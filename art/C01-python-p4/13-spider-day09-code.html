<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets@11.11.1/styles/default.min.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.18.10/dist/browser/index.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/index.js"></script><script>(r => {
              setTimeout(r);
            })(function renderToolbar() {
  const {
    markmap,
    mm
  } = window;
  const {
    el
  } = markmap.Toolbar.create(mm);
  el.setAttribute('style', 'position:absolute;bottom:20px;right:20px');
  document.body.append(el);
})</script><script>((getMarkmap, getOptions, root2, jsonOptions) => {
              const markmap = getMarkmap();
              window.mm = markmap.Markmap.create(
                "svg#mindmap",
                (getOptions || markmap.deriveOptions)(jsonOptions),
                root2
              );
            })(() => window.markmap,null,{"content":"&#x793a;&#x4f8b;","children":[{"content":"Kfc","children":[{"content":"Kfc/Kfc","children":[{"content":"<pre data-lines=\"29,49\"><code class=\"language-python\"><span class=\"hljs-comment\"># -*- coding: utf-8 -*-</span>\n\n<span class=\"hljs-comment\"># Define here the models for your scraped items</span>\n<span class=\"hljs-comment\">#</span>\n<span class=\"hljs-comment\"># See documentation in:</span>\n<span class=\"hljs-comment\"># https://doc.scrapy.org/en/latest/topics/items.html</span>\n\n<span class=\"hljs-keyword\">import</span> scrapy\n\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">KfcItem</span>(scrapy.Item):\n    <span class=\"hljs-comment\"># define the fields for your item here like:</span>\n    <span class=\"hljs-comment\"># &#x7f16;&#x53f7;&#x3001;&#x540d;&#x79f0;&#x3001;&#x5730;&#x5740;&#x3001;&#x57ce;&#x5e02;</span>\n    row_num = scrapy.Field()\n    store_name = scrapy.Field()\n    address_detail = scrapy.Field()\n    city_name = scrapy.Field()\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"29,49"}},{"content":"<pre data-lines=\"50,156\"><code class=\"language-python\"><span class=\"hljs-comment\"># -*- coding: utf-8 -*-</span>\n\n<span class=\"hljs-comment\"># Define here the models for your spider middleware</span>\n<span class=\"hljs-comment\">#</span>\n<span class=\"hljs-comment\"># See documentation in:</span>\n<span class=\"hljs-comment\"># https://doc.scrapy.org/en/latest/topics/spider-middleware.html</span>\n\n<span class=\"hljs-keyword\">from</span> scrapy <span class=\"hljs-keyword\">import</span> signals\n\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">KfcSpiderMiddleware</span>(<span class=\"hljs-title class_ inherited__\">object</span>):\n    <span class=\"hljs-comment\"># Not all methods need to be defined. If a method is not defined,</span>\n    <span class=\"hljs-comment\"># scrapy acts as if the spider middleware does not modify the</span>\n    <span class=\"hljs-comment\"># passed objects.</span>\n\n<span class=\"hljs-meta\">    @classmethod</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">from_crawler</span>(<span class=\"hljs-params\">cls, crawler</span>):\n        <span class=\"hljs-comment\"># This method is used by Scrapy to create your spiders.</span>\n        s = cls()\n        crawler.signals.connect(s.spider_opened, signal=signals.spider_opened)\n        <span class=\"hljs-keyword\">return</span> s\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_spider_input</span>(<span class=\"hljs-params\">self, response, spider</span>):\n        <span class=\"hljs-comment\"># Called for each response that goes through the spider</span>\n        <span class=\"hljs-comment\"># middleware and into the spider.</span>\n\n        <span class=\"hljs-comment\"># Should return None or raise an exception.</span>\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">None</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_spider_output</span>(<span class=\"hljs-params\">self, response, result, spider</span>):\n        <span class=\"hljs-comment\"># Called with the results returned from the Spider, after</span>\n        <span class=\"hljs-comment\"># it has processed the response.</span>\n\n        <span class=\"hljs-comment\"># Must return an iterable of Request, dict or Item objects.</span>\n        <span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> result:\n            <span class=\"hljs-keyword\">yield</span> i\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_spider_exception</span>(<span class=\"hljs-params\">self, response, exception, spider</span>):\n        <span class=\"hljs-comment\"># Called when a spider or process_spider_input() method</span>\n        <span class=\"hljs-comment\"># (from other spider middleware) raises an exception.</span>\n\n        <span class=\"hljs-comment\"># Should return either None or an iterable of Response, dict</span>\n        <span class=\"hljs-comment\"># or Item objects.</span>\n        <span class=\"hljs-keyword\">pass</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_start_requests</span>(<span class=\"hljs-params\">self, start_requests, spider</span>):\n        <span class=\"hljs-comment\"># Called with the start requests of the spider, and works</span>\n        <span class=\"hljs-comment\"># similarly to the process_spider_output() method, except</span>\n        <span class=\"hljs-comment\"># that it doesn&#x2019;t have a response associated.</span>\n\n        <span class=\"hljs-comment\"># Must return only requests (not items).</span>\n        <span class=\"hljs-keyword\">for</span> r <span class=\"hljs-keyword\">in</span> start_requests:\n            <span class=\"hljs-keyword\">yield</span> r\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">spider_opened</span>(<span class=\"hljs-params\">self, spider</span>):\n        spider.logger.info(<span class=\"hljs-string\">&apos;Spider opened: %s&apos;</span> % spider.name)\n\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">KfcDownloaderMiddleware</span>(<span class=\"hljs-title class_ inherited__\">object</span>):\n    <span class=\"hljs-comment\"># Not all methods need to be defined. If a method is not defined,</span>\n    <span class=\"hljs-comment\"># scrapy acts as if the downloader middleware does not modify the</span>\n    <span class=\"hljs-comment\"># passed objects.</span>\n\n<span class=\"hljs-meta\">    @classmethod</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">from_crawler</span>(<span class=\"hljs-params\">cls, crawler</span>):\n        <span class=\"hljs-comment\"># This method is used by Scrapy to create your spiders.</span>\n        s = cls()\n        crawler.signals.connect(s.spider_opened, signal=signals.spider_opened)\n        <span class=\"hljs-keyword\">return</span> s\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_request</span>(<span class=\"hljs-params\">self, request, spider</span>):\n        <span class=\"hljs-comment\"># Called for each request that goes through the downloader</span>\n        <span class=\"hljs-comment\"># middleware.</span>\n\n        <span class=\"hljs-comment\"># Must either:</span>\n        <span class=\"hljs-comment\"># - return None: continue processing this request</span>\n        <span class=\"hljs-comment\"># - or return a Response object</span>\n        <span class=\"hljs-comment\"># - or return a Request object</span>\n        <span class=\"hljs-comment\"># - or raise IgnoreRequest: process_exception() methods of</span>\n        <span class=\"hljs-comment\">#   installed downloader middleware will be called</span>\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">None</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_response</span>(<span class=\"hljs-params\">self, request, response, spider</span>):\n        <span class=\"hljs-comment\"># Called with the response returned from the downloader.</span>\n\n        <span class=\"hljs-comment\"># Must either;</span>\n        <span class=\"hljs-comment\"># - return a Response object</span>\n        <span class=\"hljs-comment\"># - return a Request object</span>\n        <span class=\"hljs-comment\"># - or raise IgnoreRequest</span>\n        <span class=\"hljs-keyword\">return</span> response\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_exception</span>(<span class=\"hljs-params\">self, request, exception, spider</span>):\n        <span class=\"hljs-comment\"># Called when a download handler or a process_request()</span>\n        <span class=\"hljs-comment\"># (from other downloader middleware) raises an exception.</span>\n\n        <span class=\"hljs-comment\"># Must either:</span>\n        <span class=\"hljs-comment\"># - return None: continue processing this exception</span>\n        <span class=\"hljs-comment\"># - return a Response object: stops process_exception() chain</span>\n        <span class=\"hljs-comment\"># - return a Request object: stops process_exception() chain</span>\n        <span class=\"hljs-keyword\">pass</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">spider_opened</span>(<span class=\"hljs-params\">self, spider</span>):\n        spider.logger.info(<span class=\"hljs-string\">&apos;Spider opened: %s&apos;</span> % spider.name)\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"50,156"}},{"content":"<pre data-lines=\"157,172\"><code class=\"language-python\"><span class=\"hljs-comment\"># -*- coding: utf-8 -*-</span>\n\n<span class=\"hljs-comment\"># Define your item pipelines here</span>\n<span class=\"hljs-comment\">#</span>\n<span class=\"hljs-comment\"># Don&apos;t forget to add your pipeline to the ITEM_PIPELINES setting</span>\n<span class=\"hljs-comment\"># See: https://doc.scrapy.org/en/latest/topics/item-pipeline.html</span>\n\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">KfcPipeline</span>(<span class=\"hljs-title class_ inherited__\">object</span>):\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_item</span>(<span class=\"hljs-params\">self, item, spider</span>):\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-built_in\">dict</span>(item))\n        <span class=\"hljs-keyword\">return</span> item\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"157,172"}},{"content":"<pre data-lines=\"173,267\"><code class=\"language-python\"><span class=\"hljs-comment\"># -*- coding: utf-8 -*-</span>\n\n<span class=\"hljs-comment\"># Scrapy settings for Kfc project</span>\n<span class=\"hljs-comment\">#</span>\n<span class=\"hljs-comment\"># For simplicity, this file contains only settings considered important or</span>\n<span class=\"hljs-comment\"># commonly used. You can find more settings consulting the documentation:</span>\n<span class=\"hljs-comment\">#</span>\n<span class=\"hljs-comment\">#     https://doc.scrapy.org/en/latest/topics/settings.html</span>\n<span class=\"hljs-comment\">#     https://doc.scrapy.org/en/latest/topics/downloader-middleware.html</span>\n<span class=\"hljs-comment\">#     https://doc.scrapy.org/en/latest/topics/spider-middleware.html</span>\n\nBOT_NAME = <span class=\"hljs-string\">&apos;Kfc&apos;</span>\n\nSPIDER_MODULES = [<span class=\"hljs-string\">&apos;Kfc.spiders&apos;</span>]\nNEWSPIDER_MODULE = <span class=\"hljs-string\">&apos;Kfc.spiders&apos;</span>\n\n\n<span class=\"hljs-comment\"># Crawl responsibly by identifying yourself (and your website) on the user-agent</span>\n<span class=\"hljs-comment\">#USER_AGENT = &apos;Kfc (+http://www.yourdomain.com)&apos;</span>\n\n<span class=\"hljs-comment\"># Obey robots.txt rules</span>\nROBOTSTXT_OBEY = <span class=\"hljs-literal\">False</span>\n\n<span class=\"hljs-comment\"># Configure maximum concurrent requests performed by Scrapy (default: 16)</span>\n<span class=\"hljs-comment\">#CONCURRENT_REQUESTS = 32</span>\n\n<span class=\"hljs-comment\"># Configure a delay for requests for the same website (default: 0)</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/settings.html#download-delay</span>\n<span class=\"hljs-comment\"># See also autothrottle settings and docs</span>\nDOWNLOAD_DELAY = <span class=\"hljs-number\">0.1</span>\n<span class=\"hljs-comment\"># The download delay setting will honor only one of:</span>\n<span class=\"hljs-comment\">#CONCURRENT_REQUESTS_PER_DOMAIN = 16</span>\n<span class=\"hljs-comment\">#CONCURRENT_REQUESTS_PER_IP = 16</span>\n\n<span class=\"hljs-comment\"># Disable cookies (enabled by default)</span>\n<span class=\"hljs-comment\">#COOKIES_ENABLED = False</span>\n\n<span class=\"hljs-comment\"># Disable Telnet Console (enabled by default)</span>\n<span class=\"hljs-comment\">#TELNETCONSOLE_ENABLED = False</span>\n\n<span class=\"hljs-comment\"># Override the default request headers:</span>\nDEFAULT_REQUEST_HEADERS = {\n  <span class=\"hljs-string\">&apos;Accept&apos;</span>: <span class=\"hljs-string\">&apos;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&apos;</span>,\n  <span class=\"hljs-string\">&apos;Accept-Language&apos;</span>: <span class=\"hljs-string\">&apos;en&apos;</span>,\n  <span class=\"hljs-string\">&apos;User-Agent&apos;</span>: <span class=\"hljs-string\">&apos;Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36&apos;</span>\n}\n\n<span class=\"hljs-comment\"># Enable or disable spider middlewares</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/spider-middleware.html</span>\n<span class=\"hljs-comment\">#SPIDER_MIDDLEWARES = {</span>\n<span class=\"hljs-comment\">#    &apos;Kfc.middlewares.KfcSpiderMiddleware&apos;: 543,</span>\n<span class=\"hljs-comment\">#}</span>\n\n<span class=\"hljs-comment\"># Enable or disable downloader middlewares</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/downloader-middleware.html</span>\n<span class=\"hljs-comment\">#DOWNLOADER_MIDDLEWARES = {</span>\n<span class=\"hljs-comment\">#    &apos;Kfc.middlewares.KfcDownloaderMiddleware&apos;: 543,</span>\n<span class=\"hljs-comment\">#}</span>\n\n<span class=\"hljs-comment\"># Enable or disable extensions</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/extensions.html</span>\n<span class=\"hljs-comment\">#EXTENSIONS = {</span>\n<span class=\"hljs-comment\">#    &apos;scrapy.extensions.telnet.TelnetConsole&apos;: None,</span>\n<span class=\"hljs-comment\">#}</span>\n\n<span class=\"hljs-comment\"># Configure item pipelines</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/item-pipeline.html</span>\nITEM_PIPELINES = {\n   <span class=\"hljs-string\">&apos;Kfc.pipelines.KfcPipeline&apos;</span>: <span class=\"hljs-number\">300</span>,\n}\n\n<span class=\"hljs-comment\"># Enable and configure the AutoThrottle extension (disabled by default)</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/autothrottle.html</span>\n<span class=\"hljs-comment\">#AUTOTHROTTLE_ENABLED = True</span>\n<span class=\"hljs-comment\"># The initial download delay</span>\n<span class=\"hljs-comment\">#AUTOTHROTTLE_START_DELAY = 5</span>\n<span class=\"hljs-comment\"># The maximum download delay to be set in case of high latencies</span>\n<span class=\"hljs-comment\">#AUTOTHROTTLE_MAX_DELAY = 60</span>\n<span class=\"hljs-comment\"># The average number of requests Scrapy should be sending in parallel to</span>\n<span class=\"hljs-comment\"># each remote server</span>\n<span class=\"hljs-comment\">#AUTOTHROTTLE_TARGET_CONCURRENCY = 1.0</span>\n<span class=\"hljs-comment\"># Enable showing throttling stats for every response received:</span>\n<span class=\"hljs-comment\">#AUTOTHROTTLE_DEBUG = False</span>\n\n<span class=\"hljs-comment\"># Enable and configure HTTP caching (disabled by default)</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/downloader-middleware.html#httpcache-middleware-settings</span>\n<span class=\"hljs-comment\">#HTTPCACHE_ENABLED = True</span>\n<span class=\"hljs-comment\">#HTTPCACHE_EXPIRATION_SECS = 0</span>\n<span class=\"hljs-comment\">#HTTPCACHE_DIR = &apos;httpcache&apos;</span>\n<span class=\"hljs-comment\">#HTTPCACHE_IGNORE_HTTP_CODES = []</span>\n<span class=\"hljs-comment\">#HTTPCACHE_STORAGE = &apos;scrapy.extensions.httpcache.FilesystemCacheStorage&apos;</span>\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"173,267"}}],"payload":{"tag":"h5","lines":"27,28"}},{"content":"Kfc/Kfc/spiders","children":[{"content":"<pre data-lines=\"272,339\"><code class=\"language-python\"><span class=\"hljs-comment\"># -*- coding: utf-8 -*-</span>\n<span class=\"hljs-keyword\">import</span> scrapy\n<span class=\"hljs-keyword\">import</span> requests\n<span class=\"hljs-keyword\">import</span> re\n<span class=\"hljs-keyword\">import</span> json\n<span class=\"hljs-keyword\">from</span> ..items <span class=\"hljs-keyword\">import</span> KfcItem\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">KfcSpider</span>(scrapy.Spider):\n    name = <span class=\"hljs-string\">&apos;kfc&apos;</span>\n    allowed_domains = [<span class=\"hljs-string\">&apos;www.kfc.com.cn&apos;</span>]\n    post_url = <span class=\"hljs-string\">&apos;http://www.kfc.com.cn/kfccda/ashx/GetStoreList.ashx?op=cname&apos;</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">start_requests</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x62fc;&#x63a5;&#x6240;&#x6709;URL&#x5730;&#x5740;,&#x4ea4;&#x7ed9;&#x8c03;&#x5ea6;&#x5668;&#x5165;&#x961f;&#x5217;&quot;&quot;&quot;</span>\n        <span class=\"hljs-comment\"># &#x57ce;&#x5e02;&#x3001;&#x9875;&#x6570;</span>\n        all_city = <span class=\"hljs-variable language_\">self</span>.get_all_city()\n        <span class=\"hljs-keyword\">for</span> city <span class=\"hljs-keyword\">in</span> all_city:\n            <span class=\"hljs-comment\"># &#x83b7;&#x53d6;1&#x4e2a;&#x57ce;&#x5e02;&#x603b;&#x9875;&#x6570;</span>\n            total = <span class=\"hljs-variable language_\">self</span>.get_total(city)\n            <span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(<span class=\"hljs-number\">1</span>,total+<span class=\"hljs-number\">1</span>):\n                formdata = {\n                    <span class=\"hljs-string\">&apos;cname&apos;</span>: city,\n                    <span class=\"hljs-string\">&apos;pid&apos;</span>: <span class=\"hljs-string\">&apos;&apos;</span>,\n                    <span class=\"hljs-string\">&apos;pageIndex&apos;</span>: <span class=\"hljs-built_in\">str</span>(i),\n                    <span class=\"hljs-string\">&apos;pageSize&apos;</span>: <span class=\"hljs-string\">&apos;10&apos;</span>\n                }\n                <span class=\"hljs-keyword\">yield</span> scrapy.FormRequest(url=<span class=\"hljs-variable language_\">self</span>.post_url, formdata=formdata, callback=<span class=\"hljs-variable language_\">self</span>.parse)\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">get_all_city</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x83b7;&#x53d6;&#x6240;&#x6709;&#x57ce;&#x5e02;&quot;&quot;&quot;</span>\n        get_url = <span class=\"hljs-string\">&apos;http://www.kfc.com.cn/kfccda/storelist/index.aspx&apos;</span>\n        headers = {<span class=\"hljs-string\">&apos;User-Agent&apos;</span> : <span class=\"hljs-string\">&apos;Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36&apos;</span>}\n        html = requests.get(url=get_url, headers=headers).text\n        pattern = re.<span class=\"hljs-built_in\">compile</span>(<span class=\"hljs-string\">&apos;&lt;a href=&quot;.*?rel=&quot;(.*?)&quot;&gt;&apos;</span>,re.S)\n        city_list = pattern.findall(html)\n\n        <span class=\"hljs-keyword\">return</span> city_list\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">get_total</span>(<span class=\"hljs-params\">self,city</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x83b7;&#x53d6;1&#x4e2a;&#x57ce;&#x5e02;&#x95e8;&#x5e97;&#x603b;&#x9875;&#x6570;&quot;&quot;&quot;</span>\n        headers = {<span class=\"hljs-string\">&apos;User-Agent&apos;</span>: <span class=\"hljs-string\">&apos;Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36&apos;</span>}\n        formdata = {\n            <span class=\"hljs-string\">&apos;cname&apos;</span>: city,\n            <span class=\"hljs-string\">&apos;pid&apos;</span>: <span class=\"hljs-string\">&apos;&apos;</span>,\n            <span class=\"hljs-string\">&apos;pageIndex&apos;</span>: <span class=\"hljs-string\">&apos;1&apos;</span>,\n            <span class=\"hljs-string\">&apos;pageSize&apos;</span>: <span class=\"hljs-string\">&apos;10&apos;</span>\n        }\n        html = requests.post(url=<span class=\"hljs-variable language_\">self</span>.post_url, data=formdata, headers=headers).json()\n        row_count = html[<span class=\"hljs-string\">&apos;Table&apos;</span>][<span class=\"hljs-number\">0</span>][<span class=\"hljs-string\">&apos;rowcount&apos;</span>]\n        total = row_count//<span class=\"hljs-number\">10</span> <span class=\"hljs-keyword\">if</span> row_count%<span class=\"hljs-number\">10</span>==<span class=\"hljs-number\">0</span> <span class=\"hljs-keyword\">else</span> row_count//<span class=\"hljs-number\">10</span> + <span class=\"hljs-number\">1</span>\n\n        <span class=\"hljs-keyword\">return</span> total\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">parse</span>(<span class=\"hljs-params\">self, response</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x63d0;&#x53d6;&#x5177;&#x4f53;&#x6570;&#x636e;&quot;&quot;&quot;</span>\n        html = json.loads(response.text)\n        <span class=\"hljs-keyword\">for</span> one_kfc <span class=\"hljs-keyword\">in</span> html[<span class=\"hljs-string\">&apos;Table1&apos;</span>]:\n            item = KfcItem()\n            item[<span class=\"hljs-string\">&apos;row_num&apos;</span>] = one_kfc[<span class=\"hljs-string\">&apos;rownum&apos;</span>]\n            item[<span class=\"hljs-string\">&apos;store_name&apos;</span>] = one_kfc[<span class=\"hljs-string\">&apos;storeName&apos;</span>]\n            item[<span class=\"hljs-string\">&apos;address_detail&apos;</span>] = one_kfc[<span class=\"hljs-string\">&apos;addressDetail&apos;</span>]\n            item[<span class=\"hljs-string\">&apos;city_name&apos;</span>] = one_kfc[<span class=\"hljs-string\">&apos;cityName&apos;</span>]\n\n            <span class=\"hljs-keyword\">yield</span> item\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"272,339"}}],"payload":{"tag":"h5","lines":"270,271"}}],"payload":{"tag":"h4","lines":"2,3"}},{"content":"Middle","children":[{"content":"Middle/Middle","children":[{"content":"<pre data-lines=\"367,384\"><code class=\"language-python\"><span class=\"hljs-comment\"># -*- coding: utf-8 -*-</span>\n\n<span class=\"hljs-comment\"># Define here the models for your scraped items</span>\n<span class=\"hljs-comment\">#</span>\n<span class=\"hljs-comment\"># See documentation in:</span>\n<span class=\"hljs-comment\"># https://doc.scrapy.org/en/latest/topics/items.html</span>\n\n<span class=\"hljs-keyword\">import</span> scrapy\n\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">MiddleItem</span>(scrapy.Item):\n    <span class=\"hljs-comment\"># define the fields for your item here like:</span>\n    <span class=\"hljs-comment\"># name = scrapy.Field()</span>\n    <span class=\"hljs-keyword\">pass</span>\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"367,384"}},{"content":"<pre data-lines=\"385,501\"><code class=\"language-python\"><span class=\"hljs-comment\"># -*- coding: utf-8 -*-</span>\n\n<span class=\"hljs-comment\"># Define here the models for your spider middleware</span>\n<span class=\"hljs-comment\">#</span>\n<span class=\"hljs-comment\"># See documentation in:</span>\n<span class=\"hljs-comment\"># https://doc.scrapy.org/en/latest/topics/spider-middleware.html</span>\n\n<span class=\"hljs-keyword\">from</span> scrapy <span class=\"hljs-keyword\">import</span> signals\n\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">MiddleSpiderMiddleware</span>(<span class=\"hljs-title class_ inherited__\">object</span>):\n    <span class=\"hljs-comment\"># Not all methods need to be defined. If a method is not defined,</span>\n    <span class=\"hljs-comment\"># scrapy acts as if the spider middleware does not modify the</span>\n    <span class=\"hljs-comment\"># passed objects.</span>\n\n<span class=\"hljs-meta\">    @classmethod</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">from_crawler</span>(<span class=\"hljs-params\">cls, crawler</span>):\n        <span class=\"hljs-comment\"># This method is used by Scrapy to create your spiders.</span>\n        s = cls()\n        crawler.signals.connect(s.spider_opened, signal=signals.spider_opened)\n        <span class=\"hljs-keyword\">return</span> s\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_spider_input</span>(<span class=\"hljs-params\">self, response, spider</span>):\n        <span class=\"hljs-comment\"># Called for each response that goes through the spider</span>\n        <span class=\"hljs-comment\"># middleware and into the spider.</span>\n\n        <span class=\"hljs-comment\"># Should return None or raise an exception.</span>\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">None</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_spider_output</span>(<span class=\"hljs-params\">self, response, result, spider</span>):\n        <span class=\"hljs-comment\"># Called with the results returned from the Spider, after</span>\n        <span class=\"hljs-comment\"># it has processed the response.</span>\n\n        <span class=\"hljs-comment\"># Must return an iterable of Request, dict or Item objects.</span>\n        <span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> result:\n            <span class=\"hljs-keyword\">yield</span> i\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_spider_exception</span>(<span class=\"hljs-params\">self, response, exception, spider</span>):\n        <span class=\"hljs-comment\"># Called when a spider or process_spider_input() method</span>\n        <span class=\"hljs-comment\"># (from other spider middleware) raises an exception.</span>\n\n        <span class=\"hljs-comment\"># Should return either None or an iterable of Response, dict</span>\n        <span class=\"hljs-comment\"># or Item objects.</span>\n        <span class=\"hljs-keyword\">pass</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_start_requests</span>(<span class=\"hljs-params\">self, start_requests, spider</span>):\n        <span class=\"hljs-comment\"># Called with the start requests of the spider, and works</span>\n        <span class=\"hljs-comment\"># similarly to the process_spider_output() method, except</span>\n        <span class=\"hljs-comment\"># that it doesn&#x2019;t have a response associated.</span>\n\n        <span class=\"hljs-comment\"># Must return only requests (not items).</span>\n        <span class=\"hljs-keyword\">for</span> r <span class=\"hljs-keyword\">in</span> start_requests:\n            <span class=\"hljs-keyword\">yield</span> r\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">spider_opened</span>(<span class=\"hljs-params\">self, spider</span>):\n        spider.logger.info(<span class=\"hljs-string\">&apos;Spider opened: %s&apos;</span> % spider.name)\n\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">MiddleDownloaderMiddleware</span>(<span class=\"hljs-title class_ inherited__\">object</span>):\n    <span class=\"hljs-comment\"># Not all methods need to be defined. If a method is not defined,</span>\n    <span class=\"hljs-comment\"># scrapy acts as if the downloader middleware does not modify the</span>\n    <span class=\"hljs-comment\"># passed objects.</span>\n\n<span class=\"hljs-meta\">    @classmethod</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">from_crawler</span>(<span class=\"hljs-params\">cls, crawler</span>):\n        <span class=\"hljs-comment\"># This method is used by Scrapy to create your spiders.</span>\n        s = cls()\n        crawler.signals.connect(s.spider_opened, signal=signals.spider_opened)\n        <span class=\"hljs-keyword\">return</span> s\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_request</span>(<span class=\"hljs-params\">self, request, spider</span>):\n        <span class=\"hljs-comment\"># Called for each request that goes through the downloader</span>\n        <span class=\"hljs-comment\"># middleware.</span>\n\n        <span class=\"hljs-comment\"># Must either:</span>\n        <span class=\"hljs-comment\"># - return None: continue processing this request</span>\n        <span class=\"hljs-comment\"># - or return a Response object</span>\n        <span class=\"hljs-comment\"># - or return a Request object</span>\n        <span class=\"hljs-comment\"># - or raise IgnoreRequest: process_exception() methods of</span>\n        <span class=\"hljs-comment\">#   installed downloader middleware will be called</span>\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">None</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_response</span>(<span class=\"hljs-params\">self, request, response, spider</span>):\n        <span class=\"hljs-comment\"># Called with the response returned from the downloader.</span>\n\n        <span class=\"hljs-comment\"># Must either;</span>\n        <span class=\"hljs-comment\"># - return a Response object</span>\n        <span class=\"hljs-comment\"># - return a Request object</span>\n        <span class=\"hljs-comment\"># - or raise IgnoreRequest</span>\n        <span class=\"hljs-keyword\">return</span> response\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_exception</span>(<span class=\"hljs-params\">self, request, exception, spider</span>):\n        <span class=\"hljs-comment\"># Called when a download handler or a process_request()</span>\n        <span class=\"hljs-comment\"># (from other downloader middleware) raises an exception.</span>\n\n        <span class=\"hljs-comment\"># Must either:</span>\n        <span class=\"hljs-comment\"># - return None: continue processing this exception</span>\n        <span class=\"hljs-comment\"># - return a Response object: stops process_exception() chain</span>\n        <span class=\"hljs-comment\"># - return a Request object: stops process_exception() chain</span>\n        <span class=\"hljs-keyword\">pass</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">spider_opened</span>(<span class=\"hljs-params\">self, spider</span>):\n        spider.logger.info(<span class=\"hljs-string\">&apos;Spider opened: %s&apos;</span> % spider.name)\n\n<span class=\"hljs-comment\"># &#x4e2d;&#x95f4;&#x4ef6;1 - &#x968f;&#x673a;User-Agent</span>\n<span class=\"hljs-keyword\">from</span> fake_useragent <span class=\"hljs-keyword\">import</span> UserAgent\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">MiddleRandomUaDownloaderMiddleware</span>(<span class=\"hljs-title class_ inherited__\">object</span>):\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_request</span>(<span class=\"hljs-params\">self, request, spider</span>):\n        <span class=\"hljs-comment\"># Request()&#x4e2d;&#x7684;&#x6240;&#x6709;&#x53c2;&#x6570;&#x90fd;&#x662f;&#x8bf7;&#x6c42;&#x5bf9;&#x8c61;request&#x7684;&#x5c5e;&#x6027;</span>\n        agent = UserAgent().random\n        request.headers[<span class=\"hljs-string\">&apos;User-Agent&apos;</span>] = agent\n        <span class=\"hljs-built_in\">print</span>(agent)\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"385,501"}},{"content":"<pre data-lines=\"502,516\"><code class=\"language-python\"><span class=\"hljs-comment\"># -*- coding: utf-8 -*-</span>\n\n<span class=\"hljs-comment\"># Define your item pipelines here</span>\n<span class=\"hljs-comment\">#</span>\n<span class=\"hljs-comment\"># Don&apos;t forget to add your pipeline to the ITEM_PIPELINES setting</span>\n<span class=\"hljs-comment\"># See: https://doc.scrapy.org/en/latest/topics/item-pipeline.html</span>\n\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">MiddlePipeline</span>(<span class=\"hljs-title class_ inherited__\">object</span>):\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_item</span>(<span class=\"hljs-params\">self, item, spider</span>):\n        <span class=\"hljs-keyword\">return</span> item\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"502,516"}},{"content":"<pre data-lines=\"517,611\"><code class=\"language-python\"><span class=\"hljs-comment\"># -*- coding: utf-8 -*-</span>\n\n<span class=\"hljs-comment\"># Scrapy settings for Middle project</span>\n<span class=\"hljs-comment\">#</span>\n<span class=\"hljs-comment\"># For simplicity, this file contains only settings considered important or</span>\n<span class=\"hljs-comment\"># commonly used. You can find more settings consulting the documentation:</span>\n<span class=\"hljs-comment\">#</span>\n<span class=\"hljs-comment\">#     https://doc.scrapy.org/en/latest/topics/settings.html</span>\n<span class=\"hljs-comment\">#     https://doc.scrapy.org/en/latest/topics/downloader-middleware.html</span>\n<span class=\"hljs-comment\">#     https://doc.scrapy.org/en/latest/topics/spider-middleware.html</span>\n\nBOT_NAME = <span class=\"hljs-string\">&apos;Middle&apos;</span>\n\nSPIDER_MODULES = [<span class=\"hljs-string\">&apos;Middle.spiders&apos;</span>]\nNEWSPIDER_MODULE = <span class=\"hljs-string\">&apos;Middle.spiders&apos;</span>\n\n\n<span class=\"hljs-comment\"># Crawl responsibly by identifying yourself (and your website) on the user-agent</span>\n<span class=\"hljs-comment\">#USER_AGENT = &apos;Middle (+http://www.yourdomain.com)&apos;</span>\n\n<span class=\"hljs-comment\"># Obey robots.txt rules</span>\nROBOTSTXT_OBEY = <span class=\"hljs-literal\">False</span>\n\n<span class=\"hljs-comment\"># Configure maximum concurrent requests performed by Scrapy (default: 16)</span>\n<span class=\"hljs-comment\">#CONCURRENT_REQUESTS = 32</span>\n\n<span class=\"hljs-comment\"># Configure a delay for requests for the same website (default: 0)</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/settings.html#download-delay</span>\n<span class=\"hljs-comment\"># See also autothrottle settings and docs</span>\n<span class=\"hljs-comment\">#DOWNLOAD_DELAY = 3</span>\n<span class=\"hljs-comment\"># The download delay setting will honor only one of:</span>\n<span class=\"hljs-comment\">#CONCURRENT_REQUESTS_PER_DOMAIN = 16</span>\n<span class=\"hljs-comment\">#CONCURRENT_REQUESTS_PER_IP = 16</span>\n\n<span class=\"hljs-comment\"># Disable cookies (enabled by default)</span>\n<span class=\"hljs-comment\">#COOKIES_ENABLED = False</span>\n\n<span class=\"hljs-comment\"># Disable Telnet Console (enabled by default)</span>\n<span class=\"hljs-comment\">#TELNETCONSOLE_ENABLED = False</span>\n\n<span class=\"hljs-comment\"># Override the default request headers:</span>\nDEFAULT_REQUEST_HEADERS = {\n  <span class=\"hljs-string\">&apos;Accept&apos;</span>: <span class=\"hljs-string\">&apos;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&apos;</span>,\n  <span class=\"hljs-string\">&apos;Accept-Language&apos;</span>: <span class=\"hljs-string\">&apos;en&apos;</span>,\n}\n\n<span class=\"hljs-comment\"># Enable or disable spider middlewares</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/spider-middleware.html</span>\n<span class=\"hljs-comment\">#SPIDER_MIDDLEWARES = {</span>\n<span class=\"hljs-comment\">#    &apos;Middle.middlewares.MiddleSpiderMiddleware&apos;: 543,</span>\n<span class=\"hljs-comment\">#}</span>\n\n<span class=\"hljs-comment\"># Enable or disable downloader middlewares</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/downloader-middleware.html</span>\nDOWNLOADER_MIDDLEWARES = {\n   <span class=\"hljs-string\">&apos;Middle.middlewares.MiddleDownloaderMiddleware&apos;</span>: <span class=\"hljs-number\">543</span>,\n   <span class=\"hljs-string\">&apos;Middle.middlewares.MiddleRandomUaDownloaderMiddleware&apos;</span> : <span class=\"hljs-number\">200</span>,\n}\n\n<span class=\"hljs-comment\"># Enable or disable extensions</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/extensions.html</span>\n<span class=\"hljs-comment\">#EXTENSIONS = {</span>\n<span class=\"hljs-comment\">#    &apos;scrapy.extensions.telnet.TelnetConsole&apos;: None,</span>\n<span class=\"hljs-comment\">#}</span>\n\n<span class=\"hljs-comment\"># Configure item pipelines</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/item-pipeline.html</span>\n<span class=\"hljs-comment\">#ITEM_PIPELINES = {</span>\n<span class=\"hljs-comment\">#    &apos;Middle.pipelines.MiddlePipeline&apos;: 300,</span>\n<span class=\"hljs-comment\">#}</span>\n\n<span class=\"hljs-comment\"># Enable and configure the AutoThrottle extension (disabled by default)</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/autothrottle.html</span>\n<span class=\"hljs-comment\">#AUTOTHROTTLE_ENABLED = True</span>\n<span class=\"hljs-comment\"># The initial download delay</span>\n<span class=\"hljs-comment\">#AUTOTHROTTLE_START_DELAY = 5</span>\n<span class=\"hljs-comment\"># The maximum download delay to be set in case of high latencies</span>\n<span class=\"hljs-comment\">#AUTOTHROTTLE_MAX_DELAY = 60</span>\n<span class=\"hljs-comment\"># The average number of requests Scrapy should be sending in parallel to</span>\n<span class=\"hljs-comment\"># each remote server</span>\n<span class=\"hljs-comment\">#AUTOTHROTTLE_TARGET_CONCURRENCY = 1.0</span>\n<span class=\"hljs-comment\"># Enable showing throttling stats for every response received:</span>\n<span class=\"hljs-comment\">#AUTOTHROTTLE_DEBUG = False</span>\n\n<span class=\"hljs-comment\"># Enable and configure HTTP caching (disabled by default)</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/downloader-middleware.html#httpcache-middleware-settings</span>\n<span class=\"hljs-comment\">#HTTPCACHE_ENABLED = True</span>\n<span class=\"hljs-comment\">#HTTPCACHE_EXPIRATION_SECS = 0</span>\n<span class=\"hljs-comment\">#HTTPCACHE_DIR = &apos;httpcache&apos;</span>\n<span class=\"hljs-comment\">#HTTPCACHE_IGNORE_HTTP_CODES = []</span>\n<span class=\"hljs-comment\">#HTTPCACHE_STORAGE = &apos;scrapy.extensions.httpcache.FilesystemCacheStorage&apos;</span>\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"517,611"}}],"payload":{"tag":"h5","lines":"365,366"}},{"content":"Middle/Middle/spiders","children":[{"content":"<pre data-lines=\"616,630\"><code class=\"language-python\"><span class=\"hljs-comment\"># -*- coding: utf-8 -*-</span>\n<span class=\"hljs-keyword\">import</span> scrapy\n\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">MiddleSpider</span>(scrapy.Spider):\n    name = <span class=\"hljs-string\">&apos;middle&apos;</span>\n    allowed_domains = [<span class=\"hljs-string\">&apos;www.baidu.com&apos;</span>]\n    start_urls = [<span class=\"hljs-string\">&apos;https://www.baidu.com/&apos;</span>]\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">parse</span>(<span class=\"hljs-params\">self, response</span>):\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&apos;&#x541b;&#x4e0d;&#x89c1;&#x9ec4;&#x6cb3;&#x4e4b;&#x6c34;&#x5929;&#x4e0a;&#x6765;,&#x5954;&#x6d41;&#x5230;&#x6d77;&#x4e0d;&#x590d;&#x56de;&apos;</span>)\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"616,630"}}],"payload":{"tag":"h5","lines":"614,615"}}],"payload":{"tag":"h4","lines":"340,341"}},{"content":"Sina","children":[{"content":"Sina/Sina","children":[{"content":"<pre data-lines=\"658,685\"><code class=\"language-python\"><span class=\"hljs-comment\"># -*- coding: utf-8 -*-</span>\n\n<span class=\"hljs-comment\"># Define here the models for your scraped items</span>\n<span class=\"hljs-comment\">#</span>\n<span class=\"hljs-comment\"># See documentation in:</span>\n<span class=\"hljs-comment\"># https://doc.scrapy.org/en/latest/topics/items.html</span>\n\n<span class=\"hljs-keyword\">import</span> scrapy\n\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">SinaItem</span>(scrapy.Item):\n    <span class=\"hljs-comment\"># define the fields for your item here like:</span>\n    <span class=\"hljs-comment\"># &#x4e00;&#x7ea7;&#x9875;&#x9762;&#xff1a;&#x5927;&#x6807;&#x9898;&#x3001;&#x5927;&#x94fe;&#x63a5;&#x3001;&#x5c0f;&#x6807;&#x9898;&#x3001;&#x5c0f;&#x94fe;&#x63a5;</span>\n    parent_name = scrapy.Field()\n    parent_url = scrapy.Field()\n    son_name = scrapy.Field()\n    son_url = scrapy.Field()\n    <span class=\"hljs-comment\"># &#x4e8c;&#x7ea7;&#x9875;&#x9762;&#xff1a;&#x65b0;&#x95fb;&#x94fe;&#x63a5;</span>\n    news_url = scrapy.Field()\n    <span class=\"hljs-comment\"># &#x4e09;&#x7ea7;&#x9875;&#x9762;&#xff1a;&#x65b0;&#x95fb;&#x6807;&#x9898;&#x3001;&#x65b0;&#x95fb;&#x5185;&#x5bb9;</span>\n    news_head = scrapy.Field()\n    news_content = scrapy.Field()\n    <span class=\"hljs-comment\"># &#x5b58;&#x50a8;&#x76ee;&#x5f55;</span>\n    directory = scrapy.Field()\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"658,685"}},{"content":"<pre data-lines=\"686,792\"><code class=\"language-python\"><span class=\"hljs-comment\"># -*- coding: utf-8 -*-</span>\n\n<span class=\"hljs-comment\"># Define here the models for your spider middleware</span>\n<span class=\"hljs-comment\">#</span>\n<span class=\"hljs-comment\"># See documentation in:</span>\n<span class=\"hljs-comment\"># https://doc.scrapy.org/en/latest/topics/spider-middleware.html</span>\n\n<span class=\"hljs-keyword\">from</span> scrapy <span class=\"hljs-keyword\">import</span> signals\n\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">SinaSpiderMiddleware</span>(<span class=\"hljs-title class_ inherited__\">object</span>):\n    <span class=\"hljs-comment\"># Not all methods need to be defined. If a method is not defined,</span>\n    <span class=\"hljs-comment\"># scrapy acts as if the spider middleware does not modify the</span>\n    <span class=\"hljs-comment\"># passed objects.</span>\n\n<span class=\"hljs-meta\">    @classmethod</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">from_crawler</span>(<span class=\"hljs-params\">cls, crawler</span>):\n        <span class=\"hljs-comment\"># This method is used by Scrapy to create your spiders.</span>\n        s = cls()\n        crawler.signals.connect(s.spider_opened, signal=signals.spider_opened)\n        <span class=\"hljs-keyword\">return</span> s\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_spider_input</span>(<span class=\"hljs-params\">self, response, spider</span>):\n        <span class=\"hljs-comment\"># Called for each response that goes through the spider</span>\n        <span class=\"hljs-comment\"># middleware and into the spider.</span>\n\n        <span class=\"hljs-comment\"># Should return None or raise an exception.</span>\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">None</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_spider_output</span>(<span class=\"hljs-params\">self, response, result, spider</span>):\n        <span class=\"hljs-comment\"># Called with the results returned from the Spider, after</span>\n        <span class=\"hljs-comment\"># it has processed the response.</span>\n\n        <span class=\"hljs-comment\"># Must return an iterable of Request, dict or Item objects.</span>\n        <span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> result:\n            <span class=\"hljs-keyword\">yield</span> i\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_spider_exception</span>(<span class=\"hljs-params\">self, response, exception, spider</span>):\n        <span class=\"hljs-comment\"># Called when a spider or process_spider_input() method</span>\n        <span class=\"hljs-comment\"># (from other spider middleware) raises an exception.</span>\n\n        <span class=\"hljs-comment\"># Should return either None or an iterable of Response, dict</span>\n        <span class=\"hljs-comment\"># or Item objects.</span>\n        <span class=\"hljs-keyword\">pass</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_start_requests</span>(<span class=\"hljs-params\">self, start_requests, spider</span>):\n        <span class=\"hljs-comment\"># Called with the start requests of the spider, and works</span>\n        <span class=\"hljs-comment\"># similarly to the process_spider_output() method, except</span>\n        <span class=\"hljs-comment\"># that it doesn&#x2019;t have a response associated.</span>\n\n        <span class=\"hljs-comment\"># Must return only requests (not items).</span>\n        <span class=\"hljs-keyword\">for</span> r <span class=\"hljs-keyword\">in</span> start_requests:\n            <span class=\"hljs-keyword\">yield</span> r\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">spider_opened</span>(<span class=\"hljs-params\">self, spider</span>):\n        spider.logger.info(<span class=\"hljs-string\">&apos;Spider opened: %s&apos;</span> % spider.name)\n\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">SinaDownloaderMiddleware</span>(<span class=\"hljs-title class_ inherited__\">object</span>):\n    <span class=\"hljs-comment\"># Not all methods need to be defined. If a method is not defined,</span>\n    <span class=\"hljs-comment\"># scrapy acts as if the downloader middleware does not modify the</span>\n    <span class=\"hljs-comment\"># passed objects.</span>\n\n<span class=\"hljs-meta\">    @classmethod</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">from_crawler</span>(<span class=\"hljs-params\">cls, crawler</span>):\n        <span class=\"hljs-comment\"># This method is used by Scrapy to create your spiders.</span>\n        s = cls()\n        crawler.signals.connect(s.spider_opened, signal=signals.spider_opened)\n        <span class=\"hljs-keyword\">return</span> s\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_request</span>(<span class=\"hljs-params\">self, request, spider</span>):\n        <span class=\"hljs-comment\"># Called for each request that goes through the downloader</span>\n        <span class=\"hljs-comment\"># middleware.</span>\n\n        <span class=\"hljs-comment\"># Must either:</span>\n        <span class=\"hljs-comment\"># - return None: continue processing this request</span>\n        <span class=\"hljs-comment\"># - or return a Response object</span>\n        <span class=\"hljs-comment\"># - or return a Request object</span>\n        <span class=\"hljs-comment\"># - or raise IgnoreRequest: process_exception() methods of</span>\n        <span class=\"hljs-comment\">#   installed downloader middleware will be called</span>\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">None</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_response</span>(<span class=\"hljs-params\">self, request, response, spider</span>):\n        <span class=\"hljs-comment\"># Called with the response returned from the downloader.</span>\n\n        <span class=\"hljs-comment\"># Must either;</span>\n        <span class=\"hljs-comment\"># - return a Response object</span>\n        <span class=\"hljs-comment\"># - return a Request object</span>\n        <span class=\"hljs-comment\"># - or raise IgnoreRequest</span>\n        <span class=\"hljs-keyword\">return</span> response\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_exception</span>(<span class=\"hljs-params\">self, request, exception, spider</span>):\n        <span class=\"hljs-comment\"># Called when a download handler or a process_request()</span>\n        <span class=\"hljs-comment\"># (from other downloader middleware) raises an exception.</span>\n\n        <span class=\"hljs-comment\"># Must either:</span>\n        <span class=\"hljs-comment\"># - return None: continue processing this exception</span>\n        <span class=\"hljs-comment\"># - return a Response object: stops process_exception() chain</span>\n        <span class=\"hljs-comment\"># - return a Request object: stops process_exception() chain</span>\n        <span class=\"hljs-keyword\">pass</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">spider_opened</span>(<span class=\"hljs-params\">self, spider</span>):\n        spider.logger.info(<span class=\"hljs-string\">&apos;Spider opened: %s&apos;</span> % spider.name)\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"686,792"}},{"content":"<pre data-lines=\"793,813\"><code class=\"language-python\"><span class=\"hljs-comment\"># -*- coding: utf-8 -*-</span>\n\n<span class=\"hljs-comment\"># Define your item pipelines here</span>\n<span class=\"hljs-comment\">#</span>\n<span class=\"hljs-comment\"># Don&apos;t forget to add your pipeline to the ITEM_PIPELINES setting</span>\n<span class=\"hljs-comment\"># See: https://doc.scrapy.org/en/latest/topics/item-pipeline.html</span>\n\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">SinaPipeline</span>(<span class=\"hljs-title class_ inherited__\">object</span>):\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_item</span>(<span class=\"hljs-params\">self, item, spider</span>):\n        <span class=\"hljs-comment\"># filename: ./data/&#x4f53;&#x80b2;/NBA/xxx.txt</span>\n        <span class=\"hljs-comment\"># https://sports.sina.com.cn/basketball/nba/2020-03-19/doc-iimxxsth0144812.shtml</span>\n        filename = item[<span class=\"hljs-string\">&apos;directory&apos;</span>] + item[<span class=\"hljs-string\">&apos;news_url&apos;</span>][<span class=\"hljs-number\">7</span>:-<span class=\"hljs-number\">6</span>].replace(<span class=\"hljs-string\">&apos;/&apos;</span>,<span class=\"hljs-string\">&apos;_&apos;</span>) + <span class=\"hljs-string\">&apos;.txt&apos;</span>\n        <span class=\"hljs-keyword\">with</span> <span class=\"hljs-built_in\">open</span>(filename,<span class=\"hljs-string\">&apos;w&apos;</span>,encoding=<span class=\"hljs-string\">&apos;utf-8&apos;</span>) <span class=\"hljs-keyword\">as</span> f:\n            f.write(item[<span class=\"hljs-string\">&apos;news_content&apos;</span>])\n\n        <span class=\"hljs-keyword\">return</span> item\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"793,813"}},{"content":"<pre data-lines=\"814,908\"><code class=\"language-python\"><span class=\"hljs-comment\"># -*- coding: utf-8 -*-</span>\n\n<span class=\"hljs-comment\"># Scrapy settings for Sina project</span>\n<span class=\"hljs-comment\">#</span>\n<span class=\"hljs-comment\"># For simplicity, this file contains only settings considered important or</span>\n<span class=\"hljs-comment\"># commonly used. You can find more settings consulting the documentation:</span>\n<span class=\"hljs-comment\">#</span>\n<span class=\"hljs-comment\">#     https://doc.scrapy.org/en/latest/topics/settings.html</span>\n<span class=\"hljs-comment\">#     https://doc.scrapy.org/en/latest/topics/downloader-middleware.html</span>\n<span class=\"hljs-comment\">#     https://doc.scrapy.org/en/latest/topics/spider-middleware.html</span>\n\nBOT_NAME = <span class=\"hljs-string\">&apos;Sina&apos;</span>\n\nSPIDER_MODULES = [<span class=\"hljs-string\">&apos;Sina.spiders&apos;</span>]\nNEWSPIDER_MODULE = <span class=\"hljs-string\">&apos;Sina.spiders&apos;</span>\n\n\n<span class=\"hljs-comment\"># Crawl responsibly by identifying yourself (and your website) on the user-agent</span>\n<span class=\"hljs-comment\">#USER_AGENT = &apos;Sina (+http://www.yourdomain.com)&apos;</span>\n\n<span class=\"hljs-comment\"># Obey robots.txt rules</span>\nROBOTSTXT_OBEY = <span class=\"hljs-literal\">False</span>\n\n<span class=\"hljs-comment\"># Configure maximum concurrent requests performed by Scrapy (default: 16)</span>\n<span class=\"hljs-comment\">#CONCURRENT_REQUESTS = 32</span>\n\n<span class=\"hljs-comment\"># Configure a delay for requests for the same website (default: 0)</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/settings.html#download-delay</span>\n<span class=\"hljs-comment\"># See also autothrottle settings and docs</span>\nDOWNLOAD_DELAY = <span class=\"hljs-number\">0.1</span>\n<span class=\"hljs-comment\"># The download delay setting will honor only one of:</span>\n<span class=\"hljs-comment\">#CONCURRENT_REQUESTS_PER_DOMAIN = 16</span>\n<span class=\"hljs-comment\">#CONCURRENT_REQUESTS_PER_IP = 16</span>\n\n<span class=\"hljs-comment\"># Disable cookies (enabled by default)</span>\n<span class=\"hljs-comment\">#COOKIES_ENABLED = False</span>\n\n<span class=\"hljs-comment\"># Disable Telnet Console (enabled by default)</span>\n<span class=\"hljs-comment\">#TELNETCONSOLE_ENABLED = False</span>\n\n<span class=\"hljs-comment\"># Override the default request headers:</span>\nDEFAULT_REQUEST_HEADERS = {\n  <span class=\"hljs-string\">&apos;Accept&apos;</span>: <span class=\"hljs-string\">&apos;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&apos;</span>,\n  <span class=\"hljs-string\">&apos;Accept-Language&apos;</span>: <span class=\"hljs-string\">&apos;en&apos;</span>,\n  <span class=\"hljs-string\">&apos;User-Agent&apos;</span>: <span class=\"hljs-string\">&apos;Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36&apos;</span>\n}\n\n<span class=\"hljs-comment\"># Enable or disable spider middlewares</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/spider-middleware.html</span>\n<span class=\"hljs-comment\">#SPIDER_MIDDLEWARES = {</span>\n<span class=\"hljs-comment\">#    &apos;Sina.middlewares.SinaSpiderMiddleware&apos;: 543,</span>\n<span class=\"hljs-comment\">#}</span>\n\n<span class=\"hljs-comment\"># Enable or disable downloader middlewares</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/downloader-middleware.html</span>\n<span class=\"hljs-comment\">#DOWNLOADER_MIDDLEWARES = {</span>\n<span class=\"hljs-comment\">#    &apos;Sina.middlewares.SinaDownloaderMiddleware&apos;: 543,</span>\n<span class=\"hljs-comment\">#}</span>\n\n<span class=\"hljs-comment\"># Enable or disable extensions</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/extensions.html</span>\n<span class=\"hljs-comment\">#EXTENSIONS = {</span>\n<span class=\"hljs-comment\">#    &apos;scrapy.extensions.telnet.TelnetConsole&apos;: None,</span>\n<span class=\"hljs-comment\">#}</span>\n\n<span class=\"hljs-comment\"># Configure item pipelines</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/item-pipeline.html</span>\nITEM_PIPELINES = {\n   <span class=\"hljs-string\">&apos;Sina.pipelines.SinaPipeline&apos;</span>: <span class=\"hljs-number\">300</span>,\n}\n\n<span class=\"hljs-comment\"># Enable and configure the AutoThrottle extension (disabled by default)</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/autothrottle.html</span>\n<span class=\"hljs-comment\">#AUTOTHROTTLE_ENABLED = True</span>\n<span class=\"hljs-comment\"># The initial download delay</span>\n<span class=\"hljs-comment\">#AUTOTHROTTLE_START_DELAY = 5</span>\n<span class=\"hljs-comment\"># The maximum download delay to be set in case of high latencies</span>\n<span class=\"hljs-comment\">#AUTOTHROTTLE_MAX_DELAY = 60</span>\n<span class=\"hljs-comment\"># The average number of requests Scrapy should be sending in parallel to</span>\n<span class=\"hljs-comment\"># each remote server</span>\n<span class=\"hljs-comment\">#AUTOTHROTTLE_TARGET_CONCURRENCY = 1.0</span>\n<span class=\"hljs-comment\"># Enable showing throttling stats for every response received:</span>\n<span class=\"hljs-comment\">#AUTOTHROTTLE_DEBUG = False</span>\n\n<span class=\"hljs-comment\"># Enable and configure HTTP caching (disabled by default)</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/downloader-middleware.html#httpcache-middleware-settings</span>\n<span class=\"hljs-comment\">#HTTPCACHE_ENABLED = True</span>\n<span class=\"hljs-comment\">#HTTPCACHE_EXPIRATION_SECS = 0</span>\n<span class=\"hljs-comment\">#HTTPCACHE_DIR = &apos;httpcache&apos;</span>\n<span class=\"hljs-comment\">#HTTPCACHE_IGNORE_HTTP_CODES = []</span>\n<span class=\"hljs-comment\">#HTTPCACHE_STORAGE = &apos;scrapy.extensions.httpcache.FilesystemCacheStorage&apos;</span>\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"814,908"}}],"payload":{"tag":"h5","lines":"656,657"}},{"content":"Sina/Sina/spiders","children":[{"content":"<pre data-lines=\"913,980\"><code class=\"language-python\"><span class=\"hljs-comment\"># -*- coding: utf-8 -*-</span>\n<span class=\"hljs-keyword\">import</span> scrapy\n<span class=\"hljs-keyword\">import</span> os\n<span class=\"hljs-keyword\">from</span> ..items <span class=\"hljs-keyword\">import</span> SinaItem\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">SinaSpider</span>(scrapy.Spider):\n    name = <span class=\"hljs-string\">&apos;sina&apos;</span>\n    allowed_domains = [<span class=\"hljs-string\">&apos;sina.com.cn&apos;</span>]\n    start_urls = [<span class=\"hljs-string\">&apos;http://news.sina.com.cn/guide/&apos;</span>]\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">parse</span>(<span class=\"hljs-params\">self, response</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x63d0;&#x53d6;&#x5185;&#x5bb9;&#xff1a;&#x5927;&#x6807;&#x9898;&#x3001;&#x5927;&#x94fe;&#x63a5;&#x3001;&#x5c0f;&#x6807;&#x9898;&#x3001;&#x5c0f;&#x94fe;&#x63a5;&quot;&quot;&quot;</span>\n        div_list = response.xpath(<span class=\"hljs-string\">&apos;//div[@id=&quot;tab01&quot;]/div&apos;</span>)\n        <span class=\"hljs-keyword\">for</span> div <span class=\"hljs-keyword\">in</span> div_list:\n            <span class=\"hljs-comment\"># &#x56e0;&#x4e3a;&#x5927;&#x6807;&#x9898;&#x548c;&#x5927;&#x94fe;&#x63a5;&#x90fd;&#x4e0d;&#x9700;&#x8981;&#x4ea4;&#x7ed9;&#x8c03;&#x5ea6;&#x5668;,&#x6240;&#x4ee5;&#x6b64;&#x5904;&#x5148;&#x4e0d;&#x521b;&#x5efa;item&#x5bf9;&#x8c61;</span>\n            <span class=\"hljs-comment\"># &#x5730;&#x65b9;&#x7ad9;&#x8282;&#x70b9;&#x7279;&#x6b8a;,&#x9700;&#x8981;&#x4f7f;&#x7528;: ./h3/span/text() &#x6765;&#x63d0;&#x53d6;</span>\n            parent_name = div.xpath(<span class=\"hljs-string\">&apos;./h3/a/text() | ./h3/span/text()&apos;</span>).get()\n            parent_url = div.xpath(<span class=\"hljs-string\">&apos;./h3/a/@href&apos;</span>).get()\n            <span class=\"hljs-comment\"># &#x5730;&#x65b9;&#x7ad9;&#x6ca1;&#x6709;&#x94fe;&#x63a5;,&#x4f46;&#x662f;&#x4e0b;&#x9762;&#x51fd;&#x6570;&#x5728;&#x5224;&#x65ad;&#x65f6;&#x4f7f;&#x7528; startswith() &#x6b64;&#x5904;&#x4f1a;&#x629b;&#x51fa;&#x5f02;&#x5e38;,&#x505a;&#x5982;&#x4e0b;&#x5904;&#x7406;</span>\n            <span class=\"hljs-keyword\">if</span> <span class=\"hljs-keyword\">not</span> parent_url:\n                parent_url = <span class=\"hljs-string\">&apos;http&apos;</span>\n            <span class=\"hljs-comment\"># &#x6bcf;&#x4e2a;&#x5927;&#x5206;&#x7c7b;&#x4e0b;&#x6709;&#x597d;&#x591a;&#x5c0f;&#x5206;&#x7c7b;</span>\n            li_list = div.xpath(<span class=\"hljs-string\">&apos;./ul/li&apos;</span>)\n            <span class=\"hljs-keyword\">for</span> li <span class=\"hljs-keyword\">in</span> li_list:\n                <span class=\"hljs-comment\"># &#x5c0f;&#x5206;&#x7c7b;&#x94fe;&#x63a5;&#x9700;&#x8981;&#x7ee7;&#x7eed;&#x4ea4;&#x7ed9;&#x8c03;&#x5ea6;&#x5668;&#x5165;&#x961f;&#x5217;,&#x6240;&#x4ee5;&#x521b;&#x5efa;item&#x5bf9;&#x8c61;&#xff01;&#xff01;&#xff01;</span>\n                item = SinaItem()\n                item[<span class=\"hljs-string\">&apos;son_name&apos;</span>] = li.xpath(<span class=\"hljs-string\">&apos;./a/text()&apos;</span>).get()\n                item[<span class=\"hljs-string\">&apos;son_url&apos;</span>] = li.xpath(<span class=\"hljs-string\">&apos;./a/@href&apos;</span>).get()\n                item[<span class=\"hljs-string\">&apos;parent_name&apos;</span>] = parent_name\n                item[<span class=\"hljs-string\">&apos;parent_url&apos;</span>] = parent_url\n                <span class=\"hljs-comment\"># diretory: ./data/&#x4f53;&#x80b2;/NBA/  -&gt; &#x5bf9;&#x5e94;&#x76ee;&#x5f55;&#x521b;&#x5efa;,&#x8be5;&#x4ea4;&#x7ed9;&#x8c03;&#x5ea6;&#x5668;&#x7684;&#x4ea4;&#x7ed9;&#x8c03;&#x5ea6;&#x5668;</span>\n                item[<span class=\"hljs-string\">&apos;directory&apos;</span>] = <span class=\"hljs-string\">&apos;./data/{}/{}/&apos;</span>.<span class=\"hljs-built_in\">format</span>(item[<span class=\"hljs-string\">&apos;parent_name&apos;</span>],item[<span class=\"hljs-string\">&apos;son_name&apos;</span>])\n                <span class=\"hljs-comment\"># &#x521b;&#x5efa;&#x597d;&#x6574;&#x4f53;&#x7684;&#x76ee;&#x5f55;&#x7ed3;&#x6784;</span>\n                <span class=\"hljs-keyword\">if</span> <span class=\"hljs-keyword\">not</span> os.path.exists(item[<span class=\"hljs-string\">&apos;directory&apos;</span>]):\n                    os.makedirs(item[<span class=\"hljs-string\">&apos;directory&apos;</span>])\n\n                <span class=\"hljs-comment\"># &#x628a;&#x5c0f;&#x5206;&#x7c7b;&#x7684;&#x8bf7;&#x6c42;&#x4ea4;&#x7ed9;&#x8c03;&#x5ea6;&#x5668;&#x5165;&#x961f;&#x5217;</span>\n                <span class=\"hljs-keyword\">yield</span> scrapy.Request(url=item[<span class=\"hljs-string\">&apos;son_url&apos;</span>], meta={<span class=\"hljs-string\">&apos;meta_1&apos;</span>:item}, callback=<span class=\"hljs-variable language_\">self</span>.parse_son_url)\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">parse_son_url</span>(<span class=\"hljs-params\">self, response</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x63d0;&#x53d6;&#x5185;&#x5bb9;&#xff1a;&#x5c0f;&#x5206;&#x7c7b;&#x7684;URL&#x5730;&#x5740;&quot;&quot;&quot;</span>\n        meta_1 = response.meta[<span class=\"hljs-string\">&apos;meta_1&apos;</span>]\n        news_url_list = response.xpath(<span class=\"hljs-string\">&apos;//a/@href&apos;</span>).extract()\n        <span class=\"hljs-keyword\">for</span> news_url <span class=\"hljs-keyword\">in</span> news_url_list:\n            <span class=\"hljs-comment\"># &#x901a;&#x8fc7;&#x89c2;&#x5bdf;&#x89c4;&#x5f8b;&#xff1a;&#x65b0;&#x95fb;&#x7684;URL&#x4e00;&#x822c;&#x4ee5; &#x5927;&#x5206;&#x7c7b;URL&#x5f00;&#x5934;,&#x5e76;&#x4e14;&#x7ed3;&#x5c3e;&#x90fd;&#x662f; .shtml</span>\n            <span class=\"hljs-keyword\">if</span> news_url.startswith(meta_1[<span class=\"hljs-string\">&apos;parent_url&apos;</span>]) <span class=\"hljs-keyword\">and</span> news_url.endswith(<span class=\"hljs-string\">&apos;.shtml&apos;</span>):\n                <span class=\"hljs-comment\"># &#x6b64;&#x65f6;,&#x5e0c;&#x671b;&#x628a;news_url&#x4ea4;&#x7ed9;&#x8c03;&#x5ea6;&#x5668;&#x5165;&#x961f;&#x5217;,&#x6240;&#x4ee5;&#x6211;&#x8981;&#x521b;&#x5efa;item&#x5bf9;&#x8c61;&#x4e86;!!!</span>\n                item = SinaItem()\n                item[<span class=\"hljs-string\">&apos;news_url&apos;</span>] = news_url\n                item[<span class=\"hljs-string\">&apos;directory&apos;</span>] = meta_1[<span class=\"hljs-string\">&apos;directory&apos;</span>]\n                item[<span class=\"hljs-string\">&apos;parent_name&apos;</span>] = meta_1[<span class=\"hljs-string\">&apos;parent_name&apos;</span>]\n                item[<span class=\"hljs-string\">&apos;parent_url&apos;</span>] = meta_1[<span class=\"hljs-string\">&apos;parent_url&apos;</span>]\n                item[<span class=\"hljs-string\">&apos;son_name&apos;</span>] = meta_1[<span class=\"hljs-string\">&apos;son_name&apos;</span>]\n                item[<span class=\"hljs-string\">&apos;son_url&apos;</span>] = meta_1[<span class=\"hljs-string\">&apos;son_url&apos;</span>]\n\n                <span class=\"hljs-keyword\">yield</span> scrapy.Request(url=item[<span class=\"hljs-string\">&apos;news_url&apos;</span>], meta={<span class=\"hljs-string\">&apos;item&apos;</span>:item}, callback=<span class=\"hljs-variable language_\">self</span>.get_content)\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">get_content</span>(<span class=\"hljs-params\">self, response</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x63d0;&#x53d6;&#x5185;&#x5bb9;&#xff1a;&#x65b0;&#x95fb;&#x6807;&#x9898;&#x3001;&#x65b0;&#x95fb;&#x5185;&#x5bb9;&quot;&quot;&quot;</span>\n        item = response.meta[<span class=\"hljs-string\">&apos;item&apos;</span>]\n        item[<span class=\"hljs-string\">&apos;news_head&apos;</span>] = response.xpath(<span class=\"hljs-string\">&apos;//h1[@class=&quot;main-title&quot;]/text() | //h1[@id=&quot;main_title&quot;]/text()&apos;</span>).get()\n        item[<span class=\"hljs-string\">&apos;news_content&apos;</span>] = <span class=\"hljs-string\">&apos;\\n&apos;</span>.join(response.xpath(<span class=\"hljs-string\">&apos;//div[@class=&quot;article&quot;]/p/text() | //div[@class=&quot;content&quot;]/p/text()&apos;</span>).extract())\n\n        <span class=\"hljs-keyword\">yield</span> item\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"913,980"}}],"payload":{"tag":"h5","lines":"911,912"}}],"payload":{"tag":"h4","lines":"631,632"}},{"content":"So","children":[{"content":"So/So","children":[{"content":"<pre data-lines=\"1008,1027\"><code class=\"language-python\"><span class=\"hljs-comment\"># -*- coding: utf-8 -*-</span>\n\n<span class=\"hljs-comment\"># Define here the models for your scraped items</span>\n<span class=\"hljs-comment\">#</span>\n<span class=\"hljs-comment\"># See documentation in:</span>\n<span class=\"hljs-comment\"># https://doc.scrapy.org/en/latest/topics/items.html</span>\n\n<span class=\"hljs-keyword\">import</span> scrapy\n\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">SoItem</span>(scrapy.Item):\n    <span class=\"hljs-comment\"># define the fields for your item here like:</span>\n    <span class=\"hljs-comment\"># &#x56fe;&#x7247;&#x94fe;&#x63a5;</span>\n    img_url = scrapy.Field()\n    <span class=\"hljs-comment\"># &#x56fe;&#x7247;&#x6807;&#x9898;</span>\n    img_title = scrapy.Field()\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1008,1027"}},{"content":"<pre data-lines=\"1028,1134\"><code class=\"language-python\"><span class=\"hljs-comment\"># -*- coding: utf-8 -*-</span>\n\n<span class=\"hljs-comment\"># Define here the models for your spider middleware</span>\n<span class=\"hljs-comment\">#</span>\n<span class=\"hljs-comment\"># See documentation in:</span>\n<span class=\"hljs-comment\"># https://doc.scrapy.org/en/latest/topics/spider-middleware.html</span>\n\n<span class=\"hljs-keyword\">from</span> scrapy <span class=\"hljs-keyword\">import</span> signals\n\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">SoSpiderMiddleware</span>(<span class=\"hljs-title class_ inherited__\">object</span>):\n    <span class=\"hljs-comment\"># Not all methods need to be defined. If a method is not defined,</span>\n    <span class=\"hljs-comment\"># scrapy acts as if the spider middleware does not modify the</span>\n    <span class=\"hljs-comment\"># passed objects.</span>\n\n<span class=\"hljs-meta\">    @classmethod</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">from_crawler</span>(<span class=\"hljs-params\">cls, crawler</span>):\n        <span class=\"hljs-comment\"># This method is used by Scrapy to create your spiders.</span>\n        s = cls()\n        crawler.signals.connect(s.spider_opened, signal=signals.spider_opened)\n        <span class=\"hljs-keyword\">return</span> s\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_spider_input</span>(<span class=\"hljs-params\">self, response, spider</span>):\n        <span class=\"hljs-comment\"># Called for each response that goes through the spider</span>\n        <span class=\"hljs-comment\"># middleware and into the spider.</span>\n\n        <span class=\"hljs-comment\"># Should return None or raise an exception.</span>\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">None</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_spider_output</span>(<span class=\"hljs-params\">self, response, result, spider</span>):\n        <span class=\"hljs-comment\"># Called with the results returned from the Spider, after</span>\n        <span class=\"hljs-comment\"># it has processed the response.</span>\n\n        <span class=\"hljs-comment\"># Must return an iterable of Request, dict or Item objects.</span>\n        <span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> result:\n            <span class=\"hljs-keyword\">yield</span> i\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_spider_exception</span>(<span class=\"hljs-params\">self, response, exception, spider</span>):\n        <span class=\"hljs-comment\"># Called when a spider or process_spider_input() method</span>\n        <span class=\"hljs-comment\"># (from other spider middleware) raises an exception.</span>\n\n        <span class=\"hljs-comment\"># Should return either None or an iterable of Response, dict</span>\n        <span class=\"hljs-comment\"># or Item objects.</span>\n        <span class=\"hljs-keyword\">pass</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_start_requests</span>(<span class=\"hljs-params\">self, start_requests, spider</span>):\n        <span class=\"hljs-comment\"># Called with the start requests of the spider, and works</span>\n        <span class=\"hljs-comment\"># similarly to the process_spider_output() method, except</span>\n        <span class=\"hljs-comment\"># that it doesn&#x2019;t have a response associated.</span>\n\n        <span class=\"hljs-comment\"># Must return only requests (not items).</span>\n        <span class=\"hljs-keyword\">for</span> r <span class=\"hljs-keyword\">in</span> start_requests:\n            <span class=\"hljs-keyword\">yield</span> r\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">spider_opened</span>(<span class=\"hljs-params\">self, spider</span>):\n        spider.logger.info(<span class=\"hljs-string\">&apos;Spider opened: %s&apos;</span> % spider.name)\n\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">SoDownloaderMiddleware</span>(<span class=\"hljs-title class_ inherited__\">object</span>):\n    <span class=\"hljs-comment\"># Not all methods need to be defined. If a method is not defined,</span>\n    <span class=\"hljs-comment\"># scrapy acts as if the downloader middleware does not modify the</span>\n    <span class=\"hljs-comment\"># passed objects.</span>\n\n<span class=\"hljs-meta\">    @classmethod</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">from_crawler</span>(<span class=\"hljs-params\">cls, crawler</span>):\n        <span class=\"hljs-comment\"># This method is used by Scrapy to create your spiders.</span>\n        s = cls()\n        crawler.signals.connect(s.spider_opened, signal=signals.spider_opened)\n        <span class=\"hljs-keyword\">return</span> s\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_request</span>(<span class=\"hljs-params\">self, request, spider</span>):\n        <span class=\"hljs-comment\"># Called for each request that goes through the downloader</span>\n        <span class=\"hljs-comment\"># middleware.</span>\n\n        <span class=\"hljs-comment\"># Must either:</span>\n        <span class=\"hljs-comment\"># - return None: continue processing this request</span>\n        <span class=\"hljs-comment\"># - or return a Response object</span>\n        <span class=\"hljs-comment\"># - or return a Request object</span>\n        <span class=\"hljs-comment\"># - or raise IgnoreRequest: process_exception() methods of</span>\n        <span class=\"hljs-comment\">#   installed downloader middleware will be called</span>\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">None</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_response</span>(<span class=\"hljs-params\">self, request, response, spider</span>):\n        <span class=\"hljs-comment\"># Called with the response returned from the downloader.</span>\n\n        <span class=\"hljs-comment\"># Must either;</span>\n        <span class=\"hljs-comment\"># - return a Response object</span>\n        <span class=\"hljs-comment\"># - return a Request object</span>\n        <span class=\"hljs-comment\"># - or raise IgnoreRequest</span>\n        <span class=\"hljs-keyword\">return</span> response\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_exception</span>(<span class=\"hljs-params\">self, request, exception, spider</span>):\n        <span class=\"hljs-comment\"># Called when a download handler or a process_request()</span>\n        <span class=\"hljs-comment\"># (from other downloader middleware) raises an exception.</span>\n\n        <span class=\"hljs-comment\"># Must either:</span>\n        <span class=\"hljs-comment\"># - return None: continue processing this exception</span>\n        <span class=\"hljs-comment\"># - return a Response object: stops process_exception() chain</span>\n        <span class=\"hljs-comment\"># - return a Request object: stops process_exception() chain</span>\n        <span class=\"hljs-keyword\">pass</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">spider_opened</span>(<span class=\"hljs-params\">self, spider</span>):\n        spider.logger.info(<span class=\"hljs-string\">&apos;Spider opened: %s&apos;</span> % spider.name)\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1028,1134"}},{"content":"<pre data-lines=\"1135,1164\"><code class=\"language-python\"><span class=\"hljs-comment\"># -*- coding: utf-8 -*-</span>\n\n<span class=\"hljs-comment\"># Define your item pipelines here</span>\n<span class=\"hljs-comment\">#</span>\n<span class=\"hljs-comment\"># Don&apos;t forget to add your pipeline to the ITEM_PIPELINES setting</span>\n<span class=\"hljs-comment\"># See: https://doc.scrapy.org/en/latest/topics/item-pipeline.html</span>\n\n<span class=\"hljs-keyword\">from</span> scrapy.pipelines.images <span class=\"hljs-keyword\">import</span> ImagesPipeline\n<span class=\"hljs-keyword\">import</span> scrapy\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">SoPipeline</span>(<span class=\"hljs-title class_ inherited__\">ImagesPipeline</span>):\n    <span class=\"hljs-comment\"># &#x91cd;&#x5199; get_media_requests() &#x65b9;&#x6cd5;,&#x628a;&#x56fe;&#x7247;&#x94fe;&#x63a5;&#x4ea4;&#x7ed9;&#x8c03;&#x5ea6;&#x5668;&#x5165;&#x961f;&#x5217;</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">get_media_requests</span>(<span class=\"hljs-params\">self, item, info</span>):\n        <span class=\"hljs-keyword\">yield</span> scrapy.Request(url=item[<span class=\"hljs-string\">&apos;img_url&apos;</span>], meta={<span class=\"hljs-string\">&apos;item&apos;</span>:item})\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">file_path</span>(<span class=\"hljs-params\">self, request, response=<span class=\"hljs-literal\">None</span>, info=<span class=\"hljs-literal\">None</span></span>):\n        <span class=\"hljs-comment\"># Request()&#x65b9;&#x6cd5;&#x4e2d;,&#x6240;&#x6709;&#x7684;&#x53c2;&#x6570;&#x90fd;&#x53ef;&#x4ee5;&#x4f5c;&#x4e3a;&#x8bf7;&#x6c42;&#x5bf9;&#x8c61; request &#x7684;&#x5c5e;&#x6027;</span>\n        item = request.meta[<span class=\"hljs-string\">&apos;item&apos;</span>]\n        filename = item[<span class=\"hljs-string\">&apos;img_title&apos;</span>] + <span class=\"hljs-string\">&apos;.jpg&apos;</span>\n        <span class=\"hljs-comment\"># windows&#x4e2d;&#x6587;&#x4ef6;&#x540d;&#x4e2d;&#x4e0d;&#x80fd;&#x6709;&#x5982;&#x4e0b;&#x5b57;&#x7b26;</span>\n        all_chars = <span class=\"hljs-string\">&quot;&quot;&quot;&apos;\\/&lt;&gt;*&quot;|?&quot;&quot;&quot;</span>\n        <span class=\"hljs-keyword\">for</span> char <span class=\"hljs-keyword\">in</span> filename:\n            <span class=\"hljs-keyword\">if</span> char <span class=\"hljs-keyword\">in</span> all_chars:\n                filename = filename.replace(char,<span class=\"hljs-string\">&apos;&apos;</span>)\n\n        <span class=\"hljs-keyword\">return</span> filename\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1135,1164"}},{"content":"<pre data-lines=\"1165,1262\"><code class=\"language-python\"><span class=\"hljs-comment\"># -*- coding: utf-8 -*-</span>\n\n<span class=\"hljs-comment\"># Scrapy settings for So project</span>\n<span class=\"hljs-comment\">#</span>\n<span class=\"hljs-comment\"># For simplicity, this file contains only settings considered important or</span>\n<span class=\"hljs-comment\"># commonly used. You can find more settings consulting the documentation:</span>\n<span class=\"hljs-comment\">#</span>\n<span class=\"hljs-comment\">#     https://doc.scrapy.org/en/latest/topics/settings.html</span>\n<span class=\"hljs-comment\">#     https://doc.scrapy.org/en/latest/topics/downloader-middleware.html</span>\n<span class=\"hljs-comment\">#     https://doc.scrapy.org/en/latest/topics/spider-middleware.html</span>\n\nBOT_NAME = <span class=\"hljs-string\">&apos;So&apos;</span>\n\nSPIDER_MODULES = [<span class=\"hljs-string\">&apos;So.spiders&apos;</span>]\nNEWSPIDER_MODULE = <span class=\"hljs-string\">&apos;So.spiders&apos;</span>\n\n\n<span class=\"hljs-comment\"># Crawl responsibly by identifying yourself (and your website) on the user-agent</span>\n<span class=\"hljs-comment\">#USER_AGENT = &apos;So (+http://www.yourdomain.com)&apos;</span>\n\n<span class=\"hljs-comment\"># Obey robots.txt rules</span>\nROBOTSTXT_OBEY = <span class=\"hljs-literal\">False</span>\n\n<span class=\"hljs-comment\"># Configure maximum concurrent requests performed by Scrapy (default: 16)</span>\n<span class=\"hljs-comment\">#CONCURRENT_REQUESTS = 32</span>\n\n<span class=\"hljs-comment\"># Configure a delay for requests for the same website (default: 0)</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/settings.html#download-delay</span>\n<span class=\"hljs-comment\"># See also autothrottle settings and docs</span>\nDOWNLOAD_DELAY = <span class=\"hljs-number\">0.1</span>\n<span class=\"hljs-comment\"># The download delay setting will honor only one of:</span>\n<span class=\"hljs-comment\">#CONCURRENT_REQUESTS_PER_DOMAIN = 16</span>\n<span class=\"hljs-comment\">#CONCURRENT_REQUESTS_PER_IP = 16</span>\n\n<span class=\"hljs-comment\"># Disable cookies (enabled by default)</span>\n<span class=\"hljs-comment\">#COOKIES_ENABLED = False</span>\n\n<span class=\"hljs-comment\"># Disable Telnet Console (enabled by default)</span>\n<span class=\"hljs-comment\">#TELNETCONSOLE_ENABLED = False</span>\n\n<span class=\"hljs-comment\"># Override the default request headers:</span>\nDEFAULT_REQUEST_HEADERS = {\n  <span class=\"hljs-string\">&apos;Accept&apos;</span>: <span class=\"hljs-string\">&apos;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&apos;</span>,\n  <span class=\"hljs-string\">&apos;Accept-Language&apos;</span>: <span class=\"hljs-string\">&apos;en&apos;</span>,\n  <span class=\"hljs-string\">&apos;User-Agent&apos;</span>: <span class=\"hljs-string\">&apos;Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36&apos;</span>,\n}\n\n<span class=\"hljs-comment\"># Enable or disable spider middlewares</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/spider-middleware.html</span>\n<span class=\"hljs-comment\">#SPIDER_MIDDLEWARES = {</span>\n<span class=\"hljs-comment\">#    &apos;So.middlewares.SoSpiderMiddleware&apos;: 543,</span>\n<span class=\"hljs-comment\">#}</span>\n\n<span class=\"hljs-comment\"># Enable or disable downloader middlewares</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/downloader-middleware.html</span>\n<span class=\"hljs-comment\">#DOWNLOADER_MIDDLEWARES = {</span>\n<span class=\"hljs-comment\">#    &apos;So.middlewares.SoDownloaderMiddleware&apos;: 543,</span>\n<span class=\"hljs-comment\">#}</span>\n\n<span class=\"hljs-comment\"># Enable or disable extensions</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/extensions.html</span>\n<span class=\"hljs-comment\">#EXTENSIONS = {</span>\n<span class=\"hljs-comment\">#    &apos;scrapy.extensions.telnet.TelnetConsole&apos;: None,</span>\n<span class=\"hljs-comment\">#}</span>\n\n<span class=\"hljs-comment\"># Configure item pipelines</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/item-pipeline.html</span>\nITEM_PIPELINES = {\n   <span class=\"hljs-string\">&apos;So.pipelines.SoPipeline&apos;</span>: <span class=\"hljs-number\">300</span>,\n}\n\n<span class=\"hljs-comment\"># Enable and configure the AutoThrottle extension (disabled by default)</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/autothrottle.html</span>\n<span class=\"hljs-comment\">#AUTOTHROTTLE_ENABLED = True</span>\n<span class=\"hljs-comment\"># The initial download delay</span>\n<span class=\"hljs-comment\">#AUTOTHROTTLE_START_DELAY = 5</span>\n<span class=\"hljs-comment\"># The maximum download delay to be set in case of high latencies</span>\n<span class=\"hljs-comment\">#AUTOTHROTTLE_MAX_DELAY = 60</span>\n<span class=\"hljs-comment\"># The average number of requests Scrapy should be sending in parallel to</span>\n<span class=\"hljs-comment\"># each remote server</span>\n<span class=\"hljs-comment\">#AUTOTHROTTLE_TARGET_CONCURRENCY = 1.0</span>\n<span class=\"hljs-comment\"># Enable showing throttling stats for every response received:</span>\n<span class=\"hljs-comment\">#AUTOTHROTTLE_DEBUG = False</span>\n\n<span class=\"hljs-comment\"># Enable and configure HTTP caching (disabled by default)</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/downloader-middleware.html#httpcache-middleware-settings</span>\n<span class=\"hljs-comment\">#HTTPCACHE_ENABLED = True</span>\n<span class=\"hljs-comment\">#HTTPCACHE_EXPIRATION_SECS = 0</span>\n<span class=\"hljs-comment\">#HTTPCACHE_DIR = &apos;httpcache&apos;</span>\n<span class=\"hljs-comment\">#HTTPCACHE_IGNORE_HTTP_CODES = []</span>\n<span class=\"hljs-comment\">#HTTPCACHE_STORAGE = &apos;scrapy.extensions.httpcache.FilesystemCacheStorage&apos;</span>\n\n<span class=\"hljs-comment\"># &#x6307;&#x5b9a;&#x56fe;&#x7247;&#x5b58;&#x50a8;&#x7684;&#x8def;&#x5f84;</span>\nIMAGES_STORE = <span class=\"hljs-string\">&apos;./images/&apos;</span>\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1165,1262"}}],"payload":{"tag":"h5","lines":"1006,1007"}},{"content":"So/So/spiders","children":[{"content":"<pre data-lines=\"1267,1294\"><code class=\"language-python\"><span class=\"hljs-comment\"># -*- coding: utf-8 -*-</span>\n<span class=\"hljs-keyword\">import</span> scrapy\n<span class=\"hljs-keyword\">import</span> json\n<span class=\"hljs-keyword\">from</span> ..items <span class=\"hljs-keyword\">import</span> SoItem\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">SoSpider</span>(scrapy.Spider):\n    name = <span class=\"hljs-string\">&apos;so&apos;</span>\n    allowed_domains = [<span class=\"hljs-string\">&apos;image.so.com&apos;</span>]\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">start_requests</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x91cd;&#x5199;&#x65b9;&#x6cd5;,&#x628a;&#x5730;&#x5740;&#x4ea4;&#x7ed9;&#x8c03;&#x5ea6;&#x5668;&quot;&quot;&quot;</span>\n        <span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(<span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">100</span>,<span class=\"hljs-number\">30</span>):\n            url = <span class=\"hljs-string\">&apos;https://image.so.com/zjl?ch=beauty&amp;sn={}&amp;listtype=new&amp;temp=1&apos;</span>.<span class=\"hljs-built_in\">format</span>(i)\n            <span class=\"hljs-keyword\">yield</span> scrapy.Request(url=url, callback=<span class=\"hljs-variable language_\">self</span>.parse)\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">parse</span>(<span class=\"hljs-params\">self, response</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x63d0;&#x53d6;&#x56fe;&#x7247;&#x94fe;&#x63a5;&quot;&quot;&quot;</span>\n        html = json.loads(response.text)\n        <span class=\"hljs-keyword\">for</span> img_dict <span class=\"hljs-keyword\">in</span> html[<span class=\"hljs-string\">&apos;list&apos;</span>]:\n            item = SoItem()\n            item[<span class=\"hljs-string\">&apos;img_url&apos;</span>] = img_dict[<span class=\"hljs-string\">&apos;qhimg_url&apos;</span>]\n            item[<span class=\"hljs-string\">&apos;img_title&apos;</span>] = img_dict[<span class=\"hljs-string\">&apos;title&apos;</span>]\n\n            <span class=\"hljs-keyword\">yield</span> item\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1267,1294"}}],"payload":{"tag":"h5","lines":"1265,1266"}}],"payload":{"tag":"h4","lines":"981,982"}},{"content":"Yd","children":[{"content":"Yd/Yd","children":[{"content":"<pre data-lines=\"1322,1338\"><code class=\"language-python\"><span class=\"hljs-comment\"># -*- coding: utf-8 -*-</span>\n\n<span class=\"hljs-comment\"># Define here the models for your scraped items</span>\n<span class=\"hljs-comment\">#</span>\n<span class=\"hljs-comment\"># See documentation in:</span>\n<span class=\"hljs-comment\"># https://doc.scrapy.org/en/latest/topics/items.html</span>\n\n<span class=\"hljs-keyword\">import</span> scrapy\n\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">YdItem</span>(scrapy.Item):\n    <span class=\"hljs-comment\"># &#x7ffb;&#x8bd1;&#x7ed3;&#x679c;</span>\n    result = scrapy.Field()\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1322,1338"}},{"content":"<pre data-lines=\"1339,1445\"><code class=\"language-python\"><span class=\"hljs-comment\"># -*- coding: utf-8 -*-</span>\n\n<span class=\"hljs-comment\"># Define here the models for your spider middleware</span>\n<span class=\"hljs-comment\">#</span>\n<span class=\"hljs-comment\"># See documentation in:</span>\n<span class=\"hljs-comment\"># https://doc.scrapy.org/en/latest/topics/spider-middleware.html</span>\n\n<span class=\"hljs-keyword\">from</span> scrapy <span class=\"hljs-keyword\">import</span> signals\n\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">YdSpiderMiddleware</span>(<span class=\"hljs-title class_ inherited__\">object</span>):\n    <span class=\"hljs-comment\"># Not all methods need to be defined. If a method is not defined,</span>\n    <span class=\"hljs-comment\"># scrapy acts as if the spider middleware does not modify the</span>\n    <span class=\"hljs-comment\"># passed objects.</span>\n\n<span class=\"hljs-meta\">    @classmethod</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">from_crawler</span>(<span class=\"hljs-params\">cls, crawler</span>):\n        <span class=\"hljs-comment\"># This method is used by Scrapy to create your spiders.</span>\n        s = cls()\n        crawler.signals.connect(s.spider_opened, signal=signals.spider_opened)\n        <span class=\"hljs-keyword\">return</span> s\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_spider_input</span>(<span class=\"hljs-params\">self, response, spider</span>):\n        <span class=\"hljs-comment\"># Called for each response that goes through the spider</span>\n        <span class=\"hljs-comment\"># middleware and into the spider.</span>\n\n        <span class=\"hljs-comment\"># Should return None or raise an exception.</span>\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">None</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_spider_output</span>(<span class=\"hljs-params\">self, response, result, spider</span>):\n        <span class=\"hljs-comment\"># Called with the results returned from the Spider, after</span>\n        <span class=\"hljs-comment\"># it has processed the response.</span>\n\n        <span class=\"hljs-comment\"># Must return an iterable of Request, dict or Item objects.</span>\n        <span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> result:\n            <span class=\"hljs-keyword\">yield</span> i\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_spider_exception</span>(<span class=\"hljs-params\">self, response, exception, spider</span>):\n        <span class=\"hljs-comment\"># Called when a spider or process_spider_input() method</span>\n        <span class=\"hljs-comment\"># (from other spider middleware) raises an exception.</span>\n\n        <span class=\"hljs-comment\"># Should return either None or an iterable of Response, dict</span>\n        <span class=\"hljs-comment\"># or Item objects.</span>\n        <span class=\"hljs-keyword\">pass</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_start_requests</span>(<span class=\"hljs-params\">self, start_requests, spider</span>):\n        <span class=\"hljs-comment\"># Called with the start requests of the spider, and works</span>\n        <span class=\"hljs-comment\"># similarly to the process_spider_output() method, except</span>\n        <span class=\"hljs-comment\"># that it doesn&#x2019;t have a response associated.</span>\n\n        <span class=\"hljs-comment\"># Must return only requests (not items).</span>\n        <span class=\"hljs-keyword\">for</span> r <span class=\"hljs-keyword\">in</span> start_requests:\n            <span class=\"hljs-keyword\">yield</span> r\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">spider_opened</span>(<span class=\"hljs-params\">self, spider</span>):\n        spider.logger.info(<span class=\"hljs-string\">&apos;Spider opened: %s&apos;</span> % spider.name)\n\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">YdDownloaderMiddleware</span>(<span class=\"hljs-title class_ inherited__\">object</span>):\n    <span class=\"hljs-comment\"># Not all methods need to be defined. If a method is not defined,</span>\n    <span class=\"hljs-comment\"># scrapy acts as if the downloader middleware does not modify the</span>\n    <span class=\"hljs-comment\"># passed objects.</span>\n\n<span class=\"hljs-meta\">    @classmethod</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">from_crawler</span>(<span class=\"hljs-params\">cls, crawler</span>):\n        <span class=\"hljs-comment\"># This method is used by Scrapy to create your spiders.</span>\n        s = cls()\n        crawler.signals.connect(s.spider_opened, signal=signals.spider_opened)\n        <span class=\"hljs-keyword\">return</span> s\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_request</span>(<span class=\"hljs-params\">self, request, spider</span>):\n        <span class=\"hljs-comment\"># Called for each request that goes through the downloader</span>\n        <span class=\"hljs-comment\"># middleware.</span>\n\n        <span class=\"hljs-comment\"># Must either:</span>\n        <span class=\"hljs-comment\"># - return None: continue processing this request</span>\n        <span class=\"hljs-comment\"># - or return a Response object</span>\n        <span class=\"hljs-comment\"># - or return a Request object</span>\n        <span class=\"hljs-comment\"># - or raise IgnoreRequest: process_exception() methods of</span>\n        <span class=\"hljs-comment\">#   installed downloader middleware will be called</span>\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">None</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_response</span>(<span class=\"hljs-params\">self, request, response, spider</span>):\n        <span class=\"hljs-comment\"># Called with the response returned from the downloader.</span>\n\n        <span class=\"hljs-comment\"># Must either;</span>\n        <span class=\"hljs-comment\"># - return a Response object</span>\n        <span class=\"hljs-comment\"># - return a Request object</span>\n        <span class=\"hljs-comment\"># - or raise IgnoreRequest</span>\n        <span class=\"hljs-keyword\">return</span> response\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_exception</span>(<span class=\"hljs-params\">self, request, exception, spider</span>):\n        <span class=\"hljs-comment\"># Called when a download handler or a process_request()</span>\n        <span class=\"hljs-comment\"># (from other downloader middleware) raises an exception.</span>\n\n        <span class=\"hljs-comment\"># Must either:</span>\n        <span class=\"hljs-comment\"># - return None: continue processing this exception</span>\n        <span class=\"hljs-comment\"># - return a Response object: stops process_exception() chain</span>\n        <span class=\"hljs-comment\"># - return a Request object: stops process_exception() chain</span>\n        <span class=\"hljs-keyword\">pass</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">spider_opened</span>(<span class=\"hljs-params\">self, spider</span>):\n        spider.logger.info(<span class=\"hljs-string\">&apos;Spider opened: %s&apos;</span> % spider.name)\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1339,1445"}},{"content":"<pre data-lines=\"1446,1461\"><code class=\"language-python\"><span class=\"hljs-comment\"># -*- coding: utf-8 -*-</span>\n\n<span class=\"hljs-comment\"># Define your item pipelines here</span>\n<span class=\"hljs-comment\">#</span>\n<span class=\"hljs-comment\"># Don&apos;t forget to add your pipeline to the ITEM_PIPELINES setting</span>\n<span class=\"hljs-comment\"># See: https://doc.scrapy.org/en/latest/topics/item-pipeline.html</span>\n\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">YdPipeline</span>(<span class=\"hljs-title class_ inherited__\">object</span>):\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_item</span>(<span class=\"hljs-params\">self, item, spider</span>):\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-built_in\">dict</span>(item))\n        <span class=\"hljs-keyword\">return</span> item\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1446,1461"}},{"content":"<pre data-lines=\"1462,1556\"><code class=\"language-python\"><span class=\"hljs-comment\"># -*- coding: utf-8 -*-</span>\n\n<span class=\"hljs-comment\"># Scrapy settings for Yd project</span>\n<span class=\"hljs-comment\">#</span>\n<span class=\"hljs-comment\"># For simplicity, this file contains only settings considered important or</span>\n<span class=\"hljs-comment\"># commonly used. You can find more settings consulting the documentation:</span>\n<span class=\"hljs-comment\">#</span>\n<span class=\"hljs-comment\">#     https://doc.scrapy.org/en/latest/topics/settings.html</span>\n<span class=\"hljs-comment\">#     https://doc.scrapy.org/en/latest/topics/downloader-middleware.html</span>\n<span class=\"hljs-comment\">#     https://doc.scrapy.org/en/latest/topics/spider-middleware.html</span>\n\nBOT_NAME = <span class=\"hljs-string\">&apos;Yd&apos;</span>\n\nSPIDER_MODULES = [<span class=\"hljs-string\">&apos;Yd.spiders&apos;</span>]\nNEWSPIDER_MODULE = <span class=\"hljs-string\">&apos;Yd.spiders&apos;</span>\n\n\n<span class=\"hljs-comment\"># Crawl responsibly by identifying yourself (and your website) on the user-agent</span>\n<span class=\"hljs-comment\">#USER_AGENT = &apos;Yd (+http://www.yourdomain.com)&apos;</span>\n\n<span class=\"hljs-comment\"># Obey robots.txt rules</span>\nROBOTSTXT_OBEY = <span class=\"hljs-literal\">False</span>\nLOG_LEVEL = <span class=\"hljs-string\">&apos;WARNING&apos;</span>\n<span class=\"hljs-comment\"># Configure maximum concurrent requests performed by Scrapy (default: 16)</span>\n<span class=\"hljs-comment\">#CONCURRENT_REQUESTS = 32</span>\n\n<span class=\"hljs-comment\"># Configure a delay for requests for the same website (default: 0)</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/settings.html#download-delay</span>\n<span class=\"hljs-comment\"># See also autothrottle settings and docs</span>\n<span class=\"hljs-comment\">#DOWNLOAD_DELAY = 3</span>\n<span class=\"hljs-comment\"># The download delay setting will honor only one of:</span>\n<span class=\"hljs-comment\">#CONCURRENT_REQUESTS_PER_DOMAIN = 16</span>\n<span class=\"hljs-comment\">#CONCURRENT_REQUESTS_PER_IP = 16</span>\n\n<span class=\"hljs-comment\"># Disable cookies (enabled by default)</span>\n<span class=\"hljs-comment\"># cookie&#x9ed8;&#x8ba4;&#x7981;&#x7528;&#xff01;&#xff01;&#xff01; &#x53d6;&#x6d88;&#x6ce8;&#x91ca;&#x540e;&#x542f;&#x7528; (True|False&#x90fd;&#x4e3a;&#x542f;&#x7528;)</span>\nCOOKIES_ENABLED = <span class=\"hljs-literal\">True</span>\n\n<span class=\"hljs-comment\"># Disable Telnet Console (enabled by default)</span>\n<span class=\"hljs-comment\">#TELNETCONSOLE_ENABLED = False</span>\n\n<span class=\"hljs-comment\"># Override the default request headers:</span>\nDEFAULT_REQUEST_HEADERS = {\n    <span class=\"hljs-string\">&quot;Referer&quot;</span>: <span class=\"hljs-string\">&quot;http://fanyi.youdao.com/&quot;</span>,\n    <span class=\"hljs-string\">&quot;User-Agent&quot;</span>: <span class=\"hljs-string\">&quot;Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36&quot;</span>,\n}\n\n<span class=\"hljs-comment\"># Enable or disable spider middlewares</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/spider-middleware.html</span>\n<span class=\"hljs-comment\">#SPIDER_MIDDLEWARES = {</span>\n<span class=\"hljs-comment\">#    &apos;Yd.middlewares.YdSpiderMiddleware&apos;: 543,</span>\n<span class=\"hljs-comment\">#}</span>\n\n<span class=\"hljs-comment\"># Enable or disable downloader middlewares</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/downloader-middleware.html</span>\n<span class=\"hljs-comment\">#DOWNLOADER_MIDDLEWARES = {</span>\n<span class=\"hljs-comment\">#    &apos;Yd.middlewares.YdDownloaderMiddleware&apos;: 543,</span>\n<span class=\"hljs-comment\">#}</span>\n\n<span class=\"hljs-comment\"># Enable or disable extensions</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/extensions.html</span>\n<span class=\"hljs-comment\">#EXTENSIONS = {</span>\n<span class=\"hljs-comment\">#    &apos;scrapy.extensions.telnet.TelnetConsole&apos;: None,</span>\n<span class=\"hljs-comment\">#}</span>\n\n<span class=\"hljs-comment\"># Configure item pipelines</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/item-pipeline.html</span>\nITEM_PIPELINES = {\n   <span class=\"hljs-string\">&apos;Yd.pipelines.YdPipeline&apos;</span>: <span class=\"hljs-number\">300</span>,\n}\n\n<span class=\"hljs-comment\"># Enable and configure the AutoThrottle extension (disabled by default)</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/autothrottle.html</span>\n<span class=\"hljs-comment\">#AUTOTHROTTLE_ENABLED = True</span>\n<span class=\"hljs-comment\"># The initial download delay</span>\n<span class=\"hljs-comment\">#AUTOTHROTTLE_START_DELAY = 5</span>\n<span class=\"hljs-comment\"># The maximum download delay to be set in case of high latencies</span>\n<span class=\"hljs-comment\">#AUTOTHROTTLE_MAX_DELAY = 60</span>\n<span class=\"hljs-comment\"># The average number of requests Scrapy should be sending in parallel to</span>\n<span class=\"hljs-comment\"># each remote server</span>\n<span class=\"hljs-comment\">#AUTOTHROTTLE_TARGET_CONCURRENCY = 1.0</span>\n<span class=\"hljs-comment\"># Enable showing throttling stats for every response received:</span>\n<span class=\"hljs-comment\">#AUTOTHROTTLE_DEBUG = False</span>\n\n<span class=\"hljs-comment\"># Enable and configure HTTP caching (disabled by default)</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/downloader-middleware.html#httpcache-middleware-settings</span>\n<span class=\"hljs-comment\">#HTTPCACHE_ENABLED = True</span>\n<span class=\"hljs-comment\">#HTTPCACHE_EXPIRATION_SECS = 0</span>\n<span class=\"hljs-comment\">#HTTPCACHE_DIR = &apos;httpcache&apos;</span>\n<span class=\"hljs-comment\">#HTTPCACHE_IGNORE_HTTP_CODES = []</span>\n<span class=\"hljs-comment\">#HTTPCACHE_STORAGE = &apos;scrapy.extensions.httpcache.FilesystemCacheStorage&apos;</span>\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1462,1556"}}],"payload":{"tag":"h5","lines":"1320,1321"}},{"content":"Yd/Yd/spiders","children":[{"content":"<pre data-lines=\"1561,1626\"><code class=\"language-python\"><span class=\"hljs-comment\"># -*- coding: utf-8 -*-</span>\n<span class=\"hljs-keyword\">import</span> scrapy\n<span class=\"hljs-keyword\">import</span> time\n<span class=\"hljs-keyword\">import</span> json\n<span class=\"hljs-keyword\">import</span> random\n<span class=\"hljs-keyword\">from</span> hashlib <span class=\"hljs-keyword\">import</span> md5\n<span class=\"hljs-keyword\">from</span> ..items <span class=\"hljs-keyword\">import</span> YdItem\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">YdSpider</span>(scrapy.Spider):\n    name = <span class=\"hljs-string\">&apos;yd&apos;</span>\n    allowed_domains = [<span class=\"hljs-string\">&apos;fanyi.youdao.com&apos;</span>]\n    post_url = <span class=\"hljs-string\">&apos;http://fanyi.youdao.com/translate_o?smartresult=dict&amp;smartresult=rule&apos;</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">start_requests</span>(<span class=\"hljs-params\">self</span>):\n        word = <span class=\"hljs-built_in\">input</span>(<span class=\"hljs-string\">&apos;&#x8bf7;&#x8f93;&#x5165;&#x8981;&#x7ffb;&#x8bd1;&#x7684;&#x5355;&#x8bcd;:&apos;</span>)\n        ts,salt,sign = <span class=\"hljs-variable language_\">self</span>.get_ts_salt_sign(word)\n        formdata = {\n            <span class=\"hljs-string\">&quot;i&quot;</span>: word,\n            <span class=\"hljs-string\">&quot;from&quot;</span>: <span class=\"hljs-string\">&quot;AUTO&quot;</span>,\n            <span class=\"hljs-string\">&quot;to&quot;</span>: <span class=\"hljs-string\">&quot;AUTO&quot;</span>,\n            <span class=\"hljs-string\">&quot;smartresult&quot;</span>: <span class=\"hljs-string\">&quot;dict&quot;</span>,\n            <span class=\"hljs-string\">&quot;client&quot;</span>: <span class=\"hljs-string\">&quot;fanyideskweb&quot;</span>,\n            <span class=\"hljs-string\">&quot;salt&quot;</span>: salt,\n            <span class=\"hljs-string\">&quot;sign&quot;</span>: sign,\n            <span class=\"hljs-string\">&quot;ts&quot;</span>: ts,\n            <span class=\"hljs-string\">&quot;bv&quot;</span>: <span class=\"hljs-string\">&quot;82ac0fd3b5f5289bb79af17e1f202a1e&quot;</span>,\n            <span class=\"hljs-string\">&quot;doctype&quot;</span>: <span class=\"hljs-string\">&quot;json&quot;</span>,\n            <span class=\"hljs-string\">&quot;version&quot;</span>: <span class=\"hljs-string\">&quot;2.1&quot;</span>,\n            <span class=\"hljs-string\">&quot;keyfrom&quot;</span>: <span class=\"hljs-string\">&quot;fanyi.web&quot;</span>,\n            <span class=\"hljs-string\">&quot;action&quot;</span>: <span class=\"hljs-string\">&quot;FY_BY_REALTlME&quot;</span>,\n        }\n        cookies = <span class=\"hljs-variable language_\">self</span>.get_cookies()\n        <span class=\"hljs-keyword\">yield</span> scrapy.FormRequest(url=<span class=\"hljs-variable language_\">self</span>.post_url, formdata=formdata, callback=<span class=\"hljs-variable language_\">self</span>.parse, cookies=cookies)\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">get_ts_salt_sign</span>(<span class=\"hljs-params\">self,word</span>):\n        <span class=\"hljs-comment\"># &#x529f;&#x80fd;&#x51fd;&#x6570;&#xff1a;&#x83b7;&#x53d6; ts + salt + sign</span>\n        ts = <span class=\"hljs-built_in\">str</span>(<span class=\"hljs-built_in\">int</span>(time.time() * <span class=\"hljs-number\">1000</span>))\n        salt = ts + <span class=\"hljs-built_in\">str</span>(random.randint(<span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">9</span>))\n        string = <span class=\"hljs-string\">&quot;fanyideskweb&quot;</span> + word + salt + <span class=\"hljs-string\">&quot;n%A-rKaT5fb[Gy?;N5@Tj&quot;</span>\n        s = md5()\n        s.update(string.encode())\n        sign = s.hexdigest()\n\n        <span class=\"hljs-keyword\">return</span> ts,salt,sign\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">get_cookies</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x5904;&#x7406;cookies&#x4e3a;&#x5b57;&#x5178;&quot;&quot;&quot;</span>\n        s = <span class=\"hljs-string\">&apos;DICT_UGC=be3af0da19b5c5e6aa4e17bd8d90b28a|; OUTFOX_SEARCH_USER_ID=-1116822587@101.30.19.86; JSESSIONID=abcFhgsjM3GXwcIUyl8dx; OUTFOX_SEARCH_USER_ID_NCOO=627961735.004065; SESSION_FROM_COOKIE=unknown; ___rl__test__cookies=1584782441965&apos;</span>\n        cookies = {}\n        <span class=\"hljs-keyword\">for</span> kv <span class=\"hljs-keyword\">in</span> s.split(<span class=\"hljs-string\">&apos;; &apos;</span>):\n            key = kv.split(<span class=\"hljs-string\">&apos;=&apos;</span>)[<span class=\"hljs-number\">0</span>]\n            value = kv.split(<span class=\"hljs-string\">&apos;=&apos;</span>)[<span class=\"hljs-number\">1</span>]\n            cookies[key] = value\n\n        <span class=\"hljs-keyword\">return</span> cookies\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">parse</span>(<span class=\"hljs-params\">self, response</span>):\n        html = json.loads(response.text)\n        item = YdItem()\n        item[<span class=\"hljs-string\">&apos;result&apos;</span>] = html[<span class=\"hljs-string\">&apos;translateResult&apos;</span>][<span class=\"hljs-number\">0</span>][<span class=\"hljs-number\">0</span>][<span class=\"hljs-string\">&apos;tgt&apos;</span>]\n\n        <span class=\"hljs-keyword\">yield</span> item\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1561,1626"}}],"payload":{"tag":"h5","lines":"1559,1560"}}],"payload":{"tag":"h4","lines":"1295,1296"}}],"payload":{"tag":"h3","lines":"0,1"}},{})</script>
</body>
</html>
