<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets@11.11.1/styles/default.min.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.18.10/dist/browser/index.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/index.js"></script><script>(r => {
              setTimeout(r);
            })(function renderToolbar() {
  const {
    markmap,
    mm
  } = window;
  const {
    el
  } = markmap.Toolbar.create(mm);
  el.setAttribute('style', 'position:absolute;bottom:20px;right:20px');
  document.body.append(el);
})</script><script>((getMarkmap, getOptions, root2, jsonOptions) => {
              const markmap = getMarkmap();
              window.mm = markmap.Markmap.create(
                "svg#mindmap",
                (getOptions || markmap.deriveOptions)(jsonOptions),
                root2
              );
            })(() => window.markmap,null,{"content":"directive&#x6307;&#x4ee4;&#x76f8;&#x5173;","children":[{"content":"&#x6307;&#x4ee4;&#x7684;&#x58f0;&#x660e;&#x5468;&#x671f;&#x94a9;&#x5b50;","children":[{"content":"<pre data-lines=\"3,6\"><code data-lines=\"3,6\">vue3&#x6307;&#x4ee4;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"3,6"}},{"content":"<pre data-lines=\"8,31\"><code class=\"language-js\"><span class=\"hljs-keyword\">const</span> myDirective = {\n  <span class=\"hljs-comment\">// &#x5728;&#x7ed1;&#x5b9a;&#x5143;&#x7d20;&#x7684; attribute &#x524d;</span>\n  <span class=\"hljs-comment\">// &#x6216;&#x4e8b;&#x4ef6;&#x76d1;&#x542c;&#x5668;&#x5e94;&#x7528;&#x524d;&#x8c03;&#x7528;</span>\n  <span class=\"hljs-title function_\">created</span>(<span class=\"hljs-params\">el, binding, vnode, prevVnode</span>) {\n    <span class=\"hljs-comment\">// &#x4e0b;&#x9762;&#x4f1a;&#x4ecb;&#x7ecd;&#x5404;&#x4e2a;&#x53c2;&#x6570;&#x7684;&#x7ec6;&#x8282;</span>\n  },\n  <span class=\"hljs-comment\">// &#x5728;&#x5143;&#x7d20;&#x88ab;&#x63d2;&#x5165;&#x5230; DOM &#x524d;&#x8c03;&#x7528;</span>\n  <span class=\"hljs-title function_\">beforeMount</span>(<span class=\"hljs-params\">el, binding, vnode, prevVnode</span>) {},\n  <span class=\"hljs-comment\">// &#x5728;&#x7ed1;&#x5b9a;&#x5143;&#x7d20;&#x7684;&#x7236;&#x7ec4;&#x4ef6;</span>\n  <span class=\"hljs-comment\">// &#x53ca;&#x4ed6;&#x81ea;&#x5df1;&#x7684;&#x6240;&#x6709;&#x5b50;&#x8282;&#x70b9;&#x90fd;&#x6302;&#x8f7d;&#x5b8c;&#x6210;&#x540e;&#x8c03;&#x7528;</span>\n  <span class=\"hljs-title function_\">mounted</span>(<span class=\"hljs-params\">el, binding, vnode, prevVnode</span>) {},\n  <span class=\"hljs-comment\">// &#x7ed1;&#x5b9a;&#x5143;&#x7d20;&#x7684;&#x7236;&#x7ec4;&#x4ef6;&#x66f4;&#x65b0;&#x524d;&#x8c03;&#x7528;</span>\n  <span class=\"hljs-title function_\">beforeUpdate</span>(<span class=\"hljs-params\">el, binding, vnode, prevVnode</span>) {},\n  <span class=\"hljs-comment\">// &#x5728;&#x7ed1;&#x5b9a;&#x5143;&#x7d20;&#x7684;&#x7236;&#x7ec4;&#x4ef6;</span>\n  <span class=\"hljs-comment\">// &#x53ca;&#x4ed6;&#x81ea;&#x5df1;&#x7684;&#x6240;&#x6709;&#x5b50;&#x8282;&#x70b9;&#x90fd;&#x66f4;&#x65b0;&#x540e;&#x8c03;&#x7528;</span>\n  <span class=\"hljs-title function_\">updated</span>(<span class=\"hljs-params\">el, binding, vnode, prevVnode</span>) {},\n  <span class=\"hljs-comment\">// &#x7ed1;&#x5b9a;&#x5143;&#x7d20;&#x7684;&#x7236;&#x7ec4;&#x4ef6;&#x5378;&#x8f7d;&#x524d;&#x8c03;&#x7528;</span>\n  <span class=\"hljs-title function_\">beforeUnmount</span>(<span class=\"hljs-params\">el, binding, vnode, prevVnode</span>) {},\n  <span class=\"hljs-comment\">// &#x7ed1;&#x5b9a;&#x5143;&#x7d20;&#x7684;&#x7236;&#x7ec4;&#x4ef6;&#x5378;&#x8f7d;&#x540e;&#x8c03;&#x7528;</span>\n  <span class=\"hljs-title function_\">unmounted</span>(<span class=\"hljs-params\">el, binding, vnode, prevVnode</span>) {}\n}\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"8,31"}},{"content":"<pre data-lines=\"32,35\"><code data-lines=\"32,35\">vue2&#x6307;&#x4ee4;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"32,35"}},{"content":"<pre data-lines=\"37,53\"><code class=\"language-js\">myDirective={\n\t<span class=\"hljs-comment\">// &#x53ea;&#x8c03;&#x7528;&#x4e00;&#x6b21;,&#x6307;&#x5b9a;&#x7b2c;&#x4e00;&#x6b21;&#x7ed1;&#x5b9a;&#x5230;&#x5143;&#x7d20;&#x65f6;&#x8c03;&#x7528;</span>\n\t<span class=\"hljs-comment\">// &#x5728;&#x8fd9;&#x91cc;&#x53ef;&#x4ee5;&#x8fdb;&#x884c;&#x4e00;&#x6b21;&#x6027;&#x521d;&#x59cb;&#x5316;&#x8bbe;&#x7f6e;</span>\n\t<span class=\"hljs-title function_\">bind</span>(<span class=\"hljs-params\">el,binding,vnode,oldValue</span>){},\n\t<span class=\"hljs-comment\">// &#x88ab;&#x7ed1;&#x5b9a;&#x5143;&#x7d20;&#x63d2;&#x5165;&#x7236;&#x8282;&#x70b9;&#x65f6;&#x8c03;&#x7528;</span>\n\t<span class=\"hljs-comment\">// &#x4ec5;&#x4fdd;&#x8bc1;&#x7236;&#x8282;&#x70b9;&#x5b58;&#x5728;,&#x4f46;&#x4e0d;&#x4e00;&#x5b9a;&#x5df2;&#x88ab;&#x63d2;&#x5165;&#x6587;&#x6863;&#x4e2d;</span>\n\t<span class=\"hljs-title function_\">inserted</span>(<span class=\"hljs-params\">el,binding,vnode,oldValue</span>){},\n\t<span class=\"hljs-comment\">// &#x6240;&#x6709;&#x7684;Vnode&#x66f4;&#x65b0;&#x65f6;&#x8c03;&#x7528;</span>\n\t<span class=\"hljs-title function_\">update</span>(<span class=\"hljs-params\">el,binding,vnode,oldValue</span>){},\n\t<span class=\"hljs-comment\">// &#x6307;&#x4ee4;&#x6240;&#x5728;&#x7ec4;&#x4ef6;&#x7684;Vnode&#x673a;&#x5668;&#x5b50;Vnode&#x5168;&#x90e8;&#x66f4;&#x65b0;&#x540e;&#x8c03;&#x7528;</span>\n\t<span class=\"hljs-title function_\">componentUpdated</span>(<span class=\"hljs-params\">el,binding,vnode,oldValue</span>){},\n\t<span class=\"hljs-comment\">// &#x53ea;&#x8c03;&#x7528;&#x4e00;&#x6b21;,&#x6307;&#x4ee4;&#x4e0e;&#x5143;&#x7d20;&#x89e3;&#x7ed1;&#x65f6;&#x8c03;&#x7528;</span>\n\t<span class=\"hljs-title function_\">unbind</span>(<span class=\"hljs-params\">el,binding,vnode,oldValue</span>){}\n}\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"37,53"}}],"payload":{"tag":"h2","lines":"1,2"}},{"content":"&#x58f0;&#x660e;&#x5468;&#x671f;&#x94a9;&#x5b50;&#x53c2;&#x6570;","children":[{"content":"<pre data-lines=\"54,57\"><code data-lines=\"54,57\">vue3&#x94a9;&#x5b50;&#x53c2;&#x6570;&#x4ecb;&#x7ecd;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"54,57"}},{"content":"<pre data-lines=\"59,89\"><code class=\"language-js\">&#x6307;&#x4ee4;&#x7684;&#x94a9;&#x5b50;&#x4f1a;&#x4f20;&#x9012;&#x4ee5;&#x4e0b;&#x51e0;&#x79cd;&#x53c2;&#x6570;&#xff1a;\n\nel&#xff1a;&#x6307;&#x4ee4;&#x7ed1;&#x5b9a;&#x5230;&#x7684;&#x5143;&#x7d20;&#x3002;&#x8fd9;&#x53ef;&#x4ee5;&#x7528;&#x4e8e;&#x76f4;&#x63a5;&#x64cd;&#x4f5c; <span class=\"hljs-variable constant_\">DOM</span>&#x3002;\n\nbinding&#xff1a;&#x4e00;&#x4e2a;&#x5bf9;&#x8c61;&#xff0c;&#x5305;&#x542b;&#x4ee5;&#x4e0b;&#x5c5e;&#x6027;&#x3002;\n\nvalue&#xff1a;&#x4f20;&#x9012;&#x7ed9;&#x6307;&#x4ee4;&#x7684;&#x503c;&#x3002;&#x4f8b;&#x5982;&#x5728; v-my-directive=<span class=\"hljs-string\">&quot;1 + 1&quot;</span> &#x4e2d;&#xff0c;&#x503c;&#x662f; <span class=\"hljs-number\">2</span>&#x3002;\noldValue&#xff1a;&#x4e4b;&#x524d;&#x7684;&#x503c;&#xff0c;&#x4ec5;&#x5728; beforeUpdate &#x548c; updated &#x4e2d;&#x53ef;&#x7528;&#x3002;&#x65e0;&#x8bba;&#x503c;&#x662f;&#x5426;&#x66f4;&#x6539;&#xff0c;&#x5b83;&#x90fd;&#x53ef;&#x7528;&#x3002;\narg&#xff1a;&#x4f20;&#x9012;&#x7ed9;&#x6307;&#x4ee4;&#x7684;&#x53c2;&#x6570; (&#x5982;&#x679c;&#x6709;&#x7684;&#x8bdd;)&#x3002;&#x4f8b;&#x5982;&#x5728; v-my-<span class=\"hljs-attr\">directive</span>:foo &#x4e2d;&#xff0c;&#x53c2;&#x6570;&#x662f; <span class=\"hljs-string\">&quot;foo&quot;</span>&#x3002;\nmodifiers&#xff1a;&#x4e00;&#x4e2a;&#x5305;&#x542b;&#x4fee;&#x9970;&#x7b26;&#x7684;&#x5bf9;&#x8c61; (&#x5982;&#x679c;&#x6709;&#x7684;&#x8bdd;)&#x3002;&#x4f8b;&#x5982;&#x5728; v-my-directive.<span class=\"hljs-property\">foo</span>.<span class=\"hljs-property\">bar</span> &#x4e2d;&#xff0c;&#x4fee;&#x9970;&#x7b26;&#x5bf9;&#x8c61;&#x662f; { <span class=\"hljs-attr\">foo</span>: <span class=\"hljs-literal\">true</span>, <span class=\"hljs-attr\">bar</span>: <span class=\"hljs-literal\">true</span> }&#x3002;\ninstance&#xff1a;&#x4f7f;&#x7528;&#x8be5;&#x6307;&#x4ee4;&#x7684;&#x7ec4;&#x4ef6;&#x5b9e;&#x4f8b;&#x3002;\ndir&#xff1a;&#x6307;&#x4ee4;&#x7684;&#x5b9a;&#x4e49;&#x5bf9;&#x8c61;&#x3002;\nvnode&#xff1a;&#x4ee3;&#x8868;&#x7ed1;&#x5b9a;&#x5143;&#x7d20;&#x7684;&#x5e95;&#x5c42; <span class=\"hljs-title class_\">VNode</span>&#x3002;\n\nprevNode&#xff1a;&#x4e4b;&#x524d;&#x7684;&#x6e32;&#x67d3;&#x4e2d;&#x4ee3;&#x8868;&#x6307;&#x4ee4;&#x6240;&#x7ed1;&#x5b9a;&#x5143;&#x7d20;&#x7684; <span class=\"hljs-title class_\">VNode</span>&#x3002;&#x4ec5;&#x5728; beforeUpdate &#x548c; updated &#x94a9;&#x5b50;&#x4e2d;&#x53ef;&#x7528;&#x3002;\n\n&#x4e3e;&#x4f8b;&#x6765;&#x8bf4;&#xff0c;&#x50cf;&#x4e0b;&#x9762;&#x8fd9;&#x6837;&#x4f7f;&#x7528;&#x6307;&#x4ee4;&#xff1a;\n\n&lt;div v-<span class=\"hljs-attr\">example</span>:foo.<span class=\"hljs-property\">bar</span>=<span class=\"hljs-string\">&quot;baz&quot;</span>&gt;\n\n{\n  <span class=\"hljs-attr\">arg</span>: <span class=\"hljs-string\">&apos;foo&apos;</span>,\n  <span class=\"hljs-attr\">modifiers</span>: { <span class=\"hljs-attr\">bar</span>: <span class=\"hljs-literal\">true</span> },\n  <span class=\"hljs-attr\">value</span>: <span class=\"hljs-comment\">/* `baz` &#x7684;&#x503c; */</span>,\n  <span class=\"hljs-attr\">oldValue</span>: <span class=\"hljs-comment\">/* &#x4e0a;&#x4e00;&#x6b21;&#x66f4;&#x65b0;&#x65f6; `baz` &#x7684;&#x503c; */</span>\n}\n\n&lt;div v-<span class=\"hljs-attr\">example</span>:[arg]=<span class=\"hljs-string\">&quot;value&quot;</span>&gt;&lt;/div&gt;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"59,89"}},{"content":"<pre data-lines=\"90,93\"><code data-lines=\"90,93\">vue2&#x94a9;&#x5b50;&#x53c2;&#x6570;&#x4ecb;&#x7ecd;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"90,93"}},{"content":"<pre data-lines=\"95,109\"><code class=\"language-js\">&#x6307;&#x4ee4;&#x94a9;&#x5b50;&#x51fd;&#x6570;&#x4f1a;&#x88ab;&#x4f20;&#x5165;&#x4ee5;&#x4e0b;&#x53c2;&#x6570;&#xff1a;\n\nel&#xff1a;&#x6307;&#x4ee4;&#x6240;&#x7ed1;&#x5b9a;&#x7684;&#x5143;&#x7d20;&#xff0c;&#x53ef;&#x4ee5;&#x7528;&#x6765;&#x76f4;&#x63a5;&#x64cd;&#x4f5c; <span class=\"hljs-variable constant_\">DOM</span>&#x3002;\nbinding&#xff1a;&#x4e00;&#x4e2a;&#x5bf9;&#x8c61;&#xff0c;&#x5305;&#x542b;&#x4ee5;&#x4e0b; property&#xff1a;\nname&#xff1a;&#x6307;&#x4ee4;&#x540d;&#xff0c;&#x4e0d;&#x5305;&#x62ec; v- &#x524d;&#x7f00;&#x3002;\nvalue&#xff1a;&#x6307;&#x4ee4;&#x7684;&#x7ed1;&#x5b9a;&#x503c;&#xff0c;&#x4f8b;&#x5982;&#xff1a;v-my-directive=<span class=\"hljs-string\">&quot;1 + 1&quot;</span> &#x4e2d;&#xff0c;&#x7ed1;&#x5b9a;&#x503c;&#x4e3a; <span class=\"hljs-number\">2</span>&#x3002;\noldValue&#xff1a;&#x6307;&#x4ee4;&#x7ed1;&#x5b9a;&#x7684;&#x524d;&#x4e00;&#x4e2a;&#x503c;&#xff0c;&#x4ec5;&#x5728; update &#x548c; componentUpdated &#x94a9;&#x5b50;&#x4e2d;&#x53ef;&#x7528;&#x3002;&#x65e0;&#x8bba;&#x503c;&#x662f;&#x5426;&#x6539;&#x53d8;&#x90fd;&#x53ef;&#x7528;&#x3002;\nexpression&#xff1a;&#x5b57;&#x7b26;&#x4e32;&#x5f62;&#x5f0f;&#x7684;&#x6307;&#x4ee4;&#x8868;&#x8fbe;&#x5f0f;&#x3002;&#x4f8b;&#x5982; v-my-directive=<span class=\"hljs-string\">&quot;1 + 1&quot;</span> &#x4e2d;&#xff0c;&#x8868;&#x8fbe;&#x5f0f;&#x4e3a; <span class=\"hljs-string\">&quot;1 + 1&quot;</span>&#x3002;\narg&#xff1a;&#x4f20;&#x7ed9;&#x6307;&#x4ee4;&#x7684;&#x53c2;&#x6570;&#xff0c;&#x53ef;&#x9009;&#x3002;&#x4f8b;&#x5982; v-my-<span class=\"hljs-attr\">directive</span>:foo &#x4e2d;&#xff0c;&#x53c2;&#x6570;&#x4e3a; <span class=\"hljs-string\">&quot;foo&quot;</span>&#x3002;\nmodifiers&#xff1a;&#x4e00;&#x4e2a;&#x5305;&#x542b;&#x4fee;&#x9970;&#x7b26;&#x7684;&#x5bf9;&#x8c61;&#x3002;&#x4f8b;&#x5982;&#xff1a;v-my-directive.<span class=\"hljs-property\">foo</span>.<span class=\"hljs-property\">bar</span> &#x4e2d;&#xff0c;&#x4fee;&#x9970;&#x7b26;&#x5bf9;&#x8c61;&#x4e3a; { <span class=\"hljs-attr\">foo</span>: <span class=\"hljs-literal\">true</span>, <span class=\"hljs-attr\">bar</span>: <span class=\"hljs-literal\">true</span> }&#x3002;\nvnode&#xff1a;<span class=\"hljs-title class_\">Vue</span> &#x7f16;&#x8bd1;&#x751f;&#x6210;&#x7684;&#x865a;&#x62df;&#x8282;&#x70b9;&#x3002;&#x79fb;&#x6b65; <span class=\"hljs-title class_\">VNode</span> <span class=\"hljs-variable constant_\">API</span> &#x6765;&#x4e86;&#x89e3;&#x66f4;&#x591a;&#x8be6;&#x60c5;&#x3002;\noldVnode&#xff1a;&#x4e0a;&#x4e00;&#x4e2a;&#x865a;&#x62df;&#x8282;&#x70b9;&#xff0c;&#x4ec5;&#x5728; update &#x548c; componentUpdated &#x94a9;&#x5b50;&#x4e2d;&#x53ef;&#x7528;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"95,109"}},{"content":"<pre data-lines=\"110,141\"><code class=\"language-js\"><span class=\"hljs-comment\">/**\n * &#x64cd;&#x4f5c;&#x6743;&#x9650;&#x5904;&#x7406;\n *\n */</span>\n\n<span class=\"hljs-keyword\">import</span> store <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&apos;@/store&apos;</span>\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">default</span> {\n  <span class=\"hljs-title function_\">inserted</span>(<span class=\"hljs-params\">el, binding, vnode</span>) {\n    <span class=\"hljs-keyword\">const</span> { value } = binding\n    <span class=\"hljs-keyword\">const</span> all_permission = <span class=\"hljs-string\">&apos;*:*:*&apos;</span>\n    <span class=\"hljs-keyword\">const</span> permissions = store.<span class=\"hljs-property\">getters</span> &amp;&amp; store.<span class=\"hljs-property\">getters</span>.<span class=\"hljs-property\">permissions</span>\n\n    <span class=\"hljs-keyword\">if</span> (value &amp;&amp; value <span class=\"hljs-keyword\">instanceof</span> <span class=\"hljs-title class_\">Array</span> &amp;&amp; value.<span class=\"hljs-property\">length</span> &gt; <span class=\"hljs-number\">0</span>) {\n      <span class=\"hljs-keyword\">const</span> permissionFlag = value\n\n      <span class=\"hljs-keyword\">const</span> hasPermissions = permissions.<span class=\"hljs-title function_\">some</span>(<span class=\"hljs-function\"><span class=\"hljs-params\">permission</span> =&gt;</span> {\n        <span class=\"hljs-keyword\">return</span> all_permission === permission || permissionFlag.<span class=\"hljs-title function_\">includes</span>(permission)\n      })\n\n      <span class=\"hljs-keyword\">if</span> (!hasPermissions) {\n        el.<span class=\"hljs-property\">parentNode</span> &amp;&amp; el.<span class=\"hljs-property\">parentNode</span>.<span class=\"hljs-title function_\">removeChild</span>(el)\n      }\n    } <span class=\"hljs-keyword\">else</span> {\n      <span class=\"hljs-keyword\">throw</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Error</span>(<span class=\"hljs-string\">`&#x8bf7;&#x8bbe;&#x7f6e;&#x64cd;&#x4f5c;&#x6743;&#x9650;&#x6807;&#x7b7e;&#x503c;`</span>)\n    }\n  }\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"110,141"}},{"content":"<pre data-lines=\"142,173\"><code class=\"language-js\"><span class=\"hljs-comment\">/**\n * &#x89d2;&#x8272;&#x6743;&#x9650;&#x5904;&#x7406;\n *\n */</span>\n\n<span class=\"hljs-keyword\">import</span> store <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&apos;@/store&apos;</span>\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">default</span> {\n  <span class=\"hljs-title function_\">inserted</span>(<span class=\"hljs-params\">el, binding, vnode</span>) {\n    <span class=\"hljs-keyword\">const</span> { value } = binding\n    <span class=\"hljs-keyword\">const</span> super_admin = <span class=\"hljs-string\">&apos;admin&apos;</span>\n    <span class=\"hljs-keyword\">const</span> roles = store.<span class=\"hljs-property\">getters</span> &amp;&amp; store.<span class=\"hljs-property\">getters</span>.<span class=\"hljs-property\">roles</span>\n\n    <span class=\"hljs-keyword\">if</span> (value &amp;&amp; value <span class=\"hljs-keyword\">instanceof</span> <span class=\"hljs-title class_\">Array</span> &amp;&amp; value.<span class=\"hljs-property\">length</span> &gt; <span class=\"hljs-number\">0</span>) {\n      <span class=\"hljs-keyword\">const</span> roleFlag = value\n\n      <span class=\"hljs-keyword\">const</span> hasRole = roles.<span class=\"hljs-title function_\">some</span>(<span class=\"hljs-function\"><span class=\"hljs-params\">role</span> =&gt;</span> {\n        <span class=\"hljs-keyword\">return</span> super_admin === role || roleFlag.<span class=\"hljs-title function_\">includes</span>(role)\n      })\n\n      <span class=\"hljs-keyword\">if</span> (!hasRole) {\n        el.<span class=\"hljs-property\">parentNode</span> &amp;&amp; el.<span class=\"hljs-property\">parentNode</span>.<span class=\"hljs-title function_\">removeChild</span>(el)\n      }\n    } <span class=\"hljs-keyword\">else</span> {\n      <span class=\"hljs-keyword\">throw</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Error</span>(<span class=\"hljs-string\">`&#x8bf7;&#x8bbe;&#x7f6e;&#x89d2;&#x8272;&#x6743;&#x9650;&#x6807;&#x7b7e;&#x503c;&quot;`</span>)\n    }\n  }\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"142,173"}},{"content":"<pre data-lines=\"174,193\"><code class=\"language-js\"><span class=\"hljs-keyword\">import</span> hasRole <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&apos;./hasRole&apos;</span>\n<span class=\"hljs-keyword\">import</span> hasPermi <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&apos;./hasPermi&apos;</span>\n<span class=\"hljs-keyword\">const</span> install = <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">Vue</span>) {\n  <span class=\"hljs-title class_\">Vue</span>.<span class=\"hljs-title function_\">directive</span>(<span class=\"hljs-string\">&apos;hasRole&apos;</span>, hasRole)\n  <span class=\"hljs-title class_\">Vue</span>.<span class=\"hljs-title function_\">directive</span>(<span class=\"hljs-string\">&apos;hasPermi&apos;</span>, hasPermi)\n  <span class=\"hljs-title class_\">Vue</span>.<span class=\"hljs-title function_\">directive</span>(<span class=\"hljs-string\">&apos;intervalClick&apos;</span>, intervalClick)\n  <span class=\"hljs-title class_\">Vue</span>.<span class=\"hljs-title function_\">directive</span>(<span class=\"hljs-string\">&apos;emotion&apos;</span>, emotion)\n}\n\n<span class=\"hljs-keyword\">if</span> (<span class=\"hljs-variable language_\">window</span>.<span class=\"hljs-property\">Vue</span>) {\n  <span class=\"hljs-variable language_\">window</span>[<span class=\"hljs-string\">&apos;hasRole&apos;</span>] = hasRole\n  <span class=\"hljs-variable language_\">window</span>[<span class=\"hljs-string\">&apos;hasPermi&apos;</span>] = hasPermi\n  <span class=\"hljs-title class_\">Vue</span>.<span class=\"hljs-title function_\">use</span>(install); <span class=\"hljs-comment\">// eslint-disable-line</span>\n}\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">default</span> install\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"174,193"}},{"content":"<pre data-lines=\"194,197\"><code data-lines=\"194,197\"><span class=\"hljs-attribute\">vue3</span> &#x590d;&#x5236;&#x6307;&#x4ee4;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"194,197"}},{"content":"<pre data-lines=\"199,267\"><code class=\"language-js\"><span class=\"hljs-comment\">/**\n* v-copyText &#x590d;&#x5236;&#x6587;&#x672c;&#x5185;&#x5bb9;\n* Copyright (c) 2022 ruoyi\n*/</span>\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">default</span> {\n  <span class=\"hljs-title function_\">beforeMount</span>(<span class=\"hljs-params\">el, { value, arg }</span>) {\n    <span class=\"hljs-keyword\">if</span> (arg === <span class=\"hljs-string\">&quot;callback&quot;</span>) {\n      el.<span class=\"hljs-property\">&#x24;copyCallback</span> = value;\n    } <span class=\"hljs-keyword\">else</span> {\n      el.<span class=\"hljs-property\">&#x24;copyValue</span> = value;\n      <span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">handler</span> = (<span class=\"hljs-params\"></span>) =&gt; {\n        <span class=\"hljs-title function_\">copyTextToClipboard</span>(el.<span class=\"hljs-property\">&#x24;copyValue</span>);\n        <span class=\"hljs-keyword\">if</span> (el.<span class=\"hljs-property\">&#x24;copyCallback</span>) {\n          el.&#x24;copyCallback(el.<span class=\"hljs-property\">&#x24;copyValue</span>);\n        }\n      };\n      el.<span class=\"hljs-title function_\">addEventListener</span>(<span class=\"hljs-string\">&quot;click&quot;</span>, handler);\n      el.<span class=\"hljs-property\">&#x24;destroyCopy</span> = <span class=\"hljs-function\">() =&gt;</span> el.<span class=\"hljs-title function_\">removeEventListener</span>(<span class=\"hljs-string\">&quot;click&quot;</span>, handler);\n    }\n  }\n}\n\n<span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">copyTextToClipboard</span>(<span class=\"hljs-params\">input, { target = <span class=\"hljs-variable language_\">document</span>.body } = {}</span>) {\n  <span class=\"hljs-keyword\">const</span> element = <span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-title function_\">createElement</span>(<span class=\"hljs-string\">&apos;textarea&apos;</span>);\n  <span class=\"hljs-keyword\">const</span> previouslyFocusedElement = <span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-property\">activeElement</span>;\n\n  element.<span class=\"hljs-property\">value</span> = input;\n\n  <span class=\"hljs-comment\">// Prevent keyboard from showing on mobile</span>\n  element.<span class=\"hljs-title function_\">setAttribute</span>(<span class=\"hljs-string\">&apos;readonly&apos;</span>, <span class=\"hljs-string\">&apos;&apos;</span>);\n\n  element.<span class=\"hljs-property\">style</span>.<span class=\"hljs-property\">contain</span> = <span class=\"hljs-string\">&apos;strict&apos;</span>;\n  element.<span class=\"hljs-property\">style</span>.<span class=\"hljs-property\">position</span> = <span class=\"hljs-string\">&apos;absolute&apos;</span>;\n  element.<span class=\"hljs-property\">style</span>.<span class=\"hljs-property\">left</span> = <span class=\"hljs-string\">&apos;-9999px&apos;</span>;\n  element.<span class=\"hljs-property\">style</span>.<span class=\"hljs-property\">fontSize</span> = <span class=\"hljs-string\">&apos;12pt&apos;</span>; <span class=\"hljs-comment\">// Prevent zooming on iOS</span>\n\n  <span class=\"hljs-keyword\">const</span> selection = <span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-title function_\">getSelection</span>();\n  <span class=\"hljs-keyword\">const</span> originalRange = selection.<span class=\"hljs-property\">rangeCount</span> &gt; <span class=\"hljs-number\">0</span> &amp;&amp; selection.<span class=\"hljs-title function_\">getRangeAt</span>(<span class=\"hljs-number\">0</span>);\n\n  target.<span class=\"hljs-title function_\">append</span>(element);\n  element.<span class=\"hljs-title function_\">select</span>();\n\n  <span class=\"hljs-comment\">// Explicit selection workaround for iOS</span>\n  element.<span class=\"hljs-property\">selectionStart</span> = <span class=\"hljs-number\">0</span>;\n  element.<span class=\"hljs-property\">selectionEnd</span> = input.<span class=\"hljs-property\">length</span>;\n\n  <span class=\"hljs-keyword\">let</span> isSuccess = <span class=\"hljs-literal\">false</span>;\n  <span class=\"hljs-keyword\">try</span> {\n    isSuccess = <span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-title function_\">execCommand</span>(<span class=\"hljs-string\">&apos;copy&apos;</span>);\n  } <span class=\"hljs-keyword\">catch</span> { }\n\n  element.<span class=\"hljs-title function_\">remove</span>();\n\n  <span class=\"hljs-keyword\">if</span> (originalRange) {\n    selection.<span class=\"hljs-title function_\">removeAllRanges</span>();\n    selection.<span class=\"hljs-title function_\">addRange</span>(originalRange);\n  }\n\n  <span class=\"hljs-comment\">// Get the focus back on the previously focused element, if any</span>\n  <span class=\"hljs-keyword\">if</span> (previouslyFocusedElement) {\n    previouslyFocusedElement.<span class=\"hljs-title function_\">focus</span>();\n  }\n\n  <span class=\"hljs-keyword\">return</span> isSuccess;\n}\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"199,267"}},{"content":"<pre data-lines=\"268,271\"><code data-lines=\"268,271\"><span class=\"hljs-attribute\">vue3</span> &#x64cd;&#x4f5c;&#x6743;&#x9650;&#x6307;&#x4ee4;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"268,271"}},{"content":"<pre data-lines=\"273,304\"><code class=\"language-js\"> <span class=\"hljs-comment\">/**\n * v-hasPermi &#x64cd;&#x4f5c;&#x6743;&#x9650;&#x5904;&#x7406;\n * Copyright (c) 2019 ruoyi\n */</span>\n \n<span class=\"hljs-keyword\">import</span> useUserStore <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&apos;@/store/modules/user&apos;</span>\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">default</span> {\n  <span class=\"hljs-title function_\">mounted</span>(<span class=\"hljs-params\">el, binding, vnode</span>) {\n    <span class=\"hljs-keyword\">const</span> { value } = binding\n    <span class=\"hljs-keyword\">const</span> all_permission = <span class=\"hljs-string\">&quot;*:*:*&quot;</span>;\n    <span class=\"hljs-keyword\">const</span> permissions = <span class=\"hljs-title function_\">useUserStore</span>().<span class=\"hljs-property\">permissions</span>\n\n    <span class=\"hljs-keyword\">if</span> (value &amp;&amp; value <span class=\"hljs-keyword\">instanceof</span> <span class=\"hljs-title class_\">Array</span> &amp;&amp; value.<span class=\"hljs-property\">length</span> &gt; <span class=\"hljs-number\">0</span>) {\n      <span class=\"hljs-keyword\">const</span> permissionFlag = value\n\n      <span class=\"hljs-keyword\">const</span> hasPermissions = permissions.<span class=\"hljs-title function_\">some</span>(<span class=\"hljs-function\"><span class=\"hljs-params\">permission</span> =&gt;</span> {\n        <span class=\"hljs-keyword\">return</span> all_permission === permission || permissionFlag.<span class=\"hljs-title function_\">includes</span>(permission)\n      })\n\n      <span class=\"hljs-keyword\">if</span> (!hasPermissions) {\n        el.<span class=\"hljs-property\">parentNode</span> &amp;&amp; el.<span class=\"hljs-property\">parentNode</span>.<span class=\"hljs-title function_\">removeChild</span>(el)\n      }\n    } <span class=\"hljs-keyword\">else</span> {\n      <span class=\"hljs-keyword\">throw</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Error</span>(<span class=\"hljs-string\">`&#x8bf7;&#x8bbe;&#x7f6e;&#x64cd;&#x4f5c;&#x6743;&#x9650;&#x6807;&#x7b7e;&#x503c;`</span>)\n    }\n  }\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"273,304"}},{"content":"<pre data-lines=\"306,336\"><code class=\"language-js\"> <span class=\"hljs-comment\">/**\n * v-hasRole &#x89d2;&#x8272;&#x6743;&#x9650;&#x5904;&#x7406;\n * Copyright (c) 2019 ruoyi\n */</span>\n \n<span class=\"hljs-keyword\">import</span> useUserStore <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&apos;@/store/modules/user&apos;</span>\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">default</span> {\n  <span class=\"hljs-title function_\">mounted</span>(<span class=\"hljs-params\">el, binding, vnode</span>) {\n    <span class=\"hljs-keyword\">const</span> { value } = binding\n    <span class=\"hljs-keyword\">const</span> super_admin = <span class=\"hljs-string\">&quot;admin&quot;</span>;\n    <span class=\"hljs-keyword\">const</span> roles = <span class=\"hljs-title function_\">useUserStore</span>().<span class=\"hljs-property\">roles</span>\n\n    <span class=\"hljs-keyword\">if</span> (value &amp;&amp; value <span class=\"hljs-keyword\">instanceof</span> <span class=\"hljs-title class_\">Array</span> &amp;&amp; value.<span class=\"hljs-property\">length</span> &gt; <span class=\"hljs-number\">0</span>) {\n      <span class=\"hljs-keyword\">const</span> roleFlag = value\n\n      <span class=\"hljs-keyword\">const</span> hasRole = roles.<span class=\"hljs-title function_\">some</span>(<span class=\"hljs-function\"><span class=\"hljs-params\">role</span> =&gt;</span> {\n        <span class=\"hljs-keyword\">return</span> super_admin === role || roleFlag.<span class=\"hljs-title function_\">includes</span>(role)\n      })\n\n      <span class=\"hljs-keyword\">if</span> (!hasRole) {\n        el.<span class=\"hljs-property\">parentNode</span> &amp;&amp; el.<span class=\"hljs-property\">parentNode</span>.<span class=\"hljs-title function_\">removeChild</span>(el)\n      }\n    } <span class=\"hljs-keyword\">else</span> {\n      <span class=\"hljs-keyword\">throw</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Error</span>(<span class=\"hljs-string\">`&#x8bf7;&#x8bbe;&#x7f6e;&#x89d2;&#x8272;&#x6743;&#x9650;&#x6807;&#x7b7e;&#x503c;`</span>)\n    }\n  }\n}\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"306,336"}},{"content":"<pre data-lines=\"337,340\"><code data-lines=\"337,340\"><span class=\"hljs-attribute\">vue3</span> &#x6307;&#x4ee4;&#x9996;&#x9875;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"337,340"}},{"content":"<pre data-lines=\"342,353\"><code class=\"language-js\"><span class=\"hljs-keyword\">import</span> hasRole <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&apos;./permission/hasRole&apos;</span>\n<span class=\"hljs-keyword\">import</span> hasPermi <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&apos;./permission/hasPermi&apos;</span>\n<span class=\"hljs-keyword\">import</span> copyText <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&apos;./common/copyText&apos;</span>\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">default</span> <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">directive</span>(<span class=\"hljs-params\">app</span>){\n  app.<span class=\"hljs-title function_\">directive</span>(<span class=\"hljs-string\">&apos;hasRole&apos;</span>, hasRole)\n  app.<span class=\"hljs-title function_\">directive</span>(<span class=\"hljs-string\">&apos;hasPermi&apos;</span>, hasPermi)\n  app.<span class=\"hljs-title function_\">directive</span>(<span class=\"hljs-string\">&apos;copyText&apos;</span>, copyText)\n}\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"342,353"}}],"payload":{"tag":"h2","lines":"53,54"}}],"payload":{"tag":"h1","lines":"0,1"}},{})</script>
</body>
</html>
