<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets@11.11.1/styles/default.min.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.18.10/dist/browser/index.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/index.js"></script><script>(r => {
              setTimeout(r);
            })(function renderToolbar() {
  const {
    markmap,
    mm
  } = window;
  const {
    el
  } = markmap.Toolbar.create(mm);
  el.setAttribute('style', 'position:absolute;bottom:20px;right:20px');
  document.body.append(el);
})</script><script>((getMarkmap, getOptions, root2, jsonOptions) => {
              const markmap = getMarkmap();
              window.mm = markmap.Markmap.create(
                "svg#mindmap",
                (getOptions || markmap.deriveOptions)(jsonOptions),
                root2
              );
            })(() => window.markmap,null,{"content":"Day02&#x56de;&#x987e;","children":[{"content":"&#x722c;&#x53d6;&#x7f51;&#x7ad9;&#x601d;&#x8def;","children":[{"content":"<pre data-lines=\"4,10\"><code class=\"language-python\">&#x3010;1&#x3011;&#x5148;&#x786e;&#x5b9a;&#x662f;&#x5426;&#x4e3a;&#x52a8;&#x6001;&#x52a0;&#x8f7d;&#x7f51;&#x7ad9;\n&#x3010;2&#x3011;&#x627e;URL&#x89c4;&#x5f8b;\n&#x3010;3&#x3011;&#x6b63;&#x5219;&#x8868;&#x8fbe;&#x5f0f;\n&#x3010;4&#x3011;&#x5b9a;&#x4e49;&#x7a0b;&#x5e8f;&#x6846;&#x67b6;&#xff0c;&#x8865;&#x5168;&#x5e76;&#x6d4b;&#x8bd5;&#x4ee3;&#x7801;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"4,10"}}],"payload":{"tag":"h2","lines":"2,3"}},{"content":"&#x6570;&#x636e;&#x6301;&#x4e45;&#x5316; - csv","children":[{"content":"<pre data-lines=\"13,20\"><code class=\"language-python\"> <span class=\"hljs-keyword\">import</span> csv\n <span class=\"hljs-keyword\">with</span> <span class=\"hljs-built_in\">open</span>(<span class=\"hljs-string\">&apos;xxx.csv&apos;</span>,<span class=\"hljs-string\">&apos;w&apos;</span>,encoding=<span class=\"hljs-string\">&apos;utf-8&apos;</span>,newline=<span class=\"hljs-string\">&apos;&apos;</span>) <span class=\"hljs-keyword\">as</span> f:\n\twriter = csv.writer(f)\n \twriter.writerow([])\n\twriter.writerows([(),(),()])\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"13,20"}}],"payload":{"tag":"h2","lines":"11,12"}},{"content":"&#x6570;&#x636e;&#x6301;&#x4e45;&#x5316; - MySQL","children":[{"content":"<pre data-lines=\"23,39\"><code class=\"language-mysql\">import pymysql\n\n# __init__(self)&#xff1a;\n\tself.db = pymysql.connect(&apos;IP&apos;,... ...)\n\tself.cursor = self.db.cursor()\n\t\n# save_html(self,r_list):\n\tself.cursor.execute(&apos;sql&apos;,[data1])\n\tself.cursor.executemany(&apos;sql&apos;,[(data1),(data2),(data3)])\n\tself.db.commit()\n\t\n# run(self):\n\tself.cursor.close()\n\tself.db.close()\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"23,39"}}],"payload":{"tag":"h2","lines":"21,22"}},{"content":"&#x6570;&#x636e;&#x6301;&#x4e45;&#x5316; - MongoDB","children":[{"content":"<pre data-lines=\"42,65\"><code class=\"language-mysql\">import pymongo\n\n\n# __init__(self)&#xff1a;\n\tself.conn = pymongo.MongoClient(&apos;IP&apos;,27017)\n\tself.db = self.conn[&apos;cardb&apos;]\n\tself.myset = self.db[&apos;car_set&apos;]\n\t\n# save_html(self,r_list):\n\tself.myset.insert_one(dict)\n\tself.myset.insert_many([{},{},{}])\n\n# MongoDB - Commmand - &#x5e93;-&gt;&#x96c6;&#x5408;-&gt;&#x6587;&#x6863;\nmongo\n&gt;show dbs\n&gt;use db_name\n&gt;show collections\n&gt;db.&#x96c6;&#x5408;&#x540d;.find().pretty()\n&gt;db.&#x96c6;&#x5408;&#x540d;.count()\n&gt;db.&#x96c6;&#x5408;&#x540d;.drop()\n&gt;db.dropDatabase()\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"42,65"}}],"payload":{"tag":"h2","lines":"40,41"}},{"content":"&#x591a;&#x7ea7;&#x9875;&#x9762;&#x6570;&#x636e;&#x6293;&#x53d6;","children":[{"content":"<pre data-lines=\"68,77\"><code class=\"language-python\">&#x3010;1&#x3011;&#x6574;&#x4f53;&#x601d;&#x8def;\n    1.1&gt; &#x722c;&#x53d6;&#x4e00;&#x7ea7;&#x9875;&#x9762;,&#x63d0;&#x53d6; &#x6240;&#x9700;&#x6570;&#x636e;+&#x94fe;&#x63a5;,&#x7ee7;&#x7eed;&#x8ddf;&#x8fdb;\n    1.2&gt; &#x722c;&#x53d6;&#x4e8c;&#x7ea7;&#x9875;&#x9762;,&#x63d0;&#x53d6; &#x6240;&#x9700;&#x6570;&#x636e;+&#x94fe;&#x63a5;,&#x7ee7;&#x7eed;&#x8ddf;&#x8fdb;\n    1.3&gt; ... ... \n\n&#x3010;2&#x3011;&#x4ee3;&#x7801;&#x5b9e;&#x73b0;&#x601d;&#x8def;\n    2.1&gt; &#x907f;&#x514d;&#x91cd;&#x590d;&#x4ee3;&#x7801; - &#x8bf7;&#x6c42;&#x3001;&#x89e3;&#x6790;&#x9700;&#x5b9a;&#x4e49;&#x51fd;&#x6570;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"68,77"}}],"payload":{"tag":"h2","lines":"66,67"}},{"content":"&#x589e;&#x91cf;&#x722c;&#x866b;","children":[{"content":"MySQL&#x5b9e;&#x73b0;&#x589e;&#x91cf;","children":[{"content":"<pre data-lines=\"82,109\"><code class=\"language-python\">&#x3010;<span class=\"hljs-number\">1</span>&#x3011;&#x6570;&#x636e;&#x5e93;&#x4e2d;&#x521b;&#x5efa;&#x6307;&#x7eb9;&#x8868;&#xff0c;&#x8868;&#x4e2d;&#x5b58;&#x653e;&#x6240;&#x6709;&#x6293;&#x53d6;&#x8fc7;&#x7684;<span class=\"hljs-string\">&apos;&#x5bf9;URL&#x5730;&#x5740;&#x8fdb;&#x884c;md5&#x52a0;&#x5bc6;&apos;</span>&#x540e;&#x7684;&#x6307;&#x7eb9;\n&#x3010;<span class=\"hljs-number\">2</span>&#x3011;&#x4ee3;&#x7801;&#x5b9e;&#x73b0;&#x6d41;&#x7a0b;&#x6a21;&#x677f;\n<span class=\"hljs-keyword\">import</span> pymysql\n<span class=\"hljs-keyword\">from</span> hashlib <span class=\"hljs-keyword\">import</span> md5\n<span class=\"hljs-keyword\">import</span> sys\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">XxxIncrSpider</span>:\n  <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__init__</span>(<span class=\"hljs-params\">self</span>):\n    <span class=\"hljs-variable language_\">self</span>.db = pymysql.connect(<span class=\"hljs-string\">&apos;localhost&apos;</span>,<span class=\"hljs-string\">&apos;root&apos;</span>,<span class=\"hljs-string\">&apos;123456&apos;</span>,<span class=\"hljs-string\">&apos;xxxdb&apos;</span>,charset=<span class=\"hljs-string\">&apos;utf8&apos;</span>)\n    <span class=\"hljs-variable language_\">self</span>.cursor = <span class=\"hljs-variable language_\">self</span>.db.cursor()\n  \n  <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">url_md5</span>(<span class=\"hljs-params\">self,url</span>):\n    <span class=\"hljs-string\">&quot;&quot;&quot;&#x5bf9;URL&#x8fdb;&#x884c;md5&#x52a0;&#x5bc6;&#x51fd;&#x6570;&quot;&quot;&quot;</span>\n    s = md5()\n    s.update(url.encode())\n    <span class=\"hljs-keyword\">return</span> s.hexdigest()\n  \n  <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">run_spider</span>(<span class=\"hljs-params\">self</span>):\n    href_list = [<span class=\"hljs-string\">&apos;url1&apos;</span>,<span class=\"hljs-string\">&apos;url2&apos;</span>,<span class=\"hljs-string\">&apos;url3&apos;</span>,<span class=\"hljs-string\">&apos;url4&apos;</span>]\n    <span class=\"hljs-keyword\">for</span> href <span class=\"hljs-keyword\">in</span> href_list:\n      href_md5 = <span class=\"hljs-variable language_\">self</span>.url_md5(href)\n      <span class=\"hljs-keyword\">if</span> href_md5 &#x4e0d;&#x5728;&#x6307;&#x7eb9;&#x8868;&#x4e2d;:\n        &#x5f00;&#x59cb;&#x8fdb;&#x884c;&#x6570;&#x636e;&#x6293;&#x53d6;&#xff0c;&#x5b8c;&#x6210;&#x540e;&#x5c06;&#x6307;&#x7eb9;&#x63d2;&#x5165;&#x5230;&#x6307;&#x7eb9;&#x8868;&#x4e2d;\n      <span class=\"hljs-keyword\">else</span>:\n        sys.exit()\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"82,109"}}],"payload":{"tag":"h3","lines":"80,81"}},{"content":"Redis&#x5b9e;&#x73b0;&#x589e;&#x91cf;","children":[{"content":"<pre data-lines=\"112,140\"><code class=\"language-python\">&#x3010;<span class=\"hljs-number\">1</span>&#x3011;&#x539f;&#x7406;\n    &#x5229;&#x7528;Redis&#x96c6;&#x5408;&#x7279;&#x6027;&#xff0c;&#x53ef;&#x5c06;&#x6293;&#x53d6;&#x8fc7;&#x7684;&#x6307;&#x7eb9;&#x6dfb;&#x52a0;&#x5230;redis&#x96c6;&#x5408;&#x4e2d;&#xff0c;&#x6839;&#x636e;&#x8fd4;&#x56de;&#x503c;&#x6765;&#x5224;&#x5b9a;&#x662f;&#x5426;&#x9700;&#x8981;&#x6293;&#x53d6;\n  \n&#x3010;<span class=\"hljs-number\">2</span>&#x3011;&#x4ee3;&#x7801;&#x5b9e;&#x73b0;&#x6a21;&#x677f;\n<span class=\"hljs-keyword\">import</span> redis\n<span class=\"hljs-keyword\">from</span> hashlib <span class=\"hljs-keyword\">import</span> md5\n<span class=\"hljs-keyword\">import</span> sys\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">XxxIncrSpider</span>:\n  <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__init__</span>(<span class=\"hljs-params\">self</span>):\n    <span class=\"hljs-variable language_\">self</span>.r = redis.Redis(host=<span class=\"hljs-string\">&apos;localhost&apos;</span>,port=<span class=\"hljs-number\">6379</span>,db=<span class=\"hljs-number\">0</span>)\n    \n  <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">url_md5</span>(<span class=\"hljs-params\">self,url</span>):\n    <span class=\"hljs-string\">&quot;&quot;&quot;&#x5bf9;URL&#x8fdb;&#x884c;md5&#x52a0;&#x5bc6;&#x51fd;&#x6570;&quot;&quot;&quot;</span>\n    s = md5()\n    s.update(url.encode())\n    <span class=\"hljs-keyword\">return</span> s.hexdigest()\n  \n  <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">run_spider</span>(<span class=\"hljs-params\">self</span>):\n    href_list = [<span class=\"hljs-string\">&apos;url1&apos;</span>,<span class=\"hljs-string\">&apos;url2&apos;</span>,<span class=\"hljs-string\">&apos;url3&apos;</span>,<span class=\"hljs-string\">&apos;url4&apos;</span>]\n    <span class=\"hljs-keyword\">for</span> href <span class=\"hljs-keyword\">in</span> href_list:\n      href_md5 = <span class=\"hljs-variable language_\">self</span>.url_md5(href)\n      <span class=\"hljs-keyword\">if</span> <span class=\"hljs-variable language_\">self</span>.r.sadd(<span class=\"hljs-string\">&apos;spider:urls&apos;</span>,href_md5) == <span class=\"hljs-number\">1</span>:\n        &#x8fd4;&#x56de;&#x503c;&#x4e3a;<span class=\"hljs-number\">1</span>&#x8868;&#x793a;&#x6dfb;&#x52a0;&#x6210;&#x529f;&#xff0c;&#x5373;&#x4e4b;&#x524d;&#x672a;&#x6293;&#x53d6;&#x8fc7;&#xff0c;&#x5219;&#x5f00;&#x59cb;&#x6293;&#x53d6;\n      <span class=\"hljs-keyword\">else</span>:\n        sys.exit()\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"112,140"}}],"payload":{"tag":"h3","lines":"110,111"}}],"payload":{"tag":"h2","lines":"78,79"}},{"content":"Day03&#x7b14;&#x8bb0;","children":[],"payload":{"tag":"h2","lines":"141,142"}},{"content":"requests&#x6a21;&#x5757;&#x9ad8;&#x7ea7;","children":[{"content":"requests.get()","children":[{"content":"<pre data-lines=\"147,163\"><code class=\"language-python\">&#x3010;1&#x3011;&#x4f5c;&#x7528;\n    &#x5411;&#x76ee;&#x6807;&#x7f51;&#x7ad9;&#x53d1;&#x8d77;&#x8bf7;&#x6c42;,&#x5e76;&#x83b7;&#x53d6;&#x54cd;&#x5e94;&#x5bf9;&#x8c61;\n    res = requests.get(url=url,headers=headers,timeout=3)\n\n&#x3010;2&#x3011;&#x53c2;&#x6570;\n    2.1) url &#xff1a;&#x9700;&#x8981;&#x6293;&#x53d6;&#x7684;URL&#x5730;&#x5740;\n    2.2) headers : &#x8bf7;&#x6c42;&#x5934;\n    2.3) timeout : &#x8d85;&#x65f6;&#x65f6;&#x95f4;&#xff0c;&#x8d85;&#x8fc7;&#x65f6;&#x95f4;&#x4f1a;&#x629b;&#x51fa;&#x5f02;&#x5e38;\n  \n&#x3010;3&#x3011;&#x54cd;&#x5e94;&#x5bf9;&#x8c61;(res)&#x5c5e;&#x6027;\n    3.1) text &#xff1a;&#x5b57;&#x7b26;&#x4e32;\n    3.2) content &#xff1a;&#x5b57;&#x8282;&#x6d41;\n    3.3) status_code &#xff1a;HTTP&#x54cd;&#x5e94;&#x7801;\n    3.4) url &#xff1a;&#x5b9e;&#x9645;&#x6570;&#x636e;&#x7684;URL&#x5730;&#x5740;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"147,163"}}],"payload":{"tag":"h3","lines":"145,146"}},{"content":"&#x975e;&#x7ed3;&#x6784;&#x5316;&#x6570;&#x636e;&#x4fdd;&#x5b58;","children":[{"content":"<pre data-lines=\"166,170\"><code class=\"language-python\"><span class=\"hljs-keyword\">with</span> <span class=\"hljs-built_in\">open</span>(<span class=\"hljs-string\">&apos;xxx.jpg&apos;</span>,<span class=\"hljs-string\">&apos;wb&apos;</span>) <span class=\"hljs-keyword\">as</span> f:\n\tf.write(res.content)\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"166,170"}}],"payload":{"tag":"h3","lines":"164,165"}},{"content":"&#x793a;&#x4f8b;&#x4ee3;&#x7801; - &#x56fe;&#x7247;&#x6293;&#x53d6;","children":[{"content":"<pre data-lines=\"173,185\"><code class=\"language-python\"><span class=\"hljs-comment\"># &#x4fdd;&#x5b58;&#x8d75;&#x4e3d;&#x9896;&#x56fe;&#x7247;&#x5230;&#x672c;&#x5730;</span>\n\n<span class=\"hljs-keyword\">import</span> requests\n\nurl = <span class=\"hljs-string\">&apos;https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1567090051520&amp;di=77e8b97b3280f999cf51340af4315b4b&amp;imgtype=jpg&amp;src=http%3A%2F%2F5b0988e595225.cdn.sohucs.com%2Fimages%2F20171121%2F4e6759d153d04c6badbb0a5262ec103d.jpeg&apos;</span>\nheaders = {<span class=\"hljs-string\">&apos;User-Agent&apos;</span>:<span class=\"hljs-string\">&apos;Mozilla/5.0&apos;</span>}\n\nhtml = requests.get(url=url,headers=headers).content\n<span class=\"hljs-keyword\">with</span> <span class=\"hljs-built_in\">open</span>(<span class=\"hljs-string\">&apos;&#x8d75;&#x4e3d;&#x9896;.jpg&apos;</span>,<span class=\"hljs-string\">&apos;wb&apos;</span>) <span class=\"hljs-keyword\">as</span> f:\n    f.write(html)\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"173,185"}}],"payload":{"tag":"h3","lines":"171,172"}},{"content":"&#x8bfe;&#x5802;&#x7ec3;&#x4e60;","children":[{"content":"<pre data-lines=\"188,210\"><code class=\"language-python\">&#x3010;<span class=\"hljs-number\">1</span>&#x3011;&#x767e;&#x5ea6;&#x56fe;&#x7247;&#x5b98;&#x7f51;&#x6307;&#x5b9a;&#x56fe;&#x7247;&#x6293;&#x53d6;:\n   <span class=\"hljs-number\">1.1</span>&gt; &#x767e;&#x5ea6;&#x56fe;&#x7247;&#x5b98;&#x7f51;: http://image.baidu.com/\n   <span class=\"hljs-number\">1.2</span>&gt; &#x8fd0;&#x884c;&#x6548;&#x679c;\n        &#x8bf7;&#x8f93;&#x5165;&#x5173;&#x952e;&#x5b57;: &#x8d75;&#x4e3d;&#x9896;\n        &#x5219;&#x81ea;&#x52a8;&#x521b;&#x5efa;&#x6587;&#x4ef6;&#x5939;: /home/tarena/images/&#x8d75;&#x4e3d;&#x9896;/  &#x5e76;&#x628a;&#x9996;&#x9875;<span class=\"hljs-number\">30</span>&#x5f20;&#x56fe;&#x7247;&#x4fdd;&#x5b58;&#x5230;&#x6b64;&#x6587;&#x4ef6;&#x5939;&#x4e0b;\n         \n&#x3010;<span class=\"hljs-number\">2</span>&#x3011;&#x6ce8;&#x610f;          \n   <span class=\"hljs-number\">2.1</span>&gt; &#x4e00;&#x5b9a;&#x8981;&#x4ee5;&#x54cd;&#x5e94;&#x5185;&#x5bb9;&#x4e3a;&#x4e3b;&#x6765;&#x5199;&#x6b63;&#x5219;&#x8868;&#x8fbe;&#x5f0f;&#xff08;&#x53f3;&#x952e; - &#x67e5;&#x770b;&#x7f51;&#x9875;&#x6e90;&#x4ee3;&#x7801;&#xff09;\n    \n&#x3010;<span class=\"hljs-number\">3</span>&#x3011;&#x98a0;&#x8986;&#x524d;&#x4e24;&#x5929;&#x8bfe;&#x7a0b;&#x8ba4;&#x77e5;&#x7684;&#x4e00;&#x4e2a;&#x73b0;&#x5b9e;\n   <span class=\"hljs-number\">3.1</span>&gt; &#x9875;&#x9762;&#x7ed3;&#x6784; - Elements&#xff0c;&#x4e3a;&#x9875;&#x9762;&#x6700;&#x7ec8;&#x6e32;&#x67d3;&#x5b8c;&#x6210;&#x540e;&#x7684;&#x7ed3;&#x6784;&#xff0c;&#x548c;&#x54cd;&#x5e94;&#x5185;&#x5bb9;&#x4e0d;&#x4e00;&#x5b9a;&#x5b8c;&#x5168;&#x4e00;&#x6837;\n   <span class=\"hljs-number\">3.2</span>&gt; &#x539f;&#x56e0;<span class=\"hljs-number\">1</span>: &#x53ef;&#x80fd;&#x4f1a;&#x6709;&#x90e8;&#x5206;&#x6570;&#x636e;&#x4e3a;&#x52a8;&#x6001;&#x52a0;&#x8f7d;&#x7684;\n        &#x539f;&#x56e0;<span class=\"hljs-number\">2</span>: &#x54cd;&#x5e94;&#x5185;&#x5bb9;&#x4e2d;&#x5b58;&#x5728;JavaScript&#xff0c;&#x5bf9;&#x9875;&#x9762;&#x7ed3;&#x6784;&#x505a;&#x4e86;&#x4e00;&#x5b9a;&#x8c03;&#x6574;\n\n&#x3010;<span class=\"hljs-number\">4</span>&#x3011;&#x90a3;&#x6211;&#x4eec;&#x5199;&#x6b63;&#x5219;&#x8868;&#x8fbe;&#x5f0f;&#x65f6;&#x8981;&#x4ee5;&#x8c01;&#x4e3a;&#x51c6;&#xff1f;\n   <span class=\"hljs-number\">4.1</span>&gt; &#x5fc5;&#x987b;&#x4ee5;&#x54cd;&#x5e94;&#x5185;&#x5bb9;&#x4e3a;&#x51c6;!!!!!! -&gt; &#x53f3;&#x952e;,&#x67e5;&#x770b;&#x7f51;&#x9875;&#x6e90;&#x4ee3;&#x7801;&#x4e3a;&#x51c6;\n   <span class=\"hljs-number\">4.1</span>&gt; &#x5fc5;&#x987b;&#x4ee5;&#x54cd;&#x5e94;&#x5185;&#x5bb9;&#x4e3a;&#x51c6;!!!!!! -&gt; &#x53f3;&#x952e;,&#x67e5;&#x770b;&#x7f51;&#x9875;&#x6e90;&#x4ee3;&#x7801;&#x4e3a;&#x51c6;\n   <span class=\"hljs-number\">4.1</span>&gt; &#x5fc5;&#x987b;&#x4ee5;&#x54cd;&#x5e94;&#x5185;&#x5bb9;&#x4e3a;&#x51c6;!!!!!! -&gt; &#x53f3;&#x952e;,&#x67e5;&#x770b;&#x7f51;&#x9875;&#x6e90;&#x4ee3;&#x7801;&#x4e3a;&#x51c6;\n  \n<span class=\"hljs-meta\">   @@ &#x91cd;&#x8981;&#x7684;&#x4e8b;&#x60c5;&#x8bf4;&#x4e09;&#x904d;,&#x5fc5;&#x987b;&#x4ee5;&#x54cd;&#x5e94;&#x5185;&#x5bb9;&#x4e3a;&#x51c6; @@</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"188,210"}}],"payload":{"tag":"h3","lines":"186,187"}},{"content":"&#x767e;&#x5ea6;&#x56fe;&#x7247;&#x6293;&#x53d6;&#x5b9e;&#x73b0;&#x6b65;&#x9aa4;","children":[{"content":"<pre data-lines=\"213,229\"><code class=\"language-python\">&#x3010;1&#x3011;&#x53f3;&#x952e;,&#x67e5;&#x770b;&#x7f51;&#x9875;&#x6e90;&#x7801;,&#x641c;&#x7d22;&#x56fe;&#x7247;&#x94fe;&#x63a5;&#x5173;&#x952e;&#x5b57; -&gt; &#x5b58;&#x5728;\n&#x3010;2&#x3011;&#x5206;&#x6790;URL&#x5730;&#x5740;&#x89c4;&#x5f8b;\n    https://image.baidu.com/search/index?tn=baiduimage&amp;word={}\n&#x3010;3&#x3011;&#x6b63;&#x5219;&#x8868;&#x8fbe;&#x5f0f; - &#x4ee5;&#x54cd;&#x5e94;&#x5185;&#x5bb9;&#x4e3a;&#x51c6;\n    &quot;thumbURL&quot;:&quot;(.*?)&quot;\n&#x3010;4&#x3011;&#x4ee3;&#x7801;&#x5b9e;&#x73b0;\n    4.1&gt; &#x77e5;&#x8bc6;&#x70b9;1 - Windows&#x4e2d;&#x8def;&#x5f84;&#x5982;&#x4f55;&#x8868;&#x793a;\n         &#x65b9;&#x5f0f;1: E:\\\\spider\\\\spider_day03\\\\\n         &#x65b9;&#x5f0f;2: E:/spider/spider_day03/\n                \n    4.2&gt; &#x5982;&#x4f55;&#x751f;&#x6210;&#x968f;&#x673a;&#x7684;User-Agent\n        sudo pip3 install fake_useragent\n        from fake_useragent import UserAgent\n        user_agent = UserAgent().random\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"213,229"}}],"payload":{"tag":"h3","lines":"211,212"}},{"content":"&#x767e;&#x5ea6;&#x56fe;&#x7247;&#x4ee3;&#x7801;&#x5b9e;&#x73b0;","children":[{"content":"<pre data-lines=\"232,282\"><code class=\"language-python\"><span class=\"hljs-keyword\">import</span> requests\n<span class=\"hljs-keyword\">import</span> re\n<span class=\"hljs-keyword\">import</span> time\n<span class=\"hljs-keyword\">import</span> random\n<span class=\"hljs-keyword\">from</span> fake_useragent <span class=\"hljs-keyword\">import</span> UserAgent\n<span class=\"hljs-keyword\">import</span> os\n<span class=\"hljs-keyword\">from</span> urllib <span class=\"hljs-keyword\">import</span> parse\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">BaiduImageSpider</span>(<span class=\"hljs-title class_ inherited__\">object</span>):\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__init__</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-variable language_\">self</span>.url = <span class=\"hljs-string\">&apos;https://image.baidu.com/search/index?tn=baiduimage&amp;word={}&apos;</span>\n        <span class=\"hljs-variable language_\">self</span>.word = <span class=\"hljs-built_in\">input</span>(<span class=\"hljs-string\">&apos;&#x8bf7;&#x8f93;&#x5165;&#x5173;&#x952e;&#x5b57;:&apos;</span>)\n        <span class=\"hljs-variable language_\">self</span>.directory = <span class=\"hljs-string\">&apos;/home/tarena/images/{}/&apos;</span>.<span class=\"hljs-built_in\">format</span>(<span class=\"hljs-variable language_\">self</span>.word)\n        <span class=\"hljs-keyword\">if</span> <span class=\"hljs-keyword\">not</span> os.path.exists(<span class=\"hljs-variable language_\">self</span>.directory):\n            os.makedirs(<span class=\"hljs-variable language_\">self</span>.directory)\n\n        <span class=\"hljs-variable language_\">self</span>.i = <span class=\"hljs-number\">1</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">get_images</span>(<span class=\"hljs-params\">self,one_url</span>):\n        <span class=\"hljs-comment\"># &#x4f7f;&#x7528;&#x968f;&#x673a;&#x7684;User-Agent</span>\n        headers = { <span class=\"hljs-string\">&apos;User-Agent&apos;</span>:UserAgent().random }\n        one_html = requests.get(url=one_url,headers=headers).text\n        regex = <span class=\"hljs-string\">&apos;&quot;thumbURL&quot;:&quot;(.*?)&quot;&apos;</span>\n        pattern = re.<span class=\"hljs-built_in\">compile</span>(regex,re.S)\n        image_src_list = pattern.findall(one_html)\n        <span class=\"hljs-keyword\">for</span> image_src <span class=\"hljs-keyword\">in</span> image_src_list:\n            <span class=\"hljs-variable language_\">self</span>.save_image(image_src)\n            <span class=\"hljs-comment\"># &#x63a7;&#x5236;&#x722c;&#x53d6;&#x901f;&#x5ea6;</span>\n            time.sleep(random.uniform(<span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">1</span>))\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">save_image</span>(<span class=\"hljs-params\">self,image_src</span>):\n        <span class=\"hljs-comment\"># &#x6bcf;&#x6b21;&#x8bf7;&#x6c42;&#x4f7f;&#x7528;&#x968f;&#x673a;&#x7684;User-Agent</span>\n        headers = { <span class=\"hljs-string\">&apos;User-Agent&apos;</span>:UserAgent().random }\n        image_html = requests.get(url=image_src,headers=headers).content\n        filename = <span class=\"hljs-string\">&apos;{}{}_{}.jpg&apos;</span>.<span class=\"hljs-built_in\">format</span>(<span class=\"hljs-variable language_\">self</span>.directory,<span class=\"hljs-variable language_\">self</span>.word,<span class=\"hljs-variable language_\">self</span>.i)\n        <span class=\"hljs-keyword\">with</span> <span class=\"hljs-built_in\">open</span>(filename,<span class=\"hljs-string\">&apos;wb&apos;</span>) <span class=\"hljs-keyword\">as</span> f:\n          f.write(image_html)\n        <span class=\"hljs-built_in\">print</span>(filename,<span class=\"hljs-string\">&apos;&#x4e0b;&#x8f7d;&#x6210;&#x529f;&apos;</span>)\n        <span class=\"hljs-variable language_\">self</span>.i += <span class=\"hljs-number\">1</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">run</span>(<span class=\"hljs-params\">self</span>):\n        params = parse.quote(<span class=\"hljs-variable language_\">self</span>.word)\n        one_url = <span class=\"hljs-variable language_\">self</span>.url.<span class=\"hljs-built_in\">format</span>(params)\n        <span class=\"hljs-variable language_\">self</span>.get_images(one_url)\n\n<span class=\"hljs-keyword\">if</span> __name__ == <span class=\"hljs-string\">&apos;__main__&apos;</span>:\n    spider = BaiduImageSpider()\n    spider.run()\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"232,282"}}],"payload":{"tag":"h3","lines":"230,231"}}],"payload":{"tag":"h2","lines":"143,144"}},{"content":"Chrome&#x6d4f;&#x89c8;&#x5668;&#x5b89;&#x88c5;&#x63d2;&#x4ef6;","children":[{"content":"&#x5b89;&#x88c5;&#x65b9;&#x6cd5;","children":[{"content":"<pre data-lines=\"287,299\"><code class=\"language-python\">&#x3010;<span class=\"hljs-number\">1</span>&#x3011;&#x5728;&#x7ebf;&#x5b89;&#x88c5;\n    <span class=\"hljs-number\">1.1</span>&gt; &#x4e0b;&#x8f7d;&#x63d2;&#x4ef6; - google&#x8bbf;&#x95ee;&#x52a9;&#x624b;\n    <span class=\"hljs-number\">1.2</span>&gt; &#x5b89;&#x88c5;&#x63d2;&#x4ef6; - google&#x8bbf;&#x95ee;&#x52a9;&#x624b;: Chrome&#x6d4f;&#x89c8;&#x5668;-&#x8bbe;&#x7f6e;-&#x66f4;&#x591a;&#x5de5;&#x5177;-&#x6269;&#x5c55;&#x7a0b;&#x5e8f;-&#x5f00;&#x53d1;&#x8005;&#x6a21;&#x5f0f;-&#x62d6;&#x62fd;(&#x89e3;&#x538b;&#x540e;&#x7684;&#x63d2;&#x4ef6;)\n    <span class=\"hljs-number\">1.3</span>&gt; &#x5728;&#x7ebf;&#x5b89;&#x88c5;&#x5176;&#x4ed6;&#x63d2;&#x4ef6; - &#x6253;&#x5f00;google&#x8bbf;&#x95ee;&#x52a9;&#x624b; - google&#x5e94;&#x7528;&#x5546;&#x5e97; - &#x641c;&#x7d22;&#x63d2;&#x4ef6; - &#x6dfb;&#x52a0;&#x5373;&#x53ef;\n\n&#x3010;<span class=\"hljs-number\">2</span>&#x3011;&#x79bb;&#x7ebf;&#x5b89;&#x88c5;\n    <span class=\"hljs-number\">2.1</span>&gt; &#x4e0b;&#x8f7d;&#x63d2;&#x4ef6; - xxx.crx &#x91cd;&#x547d;&#x540d;&#x4e3a; xxx.<span class=\"hljs-built_in\">zip</span>\n    <span class=\"hljs-number\">2.2</span>&gt; Chrome&#x6d4f;&#x89c8;&#x5668;-&#x8bbe;&#x7f6e;-&#x66f4;&#x591a;&#x5de5;&#x5177;-&#x6269;&#x5c55;&#x7a0b;&#x5e8f;-&#x5f00;&#x53d1;&#x8005;&#x6a21;&#x5f0f;\n    <span class=\"hljs-number\">2.3</span>&gt; &#x62d6;&#x62fd; &#x63d2;&#x4ef6;(&#x6216;&#x8005;&#x89e3;&#x538b;&#x540e;&#x6587;&#x4ef6;&#x5939;) &#x5230;&#x6d4f;&#x89c8;&#x5668;&#x4e2d;\n    <span class=\"hljs-number\">2.4</span>&gt; &#x91cd;&#x542f;&#x6d4f;&#x89c8;&#x5668;&#xff0c;&#x4f7f;&#x63d2;&#x4ef6;&#x751f;&#x6548;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"287,299"}}],"payload":{"tag":"h3","lines":"285,286"}},{"content":"&#x722c;&#x866b;&#x5e38;&#x7528;&#x63d2;&#x4ef6;","children":[{"content":"<pre data-lines=\"302,309\"><code class=\"language-python\">&#x3010;1&#x3011;google-access-helper : &#x8c37;&#x6b4c;&#x8bbf;&#x95ee;&#x52a9;&#x624b;,&#x53ef;&#x8bbf;&#x95ee; &#x8c37;&#x6b4c;&#x5e94;&#x7528;&#x5546;&#x5e97;\n&#x3010;2&#x3011;Xpath Helper: &#x8f7b;&#x677e;&#x83b7;&#x53d6;HTML&#x5143;&#x7d20;&#x7684;xPath&#x8def;&#x5f84;\n    &#x6253;&#x5f00;/&#x5173;&#x95ed;: Ctrl + Shift + x\n&#x3010;3&#x3011;JsonView: &#x683c;&#x5f0f;&#x5316;&#x8f93;&#x51fa;json&#x683c;&#x5f0f;&#x6570;&#x636e;\n&#x3010;4&#x3011;Proxy SwitchyOmega: Chrome&#x6d4f;&#x89c8;&#x5668;&#x4e2d;&#x7684;&#x4ee3;&#x7406;&#x7ba1;&#x7406;&#x6269;&#x5c55;&#x7a0b;&#x5e8f;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"302,309"}}],"payload":{"tag":"h3","lines":"300,301"}}],"payload":{"tag":"h2","lines":"283,284"}},{"content":"xpath&#x89e3;&#x6790;","children":[{"content":"&#x5b9a;&#x4e49;","children":[{"content":"<pre data-lines=\"314,317\"><code class=\"language-python\">XPath&#x5373;&#x4e3a;XML&#x8def;&#x5f84;&#x8bed;&#x8a00;&#xff0c;&#x5b83;&#x662f;&#x4e00;&#x79cd;&#x7528;&#x6765;&#x786e;&#x5b9a;XML&#x6587;&#x6863;&#x4e2d;&#x67d0;&#x90e8;&#x5206;&#x4f4d;&#x7f6e;&#x7684;&#x8bed;&#x8a00;&#xff0c;&#x540c;&#x6837;&#x9002;&#x7528;&#x4e8e;HTML&#x6587;&#x6863;&#x7684;&#x68c0;&#x7d22;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"314,317"}}],"payload":{"tag":"h3","lines":"312,313"}},{"content":"&#x793a;&#x4f8b;HTML&#x4ee3;&#x7801;","children":[{"content":"<pre data-lines=\"320,337\"><code class=\"language-python\">&lt;ul class=&quot;CarList&quot;&gt;\n\t&lt;li class=&quot;bjd&quot; id=&quot;car_001&quot; href=&quot;http://www.bjd.com/&quot;&gt;\n        &lt;p class=&quot;name&quot;&gt;&#x5e03;&#x52a0;&#x8fea;&lt;/p&gt;\n        &lt;p class=&quot;model&quot;&gt;&#x5a01;&#x822a;&lt;/p&gt;\n        &lt;p class=&quot;price&quot;&gt;2500&#x4e07;&lt;/p&gt;\n        &lt;p class=&quot;color&quot;&gt;&#x7ea2;&#x8272;&lt;/p&gt;\n    &lt;/li&gt;\n    \n    &lt;li class=&quot;byd&quot; id=&quot;car_002&quot; href=&quot;http://www.byd.com/&quot;&gt;\n        &lt;p class=&quot;name&quot;&gt;&#x6bd4;&#x4e9a;&#x8fea;&lt;/p&gt;\n        &lt;p class=&quot;model&quot;&gt;&#x79e6;&lt;/p&gt;\n        &lt;p class=&quot;price&quot;&gt;15&#x4e07;&lt;/p&gt;\n        &lt;p class=&quot;color&quot;&gt;&#x767d;&#x8272;&lt;/p&gt;\n    &lt;/li&gt;\n&lt;/ul&gt;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"320,337"}}],"payload":{"tag":"h3","lines":"318,319"}},{"content":"&#x5339;&#x914d;&#x6f14;&#x793a;","children":[{"content":"<pre data-lines=\"340,356\"><code class=\"language-python\">&#x3010;<span class=\"hljs-number\">1</span>&#x3011;&#x67e5;&#x627e;&#x6240;&#x6709;&#x7684;li&#x8282;&#x70b9;\n    //li\n&#x3010;<span class=\"hljs-number\">2</span>&#x3011;&#x83b7;&#x53d6;&#x6240;&#x6709;&#x6c7d;&#x8f66;&#x7684;&#x540d;&#x79f0;: &#x6240;&#x6709;li&#x8282;&#x70b9;&#x4e0b;&#x7684;&#x5b50;&#x8282;&#x70b9;p&#x7684;&#x503c; (<span class=\"hljs-keyword\">class</span>&#x5c5e;&#x6027;&#x503c;&#x4e3a;name&#xff09;\n    //li/p[@<span class=\"hljs-keyword\">class</span>=<span class=\"hljs-string\">&quot;name&quot;</span>]\n    //p[@<span class=\"hljs-keyword\">class</span>=<span class=\"hljs-string\">&quot;name&quot;</span>]\n    //ul[@<span class=\"hljs-keyword\">class</span>=<span class=\"hljs-string\">&quot;CarList&quot;</span>]/li/p[@<span class=\"hljs-keyword\">class</span>=<span class=\"hljs-string\">&quot;name&quot;</span>]\n&#x3010;<span class=\"hljs-number\">3</span>&#x3011;&#x83b7;&#x53d6;ul&#x8282;&#x70b9;&#x4e0b;&#x7b2c;<span class=\"hljs-number\">2</span>&#x4e2a;li&#x8282;&#x70b9;&#x7684;&#x6c7d;&#x8f66;&#x4fe1;&#x606f;: &#x627e;&#x6bd4;&#x4e9a;&#x8fea;&#x8f66;&#x7684;&#x4fe1;&#x606f;\n    //ul[@<span class=\"hljs-keyword\">class</span>=<span class=\"hljs-string\">&quot;CarList&quot;</span>]/li[<span class=\"hljs-number\">2</span>]/p                           \n&#x3010;<span class=\"hljs-number\">4</span>&#x3011;&#x83b7;&#x53d6;&#x6240;&#x6709;&#x6c7d;&#x8f66;&#x7684;&#x94fe;&#x63a5;: ul&#x8282;&#x70b9;&#x4e0b;&#x6240;&#x6709;li&#x5b50;&#x8282;&#x70b9;&#x7684;href&#x5c5e;&#x6027;&#x7684;&#x503c;\n    //ul[@<span class=\"hljs-keyword\">class</span>=<span class=\"hljs-string\">&quot;CarList&quot;</span>]/li/@href\n\n&#x3010;&#x6ce8;&#x610f;&#x3011;                             \n    <span class=\"hljs-number\">1</span>&gt; &#x53ea;&#x8981;&#x6d89;&#x53ca;&#x5230;&#x6761;&#x4ef6;,&#x52a0; [] : //li[@<span class=\"hljs-keyword\">class</span>=<span class=\"hljs-string\">&quot;xxx&quot;</span>]   //li[<span class=\"hljs-number\">2</span>]\n    <span class=\"hljs-number\">2</span>&gt; &#x53ea;&#x8981;&#x83b7;&#x53d6;&#x5c5e;&#x6027;&#x503c;,&#x52a0; @  : //li[@<span class=\"hljs-keyword\">class</span>=<span class=\"hljs-string\">&quot;xxx&quot;</span>]   //li/@href\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"340,356"}}],"payload":{"tag":"h3","lines":"338,339"}},{"content":"&#x9009;&#x53d6;&#x8282;&#x70b9;","children":[{"content":"<pre data-lines=\"359,377\"><code class=\"language-python\">&#x3010;<span class=\"hljs-number\">1</span>&#x3011;// : &#x4ece;&#x6240;&#x6709;&#x8282;&#x70b9;&#x4e2d;&#x67e5;&#x627e;&#xff08;&#x5305;&#x62ec;&#x5b50;&#x8282;&#x70b9;&#x548c;&#x540e;&#x4ee3;&#x8282;&#x70b9;&#xff09;\n&#x3010;<span class=\"hljs-number\">2</span>&#x3011;@  : &#x83b7;&#x53d6;&#x5c5e;&#x6027;&#x503c;\n  <span class=\"hljs-number\">2.1</span>&gt; &#x4f7f;&#x7528;&#x573a;&#x666f;<span class=\"hljs-number\">1</span>&#xff08;&#x5c5e;&#x6027;&#x503c;&#x4f5c;&#x4e3a;&#x6761;&#x4ef6;&#xff09;\n       //div[@<span class=\"hljs-keyword\">class</span>=<span class=\"hljs-string\">&quot;movie-item-info&quot;</span>]\n  <span class=\"hljs-number\">2.2</span>&gt; &#x4f7f;&#x7528;&#x573a;&#x666f;<span class=\"hljs-number\">2</span>&#xff08;&#x76f4;&#x63a5;&#x83b7;&#x53d6;&#x5c5e;&#x6027;&#x503c;&#xff09;\n       //div[@<span class=\"hljs-keyword\">class</span>=<span class=\"hljs-string\">&quot;movie-item-info&quot;</span>]/a/img/@src\n    \n&#x3010;<span class=\"hljs-number\">3</span>&#x3011;&#x7ec3;&#x4e60; - &#x732b;&#x773c;&#x7535;&#x5f71;top100\n  <span class=\"hljs-number\">3.1</span>&gt; &#x5339;&#x914d;&#x7535;&#x5f71;&#x540d;&#x79f0;\n      //div[@<span class=\"hljs-keyword\">class</span>=<span class=\"hljs-string\">&quot;movie-item-info&quot;</span>]/p[<span class=\"hljs-number\">1</span>]/a/text()\n  <span class=\"hljs-number\">3.2</span>&gt; &#x5339;&#x914d;&#x7535;&#x5f71;&#x4e3b;&#x6f14;\n      //div[@<span class=\"hljs-keyword\">class</span>=<span class=\"hljs-string\">&quot;movie-item-info&quot;</span>]/p[<span class=\"hljs-number\">2</span>]/text()\n  <span class=\"hljs-number\">3.3</span>&gt; &#x5339;&#x914d;&#x4e0a;&#x6620;&#x65f6;&#x95f4;\n      //div[@<span class=\"hljs-keyword\">class</span>=<span class=\"hljs-string\">&quot;movie-item-info&quot;</span>]/p[<span class=\"hljs-number\">3</span>]/text()\n  <span class=\"hljs-number\">3.4</span>&gt; &#x5339;&#x914d;&#x7535;&#x5f71;&#x94fe;&#x63a5;\n      //div[@<span class=\"hljs-keyword\">class</span>=<span class=\"hljs-string\">&quot;movie-item-info&quot;</span>]/p[<span class=\"hljs-number\">1</span>]/a/@href\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"359,377"}}],"payload":{"tag":"h3","lines":"357,358"}},{"content":"&#x5339;&#x914d;&#x591a;&#x8def;&#x5f84;&#xff08;&#x6216;&#xff09;","children":[{"content":"<pre data-lines=\"380,383\"><code class=\"language-python\">xpath&#x8868;&#x8fbe;&#x5f0f;1 | xpath&#x8868;&#x8fbe;&#x5f0f;2 | xpath&#x8868;&#x8fbe;&#x5f0f;3\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"380,383"}}],"payload":{"tag":"h3","lines":"378,379"}},{"content":"&#x5e38;&#x7528;&#x51fd;&#x6570;","children":[{"content":"<pre data-lines=\"386,395\"><code class=\"language-python\">&#x3010;<span class=\"hljs-number\">1</span>&#x3011;contains() : &#x5339;&#x914d;&#x5c5e;&#x6027;&#x503c;&#x4e2d;&#x5305;&#x542b;&#x67d0;&#x4e9b;&#x5b57;&#x7b26;&#x4e32;&#x8282;&#x70b9;\n    <span class=\"hljs-number\">1.1</span>&gt; &#x67e5;&#x627e;<span class=\"hljs-built_in\">id</span>&#x5c5e;&#x6027;&#x503c;&#x4e2d;&#x5305;&#x542b;&#x5b57;&#x7b26;&#x4e32; <span class=\"hljs-string\">&quot;car_&quot;</span> &#x7684; li &#x8282;&#x70b9;\n       //li[contains(@<span class=\"hljs-built_in\">id</span>,<span class=\"hljs-string\">&quot;car_&quot;</span>)]\n\n&#x3010;<span class=\"hljs-number\">2</span>&#x3011;text() &#xff1a;&#x83b7;&#x53d6;&#x8282;&#x70b9;&#x7684;&#x6587;&#x672c;&#x5185;&#x5bb9;\n    <span class=\"hljs-number\">2.1</span>&gt; &#x67e5;&#x627e;&#x6240;&#x6709;&#x6c7d;&#x8f66;&#x7684;&#x4ef7;&#x683c;\n       //ul[@<span class=\"hljs-keyword\">class</span>=<span class=\"hljs-string\">&quot;CarList&quot;</span>]/li/p[@<span class=\"hljs-keyword\">class</span>=<span class=\"hljs-string\">&quot;price&quot;</span>]/text()\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"386,395"}}],"payload":{"tag":"h3","lines":"384,385"}},{"content":"&#x7ec8;&#x6781;&#x603b;&#x7ed3;","children":[{"content":"<pre data-lines=\"398,406\"><code class=\"language-python\">&#x3010;<span class=\"hljs-number\">1</span>&#x3011;xpath&#x8868;&#x8fbe;&#x5f0f;&#x7684;&#x672b;&#x5c3e;&#x4e3a;: /text() &#x3001;/@href  &#x5f97;&#x5230;&#x7684;&#x5217;&#x8868;&#x4e2d;&#x4e3a;<span class=\"hljs-string\">&apos;&#x5b57;&#x7b26;&#x4e32;&apos;</span>\n \n&#x3010;<span class=\"hljs-number\">2</span>&#x3011;&#x5176;&#x4ed6;&#x5269;&#x4f59;&#x6240;&#x6709;&#x60c5;&#x51b5;&#x5f97;&#x5230;&#x7684;&#x5217;&#x8868;&#x4e2d;&#x5747;&#x4e3a;<span class=\"hljs-string\">&apos;&#x8282;&#x70b9;&#x5bf9;&#x8c61;&apos;</span> \n    [&lt;element dd at xxxa&gt;,&lt;element dd at xxxb&gt;,&lt;element dd at xxxc&gt;]\n    [&lt;element div at xxxa&gt;,&lt;element div at xxxb&gt;]\n    [&lt;element p at xxxa&gt;,&lt;element p at xxxb&gt;,&lt;element p at xxxc&gt;]\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"398,406"}}],"payload":{"tag":"h3","lines":"396,397"}},{"content":"&#x8bfe;&#x5802;&#x7ec3;&#x4e60;","children":[{"content":"<pre data-lines=\"409,421\"><code class=\"language-python\">&#x3010;<span class=\"hljs-number\">1</span>&#x3011;&#x5339;&#x914d;&#x6c7d;&#x8f66;&#x4e4b;&#x5bb6;-&#x4e8c;&#x624b;&#x8f66;,&#x6240;&#x6709;&#x6c7d;&#x8f66;&#x7684;&#x94fe;&#x63a5; : \n    //li[@<span class=\"hljs-keyword\">class</span>=<span class=\"hljs-string\">&quot;cards-li list-photo-li&quot;</span>]/a[<span class=\"hljs-number\">1</span>]/@href\n    //a[@<span class=\"hljs-keyword\">class</span>=<span class=\"hljs-string\">&quot;carinfo&quot;</span>]/@href\n&#x3010;<span class=\"hljs-number\">2</span>&#x3011;&#x5339;&#x914d;&#x6c7d;&#x8f66;&#x4e4b;&#x5bb6;-&#x6c7d;&#x8f66;&#x8be6;&#x60c5;&#x9875;&#x4e2d;,&#x6c7d;&#x8f66;&#x7684;\n     <span class=\"hljs-number\">2.1</span>)&#x540d;&#x79f0;:  //div[@<span class=\"hljs-keyword\">class</span>=<span class=\"hljs-string\">&quot;car-box&quot;</span>]/h3/text()\n     <span class=\"hljs-number\">2.2</span>)&#x91cc;&#x7a0b;:  //ul/li[<span class=\"hljs-number\">1</span>]/h4/text()\n     <span class=\"hljs-number\">2.3</span>)&#x65f6;&#x95f4;:  //ul/li[<span class=\"hljs-number\">2</span>]/h4/text()\n     <span class=\"hljs-number\">2.4</span>)&#x6321;&#x4f4d;+&#x6392;&#x91cf;: //ul/li[<span class=\"hljs-number\">3</span>]/h4/text()\n     <span class=\"hljs-number\">2.5</span>)&#x6240;&#x5728;&#x5730;: //ul/li[<span class=\"hljs-number\">4</span>]/h4/text()\n     <span class=\"hljs-number\">2.6</span>)&#x4ef7;&#x683c;:   //div[@<span class=\"hljs-keyword\">class</span>=<span class=\"hljs-string\">&quot;brand-price-item&quot;</span>]/span[@<span class=\"hljs-keyword\">class</span>=<span class=\"hljs-string\">&quot;price&quot;</span>]/text()\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"409,421"}}],"payload":{"tag":"h3","lines":"407,408"}}],"payload":{"tag":"h2","lines":"310,311"}},{"content":"<mark>lxml&#x89e3;&#x6790;&#x5e93;</mark>","children":[{"content":"&#x5b89;&#x88c5;","children":[{"content":"<pre data-lines=\"426,430\"><code class=\"language-python\">&#x3010;1&#x3011;Ubuntu:  sudo pip3 install lxml\n&#x3010;2&#x3011;Windows: python -m pip install lxml\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"426,430"}}],"payload":{"tag":"h3","lines":"424,425"}},{"content":"&#x4f7f;&#x7528;&#x6d41;&#x7a0b;","children":[{"content":"<pre data-lines=\"433,441\"><code class=\"language-python\"><span class=\"hljs-number\">1</span>&#x3001;&#x5bfc;&#x6a21;&#x5757;\n   <span class=\"hljs-keyword\">from</span> lxml <span class=\"hljs-keyword\">import</span> etree\n<span class=\"hljs-number\">2</span>&#x3001;&#x521b;&#x5efa;&#x89e3;&#x6790;&#x5bf9;&#x8c61;\n   parse_html = etree.HTML(html)\n<span class=\"hljs-number\">3</span>&#x3001;&#x89e3;&#x6790;&#x5bf9;&#x8c61;&#x8c03;&#x7528;xpath\n   r_list = parse_html.xpath(<span class=\"hljs-string\">&apos;xpath&#x8868;&#x8fbe;&#x5f0f;&apos;</span>)\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"433,441"}}],"payload":{"tag":"h3","lines":"431,432"}},{"content":"xpath&#x6700;&#x5e38;&#x7528;","children":[{"content":"<pre data-lines=\"444,456\"><code class=\"language-python\">&#x3010;<span class=\"hljs-number\">1</span>&#x3011;&#x57fa;&#x51c6;xpath: &#x5339;&#x914d;&#x6240;&#x6709;&#x7535;&#x5f71;&#x4fe1;&#x606f;&#x7684;&#x8282;&#x70b9;&#x5bf9;&#x8c61;&#x5217;&#x8868;\n   //dl[@<span class=\"hljs-keyword\">class</span>=<span class=\"hljs-string\">&quot;board-wrapper&quot;</span>]/dd\n   [&lt;element dd at xxx&gt;,&lt;element dd at xxx&gt;,...]\n    \n&#x3010;<span class=\"hljs-number\">2</span>&#x3011;&#x904d;&#x5386;&#x5bf9;&#x8c61;&#x5217;&#x8868;&#xff0c;&#x4f9d;&#x6b21;&#x83b7;&#x53d6;&#x6bcf;&#x4e2a;&#x7535;&#x5f71;&#x4fe1;&#x606f;\n   item = {}\n   <span class=\"hljs-keyword\">for</span> dd <span class=\"hljs-keyword\">in</span> dd_list:\n\t \titem[<span class=\"hljs-string\">&apos;name&apos;</span>] = dd.xpath(<span class=\"hljs-string\">&apos;.//p[@class=&quot;name&quot;]/a/text()&apos;</span>).strip()\n\t \titem[<span class=\"hljs-string\">&apos;star&apos;</span>] = dd.xpath(<span class=\"hljs-string\">&apos;.//p[@class=&quot;star&quot;]/text()&apos;</span>).strip()[<span class=\"hljs-number\">3</span>:]\n\t \titem[<span class=\"hljs-string\">&apos;time&apos;</span>] = dd.xpath(<span class=\"hljs-string\">&apos;//p[@class=&quot;releasetime&quot;]/text()&apos;</span>).strip()[<span class=\"hljs-number\">5</span>:<span class=\"hljs-number\">15</span>]\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"444,456"}}],"payload":{"tag":"h3","lines":"442,443"}},{"content":"&#x732b;&#x773c;&#x7535;&#x5f71;-xpath","children":[{"content":"<pre data-lines=\"459,522\"><code class=\"language-python\"><span class=\"hljs-string\">&quot;&quot;&quot;\n&#x732b;&#x773c;&#x7535;&#x5f71; - xpath\n&quot;&quot;&quot;</span>\n<span class=\"hljs-keyword\">import</span> requests\n<span class=\"hljs-keyword\">from</span> lxml <span class=\"hljs-keyword\">import</span> etree\n<span class=\"hljs-keyword\">import</span> time\n<span class=\"hljs-keyword\">import</span> random\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">MaoyanSpider</span>(<span class=\"hljs-title class_ inherited__\">object</span>):\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__init__</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-variable language_\">self</span>.url = <span class=\"hljs-string\">&apos;https://maoyan.com/board/4?offset={}&apos;</span>\n        <span class=\"hljs-variable language_\">self</span>.headers = {\n            <span class=\"hljs-string\">&apos;&apos;&apos;Accept-Encoding&apos;&apos;&apos;</span>: <span class=\"hljs-string\">&apos;&apos;&apos;gzip, deflate, br&apos;&apos;&apos;</span>,\n            <span class=\"hljs-string\">&apos;&apos;&apos;Upgrade-Insecure-Requests&apos;&apos;&apos;</span>: <span class=\"hljs-string\">&apos;&apos;&apos;1&apos;&apos;&apos;</span>,\n            <span class=\"hljs-string\">&apos;&apos;&apos;User-Agent&apos;&apos;&apos;</span>: <span class=\"hljs-string\">&apos;&apos;&apos;Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.132 Safari/537.36&apos;&apos;&apos;</span>,\n        }\n        <span class=\"hljs-comment\"># &#x8ba1;&#x6570;&#x53d8;&#x91cf;</span>\n        <span class=\"hljs-variable language_\">self</span>.i = <span class=\"hljs-number\">0</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">get_html</span>(<span class=\"hljs-params\">self,url</span>):\n        html = requests.get(url=url,headers=<span class=\"hljs-variable language_\">self</span>.headers).text\n        <span class=\"hljs-comment\"># &#x76f4;&#x63a5;&#x8c03;&#x7528;&#x89e3;&#x6790;&#x51fd;&#x6570;</span>\n        <span class=\"hljs-variable language_\">self</span>.parse_html(html)\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">parse_html</span>(<span class=\"hljs-params\">self,html</span>):\n        p = etree.HTML(html)\n        item = {}\n        <span class=\"hljs-comment\"># 1.&#x57fa;&#x51c6;xpath: dd&#x8282;&#x70b9;&#x5bf9;&#x8c61;&#x5217;&#x8868; [dd1,dd2,dd3]</span>\n        dd_list = p.xpath(<span class=\"hljs-string\">&apos;//dl[@class=&quot;board-wrapper&quot;]/dd&apos;</span>)\n        <span class=\"hljs-comment\"># 2.for&#x5faa;&#x73af;&#x904d;&#x5386;,&#x4f9d;&#x6b21;&#x63d0;&#x53d6;&#x6bcf;&#x4e2a;&#x7535;&#x5f71;&#x4fe1;&#x606f;</span>\n        <span class=\"hljs-keyword\">for</span> dd <span class=\"hljs-keyword\">in</span> dd_list:\n            item[<span class=\"hljs-string\">&apos;name&apos;</span>] = dd.xpath(<span class=\"hljs-string\">&apos;.//p[@class=&quot;name&quot;]/a/text()&apos;</span>)[<span class=\"hljs-number\">0</span>]\n            item[<span class=\"hljs-string\">&apos;star&apos;</span>] = dd.xpath(<span class=\"hljs-string\">&apos;.//p[@class=&quot;star&quot;]/text()&apos;</span>)[<span class=\"hljs-number\">0</span>].strip()\n            item[<span class=\"hljs-string\">&apos;releasetime&apos;</span>] = dd.xpath(<span class=\"hljs-string\">&apos;.//p[@class=&quot;releasetime&quot;]/text()&apos;</span>)[<span class=\"hljs-number\">0</span>].strip()[<span class=\"hljs-number\">5</span>:<span class=\"hljs-number\">15</span>]\n\n            <span class=\"hljs-built_in\">print</span>(item)\n            <span class=\"hljs-variable language_\">self</span>.i += <span class=\"hljs-number\">1</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">save_html</span>(<span class=\"hljs-params\">self,film_list</span>):\n        item = {}\n        <span class=\"hljs-keyword\">for</span> film <span class=\"hljs-keyword\">in</span> film_list:\n            item[<span class=\"hljs-string\">&apos;name&apos;</span>] = film[<span class=\"hljs-number\">0</span>].strip()\n            item[<span class=\"hljs-string\">&apos;star&apos;</span>] = film[<span class=\"hljs-number\">1</span>].strip()\n            item[<span class=\"hljs-string\">&apos;time&apos;</span>] = film[<span class=\"hljs-number\">2</span>].strip()[<span class=\"hljs-number\">5</span>:<span class=\"hljs-number\">15</span>]\n            <span class=\"hljs-built_in\">print</span>(item)\n            <span class=\"hljs-variable language_\">self</span>.i += <span class=\"hljs-number\">1</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">run</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-keyword\">for</span> offset <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(<span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">91</span>,<span class=\"hljs-number\">10</span>):\n            url = <span class=\"hljs-variable language_\">self</span>.url.<span class=\"hljs-built_in\">format</span>(offset)\n            <span class=\"hljs-variable language_\">self</span>.get_html(url)\n            <span class=\"hljs-comment\"># &#x4f11;&#x7720;</span>\n            time.sleep(random.uniform(<span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">1</span>))\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&apos;&#x6570;&#x91cf;:&apos;</span>,<span class=\"hljs-variable language_\">self</span>.i)\n\n<span class=\"hljs-keyword\">if</span> __name__ == <span class=\"hljs-string\">&apos;__main__&apos;</span>:\n    start = time.time()\n    spider = MaoyanSpider()\n    spider.run()\n    end = time.time()\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&apos;&#x6267;&#x884c;&#x65f6;&#x95f4;:%.2f&apos;</span> % (end-start))\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"459,522"}}],"payload":{"tag":"h3","lines":"457,458"}}],"payload":{"tag":"h2","lines":"422,423"}},{"content":"&#x94fe;&#x5bb6;&#x4e8c;&#x624b;&#x623f;&#x6848;&#x4f8b;&#xff08;xpath)","children":[{"content":"&#x5b9e;&#x73b0;&#x6b65;&#x9aa4;","children":[{"content":"&#x786e;&#x5b9a;&#x662f;&#x5426;&#x4e3a;&#x9759;&#x6001;","children":[{"content":"<pre data-lines=\"529,532\"><code class=\"language-python\">&#x6253;&#x5f00;&#x4e8c;&#x624b;&#x623f;&#x9875;&#x9762; -&gt; &#x67e5;&#x770b;&#x7f51;&#x9875;&#x6e90;&#x7801; -&gt; &#x641c;&#x7d22;&#x5173;&#x952e;&#x5b57;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"529,532"}}],"payload":{"tag":"h4","lines":"527,528"}},{"content":"xpath&#x8868;&#x8fbe;&#x5f0f;","children":[{"content":"<pre data-lines=\"535,557\"><code class=\"language-python\">&#x3010;<span class=\"hljs-number\">1</span>&#x3011;&#x57fa;&#x51c6;xpath&#x8868;&#x8fbe;&#x5f0f;(&#x5339;&#x914d;&#x6bcf;&#x4e2a;&#x623f;&#x6e90;&#x4fe1;&#x606f;&#x8282;&#x70b9;&#x5217;&#x8868;)\n    <span class=\"hljs-string\">&apos;&#x6b64;&#x5904;&#x6eda;&#x52a8;&#x9f20;&#x6807;&#x6ed1;&#x8f6e;&#x65f6;,li&#x8282;&#x70b9;&#x7684;class&#x5c5e;&#x6027;&#x503c;&#x4f1a;&#x53d1;&#x751f;&#x53d8;&#x5316;,&#x901a;&#x8fc7;&#x67e5;&#x770b;&#x7f51;&#x9875;&#x6e90;&#x7801;&#x786e;&#x5b9a;xpath&#x8868;&#x8fbe;&#x5f0f;&apos;</span>\n    //ul[@<span class=\"hljs-keyword\">class</span>=<span class=\"hljs-string\">&quot;sellListContent&quot;</span>]/li[@<span class=\"hljs-keyword\">class</span>=<span class=\"hljs-string\">&quot;clear LOGVIEWDATA LOGCLICKDATA&quot;</span>]\n\n&#x3010;<span class=\"hljs-number\">2</span>&#x3011;&#x4f9d;&#x6b21;&#x904d;&#x5386;&#x540e;&#x6bcf;&#x4e2a;&#x623f;&#x6e90;&#x4fe1;&#x606f;xpath&#x8868;&#x8fbe;&#x5f0f;\n   <span class=\"hljs-number\">2.1</span>)&#x540d;&#x79f0;: .//div[@<span class=\"hljs-keyword\">class</span>=<span class=\"hljs-string\">&quot;positionInfo&quot;</span>]/a[<span class=\"hljs-number\">1</span>]/text()\n   <span class=\"hljs-number\">2.2</span>)&#x5730;&#x5740;: .//div[@<span class=\"hljs-keyword\">class</span>=<span class=\"hljs-string\">&quot;positionInfo&quot;</span>]/a[<span class=\"hljs-number\">2</span>]/text()\n   <span class=\"hljs-number\">2.3</span>)&#x6237;&#x578b;+&#x9762;&#x79ef;+&#x65b9;&#x4f4d;+&#x662f;&#x5426;&#x7cbe;&#x88c5;+&#x697c;&#x5c42;+&#x5e74;&#x4ee3;+&#x7c7b;&#x578b;\n       info_list: <span class=\"hljs-string\">&apos;.//div[@class=&quot;houseInfo&quot;]/text()&apos;</span> -&gt;  [<span class=\"hljs-number\">0</span>].strip().split(<span class=\"hljs-string\">&apos;|&apos;</span>)\n       a)&#x6237;&#x578b;: info_list[<span class=\"hljs-number\">0</span>]\n       b)&#x9762;&#x79ef;: info_list[<span class=\"hljs-number\">1</span>]\n       c)&#x65b9;&#x4f4d;: info_list[<span class=\"hljs-number\">2</span>]\n       d)&#x7cbe;&#x88c5;: info_list[<span class=\"hljs-number\">3</span>]\n       e)&#x697c;&#x5c42;&#xff1a;info_list[<span class=\"hljs-number\">4</span>]\n       f)&#x5e74;&#x4ee3;: info_list[<span class=\"hljs-number\">5</span>]\n       g)&#x7c7b;&#x578b;: info_list[<span class=\"hljs-number\">6</span>]\n        \n    <span class=\"hljs-number\">2.4</span>)&#x603b;&#x4ef7;+&#x5355;&#x4ef7;\n       a)&#x603b;&#x4ef7;: .//div[@<span class=\"hljs-keyword\">class</span>=<span class=\"hljs-string\">&quot;totalPrice&quot;</span>]/span/text()\n       b)&#x5355;&#x4ef7;: .//div[@<span class=\"hljs-keyword\">class</span>=<span class=\"hljs-string\">&quot;unitPrice&quot;</span>]/span/text()\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"535,557"}}],"payload":{"tag":"h4","lines":"533,534"}},{"content":"&#x4ee3;&#x7801;&#x5b9e;&#x73b0;","children":[{"content":"<pre data-lines=\"560,631\"><code class=\"language-python\"><span class=\"hljs-keyword\">import</span> requests\n<span class=\"hljs-keyword\">from</span> lxml <span class=\"hljs-keyword\">import</span> etree\n<span class=\"hljs-keyword\">import</span> time\n<span class=\"hljs-keyword\">import</span> random\n<span class=\"hljs-keyword\">from</span> fake_useragent <span class=\"hljs-keyword\">import</span> UserAgent\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">LianjiaSpider</span>(<span class=\"hljs-title class_ inherited__\">object</span>):\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__init__</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-variable language_\">self</span>.url = <span class=\"hljs-string\">&apos;https://bj.lianjia.com/ershoufang/pg{}/&apos;</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">parse_html</span>(<span class=\"hljs-params\">self,url</span>):\n        headers = { <span class=\"hljs-string\">&apos;User-Agent&apos;</span>:UserAgent().random }\n        <span class=\"hljs-comment\"># &#x6709;&#x95ee;&#x9898;&#x9875;&#x9762;,&#x5c1d;&#x8bd5;3&#x6b21;,&#x5982;&#x679c;&#x4e0d;&#x884c;&#x76f4;&#x63a5;&#x6293;&#x53d6;&#x4e0b;&#x4e00;&#x9875;&#x6570;&#x636e;</span>\n        <span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(<span class=\"hljs-number\">3</span>):\n            <span class=\"hljs-keyword\">try</span>:\n                html = requests.get(url=url,headers=headers,timeout=<span class=\"hljs-number\">3</span>).content.decode(<span class=\"hljs-string\">&apos;utf-8&apos;</span>,<span class=\"hljs-string\">&apos;ignore&apos;</span>)\n                <span class=\"hljs-variable language_\">self</span>.get_data(html)\n                <span class=\"hljs-keyword\">break</span>\n            <span class=\"hljs-keyword\">except</span> Exception <span class=\"hljs-keyword\">as</span> e:\n                <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&apos;Retry&apos;</span>)\n\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">get_data</span>(<span class=\"hljs-params\">self,html</span>):\n        p = etree.HTML(html)\n        <span class=\"hljs-comment\"># &#x57fa;&#x51c6;xpath: [&lt;element li at xxx&gt;,&lt;element li&gt;]</span>\n        li_list = p.xpath(<span class=\"hljs-string\">&apos;//ul[@class=&quot;sellListContent&quot;]/li[@class=&quot;clear LOGVIEWDATA LOGCLICKDATA&quot;]&apos;</span>)\n        <span class=\"hljs-comment\"># for&#x904d;&#x5386;,&#x4f9d;&#x6b21;&#x63d0;&#x53d6;&#x6bcf;&#x4e2a;&#x623f;&#x6e90;&#x4fe1;&#x606f;,&#x653e;&#x5230;&#x5b57;&#x5178;item&#x4e2d;</span>\n        item = {}\n        <span class=\"hljs-keyword\">for</span> li <span class=\"hljs-keyword\">in</span> li_list:\n            <span class=\"hljs-comment\"># &#x540d;&#x79f0;+&#x533a;&#x57df;</span>\n            name_list = li.xpath(<span class=\"hljs-string\">&apos;.//div[@class=&quot;positionInfo&quot;]/a[1]/text()&apos;</span>)\n            item[<span class=\"hljs-string\">&apos;name&apos;</span>] = name_list[<span class=\"hljs-number\">0</span>].strip() <span class=\"hljs-keyword\">if</span> name_list <span class=\"hljs-keyword\">else</span> <span class=\"hljs-literal\">None</span>\n            address_list = li.xpath(<span class=\"hljs-string\">&apos;.//div[@class=&quot;positionInfo&quot;]/a[2]/text()&apos;</span>)\n            item[<span class=\"hljs-string\">&apos;address&apos;</span>] = address_list[<span class=\"hljs-number\">0</span>].strip() <span class=\"hljs-keyword\">if</span> address_list <span class=\"hljs-keyword\">else</span> <span class=\"hljs-literal\">None</span>\n            <span class=\"hljs-comment\"># &#x6237;&#x578b;+&#x9762;&#x79ef;+&#x65b9;&#x4f4d;+&#x662f;&#x5426;&#x7cbe;&#x88c5;+&#x697c;&#x5c42;+&#x5e74;&#x4ee3;+&#x7c7b;&#x578b;</span>\n            <span class=\"hljs-comment\"># h_list: [&apos;&apos;]</span>\n            h_list = li.xpath(<span class=\"hljs-string\">&apos;.//div[@class=&quot;houseInfo&quot;]/text()&apos;</span>)\n            <span class=\"hljs-keyword\">if</span> h_list:\n                info_list = h_list[<span class=\"hljs-number\">0</span>].split(<span class=\"hljs-string\">&apos;|&apos;</span>)\n                <span class=\"hljs-keyword\">if</span> <span class=\"hljs-built_in\">len</span>(info_list) == <span class=\"hljs-number\">7</span>:\n                    item[<span class=\"hljs-string\">&apos;model&apos;</span>] = info_list[<span class=\"hljs-number\">0</span>].strip()\n                    item[<span class=\"hljs-string\">&apos;area&apos;</span>] = info_list[<span class=\"hljs-number\">1</span>].strip()\n                    item[<span class=\"hljs-string\">&apos;direct&apos;</span>] = info_list[<span class=\"hljs-number\">2</span>].strip()\n                    item[<span class=\"hljs-string\">&apos;perfect&apos;</span>] = info_list[<span class=\"hljs-number\">3</span>].strip()\n                    item[<span class=\"hljs-string\">&apos;floor&apos;</span>] = info_list[<span class=\"hljs-number\">4</span>].strip()\n                    item[<span class=\"hljs-string\">&apos;year&apos;</span>] = info_list[<span class=\"hljs-number\">5</span>].strip()[:-<span class=\"hljs-number\">2</span>]\n                    item[<span class=\"hljs-string\">&apos;type&apos;</span>] = info_list[<span class=\"hljs-number\">6</span>].strip()\n                <span class=\"hljs-keyword\">else</span>:\n                    item[<span class=\"hljs-string\">&apos;model&apos;</span>] = item[<span class=\"hljs-string\">&apos;area&apos;</span>] = item[<span class=\"hljs-string\">&apos;direct&apos;</span>] = item[<span class=\"hljs-string\">&apos;perfect&apos;</span>] = item[<span class=\"hljs-string\">&apos;floor&apos;</span>] = item[<span class=\"hljs-string\">&apos;year&apos;</span>] = item[<span class=\"hljs-string\">&apos;type&apos;</span>] = <span class=\"hljs-literal\">None</span>\n            <span class=\"hljs-keyword\">else</span>:\n                item[<span class=\"hljs-string\">&apos;model&apos;</span>] = item[<span class=\"hljs-string\">&apos;area&apos;</span>] = item[<span class=\"hljs-string\">&apos;direct&apos;</span>] = item[<span class=\"hljs-string\">&apos;perfect&apos;</span>] = item[<span class=\"hljs-string\">&apos;floor&apos;</span>] = item[<span class=\"hljs-string\">&apos;year&apos;</span>] = item[<span class=\"hljs-string\">&apos;type&apos;</span>] = <span class=\"hljs-literal\">None</span>\n\n            <span class=\"hljs-comment\"># &#x603b;&#x4ef7;+&#x5355;&#x4ef7;</span>\n            total_list = li.xpath(<span class=\"hljs-string\">&apos;.//div[@class=&quot;totalPrice&quot;]/span/text()&apos;</span>)\n            item[<span class=\"hljs-string\">&apos;total&apos;</span>] = total_list[<span class=\"hljs-number\">0</span>].strip() <span class=\"hljs-keyword\">if</span> total_list <span class=\"hljs-keyword\">else</span> <span class=\"hljs-literal\">None</span>\n            unit_list = li.xpath(<span class=\"hljs-string\">&apos;.//div[@class=&quot;unitPrice&quot;]/span/text()&apos;</span>)\n            item[<span class=\"hljs-string\">&apos;unit&apos;</span>] = unit_list[<span class=\"hljs-number\">0</span>].strip() <span class=\"hljs-keyword\">if</span> unit_list <span class=\"hljs-keyword\">else</span> <span class=\"hljs-literal\">None</span>\n\n            <span class=\"hljs-built_in\">print</span>(item)\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">run</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-keyword\">for</span> pg <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(<span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">101</span>):\n            url = <span class=\"hljs-variable language_\">self</span>.url.<span class=\"hljs-built_in\">format</span>(pg)\n            <span class=\"hljs-variable language_\">self</span>.parse_html(url)\n            time.sleep(random.randint(<span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">2</span>))\n\n<span class=\"hljs-keyword\">if</span> __name__ == <span class=\"hljs-string\">&apos;__main__&apos;</span>:\n    spider = LianjiaSpider()\n    spider.run()\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"560,631"}}],"payload":{"tag":"h4","lines":"558,559"}},{"content":"&#x540e;&#x7eed;&#x81ea;&#x5df1;&#x5b8c;&#x6210;","children":[{"content":"<pre data-lines=\"634,638\"><code class=\"language-python\">&#x3010;1&#x3011;&#x5c06;&#x6570;&#x636e;&#x5b58;&#x5165;MongoDB&#x6570;&#x636e;&#x5e93;\n&#x3010;2&#x3011;&#x5c06;&#x6570;&#x636e;&#x5b58;&#x5165;MySQL&#x6570;&#x636e;&#x5e93;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"634,638"}}],"payload":{"tag":"h4","lines":"632,633"}}],"payload":{"tag":"h3","lines":"525,526"}}],"payload":{"tag":"h2","lines":"523,524"}},{"content":"requests.get()&#x53c2;&#x6570;","children":[{"content":"&#x67e5;&#x8be2;&#x53c2;&#x6570;-params","children":[{"content":"&#x53c2;&#x6570;&#x7c7b;&#x578b;","children":[{"content":"<pre data-lines=\"645,648\"><code class=\"language-python\">&#x5b57;&#x5178;,&#x5b57;&#x5178;&#x4e2d;&#x952e;&#x503c;&#x5bf9;&#x4f5c;&#x4e3a;&#x67e5;&#x8be2;&#x53c2;&#x6570;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"645,648"}}],"payload":{"tag":"h4","lines":"643,644"}},{"content":"&#x4f7f;&#x7528;&#x65b9;&#x6cd5;","children":[{"content":"<pre data-lines=\"651,657\"><code class=\"language-python\">1&#x3001;res = requests.get(url=baseurl,params=params,headers=headers)\n2&#x3001;&#x7279;&#x70b9;: \n   * url&#x4e3a;&#x57fa;&#x51c6;&#x7684;url&#x5730;&#x5740;&#xff0c;&#x4e0d;&#x5305;&#x542b;&#x67e5;&#x8be2;&#x53c2;&#x6570;\n   * &#x8be5;&#x65b9;&#x6cd5;&#x4f1a;&#x81ea;&#x52a8;&#x5bf9;params&#x5b57;&#x5178;&#x7f16;&#x7801;,&#x7136;&#x540e;&#x548c;url&#x62fc;&#x63a5;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"651,657"}}],"payload":{"tag":"h4","lines":"649,650"}},{"content":"&#x793a;&#x4f8b;","children":[{"content":"<pre data-lines=\"660,672\"><code class=\"language-python\"><span class=\"hljs-keyword\">import</span> requests\n\nbaseurl = <span class=\"hljs-string\">&apos;http://tieba.baidu.com/f?&apos;</span>\nparams = {\n  <span class=\"hljs-string\">&apos;kw&apos;</span> : <span class=\"hljs-string\">&apos;&#x8d75;&#x4e3d;&#x9896;&#x5427;&apos;</span>,\n  <span class=\"hljs-string\">&apos;pn&apos;</span> : <span class=\"hljs-string\">&apos;50&apos;</span>\n}\nheaders = {<span class=\"hljs-string\">&apos;User-Agent&apos;</span> : <span class=\"hljs-string\">&apos;Mozilla/4.0&apos;</span>}\n<span class=\"hljs-comment\"># &#x81ea;&#x52a8;&#x5bf9;params&#x8fdb;&#x884c;&#x7f16;&#x7801;,&#x7136;&#x540e;&#x81ea;&#x52a8;&#x548c;url&#x8fdb;&#x884c;&#x62fc;&#x63a5;,&#x53bb;&#x53d1;&#x8bf7;&#x6c42;</span>\nhtml = requests.get(url=baseurl,params=params,headers=headers).content.decode()\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"660,672"}}],"payload":{"tag":"h4","lines":"658,659"}},{"content":"&#x7ec3;&#x4e60;","children":[{"content":"<pre data-lines=\"675,678\"><code class=\"language-python\">&#x628a;&#x6293;&#x53d6;&#x767e;&#x5ea6;&#x8d34;&#x5427;&#x7684;&#x6848;&#x4f8b;&#x6539;&#x4e3a; params &#x53c2;&#x6570;&#x5b9e;&#x73b0;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"675,678"}}],"payload":{"tag":"h4","lines":"673,674"}}],"payload":{"tag":"h3","lines":"641,642"}}],"payload":{"tag":"h2","lines":"639,640"}},{"content":"SSL&#x8bc1;&#x4e66;&#x8ba4;&#x8bc1;&#x53c2;&#x6570;-verify","children":[{"content":"&#x9002;&#x7528;&#x7f51;&#x7ad9;&#x53ca;&#x573a;&#x666f;","children":[{"content":"<pre data-lines=\"683,687\"><code class=\"language-python\">&#x3010;1&#x3011;&#x9002;&#x7528;&#x7f51;&#x7ad9;: https&#x7c7b;&#x578b;&#x7f51;&#x7ad9;&#x4f46;&#x662f;&#x6ca1;&#x6709;&#x7ecf;&#x8fc7; &#x8bc1;&#x4e66;&#x8ba4;&#x8bc1;&#x673a;&#x6784; &#x8ba4;&#x8bc1;&#x7684;&#x7f51;&#x7ad9;\n&#x3010;2&#x3011;&#x9002;&#x7528;&#x573a;&#x666f;: &#x629b;&#x51fa; SSLError &#x5f02;&#x5e38;&#x5219;&#x8003;&#x8651;&#x4f7f;&#x7528;&#x6b64;&#x53c2;&#x6570;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"683,687"}}],"payload":{"tag":"h3","lines":"681,682"}},{"content":"&#x53c2;&#x6570;&#x7c7b;&#x578b;","children":[{"content":"<pre data-lines=\"690,696\"><code class=\"language-python\">&#x3010;<span class=\"hljs-number\">1</span>&#x3011;verify=<span class=\"hljs-literal\">True</span>(&#x9ed8;&#x8ba4;)   : &#x68c0;&#x67e5;&#x8bc1;&#x4e66;&#x8ba4;&#x8bc1;\n&#x3010;<span class=\"hljs-number\">2</span>&#x3011;verify=<span class=\"hljs-literal\">False</span>&#xff08;&#x5e38;&#x7528;&#xff09;: &#x5ffd;&#x7565;&#x8bc1;&#x4e66;&#x8ba4;&#x8bc1;\n&#x3010;<span class=\"hljs-number\">3</span>&#x3011;&#x793a;&#x4f8b;\n   res = requests.get(url=url,params=params,headers=headers,verify=<span class=\"hljs-literal\">False</span>)\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"690,696"}}],"payload":{"tag":"h3","lines":"688,689"}}],"payload":{"tag":"h2","lines":"679,680"}},{"content":"&#x4f5c;&#x4e1a; - &#x767e;&#x5ea6;&#x8d34;&#x5427;&#x56fe;&#x7247;&#x6293;&#x53d6;","children":[{"content":"&#x76ee;&#x6807;&#x601d;&#x8def;","children":[{"content":"&#x76ee;&#x6807;","children":[{"content":"<pre data-lines=\"703,706\"><code class=\"language-python\">&#x6293;&#x53d6;&#x6307;&#x5b9a;&#x8d34;&#x5427;&#x6240;&#x6709;&#x56fe;&#x7247;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"703,706"}}],"payload":{"tag":"h4","lines":"701,702"}},{"content":"&#x601d;&#x8def;","children":[{"content":"<pre data-lines=\"709,715\"><code class=\"language-python\">&#x3010;1&#x3011;&#x83b7;&#x53d6;&#x8d34;&#x5427;&#x4e3b;&#x9875;URL,&#x4e0b;&#x4e00;&#x9875;,&#x627e;&#x5230;&#x4e0d;&#x540c;&#x9875;&#x7684;URL&#x89c4;&#x5f8b;\n&#x3010;2&#x3011;&#x83b7;&#x53d6;1&#x9875;&#x4e2d;&#x6240;&#x6709;&#x5e16;&#x5b50;URL&#x5730;&#x5740;: [&#x5e16;&#x5b50;&#x94fe;&#x63a5;1,&#x5e16;&#x5b50;&#x94fe;&#x63a5;2,...]\n&#x3010;3&#x3011;&#x5bf9;&#x6bcf;&#x4e2a;&#x5e16;&#x5b50;&#x94fe;&#x63a5;&#x53d1;&#x8bf7;&#x6c42;,&#x83b7;&#x53d6;&#x56fe;&#x7247;URL&#x5217;&#x8868;: [&#x56fe;&#x7247;&#x94fe;&#x63a5;1,&#x56fe;&#x7247;&#x94fe;&#x63a5;2,...]\n&#x3010;4&#x3011;&#x4f9d;&#x6b21;&#x5411;&#x56fe;&#x7247;&#x7684;URL&#x53d1;&#x8bf7;&#x6c42;,&#x4ee5;wb&#x65b9;&#x5f0f;&#x5199;&#x5165;&#x672c;&#x5730;&#x6587;&#x4ef6;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"709,715"}}],"payload":{"tag":"h4","lines":"707,708"}}],"payload":{"tag":"h3","lines":"699,700"}},{"content":"&#x5b9e;&#x73b0;&#x6b65;&#x9aa4;","children":[{"content":"&#x8d34;&#x5427;URL&#x89c4;&#x5f8b;","children":[{"content":"<pre data-lines=\"720,723\"><code class=\"language-python\">http://tieba.baidu.com/f?kw=??&amp;pn=50\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"720,723"}}],"payload":{"tag":"h4","lines":"718,719"}},{"content":"xpath&#x8868;&#x8fbe;&#x5f0f;","children":[{"content":"<pre data-lines=\"726,741\"><code class=\"language-python\">&#x3010;<span class=\"hljs-number\">1</span>&#x3011;&#x5e16;&#x5b50;&#x94fe;&#x63a5;xpath\n   //div[@<span class=\"hljs-keyword\">class</span>=<span class=\"hljs-string\">&quot;t_con cleafix&quot;</span>]/div/div/div/a/@href\n    \n&#x3010;<span class=\"hljs-number\">2</span>&#x3011;&#x56fe;&#x7247;&#x94fe;&#x63a5;xpath\n   //div[@<span class=\"hljs-keyword\">class</span>=<span class=\"hljs-string\">&quot;d_post_content j_d_post_content  clearfix&quot;</span>]/img[@<span class=\"hljs-keyword\">class</span>=<span class=\"hljs-string\">&quot;BDE_Image&quot;</span>]/@src\n    \n&#x3010;<span class=\"hljs-number\">3</span>&#x3011;&#x89c6;&#x9891;&#x94fe;&#x63a5;xpath\n   //div[@<span class=\"hljs-keyword\">class</span>=<span class=\"hljs-string\">&quot;video_src_wrapper&quot;</span>]/embed/@data-video\n\n&#x3010;<span class=\"hljs-number\">4</span>&#x3011;&#x6ce8;&#x610f;\n    <span class=\"hljs-number\">4.1</span>) &#x52a1;&#x5fc5;&#x52a1;&#x5fc5;&#x4f7f;&#x7528;IE&#x7684;User-Agent\n    <span class=\"hljs-number\">4.2</span>) &#x4e00;&#x5207;&#x4ee5;&#x54cd;&#x5e94;&#x5185;&#x5bb9;&#x4e3a;&#x4e3b;\n    <span class=\"hljs-number\">4.3</span>) &#x89c6;&#x9891;&#x94fe;&#x63a5;&#x524d;&#x7aef;&#x5bf9;&#x54cd;&#x5e94;&#x5185;&#x5bb9;&#x505a;&#x4e86;&#x5904;&#x7406;,&#x9700;&#x8981;&#x67e5;&#x770b;&#x7f51;&#x9875;&#x6e90;&#x4ee3;&#x7801;&#x6765;&#x67e5;&#x770b;&#xff0c;&#x590d;&#x5236;HTML&#x4ee3;&#x7801;&#x5728;&#x7ebf;&#x683c;&#x5f0f;&#x5316;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"726,741"}}],"payload":{"tag":"h4","lines":"724,725"}}],"payload":{"tag":"h3","lines":"716,717"}},{"content":"&#x793a;&#x4f8b;","children":[{"content":"<pre data-lines=\"744,769\"><code class=\"language-python\"><span class=\"hljs-string\">&quot;&quot;&quot;\n&#x5c06;&#x8d75;&#x4e3d;&#x9896;&#x56fe;&#x7247;&#x4fdd;&#x5b58;&#x5230;&#x672c;&#x5730;\n1&#x3001;&#x627e;&#x5230;&#x56fe;&#x7247;&#x7684;URL&#x5730;&#x5740;\n2&#x3001;&#x5411;&#x56fe;&#x7247;&#x7684;URL&#x5730;&#x5740;&#x53d1;&#x8bf7;&#x6c42;,&#x83b7;&#x53d6; bytes &#x6570;&#x636e;&#x7c7b;&#x578b;,&#x4ee5; wb &#x7684;&#x65b9;&#x5f0f;&#x6253;&#x5f00;&#x6587;&#x4ef6;&#x5e76;&#x5199;&#x5165;\n/home/tarena/images/&#x8d75;&#x4e3d;&#x9896;/xxx.jpg\n&quot;&quot;&quot;</span>\n<span class=\"hljs-keyword\">import</span> requests\n<span class=\"hljs-keyword\">import</span> os\n\nurl = <span class=\"hljs-string\">&apos;https://timgsa.baidu.com/timg?image&amp;quality=80&amp;size=b9999_10000&amp;sec=1584677337219&amp;di=5e50843939656912b65b1d22ce57bf5e&amp;imgtype=0&amp;src=http%3A%2F%2Fimg.kutoo8.com%2Fupload%2Fimage%2F50896123%2F2014120809_960x540.jpg&apos;</span>\nheaders = {<span class=\"hljs-string\">&apos;User-Agent&apos;</span>:<span class=\"hljs-string\">&apos;Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/535.1 (KHTML, like Gecko) Chrome/14.0.835.163 Safari/535.1&apos;</span>}\n<span class=\"hljs-comment\"># &#x521b;&#x5efa;&#x5bf9;&#x5e94;&#x7684;&#x76ee;&#x5f55;</span>\ndirectory = <span class=\"hljs-string\">&apos;E:/images/&#x8d75;&#x4e3d;&#x9896;/&apos;</span>\ndirectory = <span class=\"hljs-string\">&apos;E:\\\\images\\\\&#x8d75;&#x4e3d;&#x9896;&apos;</span>\n<span class=\"hljs-keyword\">if</span> <span class=\"hljs-keyword\">not</span> os.path.exists(directory):\n    os.makedirs(directory)\n\nhtml = requests.get(url=url, headers=headers).content\n<span class=\"hljs-comment\"># filename: E:/images/&#x8d75;&#x4e3d;&#x9896;/xxxxx.jpg</span>\nfilename = directory + url[-<span class=\"hljs-number\">20</span>:]\n<span class=\"hljs-keyword\">with</span> <span class=\"hljs-built_in\">open</span>(filename,<span class=\"hljs-string\">&apos;wb&apos;</span>) <span class=\"hljs-keyword\">as</span> f:\n    f.write(html)\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"744,769"}},{"content":"<pre data-lines=\"770,831\"><code class=\"language-python\"><span class=\"hljs-string\">&quot;&quot;&quot;\n&#x5199;&#x6b63;&#x5219;&#x8868;&#x8fbe;&#x5f0f;&#x65f6;,&#x4e00;&#x5b9a;&#x8981;&#x4ee5;&#x54cd;&#x5e94;&#x5185;&#x5bb9;&#x4e3a;&#x51c6;&#xff01;&#xff01;&#xff01;\n&#x5199;&#x6b63;&#x5219;&#x8868;&#x8fbe;&#x5f0f;&#x65f6;,&#x4e00;&#x5b9a;&#x8981;&#x4ee5;&#x54cd;&#x5e94;&#x5185;&#x5bb9;&#x4e3a;&#x51c6;&#xff01;&#xff01;&#xff01;\n&#x5199;&#x6b63;&#x5219;&#x8868;&#x8fbe;&#x5f0f;&#x65f6;,&#x4e00;&#x5b9a;&#x8981;&#x4ee5;&#x54cd;&#x5e94;&#x5185;&#x5bb9;&#x4e3a;&#x51c6;&#xff01;&#xff01;&#xff01;\n&quot;&quot;&quot;</span>\n<span class=\"hljs-keyword\">import</span> requests\n<span class=\"hljs-keyword\">import</span> re\n<span class=\"hljs-keyword\">from</span> urllib <span class=\"hljs-keyword\">import</span> parse\n<span class=\"hljs-keyword\">import</span> time\n<span class=\"hljs-keyword\">import</span> random\n<span class=\"hljs-keyword\">import</span> os\n<span class=\"hljs-keyword\">from</span> useragents <span class=\"hljs-keyword\">import</span> agent_list\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">BaiduImageSpider</span>:\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__init__</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-variable language_\">self</span>.url = <span class=\"hljs-string\">&apos;https://image.baidu.com/search/index?tn=baiduimage&amp;word={}&apos;</span>\n        <span class=\"hljs-comment\"># &#x8ba1;&#x6570;</span>\n        <span class=\"hljs-variable language_\">self</span>.i = <span class=\"hljs-number\">1</span>\n        <span class=\"hljs-comment\"># &#x521b;&#x5efa;&#x5bf9;&#x5e94;&#x6587;&#x4ef6;&#x5939;</span>\n        <span class=\"hljs-variable language_\">self</span>.word = <span class=\"hljs-built_in\">input</span>(<span class=\"hljs-string\">&apos;&#x8bf7;&#x8f93;&#x5165;&#x5173;&#x952e;&#x5b57;:&apos;</span>)\n        <span class=\"hljs-variable language_\">self</span>.directory = <span class=\"hljs-string\">&apos;E:/home/tarena/images/{}/&apos;</span>.<span class=\"hljs-built_in\">format</span>(<span class=\"hljs-variable language_\">self</span>.word)\n        <span class=\"hljs-keyword\">if</span> <span class=\"hljs-keyword\">not</span> os.path.exists(<span class=\"hljs-variable language_\">self</span>.directory):\n            os.makedirs(<span class=\"hljs-variable language_\">self</span>.directory)\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">get_agent</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x83b7;&#x53d6;&#x968f;&#x673a;&#x7684;User-Agent&#x529f;&#x80fd;&#x51fd;&#x6570;&quot;&quot;&quot;</span>\n        <span class=\"hljs-keyword\">return</span> random.choice(agent_list)\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">get_html</span>(<span class=\"hljs-params\">self</span>):\n        url = <span class=\"hljs-variable language_\">self</span>.url.<span class=\"hljs-built_in\">format</span>(parse.quote(<span class=\"hljs-variable language_\">self</span>.word))\n        html = requests.get(url=url,headers={<span class=\"hljs-string\">&apos;User-Agent&apos;</span>:<span class=\"hljs-variable language_\">self</span>.get_agent()}).text\n        <span class=\"hljs-comment\"># &#x63d0;&#x53d6;&#x6240;&#x6709;&#x56fe;&#x7247;&#x7684;URL&#x5730;&#x5740;,img_url_list: [&apos;http://img1.jpg&apos;,&apos;http://img2.jpg&apos;]</span>\n        pattern = re.<span class=\"hljs-built_in\">compile</span>(<span class=\"hljs-string\">&apos;&quot;thumbURL&quot;:&quot;(.*?)&quot;&apos;</span>,re.S)\n        img_url_list = pattern.findall(html)\n        <span class=\"hljs-keyword\">for</span> img_url <span class=\"hljs-keyword\">in</span> img_url_list:\n            <span class=\"hljs-keyword\">if</span> img_url.startswith(<span class=\"hljs-string\">&apos;http&apos;</span>):\n                <span class=\"hljs-comment\"># &#x628a;1&#x5f20;&#x56fe;&#x7247;&#x94fe;&#x63a5;&#x4fdd;&#x5b58;&#x5230;&#x672c;&#x5730;</span>\n                <span class=\"hljs-variable language_\">self</span>.save_image(img_url)\n                <span class=\"hljs-comment\"># &#x63a7;&#x5236;&#x722c;&#x53d6;&#x9891;&#x7387;</span>\n                time.sleep(random.uniform(<span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">1</span>))\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">save_image</span>(<span class=\"hljs-params\">self, img_url</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x4fdd;&#x5b58;1&#x5f20;&#x56fe;&#x7247;&#x5230;&#x672c;&#x5730;&quot;&quot;&quot;</span>\n        html = requests.get(url=img_url,headers={<span class=\"hljs-string\">&apos;User-Agent&apos;</span>:<span class=\"hljs-variable language_\">self</span>.get_agent()}).content\n        <span class=\"hljs-comment\"># filename: /home/tarena/images/&#x8d75;&#x4e3d;&#x9896;/&#x8d75;&#x4e3d;&#x9896;_1.jpg</span>\n        filename = <span class=\"hljs-variable language_\">self</span>.directory + <span class=\"hljs-variable language_\">self</span>.word + <span class=\"hljs-string\">&apos;_&apos;</span> + <span class=\"hljs-built_in\">str</span>(<span class=\"hljs-variable language_\">self</span>.i) + <span class=\"hljs-string\">&apos;.&apos;</span> + img_url.split(<span class=\"hljs-string\">&apos;.&apos;</span>)[-<span class=\"hljs-number\">1</span>]\n        <span class=\"hljs-keyword\">with</span> <span class=\"hljs-built_in\">open</span>(filename,<span class=\"hljs-string\">&apos;wb&apos;</span>) <span class=\"hljs-keyword\">as</span> f:\n            f.write(html)\n        <span class=\"hljs-variable language_\">self</span>.i += <span class=\"hljs-number\">1</span>\n        <span class=\"hljs-built_in\">print</span>(filename,<span class=\"hljs-string\">&apos;&#x6293;&#x53d6;&#x6210;&#x529f;&apos;</span>)\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">run</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x7a0b;&#x5e8f;&#x5165;&#x53e3;&#x51fd;&#x6570;&quot;&quot;&quot;</span>\n        <span class=\"hljs-variable language_\">self</span>.get_html()\n\n<span class=\"hljs-keyword\">if</span> __name__ == <span class=\"hljs-string\">&apos;__main__&apos;</span>:\n    spider = BaiduImageSpider()\n    spider.run()\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"770,831"}},{"content":"<pre data-lines=\"832,893\"><code class=\"language-python\"><span class=\"hljs-string\">&quot;&quot;&quot;\n&#x5199;&#x6b63;&#x5219;&#x8868;&#x8fbe;&#x5f0f;&#x65f6;,&#x4e00;&#x5b9a;&#x8981;&#x4ee5;&#x54cd;&#x5e94;&#x5185;&#x5bb9;&#x4e3a;&#x51c6;&#xff01;&#xff01;&#xff01;\n&#x5199;&#x6b63;&#x5219;&#x8868;&#x8fbe;&#x5f0f;&#x65f6;,&#x4e00;&#x5b9a;&#x8981;&#x4ee5;&#x54cd;&#x5e94;&#x5185;&#x5bb9;&#x4e3a;&#x51c6;&#xff01;&#xff01;&#xff01;\n&#x5199;&#x6b63;&#x5219;&#x8868;&#x8fbe;&#x5f0f;&#x65f6;,&#x4e00;&#x5b9a;&#x8981;&#x4ee5;&#x54cd;&#x5e94;&#x5185;&#x5bb9;&#x4e3a;&#x51c6;&#xff01;&#xff01;&#xff01;\n&quot;&quot;&quot;</span>\n<span class=\"hljs-keyword\">import</span> requests\n<span class=\"hljs-keyword\">import</span> re\n<span class=\"hljs-keyword\">from</span> urllib <span class=\"hljs-keyword\">import</span> parse\n<span class=\"hljs-keyword\">import</span> time\n<span class=\"hljs-keyword\">import</span> random\n<span class=\"hljs-keyword\">import</span> os\n<span class=\"hljs-keyword\">from</span> fake_useragent <span class=\"hljs-keyword\">import</span> UserAgent\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">BaiduImageSpider</span>:\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__init__</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-variable language_\">self</span>.url = <span class=\"hljs-string\">&apos;https://image.baidu.com/search/index?tn=baiduimage&amp;word={}&apos;</span>\n        <span class=\"hljs-comment\"># &#x8ba1;&#x6570;</span>\n        <span class=\"hljs-variable language_\">self</span>.i = <span class=\"hljs-number\">1</span>\n        <span class=\"hljs-comment\"># &#x521b;&#x5efa;&#x5bf9;&#x5e94;&#x6587;&#x4ef6;&#x5939;</span>\n        <span class=\"hljs-variable language_\">self</span>.word = <span class=\"hljs-built_in\">input</span>(<span class=\"hljs-string\">&apos;&#x8bf7;&#x8f93;&#x5165;&#x5173;&#x952e;&#x5b57;:&apos;</span>)\n        <span class=\"hljs-variable language_\">self</span>.directory = <span class=\"hljs-string\">&apos;E:/home/tarena/images/{}/&apos;</span>.<span class=\"hljs-built_in\">format</span>(<span class=\"hljs-variable language_\">self</span>.word)\n        <span class=\"hljs-keyword\">if</span> <span class=\"hljs-keyword\">not</span> os.path.exists(<span class=\"hljs-variable language_\">self</span>.directory):\n            os.makedirs(<span class=\"hljs-variable language_\">self</span>.directory)\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">get_agent</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x83b7;&#x53d6;&#x968f;&#x673a;&#x7684;User-Agent&#x529f;&#x80fd;&#x51fd;&#x6570;&quot;&quot;&quot;</span>\n        <span class=\"hljs-keyword\">return</span> UserAgent().random\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">get_html</span>(<span class=\"hljs-params\">self</span>):\n        url = <span class=\"hljs-variable language_\">self</span>.url.<span class=\"hljs-built_in\">format</span>(parse.quote(<span class=\"hljs-variable language_\">self</span>.word))\n        html = requests.get(url=url,headers={<span class=\"hljs-string\">&apos;User-Agent&apos;</span>:<span class=\"hljs-variable language_\">self</span>.get_agent()}).text\n        <span class=\"hljs-comment\"># &#x63d0;&#x53d6;&#x6240;&#x6709;&#x56fe;&#x7247;&#x7684;URL&#x5730;&#x5740;,img_url_list: [&apos;http://img1.jpg&apos;,&apos;http://img2.jpg&apos;]</span>\n        pattern = re.<span class=\"hljs-built_in\">compile</span>(<span class=\"hljs-string\">&apos;&quot;thumbURL&quot;:&quot;(.*?)&quot;&apos;</span>,re.S)\n        img_url_list = pattern.findall(html)\n        <span class=\"hljs-keyword\">for</span> img_url <span class=\"hljs-keyword\">in</span> img_url_list:\n            <span class=\"hljs-keyword\">if</span> img_url.startswith(<span class=\"hljs-string\">&apos;http&apos;</span>):\n                <span class=\"hljs-comment\"># &#x628a;1&#x5f20;&#x56fe;&#x7247;&#x94fe;&#x63a5;&#x4fdd;&#x5b58;&#x5230;&#x672c;&#x5730;</span>\n                <span class=\"hljs-variable language_\">self</span>.save_image(img_url)\n                <span class=\"hljs-comment\"># &#x63a7;&#x5236;&#x722c;&#x53d6;&#x9891;&#x7387;</span>\n                time.sleep(random.uniform(<span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">1</span>))\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">save_image</span>(<span class=\"hljs-params\">self, img_url</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x4fdd;&#x5b58;1&#x5f20;&#x56fe;&#x7247;&#x5230;&#x672c;&#x5730;&quot;&quot;&quot;</span>\n        html = requests.get(url=img_url,headers={<span class=\"hljs-string\">&apos;User-Agent&apos;</span>:<span class=\"hljs-variable language_\">self</span>.get_agent()}).content\n        <span class=\"hljs-comment\"># filename: /home/tarena/images/&#x8d75;&#x4e3d;&#x9896;/&#x8d75;&#x4e3d;&#x9896;_1.jpg</span>\n        filename = <span class=\"hljs-variable language_\">self</span>.directory + <span class=\"hljs-variable language_\">self</span>.word + <span class=\"hljs-string\">&apos;_&apos;</span> + <span class=\"hljs-built_in\">str</span>(<span class=\"hljs-variable language_\">self</span>.i) + <span class=\"hljs-string\">&apos;.&apos;</span> + img_url.split(<span class=\"hljs-string\">&apos;.&apos;</span>)[-<span class=\"hljs-number\">1</span>]\n        <span class=\"hljs-keyword\">with</span> <span class=\"hljs-built_in\">open</span>(filename,<span class=\"hljs-string\">&apos;wb&apos;</span>) <span class=\"hljs-keyword\">as</span> f:\n            f.write(html)\n        <span class=\"hljs-variable language_\">self</span>.i += <span class=\"hljs-number\">1</span>\n        <span class=\"hljs-built_in\">print</span>(filename,<span class=\"hljs-string\">&apos;&#x6293;&#x53d6;&#x6210;&#x529f;&apos;</span>)\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">run</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x7a0b;&#x5e8f;&#x5165;&#x53e3;&#x51fd;&#x6570;&quot;&quot;&quot;</span>\n        <span class=\"hljs-variable language_\">self</span>.get_html()\n\n<span class=\"hljs-keyword\">if</span> __name__ == <span class=\"hljs-string\">&apos;__main__&apos;</span>:\n    spider = BaiduImageSpider()\n    spider.run()\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"832,893"}},{"content":"<pre data-lines=\"894,972\"><code class=\"language-python\"><span class=\"hljs-string\">&quot;&quot;&quot;\n&#x6293;&#x53d6;&#x732b;&#x773c;&#x7535;&#x5f71; - &#x699c;&#x5355; - top100&#x699c;&#xff08;&#x540d;&#x79f0;&#x3001;&#x4e3b;&#x6f14;&#x3001;&#x4e0a;&#x6620;&#x65f6;&#x95f4;&#xff09;\n&quot;&quot;&quot;</span>\n<span class=\"hljs-keyword\">import</span> requests\n<span class=\"hljs-keyword\">import</span> time\n<span class=\"hljs-keyword\">import</span> random\n<span class=\"hljs-keyword\">import</span> csv\n<span class=\"hljs-keyword\">from</span> lxml <span class=\"hljs-keyword\">import</span> etree\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">MaoyanSpider</span>:\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__init__</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-variable language_\">self</span>.url = <span class=\"hljs-string\">&apos;https://maoyan.com/board/4?offset={}&apos;</span>\n        <span class=\"hljs-comment\"># &#x732b;&#x773c;&#x7535;&#x5f71;&#x53cd;&#x722c;&#xff1a;&#x4f7f;&#x7528;&#x8f83;&#x8001;&#x7684;User-Agent&#x4f1a;&#x8df3;&#x5230;&#x9a8c;&#x8bc1;&#x4e2d;&#x5fc3;</span>\n        <span class=\"hljs-variable language_\">self</span>.headers = {\n            <span class=\"hljs-string\">&apos;&apos;&apos;Accept-Encoding&apos;&apos;&apos;</span>: <span class=\"hljs-string\">&apos;&apos;&apos;gzip, deflate, br&apos;&apos;&apos;</span>,\n            <span class=\"hljs-string\">&apos;&apos;&apos;Upgrade-Insecure-Requests&apos;&apos;&apos;</span>: <span class=\"hljs-string\">&apos;&apos;&apos;1&apos;&apos;&apos;</span>,\n            <span class=\"hljs-string\">&apos;&apos;&apos;User-Agent&apos;&apos;&apos;</span>: <span class=\"hljs-string\">&apos;&apos;&apos;Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.132 Safari/537.36&apos;&apos;&apos;</span>,\n        }\n        <span class=\"hljs-comment\"># &#x8ba1;&#x6570;</span>\n        <span class=\"hljs-variable language_\">self</span>.i = <span class=\"hljs-number\">0</span>\n        <span class=\"hljs-comment\"># &#x6253;&#x5f00;&#x6587;&#x4ef6; + &#x521d;&#x59cb;&#x5316;&#x5199;&#x5165;&#x5bf9;&#x8c61;</span>\n        <span class=\"hljs-variable language_\">self</span>.f = <span class=\"hljs-built_in\">open</span>(<span class=\"hljs-string\">&apos;maoyan.csv&apos;</span>,<span class=\"hljs-string\">&apos;w&apos;</span>,newline=<span class=\"hljs-string\">&apos;&apos;</span>)\n        <span class=\"hljs-variable language_\">self</span>.writer = csv.writer(<span class=\"hljs-variable language_\">self</span>.f)\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">get_html</span>(<span class=\"hljs-params\">self, url</span>):\n        html = requests.get(url=url, headers=<span class=\"hljs-variable language_\">self</span>.headers).text\n        <span class=\"hljs-built_in\">print</span>(html)\n        <span class=\"hljs-comment\"># &#x76f4;&#x63a5;&#x8c03;&#x7528;&#x89e3;&#x6790;&#x51fd;&#x6570;</span>\n        <span class=\"hljs-variable language_\">self</span>.parse_html(html)\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">parse_html</span>(<span class=\"hljs-params\">self, html</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;lxml+xpath&#x89e3;&#x6790;&#x63d0;&#x53d6;&#x5177;&#x4f53;&#x7535;&#x5f71;&#x6570;&#x636e;&quot;&quot;&quot;</span>\n        p = etree.HTML(html)\n        <span class=\"hljs-comment\"># 1&#x3001;&#x57fa;&#x51c6;xpath&#xff1a;[&lt;element dd at xxx&gt;,&lt;element dd at xxx&gt;,...,&lt;element dd at xxx&gt;]</span>\n        dd_list = p.xpath(<span class=\"hljs-string\">&apos;//dl[@class=&quot;board-wrapper&quot;]/dd&apos;</span>)\n        item = {}\n        <span class=\"hljs-keyword\">for</span> dd <span class=\"hljs-keyword\">in</span> dd_list:\n            item[<span class=\"hljs-string\">&apos;name&apos;</span>] = dd.xpath(<span class=\"hljs-string\">&apos;.//p[@class=&quot;name&quot;]/a/text()&apos;</span>)[<span class=\"hljs-number\">0</span>].strip()\n            item[<span class=\"hljs-string\">&apos;star&apos;</span>] = dd.xpath(<span class=\"hljs-string\">&apos;.//p[@class=&quot;star&quot;]/text()&apos;</span>)[<span class=\"hljs-number\">0</span>].strip()\n            item[<span class=\"hljs-string\">&apos;time&apos;</span>] = dd.xpath(<span class=\"hljs-string\">&apos;.//p[@class=&quot;releasetime&quot;]/text()&apos;</span>)[<span class=\"hljs-number\">0</span>].strip()\n\n            <span class=\"hljs-built_in\">print</span>(item)\n            <span class=\"hljs-variable language_\">self</span>.i += <span class=\"hljs-number\">1</span>\n\n\n\n\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">save_html</span>(<span class=\"hljs-params\">self, r_list</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x5904;&#x7406;&#x5177;&#x4f53;&#x7535;&#x5f71;&#x6570;&#x636e;&quot;&quot;&quot;</span>\n        <span class=\"hljs-keyword\">for</span> r <span class=\"hljs-keyword\">in</span> r_list:\n            li = [\n                r[<span class=\"hljs-number\">0</span>].strip(),\n                r[<span class=\"hljs-number\">1</span>].strip()[<span class=\"hljs-number\">3</span>:],\n                r[<span class=\"hljs-number\">2</span>].strip()[<span class=\"hljs-number\">5</span>:<span class=\"hljs-number\">15</span>]\n            ]\n            <span class=\"hljs-variable language_\">self</span>.writer.writerow(li)\n            <span class=\"hljs-built_in\">print</span>(li)\n            <span class=\"hljs-variable language_\">self</span>.i += <span class=\"hljs-number\">1</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">run</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x7a0b;&#x5e8f;&#x5165;&#x53e3;&#x51fd;&#x6570;&quot;&quot;&quot;</span>\n        <span class=\"hljs-keyword\">for</span> offset <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(<span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">91</span>,<span class=\"hljs-number\">10</span>):\n            url = <span class=\"hljs-variable language_\">self</span>.url.<span class=\"hljs-built_in\">format</span>(offset)\n            <span class=\"hljs-variable language_\">self</span>.get_html(url=url)\n            <span class=\"hljs-comment\"># &#x63a7;&#x5236;&#x722c;&#x53d6;&#x901f;&#x5ea6;: uniform(0,2) &#x751f;&#x6210;0-2&#x4e4b;&#x95f4;&#x7684;&#x6d6e;&#x70b9;&#x6570;</span>\n            time.sleep(random.uniform(<span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">4</span>))\n        <span class=\"hljs-comment\"># &#x5173;&#x95ed;&#x6587;&#x4ef6;</span>\n        <span class=\"hljs-variable language_\">self</span>.f.close()\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&apos;&#x6570;&#x91cf;:&apos;</span>,<span class=\"hljs-variable language_\">self</span>.i)\n\n<span class=\"hljs-keyword\">if</span> __name__ == <span class=\"hljs-string\">&apos;__main__&apos;</span>:\n    spider = MaoyanSpider()\n    spider.run()\n\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"894,972"}},{"content":"<pre data-lines=\"973,1048\"><code class=\"language-python\"><span class=\"hljs-string\">&quot;&quot;&quot;\n&#x94fe;&#x5bb6;&#x4e8c;&#x624b;&#x623f;\n&quot;&quot;&quot;</span>\n<span class=\"hljs-keyword\">import</span> requests\n<span class=\"hljs-keyword\">from</span> lxml <span class=\"hljs-keyword\">import</span> etree\n<span class=\"hljs-keyword\">import</span> time\n<span class=\"hljs-keyword\">import</span> random\n<span class=\"hljs-keyword\">from</span> useragents <span class=\"hljs-keyword\">import</span> agent_list\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">LianjiaSpider</span>:\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__init__</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-variable language_\">self</span>.url = <span class=\"hljs-string\">&apos;https://bj.lianjia.com/ershoufang/pg{}/&apos;</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">get_html</span>(<span class=\"hljs-params\">self, url</span>):\n        <span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(<span class=\"hljs-number\">3</span>):\n            <span class=\"hljs-keyword\">try</span>:\n                html = requests.get(url=url, headers={<span class=\"hljs-string\">&apos;User-Agent&apos;</span>:random.choice(agent_list)}, timeout=<span class=\"hljs-number\">3</span>).text\n                <span class=\"hljs-comment\"># &#x76f4;&#x63a5;&#x8c03;&#x7528;&#x89e3;&#x6790;&#x51fd;&#x6570;</span>\n                <span class=\"hljs-variable language_\">self</span>.parse_html(html)\n                <span class=\"hljs-keyword\">break</span>\n            <span class=\"hljs-keyword\">except</span> Exception <span class=\"hljs-keyword\">as</span> e:\n                <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&apos;Retry&apos;</span>)\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">parse_html</span>(<span class=\"hljs-params\">self, html</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x89e3;&#x6790;&#x63d0;&#x53d6;&#x6570;&#x636e;&quot;&quot;&quot;</span>\n        <span class=\"hljs-comment\"># 1&#x3001;&#x521b;&#x5efa;&#x89e3;&#x6790;&#x5bf9;&#x8c61;</span>\n        p = etree.HTML(html)\n        <span class=\"hljs-comment\"># 2&#x3001;&#x57fa;&#x51c6;xpath  li_list: [&lt;element li at xxx&gt;,&lt;element li at xxx&gt;,...,&lt;element li at xx&gt;]</span>\n        li_list = p.xpath(<span class=\"hljs-string\">&apos;//ul[@class=&quot;sellListContent&quot;]/li[@class=&quot;clear LOGVIEWDATA LOGCLICKDATA&quot;]&apos;</span>)\n        <span class=\"hljs-comment\"># 3&#x3001;&#x904d;&#x5386;,&#x4f9d;&#x6b21;&#x63d0;&#x53d6;&#x6bcf;&#x4e2a;&#x623f;&#x6e90;&#x4fe1;&#x606f;,&#x653e;&#x5230;&#x4e00;&#x4e2a;&#x5b57;&#x5178;&#x4e2d;</span>\n        item = {}\n        <span class=\"hljs-keyword\">for</span> li <span class=\"hljs-keyword\">in</span> li_list:\n            <span class=\"hljs-comment\"># &#x540d;&#x79f0; + &#x5730;&#x5740;</span>\n            name_list = li.xpath(<span class=\"hljs-string\">&apos;.//div[@class=&quot;positionInfo&quot;]/a[1]/text()&apos;</span>)\n            item[<span class=\"hljs-string\">&apos;name&apos;</span>] = name_list[<span class=\"hljs-number\">0</span>].strip() <span class=\"hljs-keyword\">if</span> name_list <span class=\"hljs-keyword\">else</span> <span class=\"hljs-literal\">None</span>\n            address_list = li.xpath(<span class=\"hljs-string\">&apos;.//div[@class=&quot;positionInfo&quot;]/a[2]/text()&apos;</span>)\n            item[<span class=\"hljs-string\">&apos;address&apos;</span>] = address_list[<span class=\"hljs-number\">0</span>].strip() <span class=\"hljs-keyword\">if</span> address_list <span class=\"hljs-keyword\">else</span> <span class=\"hljs-literal\">None</span>\n            <span class=\"hljs-comment\"># &#x6237;&#x578b;+&#x9762;&#x79ef;+&#x65b9;&#x4f4d;+&#x662f;&#x5426;&#x7cbe;&#x88c5;+&#x697c;&#x5c42;+&#x5e74;&#x4ee3;+&#x7c7b;&#x578b;</span>\n            <span class=\"hljs-comment\"># info_list: [&apos;&#x4e24;&#x5ba4;&#x4e00;&#x5385; | 78.88 | &#x5357;&#x5317; | &#x7cbe;&#x88c5;&#x4fee; | 12&#x5c42; | 2005 | &#x677f;&#x697c;&apos;]</span>\n            info_list = li.xpath(<span class=\"hljs-string\">&apos;.//div[@class=&quot;houseInfo&quot;]/text()&apos;</span>)\n            <span class=\"hljs-keyword\">if</span> info_list:\n                info_list = info_list[<span class=\"hljs-number\">0</span>].split(<span class=\"hljs-string\">&apos;|&apos;</span>)\n                <span class=\"hljs-keyword\">if</span> <span class=\"hljs-built_in\">len</span>(info_list) == <span class=\"hljs-number\">7</span>:\n                    item[<span class=\"hljs-string\">&apos;model&apos;</span>] = info_list[<span class=\"hljs-number\">0</span>].strip()\n                    item[<span class=\"hljs-string\">&apos;area&apos;</span>] = info_list[<span class=\"hljs-number\">1</span>].strip()\n                    item[<span class=\"hljs-string\">&apos;direct&apos;</span>] = info_list[<span class=\"hljs-number\">2</span>].strip()\n                    item[<span class=\"hljs-string\">&apos;perfect&apos;</span>] = info_list[<span class=\"hljs-number\">3</span>].strip()\n                    item[<span class=\"hljs-string\">&apos;floor&apos;</span>] = info_list[<span class=\"hljs-number\">4</span>].strip()\n                    item[<span class=\"hljs-string\">&apos;year&apos;</span>] = info_list[<span class=\"hljs-number\">5</span>].strip()\n                    item[<span class=\"hljs-string\">&apos;type&apos;</span>] = info_list[<span class=\"hljs-number\">6</span>].strip()\n                <span class=\"hljs-keyword\">else</span>:\n                    item[<span class=\"hljs-string\">&apos;model&apos;</span>]=item[<span class=\"hljs-string\">&apos;area&apos;</span>]=item[<span class=\"hljs-string\">&apos;direct&apos;</span>]=item[<span class=\"hljs-string\">&apos;perfect&apos;</span>]=item[<span class=\"hljs-string\">&apos;floor&apos;</span>]=item[<span class=\"hljs-string\">&apos;year&apos;</span>]=item[<span class=\"hljs-string\">&apos;type&apos;</span>] = <span class=\"hljs-literal\">None</span>\n            <span class=\"hljs-keyword\">else</span>:\n                item[<span class=\"hljs-string\">&apos;model&apos;</span>] = item[<span class=\"hljs-string\">&apos;area&apos;</span>] = item[<span class=\"hljs-string\">&apos;direct&apos;</span>] = item[<span class=\"hljs-string\">&apos;perfect&apos;</span>] = item[<span class=\"hljs-string\">&apos;floor&apos;</span>] = item[<span class=\"hljs-string\">&apos;year&apos;</span>] = item[<span class=\"hljs-string\">&apos;type&apos;</span>] = <span class=\"hljs-literal\">None</span>\n            <span class=\"hljs-comment\"># &#x603b;&#x4ef7; + &#x5355;&#x4ef7;</span>\n            total_list = p.xpath(<span class=\"hljs-string\">&apos;.//div[@class=&quot;totalPrice&quot;]/span/text()&apos;</span>)\n            item[<span class=\"hljs-string\">&apos;total&apos;</span>] = total_list[<span class=\"hljs-number\">0</span>].strip() <span class=\"hljs-keyword\">if</span> total_list <span class=\"hljs-keyword\">else</span> <span class=\"hljs-literal\">None</span>\n            unit_list = p.xpath(<span class=\"hljs-string\">&apos;.//div[@class=&quot;unitPrice&quot;]/span/text()&apos;</span>)\n            item[<span class=\"hljs-string\">&apos;unit&apos;</span>] = unit_list[<span class=\"hljs-number\">0</span>].strip() <span class=\"hljs-keyword\">if</span> unit_list <span class=\"hljs-keyword\">else</span> <span class=\"hljs-literal\">None</span>\n\n            <span class=\"hljs-built_in\">print</span>(item)\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">run</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(<span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">101</span>):\n            url = <span class=\"hljs-variable language_\">self</span>.url.<span class=\"hljs-built_in\">format</span>(i)\n            <span class=\"hljs-variable language_\">self</span>.get_html(url)\n            time.sleep(random.randint(<span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">2</span>))\n\n<span class=\"hljs-keyword\">if</span> __name__ == <span class=\"hljs-string\">&apos;__main__&apos;</span>:\n    spider = LianjiaSpider()\n    spider.run()\n\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"973,1048"}},{"content":"<pre data-lines=\"1049,1061\"><code class=\"language-python\"><span class=\"hljs-string\">&quot;&quot;&quot;\nUser-Agent&#x6c60;\n&quot;&quot;&quot;</span>\nagent_list = [\n    <span class=\"hljs-string\">&apos;Mozilla/5.0 (Windows NT 6.1; WOW64) AppleWebKit/535.1 (KHTML, like Gecko) Chrome/14.0.835.163 Safari/535.1&apos;</span>,\n    <span class=\"hljs-string\">&apos;Mozilla/5.0 (Windows NT 6.1; WOW64; rv:6.0) Gecko/20100101 Firefox/6.0&apos;</span>,\n    <span class=\"hljs-string\">&apos;Mozilla/5.0 (compatible; MSIE 9.0; Windows NT 6.1; Trident/5.0;&apos;</span>,\n]\n\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1049,1061"}},{"content":"<pre data-lines=\"1062,1103\"><code class=\"language-python\">&#x4e00;&#x3001;&#x56fe;&#x7247;&#x3001;&#x97f3;&#x9891;&#x3001;&#x89c6;&#x9891;&#x3001;&#x6587;&#x4ef6;&#x6570;&#x636e;&#x6293;&#x53d6;\n    <span class=\"hljs-number\">1</span>&#x3001;&#x627e;URL&#x5730;&#x5740;&#xff0c;&#x53d1;&#x8bf7;&#x6c42;&#x83b7;&#x53d6; <span class=\"hljs-built_in\">bytes</span> &#x6570;&#x636e;&#x7c7b;&#x578b;\n    <span class=\"hljs-number\">2</span>&#x3001;<span class=\"hljs-keyword\">with</span> <span class=\"hljs-built_in\">open</span>(<span class=\"hljs-string\">&apos;xxx.jpg&apos;</span>,<span class=\"hljs-string\">&apos;wb&apos;</span>) <span class=\"hljs-keyword\">as</span> f:\n           f.write(res.content)\n\n&#x4e8c;&#x3001;&#x6587;&#x4ef6;&#x540d;&#x5904;&#x7406;\n    <span class=\"hljs-number\">1</span>&#x3001;URL&#x5730;&#x5740;&#x5207;&#x7247;&#xff1a; url[-<span class=\"hljs-number\">20</span>:]\n    <span class=\"hljs-number\">2</span>&#x3001;filename = &#x540d;&#x79f0; + url.split(<span class=\"hljs-string\">&apos;.&apos;</span>)[-<span class=\"hljs-number\">1</span>]\n\n&#x4e09;&#x3001;&#x5b58;&#x50a8;&#x8def;&#x5f84;\n    <span class=\"hljs-keyword\">import</span> os\n    <span class=\"hljs-keyword\">if</span> <span class=\"hljs-keyword\">not</span> os.path.exists(directory):\n        os.makedirs(directory)\n\n&#x56db;&#x3001;&#x4f7f;&#x7528;&#x968f;&#x673a;User-Agent\n    <span class=\"hljs-number\">1</span>&#x3001;&#x65b0;&#x5efa; useragents.py &#x5b58;&#x653e;&#x5927;&#x91cf;&#x7684;User-Agent\n         <span class=\"hljs-keyword\">from</span> useragents <span class=\"hljs-keyword\">import</span> ua_list\n    <span class=\"hljs-number\">2</span>&#x3001;&#x4f7f;&#x7528; fake_useragent &#x6a21;&#x5757;\n         <span class=\"hljs-keyword\">from</span> fake_useragent <span class=\"hljs-keyword\">import</span> UserAgent\n         headers = { <span class=\"hljs-string\">&apos;User-Agent&apos;</span> : UserAgent().random }\n\n&#x4e94;&#x3001;lxml + xpath &#x4f7f;&#x7528;\n    <span class=\"hljs-number\">1</span>&#x3001;xpath&#x5339;&#x914d;&#x7ed3;&#x679c;&#x4e3a;&#x5b57;&#x7b26;&#x4e32; &#x8fd8;&#x662f; &#x8282;&#x70b9;&#x5bf9;&#x8c61;\n         &#x5b57;&#x7b26;&#x4e32;&#xff1a; //div/text()    &#x3001;   //div/@title\n         &#x8282;&#x70b9;&#x5bf9;&#x8c61;&#xff1a; //div/a    //ul/li//p[<span class=\"hljs-number\">2</span>]     //dl//dd\n\n    <span class=\"hljs-number\">2</span>&#x3001;&#x4f7f;&#x7528;&#x65b9;&#x6cd5;\n         <span class=\"hljs-number\">2.1</span>&#xff09;&#x5148;&#x5199;&#x57fa;&#x51c6;xpath&#x8868;&#x8fbe;&#x5f0f;&#xff0c;&#x5f97;&#x5230;&#x8282;&#x70b9;&#x5bf9;&#x8c61;&#x5217;&#x8868;\n         <span class=\"hljs-number\">2.2</span>&#xff09;<span class=\"hljs-keyword\">for</span>&#x5faa;&#x73af;&#x4f9d;&#x6b21;&#x904d;&#x5386;&#xff0c;&#x4f9d;&#x6b21;&#x63d0;&#x53d6;&#x6570;&#x636e;  -- &#x6570;&#x636e;&#x8fd8;&#x5f97;&#x662f;&#x4e00;&#x4e2a;&#x4e00;&#x4e2a;&#x63d0;\n         <span class=\"hljs-number\">2.3</span>&#xff09;&#x793a;&#x610f;&#x4ee3;&#x7801;\n                 <span class=\"hljs-keyword\">from</span> lxml <span class=\"hljs-keyword\">import</span> etree\n                 p = etree.HTML(res.text)\n                 div_list = p.xpath(<span class=\"hljs-string\">&apos;//div&apos;</span>)\n                 <span class=\"hljs-keyword\">for</span> div <span class=\"hljs-keyword\">in</span> div_list:\n                        item[<span class=\"hljs-string\">&apos;name&apos;</span>] = div.xpath(<span class=\"hljs-string\">&apos;./xxxx/text()&apos;</span>)[<span class=\"hljs-number\">0</span>]\n                        item[<span class=\"hljs-string\">&apos;score&apos;</span>] = div.xpath(<span class=\"hljs-string\">&apos;.//xxx/@score&apos;</span>)[<span class=\"hljs-number\">0</span>].strip()\n\n                        <span class=\"hljs-built_in\">print</span>(item)\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1062,1103"}}],"payload":{"tag":"h3","lines":"742,743"}}],"payload":{"tag":"h2","lines":"697,698"}}],"payload":{"tag":"h1","lines":"0,1"}},{})</script>
</body>
</html>
