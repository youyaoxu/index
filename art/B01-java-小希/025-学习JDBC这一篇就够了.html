<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets@11.11.1/styles/default.min.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.18.10/dist/browser/index.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/index.js"></script><script>(r => {
              setTimeout(r);
            })(function renderToolbar() {
  const {
    markmap,
    mm
  } = window;
  const {
    el
  } = markmap.Toolbar.create(mm);
  el.setAttribute('style', 'position:absolute;bottom:20px;right:20px');
  document.body.append(el);
})</script><script>((getMarkmap, getOptions, root2, jsonOptions) => {
              const markmap = getMarkmap();
              window.mm = markmap.Markmap.create(
                "svg#mindmap",
                (getOptions || markmap.deriveOptions)(jsonOptions),
                root2
              );
            })(() => window.markmap,null,{"content":"&#x5b66;&#x4e60;JDBC&#x8fd9;&#x4e00;&#x7bc7;&#x5c31;&#x591f;&#x4e86;","children":[{"content":"&#x7b2c;&#x4e00;&#x7ae0; &#x6982;&#x8ff0;","children":[{"content":"<pre data-lines=\"5,6\"><code>JDBC&#xff08;Java Database Connectivity&#xff09;&#x662f;SUN&#x516c;&#x53f8;&#x63d0;&#x4f9b;&#x7684;&#x4e00;&#x79cd;&#x6570;&#x636e;&#x5e93;&#x8bbf;&#x95ee;&#x89c4;&#x5219;&#x3001;&#x89c4;&#x8303;&#xff0c;&#x7531;&#x4e8e;&#x6570;&#x636e;&#x5e93;&#x79cd;&#x7c7b;&#x8f83;&#x591a;&#x4e14;Java&#x8bed;&#x8a00;&#x4f7f;&#x7528;&#x6bd4;&#x8f83;&#x5e7f;&#x6cdb;&#xff0c;SUN&#x516c;&#x53f8;&#x5c31;&#x63d0;&#x4f9b;&#x4e86;&#x4e00;&#x79cd;&#x89c4;&#x8303;&#xff0c;&#x8ba9;&#x5176;&#x5b83;&#x7684;&#x6570;&#x636e;&#x5e93;&#x63d0;&#x4f9b;&#x5546;&#x53bb;&#x5b9e;&#x73b0;&#x5e95;&#x5c42;&#x7684;&#x8bbf;&#x95ee;&#x89c4;&#x5219;&#xff0c;&#x6211;&#x4eec;&#x7684;Java&#x7a0b;&#x5e8f;&#x53ea;&#x8981;&#x4f7f;&#x7528;SUN&#x516c;&#x53f8;&#x63d0;&#x4f9b;&#x7684;jdbc&#x9a71;&#x52a8;&#x5c31;&#x53ef;&#x4ee5;&#x8fde;&#x63a5;&#x4e0d;&#x540c;&#x5382;&#x5546;&#x7684;&#x6570;&#x636e;&#x5e93;&#x4e86;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"5,6"}}],"payload":{"tag":"h2","lines":"2,4"}},{"content":"&#x7b2c;&#x4e8c;&#x7ae0; &#x6570;&#x636e;&#x5e93;&#x8fde;&#x63a5;","children":[{"content":"<pre data-lines=\"12,92\"><code class=\"language-java\"><span class=\"hljs-keyword\">import</span> java.sql.Connection;\n<span class=\"hljs-keyword\">import</span> java.sql.DriverManager;\n<span class=\"hljs-keyword\">import</span> java.sql.PreparedStatement;\n<span class=\"hljs-keyword\">import</span> java.sql.ResultSet;\n<span class=\"hljs-keyword\">import</span> java.sql.SQLException;\n\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">JDBCUtil</span> {\n\t<span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">driverClass</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;com.mysql.jdbc.Driver&quot;</span>;\n\t<span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">url</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;jdbc:mysql://127.0.0.1:3306/mytest&quot;</span>;\n\t<span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">user</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;root&quot;</span>;\n\t<span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">password</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;root&quot;</span>;\n\n\t<span class=\"hljs-keyword\">static</span> {\n\t\t<span class=\"hljs-keyword\">try</span> {\n\t\t\tClass.forName(driverClass);\n\t\t} <span class=\"hljs-keyword\">catch</span> (ClassNotFoundException e) {\n\t\t\te.printStackTrace();\n\t\t}\n\t}\n\n\t<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> Connection <span class=\"hljs-title function_\">getConnection</span><span class=\"hljs-params\">()</span> {\n\t\t<span class=\"hljs-keyword\">try</span> {\n\t\t\t<span class=\"hljs-keyword\">return</span> DriverManager.getConnection(url, user, password);\n\t\t} <span class=\"hljs-keyword\">catch</span> (SQLException e) {\n\t\t\te.printStackTrace();\n\t\t}\n\t\t<span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">null</span>;\n\t}\n\n\t<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">release</span><span class=\"hljs-params\">(Connection connection, PreparedStatement preparedStatement, ResultSet resultSet)</span> {\n\t\tcloseConnection(connection);\n\t\tclosePreparedStatement(preparedStatement);\n\t\tcloseResultSet(resultSet);\n\t}\n\n\t<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">release</span><span class=\"hljs-params\">(Connection connection, PreparedStatement preparedStatement)</span> {\n\t\tcloseConnection(connection);\n\t\tclosePreparedStatement(preparedStatement);\n\t}\n\n\t<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">closeConnection</span><span class=\"hljs-params\">(Connection connection)</span> {\n\t\t<span class=\"hljs-keyword\">if</span> (connection != <span class=\"hljs-literal\">null</span>) {\n\t\t\t<span class=\"hljs-keyword\">try</span> {\n\t\t\t\tconnection.close();\n\t\t\t} <span class=\"hljs-keyword\">catch</span> (SQLException e) {\n\t\t\t\te.printStackTrace();\n\t\t\t} <span class=\"hljs-keyword\">finally</span> {\n\t\t\t\tconnection = <span class=\"hljs-literal\">null</span>;\n\t\t\t}\n\t\t}\n\t}\n\n\t<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">closePreparedStatement</span><span class=\"hljs-params\">(PreparedStatement preparedStatement)</span> {\n\t\t<span class=\"hljs-keyword\">if</span> (preparedStatement != <span class=\"hljs-literal\">null</span>) {\n\t\t\t<span class=\"hljs-keyword\">try</span> {\n\t\t\t\tpreparedStatement.close();\n\t\t\t} <span class=\"hljs-keyword\">catch</span> (SQLException e) {\n\t\t\t\te.printStackTrace();\n\t\t\t} <span class=\"hljs-keyword\">finally</span> {\n\t\t\t\tpreparedStatement = <span class=\"hljs-literal\">null</span>;\n\t\t\t}\n\t\t}\n\t}\n\n\t<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">closeResultSet</span><span class=\"hljs-params\">(ResultSet resultSet)</span> {\n\t\t<span class=\"hljs-keyword\">if</span> (resultSet != <span class=\"hljs-literal\">null</span>) {\n\t\t\t<span class=\"hljs-keyword\">try</span> {\n\t\t\t\tresultSet.close();\n\t\t\t} <span class=\"hljs-keyword\">catch</span> (SQLException e) {\n\t\t\t\te.printStackTrace();\n\t\t\t} <span class=\"hljs-keyword\">finally</span> {\n\t\t\t\tresultSet = <span class=\"hljs-literal\">null</span>;\n\t\t\t}\n\t\t}\n\t}\n\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"12,92"}},{"content":"<pre data-lines=\"95,195\"><code class=\"language-java\"><span class=\"hljs-keyword\">import</span> java.sql.Connection;\n<span class=\"hljs-keyword\">import</span> java.sql.PreparedStatement;\n<span class=\"hljs-keyword\">import</span> java.sql.ResultSet;\n<span class=\"hljs-keyword\">import</span> java.sql.SQLException;\n\n<span class=\"hljs-keyword\">import</span> org.junit.Test;\n\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">JDBCTest</span> {\n\n\t<span class=\"hljs-meta\">@Test</span>\n\t<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">testQuery</span><span class=\"hljs-params\">()</span> {\n\t\t<span class=\"hljs-type\">Connection</span> <span class=\"hljs-variable\">connection</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-literal\">null</span>;\n\t\t<span class=\"hljs-type\">PreparedStatement</span> <span class=\"hljs-variable\">preparedStatement</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-literal\">null</span>;\n\t\t<span class=\"hljs-type\">ResultSet</span> <span class=\"hljs-variable\">resultSet</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-literal\">null</span>;\n\t\t<span class=\"hljs-keyword\">try</span> {\n\t\t\tconnection = JDBCUtil.getConnection();\n\t\t\t<span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">sql</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;select * from admin&quot;</span>;\n\t\t\tpreparedStatement = connection.prepareStatement(sql);\n\t\t\tresultSet = preparedStatement.executeQuery();\n\t\t\t<span class=\"hljs-keyword\">while</span> (resultSet.next()) {\n\t\t\t\t<span class=\"hljs-type\">Object</span> <span class=\"hljs-variable\">id</span> <span class=\"hljs-operator\">=</span> resultSet.getObject(<span class=\"hljs-number\">1</span>);\n\t\t\t\t<span class=\"hljs-type\">Object</span> <span class=\"hljs-variable\">username</span> <span class=\"hljs-operator\">=</span> resultSet.getObject(<span class=\"hljs-number\">2</span>);\n\t\t\t\t<span class=\"hljs-type\">Object</span> <span class=\"hljs-variable\">password</span> <span class=\"hljs-operator\">=</span> resultSet.getObject(<span class=\"hljs-number\">3</span>);\n\n\t\t\t\tSystem.out.println(id + <span class=\"hljs-string\">&quot;:&quot;</span> + username + <span class=\"hljs-string\">&quot;:&quot;</span> + password);\n\t\t\t}\n\t\t} <span class=\"hljs-keyword\">catch</span> (SQLException e) {\n\t\t\te.printStackTrace();\n\t\t} <span class=\"hljs-keyword\">finally</span> {\n\t\t\tJDBCUtil.release(connection, preparedStatement, resultSet);\n\t\t}\n\t}\n\n\t<span class=\"hljs-meta\">@Test</span>\n\t<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">testInsert</span><span class=\"hljs-params\">()</span> {\n\t\t<span class=\"hljs-type\">Connection</span> <span class=\"hljs-variable\">connection</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-literal\">null</span>;\n\t\t<span class=\"hljs-type\">PreparedStatement</span> <span class=\"hljs-variable\">preparedStatement</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-literal\">null</span>;\n\t\t<span class=\"hljs-keyword\">try</span> {\n\t\t\tconnection = JDBCUtil.getConnection();\n\t\t\t<span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">sql</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;insert into admin values(NULL,&apos;xiaowu&apos;,&apos;123456&apos;)&quot;</span>;\n\t\t\tpreparedStatement = connection.prepareStatement(sql);\n\t\t\t<span class=\"hljs-type\">int</span> <span class=\"hljs-variable\">rows</span> <span class=\"hljs-operator\">=</span> preparedStatement.executeUpdate(sql);\n\t\t\t<span class=\"hljs-keyword\">if</span> (rows &gt; <span class=\"hljs-number\">0</span>) {\n\t\t\t\tSystem.out.println(<span class=\"hljs-string\">&quot;&#x63d2;&#x5165;&#x6210;&#x529f;&quot;</span>);\n\t\t\t} <span class=\"hljs-keyword\">else</span> {\n\t\t\t\tSystem.out.println(<span class=\"hljs-string\">&quot;&#x63d2;&#x5165;&#x5931;&#x8d25;&quot;</span>);\n\t\t\t}\n\t\t} <span class=\"hljs-keyword\">catch</span> (SQLException e) {\n\t\t\te.printStackTrace();\n\t\t} <span class=\"hljs-keyword\">finally</span> {\n\t\t\tJDBCUtil.release(connection, preparedStatement);\n\t\t}\n\t}\n\t\n\t<span class=\"hljs-meta\">@Test</span>\n\t<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">testUpdate</span><span class=\"hljs-params\">()</span> {\n\t\t<span class=\"hljs-type\">Connection</span> <span class=\"hljs-variable\">connection</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-literal\">null</span>;\n\t\t<span class=\"hljs-type\">PreparedStatement</span> <span class=\"hljs-variable\">preparedStatement</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-literal\">null</span>;\n\t\t<span class=\"hljs-keyword\">try</span> {\n\t\t\tconnection = JDBCUtil.getConnection();\n\t\t\t<span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">sql</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;update admin set username = &apos;xiaoqi&apos; where id = 5&quot;</span>;\n\t\t\tpreparedStatement = connection.prepareStatement(sql);\n\t\t\t<span class=\"hljs-type\">int</span> <span class=\"hljs-variable\">rows</span> <span class=\"hljs-operator\">=</span> preparedStatement.executeUpdate(sql);\n\t\t\t<span class=\"hljs-keyword\">if</span> (rows &gt; <span class=\"hljs-number\">0</span>) {\n\t\t\t\tSystem.out.println(<span class=\"hljs-string\">&quot;&#x4fee;&#x6539;&#x6210;&#x529f;&quot;</span>);\n\t\t\t} <span class=\"hljs-keyword\">else</span> {\n\t\t\t\tSystem.out.println(<span class=\"hljs-string\">&quot;&#x4fee;&#x6539;&#x5931;&#x8d25;&quot;</span>);\n\t\t\t}\n\t\t} <span class=\"hljs-keyword\">catch</span> (SQLException e) {\n\t\t\te.printStackTrace();\n\t\t} <span class=\"hljs-keyword\">finally</span> {\n\t\t\tJDBCUtil.release(connection, preparedStatement);\n\t\t}\n\t}\n\t\n\t<span class=\"hljs-meta\">@Test</span>\n\t<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">testDelete</span><span class=\"hljs-params\">()</span> {\n\t\t<span class=\"hljs-type\">Connection</span> <span class=\"hljs-variable\">connection</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-literal\">null</span>;\n\t\t<span class=\"hljs-type\">PreparedStatement</span> <span class=\"hljs-variable\">preparedStatement</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-literal\">null</span>;\n\t\t<span class=\"hljs-keyword\">try</span> {\n\t\t\tconnection = JDBCUtil.getConnection();\n\t\t\t<span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">sql</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;delete from admin where id = 5&quot;</span>;\n\t\t\tpreparedStatement = connection.prepareStatement(sql);\n\t\t\t<span class=\"hljs-type\">int</span> <span class=\"hljs-variable\">rows</span> <span class=\"hljs-operator\">=</span> preparedStatement.executeUpdate(sql);\n\t\t\t<span class=\"hljs-keyword\">if</span> (rows &gt; <span class=\"hljs-number\">0</span>) {\n\t\t\t\tSystem.out.println(<span class=\"hljs-string\">&quot;&#x5220;&#x9664;&#x6210;&#x529f;&quot;</span>);\n\t\t\t} <span class=\"hljs-keyword\">else</span> {\n\t\t\t\tSystem.out.println(<span class=\"hljs-string\">&quot;&#x5220;&#x9664;&#x5931;&#x8d25;&quot;</span>);\n\t\t\t}\n\t\t} <span class=\"hljs-keyword\">catch</span> (SQLException e) {\n\t\t\te.printStackTrace();\n\t\t} <span class=\"hljs-keyword\">finally</span> {\n\t\t\tJDBCUtil.release(connection, preparedStatement);\n\t\t}\n\t}\n\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"95,195"}}],"payload":{"tag":"h2","lines":"7,9"}},{"content":"&#x7b2c;&#x4e09;&#x7ae0; &#x6570;&#x636e;&#x5e93;&#x4e8b;&#x52a1;","children":[{"content":"<pre data-lines=\"199,242\"><code class=\"language-java\"><span class=\"hljs-meta\">@Test</span>\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">testTransaction</span><span class=\"hljs-params\">()</span> {\n\t<span class=\"hljs-type\">Connection</span> <span class=\"hljs-variable\">connection</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-literal\">null</span>;\n\t<span class=\"hljs-type\">PreparedStatement</span> <span class=\"hljs-variable\">preparedStatement</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-literal\">null</span>;\n\t<span class=\"hljs-keyword\">try</span> {\n\t\tconnection = JDBCUtil.getConnection();\n\n\t\t\n\t\tconnection.setAutoCommit(<span class=\"hljs-literal\">false</span>);\n\n\t\t<span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">sql</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;update account set money = money - ? where id = ?&quot;</span>;\n\t\tpreparedStatement = connection.prepareStatement(sql);\n\n\t\t\n\t\tpreparedStatement.setInt(<span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">100</span>);\n\t\tpreparedStatement.setInt(<span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">1</span>);\n\t\tpreparedStatement.executeUpdate();\n\n        \n\t\t<span class=\"hljs-type\">int</span> <span class=\"hljs-variable\">a</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">10</span> / <span class=\"hljs-number\">0</span>;\n\n\t\t\n\t\tpreparedStatement.setInt(<span class=\"hljs-number\">1</span>, -<span class=\"hljs-number\">100</span>);\n\t\tpreparedStatement.setInt(<span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">2</span>);\n\t\tpreparedStatement.executeUpdate();\n\n\t\t\n\t\tconnection.commit();\n\t} <span class=\"hljs-keyword\">catch</span> (SQLException e) {\n\t\t<span class=\"hljs-keyword\">try</span> {\n\t\t\t\n\t\t\tconnection.rollback();\n\t\t} <span class=\"hljs-keyword\">catch</span> (SQLException e1) {\n\t\t\te1.printStackTrace();\n\t\t}\n\t\te.printStackTrace();\n\t} <span class=\"hljs-keyword\">finally</span> {\n\t\tJDBCUtil.release(connection, preparedStatement);\n\t}\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"199,242"}}],"payload":{"tag":"h2","lines":"196,198"}},{"content":"&#x7b2c;&#x56db;&#x7ae0; &#x6570;&#x636e;&#x5e93;&#x8fde;&#x63a5;&#x6c60;","children":[{"content":"4.1&#x3001;DBCP","children":[{"content":"<pre data-lines=\"248,249\"><code>**1&#x3001;&#x57fa;&#x672c;&#x4f7f;&#x7528;**\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"248,249"}},{"content":"<pre data-lines=\"250,284\"><code class=\"language-java\"><span class=\"hljs-keyword\">import</span> java.sql.Connection;\n<span class=\"hljs-keyword\">import</span> java.sql.PreparedStatement;\n<span class=\"hljs-keyword\">import</span> java.sql.ResultSet;\n<span class=\"hljs-keyword\">import</span> java.sql.SQLException;\n\n<span class=\"hljs-keyword\">import</span> org.apache.commons.dbcp2.BasicDataSource;\n\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">DBCPTest</span> {\n\n\t<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">main</span><span class=\"hljs-params\">(String[] args)</span> <span class=\"hljs-keyword\">throws</span> SQLException {\n\t\t<span class=\"hljs-type\">BasicDataSource</span> <span class=\"hljs-variable\">dataSource</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">BasicDataSource</span>();\n\t\tdataSource.setUrl(<span class=\"hljs-string\">&quot;jdbc:mysql://127.0.0.1:3306/mytest&quot;</span>);\n\t\tdataSource.setUsername(<span class=\"hljs-string\">&quot;root&quot;</span>);\n\t\tdataSource.setPassword(<span class=\"hljs-string\">&quot;root&quot;</span>);\n\n\t\t<span class=\"hljs-type\">Connection</span> <span class=\"hljs-variable\">connection</span> <span class=\"hljs-operator\">=</span> dataSource.getConnection();\n\t\t<span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">sql</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;select * from admin&quot;</span>;\n\t\t<span class=\"hljs-type\">PreparedStatement</span> <span class=\"hljs-variable\">prepareStatement</span> <span class=\"hljs-operator\">=</span> connection.prepareStatement(sql);\n\t\t<span class=\"hljs-type\">ResultSet</span> <span class=\"hljs-variable\">resultSet</span> <span class=\"hljs-operator\">=</span> prepareStatement.executeQuery();\n\t\t<span class=\"hljs-keyword\">while</span> (resultSet.next()) {\n\t\t\t<span class=\"hljs-type\">Object</span> <span class=\"hljs-variable\">id</span> <span class=\"hljs-operator\">=</span> resultSet.getObject(<span class=\"hljs-number\">1</span>);\n\t\t\t<span class=\"hljs-type\">Object</span> <span class=\"hljs-variable\">username</span> <span class=\"hljs-operator\">=</span> resultSet.getObject(<span class=\"hljs-number\">2</span>);\n\t\t\t<span class=\"hljs-type\">Object</span> <span class=\"hljs-variable\">password</span> <span class=\"hljs-operator\">=</span> resultSet.getObject(<span class=\"hljs-number\">3</span>);\n\t\t\tSystem.out.println(id + <span class=\"hljs-string\">&quot;:&quot;</span> + username + <span class=\"hljs-string\">&quot;:&quot;</span> + password);\n\t\t}\n\t\tresultSet.close();\n\t\tconnection.close();\n\t\tdataSource.close();\n\t}\n\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"250,284"}},{"content":"<pre data-lines=\"285,301\"><code>**2&#x3001;&#x9ad8;&#x7ea7;&#x4f7f;&#x7528;**\n\ndbcp-config.properties\n\n```properties\n#&#x57fa;&#x672c;&#x8bbe;&#x7f6e;\ndriverClassName=com.mysql.jdbc.Driver\nurl=jdbc:mysql://127.0.0.1:3306/mytest\nusername=root\npassword=root\n#&#x6570;&#x636e;&#x5e93;&#x8fde;&#x63a5;&#x6c60;&#x521d;&#x59cb;&#x5316;&#x6570;&#x91cf;\ninitialSize=10\n#&#x6570;&#x636e;&#x5e93;&#x8fde;&#x63a5;&#x6c60;&#x4e2d;&#x7684;&#x6700;&#x5927;&#x7684;&#x6570;&#x636e;&#x5e93;&#x8fde;&#x63a5;&#x6570;\nmaxActive=50\n#&#x6570;&#x636e;&#x5e93;&#x8fde;&#x63a5;&#x6c60;&#x4e2d;&#x7684;&#x6700;&#x5c0f;&#x7684;&#x6570;&#x636e;&#x5e93;&#x8fde;&#x63a5;&#x6570;\nminIdle=5\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"285,301"}},{"content":"<pre data-lines=\"302,344\"><code data-lines=\"302,344\">\nDBCPWithConfig.java\n\n```java\n<span class=\"hljs-keyword\">import</span> java.io.InputStream;\n<span class=\"hljs-keyword\">import</span> java.sql.Connection;\n<span class=\"hljs-keyword\">import</span> java.sql.PreparedStatement;\n<span class=\"hljs-keyword\">import</span> java.sql.ResultSet;\n<span class=\"hljs-keyword\">import</span> java.util.Properties;\n\n<span class=\"hljs-keyword\">import</span> javax.sql.DataSource;\n\n<span class=\"hljs-keyword\">import</span> org.apache.commons.dbcp2.BasicDataSourceFactory;\n\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">DBCPWithConfig</span> {\n\n\t<span class=\"hljs-meta\">@SuppressWarnings(&quot;static-access&quot;)</span>\n\t<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">main</span><span class=\"hljs-params\">(String[] args)</span> <span class=\"hljs-keyword\">throws</span> Exception {\n\t\t<span class=\"hljs-type\">BasicDataSourceFactory</span> <span class=\"hljs-variable\">dataSourceFactory</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">BasicDataSourceFactory</span>();\n\t\t<span class=\"hljs-type\">Properties</span> <span class=\"hljs-variable\">properties</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Properties</span>();\n\t\t<span class=\"hljs-type\">InputStream</span> <span class=\"hljs-variable\">is</span> <span class=\"hljs-operator\">=</span> DBCPWithConfig.class.getClassLoader().getResourceAsStream(<span class=\"hljs-string\">&quot;dbcp-config.properties&quot;</span>);\n\t\tproperties.load(is);\n\t\t<span class=\"hljs-type\">DataSource</span> <span class=\"hljs-variable\">dataSource</span> <span class=\"hljs-operator\">=</span> dataSourceFactory.createDataSource(properties);\n\n\t\t<span class=\"hljs-type\">Connection</span> <span class=\"hljs-variable\">connection</span> <span class=\"hljs-operator\">=</span> dataSource.getConnection();\n\t\t<span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">sql</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;select * from admin&quot;</span>;\n\t\t<span class=\"hljs-type\">PreparedStatement</span> <span class=\"hljs-variable\">prepareStatement</span> <span class=\"hljs-operator\">=</span> connection.prepareStatement(sql);\n\t\t<span class=\"hljs-type\">ResultSet</span> <span class=\"hljs-variable\">resultSet</span> <span class=\"hljs-operator\">=</span> prepareStatement.executeQuery();\n\t\t<span class=\"hljs-keyword\">while</span> (resultSet.next()) {\n\t\t\t<span class=\"hljs-type\">Object</span> <span class=\"hljs-variable\">id</span> <span class=\"hljs-operator\">=</span> resultSet.getObject(<span class=\"hljs-number\">1</span>);\n\t\t\t<span class=\"hljs-type\">Object</span> <span class=\"hljs-variable\">username</span> <span class=\"hljs-operator\">=</span> resultSet.getObject(<span class=\"hljs-number\">2</span>);\n\t\t\t<span class=\"hljs-type\">Object</span> <span class=\"hljs-variable\">password</span> <span class=\"hljs-operator\">=</span> resultSet.getObject(<span class=\"hljs-number\">3</span>);\n\t\t\tSystem.out.println(id + <span class=\"hljs-string\">&quot;:&quot;</span> + username + <span class=\"hljs-string\">&quot;:&quot;</span> + password);\n\t\t}\n\t\tresultSet.close();\n\t\tconnection.close();\n\t}\n\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"302,344"}}],"payload":{"tag":"h3","lines":"246,247"}},{"content":"4.2&#x3001;Druid","children":[{"content":"<pre data-lines=\"347,348\"><code>**1&#x3001;&#x57fa;&#x672c;&#x4f7f;&#x7528;**\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"347,348"}},{"content":"<pre data-lines=\"349,383\"><code class=\"language-java\"><span class=\"hljs-keyword\">import</span> java.sql.Connection;\n<span class=\"hljs-keyword\">import</span> java.sql.PreparedStatement;\n<span class=\"hljs-keyword\">import</span> java.sql.ResultSet;\n<span class=\"hljs-keyword\">import</span> java.sql.SQLException;\n\n<span class=\"hljs-keyword\">import</span> com.alibaba.druid.pool.DruidDataSource;\n\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">DruidTest</span> {\n\n\t<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">main</span><span class=\"hljs-params\">(String[] args)</span> <span class=\"hljs-keyword\">throws</span> SQLException {\n\t\t<span class=\"hljs-type\">DruidDataSource</span> <span class=\"hljs-variable\">dataSource</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">DruidDataSource</span>();\n\t\tdataSource.setUrl(<span class=\"hljs-string\">&quot;jdbc:mysql://127.0.0.1:3306/mytest&quot;</span>);\n\t\tdataSource.setUsername(<span class=\"hljs-string\">&quot;root&quot;</span>);\n\t\tdataSource.setPassword(<span class=\"hljs-string\">&quot;root&quot;</span>);\n\n\t\t<span class=\"hljs-type\">Connection</span> <span class=\"hljs-variable\">connection</span> <span class=\"hljs-operator\">=</span> dataSource.getConnection();\n\t\t<span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">sql</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;select * from admin&quot;</span>;\n\t\t<span class=\"hljs-type\">PreparedStatement</span> <span class=\"hljs-variable\">prepareStatement</span> <span class=\"hljs-operator\">=</span> connection.prepareStatement(sql);\n\t\t<span class=\"hljs-type\">ResultSet</span> <span class=\"hljs-variable\">resultSet</span> <span class=\"hljs-operator\">=</span> prepareStatement.executeQuery();\n\t\t<span class=\"hljs-keyword\">while</span> (resultSet.next()) {\n\t\t\t<span class=\"hljs-type\">Object</span> <span class=\"hljs-variable\">id</span> <span class=\"hljs-operator\">=</span> resultSet.getObject(<span class=\"hljs-number\">1</span>);\n\t\t\t<span class=\"hljs-type\">Object</span> <span class=\"hljs-variable\">username</span> <span class=\"hljs-operator\">=</span> resultSet.getObject(<span class=\"hljs-number\">2</span>);\n\t\t\t<span class=\"hljs-type\">Object</span> <span class=\"hljs-variable\">password</span> <span class=\"hljs-operator\">=</span> resultSet.getObject(<span class=\"hljs-number\">3</span>);\n\t\t\tSystem.out.println(id + <span class=\"hljs-string\">&quot;:&quot;</span> + username + <span class=\"hljs-string\">&quot;:&quot;</span> + password);\n\t\t}\n\t\tresultSet.close();\n\t\tconnection.close();\n\t\tdataSource.close();\n\t}\n\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"349,383"}},{"content":"<pre data-lines=\"384,387\"><code>**2&#x3001;&#x9ad8;&#x7ea7;&#x4f7f;&#x7528;**\n\ndruid-config.properties\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"384,387"}},{"content":"<pre data-lines=\"388,402\"><code class=\"language-properties\">#&#x57fa;&#x672c;&#x8bbe;&#x7f6e;\ndriverClassName=com.mysql.jdbc.Driver\nurl=jdbc:mysql://127.0.0.1:3306/mytest\nusername=root\npassword=root\n#&#x6570;&#x636e;&#x5e93;&#x8fde;&#x63a5;&#x6c60;&#x521d;&#x59cb;&#x5316;&#x6570;&#x91cf;\ninitialSize=10\n#&#x6570;&#x636e;&#x5e93;&#x8fde;&#x63a5;&#x6c60;&#x4e2d;&#x7684;&#x6700;&#x5927;&#x7684;&#x6570;&#x636e;&#x5e93;&#x8fde;&#x63a5;&#x6570;\nmaxActive=50\n#&#x6570;&#x636e;&#x5e93;&#x8fde;&#x63a5;&#x6c60;&#x4e2d;&#x7684;&#x6700;&#x5c0f;&#x7684;&#x6570;&#x636e;&#x5e93;&#x8fde;&#x63a5;&#x6570;\nminIdle=5\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"388,402"}},{"content":"<pre data-lines=\"405,443\"><code class=\"language-java\"><span class=\"hljs-keyword\">import</span> java.io.InputStream;\n<span class=\"hljs-keyword\">import</span> java.sql.Connection;\n<span class=\"hljs-keyword\">import</span> java.sql.PreparedStatement;\n<span class=\"hljs-keyword\">import</span> java.sql.ResultSet;\n<span class=\"hljs-keyword\">import</span> java.util.Properties;\n\n<span class=\"hljs-keyword\">import</span> javax.sql.DataSource;\n\n<span class=\"hljs-keyword\">import</span> com.alibaba.druid.pool.DruidDataSourceFactory;\n\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">DruidWithConfig</span> {\n\n\t<span class=\"hljs-meta\">@SuppressWarnings(&quot;static-access&quot;)</span>\n\t<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">main</span><span class=\"hljs-params\">(String[] args)</span> <span class=\"hljs-keyword\">throws</span> Exception {\n\t\t<span class=\"hljs-type\">DruidDataSourceFactory</span> <span class=\"hljs-variable\">dataSourceFactory</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">DruidDataSourceFactory</span>();\n\t\t<span class=\"hljs-type\">Properties</span> <span class=\"hljs-variable\">properties</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Properties</span>();\n\t\t<span class=\"hljs-type\">InputStream</span> <span class=\"hljs-variable\">is</span> <span class=\"hljs-operator\">=</span> DruidWithConfig.class.getClassLoader().getResourceAsStream(<span class=\"hljs-string\">&quot;druid-config.properties&quot;</span>);\n\t\tproperties.load(is);\n\t\t<span class=\"hljs-type\">DataSource</span> <span class=\"hljs-variable\">dataSource</span> <span class=\"hljs-operator\">=</span> dataSourceFactory.createDataSource(properties);\n\n\t\t<span class=\"hljs-type\">Connection</span> <span class=\"hljs-variable\">connection</span> <span class=\"hljs-operator\">=</span> dataSource.getConnection();\n\t\t<span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">sql</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;select * from admin&quot;</span>;\n\t\t<span class=\"hljs-type\">PreparedStatement</span> <span class=\"hljs-variable\">prepareStatement</span> <span class=\"hljs-operator\">=</span> connection.prepareStatement(sql);\n\t\t<span class=\"hljs-type\">ResultSet</span> <span class=\"hljs-variable\">resultSet</span> <span class=\"hljs-operator\">=</span> prepareStatement.executeQuery();\n\t\t<span class=\"hljs-keyword\">while</span> (resultSet.next()) {\n\t\t\t<span class=\"hljs-type\">Object</span> <span class=\"hljs-variable\">id</span> <span class=\"hljs-operator\">=</span> resultSet.getObject(<span class=\"hljs-number\">1</span>);\n\t\t\t<span class=\"hljs-type\">Object</span> <span class=\"hljs-variable\">username</span> <span class=\"hljs-operator\">=</span> resultSet.getObject(<span class=\"hljs-number\">2</span>);\n\t\t\t<span class=\"hljs-type\">Object</span> <span class=\"hljs-variable\">password</span> <span class=\"hljs-operator\">=</span> resultSet.getObject(<span class=\"hljs-number\">3</span>);\n\t\t\tSystem.out.println(id + <span class=\"hljs-string\">&quot;:&quot;</span> + username + <span class=\"hljs-string\">&quot;:&quot;</span> + password);\n\t\t}\n\t\tresultSet.close();\n\t\tconnection.close();\n\t}\n\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"405,443"}}],"payload":{"tag":"h3","lines":"345,346"}},{"content":"4.3&#x3001;C3P0","children":[{"content":"<pre data-lines=\"446,447\"><code>**1&#x3001;&#x57fa;&#x672c;&#x4f7f;&#x7528;**\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"446,447"}},{"content":"<pre data-lines=\"448,482\"><code class=\"language-java\"><span class=\"hljs-keyword\">import</span> java.sql.Connection;\n<span class=\"hljs-keyword\">import</span> java.sql.PreparedStatement;\n<span class=\"hljs-keyword\">import</span> java.sql.ResultSet;\n<span class=\"hljs-keyword\">import</span> java.sql.SQLException;\n\n<span class=\"hljs-keyword\">import</span> com.mchange.v2.c3p0.ComboPooledDataSource;\n\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">C3P0Test</span> {\n\n\t<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">main</span><span class=\"hljs-params\">(String[] args)</span> <span class=\"hljs-keyword\">throws</span> SQLException {\n\t\t<span class=\"hljs-type\">ComboPooledDataSource</span> <span class=\"hljs-variable\">dataSource</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">ComboPooledDataSource</span>();\n\t\tdataSource.setJdbcUrl(<span class=\"hljs-string\">&quot;jdbc:mysql://127.0.0.1:3306/mytest&quot;</span>);\n\t\tdataSource.setUser(<span class=\"hljs-string\">&quot;root&quot;</span>);\n\t\tdataSource.setPassword(<span class=\"hljs-string\">&quot;root&quot;</span>);\n\n\t\t<span class=\"hljs-type\">Connection</span> <span class=\"hljs-variable\">connection</span> <span class=\"hljs-operator\">=</span> dataSource.getConnection();\n\t\t<span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">sql</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;select * from admin&quot;</span>;\n\t\t<span class=\"hljs-type\">PreparedStatement</span> <span class=\"hljs-variable\">prepareStatement</span> <span class=\"hljs-operator\">=</span> connection.prepareStatement(sql);\n\t\t<span class=\"hljs-type\">ResultSet</span> <span class=\"hljs-variable\">resultSet</span> <span class=\"hljs-operator\">=</span> prepareStatement.executeQuery();\n\t\t<span class=\"hljs-keyword\">while</span> (resultSet.next()) {\n\t\t\t<span class=\"hljs-type\">Object</span> <span class=\"hljs-variable\">id</span> <span class=\"hljs-operator\">=</span> resultSet.getObject(<span class=\"hljs-number\">1</span>);\n\t\t\t<span class=\"hljs-type\">Object</span> <span class=\"hljs-variable\">username</span> <span class=\"hljs-operator\">=</span> resultSet.getObject(<span class=\"hljs-number\">2</span>);\n\t\t\t<span class=\"hljs-type\">Object</span> <span class=\"hljs-variable\">password</span> <span class=\"hljs-operator\">=</span> resultSet.getObject(<span class=\"hljs-number\">3</span>);\n\t\t\tSystem.out.println(id + <span class=\"hljs-string\">&quot;:&quot;</span> + username + <span class=\"hljs-string\">&quot;:&quot;</span> + password);\n\t\t}\n\t\tresultSet.close();\n\t\tconnection.close();\n\t\tdataSource.close();\n\t}\n\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"448,482"}},{"content":"<pre data-lines=\"483,486\"><code>**2&#x3001;&#x9ad8;&#x7ea7;&#x4f7f;&#x7528;**\n\nc3p0-config.xml\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"483,486"}},{"content":"<pre data-lines=\"487,506\"><code class=\"language-xml\"><span class=\"hljs-meta\">&lt;?xml version=<span class=\"hljs-string\">&quot;1.0&quot;</span> encoding=<span class=\"hljs-string\">&quot;UTF-8&quot;</span>?&gt;</span>\n<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">c3p0-config</span>&gt;</span>\n\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">default-config</span>&gt;</span>\n\t\t\n\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">property</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;driverClass&quot;</span>&gt;</span>com.mysql.jdbc.Driver<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">property</span>&gt;</span>\n\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">property</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;jdbcUrl&quot;</span>&gt;</span>jdbc:mysql://127.0.0.1/mytest<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">property</span>&gt;</span>\n\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">property</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;user&quot;</span>&gt;</span>root<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">property</span>&gt;</span>\n\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">property</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;password&quot;</span>&gt;</span>root<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">property</span>&gt;</span>\n\t\t\n\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">property</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;initialPoolSize&quot;</span>&gt;</span>10<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">property</span>&gt;</span>\n\t\t\n\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">property</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;maxPoolSize&quot;</span>&gt;</span>100<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">property</span>&gt;</span>\n\t\t\n\t\t<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">property</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;minPoolSize&quot;</span>&gt;</span>10<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">property</span>&gt;</span>\n\t<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">default-config</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">c3p0-config</span>&gt;</span>\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"487,506"}},{"content":"<pre data-lines=\"507,508\"><code>C3P0WithConfig.java\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"507,508"}},{"content":"<pre data-lines=\"509,540\"><code class=\"language-java\"><span class=\"hljs-keyword\">import</span> java.sql.Connection;\n<span class=\"hljs-keyword\">import</span> java.sql.PreparedStatement;\n<span class=\"hljs-keyword\">import</span> java.sql.ResultSet;\n<span class=\"hljs-keyword\">import</span> java.sql.SQLException;\n\n<span class=\"hljs-keyword\">import</span> com.mchange.v2.c3p0.ComboPooledDataSource;\n\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">C3P0WithConfig</span> {\n\n\t<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">main</span><span class=\"hljs-params\">(String[] args)</span> <span class=\"hljs-keyword\">throws</span> SQLException {\n\t\t<span class=\"hljs-type\">ComboPooledDataSource</span> <span class=\"hljs-variable\">dataSource</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">ComboPooledDataSource</span>();\n\n\t\t<span class=\"hljs-type\">Connection</span> <span class=\"hljs-variable\">connection</span> <span class=\"hljs-operator\">=</span> dataSource.getConnection();\n\t\t<span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">sql</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;select * from admin&quot;</span>;\n\t\t<span class=\"hljs-type\">PreparedStatement</span> <span class=\"hljs-variable\">prepareStatement</span> <span class=\"hljs-operator\">=</span> connection.prepareStatement(sql);\n\t\t<span class=\"hljs-type\">ResultSet</span> <span class=\"hljs-variable\">resultSet</span> <span class=\"hljs-operator\">=</span> prepareStatement.executeQuery();\n\t\t<span class=\"hljs-keyword\">while</span> (resultSet.next()) {\n\t\t\t<span class=\"hljs-type\">Object</span> <span class=\"hljs-variable\">id</span> <span class=\"hljs-operator\">=</span> resultSet.getObject(<span class=\"hljs-number\">1</span>);\n\t\t\t<span class=\"hljs-type\">Object</span> <span class=\"hljs-variable\">username</span> <span class=\"hljs-operator\">=</span> resultSet.getObject(<span class=\"hljs-number\">2</span>);\n\t\t\t<span class=\"hljs-type\">Object</span> <span class=\"hljs-variable\">password</span> <span class=\"hljs-operator\">=</span> resultSet.getObject(<span class=\"hljs-number\">3</span>);\n\t\t\tSystem.out.println(id + <span class=\"hljs-string\">&quot;:&quot;</span> + username + <span class=\"hljs-string\">&quot;:&quot;</span> + password);\n\t\t}\n\t\tresultSet.close();\n\t\tconnection.close();\n\t\tdataSource.close();\n\t}\n\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"509,540"}}],"payload":{"tag":"h3","lines":"444,445"}}],"payload":{"tag":"h2","lines":"243,245"}},{"content":"&#x7b2c;&#x4e94;&#x7ae0; DButils","children":[{"content":"<pre data-lines=\"544,547\"><code>**1&#x3001;&#x57fa;&#x672c;&#x7684;&#x4f7f;&#x7528;**\n\nAdmin.java\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"544,547"}},{"content":"<pre data-lines=\"548,585\"><code class=\"language-java\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">Admin</span> {\n\t<span class=\"hljs-keyword\">private</span> Integer id;\n\t<span class=\"hljs-keyword\">private</span> String username;\n\t<span class=\"hljs-keyword\">private</span> String password;\n\n\t<span class=\"hljs-keyword\">public</span> Integer <span class=\"hljs-title function_\">getId</span><span class=\"hljs-params\">()</span> {\n\t\t<span class=\"hljs-keyword\">return</span> id;\n\t}\n\n\t<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">setId</span><span class=\"hljs-params\">(Integer id)</span> {\n\t\t<span class=\"hljs-built_in\">this</span>.id = id;\n\t}\n\n\t<span class=\"hljs-keyword\">public</span> String <span class=\"hljs-title function_\">getUsername</span><span class=\"hljs-params\">()</span> {\n\t\t<span class=\"hljs-keyword\">return</span> username;\n\t}\n\n\t<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">setUsername</span><span class=\"hljs-params\">(String username)</span> {\n\t\t<span class=\"hljs-built_in\">this</span>.username = username;\n\t}\n\n\t<span class=\"hljs-keyword\">public</span> String <span class=\"hljs-title function_\">getPassword</span><span class=\"hljs-params\">()</span> {\n\t\t<span class=\"hljs-keyword\">return</span> password;\n\t}\n\n\t<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">setPassword</span><span class=\"hljs-params\">(String password)</span> {\n\t\t<span class=\"hljs-built_in\">this</span>.password = password;\n\t}\n\n\t<span class=\"hljs-meta\">@Override</span>\n\t<span class=\"hljs-keyword\">public</span> String <span class=\"hljs-title function_\">toString</span><span class=\"hljs-params\">()</span> {\n\t\t<span class=\"hljs-keyword\">return</span> <span class=\"hljs-string\">&quot;Admin [id=&quot;</span> + id + <span class=\"hljs-string\">&quot;, username=&quot;</span> + username + <span class=\"hljs-string\">&quot;, password=&quot;</span> + password + <span class=\"hljs-string\">&quot;]&quot;</span>;\n\t}\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"548,585"}},{"content":"<pre data-lines=\"586,587\"><code>DBUtilsTest.java\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"586,587"}},{"content":"<pre data-lines=\"588,703\"><code class=\"language-java\"><span class=\"hljs-keyword\">import</span> java.sql.SQLException;\n<span class=\"hljs-keyword\">import</span> java.util.List;\n\n<span class=\"hljs-keyword\">import</span> org.apache.commons.dbutils.QueryRunner;\n<span class=\"hljs-keyword\">import</span> org.apache.commons.dbutils.handlers.BeanHandler;\n<span class=\"hljs-keyword\">import</span> org.apache.commons.dbutils.handlers.BeanListHandler;\n<span class=\"hljs-keyword\">import</span> org.junit.Test;\n\n<span class=\"hljs-keyword\">import</span> com.mchange.v2.c3p0.ComboPooledDataSource;\n\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">DBUtilsTest</span> {\n\n\t<span class=\"hljs-meta\">@Test</span>\n\t<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">testQueryOne</span><span class=\"hljs-params\">()</span> {\n\t\t<span class=\"hljs-keyword\">try</span> {\n\t\t\t<span class=\"hljs-type\">ComboPooledDataSource</span> <span class=\"hljs-variable\">dataSource</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">ComboPooledDataSource</span>();\n\t\t\tdataSource.setJdbcUrl(<span class=\"hljs-string\">&quot;jdbc:mysql://127.0.0.1:3306/mytest&quot;</span>);\n\t\t\tdataSource.setUser(<span class=\"hljs-string\">&quot;root&quot;</span>);\n\t\t\tdataSource.setPassword(<span class=\"hljs-string\">&quot;root&quot;</span>);\n\t\t\t<span class=\"hljs-type\">QueryRunner</span> <span class=\"hljs-variable\">queryRunner</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">QueryRunner</span>(dataSource);\n\t\t\t<span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">sql</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;select * from admin where id = ?&quot;</span>;\n\t\t\t<span class=\"hljs-type\">Admin</span> <span class=\"hljs-variable\">admin</span> <span class=\"hljs-operator\">=</span> queryRunner.query(sql, <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">BeanHandler</span>&lt;Admin&gt;(Admin.class), <span class=\"hljs-number\">1</span>);\n\t\t\tSystem.out.println(admin);\n\t\t\tdataSource.close();\n\t\t} <span class=\"hljs-keyword\">catch</span> (SQLException e) {\n\t\t\te.printStackTrace();\n\t\t}\n\t}\n\n\t<span class=\"hljs-meta\">@Test</span>\n\t<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">testQueryAll</span><span class=\"hljs-params\">()</span> {\n\t\t<span class=\"hljs-keyword\">try</span> {\n\t\t\t<span class=\"hljs-type\">ComboPooledDataSource</span> <span class=\"hljs-variable\">dataSource</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">ComboPooledDataSource</span>();\n\t\t\tdataSource.setJdbcUrl(<span class=\"hljs-string\">&quot;jdbc:mysql://127.0.0.1:3306/mytest&quot;</span>);\n\t\t\tdataSource.setUser(<span class=\"hljs-string\">&quot;root&quot;</span>);\n\t\t\tdataSource.setPassword(<span class=\"hljs-string\">&quot;root&quot;</span>);\n\t\t\t<span class=\"hljs-type\">QueryRunner</span> <span class=\"hljs-variable\">queryRunner</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">QueryRunner</span>(dataSource);\n\t\t\t<span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">sql</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;select * from admin&quot;</span>;\n\t\t\tList&lt;Admin&gt; admins = queryRunner.query(sql, <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">BeanListHandler</span>&lt;Admin&gt;(Admin.class));\n\t\t\t<span class=\"hljs-keyword\">for</span> (Admin admin : admins) {\n\t\t\t\tSystem.out.println(admin);\n\t\t\t}\n\t\t\tdataSource.close();\n\t\t} <span class=\"hljs-keyword\">catch</span> (SQLException e) {\n\t\t\te.printStackTrace();\n\t\t}\n\t}\n\n\t<span class=\"hljs-meta\">@Test</span>\n\t<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">testInsert</span><span class=\"hljs-params\">()</span> {\n\t\t<span class=\"hljs-keyword\">try</span> {\n\t\t\t<span class=\"hljs-type\">ComboPooledDataSource</span> <span class=\"hljs-variable\">dataSource</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">ComboPooledDataSource</span>();\n\t\t\tdataSource.setJdbcUrl(<span class=\"hljs-string\">&quot;jdbc:mysql://127.0.0.1:3306/mytest&quot;</span>);\n\t\t\tdataSource.setUser(<span class=\"hljs-string\">&quot;root&quot;</span>);\n\t\t\tdataSource.setPassword(<span class=\"hljs-string\">&quot;root&quot;</span>);\n\t\t\t<span class=\"hljs-type\">QueryRunner</span> <span class=\"hljs-variable\">queryRunner</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">QueryRunner</span>(dataSource);\n\t\t\t<span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">sql</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;insert into admin values(NULL,?,?)&quot;</span>;\n\t\t\t<span class=\"hljs-type\">int</span> <span class=\"hljs-variable\">rows</span> <span class=\"hljs-operator\">=</span> queryRunner.update(sql, <span class=\"hljs-string\">&quot;xiaojiu&quot;</span>, <span class=\"hljs-string\">&quot;123456&quot;</span>);\n\t\t\t<span class=\"hljs-keyword\">if</span> (rows &gt; <span class=\"hljs-number\">0</span>) {\n\t\t\t\tSystem.out.println(<span class=\"hljs-string\">&quot;&#x63d2;&#x5165;&#x6210;&#x529f;&quot;</span>);\n\t\t\t} <span class=\"hljs-keyword\">else</span> {\n\t\t\t\tSystem.out.println(<span class=\"hljs-string\">&quot;&#x63d2;&#x5165;&#x5931;&#x8d25;&quot;</span>);\n\t\t\t}\n\t\t\tdataSource.close();\n\t\t} <span class=\"hljs-keyword\">catch</span> (SQLException e) {\n\t\t\te.printStackTrace();\n\t\t}\n\t}\n\n\t<span class=\"hljs-meta\">@Test</span>\n\t<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">testUpdate</span><span class=\"hljs-params\">()</span> {\n\t\t<span class=\"hljs-keyword\">try</span> {\n\t\t\t<span class=\"hljs-type\">ComboPooledDataSource</span> <span class=\"hljs-variable\">dataSource</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">ComboPooledDataSource</span>();\n\t\t\tdataSource.setJdbcUrl(<span class=\"hljs-string\">&quot;jdbc:mysql://127.0.0.1:3306/mytest&quot;</span>);\n\t\t\tdataSource.setUser(<span class=\"hljs-string\">&quot;root&quot;</span>);\n\t\t\tdataSource.setPassword(<span class=\"hljs-string\">&quot;root&quot;</span>);\n\t\t\t<span class=\"hljs-type\">QueryRunner</span> <span class=\"hljs-variable\">queryRunner</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">QueryRunner</span>(dataSource);\n\t\t\t<span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">sql</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;update admin set username = &apos;xiaoqi&apos; where id = ?&quot;</span>;\n\t\t\t<span class=\"hljs-type\">int</span> <span class=\"hljs-variable\">rows</span> <span class=\"hljs-operator\">=</span> queryRunner.update(sql, <span class=\"hljs-number\">4</span>);\n\t\t\t<span class=\"hljs-keyword\">if</span> (rows &gt; <span class=\"hljs-number\">0</span>) {\n\t\t\t\tSystem.out.println(<span class=\"hljs-string\">&quot;&#x4fee;&#x6539;&#x6210;&#x529f;&quot;</span>);\n\t\t\t} <span class=\"hljs-keyword\">else</span> {\n\t\t\t\tSystem.out.println(<span class=\"hljs-string\">&quot;&#x4fee;&#x6539;&#x5931;&#x8d25;&quot;</span>);\n\t\t\t}\n\t\t\tdataSource.close();\n\t\t} <span class=\"hljs-keyword\">catch</span> (SQLException e) {\n\t\t\te.printStackTrace();\n\t\t}\n\t}\n\n\t<span class=\"hljs-meta\">@Test</span>\n\t<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">testDelete</span><span class=\"hljs-params\">()</span> {\n\t\t<span class=\"hljs-keyword\">try</span> {\n\t\t\t<span class=\"hljs-type\">ComboPooledDataSource</span> <span class=\"hljs-variable\">dataSource</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">ComboPooledDataSource</span>();\n\t\t\tdataSource.setJdbcUrl(<span class=\"hljs-string\">&quot;jdbc:mysql://127.0.0.1:3306/mytest&quot;</span>);\n\t\t\tdataSource.setUser(<span class=\"hljs-string\">&quot;root&quot;</span>);\n\t\t\tdataSource.setPassword(<span class=\"hljs-string\">&quot;root&quot;</span>);\n\t\t\t<span class=\"hljs-type\">QueryRunner</span> <span class=\"hljs-variable\">queryRunner</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">QueryRunner</span>(dataSource);\n\t\t\t<span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">sql</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;delete from admin where id = ?&quot;</span>;\n\t\t\t<span class=\"hljs-type\">int</span> <span class=\"hljs-variable\">rows</span> <span class=\"hljs-operator\">=</span> queryRunner.update(sql, <span class=\"hljs-number\">6</span>);\n\t\t\t<span class=\"hljs-keyword\">if</span> (rows &gt; <span class=\"hljs-number\">0</span>) {\n\t\t\t\tSystem.out.println(<span class=\"hljs-string\">&quot;&#x5220;&#x9664;&#x6210;&#x529f;&quot;</span>);\n\t\t\t} <span class=\"hljs-keyword\">else</span> {\n\t\t\t\tSystem.out.println(<span class=\"hljs-string\">&quot;&#x5220;&#x9664;&#x5931;&#x8d25;&quot;</span>);\n\t\t\t}\n\t\t\tdataSource.close();\n\t\t} <span class=\"hljs-keyword\">catch</span> (SQLException e) {\n\t\t\te.printStackTrace();\n\t\t}\n\t}\n\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"588,703"}},{"content":"<pre data-lines=\"704,705\"><code>&#x6ce8;&#x610f;&#x95ee;&#x9898;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"704,705"}},{"content":"<pre data-lines=\"706,721\"><code class=\"language-java\">BeanHandler&#xff0c;&#x67e5;&#x8be2;&#x5230;&#x7684;&#x5355;&#x4e2a;&#x6570;&#x636e;&#x5c01;&#x88c5;&#x6210;&#x4e00;&#x4e2a;&#x5bf9;&#x8c61;\nBeanListHandler&#xff0c;&#x67e5;&#x8be2;&#x5230;&#x7684;&#x591a;&#x4e2a;&#x6570;&#x636e;&#x5c01;&#x88c5;&#x6210;&#x4e00;&#x4e2a;List&lt;&#x5bf9;&#x8c61;&gt;\n    \nArrayHandler&#xff0c;&#x67e5;&#x8be2;&#x5230;&#x7684;&#x5355;&#x4e2a;&#x6570;&#x636e;&#x5c01;&#x88c5;&#x6210;&#x4e00;&#x4e2a;&#x6570;&#x7ec4;\nArrayListHandler&#xff0c;&#x67e5;&#x8be2;&#x5230;&#x7684;&#x591a;&#x4e2a;&#x6570;&#x636e;&#x5c01;&#x88c5;&#x6210;&#x4e00;&#x4e2a;&#x96c6;&#x5408;&#xff0c;&#x96c6;&#x5408;&#x91cc;&#x9762;&#x7684;&#x5143;&#x7d20;&#x662f;&#x6570;&#x7ec4;\n    \nMapHandler&#xff0c;&#x67e5;&#x8be2;&#x5230;&#x7684;&#x5355;&#x4e2a;&#x6570;&#x636e;&#x5c01;&#x88c5;&#x6210;&#x4e00;&#x4e2a;map\nMapListHandler&#xff0c;&#x67e5;&#x8be2;&#x5230;&#x7684;&#x591a;&#x4e2a;&#x6570;&#x636e;&#x5c01;&#x88c5;&#x6210;&#x4e00;&#x4e2a;&#x96c6;&#x5408;&#xff0c;&#x96c6;&#x5408;&#x91cc;&#x9762;&#x7684;&#x5143;&#x7d20;&#x662f;Map\n    \nColumnListHandler\nKeyedHandler\nScalarHandler    \n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"706,721"}},{"content":"<pre data-lines=\"722,725\"><code>**2&#x3001;&#x81ea;&#x5b9a;&#x4e49;&#x5b9e;&#x73b0;**\n\nResultSetHandler.java\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"722,725"}},{"content":"<pre data-lines=\"726,738\"><code class=\"language-java\"><span class=\"hljs-keyword\">import</span> java.sql.ResultSet;\n<span class=\"hljs-keyword\">import</span> java.sql.SQLException;\n\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">interface</span> <span class=\"hljs-title class_\">ResultSetHandler</span>&lt;T&gt; {\n\n\t\n\tT <span class=\"hljs-title function_\">handle</span><span class=\"hljs-params\">(ResultSet rs)</span> <span class=\"hljs-keyword\">throws</span> SQLException;\n\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"726,738"}},{"content":"<pre data-lines=\"741,805\"><code class=\"language-java\"><span class=\"hljs-keyword\">import</span> java.sql.Connection;\n<span class=\"hljs-keyword\">import</span> java.sql.ParameterMetaData;\n<span class=\"hljs-keyword\">import</span> java.sql.PreparedStatement;\n<span class=\"hljs-keyword\">import</span> java.sql.ResultSet;\n<span class=\"hljs-keyword\">import</span> java.sql.SQLException;\n\n<span class=\"hljs-keyword\">import</span> javax.sql.DataSource;\n\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">MyQueryRunner</span> {\n\n\t<span class=\"hljs-keyword\">private</span> <span class=\"hljs-type\">DataSource</span> <span class=\"hljs-variable\">dataSource</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-literal\">null</span>;\n\n\t<span class=\"hljs-keyword\">public</span> <span class=\"hljs-title function_\">MyQueryRunner</span><span class=\"hljs-params\">()</span> {\n\t\t<span class=\"hljs-built_in\">super</span>();\n\t}\n\n\t<span class=\"hljs-keyword\">public</span> <span class=\"hljs-title function_\">MyQueryRunner</span><span class=\"hljs-params\">(DataSource dataSource)</span> {\n\t\t<span class=\"hljs-built_in\">super</span>();\n\t\t<span class=\"hljs-built_in\">this</span>.dataSource = dataSource;\n\t}\n\n\t<span class=\"hljs-keyword\">public</span> &lt;T&gt; T <span class=\"hljs-title function_\">query</span><span class=\"hljs-params\">(String sql, ResultSetHandler&lt;T&gt; handler, Object... args)</span> {\n\t\t<span class=\"hljs-type\">Connection</span> <span class=\"hljs-variable\">connection</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-literal\">null</span>;\n\t\t<span class=\"hljs-type\">PreparedStatement</span> <span class=\"hljs-variable\">preparedStatement</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-literal\">null</span>;\n\t\t<span class=\"hljs-keyword\">try</span> {\n\t\t\tconnection = dataSource.getConnection();\n\t\t\tpreparedStatement = connection.prepareStatement(sql);\n\t\t\t<span class=\"hljs-type\">ParameterMetaData</span> <span class=\"hljs-variable\">parameterMetaData</span> <span class=\"hljs-operator\">=</span> preparedStatement.getParameterMetaData();\n\t\t\t<span class=\"hljs-keyword\">for</span> (<span class=\"hljs-type\">int</span> <span class=\"hljs-variable\">i</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">0</span>; i &lt; parameterMetaData.getParameterCount(); i++) {\n\t\t\t\tpreparedStatement.setObject(i + <span class=\"hljs-number\">1</span>, args[i]);\n\t\t\t}\n\t\t\t<span class=\"hljs-type\">ResultSet</span> <span class=\"hljs-variable\">resultSet</span> <span class=\"hljs-operator\">=</span> preparedStatement.executeQuery();\n\t\t\t<span class=\"hljs-keyword\">return</span> (T) handler.handle(resultSet);\n\t\t} <span class=\"hljs-keyword\">catch</span> (SQLException e) {\n\t\t\te.printStackTrace();\n\t\t} <span class=\"hljs-keyword\">finally</span> {\n\t\t\tJDBCUtil.release(connection, preparedStatement);\n\t\t}\n\t\t<span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">null</span>;\n\t}\n\n\t<span class=\"hljs-keyword\">public</span> <span class=\"hljs-type\">int</span> <span class=\"hljs-title function_\">update</span><span class=\"hljs-params\">(String sql, Object... args)</span> {\n\t\t<span class=\"hljs-type\">Connection</span> <span class=\"hljs-variable\">connection</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-literal\">null</span>;\n\t\t<span class=\"hljs-type\">PreparedStatement</span> <span class=\"hljs-variable\">preparedStatement</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-literal\">null</span>;\n\t\t<span class=\"hljs-keyword\">try</span> {\n\t\t\tconnection = dataSource.getConnection();\n\t\t\tpreparedStatement = connection.prepareStatement(sql);\n\t\t\t<span class=\"hljs-type\">ParameterMetaData</span> <span class=\"hljs-variable\">parameterMetaData</span> <span class=\"hljs-operator\">=</span> preparedStatement.getParameterMetaData();\n\t\t\t<span class=\"hljs-keyword\">for</span> (<span class=\"hljs-type\">int</span> <span class=\"hljs-variable\">i</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">0</span>; i &lt; parameterMetaData.getParameterCount(); i++) {\n\t\t\t\tpreparedStatement.setObject(i + <span class=\"hljs-number\">1</span>, args[i]);\n\t\t\t}\n\t\t\t<span class=\"hljs-keyword\">return</span> preparedStatement.executeUpdate();\n\t\t} <span class=\"hljs-keyword\">catch</span> (SQLException e) {\n\t\t\te.printStackTrace();\n\t\t} <span class=\"hljs-keyword\">finally</span> {\n\t\t\tJDBCUtil.release(connection, preparedStatement);\n\t\t}\n\t\t<span class=\"hljs-keyword\">return</span> <span class=\"hljs-number\">0</span>;\n\t}\n\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"741,805"}},{"content":"<pre data-lines=\"806,807\"><code>Admin.java\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"806,807"}},{"content":"<pre data-lines=\"808,845\"><code class=\"language-java\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">Admin</span> {\n\t<span class=\"hljs-keyword\">private</span> Integer id;\n\t<span class=\"hljs-keyword\">private</span> String username;\n\t<span class=\"hljs-keyword\">private</span> String password;\n\n\t<span class=\"hljs-keyword\">public</span> Integer <span class=\"hljs-title function_\">getId</span><span class=\"hljs-params\">()</span> {\n\t\t<span class=\"hljs-keyword\">return</span> id;\n\t}\n\n\t<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">setId</span><span class=\"hljs-params\">(Integer id)</span> {\n\t\t<span class=\"hljs-built_in\">this</span>.id = id;\n\t}\n\n\t<span class=\"hljs-keyword\">public</span> String <span class=\"hljs-title function_\">getUsername</span><span class=\"hljs-params\">()</span> {\n\t\t<span class=\"hljs-keyword\">return</span> username;\n\t}\n\n\t<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">setUsername</span><span class=\"hljs-params\">(String username)</span> {\n\t\t<span class=\"hljs-built_in\">this</span>.username = username;\n\t}\n\n\t<span class=\"hljs-keyword\">public</span> String <span class=\"hljs-title function_\">getPassword</span><span class=\"hljs-params\">()</span> {\n\t\t<span class=\"hljs-keyword\">return</span> password;\n\t}\n\n\t<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">setPassword</span><span class=\"hljs-params\">(String password)</span> {\n\t\t<span class=\"hljs-built_in\">this</span>.password = password;\n\t}\n\n\t<span class=\"hljs-meta\">@Override</span>\n\t<span class=\"hljs-keyword\">public</span> String <span class=\"hljs-title function_\">toString</span><span class=\"hljs-params\">()</span> {\n\t\t<span class=\"hljs-keyword\">return</span> <span class=\"hljs-string\">&quot;Admin [id=&quot;</span> + id + <span class=\"hljs-string\">&quot;, username=&quot;</span> + username + <span class=\"hljs-string\">&quot;, password=&quot;</span> + password + <span class=\"hljs-string\">&quot;]&quot;</span>;\n\t}\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"808,845"}},{"content":"<pre data-lines=\"846,847\"><code>MyQueryRunnerTest.java\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"846,847"}},{"content":"<pre data-lines=\"848,973\"><code class=\"language-java\"><span class=\"hljs-keyword\">import</span> java.sql.ResultSet;\n<span class=\"hljs-keyword\">import</span> java.sql.SQLException;\n<span class=\"hljs-keyword\">import</span> java.util.ArrayList;\n<span class=\"hljs-keyword\">import</span> java.util.List;\n\n<span class=\"hljs-keyword\">import</span> org.junit.Test;\n\n<span class=\"hljs-keyword\">import</span> com.mchange.v2.c3p0.ComboPooledDataSource;\n\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">MyQueryRunnerTest</span> {\n\n\t<span class=\"hljs-meta\">@Test</span>\n\t<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">testQueryOne</span><span class=\"hljs-params\">()</span> {\n\t\t<span class=\"hljs-type\">ComboPooledDataSource</span> <span class=\"hljs-variable\">dataSource</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">ComboPooledDataSource</span>();\n\t\tdataSource.setJdbcUrl(<span class=\"hljs-string\">&quot;jdbc:mysql://127.0.0.1:3306/mytest&quot;</span>);\n\t\tdataSource.setUser(<span class=\"hljs-string\">&quot;root&quot;</span>);\n\t\tdataSource.setPassword(<span class=\"hljs-string\">&quot;root&quot;</span>);\n\t\t<span class=\"hljs-type\">MyQueryRunner</span> <span class=\"hljs-variable\">queryRunner</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">MyQueryRunner</span>(dataSource);\n\t\t<span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">sql</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;select * from admin where id = ?&quot;</span>;\n\t\t<span class=\"hljs-type\">Admin</span> <span class=\"hljs-variable\">admin</span> <span class=\"hljs-operator\">=</span> queryRunner.query(sql, <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">ResultSetHandler</span>&lt;Admin&gt;() {\n\t\t\t<span class=\"hljs-meta\">@Override</span>\n\t\t\t<span class=\"hljs-keyword\">public</span> Admin <span class=\"hljs-title function_\">handle</span><span class=\"hljs-params\">(ResultSet rs)</span> <span class=\"hljs-keyword\">throws</span> SQLException {\n\t\t\t\t<span class=\"hljs-keyword\">while</span> (rs.next()) {\n\t\t\t\t\t<span class=\"hljs-type\">Admin</span> <span class=\"hljs-variable\">admin</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Admin</span>();\n\t\t\t\t\t<span class=\"hljs-type\">int</span> <span class=\"hljs-variable\">id</span> <span class=\"hljs-operator\">=</span> rs.getInt(<span class=\"hljs-string\">&quot;id&quot;</span>);\n\t\t\t\t\t<span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">username</span> <span class=\"hljs-operator\">=</span> rs.getString(<span class=\"hljs-string\">&quot;username&quot;</span>);\n\t\t\t\t\t<span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">password</span> <span class=\"hljs-operator\">=</span> rs.getString(<span class=\"hljs-string\">&quot;password&quot;</span>);\n\t\t\t\t\tadmin.setId(id);\n\t\t\t\t\tadmin.setUsername(username);\n\t\t\t\t\tadmin.setPassword(password);\n\t\t\t\t\t<span class=\"hljs-keyword\">return</span> admin;\n\t\t\t\t}\n\t\t\t\t<span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">null</span>;\n\t\t\t}\n\t\t}, <span class=\"hljs-number\">1</span>);\n\t\tSystem.out.println(admin);\n\t\tdataSource.close();\n\t}\n\n\t<span class=\"hljs-meta\">@Test</span>\n\t<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">testQueryAll</span><span class=\"hljs-params\">()</span> {\n\t\t<span class=\"hljs-type\">ComboPooledDataSource</span> <span class=\"hljs-variable\">dataSource</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">ComboPooledDataSource</span>();\n\t\tdataSource.setJdbcUrl(<span class=\"hljs-string\">&quot;jdbc:mysql://127.0.0.1:3306/mytest&quot;</span>);\n\t\tdataSource.setUser(<span class=\"hljs-string\">&quot;root&quot;</span>);\n\t\tdataSource.setPassword(<span class=\"hljs-string\">&quot;root&quot;</span>);\n\t\t<span class=\"hljs-type\">MyQueryRunner</span> <span class=\"hljs-variable\">queryRunner</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">MyQueryRunner</span>(dataSource);\n\t\t<span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">sql</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;select * from admin&quot;</span>;\n\t\tList&lt;Admin&gt; admins = queryRunner.query(sql, <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">ResultSetHandler</span>&lt;List&lt;Admin&gt;&gt;() {\n\t\t\t<span class=\"hljs-meta\">@Override</span>\n\t\t\t<span class=\"hljs-keyword\">public</span> List&lt;Admin&gt; <span class=\"hljs-title function_\">handle</span><span class=\"hljs-params\">(ResultSet rs)</span> <span class=\"hljs-keyword\">throws</span> SQLException {\n\t\t\t\tList&lt;Admin&gt; admins = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">ArrayList</span>&lt;Admin&gt;();\n\t\t\t\t<span class=\"hljs-keyword\">while</span> (rs.next()) {\n\t\t\t\t\t<span class=\"hljs-type\">Admin</span> <span class=\"hljs-variable\">admin</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Admin</span>();\n\t\t\t\t\t<span class=\"hljs-type\">int</span> <span class=\"hljs-variable\">id</span> <span class=\"hljs-operator\">=</span> rs.getInt(<span class=\"hljs-string\">&quot;id&quot;</span>);\n\t\t\t\t\t<span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">username</span> <span class=\"hljs-operator\">=</span> rs.getString(<span class=\"hljs-string\">&quot;username&quot;</span>);\n\t\t\t\t\t<span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">password</span> <span class=\"hljs-operator\">=</span> rs.getString(<span class=\"hljs-string\">&quot;password&quot;</span>);\n\t\t\t\t\tadmin.setId(id);\n\t\t\t\t\tadmin.setUsername(username);\n\t\t\t\t\tadmin.setPassword(password);\n\t\t\t\t\tadmins.add(admin);\n\t\t\t\t}\n\t\t\t\t<span class=\"hljs-keyword\">return</span> admins;\n\t\t\t}\n\t\t});\n\t\t<span class=\"hljs-keyword\">for</span> (Admin admin : admins) {\n\t\t\tSystem.out.println(admin);\n\t\t}\n\t\tdataSource.close();\n\t}\n\n\t<span class=\"hljs-meta\">@Test</span>\n\t<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">testInsert</span><span class=\"hljs-params\">()</span> {\n\t\t<span class=\"hljs-type\">ComboPooledDataSource</span> <span class=\"hljs-variable\">dataSource</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">ComboPooledDataSource</span>();\n\t\tdataSource.setJdbcUrl(<span class=\"hljs-string\">&quot;jdbc:mysql://127.0.0.1:3306/mytest&quot;</span>);\n\t\tdataSource.setUser(<span class=\"hljs-string\">&quot;root&quot;</span>);\n\t\tdataSource.setPassword(<span class=\"hljs-string\">&quot;root&quot;</span>);\n\t\t<span class=\"hljs-type\">MyQueryRunner</span> <span class=\"hljs-variable\">queryRunner</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">MyQueryRunner</span>(dataSource);\n\t\t<span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">sql</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;insert into admin values(NULL,?,?)&quot;</span>;\n\t\t<span class=\"hljs-type\">int</span> <span class=\"hljs-variable\">rows</span> <span class=\"hljs-operator\">=</span> queryRunner.update(sql, <span class=\"hljs-string\">&quot;xiaoqiang&quot;</span>, <span class=\"hljs-string\">&quot;123456&quot;</span>);\n\t\t<span class=\"hljs-keyword\">if</span> (rows &gt; <span class=\"hljs-number\">0</span>) {\n\t\t\tSystem.out.println(<span class=\"hljs-string\">&quot;&#x63d2;&#x5165;&#x6210;&#x529f;&quot;</span>);\n\t\t} <span class=\"hljs-keyword\">else</span> {\n\t\t\tSystem.out.println(<span class=\"hljs-string\">&quot;&#x63d2;&#x5165;&#x5931;&#x8d25;&quot;</span>);\n\t\t}\n\t\tdataSource.close();\n\t}\n\n\t<span class=\"hljs-meta\">@Test</span>\n\t<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">testUpdate</span><span class=\"hljs-params\">()</span> {\n\t\t<span class=\"hljs-type\">ComboPooledDataSource</span> <span class=\"hljs-variable\">dataSource</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">ComboPooledDataSource</span>();\n\t\tdataSource.setJdbcUrl(<span class=\"hljs-string\">&quot;jdbc:mysql://127.0.0.1:3306/mytest&quot;</span>);\n\t\tdataSource.setUser(<span class=\"hljs-string\">&quot;root&quot;</span>);\n\t\tdataSource.setPassword(<span class=\"hljs-string\">&quot;root&quot;</span>);\n\t\t<span class=\"hljs-type\">MyQueryRunner</span> <span class=\"hljs-variable\">queryRunner</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">MyQueryRunner</span>(dataSource);\n\t\t<span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">sql</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;update admin set username = &apos;mingming&apos; where id = ?&quot;</span>;\n\t\t<span class=\"hljs-type\">int</span> <span class=\"hljs-variable\">rows</span> <span class=\"hljs-operator\">=</span> queryRunner.update(sql, <span class=\"hljs-number\">4</span>);\n\t\t<span class=\"hljs-keyword\">if</span> (rows &gt; <span class=\"hljs-number\">0</span>) {\n\t\t\tSystem.out.println(<span class=\"hljs-string\">&quot;&#x4fee;&#x6539;&#x6210;&#x529f;&quot;</span>);\n\t\t} <span class=\"hljs-keyword\">else</span> {\n\t\t\tSystem.out.println(<span class=\"hljs-string\">&quot;&#x4fee;&#x6539;&#x5931;&#x8d25;&quot;</span>);\n\t\t}\n\t\tdataSource.close();\n\t}\n\n\t<span class=\"hljs-meta\">@Test</span>\n\t<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">testDelete</span><span class=\"hljs-params\">()</span> {\n\t\t<span class=\"hljs-type\">ComboPooledDataSource</span> <span class=\"hljs-variable\">dataSource</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">ComboPooledDataSource</span>();\n\t\tdataSource.setJdbcUrl(<span class=\"hljs-string\">&quot;jdbc:mysql://127.0.0.1:3306/mytest&quot;</span>);\n\t\tdataSource.setUser(<span class=\"hljs-string\">&quot;root&quot;</span>);\n\t\tdataSource.setPassword(<span class=\"hljs-string\">&quot;root&quot;</span>);\n\t\t<span class=\"hljs-type\">MyQueryRunner</span> <span class=\"hljs-variable\">queryRunner</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">MyQueryRunner</span>(dataSource);\n\t\t<span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">sql</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;delete from admin where id = ?&quot;</span>;\n\t\t<span class=\"hljs-type\">int</span> <span class=\"hljs-variable\">rows</span> <span class=\"hljs-operator\">=</span> queryRunner.update(sql, <span class=\"hljs-number\">7</span>);\n\t\t<span class=\"hljs-keyword\">if</span> (rows &gt; <span class=\"hljs-number\">0</span>) {\n\t\t\tSystem.out.println(<span class=\"hljs-string\">&quot;&#x5220;&#x9664;&#x6210;&#x529f;&quot;</span>);\n\t\t} <span class=\"hljs-keyword\">else</span> {\n\t\t\tSystem.out.println(<span class=\"hljs-string\">&quot;&#x5220;&#x9664;&#x5931;&#x8d25;&quot;</span>);\n\t\t}\n\t\tdataSource.close();\n\t}\n\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"848,973"}}],"payload":{"tag":"h2","lines":"541,543"}}],"payload":{"tag":"h1","lines":"0,1"}},{})</script>
</body>
</html>
