<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets@11.11.1/styles/default.min.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.18.10/dist/browser/index.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/index.js"></script><script>(r => {
              setTimeout(r);
            })(function renderToolbar() {
  const {
    markmap,
    mm
  } = window;
  const {
    el
  } = markmap.Toolbar.create(mm);
  el.setAttribute('style', 'position:absolute;bottom:20px;right:20px');
  document.body.append(el);
})</script><script>((getMarkmap, getOptions, root2, jsonOptions) => {
              const markmap = getMarkmap();
              window.mm = markmap.Markmap.create(
                "svg#mindmap",
                (getOptions || markmap.deriveOptions)(jsonOptions),
                root2
              );
            })(() => window.markmap,null,{"content":"<a href=\"#api\">#</a> API","children":[{"content":"&#x8ba4;&#x8bc6;","children":[{"content":"<pre data-lines=\"6,7\"><code>&#x4e0a;&#x4e00;&#x8282;&#x6211;&#x4eec;&#x5bf9; Vuex &#x7684;&#x521d;&#x59cb;&#x5316;&#x8fc7;&#x7a0b;&#x6709;&#x4e86;&#x6df1;&#x5165;&#x7684;&#x5206;&#x6790;&#xff0c;&#x5728;&#x6211;&#x4eec;&#x6784;&#x9020;&#x597d;&#x8fd9;&#x4e2a; `store` &#x540e;&#xff0c;&#x9700;&#x8981;&#x63d0;&#x4f9b;&#x4e00;&#x4e9b; API &#x5bf9;&#x8fd9;&#x4e2a; `store` &#x505a;&#x5b58;&#x53d6;&#x7684;&#x64cd;&#x4f5c;&#xff0c;&#x90a3;&#x4e48;&#x8fd9;&#x4e00;&#x8282;&#x6211;&#x4eec;&#x5c31;&#x4ece;&#x6e90;&#x7801;&#x7684;&#x89d2;&#x5ea6;&#x5bf9;&#x8fd9;&#x4e9b; API &#x505a;&#x5206;&#x6790;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"6,7"}}],"payload":{"tag":"h2","lines":"3,5"}},{"content":"<a href=\"#%E6%95%B0%E6%8D%AE%E8%8E%B7%E5%8F%96\">#</a> &#x6570;&#x636e;&#x83b7;&#x53d6;","children":[{"content":"<pre data-lines=\"11,12\"><code>Vuex &#x6700;&#x7ec8;&#x5b58;&#x50a8;&#x7684;&#x6570;&#x636e;&#x662f;&#x5728; `state` &#x4e0a;&#x7684;&#xff0c;&#x6211;&#x4eec;&#x4e4b;&#x524d;&#x5206;&#x6790;&#x8fc7;&#x5728; `store.state` &#x5b58;&#x50a8;&#x7684;&#x662f; `root state`&#xff0c;&#x90a3;&#x4e48;&#x5bf9;&#x4e8e;&#x6a21;&#x5757;&#x4e0a;&#x7684; `state`&#xff0c;&#x5047;&#x8bbe;&#x6211;&#x4eec;&#x6709; 2 &#x4e2a;&#x5d4c;&#x5957;&#x7684; `modules`&#xff0c;&#x5b83;&#x4eec;&#x7684; `key` &#x5206;&#x522b;&#x4e3a; `a` &#x548c; `b`&#xff0c;&#x6211;&#x4eec;&#x53ef;&#x4ee5;&#x901a;&#x8fc7; `store.state.a.b.xxx` &#x7684;&#x65b9;&#x5f0f;&#x53bb;&#x83b7;&#x53d6;&#x3002;&#x5b83;&#x7684;&#x5b9e;&#x73b0;&#x662f;&#x5728;&#x53d1;&#x751f;&#x5728; `installModule` &#x7684;&#x65f6;&#x5019;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"11,12"}},{"content":"<pre data-lines=\"13,29\"><code data-lines=\"13,29\">function installModule (store, rootState, path, module, hot) {\n  <span class=\"hljs-keyword\">const</span> isRoot = !path.length\n  \n  // ...\n  // <span class=\"hljs-built_in\">set</span> <span class=\"hljs-keyword\">state</span>\n  if (!isRoot &amp;&amp; !hot) {\n    <span class=\"hljs-keyword\">const</span> <span class=\"hljs-keyword\">parent</span>State = getNestedState(rootState, path.slice(<span class=\"hljs-number\">0</span>, -<span class=\"hljs-number\">1</span>))\n    <span class=\"hljs-keyword\">const</span> moduleName = path[path.length - <span class=\"hljs-number\">1</span>]\n    store._withCommit(() =&gt; {\n      Vue.<span class=\"hljs-built_in\">set</span>(<span class=\"hljs-keyword\">parent</span>State, moduleName, module.<span class=\"hljs-keyword\">state</span>)\n    })\n  }\n  // ...\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"13,29"}},{"content":"<pre data-lines=\"30,33\"><code>&#x5728;&#x9012;&#x5f52;&#x6267;&#x884c; `installModule` &#x7684;&#x8fc7;&#x7a0b;&#x4e2d;&#xff0c;&#x5c31;&#x5b8c;&#x6210;&#x4e86;&#x6574;&#x4e2a; `state` &#x7684;&#x5efa;&#x8bbe;&#xff0c;&#x8fd9;&#x6837;&#x6211;&#x4eec;&#x5c31;&#x53ef;&#x4ee5;&#x901a;&#x8fc7; `module` &#x540d;&#x7684; `path` &#x53bb;&#x8bbf;&#x95ee;&#x5230;&#x4e00;&#x4e2a;&#x6df1;&#x5c42; `module` &#x7684; `state`&#x3002;\n\n&#x6709;&#x4e9b;&#x65f6;&#x5019;&#xff0c;&#x6211;&#x4eec;&#x83b7;&#x53d6;&#x7684;&#x6570;&#x636e;&#x4e0d;&#x4ec5;&#x4ec5;&#x662f;&#x4e00;&#x4e2a; `state`&#xff0c;&#x800c;&#x662f;&#x7531;&#x591a;&#x4e2a; `state` &#x8ba1;&#x7b97;&#x800c;&#x6765;&#xff0c;Vuex &#x63d0;&#x4f9b;&#x4e86; `getters`&#xff0c;&#x5141;&#x8bb8;&#x6211;&#x4eec;&#x5b9a;&#x4e49;&#x4e00;&#x4e2a; `getter` &#x51fd;&#x6570;&#xff0c;&#x5982;&#x4e0b;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"30,33"}},{"content":"<pre data-lines=\"34,42\"><code data-lines=\"34,42\">getters: {\n  total (<span class=\"hljs-keyword\">state</span>, getters, localState, localGetters) {\n    // &#x53ef;&#x8bbf;&#x95ee;&#x5168;&#x5c40; <span class=\"hljs-keyword\">state</span> &#x548c; getters&#xff0c;&#x4ee5;&#x53ca;&#x5982;&#x679c;&#x662f;&#x5728; modules &#x4e0b;&#x9762;&#xff0c;&#x53ef;&#x4ee5;&#x8bbf;&#x95ee;&#x5230;&#x5c40;&#x90e8; <span class=\"hljs-keyword\">state</span> &#x548c; &#x5c40;&#x90e8; getters\n    return <span class=\"hljs-keyword\">state</span>.a + <span class=\"hljs-keyword\">state</span>.b\n  }\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"34,42"}},{"content":"<pre data-lines=\"43,44\"><code>&#x6211;&#x4eec;&#x5728; `installModule` &#x7684;&#x8fc7;&#x7a0b;&#x4e2d;&#xff0c;&#x9012;&#x5f52;&#x6267;&#x884c;&#x4e86;&#x6240;&#x6709; `getters` &#x5b9a;&#x4e49;&#x7684;&#x6ce8;&#x518c;&#xff0c;&#x5728;&#x4e4b;&#x540e;&#x7684; `resetStoreVM` &#x8fc7;&#x7a0b;&#x4e2d;&#xff0c;&#x6267;&#x884c;&#x4e86; `store.getters` &#x7684;&#x521d;&#x59cb;&#x5316;&#x5de5;&#x4f5c;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"43,44"}},{"content":"<pre data-lines=\"45,107\"><code data-lines=\"45,107\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">installModule</span> (<span class=\"hljs-params\">store, rootState, path, <span class=\"hljs-variable language_\">module</span>, hot</span>) {\n  <span class=\"hljs-comment\">// ...</span>\n  <span class=\"hljs-keyword\">const</span> namespace = store.<span class=\"hljs-property\">_modules</span>.<span class=\"hljs-title function_\">getNamespace</span>(path)\n  <span class=\"hljs-comment\">// ...</span>\n  <span class=\"hljs-keyword\">const</span> local = <span class=\"hljs-variable language_\">module</span>.<span class=\"hljs-property\">context</span> = <span class=\"hljs-title function_\">makeLocalContext</span>(store, namespace, path)\n\n  <span class=\"hljs-comment\">// ...</span>\n\n  <span class=\"hljs-variable language_\">module</span>.<span class=\"hljs-title function_\">forEachGetter</span>(<span class=\"hljs-function\">(<span class=\"hljs-params\">getter, key</span>) =&gt;</span> {\n    <span class=\"hljs-keyword\">const</span> namespacedType = namespace + key\n    <span class=\"hljs-title function_\">registerGetter</span>(store, namespacedType, getter, local)\n  })\n\n  <span class=\"hljs-comment\">// ...</span>\n}\n\n<span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">registerGetter</span> (<span class=\"hljs-params\">store, type, rawGetter, local</span>) {\n  <span class=\"hljs-keyword\">if</span> (store.<span class=\"hljs-property\">_wrappedGetters</span>[type]) {\n    <span class=\"hljs-keyword\">if</span> (process.<span class=\"hljs-property\">env</span>.<span class=\"hljs-property\">NODE_ENV</span> !== <span class=\"hljs-string\">&apos;production&apos;</span>) {\n      <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">error</span>(<span class=\"hljs-string\">`[vuex] duplicate getter key: <span class=\"hljs-subst\">&#x24;{type}</span>`</span>)\n    }\n    <span class=\"hljs-keyword\">return</span>\n  }\n  store.<span class=\"hljs-property\">_wrappedGetters</span>[type] = <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">wrappedGetter</span> (<span class=\"hljs-params\">store</span>) {\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-title function_\">rawGetter</span>(\n      local.<span class=\"hljs-property\">state</span>, <span class=\"hljs-comment\">// local state</span>\n      local.<span class=\"hljs-property\">getters</span>, <span class=\"hljs-comment\">// local getters</span>\n      store.<span class=\"hljs-property\">state</span>, <span class=\"hljs-comment\">// root state</span>\n      store.<span class=\"hljs-property\">getters</span> <span class=\"hljs-comment\">// root getters</span>\n    )\n  }\n}\n\n<span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">resetStoreVM</span> (<span class=\"hljs-params\">store, state, hot</span>) {\n  <span class=\"hljs-comment\">// ...</span>\n  <span class=\"hljs-comment\">// bind store public getters</span>\n  store.<span class=\"hljs-property\">getters</span> = {}\n  <span class=\"hljs-keyword\">const</span> wrappedGetters = store.<span class=\"hljs-property\">_wrappedGetters</span>\n  <span class=\"hljs-keyword\">const</span> computed = {}\n  <span class=\"hljs-title function_\">forEachValue</span>(wrappedGetters, <span class=\"hljs-function\">(<span class=\"hljs-params\">fn, key</span>) =&gt;</span> {\n    <span class=\"hljs-comment\">// use computed to leverage its lazy-caching mechanism</span>\n    computed[key] = <span class=\"hljs-function\">() =&gt;</span> <span class=\"hljs-title function_\">fn</span>(store)\n    <span class=\"hljs-title class_\">Object</span>.<span class=\"hljs-title function_\">defineProperty</span>(store.<span class=\"hljs-property\">getters</span>, key, {\n      <span class=\"hljs-attr\">get</span>: <span class=\"hljs-function\">() =&gt;</span> store.<span class=\"hljs-property\">_vm</span>[key],\n      <span class=\"hljs-attr\">enumerable</span>: <span class=\"hljs-literal\">true</span> <span class=\"hljs-comment\">// for local getters</span>\n    })\n  })\n\n  <span class=\"hljs-comment\">// use a Vue instance to store the state tree</span>\n  <span class=\"hljs-comment\">// suppress warnings just in case the user has added</span>\n  <span class=\"hljs-comment\">// some funky global mixins</span>\n  <span class=\"hljs-comment\">// ...</span>\n  store.<span class=\"hljs-property\">_vm</span> = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Vue</span>({\n    <span class=\"hljs-attr\">data</span>: {\n      <span class=\"hljs-attr\">&#x24;&#x24;state</span>: state\n    },\n    computed\n  })\n  <span class=\"hljs-comment\">// ...</span>\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"45,107"}},{"content":"<pre data-lines=\"108,109\"><code>&#x5728; `installModule` &#x7684;&#x8fc7;&#x7a0b;&#x4e2d;&#xff0c;&#x4e3a;&#x5efa;&#x7acb;&#x4e86;&#x6bcf;&#x4e2a;&#x6a21;&#x5757;&#x7684;&#x4e0a;&#x4e0b;&#x6587;&#x73af;&#x5883;&#xff0c; &#x56e0;&#x6b64;&#x5f53;&#x6211;&#x4eec;&#x8bbf;&#x95ee; `store.getters.xxx` &#x7684;&#x65f6;&#x5019;&#xff0c;&#x5b9e;&#x9645;&#x4e0a;&#x5c31;&#x662f;&#x6267;&#x884c;&#x4e86; `rawGetter(local.state,...)`&#xff0c;`rawGetter` &#x5c31;&#x662f;&#x6211;&#x4eec;&#x5b9a;&#x4e49;&#x7684; `getter` &#x65b9;&#x6cd5;&#xff0c;&#x8fd9;&#x4e5f;&#x5c31;&#x662f;&#x4e3a;&#x4ec0;&#x4e48;&#x6211;&#x4eec;&#x7684; `getter` &#x51fd;&#x6570;&#x652f;&#x6301;&#x8fd9;&#x56db;&#x4e2a;&#x53c2;&#x6570;&#xff0c;&#x5e76;&#x4e14;&#x9664;&#x4e86;&#x5168;&#x5c40;&#x7684; `state` &#x548c; `getter` &#x5916;&#xff0c;&#x6211;&#x4eec;&#x8fd8;&#x53ef;&#x4ee5;&#x8bbf;&#x95ee;&#x5230;&#x5f53;&#x524d; `module` &#x4e0b;&#x7684; `state` &#x548c; `getter`&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"108,109"}}],"payload":{"tag":"h2","lines":"8,10"}},{"content":"<a href=\"#%E6%95%B0%E6%8D%AE%E5%AD%98%E5%82%A8\">#</a> &#x6570;&#x636e;&#x5b58;&#x50a8;","children":[{"content":"<pre data-lines=\"113,114\"><code>Vuex &#x5bf9;&#x6570;&#x636e;&#x5b58;&#x50a8;&#x7684;&#x5b58;&#x50a8;&#x672c;&#x8d28;&#x4e0a;&#x5c31;&#x662f;&#x5bf9; `state` &#x505a;&#x4fee;&#x6539;&#xff0c;&#x5e76;&#x4e14;&#x53ea;&#x5141;&#x8bb8;&#x6211;&#x4eec;&#x901a;&#x8fc7;&#x63d0;&#x4ea4; `mutaion` &#x7684;&#x5f62;&#x5f0f;&#x53bb;&#x4fee;&#x6539; `state`&#xff0c;`mutation` &#x662f;&#x4e00;&#x4e2a;&#x51fd;&#x6570;&#xff0c;&#x5982;&#x4e0b;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"113,114"}},{"content":"<pre data-lines=\"115,122\"><code data-lines=\"115,122\">mutations: {\n  increment (<span class=\"hljs-keyword\">state</span>) {\n    <span class=\"hljs-keyword\">state</span>.count++\n  }\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"115,122"}},{"content":"<pre data-lines=\"123,124\"><code>`mutations` &#x7684;&#x521d;&#x59cb;&#x5316;&#x4e5f;&#x662f;&#x5728; `installModule` &#x7684;&#x65f6;&#x5019;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"123,124"}},{"content":"<pre data-lines=\"125,147\"><code data-lines=\"125,147\"><span class=\"hljs-keyword\">function</span> installModule (store, rootState, path, <span class=\"hljs-keyword\">module</span>, hot) {\n  <span class=\"hljs-comment\">// ...</span>\n  <span class=\"hljs-keyword\">const</span> namespace = store<span class=\"hljs-variable\">._modules</span><span class=\"hljs-variable\">.getNamespace</span>(path)\n\n  <span class=\"hljs-comment\">// ...</span>\n  <span class=\"hljs-keyword\">const</span> <span class=\"hljs-keyword\">local</span> = <span class=\"hljs-keyword\">module</span><span class=\"hljs-variable\">.context</span> = makeLocalContext(store, namespace, path)\n\n  <span class=\"hljs-keyword\">module</span><span class=\"hljs-variable\">.forEachMutation</span>((mutation, key) =&gt; {\n    <span class=\"hljs-keyword\">const</span> namespacedType = namespace + key\n    registerMutation(store, namespacedType, mutation, <span class=\"hljs-keyword\">local</span>)\n  })\n  <span class=\"hljs-comment\">// ...</span>\n}\n\n<span class=\"hljs-keyword\">function</span> registerMutation (store, <span class=\"hljs-keyword\">type</span>, handler, <span class=\"hljs-keyword\">local</span>) {\n  <span class=\"hljs-keyword\">const</span> entry = store<span class=\"hljs-variable\">._mutations</span>[<span class=\"hljs-keyword\">type</span>] || (store<span class=\"hljs-variable\">._mutations</span>[<span class=\"hljs-keyword\">type</span>] = [])\n  entry<span class=\"hljs-variable\">.push</span>(<span class=\"hljs-keyword\">function</span> wrappedMutationHandler (payload) {\n    handler<span class=\"hljs-variable\">.call</span>(store, <span class=\"hljs-keyword\">local</span><span class=\"hljs-variable\">.state</span>, payload)\n  })\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"125,147"}},{"content":"<pre data-lines=\"148,149\"><code>`store` &#x63d0;&#x4f9b;&#x4e86;`commit` &#x65b9;&#x6cd5;&#x8ba9;&#x6211;&#x4eec;&#x63d0;&#x4ea4;&#x4e00;&#x4e2a; `mutation`&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"148,149"}},{"content":"<pre data-lines=\"150,185\"><code data-lines=\"150,185\"><span class=\"hljs-title function_\">commit</span> (_type, _payload, _options) {\n  <span class=\"hljs-comment\">// check object-style commit</span>\n  <span class=\"hljs-keyword\">const</span> {\n    <span class=\"hljs-keyword\">type</span>,\n    payload,\n    options\n  } = <span class=\"hljs-title function_\">unifyObjectStyle</span>(_type, _payload, _options)\n\n  <span class=\"hljs-keyword\">const</span> mutation = { <span class=\"hljs-keyword\">type</span>, payload }\n  <span class=\"hljs-keyword\">const</span> entry = <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">_mutations</span>[<span class=\"hljs-keyword\">type</span>]\n  <span class=\"hljs-keyword\">if</span> (!entry) {\n    <span class=\"hljs-keyword\">if</span> (process.<span class=\"hljs-property\">env</span>.<span class=\"hljs-property\">NODE_ENV</span> !== <span class=\"hljs-string\">&apos;production&apos;</span>) {\n      <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">error</span>(<span class=\"hljs-string\">`[vuex] unknown mutation type: <span class=\"hljs-subst\">&#x24;{<span class=\"hljs-keyword\">type</span>}</span>`</span>)\n    }\n    <span class=\"hljs-keyword\">return</span>\n  }\n  <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-title function_\">_withCommit</span>(<span class=\"hljs-function\">() =&gt;</span> {\n    entry.<span class=\"hljs-title function_\">forEach</span>(<span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">commitIterator</span> (<span class=\"hljs-params\">handler</span>) {\n      <span class=\"hljs-title function_\">handler</span>(payload)\n    })\n  })\n  <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">_subscribers</span>.<span class=\"hljs-title function_\">forEach</span>(<span class=\"hljs-function\"><span class=\"hljs-params\">sub</span> =&gt;</span> <span class=\"hljs-title function_\">sub</span>(mutation, <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">state</span>))\n\n  <span class=\"hljs-keyword\">if</span> (\n    process.<span class=\"hljs-property\">env</span>.<span class=\"hljs-property\">NODE_ENV</span> !== <span class=\"hljs-string\">&apos;production&apos;</span> &amp;&amp;\n    options &amp;&amp; options.<span class=\"hljs-property\">silent</span>\n  ) {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">warn</span>(\n      <span class=\"hljs-string\">`[vuex] mutation type: <span class=\"hljs-subst\">&#x24;{<span class=\"hljs-keyword\">type</span>}</span>. Silent option has been removed. `</span> +\n      <span class=\"hljs-string\">&apos;Use the filter functionality in the vue-devtools&apos;</span>\n    )\n  }\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"150,185"}},{"content":"<pre data-lines=\"186,191\"><code>&#x8fd9;&#x91cc;&#x4f20;&#x5165;&#x7684; `_type` &#x5c31;&#x662f; `mutation` &#x7684; `type`&#xff0c;&#x6211;&#x4eec;&#x53ef;&#x4ee5;&#x4ece; `store._mutations` &#x627e;&#x5230;&#x5bf9;&#x5e94;&#x7684;&#x51fd;&#x6570;&#x6570;&#x7ec4;&#xff0c;&#x904d;&#x5386;&#x5b83;&#x4eec;&#x6267;&#x884c;&#x83b7;&#x53d6;&#x5230;&#x6bcf;&#x4e2a; `handler` &#x7136;&#x540e;&#x6267;&#x884c;&#xff0c;&#x5b9e;&#x9645;&#x4e0a;&#x5c31;&#x662f;&#x6267;&#x884c;&#x4e86; `wrappedMutationHandler(playload)`&#xff0c;&#x63a5;&#x7740;&#x4f1a;&#x6267;&#x884c;&#x6211;&#x4eec;&#x5b9a;&#x4e49;&#x7684; `mutation` &#x51fd;&#x6570;&#xff0c;&#x5e76;&#x4f20;&#x5165;&#x5f53;&#x524d;&#x6a21;&#x5757;&#x7684; `state`&#xff0c;&#x6240;&#x4ee5;&#x6211;&#x4eec;&#x7684; `mutation` &#x51fd;&#x6570;&#x4e5f;&#x5c31;&#x662f;&#x5bf9;&#x5f53;&#x524d;&#x6a21;&#x5757;&#x7684; `state` &#x505a;&#x4fee;&#x6539;&#x3002;\n\n&#x9700;&#x8981;&#x6ce8;&#x610f;&#x7684;&#x662f;&#xff0c; `mutation` &#x5fc5;&#x987b;&#x662f;&#x540c;&#x6b65;&#x51fd;&#x6570;&#xff0c;&#x4f46;&#x662f;&#x6211;&#x4eec;&#x5728;&#x5f00;&#x53d1;&#x5b9e;&#x9645;&#x9879;&#x76ee;&#x4e2d;&#xff0c;&#x7ecf;&#x5e38;&#x4f1a;&#x9047;&#x5230;&#x8981;&#x5148;&#x53bb;&#x53d1;&#x9001;&#x4e00;&#x4e2a;&#x8bf7;&#x6c42;&#xff0c;&#x7136;&#x540e;&#x6839;&#x636e;&#x8bf7;&#x6c42;&#x7684;&#x7ed3;&#x679c;&#x53bb;&#x4fee;&#x6539; `state`&#xff0c;&#x90a3;&#x4e48;&#x5355;&#x7eaf;&#x53ea;&#x901a;&#x8fc7; `mutation` &#x662f;&#x65e0;&#x6cd5;&#x5b8c;&#x6210;&#x9700;&#x6c42;&#xff0c;&#x56e0;&#x6b64; Vuex &#x53c8;&#x7ed9;&#x6211;&#x4eec;&#x8bbe;&#x8ba1;&#x4e86;&#x4e00;&#x4e2a; `action` &#x7684;&#x6982;&#x5ff5;&#x3002;\n\n`action` &#x7c7b;&#x4f3c;&#x4e8e; `mutation`&#xff0c;&#x4e0d;&#x540c;&#x5728;&#x4e8e; `action` &#x63d0;&#x4ea4;&#x7684;&#x662f; `mutation`&#xff0c;&#x800c;&#x4e0d;&#x662f;&#x76f4;&#x63a5;&#x64cd;&#x4f5c; `state`&#xff0c;&#x5e76;&#x4e14;&#x5b83;&#x53ef;&#x4ee5;&#x5305;&#x542b;&#x4efb;&#x610f;&#x5f02;&#x6b65;&#x64cd;&#x4f5c;&#x3002;&#x4f8b;&#x5982;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"186,191"}},{"content":"<pre data-lines=\"192,206\"><code data-lines=\"192,206\">mutations: {\n  increment (<span class=\"hljs-keyword\">state</span>) {\n    <span class=\"hljs-keyword\">state</span>.count++\n  }\n},\nactions: {\n  increment (context) {\n    <span class=\"hljs-built_in\">set</span>Timeout(() =&gt; {\n      context.commit(&apos;increment&apos;)\n    }, <span class=\"hljs-number\">0</span>)\n  }\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"192,206"}},{"content":"<pre data-lines=\"207,208\"><code>`actions` &#x7684;&#x521d;&#x59cb;&#x5316;&#x4e5f;&#x662f;&#x5728; `installModule` &#x7684;&#x65f6;&#x5019;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"207,208"}},{"content":"<pre data-lines=\"209,250\"><code data-lines=\"209,250\"><span class=\"hljs-keyword\">function</span> installModule (store, rootState, path, <span class=\"hljs-keyword\">module</span>, hot) {\n  <span class=\"hljs-comment\">// ...</span>\n  <span class=\"hljs-keyword\">const</span> namespace = store<span class=\"hljs-variable\">._modules</span><span class=\"hljs-variable\">.getNamespace</span>(path)\n\n  <span class=\"hljs-comment\">// ...</span>\n  <span class=\"hljs-keyword\">const</span> <span class=\"hljs-keyword\">local</span> = <span class=\"hljs-keyword\">module</span><span class=\"hljs-variable\">.context</span> = makeLocalContext(store, namespace, path)\n\n  <span class=\"hljs-keyword\">module</span><span class=\"hljs-variable\">.forEachAction</span>((action, key) =&gt; {\n    <span class=\"hljs-keyword\">const</span> <span class=\"hljs-keyword\">type</span> = action<span class=\"hljs-variable\">.root</span> ? key : namespace + key\n    <span class=\"hljs-keyword\">const</span> handler = action<span class=\"hljs-variable\">.handler</span> || action\n    registerAction(store, <span class=\"hljs-keyword\">type</span>, handler, <span class=\"hljs-keyword\">local</span>)\n}  )\n  <span class=\"hljs-comment\">// ...</span>\n}\n\n<span class=\"hljs-keyword\">function</span> registerAction (store, <span class=\"hljs-keyword\">type</span>, handler, <span class=\"hljs-keyword\">local</span>) {\n  <span class=\"hljs-keyword\">const</span> entry = store<span class=\"hljs-variable\">._actions</span>[<span class=\"hljs-keyword\">type</span>] || (store<span class=\"hljs-variable\">._actions</span>[<span class=\"hljs-keyword\">type</span>] = [])\n  entry<span class=\"hljs-variable\">.push</span>(<span class=\"hljs-keyword\">function</span> wrappedActionHandler (payload, cb) {\n    <span class=\"hljs-keyword\">let</span> res = handler<span class=\"hljs-variable\">.call</span>(store, {\n      dispatch: <span class=\"hljs-keyword\">local</span><span class=\"hljs-variable\">.dispatch</span>,\n      commit: <span class=\"hljs-keyword\">local</span><span class=\"hljs-variable\">.commit</span>,\n      getters: <span class=\"hljs-keyword\">local</span><span class=\"hljs-variable\">.getters</span>,\n      state: <span class=\"hljs-keyword\">local</span><span class=\"hljs-variable\">.state</span>,\n      rootGetters: store<span class=\"hljs-variable\">.getters</span>,\n      rootState: store<span class=\"hljs-variable\">.state</span>\n    }, payload, cb)\n    <span class=\"hljs-keyword\">if</span> (!isPromise(res)) {\n      res = Promise<span class=\"hljs-variable\">.resolve</span>(res)\n    }\n    <span class=\"hljs-keyword\">if</span> (store<span class=\"hljs-variable\">._devtoolHook</span>) {\n      <span class=\"hljs-keyword\">return</span> res<span class=\"hljs-variable\">.catch</span>(err =&gt; {\n        store<span class=\"hljs-variable\">._devtoolHook</span><span class=\"hljs-variable\">.emit</span>(&apos;vuex:error&apos;, err)\n        throw err\n      })\n    } <span class=\"hljs-keyword\">else</span> {\n      <span class=\"hljs-keyword\">return</span> res\n    }\n  })\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"209,250"}},{"content":"<pre data-lines=\"251,252\"><code>`store` &#x63d0;&#x4f9b;&#x4e86;`dispatch` &#x65b9;&#x6cd5;&#x8ba9;&#x6211;&#x4eec;&#x63d0;&#x4ea4;&#x4e00;&#x4e2a; `action`&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"251,252"}},{"content":"<pre data-lines=\"253,277\"><code data-lines=\"253,277\"><span class=\"hljs-title function_\">dispatch</span> (_type, _payload) {\n  <span class=\"hljs-comment\">// check object-style dispatch</span>\n  <span class=\"hljs-keyword\">const</span> {\n    <span class=\"hljs-keyword\">type</span>,\n    payload\n  } = <span class=\"hljs-title function_\">unifyObjectStyle</span>(_type, _payload)\n\n  <span class=\"hljs-keyword\">const</span> action = { <span class=\"hljs-keyword\">type</span>, payload }\n  <span class=\"hljs-keyword\">const</span> entry = <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">_actions</span>[<span class=\"hljs-keyword\">type</span>]\n  <span class=\"hljs-keyword\">if</span> (!entry) {\n    <span class=\"hljs-keyword\">if</span> (process.<span class=\"hljs-property\">env</span>.<span class=\"hljs-property\">NODE_ENV</span> !== <span class=\"hljs-string\">&apos;production&apos;</span>) {\n      <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">error</span>(<span class=\"hljs-string\">`[vuex] unknown action type: <span class=\"hljs-subst\">&#x24;{<span class=\"hljs-keyword\">type</span>}</span>`</span>)\n    }\n    <span class=\"hljs-keyword\">return</span>\n  }\n\n  <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">_actionSubscribers</span>.<span class=\"hljs-title function_\">forEach</span>(<span class=\"hljs-function\"><span class=\"hljs-params\">sub</span> =&gt;</span> <span class=\"hljs-title function_\">sub</span>(action, <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">state</span>))\n\n  <span class=\"hljs-keyword\">return</span> entry.<span class=\"hljs-property\">length</span> &gt; <span class=\"hljs-number\">1</span>\n    ? <span class=\"hljs-title class_\">Promise</span>.<span class=\"hljs-title function_\">all</span>(entry.<span class=\"hljs-title function_\">map</span>(<span class=\"hljs-function\"><span class=\"hljs-params\">handler</span> =&gt;</span> <span class=\"hljs-title function_\">handler</span>(payload)))\n    : entry[<span class=\"hljs-number\">0</span>](payload)\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"253,277"}},{"content":"<pre data-lines=\"278,281\"><code>&#x8fd9;&#x91cc;&#x4f20;&#x5165;&#x7684; `_type` &#x5c31;&#x662f; `action` &#x7684; `type`&#xff0c;&#x6211;&#x4eec;&#x53ef;&#x4ee5;&#x4ece; `store._actions` &#x627e;&#x5230;&#x5bf9;&#x5e94;&#x7684;&#x51fd;&#x6570;&#x6570;&#x7ec4;&#xff0c;&#x904d;&#x5386;&#x5b83;&#x4eec;&#x6267;&#x884c;&#x83b7;&#x53d6;&#x5230;&#x6bcf;&#x4e2a; `handler` &#x7136;&#x540e;&#x6267;&#x884c;&#xff0c;&#x5b9e;&#x9645;&#x4e0a;&#x5c31;&#x662f;&#x6267;&#x884c;&#x4e86; `wrappedActionHandler(payload)`&#xff0c;&#x63a5;&#x7740;&#x4f1a;&#x6267;&#x884c;&#x6211;&#x4eec;&#x5b9a;&#x4e49;&#x7684; `action` &#x51fd;&#x6570;&#xff0c;&#x5e76;&#x4f20;&#x5165;&#x4e00;&#x4e2a;&#x5bf9;&#x8c61;&#xff0c;&#x5305;&#x542b;&#x4e86;&#x5f53;&#x524d;&#x6a21;&#x5757;&#x4e0b;&#x7684; `dispatch`&#x3001;`commit`&#x3001;`getters`&#x3001;`state`&#xff0c;&#x4ee5;&#x53ca;&#x5168;&#x5c40;&#x7684; `rootState` &#x548c; `rootGetters`&#xff0c;&#x6240;&#x4ee5;&#x6211;&#x4eec;&#x5b9a;&#x4e49;&#x7684; `action` &#x51fd;&#x6570;&#x80fd;&#x62ff;&#x5230;&#x5f53;&#x524d;&#x6a21;&#x5757;&#x4e0b;&#x7684; `commit` &#x65b9;&#x6cd5;&#x3002;\n\n&#x56e0;&#x6b64; `action` &#x6bd4;&#x6211;&#x4eec;&#x81ea;&#x5df1;&#x5199;&#x4e00;&#x4e2a;&#x51fd;&#x6570;&#x6267;&#x884c;&#x5f02;&#x6b65;&#x64cd;&#x4f5c;&#x7136;&#x540e;&#x63d0;&#x4ea4; `muataion` &#x7684;&#x597d;&#x5904;&#x662f;&#x5728;&#x4e8e;&#x5b83;&#x53ef;&#x4ee5;&#x5728;&#x53c2;&#x6570;&#x4e2d;&#x83b7;&#x53d6;&#x5230;&#x5f53;&#x524d;&#x6a21;&#x5757;&#x7684;&#x4e00;&#x4e9b;&#x65b9;&#x6cd5;&#x548c;&#x72b6;&#x6001;&#xff0c;Vuex &#x5e2e;&#x6211;&#x4eec;&#x505a;&#x597d;&#x4e86;&#x8fd9;&#x4e9b;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"278,281"}}],"payload":{"tag":"h2","lines":"110,112"}},{"content":"<a href=\"#%E8%AF%AD%E6%B3%95%E7%B3%96\">#</a> &#x8bed;&#x6cd5;&#x7cd6;","children":[{"content":"<a href=\"#mapstate\">#</a> <code>mapState</code>","children":[{"content":"<pre data-lines=\"306,307\"><code>&#x6211;&#x4eec;&#x5148;&#x6765;&#x770b;&#x4e00;&#x4e0b; `mapState` &#x7684;&#x7528;&#x6cd5;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"306,307"}},{"content":"<pre data-lines=\"308,328\"><code data-lines=\"308,328\">// &#x5728;&#x5355;&#x72ec;&#x6784;&#x5efa;&#x7684;&#x7248;&#x672c;&#x4e2d;&#x8f85;&#x52a9;&#x51fd;&#x6570;&#x4e3a; Vuex.mapState\nimport { mapState } <span class=\"hljs-keyword\">from</span> &apos;vuex&apos;\n\nexport <span class=\"hljs-keyword\">default</span> {\n  // ...\n  computed: mapState({\n    // &#x7bad;&#x5934;&#x51fd;&#x6570;&#x53ef;&#x4f7f;&#x4ee3;&#x7801;&#x66f4;&#x7b80;&#x7ec3;\n    count: <span class=\"hljs-keyword\">state</span> =&gt; <span class=\"hljs-keyword\">state</span>.count,\n\n    // &#x4f20;&#x5b57;&#x7b26;&#x4e32;&#x53c2;&#x6570; &apos;count&apos; &#x7b49;&#x540c;&#x4e8e; `<span class=\"hljs-keyword\">state</span> =&gt; <span class=\"hljs-keyword\">state</span>.count`\n    countAlias: &apos;count&apos;,\n\n    // &#x4e3a;&#x4e86;&#x80fd;&#x591f;&#x4f7f;&#x7528; `this` &#x83b7;&#x53d6;&#x5c40;&#x90e8;&#x72b6;&#x6001;&#xff0c;&#x5fc5;&#x987b;&#x4f7f;&#x7528;&#x5e38;&#x89c4;&#x51fd;&#x6570;\n    countPlusLocalState (<span class=\"hljs-keyword\">state</span>) {\n      return <span class=\"hljs-keyword\">state</span>.count + this.localCount\n    }\n  })\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"308,328"}},{"content":"<pre data-lines=\"329,330\"><code>&#x518d;&#x6765;&#x770b;&#x4e00;&#x4e0b; `mapState` &#x65b9;&#x6cd5;&#x7684;&#x5b9a;&#x4e49;&#xff0c;&#x5728; `src/helpers.js` &#x4e2d;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"329,330"}},{"content":"<pre data-lines=\"331,374\"><code data-lines=\"331,374\">export const mapState = normalizeNamespace((<span class=\"hljs-type\">namespace</span>, states) =&gt; {\n  const res = {}\n  normalizeMap(states).forEach(({<span class=\"hljs-built_in\"> key</span>, val }) =&gt; {\n    res<span class=\"hljs-built_in\">[key</span>] = <span class=\"hljs-keyword\">function</span> mappedState () {\n      <span class=\"hljs-keyword\">let</span> state = this.<span class=\"hljs-variable\">&#x24;store</span>.state\n      <span class=\"hljs-keyword\">let</span> getters = this.<span class=\"hljs-variable\">&#x24;store</span>.getters\n      <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-type\">namespace</span>) {\n        const <span class=\"hljs-keyword\">module</span> = getModuleByNamespace(this.<span class=\"hljs-variable\">&#x24;store</span>, <span class=\"hljs-string\">&apos;mapState&apos;</span>, <span class=\"hljs-type\">namespace</span>)\n        <span class=\"hljs-keyword\">if</span> (!<span class=\"hljs-keyword\">module</span>) {\n          <span class=\"hljs-keyword\">return</span>\n        }\n        state = <span class=\"hljs-keyword\">module</span>.<span class=\"hljs-keyword\">context</span>.state\n        getters = <span class=\"hljs-keyword\">module</span>.<span class=\"hljs-keyword\">context</span>.getters\n      }\n      <span class=\"hljs-keyword\">return</span> typeof val === <span class=\"hljs-string\">&apos;function&apos;</span>\n        ? val.call(this, state, getters)\n        : state[val]\n    }\n    // mark vuex getter <span class=\"hljs-keyword\">for</span> devtools\n    res<span class=\"hljs-built_in\">[key</span>].vuex =<span class=\"hljs-built_in\"> true</span>\n  })\n  <span class=\"hljs-keyword\">return</span> res\n})\n\n<span class=\"hljs-keyword\">function</span> normalizeNamespace (fn) {\n  <span class=\"hljs-keyword\">return</span> (<span class=\"hljs-type\">namespace</span>, <span class=\"hljs-keyword\">map</span>) =&gt; {\n    <span class=\"hljs-keyword\">if</span> (typeof <span class=\"hljs-type\">namespace</span> !== <span class=\"hljs-string\">&apos;string&apos;</span>) {\n      <span class=\"hljs-keyword\">map</span> = <span class=\"hljs-type\">namespace</span>\n      <span class=\"hljs-type\">namespace</span> = <span class=\"hljs-string\">&apos;&apos;</span>\n    } <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-type\">namespace</span>.charAt(<span class=\"hljs-type\">namespace</span>.length - <span class=\"hljs-number\">1</span>) !== <span class=\"hljs-string\">&apos;/&apos;</span>) {\n      <span class=\"hljs-type\">namespace</span> += <span class=\"hljs-string\">&apos;/&apos;</span>\n    }\n    <span class=\"hljs-keyword\">return</span> fn(<span class=\"hljs-type\">namespace</span>, <span class=\"hljs-keyword\">map</span>)\n  }\n}\n\n<span class=\"hljs-keyword\">function</span> normalizeMap (<span class=\"hljs-keyword\">map</span>) {\n  <span class=\"hljs-keyword\">return</span> Array.isArray(<span class=\"hljs-keyword\">map</span>)\n    ? <span class=\"hljs-keyword\">map</span>.<span class=\"hljs-keyword\">map</span><span class=\"hljs-built_in\">(key</span> =&gt; ({<span class=\"hljs-built_in\"> key</span>, val:<span class=\"hljs-built_in\"> key</span> }))\n    : Object.keys(<span class=\"hljs-keyword\">map</span>).<span class=\"hljs-keyword\">map</span><span class=\"hljs-built_in\">(key</span> =&gt; ({<span class=\"hljs-built_in\"> key</span>, val: <span class=\"hljs-keyword\">map</span><span class=\"hljs-built_in\">[key</span>] }))\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"331,374"}},{"content":"<pre data-lines=\"375,384\"><code>&#x9996;&#x5148; `mapState` &#x662f;&#x901a;&#x8fc7;&#x6267;&#x884c; `normalizeNamespace` &#x8fd4;&#x56de;&#x7684;&#x51fd;&#x6570;&#xff0c;&#x5b83;&#x63a5;&#x6536; 2 &#x4e2a;&#x53c2;&#x6570;&#xff0c;&#x5176;&#x4e2d; `namespace` &#x8868;&#x793a;&#x547d;&#x540d;&#x7a7a;&#x95f4;&#xff0c;`map` &#x8868;&#x793a;&#x5177;&#x4f53;&#x7684;&#x5bf9;&#x8c61;&#xff0c;`namespace` &#x53ef;&#x4e0d;&#x4f20;&#xff0c;&#x7a0d;&#x540e;&#x6211;&#x4eec;&#x6765;&#x4ecb;&#x7ecd; `namespace` &#x7684;&#x4f5c;&#x7528;&#x3002;\n\n&#x5f53;&#x6267;&#x884c; `mapState(map)` &#x51fd;&#x6570;&#x7684;&#x65f6;&#x5019;&#xff0c;&#x5b9e;&#x9645;&#x4e0a;&#x5c31;&#x662f;&#x6267;&#x884c; `normalizeNamespace` &#x5305;&#x88f9;&#x7684;&#x51fd;&#x6570;&#xff0c;&#x7136;&#x540e;&#x628a; `map` &#x4f5c;&#x4e3a;&#x53c2;&#x6570; `states` &#x4f20;&#x5165;&#x3002;\n\n`mapState` &#x6700;&#x7ec8;&#x662f;&#x8981;&#x6784;&#x9020;&#x4e00;&#x4e2a;&#x5bf9;&#x8c61;&#xff0c;&#x6bcf;&#x4e2a;&#x5bf9;&#x8c61;&#x7684;&#x5143;&#x7d20;&#x90fd;&#x662f;&#x4e00;&#x4e2a;&#x65b9;&#x6cd5;&#xff0c;&#x56e0;&#x4e3a;&#x8fd9;&#x4e2a;&#x5bf9;&#x8c61;&#x662f;&#x8981;&#x6269;&#x5c55;&#x5230;&#x7ec4;&#x4ef6;&#x7684; `computed` &#x8ba1;&#x7b97;&#x5c5e;&#x6027;&#x4e2d;&#x7684;&#x3002;&#x51fd;&#x6570;&#x9996;&#x5148;&#x6267;&#x884c; `normalizeMap` &#x65b9;&#x6cd5;&#xff0c;&#x628a;&#x8fd9;&#x4e2a; `states` &#x53d8;&#x6210;&#x4e00;&#x4e2a;&#x6570;&#x7ec4;&#xff0c;&#x6570;&#x7ec4;&#x7684;&#x6bcf;&#x4e2a;&#x5143;&#x7d20;&#x90fd;&#x662f; `{key, val}` &#x7684;&#x5f62;&#x5f0f;&#x3002;&#x63a5;&#x7740;&#x518d;&#x904d;&#x5386;&#x8fd9;&#x4e2a;&#x6570;&#x7ec4;&#xff0c;&#x4ee5; `key` &#x4f5c;&#x4e3a;&#x5bf9;&#x8c61;&#x7684; `key`&#xff0c;&#x503c;&#x4e3a;&#x4e00;&#x4e2a; `mappedState` &#x7684;&#x51fd;&#x6570;&#xff0c;&#x5728;&#x8fd9;&#x4e2a;&#x51fd;&#x6570;&#x7684;&#x5185;&#x90e8;&#xff0c;&#x83b7;&#x53d6;&#x5230; `&#x24;store.getters` &#x548c; `&#x24;store.state`&#xff0c;&#x7136;&#x540e;&#x518d;&#x5224;&#x65ad;&#x6570;&#x7ec4;&#x7684; `val` &#x5982;&#x679c;&#x662f;&#x4e00;&#x4e2a;&#x51fd;&#x6570;&#xff0c;&#x6267;&#x884c;&#x8be5;&#x51fd;&#x6570;&#xff0c;&#x4f20;&#x5165; `state` &#x548c; `getters`&#xff0c;&#x5426;&#x5219;&#x76f4;&#x63a5;&#x8bbf;&#x95ee; `state[val]`&#x3002;\n\n&#x6bd4;&#x8d77;&#x4e00;&#x4e2a;&#x4e2a;&#x624b;&#x52a8;&#x58f0;&#x660e;&#x8ba1;&#x7b97;&#x5c5e;&#x6027;&#xff0c;`mapState` &#x786e;&#x5b9e;&#x8981;&#x65b9;&#x4fbf;&#x8bb8;&#x591a;&#xff0c;&#x4e0b;&#x9762;&#x6211;&#x4eec;&#x6765;&#x770b;&#x4e00;&#x4e0b; `namespace` &#x7684;&#x4f5c;&#x7528;&#x3002;\n\n&#x5f53;&#x6211;&#x4eec;&#x60f3;&#x8bbf;&#x95ee;&#x4e00;&#x4e2a;&#x5b50;&#x6a21;&#x5757;&#x7684; `state` &#x7684;&#x65f6;&#x5019;&#xff0c;&#x6211;&#x4eec;&#x53ef;&#x80fd;&#x9700;&#x8981;&#x8fd9;&#x6837;&#x8bbf;&#x95ee;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"375,384"}},{"content":"<pre data-lines=\"385,393\"><code data-lines=\"385,393\">computed: {\n  mapState({\n    a: <span class=\"hljs-keyword\">state</span> =&gt; <span class=\"hljs-keyword\">state</span>.some.nested.module.a,\n    b: <span class=\"hljs-keyword\">state</span> =&gt; <span class=\"hljs-keyword\">state</span>.some.nested.module.b\n  })\n}, \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"385,393"}},{"content":"<pre data-lines=\"394,395\"><code>&#x8fd9;&#x6837;&#x4ece;&#x5199;&#x6cd5;&#x4e0a;&#x5c31;&#x5f88;&#x4e0d;&#x53cb;&#x597d;&#xff0c;`mapState` &#x652f;&#x6301;&#x4f20;&#x5165; `namespace`&#xff0c; &#x56e0;&#x6b64;&#x6211;&#x4eec;&#x53ef;&#x4ee5;&#x8fd9;&#x4e48;&#x5199;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"394,395"}},{"content":"<pre data-lines=\"396,404\"><code data-lines=\"396,404\">computed: {\n  mapState(&apos;some/nested/module&apos;, {\n    a: <span class=\"hljs-keyword\">state</span> =&gt; <span class=\"hljs-keyword\">state</span>.a,\n    b: <span class=\"hljs-keyword\">state</span> =&gt; <span class=\"hljs-keyword\">state</span>.b\n  })\n}, \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"396,404"}},{"content":"<pre data-lines=\"405,406\"><code>&#x8fd9;&#x6837;&#x770b;&#x8d77;&#x6765;&#x5c31;&#x6e05;&#x723d;&#x8bb8;&#x591a;&#x3002;&#x5728; `mapState` &#x7684;&#x5b9e;&#x73b0;&#x4e2d;&#xff0c;&#x5982;&#x679c;&#x6709; `namespace`&#xff0c;&#x5219;&#x5c1d;&#x8bd5;&#x53bb;&#x901a;&#x8fc7; `getModuleByNamespace(this.&#x24;store, &apos;mapState&apos;, namespace)` &#x5bf9;&#x5e94;&#x7684; `module`&#xff0c;&#x7136;&#x540e;&#x628a; `state` &#x548c; `getters` &#x4fee;&#x6539;&#x4e3a; `module` &#x5bf9;&#x5e94;&#x7684; `state` &#x548c; `getters`&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"405,406"}},{"content":"<pre data-lines=\"407,416\"><code data-lines=\"407,416\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">getModuleByNamespace</span> (<span class=\"hljs-params\">store, helper, namespace</span>) {\n  <span class=\"hljs-keyword\">const</span> <span class=\"hljs-variable language_\">module</span> = store.<span class=\"hljs-property\">_modulesNamespaceMap</span>[namespace]\n  <span class=\"hljs-keyword\">if</span> (process.<span class=\"hljs-property\">env</span>.<span class=\"hljs-property\">NODE_ENV</span> !== <span class=\"hljs-string\">&apos;production&apos;</span> &amp;&amp; !<span class=\"hljs-variable language_\">module</span>) {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">error</span>(<span class=\"hljs-string\">`[vuex] module namespace not found in <span class=\"hljs-subst\">&#x24;{helper}</span>(): <span class=\"hljs-subst\">&#x24;{namespace}</span>`</span>)\n  }\n  <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable language_\">module</span>\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"407,416"}},{"content":"<pre data-lines=\"417,418\"><code>&#x6211;&#x4eec;&#x5728; Vuex &#x521d;&#x59cb;&#x5316;&#x6267;&#x884c; `installModule` &#x7684;&#x8fc7;&#x7a0b;&#x4e2d;&#xff0c;&#x521d;&#x59cb;&#x5316;&#x4e86;&#x8fd9;&#x4e2a;&#x6620;&#x5c04;&#x8868;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"417,418"}},{"content":"<pre data-lines=\"419,432\"><code data-lines=\"419,432\"><span class=\"hljs-function\">function <span class=\"hljs-title\">installModule</span> <span class=\"hljs-params\">(store, rootState, path, <span class=\"hljs-keyword\">module</span>, hot)</span> </span>{\n  <span class=\"hljs-comment\">// ...</span>\n  <span class=\"hljs-type\">const</span> <span class=\"hljs-keyword\">namespace</span> = store._modules.<span class=\"hljs-built_in\">getNamespace</span>(path)\n\n  <span class=\"hljs-comment\">// register in namespace map</span>\n  <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-keyword\">module</span>.namespaced) {\n    store._modulesNamespaceMap[<span class=\"hljs-keyword\">namespace</span>] = <span class=\"hljs-keyword\">module</span>\n  }\n\n  <span class=\"hljs-comment\">// ...</span>\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"419,432"}}],"payload":{"tag":"h3","lines":"304,305"}},{"content":"<a href=\"#mapgetters\">#</a> <code>mapGetters</code>","children":[{"content":"<pre data-lines=\"435,436\"><code>&#x6211;&#x4eec;&#x5148;&#x6765;&#x770b;&#x4e00;&#x4e0b; `mapGetters` &#x7684;&#x7528;&#x6cd5;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"435,436"}},{"content":"<pre data-lines=\"437,452\"><code data-lines=\"437,452\"><span class=\"hljs-keyword\">import</span> { mapGetters } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&apos;vuex&apos;</span>\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">default</span> {\n  <span class=\"hljs-comment\">// ...</span>\n  <span class=\"hljs-attr\">computed</span>: {\n    <span class=\"hljs-comment\">// &#x4f7f;&#x7528;&#x5bf9;&#x8c61;&#x5c55;&#x5f00;&#x8fd0;&#x7b97;&#x7b26;&#x5c06; getter &#x6df7;&#x5165; computed &#x5bf9;&#x8c61;&#x4e2d;</span>\n    <span class=\"hljs-title function_\">mapGetters</span>([\n      <span class=\"hljs-string\">&apos;doneTodosCount&apos;</span>,\n      <span class=\"hljs-string\">&apos;anotherGetter&apos;</span>,\n      <span class=\"hljs-comment\">// ...</span>\n    ])\n  }\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"437,452"}},{"content":"<pre data-lines=\"453,454\"><code>&#x548c; `mapState` &#x7c7b;&#x4f3c;&#xff0c;`mapGetters` &#x662f;&#x5c06; `store` &#x4e2d;&#x7684; `getter` &#x6620;&#x5c04;&#x5230;&#x5c40;&#x90e8;&#x8ba1;&#x7b97;&#x5c5e;&#x6027;&#xff0c;&#x6765;&#x770b;&#x4e00;&#x4e0b;&#x5b83;&#x7684;&#x5b9a;&#x4e49;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"453,454"}},{"content":"<pre data-lines=\"455,477\"><code data-lines=\"455,477\">export <span class=\"hljs-keyword\">const</span> mapGetters = normalizeNamespace((namespace, getters) =&gt; {\n  <span class=\"hljs-keyword\">const</span> res = {}\n  normalizeMap(getters).forEach(({ key, <span class=\"hljs-keyword\">val</span> }) =&gt; {\n    <span class=\"hljs-comment\">// thie namespace has been mutate by normalizeNamespace</span>\n    <span class=\"hljs-keyword\">val</span> = namespace + <span class=\"hljs-keyword\">val</span>\n    res[key] = function mappedGetter () {\n      <span class=\"hljs-keyword\">if</span> (namespace &amp;&amp; !getModuleByNamespace(<span class=\"hljs-keyword\">this</span>.&#x24;store, <span class=\"hljs-string\">&apos;mapGetters&apos;</span>, namespace)) {\n        <span class=\"hljs-keyword\">return</span>\n      }\n      <span class=\"hljs-keyword\">if</span> (process.env.NODE_ENV !== <span class=\"hljs-string\">&apos;production&apos;</span> &amp;&amp; !(<span class=\"hljs-keyword\">val</span> <span class=\"hljs-keyword\">in</span> <span class=\"hljs-keyword\">this</span>.&#x24;store.getters)) {\n        console.error(`[vuex] unknown getter: &#x24;{<span class=\"hljs-keyword\">val</span>}`)\n        <span class=\"hljs-keyword\">return</span>\n      }\n      <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">this</span>.&#x24;store.getters[<span class=\"hljs-keyword\">val</span>]\n    }\n    <span class=\"hljs-comment\">// mark vuex getter for devtools</span>\n    res[key].vuex = <span class=\"hljs-literal\">true</span>\n  })\n  <span class=\"hljs-keyword\">return</span> res\n}) \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"455,477"}},{"content":"<pre data-lines=\"478,479\"><code>`mapGetters` &#x4e5f;&#x540c;&#x6837;&#x652f;&#x6301; `namespace`&#xff0c;&#x5982;&#x679c;&#x4e0d;&#x5199; `namespace` &#xff0c;&#x8bbf;&#x95ee;&#x4e00;&#x4e2a;&#x5b50; `module` &#x7684;&#x5c5e;&#x6027;&#x9700;&#x8981;&#x5199;&#x5f88;&#x957f;&#x7684; `key`&#xff0c;&#x4e00;&#x65e6;&#x6211;&#x4eec;&#x4f7f;&#x7528;&#x4e86; `namespace`&#xff0c;&#x5c31;&#x53ef;&#x4ee5;&#x65b9;&#x4fbf;&#x6211;&#x4eec;&#x7684;&#x4e66;&#x5199;&#xff0c;&#x6bcf;&#x4e2a; `mappedGetter` &#x7684;&#x5b9e;&#x73b0;&#x5b9e;&#x9645;&#x4e0a;&#x5c31;&#x662f;&#x53d6; `this.&#x24;store.getters[val]`&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"478,479"}}],"payload":{"tag":"h3","lines":"433,434"}},{"content":"<a href=\"#mapmutations\">#</a> <code>mapMutations</code>","children":[{"content":"<pre data-lines=\"482,485\"><code>&#x6211;&#x4eec;&#x53ef;&#x4ee5;&#x5728;&#x7ec4;&#x4ef6;&#x4e2d;&#x4f7f;&#x7528; `this.&#x24;store.commit(&apos;xxx&apos;)` &#x63d0;&#x4ea4; `mutation`&#xff0c;&#x6216;&#x8005;&#x4f7f;&#x7528; `mapMutations` &#x8f85;&#x52a9;&#x51fd;&#x6570;&#x5c06;&#x7ec4;&#x4ef6;&#x4e2d;&#x7684; `methods` &#x6620;&#x5c04;&#x4e3a; `store.commit` &#x7684;&#x8c03;&#x7528;&#x3002;\n\n&#x6211;&#x4eec;&#x5148;&#x6765;&#x770b;&#x4e00;&#x4e0b; `mapMutations` &#x7684;&#x7528;&#x6cd5;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"482,485"}},{"content":"<pre data-lines=\"486,504\"><code data-lines=\"486,504\"><span class=\"hljs-keyword\">import</span> { mapMutations } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&apos;vuex&apos;</span>\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">default</span> {\n  <span class=\"hljs-regexp\">//</span> ...\n  methods: {\n    ...mapMutations([\n      <span class=\"hljs-string\">&apos;increment&apos;</span>, <span class=\"hljs-regexp\">//</span> &#x5c06; `<span class=\"language-javascript\"><span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-title function_\">increment</span>()</span>` &#x6620;&#x5c04;&#x4e3a; `<span class=\"language-javascript\"><span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">&#x24;store</span>.<span class=\"hljs-title function_\">commit</span>(<span class=\"hljs-string\">&apos;increment&apos;</span>)</span>`\n\n      <span class=\"hljs-regexp\">//</span> `<span class=\"language-javascript\">mapMutations</span>` &#x4e5f;&#x652f;&#x6301;&#x8f7d;&#x8377;&#xff1a;\n      <span class=\"hljs-string\">&apos;incrementBy&apos;</span> <span class=\"hljs-regexp\">//</span> &#x5c06; `<span class=\"language-javascript\"><span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-title function_\">incrementBy</span>(amount)</span>` &#x6620;&#x5c04;&#x4e3a; `<span class=\"language-javascript\"><span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">&#x24;store</span>.<span class=\"hljs-title function_\">commit</span>(<span class=\"hljs-string\">&apos;incrementBy&apos;</span>, amount)</span>`\n    ]),\n    ...mapMutations({\n      add: <span class=\"hljs-string\">&apos;increment&apos;</span> <span class=\"hljs-regexp\">//</span> &#x5c06; `<span class=\"language-javascript\"><span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-title function_\">add</span>()</span>` &#x6620;&#x5c04;&#x4e3a; `<span class=\"language-javascript\"><span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">&#x24;store</span>.<span class=\"hljs-title function_\">commit</span>(<span class=\"hljs-string\">&apos;increment&apos;</span>)</span>`\n    })\n  }\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"486,504"}},{"content":"<pre data-lines=\"505,506\"><code>`mapMutations` &#x652f;&#x6301;&#x4f20;&#x5165;&#x4e00;&#x4e2a;&#x6570;&#x7ec4;&#x6216;&#x8005;&#x4e00;&#x4e2a;&#x5bf9;&#x8c61;&#xff0c;&#x76ee;&#x6807;&#x90fd;&#x662f;&#x7ec4;&#x4ef6;&#x4e2d;&#x5bf9;&#x5e94;&#x7684; `methods` &#x6620;&#x5c04;&#x4e3a; `store.commit` &#x7684;&#x8c03;&#x7528;&#x3002;&#x6765;&#x770b;&#x4e00;&#x4e0b;&#x5b83;&#x7684;&#x5b9a;&#x4e49;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"505,506"}},{"content":"<pre data-lines=\"507,529\"><code data-lines=\"507,529\">export <span class=\"hljs-keyword\">const</span> mapMutations = normalizeNamespace((<span class=\"hljs-keyword\">namespace</span>, mutations) =&gt; {\n  <span class=\"hljs-keyword\">const</span> res = {}\n  normalizeMap(mutations).forEach(({ key, val }) =&gt; {\n    res[key] = <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">mappedMutation</span> <span class=\"hljs-params\">(<span class=\"hljs-rest_arg\">...args</span>)</span> {\n      <span class=\"hljs-comment\">// Get the commit method from store</span>\n      let commit = <span class=\"hljs-keyword\">this</span>.&#x24;store.commit\n      <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-keyword\">namespace</span>) {\n        <span class=\"hljs-keyword\">const</span> module = getModuleByNamespace(<span class=\"hljs-keyword\">this</span>.&#x24;store, <span class=\"hljs-string\">&apos;mapMutations&apos;</span>, <span class=\"hljs-keyword\">namespace</span>)\n        <span class=\"hljs-keyword\">if</span> (!module) {\n          <span class=\"hljs-keyword\">return</span>\n        }\n        commit = module.context.commit\n      }\n      <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">typeof</span> val === <span class=\"hljs-string\">&apos;function&apos;</span>\n        ? val.apply(<span class=\"hljs-keyword\">this</span>, [commit].concat(args))\n        : commit.apply(<span class=\"hljs-keyword\">this</span>.&#x24;store, [val].concat(args))\n    }\n  })\n  <span class=\"hljs-keyword\">return</span> res\n}) \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"507,529"}},{"content":"<pre data-lines=\"530,531\"><code>&#x53ef;&#x4ee5;&#x770b;&#x5230; `mappedMutation` &#x540c;&#x6837;&#x652f;&#x6301;&#x4e86; `namespace`&#xff0c;&#x5e76;&#x4e14;&#x652f;&#x6301;&#x4e86;&#x4f20;&#x5165;&#x989d;&#x5916;&#x7684;&#x53c2;&#x6570; `args`&#xff0c;&#x4f5c;&#x4e3a;&#x63d0;&#x4ea4; `mutation` &#x7684; `payload`&#xff0c;&#x6700;&#x7ec8;&#x5c31;&#x662f;&#x6267;&#x884c;&#x4e86; `store.commit` &#x65b9;&#x6cd5;&#xff0c;&#x5e76;&#x4e14;&#x8fd9;&#x4e2a; `commit` &#x4f1a;&#x6839;&#x636e;&#x4f20;&#x5165;&#x7684; `namespace` &#x6620;&#x5c04;&#x5230;&#x5bf9;&#x5e94; `module` &#x7684; `commit` &#x4e0a;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"530,531"}}],"payload":{"tag":"h3","lines":"480,481"}},{"content":"<a href=\"#mapactions\">#</a> <code>mapActions</code>","children":[{"content":"<pre data-lines=\"534,537\"><code>&#x6211;&#x4eec;&#x53ef;&#x4ee5;&#x5728;&#x7ec4;&#x4ef6;&#x4e2d;&#x4f7f;&#x7528; `this.&#x24;store.dispatch(&apos;xxx&apos;)` &#x63d0;&#x4ea4; `action`&#xff0c;&#x6216;&#x8005;&#x4f7f;&#x7528; `mapActions` &#x8f85;&#x52a9;&#x51fd;&#x6570;&#x5c06;&#x7ec4;&#x4ef6;&#x4e2d;&#x7684; `methods` &#x6620;&#x5c04;&#x4e3a; `store.dispatch` &#x7684;&#x8c03;&#x7528;&#x3002;\n\n`mapActions` &#x5728;&#x7528;&#x6cd5;&#x4e0a;&#x548c; `mapMutations` &#x51e0;&#x4e4e;&#x4e00;&#x6837;&#xff0c;&#x5b9e;&#x73b0;&#x4e5f;&#x5f88;&#x7c7b;&#x4f3c;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"534,537"}},{"content":"<pre data-lines=\"538,560\"><code data-lines=\"538,560\">export <span class=\"hljs-keyword\">const</span> mapActions = normalizeNamespace((<span class=\"hljs-keyword\">namespace</span>, actions) =&gt; {\n  <span class=\"hljs-keyword\">const</span> res = {}\n  normalizeMap(actions).forEach(({ key, val }) =&gt; {\n    res[key] = <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">mappedAction</span> <span class=\"hljs-params\">(<span class=\"hljs-rest_arg\">...args</span>)</span> {\n      <span class=\"hljs-comment\">// get dispatch function from store</span>\n      let dispatch = <span class=\"hljs-keyword\">this</span>.&#x24;store.dispatch\n      <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-keyword\">namespace</span>) {\n        <span class=\"hljs-keyword\">const</span> module = getModuleByNamespace(<span class=\"hljs-keyword\">this</span>.&#x24;store, <span class=\"hljs-string\">&apos;mapActions&apos;</span>, <span class=\"hljs-keyword\">namespace</span>)\n        <span class=\"hljs-keyword\">if</span> (!module) {\n          <span class=\"hljs-keyword\">return</span>\n        }\n        dispatch = module.context.dispatch\n      }\n      <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">typeof</span> val === <span class=\"hljs-string\">&apos;function&apos;</span>\n        ? val.apply(<span class=\"hljs-keyword\">this</span>, [dispatch].concat(args))\n        : dispatch.apply(<span class=\"hljs-keyword\">this</span>.&#x24;store, [val].concat(args))\n    }\n  })\n  <span class=\"hljs-keyword\">return</span> res\n}) \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"538,560"}},{"content":"<pre data-lines=\"561,562\"><code>&#x548c; `mapMutations` &#x7684;&#x5b9e;&#x73b0;&#x51e0;&#x4e4e;&#x4e00;&#x6837;&#xff0c;&#x4e0d;&#x540c;&#x7684;&#x662f;&#x628a; `commit` &#x65b9;&#x6cd5;&#x6362;&#x6210;&#x4e86; `dispatch`&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"561,562"}}],"payload":{"tag":"h3","lines":"532,533"}}],"payload":{"tag":"h2","lines":"282,284"}},{"content":"<a href=\"#%E5%8A%A8%E6%80%81%E6%9B%B4%E6%96%B0%E6%A8%A1%E5%9D%97\">#</a> &#x52a8;&#x6001;&#x66f4;&#x65b0;&#x6a21;&#x5757;","children":[{"content":"<pre data-lines=\"566,567\"><code>&#x5728; Vuex &#x521d;&#x59cb;&#x5316;&#x9636;&#x6bb5;&#x6211;&#x4eec;&#x6784;&#x9020;&#x4e86;&#x6a21;&#x5757;&#x6811;&#xff0c;&#x521d;&#x59cb;&#x5316;&#x4e86;&#x6a21;&#x5757;&#x4e0a;&#x5404;&#x4e2a;&#x90e8;&#x5206;&#x3002;&#x5728;&#x6709;&#x4e00;&#x4e9b;&#x573a;&#x666f;&#x4e0b;&#xff0c;&#x6211;&#x4eec;&#x9700;&#x8981;&#x52a8;&#x6001;&#x53bb;&#x6ce8;&#x5165;&#x4e00;&#x4e9b;&#x65b0;&#x7684;&#x6a21;&#x5757;&#xff0c;Vuex &#x63d0;&#x4f9b;&#x4e86;&#x6a21;&#x5757;&#x52a8;&#x6001;&#x6ce8;&#x518c;&#x529f;&#x80fd;&#xff0c;&#x5728; `store` &#x4e0a;&#x63d0;&#x4f9b;&#x4e86;&#x4e00;&#x4e2a; `registerModule` &#x7684; API&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"566,567"}},{"content":"<pre data-lines=\"568,583\"><code data-lines=\"568,583\">registerModule (path, rawModule, options = {}) {\n  <span class=\"hljs-keyword\">if</span> (typeof path === <span class=\"hljs-string\">&apos;string&apos;</span>) path = [path]\n\n  <span class=\"hljs-keyword\">if</span> (process.env.NODE_ENV !== <span class=\"hljs-string\">&apos;production&apos;</span>) {\n    assert(Array.isArray(path), `module path must be a string or an Array.`)\n    assert(path.length &gt; <span class=\"hljs-number\">0</span>, <span class=\"hljs-string\">&apos;cannot register the root module by using registerModule.&apos;</span>)\n  }\n\n  <span class=\"hljs-keyword\">this</span>._modules.register(path, rawModule)\n  installModule(<span class=\"hljs-keyword\">this</span>, <span class=\"hljs-keyword\">this</span>.state, path, <span class=\"hljs-keyword\">this</span>._modules.<span class=\"hljs-keyword\">get</span>(path), options.preserveState)\n  <span class=\"hljs-comment\">// reset store to update getters...</span>\n  resetStoreVM(<span class=\"hljs-keyword\">this</span>, <span class=\"hljs-keyword\">this</span>.state)\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"568,583"}},{"content":"<pre data-lines=\"584,587\"><code>`registerModule` &#x652f;&#x6301;&#x4f20;&#x5165;&#x4e00;&#x4e2a; `path` &#x6a21;&#x5757;&#x8def;&#x5f84; &#x548c; `rawModule` &#x6a21;&#x5757;&#x5b9a;&#x4e49;&#xff0c;&#x9996;&#x5148;&#x6267;&#x884c; `register` &#x65b9;&#x6cd5;&#x6269;&#x5c55;&#x6211;&#x4eec;&#x7684;&#x6a21;&#x5757;&#x6811;&#xff0c;&#x63a5;&#x7740;&#x6267;&#x884c; `installModule` &#x53bb;&#x5b89;&#x88c5;&#x6a21;&#x5757;&#xff0c;&#x6700;&#x540e;&#x6267;&#x884c; `resetStoreVM` &#x91cd;&#x65b0;&#x5b9e;&#x4f8b;&#x5316; `store._vm`&#xff0c;&#x5e76;&#x9500;&#x6bc1;&#x65e7;&#x7684; `store._vm`&#x3002;\n\n&#x76f8;&#x5bf9;&#x7684;&#xff0c;&#x6709;&#x52a8;&#x6001;&#x6ce8;&#x518c;&#x6a21;&#x5757;&#x7684;&#x9700;&#x6c42;&#x5c31;&#x6709;&#x52a8;&#x6001;&#x5378;&#x8f7d;&#x6a21;&#x5757;&#x7684;&#x9700;&#x6c42;&#xff0c;Vuex &#x63d0;&#x4f9b;&#x4e86;&#x6a21;&#x5757;&#x52a8;&#x6001;&#x5378;&#x8f7d;&#x529f;&#x80fd;&#xff0c;&#x5728; `store` &#x4e0a;&#x63d0;&#x4f9b;&#x4e86;&#x4e00;&#x4e2a; `unregisterModule` &#x7684; API&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"584,587"}},{"content":"<pre data-lines=\"588,604\"><code data-lines=\"588,604\">unregisterModule (<span class=\"hljs-type\">path</span>) {\n  <span class=\"hljs-keyword\">if</span> (typeof <span class=\"hljs-type\">path</span> === <span class=\"hljs-string\">&apos;string&apos;</span>) <span class=\"hljs-type\">path</span> = [<span class=\"hljs-type\">path</span>]\n\n  <span class=\"hljs-keyword\">if</span> (process.env.NODE_ENV !== <span class=\"hljs-string\">&apos;production&apos;</span>) {\n    <span class=\"hljs-keyword\">assert</span>(<span class=\"hljs-keyword\">Array</span>.isArray(<span class=\"hljs-type\">path</span>), `module <span class=\"hljs-type\">path</span> must be a string <span class=\"hljs-keyword\">or</span> an <span class=\"hljs-keyword\">Array</span>.`)\n  }\n\n  this._modules.unregister(<span class=\"hljs-type\">path</span>)\n  this._withCommit(() =&gt; {\n    const parentState = getNestedState(this.state, <span class=\"hljs-type\">path</span>.<span class=\"hljs-keyword\">slice</span>(<span class=\"hljs-number\">0</span>, <span class=\"hljs-number\">-1</span>))\n    Vue.<span class=\"hljs-keyword\">delete</span>(parentState, <span class=\"hljs-type\">path</span>[<span class=\"hljs-type\">path</span>.length - <span class=\"hljs-number\">1</span>])\n  })\n  resetStore(this)\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"588,604"}},{"content":"<pre data-lines=\"605,606\"><code>`unregisterModule` &#x652f;&#x6301;&#x4f20;&#x5165;&#x4e00;&#x4e2a; `path` &#x6a21;&#x5757;&#x8def;&#x5f84;&#xff0c;&#x9996;&#x5148;&#x6267;&#x884c; `unregister` &#x65b9;&#x6cd5;&#x53bb;&#x4fee;&#x526a;&#x6211;&#x4eec;&#x7684;&#x6a21;&#x5757;&#x6811;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"605,606"}},{"content":"<pre data-lines=\"607,616\"><code data-lines=\"607,616\">unregister <span class=\"hljs-built_in\">(path</span>) {\n  const parent = this.get<span class=\"hljs-built_in\">(path</span>.slice(<span class=\"hljs-number\">0</span>, -<span class=\"hljs-number\">1</span>))\n  const<span class=\"hljs-built_in\"> key</span> =<span class=\"hljs-built_in\"> path</span><span class=\"hljs-built_in\">[path</span>.length - <span class=\"hljs-number\">1</span>]\n  <span class=\"hljs-keyword\">if</span> (!parent.getChild<span class=\"hljs-built_in\">(key</span>).runtime) <span class=\"hljs-keyword\">return</span>\n\n  parent.removeChild<span class=\"hljs-built_in\">(key</span>)\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"607,616"}},{"content":"<pre data-lines=\"617,620\"><code>&#x6ce8;&#x610f;&#xff0c;&#x8fd9;&#x91cc;&#x53ea;&#x4f1a;&#x79fb;&#x9664;&#x6211;&#x4eec;&#x8fd0;&#x884c;&#x65f6;&#x52a8;&#x6001;&#x521b;&#x5efa;&#x7684;&#x6a21;&#x5757;&#x3002;\n\n&#x63a5;&#x7740;&#x4f1a;&#x5220;&#x9664; `state` &#x5728;&#x8be5;&#x8def;&#x5f84;&#x4e0b;&#x7684;&#x5f15;&#x7528;&#xff0c;&#x6700;&#x540e;&#x6267;&#x884c; `resetStore` &#x65b9;&#x6cd5;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"617,620"}},{"content":"<pre data-lines=\"621,634\"><code data-lines=\"621,634\">function resetStore (store, hot) {\n  store._actions = Object.create(null)\n  store._mutations = Object.create(null)\n  store._wrappedGetters = Object.create(null)\n  store._modulesNamespaceMap = Object.create(null)\n  <span class=\"hljs-keyword\">const</span> <span class=\"hljs-keyword\">state</span> = store.<span class=\"hljs-keyword\">state</span>\n  // init <span class=\"hljs-literal\">all</span> modules\n  installModule(store, <span class=\"hljs-keyword\">state</span>, [], store._modules.root, true)\n  // reset vm\n  resetStoreVM(store, <span class=\"hljs-keyword\">state</span>, hot)\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"621,634"}},{"content":"<pre data-lines=\"635,636\"><code>&#x8be5;&#x65b9;&#x6cd5;&#x5c31;&#x662f;&#x628a; `store` &#x4e0b;&#x7684;&#x5bf9;&#x5e94;&#x5b58;&#x50a8;&#x7684; `_actions`&#x3001;`_mutations`&#x3001;`_wrappedGetters` &#x548c; `_modulesNamespaceMap` &#x90fd;&#x6e05;&#x7a7a;&#xff0c;&#x7136;&#x540e;&#x91cd;&#x65b0;&#x6267;&#x884c; `installModule` &#x5b89;&#x88c5;&#x6240;&#x6709;&#x6a21;&#x5757;&#x4ee5;&#x53ca; `resetStoreVM` &#x91cd;&#x7f6e; `store._vm`&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"635,636"}}],"payload":{"tag":"h2","lines":"563,565"}},{"content":"<a href=\"#%E6%80%BB%E7%BB%93\">#</a> &#x603b;&#x7ed3;","children":[{"content":"<pre data-lines=\"640,641\"><code>&#x90a3;&#x4e48;&#x81f3;&#x6b64;&#xff0c;Vuex &#x63d0;&#x4f9b;&#x7684;&#x4e00;&#x4e9b;&#x5e38;&#x7528; API &#x6211;&#x4eec;&#x5c31;&#x5206;&#x6790;&#x5b8c;&#x4e86;&#xff0c;&#x5305;&#x62ec;&#x6570;&#x636e;&#x7684;&#x5b58;&#x53d6;&#x3001;&#x8bed;&#x6cd5;&#x7cd6;&#x3001;&#x6a21;&#x5757;&#x7684;&#x52a8;&#x6001;&#x66f4;&#x65b0;&#x7b49;&#x3002;&#x8981;&#x7406;&#x89e3; Vuex &#x63d0;&#x4f9b;&#x8fd9;&#x4e9b; API &#x90fd;&#x662f;&#x65b9;&#x4fbf;&#x6211;&#x4eec;&#x5728;&#x5bf9; `store` &#x505a;&#x5404;&#x79cd;&#x64cd;&#x4f5c;&#x6765;&#x5b8c;&#x6210;&#x5404;&#x79cd;&#x80fd;&#x529b;&#xff0c;&#x5c24;&#x5176;&#x662f; `mapXXX` &#x7684;&#x8bbe;&#x8ba1;&#xff0c;&#x8ba9;&#x6211;&#x4eec;&#x5728;&#x4f7f;&#x7528; API &#x7684;&#x65f6;&#x5019;&#x66f4;&#x52a0;&#x65b9;&#x4fbf;&#xff0c;&#x8fd9;&#x4e5f;&#x662f;&#x6211;&#x4eec;&#x4eca;&#x540e;&#x5728;&#x8bbe;&#x8ba1;&#x4e00;&#x4e9b; JavaScript &#x5e93;&#x7684;&#x65f6;&#x5019;&#xff0c;&#x4ece; API &#x8bbe;&#x8ba1;&#x89d2;&#x5ea6;&#x4e2d;&#x5e94;&#x8be5;&#x5b66;&#x4e60;&#x7684;&#x65b9;&#x5411;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"640,641"}}],"payload":{"tag":"h2","lines":"637,639"}}],"payload":{"tag":"h1","lines":"0,2"}},{})</script>
</body>
</html>
