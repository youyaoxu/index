<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets@11.11.1/styles/default.min.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.18.10/dist/browser/index.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/index.js"></script><script>(r => {
              setTimeout(r);
            })(function renderToolbar() {
  const {
    markmap,
    mm
  } = window;
  const {
    el
  } = markmap.Toolbar.create(mm);
  el.setAttribute('style', 'position:absolute;bottom:20px;right:20px');
  document.body.append(el);
})</script><script>((getMarkmap, getOptions, root2, jsonOptions) => {
              const markmap = getMarkmap();
              window.mm = markmap.Markmap.create(
                "svg#mindmap",
                (getOptions || markmap.deriveOptions)(jsonOptions),
                root2
              );
            })(() => window.markmap,null,{"content":"","children":[{"content":"Day03&#x56de;&#x987e;","children":[{"content":"&#x8bf7;&#x6c42;&#x6a21;&#x5757;&#x603b;&#x7ed3;","children":[{"content":"requests&#x6a21;&#x5757;&#x4f7f;&#x7528;&#x6d41;&#x7a0b;","children":[{"content":"<pre data-lines=\"6,24\"><code class=\"language-python\"><span class=\"hljs-comment\"># &#x7f16;&#x7801;+&#x62fc;&#x63a5;URL&#x5730;&#x5740;</span>\nurl = <span class=\"hljs-string\">&apos;http://www.baidu.com/s?&apos;</span>\nparams = {\n    <span class=\"hljs-string\">&apos;&apos;</span>:<span class=\"hljs-string\">&apos;&apos;</span>,\n    <span class=\"hljs-string\">&apos;&apos;</span>:<span class=\"hljs-string\">&apos;&apos;</span>\n}\nparams = urllib.parse.urlencode(params)\nurl = baseurl + params\n\n<span class=\"hljs-comment\"># &#x8bf7;&#x6c42;</span>\nhtml = requests.get(url=url,headers=headers).text\nhtml = requests.get(url=url,headers=headers).content.decode(<span class=\"hljs-string\">&apos;gb2312&apos;</span>,<span class=\"hljs-string\">&apos;ignore&apos;</span>)\n\n&#x3010;&#x4ee3;&#x7801;&#x4e2d;&#x9047;&#x5230;&#x5982;&#x4e0b;&#x95ee;&#x9898;,&#x8003;&#x8651;decode()&#x95ee;&#x9898;&#x3011;\n    <span class=\"hljs-number\">1</span>) &#x4e71;&#x7801;\n    <span class=\"hljs-number\">2</span>) decode error: utf-<span class=\"hljs-number\">8</span> code can <span class=\"hljs-keyword\">not</span> character \\xxx .... ....\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"6,24"}}],"payload":{"tag":"h3","lines":"4,5"}},{"content":"&#x54cd;&#x5e94;&#x5bf9;&#x8c61;res&#x5c5e;&#x6027;","children":[{"content":"<pre data-lines=\"27,33\"><code class=\"language-python\">res.text        : <span class=\"hljs-string\">&apos;&#x5b57;&#x7b26;&#x4e32;&apos;</span>\nres.content     : <span class=\"hljs-string\">&apos;bytes&apos;</span>\nres.status_code : <span class=\"hljs-string\">&apos;HTTP&#x54cd;&#x5e94;&#x7801;&apos;</span>\nres.url         : <span class=\"hljs-string\">&apos;&#x5b9e;&#x9645;&#x6570;&#x636e;URL&#x5730;&#x5740;&apos;</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"27,33"}}],"payload":{"tag":"h3","lines":"25,26"}},{"content":"&#x975e;&#x7ed3;&#x6784;&#x5316;&#x6570;&#x636e;&#x4fdd;&#x5b58;","children":[{"content":"<pre data-lines=\"36,46\"><code class=\"language-python\">&#x3010;<span class=\"hljs-number\">1</span>&#x3011;&#x6587;&#x4ef6;&#x540d; : &#x53ef;&#x4ee5;&#x4f7f;&#x7528;URL&#x5730;&#x5740;&#x8fdb;&#x884c;&#x5207;&#x5272;&#x6216;&#x5207;&#x7247;\n\n&#x3010;<span class=\"hljs-number\">2</span>&#x3011;&#x4fdd;&#x5b58;&#x65f6;&#x4ee5; wb &#x7684;&#x65b9;&#x5f0f;&#x6253;&#x5f00;&#x6587;&#x4ef6;\n\n&#x3010;<span class=\"hljs-number\">3</span>&#x3011;&#x53ef;&#x7528;os&#x6a21;&#x5757;&#x521b;&#x5efa;&#x5e76;&#x6307;&#x5b9a;&#x4fdd;&#x5b58;&#x8def;&#x5f84;\n    <span class=\"hljs-keyword\">import</span> os\n    <span class=\"hljs-keyword\">if</span> <span class=\"hljs-keyword\">not</span> os.path.exists(directory):\n        os.makedirs(directory)\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"36,46"}}],"payload":{"tag":"h3","lines":"34,35"}}],"payload":{"tag":"h2","lines":"2,3"}},{"content":"Chrome&#x6d4f;&#x89c8;&#x5668;&#x5b89;&#x88c5;&#x63d2;&#x4ef6;","children":[{"content":"&#x5b89;&#x88c5;&#x65b9;&#x6cd5;","children":[{"content":"<pre data-lines=\"51,59\"><code class=\"language-python\">&#x3010;<span class=\"hljs-number\">1</span>&#x3011;&#x4ece;&#x7f51;&#x4e0a;&#x4e0b;&#x8f7d;&#x76f8;&#x5173;&#x63d2;&#x4ef6; - xxx.crx &#x91cd;&#x547d;&#x540d;&#x4e3a; xxx.<span class=\"hljs-built_in\">zip</span>\n&#x3010;<span class=\"hljs-number\">2</span>&#x3011;Chrome&#x6d4f;&#x89c8;&#x5668;-&gt;&#x8bbe;&#x7f6e;-&gt;&#x66f4;&#x591a;&#x5de5;&#x5177;-&gt;&#x6269;&#x5c55;&#x7a0b;&#x5e8f;-&gt;&#x5f00;&#x53d1;&#x8005;&#x6a21;&#x5f0f;\n&#x3010;<span class=\"hljs-number\">3</span>&#x3011;&#x62d6;&#x62fd;<span class=\"hljs-built_in\">zip</span>&#x6587;&#x4ef6;(&#x6216;&#x89e3;&#x538b;&#x540e;&#x7684;&#x6587;&#x4ef6;&#x5939;) &#x5230;&#x6d4f;&#x89c8;&#x5668;&#x9875;&#x9762;\n&#x3010;<span class=\"hljs-number\">4</span>&#x3011;&#x91cd;&#x542f;&#x6d4f;&#x89c8;&#x5668;&#xff0c;&#x4f7f;&#x63d2;&#x4ef6;&#x751f;&#x6548;\n\n&#x3010;&#x6ce8;&#x610f;&#x3011;: &#x5f53;&#x7136;&#x4e5f;&#x53ef;&#x4ee5;&#x4f7f;&#x7528;&#x8c37;&#x6b4c;&#x8bbf;&#x95ee;&#x52a9;&#x624b;&#x5728;&#x7ebf;&#x5b89;&#x88c5;&#x63d2;&#x4ef6;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"51,59"}}],"payload":{"tag":"h3","lines":"49,50"}}],"payload":{"tag":"h2","lines":"47,48"}},{"content":"&#x76ee;&#x524d;&#x53cd;&#x722c;&#x603b;&#x7ed3;","children":[{"content":"&#x53cd;&#x722c;&#x866b;&#x68b3;&#x7406;","children":[{"content":"<pre data-lines=\"64,79\"><code class=\"language-python\">&#x3010;<span class=\"hljs-number\">1</span>&#x3011;&#x57fa;&#x4e8e;User-Agent&#x53cd;&#x722c;\n   <span class=\"hljs-number\">1.1</span>) &#x53d1;&#x9001;&#x8bf7;&#x6c42;&#x643a;&#x5e26;&#x8bf7;&#x6c42;&#x5934;: headers={<span class=\"hljs-string\">&apos;User-Agent&apos;</span> : <span class=\"hljs-string\">&apos;Mozilla/5.0 xxxxxx&apos;</span>}\n   <span class=\"hljs-number\">1.2</span>) &#x591a;&#x4e2a;&#x8bf7;&#x6c42;&#x65f6;&#x968f;&#x673a;&#x5207;&#x6362;User-Agent\n        a) &#x5b9a;&#x4e49;&#x5217;&#x8868;&#x5b58;&#x653e;&#x5927;&#x91cf;User-Agent&#xff0c;&#x4f7f;&#x7528;random.choice()&#x6bcf;&#x6b21;&#x968f;&#x673a;&#x9009;&#x62e9;\n        b) &#x5b9a;&#x4e49;py&#x6587;&#x4ef6;&#x5b58;&#x653e;&#x5927;&#x91cf;User-Agent&#xff0c;&#x5bfc;&#x5165;&#x540e;&#x4f7f;&#x7528;random.choice()&#x6bcf;&#x6b21;&#x968f;&#x673a;&#x9009;&#x62e9;\n        c) &#x4f7f;&#x7528;fake_useragent&#x6a21;&#x5757;&#x6bcf;&#x6b21;&#x8bbf;&#x95ee;&#x968f;&#x673a;&#x751f;&#x6210;User-Agent\n           <span class=\"hljs-keyword\">from</span> fake_useragent <span class=\"hljs-keyword\">import</span> UserAgent\n           agent = UserAgent().random\n        \n&#x3010;<span class=\"hljs-number\">2</span>&#x3011;&#x54cd;&#x5e94;&#x5185;&#x5bb9;&#x4e2d;&#x5d4c;&#x5165;JS&#x53cd;&#x722c;\n   <span class=\"hljs-number\">2.1</span>) &#x73b0;&#x8c61;: html&#x9875;&#x9762;&#x4e2d;&#x4f7f;&#x7528;xpath helper&#x53ef;&#x5339;&#x914d;&#x51fa;&#x5185;&#x5bb9;&#xff0c;&#x4f46;&#x662f;&#x7a0b;&#x5e8f;&#x4e2d;&#x5339;&#x914d;&#x7ed3;&#x679c;&#x4e3a;&#x7a7a;\n   <span class=\"hljs-number\">2.2</span>) &#x539f;&#x56e0;: &#x54cd;&#x5e94;&#x5185;&#x5bb9;&#x4e2d;&#x5d4c;&#x5165;js,&#x6d4f;&#x89c8;&#x5668;&#x81ea;&#x52a8;&#x6267;&#x884c;JS&#x4f1a;&#x8c03;&#x6574;&#x9875;&#x9762;&#x7ed3;&#x6784;\n   <span class=\"hljs-number\">2.3</span>) &#x89e3;&#x51b3;&#x65b9;&#x6848;: &#x5728;&#x7a0b;&#x5e8f;&#x4e2d;&#x6253;&#x5370;&#x54cd;&#x5e94;&#x5185;&#x5bb9;:<span class=\"hljs-built_in\">print</span>(html)&#x6216;&#x8005;&#x5c06;html&#x4fdd;&#x5b58;&#x5230;&#x672c;&#x5730;&#x6587;&#x4ef6;,&#x6839;&#x636e;&#x5b9e;&#x9645;&#x54cd;&#x5e94;&#x5185;&#x5bb9;&#x7ed3;&#x6784;&#x6765;&#x8fdb;&#x4e00;&#x6b65;&#x8c03;&#x6574;xpath&#x6216;&#x8005;&#x6b63;&#x5219;&#x8868;&#x8fbe;&#x5f0f;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"64,79"}}],"payload":{"tag":"h3","lines":"62,63"}}],"payload":{"tag":"h2","lines":"60,61"}},{"content":"requests&#x6a21;&#x5757;&#x53c2;&#x6570;&#x603b;&#x7ed3;","children":[{"content":"<pre data-lines=\"83,90\"><code class=\"language-python\">&#x3010;1&#x3011;&#x65b9;&#x6cd5; : requests.get()\n&#x3010;2&#x3011;&#x53c2;&#x6570;\n   2.1) url\n   2.2) headers\n   2.3) timeout\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"83,90"}}],"payload":{"tag":"h2","lines":"81,82"}},{"content":"&#x89e3;&#x6790;&#x6a21;&#x5757;&#x603b;&#x7ed3;","children":[{"content":"re&#x6b63;&#x5219;&#x89e3;&#x6790;","children":[{"content":"<pre data-lines=\"95,100\"><code class=\"language-python\"><span class=\"hljs-keyword\">import</span> re \npattern = re.<span class=\"hljs-built_in\">compile</span>(<span class=\"hljs-string\">r&apos;&#x6b63;&#x5219;&#x8868;&#x8fbe;&#x5f0f;&apos;</span>,re.S)\nr_list = pattern.findall(html)\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"95,100"}}],"payload":{"tag":"h3","lines":"93,94"}},{"content":"lxml+xpath&#x89e3;&#x6790;","children":[{"content":"<pre data-lines=\"103,110\"><code class=\"language-python\"><span class=\"hljs-keyword\">from</span> lxml <span class=\"hljs-keyword\">import</span> etree\np = etree.HTML(res.text)\nr_list = p.xpath(<span class=\"hljs-string\">&apos;xpath&#x8868;&#x8fbe;&#x5f0f;&apos;</span>)\n\n&#x3010;&#x8c28;&#x8bb0;&#x3011;&#x53ea;&#x8981;&#x8c03;&#x7528;&#x4e86;xpath&#xff0c;&#x5f97;&#x5230;&#x7684;&#x7ed3;&#x679c;&#x4e00;&#x5b9a;&#x4e3a;<span class=\"hljs-string\">&apos;&#x5217;&#x8868;&apos;</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"103,110"}}],"payload":{"tag":"h3","lines":"101,102"}}],"payload":{"tag":"h2","lines":"91,92"}},{"content":"xpath&#x8868;&#x8fbe;&#x5f0f;","children":[{"content":"&#x5339;&#x914d;&#x89c4;&#x5219;","children":[{"content":"<pre data-lines=\"115,122\"><code class=\"language-python\">&#x3010;<span class=\"hljs-number\">1</span>&#x3011;&#x7ed3;&#x679c;: &#x8282;&#x70b9;&#x5bf9;&#x8c61;&#x5217;&#x8868;\n   <span class=\"hljs-number\">1.1</span>) xpath&#x793a;&#x4f8b;: //div&#x3001;//div[@<span class=\"hljs-keyword\">class</span>=<span class=\"hljs-string\">&quot;student&quot;</span>]&#x3001;//div/a[@title=<span class=\"hljs-string\">&quot;stu&quot;</span>]/span\n\n&#x3010;<span class=\"hljs-number\">2</span>&#x3011;&#x7ed3;&#x679c;: &#x5b57;&#x7b26;&#x4e32;&#x5217;&#x8868;\n   <span class=\"hljs-number\">2.1</span>) xpath&#x8868;&#x8fbe;&#x5f0f;&#x4e2d;&#x672b;&#x5c3e;&#x4e3a;: @src&#x3001;@href&#x3001;/text()\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"115,122"}}],"payload":{"tag":"h3","lines":"113,114"}},{"content":"&#x6700;&#x5e38;&#x7528;","children":[{"content":"<pre data-lines=\"125,132\"><code class=\"language-python\">&#x3010;<span class=\"hljs-number\">1</span>&#x3011;&#x57fa;&#x51c6;xpath&#x8868;&#x8fbe;&#x5f0f;: &#x5f97;&#x5230;&#x8282;&#x70b9;&#x5bf9;&#x8c61;&#x5217;&#x8868;\n&#x3010;<span class=\"hljs-number\">2</span>&#x3011;<span class=\"hljs-keyword\">for</span> r <span class=\"hljs-keyword\">in</span> [&#x8282;&#x70b9;&#x5bf9;&#x8c61;&#x5217;&#x8868;]:\n       username = r.xpath(<span class=\"hljs-string\">&apos;./xxxxxx&apos;</span>)\n\n&#x3010;&#x6ce8;&#x610f;&#x3011;&#x904d;&#x5386;&#x540e;&#x7ee7;&#x7eed;xpath&#x4e00;&#x5b9a;&#x8981;&#x4ee5;:  . &#x5f00;&#x5934;&#xff0c;&#x4ee3;&#x8868;&#x5f53;&#x524d;&#x8282;&#x70b9;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"125,132"}}],"payload":{"tag":"h3","lines":"123,124"}},{"content":"&#x5199;&#x7a0b;&#x5e8f;&#x6ce8;&#x610f;","children":[{"content":"<pre data-lines=\"135,142\"><code class=\"language-python\">&#x3010;&#x7ec8;&#x6781;&#x76ee;&#x6807;&#x3011;: &#x4e0d;&#x8981;&#x4f7f;&#x4f60;&#x7684;&#x7a0b;&#x5e8f;&#x56e0;&#x4e3a;&#x4efb;&#x4f55;&#x5f02;&#x5e38;&#x800c;&#x7ec8;&#x6b62;\n  \n&#x3010;&#x9700;&#x8981;&#x6ce8;&#x610f;&#x3011;\n   <span class=\"hljs-number\">1</span>&#x3001;&#x9875;&#x9762;&#x8bf7;&#x6c42;&#x8bbe;&#x7f6e;&#x8d85;&#x65f6;&#x65f6;&#x95f4;,&#x5e76;&#x7528;<span class=\"hljs-keyword\">try</span>&#x6355;&#x6349;&#x5f02;&#x5e38;,&#x8d85;&#x8fc7;&#x6307;&#x5b9a;&#x6b21;&#x6570;&#x5219;&#x66f4;&#x6362;&#x4e0b;&#x4e00;&#x4e2a;URL&#x5730;&#x5740;\n   <span class=\"hljs-number\">2</span>&#x3001;&#x6240;&#x6293;&#x53d6;&#x4efb;&#x4f55;&#x6570;&#x636e;,&#x83b7;&#x53d6;&#x5177;&#x4f53;&#x6570;&#x636e;&#x524d;&#x5148;&#x5224;&#x65ad;&#x662f;&#x5426;&#x5b58;&#x5728;&#x8be5;&#x6570;&#x636e;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"135,142"}}],"payload":{"tag":"h3","lines":"133,134"}}],"payload":{"tag":"h2","lines":"111,112"}}],"payload":{"tag":"h1","lines":"0,1"}},{"content":"Day04&#x7b14;&#x8bb0;","children":[{"content":"&#x767e;&#x5ea6;&#x8d34;&#x5427;&#x56fe;&#x7247;&#x6293;&#x53d6;","children":[{"content":"&#x76ee;&#x6807;","children":[{"content":"<pre data-lines=\"149,152\"><code class=\"language-python\">&#x6293;&#x53d6;&#x6307;&#x5b9a;&#x8d34;&#x5427;&#x6240;&#x6709;&#x56fe;&#x7247;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"149,152"}}],"payload":{"tag":"h3","lines":"147,148"}},{"content":"&#x601d;&#x8def;","children":[{"content":"<pre data-lines=\"155,161\"><code class=\"language-python\">&#x3010;1&#x3011;&#x83b7;&#x53d6;&#x8d34;&#x5427;&#x4e3b;&#x9875;URL,&#x4e0b;&#x4e00;&#x9875;,&#x627e;&#x5230;&#x4e0d;&#x540c;&#x9875;&#x7684;URL&#x89c4;&#x5f8b;\n&#x3010;2&#x3011;&#x83b7;&#x53d6;1&#x9875;&#x4e2d;&#x6240;&#x6709;&#x5e16;&#x5b50;URL&#x5730;&#x5740;: [&#x5e16;&#x5b50;&#x94fe;&#x63a5;1,&#x5e16;&#x5b50;&#x94fe;&#x63a5;2,...]\n&#x3010;3&#x3011;&#x5bf9;&#x6bcf;&#x4e2a;&#x5e16;&#x5b50;&#x94fe;&#x63a5;&#x53d1;&#x8bf7;&#x6c42;,&#x83b7;&#x53d6;&#x56fe;&#x7247;URL&#x5217;&#x8868;: [&#x56fe;&#x7247;&#x94fe;&#x63a5;1,&#x56fe;&#x7247;&#x94fe;&#x63a5;2,...]\n&#x3010;4&#x3011;&#x5411;&#x56fe;&#x7247;&#x7684;URL&#x53d1;&#x8bf7;&#x6c42;,&#x4ee5;wb&#x65b9;&#x5f0f;&#x5199;&#x5165;&#x672c;&#x5730;&#x6587;&#x4ef6;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"155,161"}}],"payload":{"tag":"h3","lines":"153,154"}},{"content":"&#x5b9e;&#x73b0;&#x6b65;&#x9aa4;","children":[{"content":"<pre data-lines=\"164,176\"><code class=\"language-python\">&#x3010;1&#x3011;&#x54cd;&#x5e94;&#x5185;&#x5bb9;&#x603b;&#x662f;&#x5426;&#x5b58;&#x5728;&#x6240;&#x6293;&#x6570;&#x636e; : &#x5b58;&#x5728;!\n  \n&#x3010;2&#x3011;&#x8d34;&#x5427;URL&#x89c4;&#x5f8b;\n   http://tieba.baidu.com/f?kw=??&amp;pn=50\n    \n&#x3010;3&#x3011;xpath&#x8868;&#x8fbe;&#x5f0f;\n   3.1) &#x5e16;&#x5b50;&#x94fe;&#x63a5;: //div[@class=&quot;t_con cleafix&quot;]/div/div/div/a/@href\n   3.2) &#x56fe;&#x7247;&#x94fe;&#x63a5;: //div[@class=&quot;d_post_content j_d_post_content  clearfix&quot;]/img[@class=&quot;BDE_Image&quot;]/@src\n   3.3) &#x89c6;&#x9891;&#x94fe;&#x63a5;: //div[@class=&quot;video_src_wrapper&quot;]/embed/@data-video\n        &#x6b64;&#x5904;&#x89c6;&#x9891;&#x94fe;&#x63a5;&#x524d;&#x7aef;&#x5bf9;&#x54cd;&#x5e94;&#x5185;&#x5bb9;&#x505a;&#x4e86;&#x5904;&#x7406;,&#x9700;&#x8981;&#x67e5;&#x770b;&#x7f51;&#x9875;&#x6e90;&#x4ee3;&#x7801;&#x6765;&#x67e5;&#x770b;&#xff0c;&#x590d;&#x5236;HTML&#x4ee3;&#x7801;&#x5728;&#x7ebf;&#x683c;&#x5f0f;&#x5316; \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"164,176"}}],"payload":{"tag":"h3","lines":"162,163"}},{"content":"&#x4ee3;&#x7801;&#x5b9e;&#x73b0;","children":[{"content":"<pre data-lines=\"179,241\"><code class=\"language-python\"><span class=\"hljs-string\">&quot;&quot;&quot;&#x6293;&#x53d6;&#x6307;&#x5b9a;&#x8d34;&#x5427;&#x7684;&#x6240;&#x6709;&#x5e16;&#x5b50;&#x4e2d;&#x56fe;&#x7247;&quot;&quot;&quot;</span>\n<span class=\"hljs-keyword\">import</span> requests\n<span class=\"hljs-keyword\">from</span> lxml <span class=\"hljs-keyword\">import</span> etree\n<span class=\"hljs-keyword\">import</span> time\n<span class=\"hljs-keyword\">import</span> random\n<span class=\"hljs-keyword\">from</span> urllib <span class=\"hljs-keyword\">import</span> parse\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">TiebaImageSpider</span>(<span class=\"hljs-title class_ inherited__\">object</span>):\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__init__</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-variable language_\">self</span>.url = <span class=\"hljs-string\">&apos;http://tieba.baidu.com/f?kw={}&amp;pn={}&apos;</span>\n        <span class=\"hljs-variable language_\">self</span>.headers = { <span class=\"hljs-string\">&apos;User-Agent&apos;</span>:<span class=\"hljs-string\">&apos;Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; InfoPath.3)&apos;</span> }\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">get_html</span>(<span class=\"hljs-params\">self,url</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x8bf7;&#x6c42;&#x529f;&#x80fd;&#x51fd;&#x6570;&quot;&quot;&quot;</span>\n        html = requests.get(url=url,headers=<span class=\"hljs-variable language_\">self</span>.headers).text\n\n        <span class=\"hljs-keyword\">return</span> html\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">xpath_func</span>(<span class=\"hljs-params\">self,html,xpath_bds</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x89e3;&#x6790;&#x529f;&#x80fd;&#x51fd;&#x6570;&quot;&quot;&quot;</span>\n        parse_html = etree.HTML(html)\n        r_list = parse_html.xpath(xpath_bds)\n\n        <span class=\"hljs-keyword\">return</span> r_list\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">get_images</span>(<span class=\"hljs-params\">self,one_url</span>):\n        one_html = <span class=\"hljs-variable language_\">self</span>.get_html(one_url)\n        xpath_bds = <span class=\"hljs-string\">&apos;//div[@class=&quot;t_con cleafix&quot;]/div/div/div/a/@href&apos;</span>\n        href_list = <span class=\"hljs-variable language_\">self</span>.xpath_func(one_html,xpath_bds)\n        <span class=\"hljs-comment\"># href_list: [&apos;/p/2323&apos;,&apos;/p/23322&apos;,&apos;&apos;]</span>\n        <span class=\"hljs-keyword\">for</span> href <span class=\"hljs-keyword\">in</span> href_list:\n            t_link = <span class=\"hljs-string\">&apos;http://tieba.baidu.com&apos;</span> + href\n            <span class=\"hljs-comment\"># &#x628a;1&#x4e2a;&#x5e16;&#x5b50;&#x4e2d;&#x6240;&#x6709;&#x56fe;&#x7247;&#x4fdd;&#x5b58;&#x4e0b;&#x6765;</span>\n            <span class=\"hljs-variable language_\">self</span>.save_images(t_link)\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">save_images</span>(<span class=\"hljs-params\">self,t_link</span>):\n        two_html = <span class=\"hljs-variable language_\">self</span>.get_html(t_link)\n        two_xpath = <span class=\"hljs-string\">&apos;//div[@class=&quot;d_post_content j_d_post_content  clearfix&quot;]/img[@class=&quot;BDE_Image&quot;]/@src | //div[@class=&quot;video_src_wrapper&quot;]/embed/@data-video&apos;</span>\n        src_list = <span class=\"hljs-variable language_\">self</span>.xpath_func(two_html,two_xpath)\n        <span class=\"hljs-keyword\">for</span> src <span class=\"hljs-keyword\">in</span> src_list:\n            img_html = requests.get(url=src,headers=<span class=\"hljs-variable language_\">self</span>.headers).content\n            filename = src[-<span class=\"hljs-number\">10</span>:]\n            <span class=\"hljs-keyword\">with</span> <span class=\"hljs-built_in\">open</span>(filename,<span class=\"hljs-string\">&apos;wb&apos;</span>) <span class=\"hljs-keyword\">as</span> f:\n                f.write(img_html)\n            <span class=\"hljs-built_in\">print</span>(filename,<span class=\"hljs-string\">&apos;&#x4e0b;&#x8f7d;&#x6210;&#x529f;&apos;</span>)\n            time.sleep(random.uniform(<span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">1</span>))\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">run</span>(<span class=\"hljs-params\">self</span>):\n        name = <span class=\"hljs-built_in\">input</span>(<span class=\"hljs-string\">&quot;&#x8bf7;&#x8f93;&#x5165;&#x8d34;&#x5427;&#x540d;:&quot;</span>)\n        begin = <span class=\"hljs-built_in\">int</span>(<span class=\"hljs-built_in\">input</span>(<span class=\"hljs-string\">&apos;&#x8bf7;&#x8f93;&#x5165;&#x8d77;&#x59cb;&#x9875;:&apos;</span>))\n        end = <span class=\"hljs-built_in\">int</span>(<span class=\"hljs-built_in\">input</span>(<span class=\"hljs-string\">&apos;&#x8bf7;&#x8f93;&#x5165;&#x7ec8;&#x6b62;&#x9875;:&apos;</span>))\n        name = parse.quote(name)\n        <span class=\"hljs-keyword\">for</span> page <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(begin,end+<span class=\"hljs-number\">1</span>):\n            pn = (page-<span class=\"hljs-number\">1</span>)*<span class=\"hljs-number\">50</span>\n            url = <span class=\"hljs-variable language_\">self</span>.url.<span class=\"hljs-built_in\">format</span>(name,pn)\n            <span class=\"hljs-variable language_\">self</span>.get_images(url)\n\n<span class=\"hljs-keyword\">if</span> __name__ == <span class=\"hljs-string\">&apos;__main__&apos;</span>:\n    spider = TiebaImageSpider()\n    spider.run()\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"179,241"}}],"payload":{"tag":"h3","lines":"177,178"}}],"payload":{"tag":"h2","lines":"145,146"}},{"content":"requests.get()&#x53c2;&#x6570;","children":[{"content":"&#x67e5;&#x8be2;&#x53c2;&#x6570;-params","children":[{"content":"&#x53c2;&#x6570;&#x7c7b;&#x578b;","children":[{"content":"<pre data-lines=\"248,251\"><code class=\"language-python\">&#x5b57;&#x5178;,&#x5b57;&#x5178;&#x4e2d;&#x952e;&#x503c;&#x5bf9;&#x4f5c;&#x4e3a;&#x67e5;&#x8be2;&#x53c2;&#x6570;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"248,251"}}],"payload":{"tag":"h4","lines":"246,247"}},{"content":"&#x4f7f;&#x7528;&#x65b9;&#x6cd5;","children":[{"content":"<pre data-lines=\"254,260\"><code class=\"language-python\">&#x3010;1&#x3011;res = requests.get(url=baseurl,params=params,headers=headers)\n&#x3010;2&#x3011;&#x7279;&#x70b9;: \n   2.1) url&#x4e3a;&#x57fa;&#x51c6;&#x7684;url&#x5730;&#x5740;&#xff0c;&#x4e0d;&#x5305;&#x542b;&#x67e5;&#x8be2;&#x53c2;&#x6570;\n   2.2) &#x8be5;&#x65b9;&#x6cd5;&#x4f1a;&#x81ea;&#x52a8;&#x5bf9;params&#x5b57;&#x5178;&#x7f16;&#x7801;,&#x7136;&#x540e;&#x548c;url&#x62fc;&#x63a5;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"254,260"}}],"payload":{"tag":"h4","lines":"252,253"}},{"content":"&#x793a;&#x4f8b;","children":[{"content":"<pre data-lines=\"263,275\"><code class=\"language-python\"><span class=\"hljs-keyword\">import</span> requests\n\nbaseurl = <span class=\"hljs-string\">&apos;http://tieba.baidu.com/f?&apos;</span>\nparams = {\n  <span class=\"hljs-string\">&apos;kw&apos;</span> : <span class=\"hljs-string\">&apos;&#x8d75;&#x4e3d;&#x9896;&#x5427;&apos;</span>,\n  <span class=\"hljs-string\">&apos;pn&apos;</span> : <span class=\"hljs-string\">&apos;50&apos;</span>\n}\nheaders = {<span class=\"hljs-string\">&apos;User-Agent&apos;</span> : <span class=\"hljs-string\">&apos;Mozilla/4.0&apos;</span>}\n<span class=\"hljs-comment\"># &#x81ea;&#x52a8;&#x5bf9;params&#x8fdb;&#x884c;&#x7f16;&#x7801;,&#x7136;&#x540e;&#x81ea;&#x52a8;&#x548c;url&#x8fdb;&#x884c;&#x62fc;&#x63a5;,&#x53bb;&#x53d1;&#x8bf7;&#x6c42;</span>\nhtml = requests.get(url=baseurl,params=params,headers=headers).content.decode()\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"263,275"}}],"payload":{"tag":"h4","lines":"261,262"}}],"payload":{"tag":"h3","lines":"244,245"}},{"content":"SSL&#x8bc1;&#x4e66;&#x8ba4;&#x8bc1;&#x53c2;&#x6570;-verify","children":[{"content":"&#x9002;&#x7528;&#x7f51;&#x7ad9;&#x53ca;&#x573a;&#x666f;","children":[{"content":"<pre data-lines=\"280,284\"><code class=\"language-python\">&#x3010;1&#x3011;&#x9002;&#x7528;&#x7f51;&#x7ad9;: https&#x7c7b;&#x578b;&#x7f51;&#x7ad9;&#x4f46;&#x662f;&#x6ca1;&#x6709;&#x7ecf;&#x8fc7; &#x8bc1;&#x4e66;&#x8ba4;&#x8bc1;&#x673a;&#x6784; &#x8ba4;&#x8bc1;&#x7684;&#x7f51;&#x7ad9;\n&#x3010;2&#x3011;&#x9002;&#x7528;&#x573a;&#x666f;: &#x629b;&#x51fa; SSLError &#x5f02;&#x5e38;&#x5219;&#x8003;&#x8651;&#x4f7f;&#x7528;&#x6b64;&#x53c2;&#x6570;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"280,284"}}],"payload":{"tag":"h4","lines":"278,279"}},{"content":"&#x53c2;&#x6570;&#x7c7b;&#x578b;","children":[{"content":"<pre data-lines=\"287,293\"><code class=\"language-python\">&#x3010;<span class=\"hljs-number\">1</span>&#x3011;verify=<span class=\"hljs-literal\">True</span>(&#x9ed8;&#x8ba4;)   : &#x68c0;&#x67e5;&#x8bc1;&#x4e66;&#x8ba4;&#x8bc1;\n&#x3010;<span class=\"hljs-number\">2</span>&#x3011;verify=<span class=\"hljs-literal\">False</span>&#xff08;&#x5e38;&#x7528;&#xff09;: &#x5ffd;&#x7565;&#x8bc1;&#x4e66;&#x8ba4;&#x8bc1;\n&#x3010;<span class=\"hljs-number\">3</span>&#x3011;&#x793a;&#x4f8b;\n   res = requests.get(url=url,params=params,headers=headers,verify=<span class=\"hljs-literal\">False</span>)\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"287,293"}}],"payload":{"tag":"h4","lines":"285,286"}}],"payload":{"tag":"h3","lines":"276,277"}},{"content":"&#x4ee3;&#x7406;&#x53c2;&#x6570;-proxies","children":[{"content":"&#x5b9a;&#x4e49;&#x53ca;&#x5206;&#x7c7b;","children":[{"content":"<pre data-lines=\"298,308\"><code class=\"language-python\">&#x3010;1&#x3011;&#x5b9a;&#x4e49; : &#x4ee3;&#x66ff;&#x4f60;&#x539f;&#x6765;&#x7684;IP&#x5730;&#x5740;&#x53bb;&#x5bf9;&#x63a5;&#x7f51;&#x7edc;&#x7684;IP&#x5730;&#x5740;\n\n&#x3010;2&#x3011;&#x4f5c;&#x7528; : &#x9690;&#x85cf;&#x81ea;&#x8eab;&#x771f;&#x5b9e;IP,&#x907f;&#x514d;&#x88ab;&#x5c01;\n\n&#x3010;3&#x3011;&#x79cd;&#x7c7b;\n   3.1) &#x9ad8;&#x533f;&#x4ee3;&#x7406;: Web&#x7aef;&#x53ea;&#x80fd;&#x770b;&#x5230;&#x4ee3;&#x7406;IP\n   3.2) &#x666e;&#x901a;&#x4ee3;&#x7406;: Web&#x7aef;&#x77e5;&#x9053;&#x6709;&#x4eba;&#x901a;&#x8fc7;&#x6b64;&#x4ee3;&#x7406;IP&#x8bbf;&#x95ee;&#xff0c;&#x4f46;&#x4e0d;&#x77e5;&#x7528;&#x6237;&#x771f;&#x5b9e;IP\n   3.3) &#x900f;&#x660e;&#x4ee3;&#x7406;: Web&#x80fd;&#x770b;&#x5230;&#x7528;&#x6237;&#x771f;&#x5b9e;IP&#xff0c;&#x4e5f;&#x80fd;&#x770b;&#x5230;&#x4ee3;&#x7406;IP\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"298,308"}}],"payload":{"tag":"h4","lines":"296,297"}},{"content":"&#x666e;&#x901a;&#x4ee3;&#x7406;","children":[{"content":"<pre data-lines=\"311,322\"><code class=\"language-python\">&#x3010;<span class=\"hljs-number\">1</span>&#x3011;&#x83b7;&#x53d6;&#x4ee3;&#x7406;IP&#x7f51;&#x7ad9;\n   &#x897f;&#x523a;&#x4ee3;&#x7406;&#x3001;&#x5feb;&#x4ee3;&#x7406;&#x3001;&#x5168;&#x7f51;&#x4ee3;&#x7406;&#x3001;&#x4ee3;&#x7406;&#x7cbe;&#x7075;&#x3001;... ...\n\n&#x3010;<span class=\"hljs-number\">2</span>&#x3011;&#x53c2;&#x6570;&#x7c7b;&#x578b;\n   proxies = { <span class=\"hljs-string\">&apos;&#x534f;&#x8bae;&apos;</span>:<span class=\"hljs-string\">&apos;&#x534f;&#x8bae;://IP:&#x7aef;&#x53e3;&#x53f7;&apos;</span> }\n   proxies = {\n    \t<span class=\"hljs-string\">&apos;http&apos;</span>:<span class=\"hljs-string\">&apos;http://IP:&#x7aef;&#x53e3;&#x53f7;&apos;</span>,\n    \t<span class=\"hljs-string\">&apos;https&apos;</span>:<span class=\"hljs-string\">&apos;https://IP:&#x7aef;&#x53e3;&#x53f7;&apos;</span>,\n   }\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"311,322"}}],"payload":{"tag":"h4","lines":"309,310"}},{"content":"&#x666e;&#x901a;&#x4ee3;&#x7406; - &#x793a;&#x4f8b;","children":[{"content":"<pre data-lines=\"325,339\"><code class=\"language-python\"><span class=\"hljs-comment\"># &#x4f7f;&#x7528;&#x514d;&#x8d39;&#x666e;&#x901a;&#x4ee3;&#x7406;IP&#x8bbf;&#x95ee;&#x6d4b;&#x8bd5;&#x7f51;&#x7ad9;: http://httpbin.org/get</span>\n<span class=\"hljs-keyword\">import</span> requests\n\nurl = <span class=\"hljs-string\">&apos;http://httpbin.org/get&apos;</span>\nheaders = {<span class=\"hljs-string\">&apos;User-Agent&apos;</span>:<span class=\"hljs-string\">&apos;Mozilla/5.0&apos;</span>}\n<span class=\"hljs-comment\"># &#x5b9a;&#x4e49;&#x4ee3;&#x7406;,&#x5728;&#x4ee3;&#x7406;IP&#x7f51;&#x7ad9;&#x4e2d;&#x67e5;&#x627e;&#x514d;&#x8d39;&#x4ee3;&#x7406;IP</span>\nproxies = {\n    <span class=\"hljs-string\">&apos;http&apos;</span>:<span class=\"hljs-string\">&apos;http://112.85.164.220:9999&apos;</span>,\n    <span class=\"hljs-string\">&apos;https&apos;</span>:<span class=\"hljs-string\">&apos;https://112.85.164.220:9999&apos;</span>\n}\nhtml = requests.get(url,proxies=proxies,headers=headers,timeout=<span class=\"hljs-number\">5</span>).text\n<span class=\"hljs-built_in\">print</span>(html)\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"325,339"}}],"payload":{"tag":"h4","lines":"323,324"}},{"content":"&#x79c1;&#x5bc6;&#x4ee3;&#x7406;+&#x72ec;&#x4eab;&#x4ee3;&#x7406;","children":[{"content":"<pre data-lines=\"342,352\"><code class=\"language-python\">&#x3010;<span class=\"hljs-number\">1</span>&#x3011;&#x8bed;&#x6cd5;&#x7ed3;&#x6784;\n   proxies = { <span class=\"hljs-string\">&apos;&#x534f;&#x8bae;&apos;</span>:<span class=\"hljs-string\">&apos;&#x534f;&#x8bae;://&#x7528;&#x6237;&#x540d;:&#x5bc6;&#x7801;@IP:&#x7aef;&#x53e3;&#x53f7;&apos;</span> }\n\n&#x3010;<span class=\"hljs-number\">2</span>&#x3011;&#x793a;&#x4f8b;\n   proxies = {\n\t  <span class=\"hljs-string\">&apos;http&apos;</span>:<span class=\"hljs-string\">&apos;http://&#x7528;&#x6237;&#x540d;:&#x5bc6;&#x7801;@IP:&#x7aef;&#x53e3;&#x53f7;&apos;</span>,\n      <span class=\"hljs-string\">&apos;https&apos;</span>:<span class=\"hljs-string\">&apos;https://&#x7528;&#x6237;&#x540d;:&#x5bc6;&#x7801;@IP:&#x7aef;&#x53e3;&#x53f7;&apos;</span>,\n   }\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"342,352"}}],"payload":{"tag":"h4","lines":"340,341"}},{"content":"&#x79c1;&#x5bc6;&#x4ee3;&#x7406;+&#x72ec;&#x4eab;&#x4ee3;&#x7406; - &#x793a;&#x4f8b;&#x4ee3;&#x7801;","children":[{"content":"<pre data-lines=\"355,369\"><code class=\"language-python\"><span class=\"hljs-keyword\">import</span> requests\nurl = <span class=\"hljs-string\">&apos;http://httpbin.org/get&apos;</span>\nproxies = {\n    <span class=\"hljs-string\">&apos;http&apos;</span>: <span class=\"hljs-string\">&apos;http://309435365:szayclhp@106.75.71.140:16816&apos;</span>,\n    <span class=\"hljs-string\">&apos;https&apos;</span>:<span class=\"hljs-string\">&apos;https://309435365:szayclhp@106.75.71.140:16816&apos;</span>,\n}\nheaders = {\n    <span class=\"hljs-string\">&apos;User-Agent&apos;</span> : <span class=\"hljs-string\">&apos;Mozilla/5.0&apos;</span>,\n}\n\nhtml = requests.get(url,proxies=proxies,headers=headers,timeout=<span class=\"hljs-number\">5</span>).text\n<span class=\"hljs-built_in\">print</span>(html)\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"355,369"}},{"content":"<pre data-lines=\"370,373\"><code data-lines=\"370,373\"><span class=\"hljs-function\"><span class=\"hljs-title\">sget</span><span class=\"hljs-params\">()</span></span>&#x65b9;&#x6cd5;&#x53c2;&#x6570;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"370,373"}},{"content":"<pre data-lines=\"376,385\"><code class=\"language-python\">&#x3010;<span class=\"hljs-number\">1</span>&#x3011;url=url\n&#x3010;<span class=\"hljs-number\">2</span>&#x3011;params={}\n&#x3010;<span class=\"hljs-number\">3</span>&#x3011;proxies={}\n&#x3010;<span class=\"hljs-number\">4</span>&#x3011;headers={}\n&#x3010;<span class=\"hljs-number\">5</span>&#x3011;timeout=<span class=\"hljs-number\">3</span>\n&#x3010;<span class=\"hljs-number\">6</span>&#x3011;verify=<span class=\"hljs-literal\">False</span> | <span class=\"hljs-literal\">True</span>\n&#x3010;<span class=\"hljs-number\">7</span>&#x3011;cookies={}\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"376,385"}}],"payload":{"tag":"h4","lines":"353,354"}}],"payload":{"tag":"h3","lines":"294,295"}}],"payload":{"tag":"h2","lines":"242,243"}},{"content":"requests.post()","children":[{"content":"&#x9002;&#x7528;&#x573a;&#x666f;","children":[{"content":"<pre data-lines=\"390,399\"><code class=\"language-python\">&#x3010;1&#x3011;&#x9002;&#x7528;&#x573a;&#x666f; : Post&#x7c7b;&#x578b;&#x8bf7;&#x6c42;&#x7684;&#x7f51;&#x7ad9;\n\n&#x3010;2&#x3011;&#x53c2;&#x6570; : data={}\n   2.1) Form&#x8868;&#x5355;&#x6570;&#x636e;: &#x5b57;&#x5178;\n   2.2) res = requests.post(url=url,data=data,headers=headers)\n  \n&#x3010;3&#x3011;POST&#x8bf7;&#x6c42;&#x7279;&#x70b9; : Form&#x8868;&#x5355;&#x63d0;&#x4ea4;&#x6570;&#x636e;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"390,399"}}],"payload":{"tag":"h3","lines":"388,389"}}],"payload":{"tag":"h2","lines":"386,387"}},{"content":"&#x63a7;&#x5236;&#x53f0;&#x6293;&#x5305;","children":[{"content":"&#x6253;&#x5f00;&#x65b9;&#x5f0f;&#x53ca;&#x5e38;&#x7528;&#x9009;&#x9879;","children":[{"content":"<pre data-lines=\"404,423\"><code class=\"language-python\">&#x3010;1&#x3011;&#x6253;&#x5f00;&#x6d4f;&#x89c8;&#x5668;&#xff0c;F12&#x6253;&#x5f00;&#x63a7;&#x5236;&#x53f0;&#xff0c;&#x627e;&#x5230;Network&#x9009;&#x9879;&#x5361;\n\n&#x3010;2&#x3011;&#x63a7;&#x5236;&#x53f0;&#x5e38;&#x7528;&#x9009;&#x9879;\n   2.1) Network: &#x6293;&#x53d6;&#x7f51;&#x7edc;&#x6570;&#x636e;&#x5305;\n     a&gt; ALL: &#x6293;&#x53d6;&#x6240;&#x6709;&#x7684;&#x7f51;&#x7edc;&#x6570;&#x636e;&#x5305;\n     b&gt; XHR&#xff1a;&#x6293;&#x53d6;&#x5f02;&#x6b65;&#x52a0;&#x8f7d;&#x7684;&#x7f51;&#x7edc;&#x6570;&#x636e;&#x5305;\n     c&gt; JS : &#x6293;&#x53d6;&#x6240;&#x6709;&#x7684;JS&#x6587;&#x4ef6;\n   2.2) Sources: &#x683c;&#x5f0f;&#x5316;&#x8f93;&#x51fa;&#x5e76;&#x6253;&#x65ad;&#x70b9;&#x8c03;&#x8bd5;JavaScript&#x4ee3;&#x7801;&#xff0c;&#x52a9;&#x4e8e;&#x5206;&#x6790;&#x722c;&#x866b;&#x4e2d;&#x4e00;&#x4e9b;&#x53c2;&#x6570;\n   2.3) Console: &#x4ea4;&#x4e92;&#x6a21;&#x5f0f;&#xff0c;&#x53ef;&#x5bf9;JavaScript&#x4e2d;&#x7684;&#x4ee3;&#x7801;&#x8fdb;&#x884c;&#x6d4b;&#x8bd5;\n    \n&#x3010;3&#x3011;&#x6293;&#x53d6;&#x5177;&#x4f53;&#x7f51;&#x7edc;&#x6570;&#x636e;&#x5305;&#x540e;\n   3.1) &#x5355;&#x51fb;&#x5de6;&#x4fa7;&#x7f51;&#x7edc;&#x6570;&#x636e;&#x5305;&#x5730;&#x5740;&#xff0c;&#x8fdb;&#x5165;&#x6570;&#x636e;&#x5305;&#x8be6;&#x60c5;&#xff0c;&#x67e5;&#x770b;&#x53f3;&#x4fa7;\n   3.2) &#x53f3;&#x4fa7;:\n     a&gt; Headers: &#x6574;&#x4e2a;&#x8bf7;&#x6c42;&#x4fe1;&#x606f;\n        General&#x3001;Response Headers&#x3001;Request Headers&#x3001;Query String&#x3001;Form Data\n     b&gt; Preview: &#x5bf9;&#x54cd;&#x5e94;&#x5185;&#x5bb9;&#x8fdb;&#x884c;&#x9884;&#x89c8;\n     c&gt; Response&#xff1a;&#x54cd;&#x5e94;&#x5185;&#x5bb9;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"404,423"}}],"payload":{"tag":"h3","lines":"402,403"}},{"content":"&#x6709;&#x9053;&#x7ffb;&#x8bd1;&#x7834;&#x89e3;&#x6848;&#x4f8b;(post)","children":[{"content":"&#x76ee;&#x6807;","children":[{"content":"<pre data-lines=\"428,437\"><code class=\"language-python\">&#x7834;&#x89e3;&#x6709;&#x9053;&#x7ffb;&#x8bd1;&#x63a5;&#x53e3;&#xff0c;&#x6293;&#x53d6;&#x7ffb;&#x8bd1;&#x7ed3;&#x679c;\n<span class=\"hljs-comment\"># &#x7ed3;&#x679c;&#x5c55;&#x793a;</span>\n&#x8bf7;&#x8f93;&#x5165;&#x8981;&#x7ffb;&#x8bd1;&#x7684;&#x8bcd;&#x8bed;: elephant\n&#x7ffb;&#x8bd1;&#x7ed3;&#x679c;: &#x5927;&#x8c61;\n*\n&#x8bf7;&#x8f93;&#x5165;&#x8981;&#x7ffb;&#x8bd1;&#x7684;&#x8bcd;&#x8bed;: &#x55b5;&#x55b5;&#x53eb;\n&#x7ffb;&#x8bd1;&#x7ed3;&#x679c;: mews\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"428,437"}}],"payload":{"tag":"h4","lines":"426,427"}},{"content":"&#x5b9e;&#x73b0;&#x6b65;&#x9aa4;","children":[{"content":"<pre data-lines=\"440,447\"><code class=\"language-python\">&#x3010;1&#x3011;&#x6d4f;&#x89c8;&#x5668;F12&#x5f00;&#x542f;&#x7f51;&#x7edc;&#x6293;&#x5305;,Network-All,&#x9875;&#x9762;&#x7ffb;&#x8bd1;&#x5355;&#x8bcd;&#x540e;&#x627e;Form&#x8868;&#x5355;&#x6570;&#x636e;\n&#x3010;2&#x3011;&#x5728;&#x9875;&#x9762;&#x4e2d;&#x591a;&#x7ffb;&#x8bd1;&#x51e0;&#x4e2a;&#x5355;&#x8bcd;&#xff0c;&#x89c2;&#x5bdf;Form&#x8868;&#x5355;&#x6570;&#x636e;&#x53d8;&#x5316;&#xff08;&#x6709;&#x6570;&#x636e;&#x662f;&#x52a0;&#x5bc6;&#x5b57;&#x7b26;&#x4e32;&#xff09;\n&#x3010;3&#x3011;&#x5237;&#x65b0;&#x6709;&#x9053;&#x7ffb;&#x8bd1;&#x9875;&#x9762;&#xff0c;&#x6293;&#x53d6;&#x5e76;&#x5206;&#x6790;JS&#x4ee3;&#x7801;&#xff08;&#x672c;&#x5730;JS&#x52a0;&#x5bc6;&#xff09;\n&#x3010;4&#x3011;&#x627e;&#x5230;JS&#x52a0;&#x5bc6;&#x7b97;&#x6cd5;&#xff0c;&#x7528;Python&#x6309;&#x540c;&#x6837;&#x65b9;&#x5f0f;&#x52a0;&#x5bc6;&#x751f;&#x6210;&#x52a0;&#x5bc6;&#x6570;&#x636e;\n&#x3010;5&#x3011;&#x5c06;Form&#x8868;&#x5355;&#x6570;&#x636e;&#x5904;&#x7406;&#x4e3a;&#x5b57;&#x5178;&#xff0c;&#x901a;&#x8fc7;requests.post()&#x7684;data&#x53c2;&#x6570;&#x53d1;&#x9001;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"440,447"}}],"payload":{"tag":"h4","lines":"438,439"}},{"content":"&#x5177;&#x4f53;&#x5b9e;&#x73b0;","children":[{"content":"1&#x3001;&#x5f00;&#x542f;F12&#x6293;&#x5305;&#xff0c;&#x627e;&#x5230;Form&#x8868;&#x5355;&#x6570;&#x636e;&#x5982;&#x4e0b;:","children":[{"content":"<pre data-lines=\"452,467\"><code class=\"language-python\">i: &#x55b5;&#x55b5;&#x53eb;\n<span class=\"hljs-keyword\">from</span>: AUTO\nto: AUTO\nsmartresult: <span class=\"hljs-built_in\">dict</span>\nclient: fanyideskweb\nsalt: <span class=\"hljs-number\">15614112641250</span>\nsign: 94008208919faa19bd531acde36aac5d\nts: <span class=\"hljs-number\">1561411264125</span>\nbv: f4d62a2579ebb44874d7ef93ba47e822\ndoctype: json\nversion: <span class=\"hljs-number\">2.1</span>\nkeyfrom: fanyi.web\naction: FY_BY_REALTlME\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"452,467"}}],"payload":{"tag":"h5","lines":"450,451"}},{"content":"2&#x3001;&#x5728;&#x9875;&#x9762;&#x4e2d;&#x591a;&#x7ffb;&#x8bd1;&#x51e0;&#x4e2a;&#x5355;&#x8bcd;&#xff0c;&#x89c2;&#x5bdf;Form&#x8868;&#x5355;&#x6570;&#x636e;&#x53d8;&#x5316;","children":[{"content":"<pre data-lines=\"470,477\"><code class=\"language-python\">salt: <span class=\"hljs-number\">15614112641250</span>\nsign: 94008208919faa19bd531acde36aac5d\nts: <span class=\"hljs-number\">1561411264125</span>\nbv: f4d62a2579ebb44874d7ef93ba47e822\n<span class=\"hljs-comment\"># &#x4f46;&#x662f;bv&#x7684;&#x503c;&#x4e0d;&#x53d8;</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"470,477"}}],"payload":{"tag":"h5","lines":"468,469"}},{"content":"3&#x3001;&#x4e00;&#x822c;&#x4e3a;&#x672c;&#x5730;js&#x6587;&#x4ef6;&#x52a0;&#x5bc6;&#xff0c;&#x5237;&#x65b0;&#x9875;&#x9762;&#xff0c;&#x627e;&#x5230;js&#x6587;&#x4ef6;&#x5e76;&#x5206;&#x6790;JS&#x4ee3;&#x7801;","children":[{"content":"<pre data-lines=\"480,486\"><code class=\"language-python\">&#x3010;&#x65b9;&#x6cd5;<span class=\"hljs-number\">1</span>&#x3011; : Network - JS&#x9009;&#x9879; - &#x641c;&#x7d22;&#x5173;&#x952e;&#x8bcd;salt\n&#x3010;&#x65b9;&#x6cd5;<span class=\"hljs-number\">2</span>&#x3011; : &#x63a7;&#x5236;&#x53f0;&#x53f3;&#x4e0a;&#x89d2; - Search - &#x641c;&#x7d22;salt - &#x67e5;&#x770b;&#x6587;&#x4ef6; - &#x683c;&#x5f0f;&#x5316;&#x8f93;&#x51fa;\n\n&#x3010;&#x7ed3;&#x679c;&#x3011; : &#x6700;&#x7ec8;&#x627e;&#x5230;&#x76f8;&#x5173;JS&#x6587;&#x4ef6; : fanyi.<span class=\"hljs-built_in\">min</span>.js\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"480,486"}}],"payload":{"tag":"h5","lines":"478,479"}},{"content":"4&#x3001;&#x6253;&#x5f00;JS&#x6587;&#x4ef6;&#xff0c;&#x5206;&#x6790;&#x52a0;&#x5bc6;&#x7b97;&#x6cd5;&#xff0c;&#x7528;Python&#x5b9e;&#x73b0;","children":[{"content":"<pre data-lines=\"489,507\"><code class=\"language-python\">&#x3010;ts&#x3011;&#x7ecf;&#x8fc7;&#x5206;&#x6790;&#x4e3a;<span class=\"hljs-number\">13</span>&#x4f4d;&#x7684;&#x65f6;&#x95f4;&#x6233;&#xff0c;&#x5b57;&#x7b26;&#x4e32;&#x7c7b;&#x578b;\n   js&#x4ee3;&#x7801;&#x5b9e;&#x73b0;)  <span class=\"hljs-string\">&quot;&quot;</span> + (new Date).getTime()\n   python&#x5b9e;&#x73b0;) <span class=\"hljs-built_in\">str</span>(<span class=\"hljs-built_in\">int</span>(time.time()*<span class=\"hljs-number\">1000</span>))\n\n&#x3010;salt&#x3011;\n   js&#x4ee3;&#x7801;&#x5b9e;&#x73b0;)  ts + parseInt(<span class=\"hljs-number\">10</span> * Math.random(), <span class=\"hljs-number\">10</span>);\n   python&#x5b9e;&#x73b0;)  ts + <span class=\"hljs-built_in\">str</span>(random.randint(<span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">9</span>))\n\n&#x3010;sign&#x3011;&#xff08;<span class=\"hljs-string\">&apos;&#x8bbe;&#x7f6e;&#x65ad;&#x70b9;&#x8c03;&#x8bd5;&#xff0c;&#x6765;&#x67e5;&#x770b; e &#x7684;&#x503c;&#xff0c;&#x53d1;&#x73b0; e &#x4e3a;&#x8981;&#x7ffb;&#x8bd1;&#x7684;&#x5355;&#x8bcd;&apos;</span>&#xff09;\n   js&#x4ee3;&#x7801;&#x5b9e;&#x73b0;) n.md5(<span class=\"hljs-string\">&quot;fanyideskweb&quot;</span> + e + salt + <span class=\"hljs-string\">&quot;n%A-rKaT5fb[Gy?;N5@Tj&quot;</span>)\n   python&#x5b9e;&#x73b0;)\n   string = <span class=\"hljs-string\">&apos;&quot;fanyideskweb&quot; + e + salt + &quot;n%A-rKaT5fb[Gy?;N5@Tj&quot;&apos;</span>\n   <span class=\"hljs-keyword\">from</span> hashlib <span class=\"hljs-keyword\">import</span> md5\n   s = md5()\n   s.update(string.encode())\n   sign = s.hexdigest()\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"489,507"}}],"payload":{"tag":"h5","lines":"487,488"}},{"content":"4&#x3001;pycharm&#x4e2d;&#x6b63;&#x5219;&#x5904;&#x7406;headers&#x548c;formdata","children":[{"content":"<pre data-lines=\"510,517\"><code class=\"language-python\">&#x3010;<span class=\"hljs-number\">1</span>&#x3011;pycharm&#x8fdb;&#x5165;&#x65b9;&#x6cd5; &#xff1a;Ctrl + r &#xff0c;&#x9009;&#x4e2d; Regex\n&#x3010;<span class=\"hljs-number\">2</span>&#x3011;&#x5904;&#x7406;headers&#x548c;formdata\n    (.*): (.*)\n    <span class=\"hljs-string\">&quot;&#x24;1&quot;</span>: <span class=\"hljs-string\">&quot;&#x24;2&quot;</span>,\n&#x3010;<span class=\"hljs-number\">3</span>&#x3011;&#x70b9;&#x51fb; Replace All\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"510,517"}}],"payload":{"tag":"h5","lines":"508,509"}},{"content":"5&#x3001;&#x4ee3;&#x7801;&#x5b9e;&#x73b0;","children":[{"content":"<pre data-lines=\"520,593\"><code class=\"language-python\"><span class=\"hljs-keyword\">import</span> requests\n<span class=\"hljs-keyword\">import</span> time\n<span class=\"hljs-keyword\">import</span> random\n<span class=\"hljs-keyword\">from</span> hashlib <span class=\"hljs-keyword\">import</span> md5\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">YdSpider</span>(<span class=\"hljs-title class_ inherited__\">object</span>):\n  <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__init__</span>(<span class=\"hljs-params\">self</span>):\n    <span class=\"hljs-comment\"># url&#x4e00;&#x5b9a;&#x4e3a;F12&#x6293;&#x5230;&#x7684; headers -&gt; General -&gt; Request URL</span>\n    <span class=\"hljs-variable language_\">self</span>.url = <span class=\"hljs-string\">&apos;http://fanyi.youdao.com/translate_o?smartresult=dict&amp;smartresult=rule&apos;</span>\n    <span class=\"hljs-variable language_\">self</span>.headers = {\n      <span class=\"hljs-comment\"># &#x68c0;&#x67e5;&#x9891;&#x7387;&#x6700;&#x9ad8; - 3&#x4e2a;</span>\n      <span class=\"hljs-string\">&quot;Cookie&quot;</span>: <span class=\"hljs-string\">&quot;OUTFOX_SEARCH_USER_ID=970246104@10.169.0.83; OUTFOX_SEARCH_USER_ID_NCOO=570559528.1224236; _ntes_nnid=96bc13a2f5ce64962adfd6a278467214,1551873108952; JSESSIONID=aaae9i7plXPlKaJH_gkYw; td_cookie=18446744072941336803; SESSION_FROM_COOKIE=unknown; ___rl__test__cookies=1565689460872&quot;</span>,\n      <span class=\"hljs-string\">&quot;Referer&quot;</span>: <span class=\"hljs-string\">&quot;http://fanyi.youdao.com/&quot;</span>,\n      <span class=\"hljs-string\">&quot;User-Agent&quot;</span>: <span class=\"hljs-string\">&quot;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/76.0.3809.100 Safari/537.36&quot;</span>,\n    }\n\n  <span class=\"hljs-comment\"># &#x83b7;&#x53d6;salt,sign,ts</span>\n  <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">get_salt_sign_ts</span>(<span class=\"hljs-params\">self,word</span>):\n    <span class=\"hljs-comment\"># ts</span>\n    ts = <span class=\"hljs-built_in\">str</span>(<span class=\"hljs-built_in\">int</span>(time.time()*<span class=\"hljs-number\">1000</span>))\n    <span class=\"hljs-comment\"># salt</span>\n    salt = ts + <span class=\"hljs-built_in\">str</span>(random.randint(<span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">9</span>))\n    <span class=\"hljs-comment\"># sign</span>\n    string = <span class=\"hljs-string\">&quot;fanyideskweb&quot;</span> + word + salt + <span class=\"hljs-string\">&quot;n%A-rKaT5fb[Gy?;N5@Tj&quot;</span>\n    s = md5()\n    s.update(string.encode())\n    sign = s.hexdigest()\n\n    <span class=\"hljs-keyword\">return</span> salt,sign,ts\n\n  <span class=\"hljs-comment\"># &#x4e3b;&#x51fd;&#x6570;</span>\n  <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">attack_yd</span>(<span class=\"hljs-params\">self,word</span>):\n    <span class=\"hljs-comment\"># 1. &#x5148;&#x62ff;&#x5230;salt,sign,ts</span>\n    salt,sign,ts = <span class=\"hljs-variable language_\">self</span>.get_salt_sign_ts(word)\n    <span class=\"hljs-comment\"># 2. &#x5b9a;&#x4e49;form&#x8868;&#x5355;&#x6570;&#x636e;&#x4e3a;&#x5b57;&#x5178;: data={}</span>\n    <span class=\"hljs-comment\"># &#x68c0;&#x67e5;&#x4e86;salt sign</span>\n    data = {\n      <span class=\"hljs-string\">&quot;i&quot;</span>: word,\n      <span class=\"hljs-string\">&quot;from&quot;</span>: <span class=\"hljs-string\">&quot;AUTO&quot;</span>,\n      <span class=\"hljs-string\">&quot;to&quot;</span>: <span class=\"hljs-string\">&quot;AUTO&quot;</span>,\n      <span class=\"hljs-string\">&quot;smartresult&quot;</span>: <span class=\"hljs-string\">&quot;dict&quot;</span>,\n      <span class=\"hljs-string\">&quot;client&quot;</span>: <span class=\"hljs-string\">&quot;fanyideskweb&quot;</span>,\n      <span class=\"hljs-string\">&quot;salt&quot;</span>: salt,\n      <span class=\"hljs-string\">&quot;sign&quot;</span>: sign,\n      <span class=\"hljs-string\">&quot;ts&quot;</span>: ts,\n      <span class=\"hljs-string\">&quot;bv&quot;</span>: <span class=\"hljs-string\">&quot;7e3150ecbdf9de52dc355751b074cf60&quot;</span>,\n      <span class=\"hljs-string\">&quot;doctype&quot;</span>: <span class=\"hljs-string\">&quot;json&quot;</span>,\n      <span class=\"hljs-string\">&quot;version&quot;</span>: <span class=\"hljs-string\">&quot;2.1&quot;</span>,\n      <span class=\"hljs-string\">&quot;keyfrom&quot;</span>: <span class=\"hljs-string\">&quot;fanyi.web&quot;</span>,\n      <span class=\"hljs-string\">&quot;action&quot;</span>: <span class=\"hljs-string\">&quot;FY_BY_REALTlME&quot;</span>,\n    }\n    <span class=\"hljs-comment\"># 3. &#x76f4;&#x63a5;&#x53d1;&#x8bf7;&#x6c42;:requests.post(url,data=data,headers=xxx)</span>\n    html = requests.post(\n      url=<span class=\"hljs-variable language_\">self</span>.url,\n      data=data,\n      headers=<span class=\"hljs-variable language_\">self</span>.headers\n    ).json()\n    <span class=\"hljs-comment\"># res.json() &#x5c06;json&#x683c;&#x5f0f;&#x7684;&#x5b57;&#x7b26;&#x4e32;&#x8f6c;&#x4e3a;python&#x6570;&#x636e;&#x7c7b;&#x578b;</span>\n    result = html[<span class=\"hljs-string\">&apos;translateResult&apos;</span>][<span class=\"hljs-number\">0</span>][<span class=\"hljs-number\">0</span>][<span class=\"hljs-string\">&apos;tgt&apos;</span>]\n\n    <span class=\"hljs-built_in\">print</span>(result)\n\n  <span class=\"hljs-comment\"># &#x4e3b;&#x51fd;&#x6570;</span>\n  <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">run</span>(<span class=\"hljs-params\">self</span>):\n    <span class=\"hljs-comment\"># &#x8f93;&#x5165;&#x7ffb;&#x8bd1;&#x5355;&#x8bcd;</span>\n    word = <span class=\"hljs-built_in\">input</span>(<span class=\"hljs-string\">&apos;&#x8bf7;&#x8f93;&#x5165;&#x8981;&#x7ffb;&#x8bd1;&#x7684;&#x5355;&#x8bcd;:&apos;</span>)\n    <span class=\"hljs-variable language_\">self</span>.attack_yd(word)\n\n<span class=\"hljs-keyword\">if</span> __name__ == <span class=\"hljs-string\">&apos;__main__&apos;</span>:\n  spider = YdSpider()\n  spider.run()\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"520,593"}}],"payload":{"tag":"h5","lines":"518,519"}}],"payload":{"tag":"h4","lines":"448,449"}}],"payload":{"tag":"h3","lines":"424,425"}}],"payload":{"tag":"h2","lines":"400,401"}},{"content":"&#x4eca;&#x65e5;&#x4f5c;&#x4e1a;","children":[{"content":"&#x793a;&#x4f8b;","children":[{"content":"<pre data-lines=\"616,691\"><code class=\"language-python\"><span class=\"hljs-string\">&quot;&quot;&quot;\n&#x767e;&#x5ea6;&#x8d34;&#x5427;&#x5e16;&#x5b50;&#x4e2d;&#x56fe;&#x7247;&#x6293;&#x53d6;\n&quot;&quot;&quot;</span>\n<span class=\"hljs-keyword\">import</span> requests\n<span class=\"hljs-keyword\">from</span> lxml <span class=\"hljs-keyword\">import</span> etree\n<span class=\"hljs-keyword\">import</span> time\n<span class=\"hljs-keyword\">import</span> random\n<span class=\"hljs-keyword\">from</span> urllib <span class=\"hljs-keyword\">import</span> parse\n<span class=\"hljs-keyword\">import</span> os\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">TiebaImageSpider</span>:\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__init__</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-variable language_\">self</span>.url = <span class=\"hljs-string\">&apos;http://tieba.baidu.com/f?kw={}&amp;pn={}&apos;</span>\n        <span class=\"hljs-comment\"># &#x6b64;&#x5904;&#x4f7f;&#x7528;IE&#x7684;User-Agent,&#x56e0;&#x4e3a;&#x4e0d;&#x540c;&#x6d4f;&#x89c8;&#x5668;&#x5411;&#x7f51;&#x7ad9;&#x53d1;&#x8bf7;&#x6c42;,&#x5f97;&#x5230;&#x7684;&#x54cd;&#x5e94;&#x4e0d;&#x4e00;&#x5b9a;&#x5b8c;&#x5168;&#x4e00;&#x6837;</span>\n        <span class=\"hljs-variable language_\">self</span>.headers = {<span class=\"hljs-string\">&apos;User-Agent&apos;</span> : <span class=\"hljs-string\">&apos;Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; InfoPath.3)&apos;</span>}\n        <span class=\"hljs-variable language_\">self</span>.directory = <span class=\"hljs-string\">&apos;E:/home/tarena/images/&apos;</span>\n        <span class=\"hljs-keyword\">if</span> <span class=\"hljs-keyword\">not</span> os.path.exists(<span class=\"hljs-variable language_\">self</span>.directory):\n            os.makedirs(<span class=\"hljs-variable language_\">self</span>.directory)\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">get_html</span>(<span class=\"hljs-params\">self, url</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x529f;&#x80fd;&#x51fd;&#x6570;1 - &#x83b7;&#x53d6;html&quot;&quot;&quot;</span>\n        html = requests.get(url=url, headers=<span class=\"hljs-variable language_\">self</span>.headers).text\n\n        <span class=\"hljs-keyword\">return</span> html\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">xpath_func</span>(<span class=\"hljs-params\">self, html, xpath_bds</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x529f;&#x80fd;&#x51fd;&#x6570;2 - &#x89e3;&#x6790;&#x63d0;&#x53d6;&#x6570;&#x636e;&quot;&quot;&quot;</span>\n        p = etree.HTML(html)\n        r_list = p.xpath(xpath_bds)\n\n        <span class=\"hljs-keyword\">return</span>  r_list\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">parse_html</span>(<span class=\"hljs-params\">self, one_url</span>):\n        one_html = <span class=\"hljs-variable language_\">self</span>.get_html(url=one_url)\n        xpath_bds = <span class=\"hljs-string\">&apos;//div[@class=&quot;t_con cleafix&quot;]/div/div/div/a/@href&apos;</span>\n        href_list = <span class=\"hljs-variable language_\">self</span>.xpath_func(one_html, xpath_bds)\n        <span class=\"hljs-keyword\">for</span> href <span class=\"hljs-keyword\">in</span> href_list:\n            <span class=\"hljs-comment\"># &#x628a;1&#x4e2a;href&#x5e16;&#x5b50;&#x4e2d;,&#x6240;&#x6709;&#x7684;&#x56fe;&#x7247;&#x4fdd;&#x5b58;&#x5230;&#x672c;&#x5730;</span>\n            t_url = <span class=\"hljs-string\">&apos;http://tieba.baidu.com&apos;</span> + href\n            <span class=\"hljs-variable language_\">self</span>.save_images(t_url)\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">save_images</span>(<span class=\"hljs-params\">self, t_url</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x529f;&#x80fd;&#xff1a;&#x628a;1&#x4e2a;&#x5e16;&#x5b50;&#x4e2d;&#x6240;&#x6709;&#x56fe;&#x7247;&#x4fdd;&#x5b58;&#x5230;&#x672c;&#x5730;&quot;&quot;&quot;</span>\n        two_html = <span class=\"hljs-variable language_\">self</span>.get_html(url=t_url)\n        two_xpath = <span class=\"hljs-string\">&apos;//div[@class=&quot;d_post_content j_d_post_content  clearfix&quot;]/img[@class=&quot;BDE_Image&quot;]/@src | //div[@class=&quot;video_src_wrapper&quot;]/embed/@data-video&apos;</span>\n        img_url_list = <span class=\"hljs-variable language_\">self</span>.xpath_func(two_html, two_xpath)\n        <span class=\"hljs-keyword\">for</span> img_url <span class=\"hljs-keyword\">in</span> img_url_list:\n            <span class=\"hljs-comment\"># &#x628a;&#x6bcf;&#x5f20;&#x56fe;&#x7247;&#x4fdd;&#x5b58;&#x5230;&#x672c;&#x5730;</span>\n            <span class=\"hljs-variable language_\">self</span>.down_image(img_url)\n            time.sleep(random.uniform(<span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">1</span>))\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">down_image</span>(<span class=\"hljs-params\">self, img_url</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x529f;&#x80fd;&#xff1a;&#x628a;1&#x5f20;&#x56fe;&#x7247;&#x4fdd;&#x5b58;&#x5230;&#x672c;&#x5730;&quot;&quot;&quot;</span>\n        html = requests.get(url=img_url, headers=<span class=\"hljs-variable language_\">self</span>.headers).content\n        filename = <span class=\"hljs-variable language_\">self</span>.directory + img_url[-<span class=\"hljs-number\">10</span>:]\n        <span class=\"hljs-keyword\">with</span> <span class=\"hljs-built_in\">open</span>(filename,<span class=\"hljs-string\">&apos;wb&apos;</span>) <span class=\"hljs-keyword\">as</span> f:\n            f.write(html)\n        <span class=\"hljs-built_in\">print</span>(filename,<span class=\"hljs-string\">&apos;&#x4e0b;&#x8f7d;&#x6210;&#x529f;&apos;</span>)\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">run</span>(<span class=\"hljs-params\">self</span>):\n        name = <span class=\"hljs-built_in\">input</span>(<span class=\"hljs-string\">&apos;&#x8bf7;&#x8f93;&#x5165;&#x8d34;&#x5427;&#x540d;:&apos;</span>)\n        start = <span class=\"hljs-built_in\">int</span>(<span class=\"hljs-built_in\">input</span>(<span class=\"hljs-string\">&apos;&#x8bf7;&#x8f93;&#x5165;&#x8d77;&#x59cb;&#x9875;:&apos;</span>))\n        end = <span class=\"hljs-built_in\">int</span>(<span class=\"hljs-built_in\">input</span>(<span class=\"hljs-string\">&apos;&#x8bf7;&#x8f93;&#x5165;&#x7ec8;&#x6b62;&#x9875;:&apos;</span>))\n        params = parse.quote(name)\n        <span class=\"hljs-keyword\">for</span> page <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(start,end+<span class=\"hljs-number\">1</span>):\n            pn = (page - <span class=\"hljs-number\">1</span>) * <span class=\"hljs-number\">50</span>\n            url = <span class=\"hljs-variable language_\">self</span>.url.<span class=\"hljs-built_in\">format</span>(params,pn)\n            <span class=\"hljs-variable language_\">self</span>.parse_html(url)\n\n<span class=\"hljs-keyword\">if</span> __name__ == <span class=\"hljs-string\">&apos;__main__&apos;</span>:\n    spider = TiebaImageSpider()\n    spider.run()\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"616,691"}},{"content":"<pre data-lines=\"692,771\"><code class=\"language-python\"><span class=\"hljs-string\">&quot;&quot;&quot;\n&#x767e;&#x5ea6;&#x8d34;&#x5427;&#x5e16;&#x5b50;&#x4e2d;&#x56fe;&#x7247;&#x6293;&#x53d6;\n&quot;&quot;&quot;</span>\n<span class=\"hljs-keyword\">import</span> requests\n<span class=\"hljs-keyword\">from</span> lxml <span class=\"hljs-keyword\">import</span> etree\n<span class=\"hljs-keyword\">import</span> time\n<span class=\"hljs-keyword\">import</span> random\n<span class=\"hljs-keyword\">import</span> os\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">TiebaImageSpider</span>:\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__init__</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-comment\"># 1&#x3001;&#x4f7f;&#x7528;params&#x53c2;&#x6570; - URL&#x5730;&#x5740;&#x5b9a;&#x4e49;&#x65f6;&#x5b9a;&#x4e49;&#x5230; ? &#x4f4d;&#x7f6e;</span>\n        <span class=\"hljs-variable language_\">self</span>.url = <span class=\"hljs-string\">&apos;http://tieba.baidu.com/f?&apos;</span>\n        <span class=\"hljs-comment\"># &#x6b64;&#x5904;&#x4f7f;&#x7528;IE&#x7684;User-Agent,&#x56e0;&#x4e3a;&#x4e0d;&#x540c;&#x6d4f;&#x89c8;&#x5668;&#x5411;&#x7f51;&#x7ad9;&#x53d1;&#x8bf7;&#x6c42;,&#x5f97;&#x5230;&#x7684;&#x54cd;&#x5e94;&#x4e0d;&#x4e00;&#x5b9a;&#x5b8c;&#x5168;&#x4e00;&#x6837;</span>\n        <span class=\"hljs-variable language_\">self</span>.headers = {<span class=\"hljs-string\">&apos;User-Agent&apos;</span> : <span class=\"hljs-string\">&apos;Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; InfoPath.3)&apos;</span>}\n        <span class=\"hljs-variable language_\">self</span>.directory = <span class=\"hljs-string\">&apos;E:/home/tarena/images/&apos;</span>\n        <span class=\"hljs-keyword\">if</span> <span class=\"hljs-keyword\">not</span> os.path.exists(<span class=\"hljs-variable language_\">self</span>.directory):\n            os.makedirs(<span class=\"hljs-variable language_\">self</span>.directory)\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">get_html</span>(<span class=\"hljs-params\">self, params</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x529f;&#x80fd;&#x51fd;&#x6570;1 - &#x83b7;&#x53d6;html&quot;&quot;&quot;</span>\n        html = requests.get(url=<span class=\"hljs-variable language_\">self</span>.url, params=params, headers=<span class=\"hljs-variable language_\">self</span>.headers).text\n\n        <span class=\"hljs-keyword\">return</span> html\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">xpath_func</span>(<span class=\"hljs-params\">self, html, xpath_bds</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x529f;&#x80fd;&#x51fd;&#x6570;2 - &#x89e3;&#x6790;&#x63d0;&#x53d6;&#x6570;&#x636e;&quot;&quot;&quot;</span>\n        p = etree.HTML(html)\n        r_list = p.xpath(xpath_bds)\n\n        <span class=\"hljs-keyword\">return</span>  r_list\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">parse_html</span>(<span class=\"hljs-params\">self, params</span>):\n        one_html = <span class=\"hljs-variable language_\">self</span>.get_html(params)\n        xpath_bds = <span class=\"hljs-string\">&apos;//div[@class=&quot;t_con cleafix&quot;]/div/div/div/a/@href&apos;</span>\n        href_list = <span class=\"hljs-variable language_\">self</span>.xpath_func(one_html, xpath_bds)\n        <span class=\"hljs-keyword\">for</span> href <span class=\"hljs-keyword\">in</span> href_list:\n            <span class=\"hljs-comment\"># &#x628a;1&#x4e2a;href&#x5e16;&#x5b50;&#x4e2d;,&#x6240;&#x6709;&#x7684;&#x56fe;&#x7247;&#x4fdd;&#x5b58;&#x5230;&#x672c;&#x5730;</span>\n            t_url = <span class=\"hljs-string\">&apos;http://tieba.baidu.com&apos;</span> + href\n            <span class=\"hljs-variable language_\">self</span>.save_images(t_url)\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">save_images</span>(<span class=\"hljs-params\">self, t_url</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x529f;&#x80fd;&#xff1a;&#x628a;1&#x4e2a;&#x5e16;&#x5b50;&#x4e2d;&#x6240;&#x6709;&#x56fe;&#x7247;&#x4fdd;&#x5b58;&#x5230;&#x672c;&#x5730;&quot;&quot;&quot;</span>\n        two_html = requests.get(url=t_url, headers=<span class=\"hljs-variable language_\">self</span>.headers).text\n        two_xpath = <span class=\"hljs-string\">&apos;//div[@class=&quot;d_post_content j_d_post_content  clearfix&quot;]/img[@class=&quot;BDE_Image&quot;]/@src | //div[@class=&quot;video_src_wrapper&quot;]/embed/@data-video&apos;</span>\n        img_url_list = <span class=\"hljs-variable language_\">self</span>.xpath_func(two_html, two_xpath)\n        <span class=\"hljs-keyword\">for</span> img_url <span class=\"hljs-keyword\">in</span> img_url_list:\n            <span class=\"hljs-comment\"># &#x628a;&#x6bcf;&#x5f20;&#x56fe;&#x7247;&#x4fdd;&#x5b58;&#x5230;&#x672c;&#x5730;</span>\n            <span class=\"hljs-variable language_\">self</span>.down_image(img_url)\n            time.sleep(random.uniform(<span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">1</span>))\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">down_image</span>(<span class=\"hljs-params\">self, img_url</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x529f;&#x80fd;&#xff1a;&#x628a;1&#x5f20;&#x56fe;&#x7247;&#x4fdd;&#x5b58;&#x5230;&#x672c;&#x5730;&quot;&quot;&quot;</span>\n        html = requests.get(url=img_url, headers=<span class=\"hljs-variable language_\">self</span>.headers).content\n        filename = <span class=\"hljs-variable language_\">self</span>.directory + img_url[-<span class=\"hljs-number\">10</span>:]\n        <span class=\"hljs-keyword\">with</span> <span class=\"hljs-built_in\">open</span>(filename,<span class=\"hljs-string\">&apos;wb&apos;</span>) <span class=\"hljs-keyword\">as</span> f:\n            f.write(html)\n        <span class=\"hljs-built_in\">print</span>(filename,<span class=\"hljs-string\">&apos;&#x4e0b;&#x8f7d;&#x6210;&#x529f;&apos;</span>)\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">run</span>(<span class=\"hljs-params\">self</span>):\n        name = <span class=\"hljs-built_in\">input</span>(<span class=\"hljs-string\">&apos;&#x8bf7;&#x8f93;&#x5165;&#x8d34;&#x5427;&#x540d;:&apos;</span>)\n        start = <span class=\"hljs-built_in\">int</span>(<span class=\"hljs-built_in\">input</span>(<span class=\"hljs-string\">&apos;&#x8bf7;&#x8f93;&#x5165;&#x8d77;&#x59cb;&#x9875;:&apos;</span>))\n        end = <span class=\"hljs-built_in\">int</span>(<span class=\"hljs-built_in\">input</span>(<span class=\"hljs-string\">&apos;&#x8bf7;&#x8f93;&#x5165;&#x7ec8;&#x6b62;&#x9875;:&apos;</span>))\n\n        <span class=\"hljs-keyword\">for</span> page <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(start,end+<span class=\"hljs-number\">1</span>):\n            pn = (page - <span class=\"hljs-number\">1</span>) * <span class=\"hljs-number\">50</span>\n            params = {\n                <span class=\"hljs-string\">&apos;kw&apos;</span> : name,\n                <span class=\"hljs-string\">&apos;pn&apos;</span> : <span class=\"hljs-built_in\">str</span>(pn),\n            }\n            <span class=\"hljs-comment\"># &#x4f20;&#x53c2;&#x65f6;&#x4f20;&#x9012; params &#x53c2;&#x6570;</span>\n            <span class=\"hljs-variable language_\">self</span>.parse_html(params)\n\n<span class=\"hljs-keyword\">if</span> __name__ == <span class=\"hljs-string\">&apos;__main__&apos;</span>:\n    spider = TiebaImageSpider()\n    spider.run()\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"692,771"}},{"content":"<pre data-lines=\"772,789\"><code class=\"language-python\"><span class=\"hljs-string\">&quot;&quot;&quot;\n&#x4f7f;&#x7528;&#x514d;&#x8d39;&#x4ee3;&#x7406;IP&#x5411;&#x6d4b;&#x8bd5;&#x7f51;&#x7ad9;&#x53d1;&#x8bf7;&#x6c42;,&#x5e76;&#x786e;&#x8ba4;\n&quot;&quot;&quot;</span>\n<span class=\"hljs-keyword\">import</span> requests\n\nurl = <span class=\"hljs-string\">&apos;http://httpbin.org/get&apos;</span>\nheaders = {<span class=\"hljs-string\">&apos;User-Agent&apos;</span>:<span class=\"hljs-string\">&apos;Mozilla/5.0&apos;</span>}\nproxies = {\n    <span class=\"hljs-string\">&apos;http&apos;</span> : <span class=\"hljs-string\">&apos;http://60.190.250.120:8080&apos;</span>,\n    <span class=\"hljs-string\">&apos;https&apos;</span> : <span class=\"hljs-string\">&apos;https://60.190.250.120:8080&apos;</span>,\n}\n\nhtml = requests.get(url=url, proxies=proxies, headers=headers).text\n<span class=\"hljs-built_in\">print</span>(html)\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"772,789"}},{"content":"<pre data-lines=\"790,804\"><code class=\"language-python\"><span class=\"hljs-string\">&quot;&quot;&quot;\n&#x8ba9;&#x897f;&#x523a;&#x4ee3;&#x7406;&#x5c01;&#x6389;&#x6211;&#x7684;IP&#xff01;&#xff01;&#xff01;\n&quot;&quot;&quot;</span>\n<span class=\"hljs-keyword\">import</span> requests\n\nurl = <span class=\"hljs-string\">&apos;https://www.xicidaili.com/nn/{}&apos;</span>\nheaders = {<span class=\"hljs-string\">&apos;User-Agent&apos;</span> : <span class=\"hljs-string\">&apos;Mozilla/5.0&apos;</span>}\n\n<span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(<span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">101</span>):\n    page_url = url.<span class=\"hljs-built_in\">format</span>(i)\n    res = requests.get(url=page_url,headers=headers)\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"790,804"}},{"content":"<pre data-lines=\"805,846\"><code class=\"language-python\"><span class=\"hljs-string\">&quot;&quot;&quot;\n&#x5efa;&#x7acb;&#x5f00;&#x653e;&#x4ee3;&#x7406; &#x4ee3;&#x7406;IP&#x6c60;\n&quot;&quot;&quot;</span>\n<span class=\"hljs-keyword\">import</span> requests\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">ProxyPool</span>:\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__init__</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-variable language_\">self</span>.api_url = <span class=\"hljs-string\">&apos;http://dev.kdlapi.com/api/getproxy/?orderid=958477150989954&amp;num=20&amp;protocol=2&amp;method=2&amp;an_ha=1&amp;sep=1&apos;</span>\n        <span class=\"hljs-variable language_\">self</span>.test_url = <span class=\"hljs-string\">&apos;http://www.baidu.com/&apos;</span>\n        <span class=\"hljs-variable language_\">self</span>.headers = {<span class=\"hljs-string\">&apos;User-Agent&apos;</span> : <span class=\"hljs-string\">&apos;Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; InfoPath.3)&apos;</span>}\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">get_proxy</span>(<span class=\"hljs-params\">self</span>):\n        html = requests.get(url=<span class=\"hljs-variable language_\">self</span>.api_url, headers=<span class=\"hljs-variable language_\">self</span>.headers).text\n        <span class=\"hljs-comment\"># proxy_list: [&apos;1.1.1.1:8888&apos;,&apos;1.1.1.2:8888&apos;,&apos;1.1.1.3:8888&apos;]</span>\n        proxy_list = html.split(<span class=\"hljs-string\">&apos;\\r\\n&apos;</span>)\n        <span class=\"hljs-keyword\">for</span> proxy <span class=\"hljs-keyword\">in</span> proxy_list:\n            <span class=\"hljs-comment\"># &#x5bf9;&#x6bcf;&#x4e2a;&#x4ee3;&#x7406;IP&#x8fdb;&#x884c;&#x6d4b;&#x8bd5;,&#x5224;&#x65ad;&#x662f;&#x5426;&#x53ef;&#x7528;</span>\n            <span class=\"hljs-variable language_\">self</span>.test_proxy(proxy)\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">test_proxy</span>(<span class=\"hljs-params\">self, proxy</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x6d4b;&#x8bd5;&#x4ee3;&#x7406;IP&#x662f;&#x5426;&#x53ef;&#x7528;&#x51fd;&#x6570;&quot;&quot;&quot;</span>\n        proxies = {\n            <span class=\"hljs-string\">&apos;http&apos;</span> : <span class=\"hljs-string\">&apos;http://{}&apos;</span>.<span class=\"hljs-built_in\">format</span>(proxy),\n            <span class=\"hljs-string\">&apos;https&apos;</span>: <span class=\"hljs-string\">&apos;https://{}&apos;</span>.<span class=\"hljs-built_in\">format</span>(proxy),\n        }\n        <span class=\"hljs-keyword\">try</span>:\n            res = requests.get(url=<span class=\"hljs-variable language_\">self</span>.test_url,proxies=proxies,headers=<span class=\"hljs-variable language_\">self</span>.headers,timeout=<span class=\"hljs-number\">3</span>)\n            <span class=\"hljs-keyword\">if</span> res.status_code == <span class=\"hljs-number\">200</span>:\n                <span class=\"hljs-built_in\">print</span>(proxy,<span class=\"hljs-string\">&apos;\\033[31m&#x53ef;&#x7528;\\033[0m&apos;</span>)\n        <span class=\"hljs-keyword\">except</span> Exception <span class=\"hljs-keyword\">as</span> e:\n            <span class=\"hljs-built_in\">print</span>(proxy,<span class=\"hljs-string\">&apos;&#x4e0d;&#x53ef;&#x7528;&apos;</span>)\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">run</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-variable language_\">self</span>.get_proxy()\n\n<span class=\"hljs-keyword\">if</span> __name__ == <span class=\"hljs-string\">&apos;__main__&apos;</span>:\n    spider = ProxyPool()\n    spider.run()\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"805,846"}},{"content":"<pre data-lines=\"847,888\"><code class=\"language-python\"><span class=\"hljs-string\">&quot;&quot;&quot;\n&#x5efa;&#x7acb;&#x79c1;&#x5bc6;&#x4ee3;&#x7406; &#x4ee3;&#x7406;IP&#x6c60;\n&quot;&quot;&quot;</span>\n<span class=\"hljs-keyword\">import</span> requests\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">ProxyPool</span>:\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__init__</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-variable language_\">self</span>.api_url = <span class=\"hljs-string\">&apos;http://dps.kdlapi.com/api/getdps/?orderid=908477155195136&amp;num=20&amp;pt=1&amp;sep=1&apos;</span>\n        <span class=\"hljs-variable language_\">self</span>.test_url = <span class=\"hljs-string\">&apos;http://www.baidu.com/&apos;</span>\n        <span class=\"hljs-variable language_\">self</span>.headers = {<span class=\"hljs-string\">&apos;User-Agent&apos;</span> : <span class=\"hljs-string\">&apos;Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; InfoPath.3)&apos;</span>}\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">get_proxy</span>(<span class=\"hljs-params\">self</span>):\n        html = requests.get(url=<span class=\"hljs-variable language_\">self</span>.api_url, headers=<span class=\"hljs-variable language_\">self</span>.headers).text\n        <span class=\"hljs-comment\"># proxy_list: [&apos;1.1.1.1:8888&apos;,&apos;1.1.1.2:8888&apos;,&apos;1.1.1.3:8888&apos;]</span>\n        proxy_list = html.split(<span class=\"hljs-string\">&apos;\\r\\n&apos;</span>)\n        <span class=\"hljs-keyword\">for</span> proxy <span class=\"hljs-keyword\">in</span> proxy_list:\n            <span class=\"hljs-comment\"># &#x5bf9;&#x6bcf;&#x4e2a;&#x4ee3;&#x7406;IP&#x8fdb;&#x884c;&#x6d4b;&#x8bd5;,&#x5224;&#x65ad;&#x662f;&#x5426;&#x53ef;&#x7528;</span>\n            <span class=\"hljs-variable language_\">self</span>.test_proxy(proxy)\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">test_proxy</span>(<span class=\"hljs-params\">self, proxy</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x6d4b;&#x8bd5;&#x4ee3;&#x7406;IP&#x662f;&#x5426;&#x53ef;&#x7528;&#x51fd;&#x6570;&quot;&quot;&quot;</span>\n        proxies = {\n            <span class=\"hljs-string\">&apos;http&apos;</span> : <span class=\"hljs-string\">&apos;http://309435365:szayclhp@{}&apos;</span>.<span class=\"hljs-built_in\">format</span>(proxy),\n            <span class=\"hljs-string\">&apos;https&apos;</span>: <span class=\"hljs-string\">&apos;https://309435365:szayclhp@{}&apos;</span>.<span class=\"hljs-built_in\">format</span>(proxy),\n        }\n        <span class=\"hljs-keyword\">try</span>:\n            res = requests.get(url=<span class=\"hljs-variable language_\">self</span>.test_url,proxies=proxies,headers=<span class=\"hljs-variable language_\">self</span>.headers,timeout=<span class=\"hljs-number\">3</span>)\n            <span class=\"hljs-keyword\">if</span> res.status_code == <span class=\"hljs-number\">200</span>:\n                <span class=\"hljs-built_in\">print</span>(proxy,<span class=\"hljs-string\">&apos;\\033[31m&#x53ef;&#x7528;\\033[0m&apos;</span>)\n        <span class=\"hljs-keyword\">except</span> Exception <span class=\"hljs-keyword\">as</span> e:\n            <span class=\"hljs-built_in\">print</span>(proxy,<span class=\"hljs-string\">&apos;&#x4e0d;&#x53ef;&#x7528;&apos;</span>)\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">run</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-variable language_\">self</span>.get_proxy()\n\n<span class=\"hljs-keyword\">if</span> __name__ == <span class=\"hljs-string\">&apos;__main__&apos;</span>:\n    spider = ProxyPool()\n    spider.run()\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"847,888"}},{"content":"<pre data-lines=\"889,907\"><code class=\"language-python\"><span class=\"hljs-string\">&quot;&quot;&quot;\n&#x4f7f;&#x7528;&#x72ec;&#x4eab;&#x4ee3;&#x7406;&#x6765;&#x8bbf;&#x95ee;&#x5df2;&#x7ecf;&#x5c01;&#x6389;&#x7684;&#x897f;&#x523a;&#x4ee3;&#x7406;&#x7f51;&#x7ad9;\n&quot;&quot;&quot;</span>\n<span class=\"hljs-keyword\">import</span> requests\n\nurl = <span class=\"hljs-string\">&apos;https://www.xicidaili.com/&apos;</span>\nheaders = {<span class=\"hljs-string\">&apos;User-Agent&apos;</span>:<span class=\"hljs-string\">&apos;Mozilla/4.0 (compatible; MSIE 8.0; Windows NT 6.1; WOW64; Trident/4.0; SLCC2; .NET CLR 2.0.50727; .NET CLR 3.5.30729; .NET CLR 3.0.30729; Media Center PC 6.0; .NET4.0C; InfoPath.3)&apos;</span>}\nproxies = {\n    <span class=\"hljs-string\">&apos;http&apos;</span> : <span class=\"hljs-string\">&apos;http://309435365:szayclhp@49.7.96.227:16819&apos;</span>,\n    <span class=\"hljs-string\">&apos;https&apos;</span>: <span class=\"hljs-string\">&apos;https://309435365:szayclhp@49.7.96.227:16819&apos;</span>\n}\n\nhtml = requests.get(url=url, proxies=proxies, headers=headers).text\n<span class=\"hljs-built_in\">print</span>(html)\n\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"889,907"}},{"content":"<pre data-lines=\"908,969\"><code class=\"language-python\"><span class=\"hljs-string\">&quot;&quot;&quot;\n&#x6709;&#x9053;&#x7ffb;&#x8bd1;&#x7834;&#x89e3;\n&quot;&quot;&quot;</span>\n\n<span class=\"hljs-keyword\">import</span> requests\n<span class=\"hljs-keyword\">import</span> time\n<span class=\"hljs-keyword\">import</span> random\n<span class=\"hljs-keyword\">from</span> hashlib <span class=\"hljs-keyword\">import</span> md5\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">YdSpider</span>:\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__init__</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-comment\"># url: &#x4e3a;F12&#x6293;&#x5305;&#x6293;&#x5230;&#x7684; POST &#x7684;&#x5730;&#x5740;</span>\n        <span class=\"hljs-variable language_\">self</span>.url = <span class=\"hljs-string\">&apos;http://fanyi.youdao.com/translate_o?smartresult=dict&amp;smartresult=rule&apos;</span>\n        <span class=\"hljs-variable language_\">self</span>.headers = {\n            <span class=\"hljs-comment\"># Cookie&#x3001;Referer&#x3001;User-Agent &#x4e09;&#x4e2a;,&#x662f;&#x7f51;&#x7ad9;&#x68c0;&#x67e5;&#x9891;&#x7387;&#x6700;&#x9ad8;&#x7684;&#x4e09;&#x4e2a;</span>\n            <span class=\"hljs-string\">&quot;Cookie&quot;</span>: <span class=\"hljs-string\">&quot;DICT_UGC=be3af0da19b5c5e6aa4e17bd8d90b28a|; OUTFOX_SEARCH_USER_ID=-1116822587@101.30.19.86; JSESSIONID=abcFhgsjM3GXwcIUyl8dx; OUTFOX_SEARCH_USER_ID_NCOO=627961735.004065; SESSION_FROM_COOKIE=unknown; ___rl__test__cookies=1584782441965&quot;</span>,\n            <span class=\"hljs-string\">&quot;Referer&quot;</span>: <span class=\"hljs-string\">&quot;http://fanyi.youdao.com/&quot;</span>,\n            <span class=\"hljs-string\">&quot;User-Agent&quot;</span>: <span class=\"hljs-string\">&quot;Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36&quot;</span>,\n        }\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">get_ts_salt_sign</span>(<span class=\"hljs-params\">self,word</span>):\n        <span class=\"hljs-comment\"># &#x529f;&#x80fd;&#x51fd;&#x6570;&#xff1a;&#x83b7;&#x53d6; ts + salt + sign</span>\n        ts = <span class=\"hljs-built_in\">str</span>(<span class=\"hljs-built_in\">int</span>(time.time() * <span class=\"hljs-number\">1000</span>))\n        salt = ts + <span class=\"hljs-built_in\">str</span>(random.randint(<span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">9</span>))\n        string = <span class=\"hljs-string\">&quot;fanyideskweb&quot;</span> + word + salt + <span class=\"hljs-string\">&quot;n%A-rKaT5fb[Gy?;N5@Tj&quot;</span>\n        s = md5()\n        s.update(string.encode())\n        sign = s.hexdigest()\n\n        <span class=\"hljs-keyword\">return</span> ts,salt,sign\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">attack_yd</span>(<span class=\"hljs-params\">self,word</span>):\n        ts,salt,sign = <span class=\"hljs-variable language_\">self</span>.get_ts_salt_sign(word)\n        data = {\n            <span class=\"hljs-string\">&quot;i&quot;</span>: word,\n            <span class=\"hljs-string\">&quot;from&quot;</span>: <span class=\"hljs-string\">&quot;AUTO&quot;</span>,\n            <span class=\"hljs-string\">&quot;to&quot;</span>: <span class=\"hljs-string\">&quot;AUTO&quot;</span>,\n            <span class=\"hljs-string\">&quot;smartresult&quot;</span>: <span class=\"hljs-string\">&quot;dict&quot;</span>,\n            <span class=\"hljs-string\">&quot;client&quot;</span>: <span class=\"hljs-string\">&quot;fanyideskweb&quot;</span>,\n            <span class=\"hljs-string\">&quot;salt&quot;</span>: salt,\n            <span class=\"hljs-string\">&quot;sign&quot;</span>: sign,\n            <span class=\"hljs-string\">&quot;ts&quot;</span>: ts,\n            <span class=\"hljs-string\">&quot;bv&quot;</span>: <span class=\"hljs-string\">&quot;82ac0fd3b5f5289bb79af17e1f202a1e&quot;</span>,\n            <span class=\"hljs-string\">&quot;doctype&quot;</span>: <span class=\"hljs-string\">&quot;json&quot;</span>,\n            <span class=\"hljs-string\">&quot;version&quot;</span>: <span class=\"hljs-string\">&quot;2.1&quot;</span>,\n            <span class=\"hljs-string\">&quot;keyfrom&quot;</span>: <span class=\"hljs-string\">&quot;fanyi.web&quot;</span>,\n            <span class=\"hljs-string\">&quot;action&quot;</span>: <span class=\"hljs-string\">&quot;FY_BY_REALTlME&quot;</span>,\n        }\n        html = requests.post(url=<span class=\"hljs-variable language_\">self</span>.url, data=data, headers=<span class=\"hljs-variable language_\">self</span>.headers).text\n        <span class=\"hljs-built_in\">print</span>(html)\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">run</span>(<span class=\"hljs-params\">self</span>):\n        word = <span class=\"hljs-built_in\">input</span>(<span class=\"hljs-string\">&apos;&#x8bf7;&#x8f93;&#x5165;&#x8981;&#x7ffb;&#x8bd1;&#x7684;&#x5355;&#x8bcd;:&apos;</span>)\n        <span class=\"hljs-variable language_\">self</span>.attack_yd(word)\n\n<span class=\"hljs-keyword\">if</span> __name__ == <span class=\"hljs-string\">&apos;__main__&apos;</span>:\n    spider = YdSpider()\n    spider.run()\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"908,969"}}],"payload":{"tag":"h3","lines":"614,615"}}],"payload":{"tag":"h2","lines":"594,595"}}],"payload":{"tag":"h1","lines":"143,144"}}]},{})</script>
</body>
</html>
