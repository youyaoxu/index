<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>
<link rel="stylesheet" href="https://unpkg.com/markmap-toolbar@0.18.10/dist/style.css"><link rel="stylesheet" href="https://unpkg.com/@highlightjs/cdn-assets@11.11.1/styles/default.min.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://unpkg.com/d3@7.9.0/dist/d3.min.js"></script><script src="https://unpkg.com/markmap-view@0.18.10/dist/browser/index.js"></script><script src="https://unpkg.com/markmap-toolbar@0.18.10/dist/index.js"></script><script>(r => {
              setTimeout(r);
            })(function renderToolbar() {
  const {
    markmap,
    mm
  } = window;
  const {
    el
  } = markmap.Toolbar.create(mm);
  el.setAttribute('style', 'position:absolute;bottom:20px;right:20px');
  document.body.append(el);
})</script><script>((getMarkmap, getOptions, root2, jsonOptions) => {
              const markmap = getMarkmap();
              window.mm = markmap.Markmap.create(
                "svg#mindmap",
                (getOptions || markmap.deriveOptions)(jsonOptions),
                root2
              );
            })(() => window.markmap,null,{"content":"[&#x8bf7;&#x6c42;]-B&#x7aef;&#x5c01;&#x88c5;","children":[{"content":"<pre data-lines=\"2,159\"><code class=\"language-js\"><span class=\"hljs-keyword\">import</span> axios <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&apos;axios&apos;</span>\n<span class=\"hljs-keyword\">import</span> {  <span class=\"hljs-title class_\">MessageBox</span>, <span class=\"hljs-title class_\">Message</span> } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&apos;element-ui&apos;</span>\n<span class=\"hljs-keyword\">import</span> { getToken } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&apos;@/utils/auth&apos;</span>\n<span class=\"hljs-comment\">// import errorCode from &apos;@/utils/errorCode&apos;</span>\n<span class=\"hljs-keyword\">import</span> { tansParams } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&apos;@/utils/dia&apos;</span>\n\naxios.<span class=\"hljs-property\">defaults</span>.<span class=\"hljs-property\">headers</span>[<span class=\"hljs-string\">&apos;Content-Type&apos;</span>] = <span class=\"hljs-string\">&apos;application/json;charset=utf-8&apos;</span>\n<span class=\"hljs-comment\">// &#x521b;&#x5efa;axios&#x5b9e;&#x4f8b;</span>\n<span class=\"hljs-keyword\">const</span> service = axios.<span class=\"hljs-title function_\">create</span>({\n  <span class=\"hljs-comment\">// axios&#x4e2d;&#x8bf7;&#x6c42;&#x914d;&#x7f6e;&#x6709;baseURL&#x9009;&#x9879;&#xff0c;&#x8868;&#x793a;&#x8bf7;&#x6c42;URL&#x516c;&#x5171;&#x90e8;&#x5206;</span>\n  <span class=\"hljs-comment\">// baseURL: process.env.VUE_APP_BASE_API,</span>\n  <span class=\"hljs-attr\">baseURL</span>: <span class=\"hljs-string\">`https://dev-dia.diact.com/`</span>+process.<span class=\"hljs-property\">env</span>.<span class=\"hljs-property\">VUE_APP_BASE_API</span>,\n\n  <span class=\"hljs-comment\">// &#x8d85;&#x65f6;</span>\n  <span class=\"hljs-attr\">timeout</span>: <span class=\"hljs-number\">30000</span>\n})\n\n<span class=\"hljs-comment\">// request&#x62e6;&#x622a;&#x5668;</span>\nservice.<span class=\"hljs-property\">interceptors</span>.<span class=\"hljs-property\">request</span>.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-function\"><span class=\"hljs-params\">config</span> =&gt;</span> {\n  <span class=\"hljs-comment\">// &#x662f;&#x5426;&#x9700;&#x8981;&#x8bbe;&#x7f6e; token</span>\n  <span class=\"hljs-keyword\">const</span> isToken = (config.<span class=\"hljs-property\">headers</span> || {}).<span class=\"hljs-property\">isToken</span> === <span class=\"hljs-literal\">false</span>\n  <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-title function_\">getToken</span>() &amp;&amp; !isToken) {\n    config.<span class=\"hljs-property\">headers</span>[<span class=\"hljs-string\">&apos;Authorization&apos;</span>] = <span class=\"hljs-string\">&apos;Bearer &apos;</span> + <span class=\"hljs-title function_\">getToken</span>() <span class=\"hljs-comment\">// &#x8ba9;&#x6bcf;&#x4e2a;&#x8bf7;&#x6c42;&#x643a;&#x5e26;&#x81ea;&#x5b9a;&#x4e49;token &#x8bf7;&#x6839;&#x636e;&#x5b9e;&#x9645;&#x60c5;&#x51b5;&#x81ea;&#x884c;&#x4fee;&#x6539;</span>\n  }\n\n  <span class=\"hljs-comment\">// &#x6307;&#x5b9a;&#x5e73;&#x53f0;/&#x79df;&#x6237;</span>\n  <span class=\"hljs-keyword\">const</span> <span class=\"hljs-variable constant_\">TENANT</span> = process.<span class=\"hljs-property\">env</span>.<span class=\"hljs-property\">VUE_APP_TENANT</span>\n  <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-variable constant_\">TENANT</span> &amp;&amp; <span class=\"hljs-variable constant_\">TENANT</span> !== <span class=\"hljs-string\">&apos;&apos;</span>) {\n    config.<span class=\"hljs-property\">headers</span>[<span class=\"hljs-string\">&apos;tenant&apos;</span>] = <span class=\"hljs-variable constant_\">TENANT</span>\n  }\n\n  <span class=\"hljs-comment\">// // &#x5fae;&#x4fe1;&#x516c;&#x4f17;&#x53f7;&#x8fc1;&#x79fb;&#x8c03;&#x8bd5;</span>\n  <span class=\"hljs-comment\">// if (config.url.indexOf(&apos;/reach/manage&apos;) &gt; -1) {</span>\n  <span class=\"hljs-comment\">//   config.headers[&apos;Authorization&apos;] = &apos;Bearer 232a720c-ad8a-4828-a972-5c8d2db7abd1&apos;</span>\n  <span class=\"hljs-comment\">// }</span>\n  <span class=\"hljs-comment\">// config.headers[&apos;token&apos;] = &apos;63eb4bac733c0871410b183bcb8e1792&apos;</span>\n\n  <span class=\"hljs-comment\">// get&#x8bf7;&#x6c42;&#x6620;&#x5c04;params&#x53c2;&#x6570;</span>\n  <span class=\"hljs-keyword\">if</span> (config.<span class=\"hljs-property\">method</span> === <span class=\"hljs-string\">&apos;get&apos;</span> &amp;&amp; config.<span class=\"hljs-property\">params</span>) {\n    <span class=\"hljs-keyword\">let</span> url = config.<span class=\"hljs-property\">url</span> + <span class=\"hljs-string\">&apos;?&apos;</span>\n    <span class=\"hljs-keyword\">for</span> (<span class=\"hljs-keyword\">const</span> propName <span class=\"hljs-keyword\">of</span> <span class=\"hljs-title class_\">Object</span>.<span class=\"hljs-title function_\">keys</span>(config.<span class=\"hljs-property\">params</span>)) {\n      <span class=\"hljs-keyword\">const</span> value = config.<span class=\"hljs-property\">params</span>[propName]\n      <span class=\"hljs-keyword\">var</span> part = <span class=\"hljs-built_in\">encodeURIComponent</span>(propName) + <span class=\"hljs-string\">&apos;=&apos;</span>\n      <span class=\"hljs-keyword\">if</span> (value !== <span class=\"hljs-literal\">null</span> &amp;&amp; <span class=\"hljs-title function_\">typeof</span> (value) !== <span class=\"hljs-string\">&apos;undefined&apos;</span>) {\n        <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-keyword\">typeof</span> value === <span class=\"hljs-string\">&apos;object&apos;</span>) {\n          <span class=\"hljs-keyword\">for</span> (<span class=\"hljs-keyword\">const</span> key <span class=\"hljs-keyword\">of</span> <span class=\"hljs-title class_\">Object</span>.<span class=\"hljs-title function_\">keys</span>(value)) {\n            <span class=\"hljs-keyword\">const</span> params = propName + <span class=\"hljs-string\">&apos;[&apos;</span> + key + <span class=\"hljs-string\">&apos;]&apos;</span>\n            <span class=\"hljs-keyword\">var</span> subPart = <span class=\"hljs-built_in\">encodeURIComponent</span>(params) + <span class=\"hljs-string\">&apos;=&apos;</span>\n            url += subPart + <span class=\"hljs-built_in\">encodeURIComponent</span>(value[key]) + <span class=\"hljs-string\">&apos;&amp;&apos;</span>\n          }\n        } <span class=\"hljs-keyword\">else</span> {\n          url += part + <span class=\"hljs-built_in\">encodeURIComponent</span>(value) + <span class=\"hljs-string\">&apos;&amp;&apos;</span>\n        }\n      }\n    }\n    url = url.<span class=\"hljs-title function_\">slice</span>(<span class=\"hljs-number\">0</span>, -<span class=\"hljs-number\">1</span>)\n    config.<span class=\"hljs-property\">params</span> = {}\n    config.<span class=\"hljs-property\">url</span> = url\n  }\n  <span class=\"hljs-keyword\">return</span> config\n}, <span class=\"hljs-function\"><span class=\"hljs-params\">error</span> =&gt;</span> {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(error)\n  <span class=\"hljs-title class_\">Promise</span>.<span class=\"hljs-title function_\">reject</span>(error)\n})\n\n<span class=\"hljs-comment\">// &#x54cd;&#x5e94;&#x62e6;&#x622a;&#x5668;</span>\nservice.<span class=\"hljs-property\">interceptors</span>.<span class=\"hljs-property\">response</span>.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-function\"><span class=\"hljs-params\">res</span> =&gt;</span> {\n  <span class=\"hljs-comment\">// &#x672a;&#x8bbe;&#x7f6e;&#x72b6;&#x6001;&#x7801;&#x5219;&#x9ed8;&#x8ba4;&#x6210;&#x529f;&#x72b6;&#x6001;</span>\n  <span class=\"hljs-keyword\">const</span> code = res.<span class=\"hljs-property\">data</span>.<span class=\"hljs-property\">code</span> || <span class=\"hljs-number\">200</span>\n  <span class=\"hljs-comment\">// &#x83b7;&#x53d6;&#x9519;&#x8bef;&#x4fe1;&#x606f;</span>\n  <span class=\"hljs-comment\">// const msg = errorCode[code] || res.data.msg || res.data.message || errorCode[&apos;default&apos;]</span>\n  <span class=\"hljs-keyword\">if</span> (code === <span class=\"hljs-number\">401</span>) {\n    <span class=\"hljs-title class_\">MessageBox</span>.<span class=\"hljs-title function_\">confirm</span>(<span class=\"hljs-string\">&apos;&#x767b;&#x5f55;&#x72b6;&#x6001;&#x5df2;&#x8fc7;&#x671f;&#xff0c;&#x60a8;&#x53ef;&#x4ee5;&#x7ee7;&#x7eed;&#x7559;&#x5728;&#x8be5;&#x9875;&#x9762;&#xff0c;&#x6216;&#x8005;&#x91cd;&#x65b0;&#x767b;&#x5f55;&apos;</span>, <span class=\"hljs-string\">&apos;&#x7cfb;&#x7edf;&#x63d0;&#x793a;&apos;</span>, {\n      <span class=\"hljs-attr\">confirmButtonText</span>: <span class=\"hljs-string\">&apos;&#x91cd;&#x65b0;&#x767b;&#x5f55;&apos;</span>,\n      <span class=\"hljs-attr\">cancelButtonText</span>: <span class=\"hljs-string\">&apos;&#x53d6;&#x6d88;&apos;</span>,\n      <span class=\"hljs-attr\">type</span>: <span class=\"hljs-string\">&apos;warning&apos;</span>\n    }\n    ).<span class=\"hljs-title function_\">then</span>(<span class=\"hljs-function\">() =&gt;</span> {\n      location.<span class=\"hljs-property\">href</span> = <span class=\"hljs-string\">&apos;/&apos;</span>\n    })\n  } <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span> (code === <span class=\"hljs-number\">500</span>) {\n\n    <span class=\"hljs-comment\">// let tempMsg = msg.split(&apos;:&apos;)[0] || msg</span>\n    <span class=\"hljs-comment\">// if(tempMsg !== &apos;&#x7ec4;&#x5408;&#x6295;&#x653e;-&#x4e0a;&#x4f20;&#x5ba2;&#x6237;&#x4fe1;&#x606f;-&#x4e0a;&#x4f20;&#x5ba2;&#x6237;&#x4fe1;&#x606f;&#x4e2d;&#x5b58;&#x5728;&#x975e;&#x6cd5;&#x7528;&#x6237;&#xff08;&#x7cfb;&#x7edf;&#x4e2d;&#x4e0d;&#x5b58;&#x5728;&#x7684;&#x5ba2;&#x6237;&#xff09;&#xff0c;&#x8bf7;&#x68c0;&#x67e5;&#x4e0a;&#x4f20;&#x4fe1;&#x606f;&#xff01;&apos; &amp;&amp; tempMsg != &apos;&#x7ec4;&#x5408;&#x6295;&#x653e;-&#x4fdd;&#x5b58;&#x7ec4;&#x5408;&#x6295;&#x653e;-&#x4e8b;&#x4ef6;&#x5df2;&#x88ab;&#x4f7f;&#x7528;&#x4e0d;&#x80fd;&#x5220;&#x9664;&apos;){</span>\n    <span class=\"hljs-comment\">//   Message({</span>\n    <span class=\"hljs-comment\">//     message: msg,</span>\n    <span class=\"hljs-comment\">//     type: &apos;error&apos;</span>\n    <span class=\"hljs-comment\">//   })</span>\n\n    <span class=\"hljs-comment\">// }</span>\n    <span class=\"hljs-comment\">// return Promise.reject(new Error(msg))</span>\n    <span class=\"hljs-keyword\">return</span> res.<span class=\"hljs-property\">data</span>\n  }\n  <span class=\"hljs-comment\">// else if (code !== 200) {</span>\n  <span class=\"hljs-comment\">//   Notification.error({</span>\n  <span class=\"hljs-comment\">//     title: msg</span>\n  <span class=\"hljs-comment\">//   })</span>\n  <span class=\"hljs-comment\">//   return Promise.reject(&apos;error&apos;)</span>\n  <span class=\"hljs-comment\">// }</span>\n  <span class=\"hljs-keyword\">else</span> {\n    <span class=\"hljs-keyword\">return</span> res.<span class=\"hljs-property\">data</span>\n  }\n},\n<span class=\"hljs-function\"><span class=\"hljs-params\">error</span> =&gt;</span> {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;err&apos;</span> + error)\n  <span class=\"hljs-keyword\">let</span> { message } = error\n  <span class=\"hljs-keyword\">if</span> (message === <span class=\"hljs-string\">&apos;Network Error&apos;</span>) {\n    message = <span class=\"hljs-string\">&apos;&#x540e;&#x7aef;&#x63a5;&#x53e3;&#x8fde;&#x63a5;&#x5f02;&#x5e38;&apos;</span>\n  } <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span> (message.<span class=\"hljs-title function_\">includes</span>(<span class=\"hljs-string\">&apos;timeout&apos;</span>)) {\n    message = <span class=\"hljs-string\">&apos;&#x7cfb;&#x7edf;&#x63a5;&#x53e3;&#x8bf7;&#x6c42;&#x8d85;&#x65f6;&apos;</span>\n  } <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span> (message.<span class=\"hljs-title function_\">includes</span>(<span class=\"hljs-string\">&apos;Request failed with status code&apos;</span>)) {\n    message = <span class=\"hljs-string\">&apos;&#x7cfb;&#x7edf;&#x63a5;&#x53e3;&apos;</span> + message.<span class=\"hljs-title function_\">substr</span>(message.<span class=\"hljs-property\">length</span> - <span class=\"hljs-number\">3</span>) + <span class=\"hljs-string\">&apos;&#x5f02;&#x5e38;&apos;</span>\n  }\n  <span class=\"hljs-title class_\">Message</span>({\n    <span class=\"hljs-attr\">message</span>: message,\n    <span class=\"hljs-attr\">type</span>: <span class=\"hljs-string\">&apos;error&apos;</span>,\n    <span class=\"hljs-attr\">duration</span>: <span class=\"hljs-number\">5</span> * <span class=\"hljs-number\">1000</span>\n  })\n  <span class=\"hljs-keyword\">return</span> <span class=\"hljs-title class_\">Promise</span>.<span class=\"hljs-title function_\">reject</span>(error)\n}\n)\n\n<span class=\"hljs-comment\">// &#x901a;&#x7528;&#x4e0b;&#x8f7d;&#x65b9;&#x6cd5;</span>\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">download</span>(<span class=\"hljs-params\">url, params, filename</span>) {\n  <span class=\"hljs-keyword\">return</span> service.<span class=\"hljs-title function_\">post</span>(url, params, {\n    <span class=\"hljs-attr\">transformRequest</span>: [<span class=\"hljs-function\">(<span class=\"hljs-params\">params</span>) =&gt;</span> {\n      <span class=\"hljs-keyword\">return</span> <span class=\"hljs-title function_\">tansParams</span>(params)\n    }],\n    <span class=\"hljs-attr\">headers</span>: {\n      <span class=\"hljs-string\">&apos;Content-Type&apos;</span>: <span class=\"hljs-string\">&apos;application/x-www-form-urlencoded&apos;</span>\n    },\n    <span class=\"hljs-attr\">responseType</span>: <span class=\"hljs-string\">&apos;blob&apos;</span>\n  }).<span class=\"hljs-title function_\">then</span>(<span class=\"hljs-function\">(<span class=\"hljs-params\">data</span>) =&gt;</span> {\n    <span class=\"hljs-keyword\">const</span> content = data\n    <span class=\"hljs-keyword\">const</span> blob = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Blob</span>([<span class=\"hljs-string\">&apos;\\ufeff&apos;</span> + content])\n    <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-string\">&apos;download&apos;</span> <span class=\"hljs-keyword\">in</span> <span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-title function_\">createElement</span>(<span class=\"hljs-string\">&apos;a&apos;</span>)) {\n      <span class=\"hljs-keyword\">const</span> elink = <span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-title function_\">createElement</span>(<span class=\"hljs-string\">&apos;a&apos;</span>)\n      elink.<span class=\"hljs-property\">download</span> = filename\n      elink.<span class=\"hljs-property\">style</span>.<span class=\"hljs-property\">display</span> = <span class=\"hljs-string\">&apos;none&apos;</span>\n      elink.<span class=\"hljs-property\">href</span> = <span class=\"hljs-variable constant_\">URL</span>.<span class=\"hljs-title function_\">createObjectURL</span>(blob)\n      <span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-property\">body</span>.<span class=\"hljs-title function_\">appendChild</span>(elink)\n      elink.<span class=\"hljs-title function_\">click</span>()\n      <span class=\"hljs-variable constant_\">URL</span>.<span class=\"hljs-title function_\">revokeObjectURL</span>(elink.<span class=\"hljs-property\">href</span>)\n      <span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-property\">body</span>.<span class=\"hljs-title function_\">removeChild</span>(elink)\n    } <span class=\"hljs-keyword\">else</span> {\n      navigator.<span class=\"hljs-title function_\">msSaveBlob</span>(blob, filename)\n    }\n  }).<span class=\"hljs-title function_\">catch</span>(<span class=\"hljs-function\">(<span class=\"hljs-params\">r</span>) =&gt;</span> {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">error</span>(r)\n  })\n}\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">default</span> service\n\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2,159"}}],"payload":{"tag":"h1","lines":"0,1"}},{})</script>
</body>
</html>
