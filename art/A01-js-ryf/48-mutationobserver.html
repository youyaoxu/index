<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>
<link rel="stylesheet" href="https://unpkg.com/markmap-toolbar@0.18.10/dist/style.css"><link rel="stylesheet" href="https://unpkg.com/@highlightjs/cdn-assets@11.11.1/styles/default.min.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://unpkg.com/d3@7.9.0/dist/d3.min.js"></script><script src="https://unpkg.com/markmap-view@0.18.10/dist/browser/index.js"></script><script src="https://unpkg.com/markmap-toolbar@0.18.10/dist/index.js"></script><script>(r => {
              setTimeout(r);
            })(function renderToolbar() {
  const {
    markmap,
    mm
  } = window;
  const {
    el
  } = markmap.Toolbar.create(mm);
  el.setAttribute('style', 'position:absolute;bottom:20px;right:20px');
  document.body.append(el);
})</script><script>((getMarkmap, getOptions, root2, jsonOptions) => {
              const markmap = getMarkmap();
              window.mm = markmap.Markmap.create(
                "svg#mindmap",
                (getOptions || markmap.deriveOptions)(jsonOptions),
                root2
              );
            })(() => window.markmap,null,{"content":"Mutation Observer API","children":[{"content":"&#x6982;&#x8ff0;","children":[{"content":"<pre data-lines=\"4,15\"><code>Mutation Observer API &#x7528;&#x6765;&#x76d1;&#x89c6; DOM &#x53d8;&#x52a8;&#x3002;DOM &#x7684;&#x4efb;&#x4f55;&#x53d8;&#x52a8;&#xff0c;&#x6bd4;&#x5982;&#x8282;&#x70b9;&#x7684;&#x589e;&#x51cf;&#x3001;&#x5c5e;&#x6027;&#x7684;&#x53d8;&#x52a8;&#x3001;&#x6587;&#x672c;&#x5185;&#x5bb9;&#x7684;&#x53d8;&#x52a8;&#xff0c;&#x8fd9;&#x4e2a; API &#x90fd;&#x53ef;&#x4ee5;&#x5f97;&#x5230;&#x901a;&#x77e5;&#x3002;\n\n&#x6982;&#x5ff5;&#x4e0a;&#xff0c;&#x5b83;&#x5f88;&#x63a5;&#x8fd1;&#x4e8b;&#x4ef6;&#xff0c;&#x53ef;&#x4ee5;&#x7406;&#x89e3;&#x4e3a; DOM &#x53d1;&#x751f;&#x53d8;&#x52a8;&#x5c31;&#x4f1a;&#x89e6;&#x53d1; Mutation Observer &#x4e8b;&#x4ef6;&#x3002;&#x4f46;&#x662f;&#xff0c;&#x5b83;&#x4e0e;&#x4e8b;&#x4ef6;&#x6709;&#x4e00;&#x4e2a;&#x672c;&#x8d28;&#x4e0d;&#x540c;&#xff1a;&#x4e8b;&#x4ef6;&#x662f;&#x540c;&#x6b65;&#x89e6;&#x53d1;&#xff0c;&#x4e5f;&#x5c31;&#x662f;&#x8bf4;&#xff0c;DOM &#x7684;&#x53d8;&#x52a8;&#x7acb;&#x523b;&#x4f1a;&#x89e6;&#x53d1;&#x76f8;&#x5e94;&#x7684;&#x4e8b;&#x4ef6;&#xff1b;Mutation Observer &#x5219;&#x662f;&#x5f02;&#x6b65;&#x89e6;&#x53d1;&#xff0c;DOM &#x7684;&#x53d8;&#x52a8;&#x5e76;&#x4e0d;&#x4f1a;&#x9a6c;&#x4e0a;&#x89e6;&#x53d1;&#xff0c;&#x800c;&#x662f;&#x8981;&#x7b49;&#x5230;&#x5f53;&#x524d;&#x6240;&#x6709; DOM &#x64cd;&#x4f5c;&#x90fd;&#x7ed3;&#x675f;&#x624d;&#x89e6;&#x53d1;&#x3002;\n\n&#x8fd9;&#x6837;&#x8bbe;&#x8ba1;&#x662f;&#x4e3a;&#x4e86;&#x5e94;&#x4ed8; DOM &#x53d8;&#x52a8;&#x9891;&#x7e41;&#x7684;&#x7279;&#x70b9;&#x3002;&#x4e3e;&#x4f8b;&#x6765;&#x8bf4;&#xff0c;&#x5982;&#x679c;&#x6587;&#x6863;&#x4e2d;&#x8fde;&#x7eed;&#x63d2;&#x5165;1000&#x4e2a;`&lt;p&gt;`&#x5143;&#x7d20;&#xff0c;&#x5c31;&#x4f1a;&#x8fde;&#x7eed;&#x89e6;&#x53d1;1000&#x4e2a;&#x63d2;&#x5165;&#x4e8b;&#x4ef6;&#xff0c;&#x6267;&#x884c;&#x6bcf;&#x4e2a;&#x4e8b;&#x4ef6;&#x7684;&#x56de;&#x8c03;&#x51fd;&#x6570;&#xff0c;&#x8fd9;&#x5f88;&#x53ef;&#x80fd;&#x9020;&#x6210;&#x6d4f;&#x89c8;&#x5668;&#x7684;&#x5361;&#x987f;&#xff1b;&#x800c; Mutation Observer &#x5b8c;&#x5168;&#x4e0d;&#x540c;&#xff0c;&#x53ea;&#x5728;1000&#x4e2a;&#x6bb5;&#x843d;&#x90fd;&#x63d2;&#x5165;&#x7ed3;&#x675f;&#x540e;&#x624d;&#x4f1a;&#x89e6;&#x53d1;&#xff0c;&#x800c;&#x4e14;&#x53ea;&#x89e6;&#x53d1;&#x4e00;&#x6b21;&#x3002;\n\nMutation Observer &#x6709;&#x4ee5;&#x4e0b;&#x7279;&#x70b9;&#x3002;\n\n- &#x5b83;&#x7b49;&#x5f85;&#x6240;&#x6709;&#x811a;&#x672c;&#x4efb;&#x52a1;&#x5b8c;&#x6210;&#x540e;&#xff0c;&#x624d;&#x4f1a;&#x8fd0;&#x884c;&#xff08;&#x5373;&#x5f02;&#x6b65;&#x89e6;&#x53d1;&#x65b9;&#x5f0f;&#xff09;&#x3002;\n- &#x5b83;&#x628a; DOM &#x53d8;&#x52a8;&#x8bb0;&#x5f55;&#x5c01;&#x88c5;&#x6210;&#x4e00;&#x4e2a;&#x6570;&#x7ec4;&#x8fdb;&#x884c;&#x5904;&#x7406;&#xff0c;&#x800c;&#x4e0d;&#x662f;&#x4e00;&#x6761;&#x6761;&#x4e2a;&#x522b;&#x5904;&#x7406; DOM &#x53d8;&#x52a8;&#x3002;\n- &#x5b83;&#x65e2;&#x53ef;&#x4ee5;&#x89c2;&#x5bdf; DOM &#x7684;&#x6240;&#x6709;&#x7c7b;&#x578b;&#x53d8;&#x52a8;&#xff0c;&#x4e5f;&#x53ef;&#x4ee5;&#x6307;&#x5b9a;&#x53ea;&#x89c2;&#x5bdf;&#x67d0;&#x4e00;&#x7c7b;&#x53d8;&#x52a8;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"4,15"}}],"payload":{"tag":"h2","lines":"2,3"}},{"content":"MutationObserver &#x6784;&#x9020;&#x51fd;&#x6570;","children":[{"content":"<pre data-lines=\"18,19\"><code>&#x4f7f;&#x7528;&#x65f6;&#xff0c;&#x9996;&#x5148;&#x4f7f;&#x7528;`MutationObserver`&#x6784;&#x9020;&#x51fd;&#x6570;&#xff0c;&#x65b0;&#x5efa;&#x4e00;&#x4e2a;&#x89c2;&#x5bdf;&#x5668;&#x5b9e;&#x4f8b;&#xff0c;&#x540c;&#x65f6;&#x6307;&#x5b9a;&#x8fd9;&#x4e2a;&#x5b9e;&#x4f8b;&#x7684;&#x56de;&#x8c03;&#x51fd;&#x6570;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"18,19"}},{"content":"<pre data-lines=\"20,23\"><code class=\"language-javascript\"><span class=\"hljs-keyword\">var</span> observer = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">MutationObserver</span>(callback);\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"20,23"}},{"content":"<pre data-lines=\"24,25\"><code>&#x4e0a;&#x9762;&#x4ee3;&#x7801;&#x4e2d;&#x7684;&#x56de;&#x8c03;&#x51fd;&#x6570;&#xff0c;&#x4f1a;&#x5728;&#x6bcf;&#x6b21; DOM &#x53d8;&#x52a8;&#x540e;&#x8c03;&#x7528;&#x3002;&#x8be5;&#x56de;&#x8c03;&#x51fd;&#x6570;&#x63a5;&#x53d7;&#x4e24;&#x4e2a;&#x53c2;&#x6570;&#xff0c;&#x7b2c;&#x4e00;&#x4e2a;&#x662f;&#x53d8;&#x52a8;&#x6570;&#x7ec4;&#xff0c;&#x7b2c;&#x4e8c;&#x4e2a;&#x662f;&#x89c2;&#x5bdf;&#x5668;&#x5b9e;&#x4f8b;&#xff0c;&#x4e0b;&#x9762;&#x662f;&#x4e00;&#x4e2a;&#x4f8b;&#x5b50;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"24,25"}},{"content":"<pre data-lines=\"26,33\"><code class=\"language-javascript\"><span class=\"hljs-keyword\">var</span> observer = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">MutationObserver</span>(<span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">mutations, observer</span>) {\n  mutations.<span class=\"hljs-title function_\">forEach</span>(<span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">mutation</span>) {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(mutation);\n  });\n});\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"26,33"}}],"payload":{"tag":"h2","lines":"16,17"}},{"content":"MutationObserver &#x7684;&#x5b9e;&#x4f8b;&#x65b9;&#x6cd5;","children":[{"content":"observe()","children":[{"content":"<pre data-lines=\"38,42\"><code>`observe`&#x65b9;&#x6cd5;&#x7528;&#x6765;&#x542f;&#x52a8;&#x76d1;&#x542c;&#xff0c;&#x5b83;&#x63a5;&#x53d7;&#x4e24;&#x4e2a;&#x53c2;&#x6570;&#x3002;\n\n- &#x7b2c;&#x4e00;&#x4e2a;&#x53c2;&#x6570;&#xff1a;&#x6240;&#x8981;&#x89c2;&#x5bdf;&#x7684; DOM &#x8282;&#x70b9;\n- &#x7b2c;&#x4e8c;&#x4e2a;&#x53c2;&#x6570;&#xff1a;&#x4e00;&#x4e2a;&#x914d;&#x7f6e;&#x5bf9;&#x8c61;&#xff0c;&#x6307;&#x5b9a;&#x6240;&#x8981;&#x89c2;&#x5bdf;&#x7684;&#x7279;&#x5b9a;&#x53d8;&#x52a8;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"38,42"}},{"content":"<pre data-lines=\"43,53\"><code class=\"language-javascript\"><span class=\"hljs-keyword\">var</span> article = <span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-title function_\">querySelector</span>(<span class=\"hljs-string\">&apos;article&apos;</span>);\n\n<span class=\"hljs-keyword\">var</span>  options = {\n  <span class=\"hljs-string\">&apos;childList&apos;</span>: <span class=\"hljs-literal\">true</span>,\n  <span class=\"hljs-string\">&apos;attributes&apos;</span>:<span class=\"hljs-literal\">true</span>\n} ;\n\nobserver.<span class=\"hljs-title function_\">observe</span>(article, options);\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"43,53"}},{"content":"<pre data-lines=\"54,70\"><code>&#x4e0a;&#x9762;&#x4ee3;&#x7801;&#x4e2d;&#xff0c;`observe`&#x65b9;&#x6cd5;&#x63a5;&#x53d7;&#x4e24;&#x4e2a;&#x53c2;&#x6570;&#xff0c;&#x7b2c;&#x4e00;&#x4e2a;&#x662f;&#x6240;&#x8981;&#x89c2;&#x5bdf;&#x7684;DOM&#x5143;&#x7d20;&#x662f;`article`&#xff0c;&#x7b2c;&#x4e8c;&#x4e2a;&#x662f;&#x6240;&#x8981;&#x89c2;&#x5bdf;&#x7684;&#x53d8;&#x52a8;&#x7c7b;&#x578b;&#xff08;&#x5b50;&#x8282;&#x70b9;&#x53d8;&#x52a8;&#x548c;&#x5c5e;&#x6027;&#x53d8;&#x52a8;&#xff09;&#x3002;\n\n&#x89c2;&#x5bdf;&#x5668;&#x6240;&#x80fd;&#x89c2;&#x5bdf;&#x7684; DOM &#x53d8;&#x52a8;&#x7c7b;&#x578b;&#xff08;&#x5373;&#x4e0a;&#x9762;&#x4ee3;&#x7801;&#x7684;`options`&#x5bf9;&#x8c61;&#xff09;&#xff0c;&#x6709;&#x4ee5;&#x4e0b;&#x51e0;&#x79cd;&#x3002;\n\n- **childList**&#xff1a;&#x5b50;&#x8282;&#x70b9;&#x7684;&#x53d8;&#x52a8;&#xff08;&#x6307;&#x65b0;&#x589e;&#xff0c;&#x5220;&#x9664;&#x6216;&#x8005;&#x66f4;&#x6539;&#xff09;&#x3002;\n- **attributes**&#xff1a;&#x5c5e;&#x6027;&#x7684;&#x53d8;&#x52a8;&#x3002;\n- **characterData**&#xff1a;&#x8282;&#x70b9;&#x5185;&#x5bb9;&#x6216;&#x8282;&#x70b9;&#x6587;&#x672c;&#x7684;&#x53d8;&#x52a8;&#x3002;\n\n&#x60f3;&#x8981;&#x89c2;&#x5bdf;&#x54ea;&#x4e00;&#x79cd;&#x53d8;&#x52a8;&#x7c7b;&#x578b;&#xff0c;&#x5c31;&#x5728;`option`&#x5bf9;&#x8c61;&#x4e2d;&#x6307;&#x5b9a;&#x5b83;&#x7684;&#x503c;&#x4e3a;`true`&#x3002;&#x9700;&#x8981;&#x6ce8;&#x610f;&#x7684;&#x662f;&#xff0c;&#x81f3;&#x5c11;&#x5fc5;&#x987b;&#x540c;&#x65f6;&#x6307;&#x5b9a;&#x8fd9;&#x4e09;&#x79cd;&#x89c2;&#x5bdf;&#x7684;&#x4e00;&#x79cd;&#xff0c;&#x82e5;&#x5747;&#x672a;&#x6307;&#x5b9a;&#x5c06;&#x62a5;&#x9519;&#x3002;\n\n&#x9664;&#x4e86;&#x53d8;&#x52a8;&#x7c7b;&#x578b;&#xff0c;`options`&#x5bf9;&#x8c61;&#x8fd8;&#x53ef;&#x4ee5;&#x8bbe;&#x5b9a;&#x4ee5;&#x4e0b;&#x5c5e;&#x6027;&#xff1a;\n\n- `subtree`&#xff1a;&#x5e03;&#x5c14;&#x503c;&#xff0c;&#x8868;&#x793a;&#x662f;&#x5426;&#x5c06;&#x8be5;&#x89c2;&#x5bdf;&#x5668;&#x5e94;&#x7528;&#x4e8e;&#x8be5;&#x8282;&#x70b9;&#x7684;&#x6240;&#x6709;&#x540e;&#x4ee3;&#x8282;&#x70b9;&#x3002;\n- `attributeOldValue`&#xff1a;&#x5e03;&#x5c14;&#x503c;&#xff0c;&#x8868;&#x793a;&#x89c2;&#x5bdf;`attributes`&#x53d8;&#x52a8;&#x65f6;&#xff0c;&#x662f;&#x5426;&#x9700;&#x8981;&#x8bb0;&#x5f55;&#x53d8;&#x52a8;&#x524d;&#x7684;&#x5c5e;&#x6027;&#x503c;&#x3002;\n- `characterDataOldValue`&#xff1a;&#x5e03;&#x5c14;&#x503c;&#xff0c;&#x8868;&#x793a;&#x89c2;&#x5bdf;`characterData`&#x53d8;&#x52a8;&#x65f6;&#xff0c;&#x662f;&#x5426;&#x9700;&#x8981;&#x8bb0;&#x5f55;&#x53d8;&#x52a8;&#x524d;&#x7684;&#x503c;&#x3002;\n- `attributeFilter`&#xff1a;&#x6570;&#x7ec4;&#xff0c;&#x8868;&#x793a;&#x9700;&#x8981;&#x89c2;&#x5bdf;&#x7684;&#x7279;&#x5b9a;&#x5c5e;&#x6027;&#xff08;&#x6bd4;&#x5982;`[&apos;class&apos;,&apos;src&apos;]`&#xff09;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"54,70"}},{"content":"<pre data-lines=\"71,82\"><code class=\"language-javascript\"><span class=\"hljs-comment\">// &#x5f00;&#x59cb;&#x76d1;&#x542c;&#x6587;&#x6863;&#x6839;&#x8282;&#x70b9;&#xff08;&#x5373;&lt;html&gt;&#x6807;&#x7b7e;&#xff09;&#x7684;&#x53d8;&#x52a8;</span>\nmutationObserver.<span class=\"hljs-title function_\">observe</span>(<span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-property\">documentElement</span>, {\n  <span class=\"hljs-attr\">attributes</span>: <span class=\"hljs-literal\">true</span>,\n  <span class=\"hljs-attr\">characterData</span>: <span class=\"hljs-literal\">true</span>,\n  <span class=\"hljs-attr\">childList</span>: <span class=\"hljs-literal\">true</span>,\n  <span class=\"hljs-attr\">subtree</span>: <span class=\"hljs-literal\">true</span>,\n  <span class=\"hljs-attr\">attributeOldValue</span>: <span class=\"hljs-literal\">true</span>,\n  <span class=\"hljs-attr\">characterDataOldValue</span>: <span class=\"hljs-literal\">true</span>\n});\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"71,82"}},{"content":"<pre data-lines=\"83,86\"><code>&#x5bf9;&#x4e00;&#x4e2a;&#x8282;&#x70b9;&#x6dfb;&#x52a0;&#x89c2;&#x5bdf;&#x5668;&#xff0c;&#x5c31;&#x50cf;&#x4f7f;&#x7528;`addEventListener`&#x65b9;&#x6cd5;&#x4e00;&#x6837;&#xff0c;&#x591a;&#x6b21;&#x6dfb;&#x52a0;&#x540c;&#x4e00;&#x4e2a;&#x89c2;&#x5bdf;&#x5668;&#x662f;&#x65e0;&#x6548;&#x7684;&#xff0c;&#x56de;&#x8c03;&#x51fd;&#x6570;&#x4f9d;&#x7136;&#x53ea;&#x4f1a;&#x89e6;&#x53d1;&#x4e00;&#x6b21;&#x3002;&#x5982;&#x679c;&#x6307;&#x5b9a;&#x4e0d;&#x540c;&#x7684;`options`&#x5bf9;&#x8c61;&#xff0c;&#x4ee5;&#x540e;&#x9762;&#x6dfb;&#x52a0;&#x7684;&#x90a3;&#x4e2a;&#x4e3a;&#x51c6;&#xff0c;&#x7c7b;&#x4f3c;&#x8986;&#x76d6;&#x3002;\n\n&#x4e0b;&#x9762;&#x7684;&#x4f8b;&#x5b50;&#x662f;&#x89c2;&#x5bdf;&#x65b0;&#x589e;&#x7684;&#x5b50;&#x8282;&#x70b9;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"83,86"}},{"content":"<pre data-lines=\"87,99\"><code class=\"language-javascript\"><span class=\"hljs-keyword\">var</span> insertedNodes = [];\n<span class=\"hljs-keyword\">var</span> observer = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">MutationObserver</span>(<span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">mutations</span>) {\n  mutations.<span class=\"hljs-title function_\">forEach</span>(<span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">mutation</span>) {\n    <span class=\"hljs-keyword\">for</span> (<span class=\"hljs-keyword\">var</span> i = <span class=\"hljs-number\">0</span>; i &lt; mutation.<span class=\"hljs-property\">addedNodes</span>.<span class=\"hljs-property\">length</span>; i++) {\n      insertedNodes.<span class=\"hljs-title function_\">push</span>(mutation.<span class=\"hljs-property\">addedNodes</span>[i]);\n    }\n  });\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(insertedNodes);\n});\nobserver.<span class=\"hljs-title function_\">observe</span>(<span class=\"hljs-variable language_\">document</span>, { <span class=\"hljs-attr\">childList</span>: <span class=\"hljs-literal\">true</span>, <span class=\"hljs-attr\">subtree</span>: <span class=\"hljs-literal\">true</span> });\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"87,99"}}],"payload":{"tag":"h3","lines":"36,37"}},{"content":"disconnect()&#xff0c;takeRecords&#xff08;&#xff09;","children":[{"content":"<pre data-lines=\"102,103\"><code>`disconnect`&#x65b9;&#x6cd5;&#x7528;&#x6765;&#x505c;&#x6b62;&#x89c2;&#x5bdf;&#x3002;&#x8c03;&#x7528;&#x8be5;&#x65b9;&#x6cd5;&#x540e;&#xff0c;DOM &#x518d;&#x53d1;&#x751f;&#x53d8;&#x52a8;&#xff0c;&#x4e5f;&#x4e0d;&#x4f1a;&#x89e6;&#x53d1;&#x89c2;&#x5bdf;&#x5668;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"102,103"}},{"content":"<pre data-lines=\"104,107\"><code class=\"language-javascript\">observer.disconnect();\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"104,107"}},{"content":"<pre data-lines=\"108,109\"><code>`takeRecords`&#x65b9;&#x6cd5;&#x7528;&#x6765;&#x6e05;&#x9664;&#x53d8;&#x52a8;&#x8bb0;&#x5f55;&#xff0c;&#x5373;&#x4e0d;&#x518d;&#x5904;&#x7406;&#x672a;&#x5904;&#x7406;&#x7684;&#x53d8;&#x52a8;&#x3002;&#x8be5;&#x65b9;&#x6cd5;&#x8fd4;&#x56de;&#x53d8;&#x52a8;&#x8bb0;&#x5f55;&#x7684;&#x6570;&#x7ec4;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"108,109"}},{"content":"<pre data-lines=\"110,113\"><code class=\"language-javascript\">observer.takeRecords();\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"110,113"}},{"content":"<pre data-lines=\"114,115\"><code>&#x4e0b;&#x9762;&#x662f;&#x4e00;&#x4e2a;&#x4f8b;&#x5b50;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"114,115"}},{"content":"<pre data-lines=\"116,123\"><code class=\"language-javascript\"><span class=\"hljs-comment\">// &#x4fdd;&#x5b58;&#x6240;&#x6709;&#x6ca1;&#x6709;&#x88ab;&#x89c2;&#x5bdf;&#x5668;&#x5904;&#x7406;&#x7684;&#x53d8;&#x52a8;</span>\n<span class=\"hljs-keyword\">var</span> changes = mutationObserver.<span class=\"hljs-title function_\">takeRecords</span>();\n\n<span class=\"hljs-comment\">// &#x505c;&#x6b62;&#x89c2;&#x5bdf;</span>\nmutationObserver.<span class=\"hljs-title function_\">disconnect</span>();\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"116,123"}}],"payload":{"tag":"h3","lines":"100,101"}}],"payload":{"tag":"h2","lines":"34,35"}},{"content":"MutationRecord &#x5bf9;&#x8c61;","children":[{"content":"<pre data-lines=\"126,138\"><code>DOM &#x6bcf;&#x6b21;&#x53d1;&#x751f;&#x53d8;&#x5316;&#xff0c;&#x5c31;&#x4f1a;&#x751f;&#x6210;&#x4e00;&#x6761;&#x53d8;&#x52a8;&#x8bb0;&#x5f55;&#xff08;MutationRecord &#x5b9e;&#x4f8b;&#xff09;&#x3002;&#x8be5;&#x5b9e;&#x4f8b;&#x5305;&#x542b;&#x4e86;&#x4e0e;&#x53d8;&#x52a8;&#x76f8;&#x5173;&#x7684;&#x6240;&#x6709;&#x4fe1;&#x606f;&#x3002;Mutation Observer &#x5904;&#x7406;&#x7684;&#x5c31;&#x662f;&#x4e00;&#x4e2a;&#x4e2a;`MutationRecord`&#x5b9e;&#x4f8b;&#x6240;&#x7ec4;&#x6210;&#x7684;&#x6570;&#x7ec4;&#x3002;\n\n`MutationRecord`&#x5bf9;&#x8c61;&#x5305;&#x542b;&#x4e86;DOM&#x7684;&#x76f8;&#x5173;&#x4fe1;&#x606f;&#xff0c;&#x6709;&#x5982;&#x4e0b;&#x5c5e;&#x6027;&#xff1a;\n\n- `type`&#xff1a;&#x89c2;&#x5bdf;&#x7684;&#x53d8;&#x52a8;&#x7c7b;&#x578b;&#xff08;`attributes`&#x3001;`characterData`&#x6216;&#x8005;`childList`&#xff09;&#x3002;\n- `target`&#xff1a;&#x53d1;&#x751f;&#x53d8;&#x52a8;&#x7684;DOM&#x8282;&#x70b9;&#x3002;\n- `addedNodes`&#xff1a;&#x65b0;&#x589e;&#x7684;DOM&#x8282;&#x70b9;&#x3002;\n- `removedNodes`&#xff1a;&#x5220;&#x9664;&#x7684;DOM&#x8282;&#x70b9;&#x3002;\n- `previousSibling`&#xff1a;&#x524d;&#x4e00;&#x4e2a;&#x540c;&#x7ea7;&#x8282;&#x70b9;&#xff0c;&#x5982;&#x679c;&#x6ca1;&#x6709;&#x5219;&#x8fd4;&#x56de;`null`&#x3002;\n- `nextSibling`&#xff1a;&#x4e0b;&#x4e00;&#x4e2a;&#x540c;&#x7ea7;&#x8282;&#x70b9;&#xff0c;&#x5982;&#x679c;&#x6ca1;&#x6709;&#x5219;&#x8fd4;&#x56de;`null`&#x3002;\n- `attributeName`&#xff1a;&#x53d1;&#x751f;&#x53d8;&#x52a8;&#x7684;&#x5c5e;&#x6027;&#x3002;&#x5982;&#x679c;&#x8bbe;&#x7f6e;&#x4e86;`attributeFilter`&#xff0c;&#x5219;&#x53ea;&#x8fd4;&#x56de;&#x9884;&#x5148;&#x6307;&#x5b9a;&#x7684;&#x5c5e;&#x6027;&#x3002;\n- `oldValue`&#xff1a;&#x53d8;&#x52a8;&#x524d;&#x7684;&#x503c;&#x3002;&#x8fd9;&#x4e2a;&#x5c5e;&#x6027;&#x53ea;&#x5bf9;`attribute`&#x548c;`characterData`&#x53d8;&#x52a8;&#x6709;&#x6548;&#xff0c;&#x5982;&#x679c;&#x53d1;&#x751f;`childList`&#x53d8;&#x52a8;&#xff0c;&#x5219;&#x8fd4;&#x56de;`null`&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"126,138"}}],"payload":{"tag":"h2","lines":"124,125"}},{"content":"&#x5e94;&#x7528;&#x793a;&#x4f8b;","children":[{"content":"&#x5b50;&#x5143;&#x7d20;&#x7684;&#x53d8;&#x52a8;","children":[{"content":"<pre data-lines=\"143,144\"><code>&#x4e0b;&#x9762;&#x7684;&#x4f8b;&#x5b50;&#x8bf4;&#x660e;&#x5982;&#x4f55;&#x8bfb;&#x53d6;&#x53d8;&#x52a8;&#x8bb0;&#x5f55;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"143,144"}},{"content":"<pre data-lines=\"145,162\"><code class=\"language-javascript\"><span class=\"hljs-keyword\">var</span> callback = <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">records</span>){\n  records.<span class=\"hljs-title function_\">map</span>(<span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">record</span>){\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;Mutation type: &apos;</span> + record.<span class=\"hljs-property\">type</span>);\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;Mutation target: &apos;</span> + record.<span class=\"hljs-property\">target</span>);\n  });\n};\n\n<span class=\"hljs-keyword\">var</span> mo = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">MutationObserver</span>(callback);\n\n<span class=\"hljs-keyword\">var</span> option = {\n  <span class=\"hljs-string\">&apos;childList&apos;</span>: <span class=\"hljs-literal\">true</span>,\n  <span class=\"hljs-string\">&apos;subtree&apos;</span>: <span class=\"hljs-literal\">true</span>\n};\n\nmo.<span class=\"hljs-title function_\">observe</span>(<span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-property\">body</span>, option);\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"145,162"}},{"content":"<pre data-lines=\"163,164\"><code>&#x4e0a;&#x9762;&#x4ee3;&#x7801;&#x7684;&#x89c2;&#x5bdf;&#x5668;&#xff0c;&#x89c2;&#x5bdf;`&lt;body&gt;`&#x7684;&#x6240;&#x6709;&#x4e0b;&#x7ea7;&#x8282;&#x70b9;&#xff08;`childList`&#x8868;&#x793a;&#x89c2;&#x5bdf;&#x5b50;&#x8282;&#x70b9;&#xff0c;`subtree`&#x8868;&#x793a;&#x89c2;&#x5bdf;&#x540e;&#x4ee3;&#x8282;&#x70b9;&#xff09;&#x7684;&#x53d8;&#x52a8;&#x3002;&#x56de;&#x8c03;&#x51fd;&#x6570;&#x4f1a;&#x5728;&#x63a7;&#x5236;&#x53f0;&#x663e;&#x793a;&#x6240;&#x6709;&#x53d8;&#x52a8;&#x7684;&#x7c7b;&#x578b;&#x548c;&#x76ee;&#x6807;&#x8282;&#x70b9;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"163,164"}}],"payload":{"tag":"h3","lines":"141,142"}},{"content":"&#x5c5e;&#x6027;&#x7684;&#x53d8;&#x52a8;","children":[{"content":"<pre data-lines=\"167,168\"><code>&#x4e0b;&#x9762;&#x7684;&#x4f8b;&#x5b50;&#x8bf4;&#x660e;&#x5982;&#x4f55;&#x8ffd;&#x8e2a;&#x5c5e;&#x6027;&#x7684;&#x53d8;&#x52a8;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"167,168"}},{"content":"<pre data-lines=\"169,187\"><code class=\"language-javascript\"><span class=\"hljs-keyword\">var</span> callback = <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">records</span>) {\n  records.<span class=\"hljs-title function_\">map</span>(<span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">record</span>) {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;Previous attribute value: &apos;</span> + record.<span class=\"hljs-property\">oldValue</span>);\n  });\n};\n\n<span class=\"hljs-keyword\">var</span> mo = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">MutationObserver</span>(callback);\n\n<span class=\"hljs-keyword\">var</span> element = <span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-title function_\">getElementById</span>(<span class=\"hljs-string\">&apos;#my_element&apos;</span>);\n\n<span class=\"hljs-keyword\">var</span> options = {\n  <span class=\"hljs-string\">&apos;attributes&apos;</span>: <span class=\"hljs-literal\">true</span>,\n  <span class=\"hljs-string\">&apos;attributeOldValue&apos;</span>: <span class=\"hljs-literal\">true</span>\n}\n\nmo.<span class=\"hljs-title function_\">observe</span>(element, options);\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"169,187"}},{"content":"<pre data-lines=\"188,189\"><code>&#x4e0a;&#x9762;&#x4ee3;&#x7801;&#x5148;&#x8bbe;&#x5b9a;&#x8ffd;&#x8e2a;&#x5c5e;&#x6027;&#x53d8;&#x52a8;&#xff08;`&apos;attributes&apos;: true`&#xff09;&#xff0c;&#x7136;&#x540e;&#x8bbe;&#x5b9a;&#x8bb0;&#x5f55;&#x53d8;&#x52a8;&#x524d;&#x7684;&#x503c;&#x3002;&#x5b9e;&#x9645;&#x53d1;&#x751f;&#x53d8;&#x52a8;&#x65f6;&#xff0c;&#x4f1a;&#x5c06;&#x53d8;&#x52a8;&#x524d;&#x7684;&#x503c;&#x663e;&#x793a;&#x5728;&#x63a7;&#x5236;&#x53f0;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"188,189"}}],"payload":{"tag":"h3","lines":"165,166"}},{"content":"&#x53d6;&#x4ee3; DOMContentLoaded &#x4e8b;&#x4ef6;","children":[{"content":"<pre data-lines=\"192,193\"><code>&#x7f51;&#x9875;&#x52a0;&#x8f7d;&#x7684;&#x65f6;&#x5019;&#xff0c;DOM &#x8282;&#x70b9;&#x7684;&#x751f;&#x6210;&#x4f1a;&#x4ea7;&#x751f;&#x53d8;&#x52a8;&#x8bb0;&#x5f55;&#xff0c;&#x56e0;&#x6b64;&#x53ea;&#x8981;&#x89c2;&#x5bdf; DOM &#x7684;&#x53d8;&#x52a8;&#xff0c;&#x5c31;&#x80fd;&#x5728;&#x7b2c;&#x4e00;&#x65f6;&#x95f4;&#x89e6;&#x53d1;&#x76f8;&#x5173;&#x4e8b;&#x4ef6;&#xff0c;&#x4e5f;&#x5c31;&#x6ca1;&#x6709;&#x5fc5;&#x8981;&#x4f7f;&#x7528;`DOMContentLoaded`&#x4e8b;&#x4ef6;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"192,193"}},{"content":"<pre data-lines=\"194,201\"><code class=\"language-javascript\"><span class=\"hljs-keyword\">var</span> observer = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">MutationObserver</span>(callback);\nobserver.<span class=\"hljs-title function_\">observe</span>(<span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-property\">documentElement</span>, {\n  <span class=\"hljs-attr\">childList</span>: <span class=\"hljs-literal\">true</span>,\n  <span class=\"hljs-attr\">subtree</span>: <span class=\"hljs-literal\">true</span>\n});\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"194,201"}},{"content":"<pre data-lines=\"202,205\"><code>&#x4e0a;&#x9762;&#x4ee3;&#x7801;&#x4e2d;&#xff0c;&#x76d1;&#x542c;`document.documentElement`&#xff08;&#x5373;&#x7f51;&#x9875;&#x7684;`&lt;html&gt;`HTML &#x8282;&#x70b9;&#xff09;&#x7684;&#x5b50;&#x8282;&#x70b9;&#x7684;&#x53d8;&#x52a8;&#xff0c;`subtree`&#x5c5e;&#x6027;&#x6307;&#x5b9a;&#x76d1;&#x542c;&#x8fd8;&#x5305;&#x62ec;&#x540e;&#x4ee3;&#x8282;&#x70b9;&#x3002;&#x56e0;&#x6b64;&#xff0c;&#x4efb;&#x610f;&#x4e00;&#x4e2a;&#x7f51;&#x9875;&#x5143;&#x7d20;&#x4e00;&#x65e6;&#x751f;&#x6210;&#xff0c;&#x5c31;&#x80fd;&#x7acb;&#x523b;&#x88ab;&#x76d1;&#x542c;&#x5230;&#x3002;\n\n&#x4e0b;&#x9762;&#x7684;&#x4ee3;&#x7801;&#xff0c;&#x4f7f;&#x7528;`MutationObserver`&#x5bf9;&#x8c61;&#x5c01;&#x88c5;&#x4e00;&#x4e2a;&#x76d1;&#x542c; DOM &#x751f;&#x6210;&#x7684;&#x51fd;&#x6570;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"202,205"}},{"content":"<pre data-lines=\"206,261\"><code class=\"language-javascript\">(<span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">win</span>){\n  <span class=\"hljs-string\">&apos;use strict&apos;</span>;\n\n  <span class=\"hljs-keyword\">var</span> listeners = [];\n  <span class=\"hljs-keyword\">var</span> doc = win.<span class=\"hljs-property\">document</span>;\n  <span class=\"hljs-keyword\">var</span> <span class=\"hljs-title class_\">MutationObserver</span> = win.<span class=\"hljs-property\">MutationObserver</span> || win.<span class=\"hljs-property\">WebKitMutationObserver</span>;\n  <span class=\"hljs-keyword\">var</span> observer;\n\n  <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">ready</span>(<span class=\"hljs-params\">selector, fn</span>){\n    <span class=\"hljs-comment\">// &#x50a8;&#x5b58;&#x9009;&#x62e9;&#x5668;&#x548c;&#x56de;&#x8c03;&#x51fd;&#x6570;</span>\n    listeners.<span class=\"hljs-title function_\">push</span>({\n      <span class=\"hljs-attr\">selector</span>: selector,\n      <span class=\"hljs-attr\">fn</span>: fn\n    });\n    <span class=\"hljs-keyword\">if</span>(!observer){\n      <span class=\"hljs-comment\">// &#x76d1;&#x542c;document&#x53d8;&#x5316;</span>\n      observer = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">MutationObserver</span>(check);\n      observer.<span class=\"hljs-title function_\">observe</span>(doc.<span class=\"hljs-property\">documentElement</span>, {\n        <span class=\"hljs-attr\">childList</span>: <span class=\"hljs-literal\">true</span>,\n        <span class=\"hljs-attr\">subtree</span>: <span class=\"hljs-literal\">true</span>\n      });\n    }\n    <span class=\"hljs-comment\">// &#x68c0;&#x67e5;&#x8be5;&#x8282;&#x70b9;&#x662f;&#x5426;&#x5df2;&#x7ecf;&#x5728;DOM&#x4e2d;</span>\n    <span class=\"hljs-title function_\">check</span>();\n  }\n\n  <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">check</span>(<span class=\"hljs-params\"></span>){\n  <span class=\"hljs-comment\">// &#x68c0;&#x67e5;&#x662f;&#x5426;&#x5339;&#x914d;&#x5df2;&#x50a8;&#x5b58;&#x7684;&#x8282;&#x70b9;</span>\n    <span class=\"hljs-keyword\">for</span>(<span class=\"hljs-keyword\">var</span> i = <span class=\"hljs-number\">0</span>; i &lt; listeners.<span class=\"hljs-property\">length</span>; i++){\n      <span class=\"hljs-keyword\">var</span> listener = listeners[i];\n      <span class=\"hljs-comment\">// &#x68c0;&#x67e5;&#x6307;&#x5b9a;&#x8282;&#x70b9;&#x662f;&#x5426;&#x6709;&#x5339;&#x914d;</span>\n      <span class=\"hljs-keyword\">var</span> elements = doc.<span class=\"hljs-title function_\">querySelectorAll</span>(listener.<span class=\"hljs-property\">selector</span>);\n      <span class=\"hljs-keyword\">for</span>(<span class=\"hljs-keyword\">var</span> j = <span class=\"hljs-number\">0</span>; j &lt; elements.<span class=\"hljs-property\">length</span>; j++){\n        <span class=\"hljs-keyword\">var</span> element = elements[j];\n        <span class=\"hljs-comment\">// &#x786e;&#x4fdd;&#x56de;&#x8c03;&#x51fd;&#x6570;&#x53ea;&#x4f1a;&#x5bf9;&#x8be5;&#x5143;&#x7d20;&#x8c03;&#x7528;&#x4e00;&#x6b21;</span>\n        <span class=\"hljs-keyword\">if</span>(!element.<span class=\"hljs-property\">ready</span>){\n          element.<span class=\"hljs-property\">ready</span> = <span class=\"hljs-literal\">true</span>;\n          <span class=\"hljs-comment\">// &#x5bf9;&#x8be5;&#x8282;&#x70b9;&#x8c03;&#x7528;&#x56de;&#x8c03;&#x51fd;&#x6570;</span>\n          listener.<span class=\"hljs-property\">fn</span>.<span class=\"hljs-title function_\">call</span>(element, element);\n        }\n      }\n    }\n  }\n\n  <span class=\"hljs-comment\">// &#x5bf9;&#x5916;&#x66b4;&#x9732;ready</span>\n  win.<span class=\"hljs-property\">ready</span> = ready;\n\n})(<span class=\"hljs-variable language_\">this</span>);\n\n<span class=\"hljs-comment\">// &#x4f7f;&#x7528;&#x65b9;&#x6cd5;</span>\n<span class=\"hljs-title function_\">ready</span>(<span class=\"hljs-string\">&apos;.foo&apos;</span>, <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">element</span>){\n  <span class=\"hljs-comment\">// ...</span>\n});\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"206,261"}}],"payload":{"tag":"h3","lines":"190,191"}}],"payload":{"tag":"h2","lines":"139,140"}},{"content":"&#x53c2;&#x8003;&#x94fe;&#x63a5;","children":[{"content":"Paul Kinlan, <a href=\"https://developers.google.com/web/updates/2012/02/Detect-DOM-changes-with-Mutation-Observers\">Detect DOM changes with Mutation Observers</a>","children":[],"payload":{"tag":"li","lines":"264,265"}},{"content":"Tiffany Brown, <a href=\"http://dev.opera.com/articles/view/mutation-observers-tutorial/\">Getting to know mutation observers</a>","children":[],"payload":{"tag":"li","lines":"265,266"}},{"content":"Michal Budzynski, <a href=\"http://michalbe.blogspot.com/2013/04/javascript-less-known-parts-dom.html\">JavaScript: The less known parts. DOM Mutations</a>","children":[],"payload":{"tag":"li","lines":"266,267"}},{"content":"Jeff Griffiths, <a href=\"https://hacks.mozilla.org/2012/05/dom-mutationobserver-reacting-to-dom-changes-without-killing-browser-performance/\">DOM MutationObserver &#x2013; reacting to DOM changes without killing browser performance</a>","children":[],"payload":{"tag":"li","lines":"267,268"}},{"content":"Addy Osmani, <a href=\"http://addyosmani.com/blog/mutation-observers/\">Detect, Undo And Redo DOM Changes With Mutation Observers</a>","children":[],"payload":{"tag":"li","lines":"268,269"}},{"content":"Ryan Morr, <a href=\"http://ryanmorr.com/using-mutation-observers-to-watch-for-element-availability/\">Using Mutation Observers to Watch for Element Availability</a>","children":[],"payload":{"tag":"li","lines":"269,270"}}],"payload":{"tag":"h2","lines":"262,263"}}],"payload":{"tag":"h1","lines":"0,1"}},{})</script>
</body>
</html>
