<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets@11.11.1/styles/default.min.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.18.10/dist/browser/index.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/index.js"></script><script>(r => {
              setTimeout(r);
            })(function renderToolbar() {
  const {
    markmap,
    mm
  } = window;
  const {
    el
  } = markmap.Toolbar.create(mm);
  el.setAttribute('style', 'position:absolute;bottom:20px;right:20px');
  document.body.append(el);
})</script><script>((getMarkmap, getOptions, root2, jsonOptions) => {
              const markmap = getMarkmap();
              window.mm = markmap.Markmap.create(
                "svg#mindmap",
                (getOptions || markmap.deriveOptions)(jsonOptions),
                root2
              );
            })(() => window.markmap,null,{"content":"Deep-Learning","children":[{"content":"&#x793a;&#x4f8b;","children":[{"content":"<pre data-lines=\"6,48\"><code class=\"language-python\"><span class=\"hljs-comment\"># &#x7ebf;&#x6027;&#x56de;&#x5f52;&#x793a;&#x4f8b;</span>\n<span class=\"hljs-keyword\">import</span> tensorflow <span class=\"hljs-keyword\">as</span> tf\n\n<span class=\"hljs-comment\"># &#x7b2c;&#x4e00;&#x6b65;&#xff1a;&#x521b;&#x5efa;&#x6570;&#x636e;</span>\nx = tf.random_normal([<span class=\"hljs-number\">100</span>, <span class=\"hljs-number\">1</span>], mean=<span class=\"hljs-number\">1.75</span>, stddev=<span class=\"hljs-number\">0.5</span>, name=<span class=\"hljs-string\">&quot;x_data&quot;</span>)\ny_true = tf.matmul(x, [[<span class=\"hljs-number\">2.0</span>]]) + <span class=\"hljs-number\">5.0</span>  <span class=\"hljs-comment\"># &#x77e9;&#x9635;&#x76f8;&#x4e58;&#x5fc5;&#x987b;&#x662f;&#x4e8c;&#x7ef4;&#x7684;</span>\n\n<span class=\"hljs-comment\"># &#x7b2c;&#x4e8c;&#x6b65;&#xff1a;&#x5efa;&#x7acb;&#x7ebf;&#x6027;&#x56de;&#x5f52;&#x6a21;&#x578b;</span>\n<span class=\"hljs-comment\"># &#x5efa;&#x7acb;&#x6a21;&#x578b;&#x65f6;&#xff0c;&#x968f;&#x673a;&#x5efa;&#x7acb;&#x6743;&#x91cd;&#x3001;&#x504f;&#x7f6e; y = wx + b</span>\n<span class=\"hljs-comment\"># &#x6743;&#x91cd;&#x9700;&#x8981;&#x4e0d;&#x65ad;&#x66f4;&#x65b0;&#xff0c;&#x6240;&#x4ee5;&#x5fc5;&#x987b;&#x662f;&#x53d8;&#x91cf;&#x7c7b;&#x578b;. trainable&#x6307;&#x5b9a;&#x8be5;&#x53d8;&#x91cf;&#x662f;&#x5426;&#x80fd;&#x968f;&#x68af;&#x5ea6;&#x4e0b;&#x964d;&#x4e00;&#x8d77;&#x53d8;&#x5316;</span>\nweight = tf.Variable(tf.random_normal([<span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">1</span>], name=<span class=\"hljs-string\">&quot;w&quot;</span>),\n                     trainable=<span class=\"hljs-literal\">True</span>)  <span class=\"hljs-comment\"># &#x8bad;&#x7ec3;&#x8fc7;&#x7a0b;&#x4e2d;&#x503c;&#x662f;&#x5426;&#x5141;&#x8bb8;&#x53d8;&#x5316;</span>\nbias = tf.Variable(<span class=\"hljs-number\">0.0</span>, name=<span class=\"hljs-string\">&quot;b&quot;</span>, trainable=<span class=\"hljs-literal\">True</span>)  <span class=\"hljs-comment\"># &#x504f;&#x7f6e;</span>\ny_predict = tf.matmul(x, weight) + bias  <span class=\"hljs-comment\"># &#x8ba1;&#x7b97; wx + b</span>\n\n<span class=\"hljs-comment\"># # &#x7b2c;&#x4e09;&#x6b65;&#xff1a;&#x6c42;&#x635f;&#x5931;&#x51fd;&#x6570;&#xff0c;&#x8bef;&#x5dee;(&#x5747;&#x65b9;&#x5dee;)</span>\nloss = tf.reduce_mean(tf.square(y_true - y_predict))\n\n<span class=\"hljs-comment\"># # &#x7b2c;&#x56db;&#x6b65;&#xff1a;&#x4f7f;&#x7528;&#x68af;&#x5ea6;&#x4e0b;&#x964d;&#x6cd5;&#x4f18;&#x5316;&#x635f;&#x5931;</span>\n<span class=\"hljs-comment\"># &#x5b66;&#x4e60;&#x7387;&#x662f;&#x6bd4;&#x4ef7;&#x654f;&#x611f;&#x7684;&#x53c2;&#x6570;&#xff0c;&#x8fc7;&#x5c0f;&#x4f1a;&#x5bfc;&#x81f4;&#x6536;&#x655b;&#x6162;&#xff0c;&#x8fc7;&#x5927;&#x53ef;&#x80fd;&#x5bfc;&#x81f4;&#x68af;&#x5ea6;&#x7206;&#x70b8;</span>\ntrain_op = tf.train.GradientDescentOptimizer(<span class=\"hljs-number\">0.1</span>).minimize(loss)\n\n<span class=\"hljs-comment\">#### &#x6536;&#x96c6;&#x635f;&#x5931;&#x503c;</span>\ntf.summary.scalar(<span class=\"hljs-string\">&quot;losses&quot;</span>, loss)\nmerged = tf.summary.merge_all() <span class=\"hljs-comment\">#&#x5c06;&#x6240;&#x6709;&#x7684;&#x6458;&#x8981;&#x4fe1;&#x606f;&#x4fdd;&#x5b58;&#x5230;&#x78c1;&#x76d8;</span>\n\ninit_op = tf.global_variables_initializer()\n<span class=\"hljs-keyword\">with</span> tf.Session() <span class=\"hljs-keyword\">as</span> sess:  <span class=\"hljs-comment\"># &#x901a;&#x8fc7;Session&#x8fd0;&#x884c;op</span>\n    sess.run(init_op)\n    <span class=\"hljs-comment\"># &#x6253;&#x5370;&#x521d;&#x59cb;&#x6743;&#x91cd;&#x3001;&#x504f;&#x79fb;&#x503c;</span>\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;weight:&quot;</span>, weight.<span class=\"hljs-built_in\">eval</span>(), <span class=\"hljs-string\">&quot; bias:&quot;</span>, bias.<span class=\"hljs-built_in\">eval</span>())\n\n    <span class=\"hljs-comment\">#### &#x6307;&#x5b9a;&#x4e8b;&#x4ef6;&#x6587;&#x4ef6;</span>\n    fw = tf.summary.FileWriter(<span class=\"hljs-string\">&quot;../summary/&quot;</span>, graph=sess.graph)\n\n    <span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(<span class=\"hljs-number\">500</span>):  <span class=\"hljs-comment\"># &#x5faa;&#x73af;&#x6267;&#x884c;&#x8bad;&#x7ec3;</span>\n        sess.run(train_op)  <span class=\"hljs-comment\"># &#x6267;&#x884c;&#x8bad;&#x7ec3;</span>\n        summary = sess.run(merged) <span class=\"hljs-comment\">#### &#x8fd0;&#x884c;&#x5408;&#x5e76;&#x6458;&#x8981;op</span>\n        fw.add_summary(summary, i) <span class=\"hljs-comment\">#### &#x5199;&#x5165;&#x6587;&#x4ef6;</span>\n        <span class=\"hljs-built_in\">print</span>(i, <span class=\"hljs-string\">&quot;:&quot;</span>, i, <span class=\"hljs-string\">&quot;weight:&quot;</span>, weight.<span class=\"hljs-built_in\">eval</span>(), <span class=\"hljs-string\">&quot; bias:&quot;</span>, bias.<span class=\"hljs-built_in\">eval</span>())\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"6,48"}},{"content":"<pre data-lines=\"49,104\"><code class=\"language-python\"><span class=\"hljs-comment\"># 02_csv_reader.py</span>\n<span class=\"hljs-comment\"># csv&#x6587;&#x4ef6;&#x8bfb;&#x53d6;&#x793a;&#x4f8b;</span>\n<span class=\"hljs-string\">&quot;&quot;&quot; &#x6837;&#x672c;&#x6587;&#x4ef6;&#x8bfb;&#x53d6;&#x4e09;&#x4e2a;&#x6b65;&#x9aa4;&#xff1a;\n1. &#x521b;&#x5efa;&#x6587;&#x4ef6;&#x961f;&#x5217;\n2. &#x8bfb;&#x53d6;&#x6587;&#x4ef6;&#x5185;&#x5bb9;&#xff0c;&#x5e76;&#x4e14;&#x8fdb;&#x884c;&#x89e3;&#x7801;\n3. &#x5c06;&#x89e3;&#x7801;&#x540e;&#x7684;&#x6570;&#x636e;&#x5206;&#x6279;&#x6b21;&#x8fd4;&#x56de;\n&quot;&quot;&quot;</span>\n<span class=\"hljs-keyword\">import</span> tensorflow <span class=\"hljs-keyword\">as</span> tf\n<span class=\"hljs-keyword\">import</span> os\n\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">csv_read</span>(<span class=\"hljs-params\">filelist</span>):\n    <span class=\"hljs-string\">&quot;&quot;&quot;\n    &#x8bfb;&#x53d6;csv&#x6587;&#x4ef6;&#x51fd;&#x6570;\n    :param filelist: &#x6587;&#x4ef6;&#x5217;&#x8868;\n    :return: &#x8fd4;&#x56de;&#x4e00;&#x4e2a;&#x6279;&#x6b21;&#x6570;&#x636e;\n    &quot;&quot;&quot;</span>\n    <span class=\"hljs-comment\"># &#x6784;&#x5efa;&#x6587;&#x4ef6;&#x961f;&#x5217;</span>\n    file_queue = tf.train.string_input_producer(filelist)\n\n    <span class=\"hljs-comment\"># &#x8bfb;&#x53d6;&#x3001;&#x89e3;&#x7801;</span>\n    reader = tf.TextLineReader()\n    k, v = reader.read(file_queue) <span class=\"hljs-comment\"># &#x4ece;&#x6307;&#x5b9a;&#x7684;&#x961f;&#x5217;&#x4e2d;&#x8bfb;&#x53d6;&#x6587;&#x4ef6;&#xff0c;&#x8fd4;&#x56de;&#x6587;&#x4ef6;&#x540d;&#x3001;&#x6570;&#x636e;</span>\n\n    records = [[<span class=\"hljs-string\">&quot;None&quot;</span>], [<span class=\"hljs-string\">&quot;None&quot;</span>]] <span class=\"hljs-comment\"># &#x89e3;&#x7801;&#x4f7f;&#x7528;&#x7684;&#x9ed8;&#x8ba4;&#x503c;</span>\n    <span class=\"hljs-comment\"># &#x89e3;&#x7801;</span>\n    example, label = tf.decode_csv(v, <span class=\"hljs-comment\"># &#x53c2;&#x4e0e;&#x89e3;&#x7801;&#x7684;&#x6570;&#x636e;</span>\n                                   record_defaults=records) <span class=\"hljs-comment\"># &#x9ed8;&#x8ba4;&#x503c;</span>\n    <span class=\"hljs-comment\"># &#x5206;&#x6279;&#x6b21;</span>\n    example_bat, label_bat = tf.train.batch([example, label], <span class=\"hljs-comment\"># &#x6570;&#x636e;</span>\n                                            batch_size=<span class=\"hljs-number\">9</span>, <span class=\"hljs-comment\"># &#x6279;&#x6b21;&#x5927;&#x5c0f;</span>\n                                            num_threads=<span class=\"hljs-number\">1</span>, <span class=\"hljs-comment\"># &#x7ebf;&#x7a0b;&#x6570;&#x91cf;</span>\n                                            capacity=<span class=\"hljs-number\">9</span>) <span class=\"hljs-comment\"># &#x7f13;&#x51b2;&#x533a;&#x5927;&#x5c0f;</span>\n    <span class=\"hljs-keyword\">return</span> example_bat, label_bat <span class=\"hljs-comment\"># &#x8fd4;&#x56de;&#x4e00;&#x4e2a;&#x6279;&#x6b21;&#x6837;&#x672c;&#x3001;&#x6807;&#x7b7e;</span>\n\n<span class=\"hljs-keyword\">if</span> __name__ == <span class=\"hljs-string\">&quot;__main__&quot;</span>:\n    dir_name = <span class=\"hljs-string\">&quot;../test_data/&quot;</span> <span class=\"hljs-comment\"># &#x6570;&#x636e;&#x6587;&#x4ef6;&#x76ee;&#x5f55;</span>\n    file_names = os.listdir(dir_name) <span class=\"hljs-comment\"># &#x5217;&#x51fa;&#x76ee;&#x5f55;&#x4e0b;&#x6240;&#x6709;&#x6587;&#x4ef6;</span>\n    file_list = []\n    <span class=\"hljs-keyword\">for</span> f <span class=\"hljs-keyword\">in</span> file_names:\n        <span class=\"hljs-comment\"># &#x76ee;&#x5f55;&#x3001;&#x6587;&#x4ef6;&#x540d;&#x62fc;&#x63a5;&#x6210;&#x5b8c;&#x6574;&#x8def;&#x5f84;&#xff0c;&#x5e76;&#x52a0;&#x5165;&#x6587;&#x4ef6;&#x8def;&#x5f84;&#x5217;&#x8868;</span>\n        file_list.append(os.path.join(dir_name, f))\n\n    example, label = csv_read(file_list) <span class=\"hljs-comment\"># &#x8bfb;&#x53d6;&#x6587;&#x4ef6;&#x3001;&#x89e3;&#x7801;&#x3001;&#x8fd4;&#x56de;&#x6279;&#x6b21;</span>\n\n    <span class=\"hljs-keyword\">with</span> tf.Session() <span class=\"hljs-keyword\">as</span> sess:\n        coord = tf.train.Coordinator() <span class=\"hljs-comment\"># &#x7ebf;&#x7a0b;&#x534f;&#x8c03;&#x5668;</span>\n        <span class=\"hljs-comment\"># &#x8fd4;&#x56de;&#x4e00;&#x7ec4;&#x7ebf;&#x7a0b;</span>\n        threads = tf.train.start_queue_runners(sess, coord=coord)\n        <span class=\"hljs-built_in\">print</span>(sess.run([example, label]))  <span class=\"hljs-comment\">#&#x6267;&#x884c;&#x8bfb;&#x53d6;op, &#x5e76;&#x6253;&#x5370;&#x7ed3;&#x679c;</span>\n\n        <span class=\"hljs-comment\"># &#x7b49;&#x5f85;&#x7ebf;&#x7a0b;&#x7ed3;&#x675f;&#xff0c;&#x5e76;&#x56de;&#x6536;&#x8d44;&#x6e90;</span>\n        coord.request_stop()\n        coord.join()\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"49,104"}},{"content":"<pre data-lines=\"105,163\"><code class=\"language-python\"><span class=\"hljs-comment\"># 03_img_reader.py</span>\n<span class=\"hljs-comment\"># &#x56fe;&#x50cf;&#x8bfb;&#x53d6;&#x793a;&#x4f8b;</span>\n<span class=\"hljs-keyword\">import</span> tensorflow <span class=\"hljs-keyword\">as</span> tf\n<span class=\"hljs-keyword\">import</span> os\n\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">img_read</span>(<span class=\"hljs-params\">filelist</span>):\n    <span class=\"hljs-comment\"># &#x6784;&#x5efa;&#x6587;&#x4ef6;&#x961f;&#x5217;</span>\n    file_queue = tf.train.string_input_producer(filelist)\n    <span class=\"hljs-comment\"># &#x5b9a;&#x4e49;reader&#xff0c;&#x8bfb;&#x53d6;&#x6587;&#x4ef6;&#x5185;&#x5bb9;</span>\n    reader = tf.WholeFileReader()\n    k, v = reader.read(file_queue)\n    <span class=\"hljs-comment\"># &#x89e3;&#x7801;</span>\n    img = tf.image.decode_jpeg(v)\n\n    <span class=\"hljs-comment\"># &#x6279;&#x5904;&#x7406;</span>\n    img_resized = tf.image.resize(img, [<span class=\"hljs-number\">200</span>, <span class=\"hljs-number\">200</span>]) <span class=\"hljs-comment\"># &#x8bbe;&#x7f6e;&#x56fe;&#x50cf;&#x5927;&#x5c0f;</span>\n    img_resized.set_shape([<span class=\"hljs-number\">200</span>, <span class=\"hljs-number\">200</span>, <span class=\"hljs-number\">3</span>]) <span class=\"hljs-comment\"># &#x8bbe;&#x7f6e;&#x9759;&#x6001;&#x5f62;&#x72b6;&#xff0c;&#x6279;&#x5904;&#x7406;&#x5bf9;&#x5927;&#x5c0f;&#x6709;&#x8981;&#x6c42;</span>\n    img_bat = tf.train.batch([img_resized],\n                             batch_size=<span class=\"hljs-number\">10</span>,\n                             num_threads=<span class=\"hljs-number\">1</span>)\n    <span class=\"hljs-keyword\">return</span> img_bat\n\n<span class=\"hljs-keyword\">if</span> __name__ == <span class=\"hljs-string\">&quot;__main__&quot;</span>:\n    dir_name = <span class=\"hljs-string\">&quot;../test_img/&quot;</span> <span class=\"hljs-comment\"># &#x6570;&#x636e;&#x6587;&#x4ef6;&#x76ee;&#x5f55;</span>\n    file_names = os.listdir(dir_name) <span class=\"hljs-comment\"># &#x5217;&#x51fa;&#x76ee;&#x5f55;&#x4e0b;&#x6240;&#x6709;&#x6587;&#x4ef6;</span>\n    file_list = []\n    <span class=\"hljs-keyword\">for</span> f <span class=\"hljs-keyword\">in</span> file_names:\n        <span class=\"hljs-comment\"># &#x76ee;&#x5f55;&#x3001;&#x6587;&#x4ef6;&#x540d;&#x62fc;&#x63a5;&#x6210;&#x5b8c;&#x6574;&#x8def;&#x5f84;&#xff0c;&#x5e76;&#x52a0;&#x5165;&#x6587;&#x4ef6;&#x8def;&#x5f84;&#x5217;&#x8868;</span>\n        file_list.append(os.path.join(dir_name, f))\n\n    imgs = img_read(file_list) <span class=\"hljs-comment\"># &#x8bfb;&#x53d6;&#x6587;&#x4ef6;&#x3001;&#x89e3;&#x7801;&#x3001;&#x8fd4;&#x56de;&#x6279;&#x6b21;</span>\n\n    <span class=\"hljs-keyword\">with</span> tf.Session() <span class=\"hljs-keyword\">as</span> sess:\n        coord = tf.train.Coordinator() <span class=\"hljs-comment\"># &#x7ebf;&#x7a0b;&#x534f;&#x8c03;&#x5668;</span>\n        <span class=\"hljs-comment\"># &#x8fd4;&#x56de;&#x4e00;&#x7ec4;&#x7ebf;&#x7a0b;</span>\n        threads = tf.train.start_queue_runners(sess, coord=coord)\n        imgs_data = imgs.<span class=\"hljs-built_in\">eval</span>() <span class=\"hljs-comment\"># &#x6267;&#x884c;imgs&#x64cd;&#x4f5c;&#xff0c;&#x8fd4;&#x56de;&#x7684;&#x56fe;&#x50cf;&#x6570;&#x636e;&#x5b58;&#x5165;imgs&#x53d8;&#x91cf;</span>\n\n        <span class=\"hljs-comment\"># &#x7b49;&#x5f85;&#x7ebf;&#x7a0b;&#x7ed3;&#x675f;&#xff0c;&#x5e76;&#x56de;&#x6536;&#x8d44;&#x6e90;</span>\n        coord.request_stop()\n        coord.join()\n\n<span class=\"hljs-comment\">## &#x663e;&#x793a;&#x56fe;&#x7247;</span>\n<span class=\"hljs-built_in\">print</span>(imgs_data.shape)\n<span class=\"hljs-keyword\">import</span> matplotlib.pyplot <span class=\"hljs-keyword\">as</span> plt\n\nplt.figure(<span class=\"hljs-string\">&quot;Img Show&quot;</span>, facecolor=<span class=\"hljs-string\">&quot;lightgray&quot;</span>)\n\n<span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(<span class=\"hljs-number\">10</span>):\n    plt.subplot(<span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">5</span>, i+<span class=\"hljs-number\">1</span>)\n    plt.xticks([])\n    plt.yticks([])\n    plt.imshow(imgs_data[i].astype(<span class=\"hljs-string\">&quot;int32&quot;</span>))\n\nplt.tight_layout()\nplt.show()\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"105,163"}},{"content":"<pre data-lines=\"164,255\"><code class=\"language-python\"><span class=\"hljs-comment\"># 04_mnist.py</span>\n<span class=\"hljs-comment\"># &#x624b;&#x5199;&#x4f53;&#x8bc6;&#x522b;&#x793a;&#x4f8b;</span>\n<span class=\"hljs-keyword\">import</span> tensorflow <span class=\"hljs-keyword\">as</span> tf\n<span class=\"hljs-keyword\">from</span> tensorflow.examples.tutorials.mnist <span class=\"hljs-keyword\">import</span> input_data\n<span class=\"hljs-keyword\">import</span> pylab\n\n<span class=\"hljs-comment\"># &#x8bfb;&#x5165;&#x6570;&#x636e;&#x96c6;</span>\nmnist = input_data.read_data_sets(<span class=\"hljs-string\">&quot;MNIST_data/&quot;</span>, one_hot=<span class=\"hljs-literal\">True</span>)\n\nx = tf.placeholder(tf.float32, [<span class=\"hljs-literal\">None</span>, <span class=\"hljs-number\">784</span>]) <span class=\"hljs-comment\"># N&#x4e2a;&#x6837;&#x672c;&#xff0c;&#x6bcf;&#x4e2a;&#x6837;&#x672c;784&#x4e2a;&#x7279;&#x5f81;</span>\ny = tf.placeholder(tf.float32, [<span class=\"hljs-literal\">None</span>, <span class=\"hljs-number\">10</span>]) <span class=\"hljs-comment\"># N&#x4e2a;&#x6837;&#x672c;&#xff0c;&#x6bcf;&#x4e2a;&#x6837;&#x672c;10&#x4e2a;&#x6982;&#x7387;&#x503c;</span>\n\nw = tf.Variable(tf.random_normal([<span class=\"hljs-number\">784</span>, <span class=\"hljs-number\">10</span>])) <span class=\"hljs-comment\"># &#x6743;&#x91cd;</span>\nb = tf.Variable(tf.zeros([<span class=\"hljs-number\">10</span>])) <span class=\"hljs-comment\"># &#x504f;&#x7f6e;</span>\n\n<span class=\"hljs-comment\"># &#x6784;&#x5efa;&#x5168;&#x8fde;&#x63a5;&#x6a21;&#x578b;</span>\npred_y = tf.nn.softmax(tf.matmul(x, w) + b) <span class=\"hljs-comment\"># &#x795e;&#x7ecf;&#x7f51;&#x7edc;&#x8ba1;&#x7b97;&#x5e76;&#x505a;softmax&#x6fc0;&#x6d3b;&#x8fd0;&#x884c;</span>\n<span class=\"hljs-built_in\">print</span>(pred_y.shape)\n\n<span class=\"hljs-comment\"># &#x635f;&#x5931;&#x51fd;&#x6570;</span>\ncross_entorpy = -tf.reduce_sum(y * tf.log(pred_y), reduction_indices=<span class=\"hljs-number\">1</span>)\ncost = tf.reduce_mean(cross_entorpy)\n<span class=\"hljs-comment\"># &#x4f18;&#x5316;&#x5668;</span>\noptimizer = tf.train.GradientDescentOptimizer(<span class=\"hljs-number\">0.01</span>).minimize(cost)\n\ntraining_epochs = <span class=\"hljs-number\">50</span>\nbatch_size = <span class=\"hljs-number\">100</span> <span class=\"hljs-comment\"># &#x6279;&#x6b21;&#x5927;&#x5c0f;</span>\nsaver = tf.train.Saver()\nmodel_path = <span class=\"hljs-string\">&quot;../model/mnist/mnist_model.ckpt&quot;</span> <span class=\"hljs-comment\"># &#x6a21;&#x578b;&#x8def;&#x5f84;</span>\n\n<span class=\"hljs-keyword\">with</span> tf.Session() <span class=\"hljs-keyword\">as</span> sess:\n    sess.run(tf.global_variables_initializer()) <span class=\"hljs-comment\"># &#x6267;&#x884c;&#x521d;&#x59cb;&#x5316;op</span>\n\n    <span class=\"hljs-comment\"># &#x5faa;&#x73af;&#x8bad;&#x7ec3;</span>\n    <span class=\"hljs-keyword\">for</span> epoch <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(training_epochs):\n        <span class=\"hljs-comment\"># &#x8ba1;&#x7b97;&#x6bcf;&#x8f6e;&#x6b21;&#x4e0b;&#x8bad;&#x7ec3;&#x7684;&#x6279;&#x6b21;&#x6570;&#x91cf;</span>\n        total_batch = <span class=\"hljs-built_in\">int</span>(mnist.train.num_examples / batch_size)\n        avg_cost = <span class=\"hljs-number\">0.0</span>  <span class=\"hljs-comment\"># &#x635f;&#x5931;&#x503c;</span>\n\n        <span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(total_batch):\n            batch_xs, batch_ys = mnist.train.next_batch(batch_size) <span class=\"hljs-comment\"># &#x8bfb;&#x53d6;&#x4e00;&#x4e2a;&#x6279;&#x6b21;&#x6837;&#x672c;</span>\n            params = {x:batch_xs, y:batch_ys} <span class=\"hljs-comment\"># &#x8bad;&#x7ec3;&#x65f6;&#x8981;&#x4f20;&#x5165;&#x7684;&#x53c2;&#x6570;</span>\n\n            o, c = sess.run([optimizer, cost], <span class=\"hljs-comment\"># &#x8981;&#x6267;&#x884c;&#x7684;op</span>\n                            feed_dict=params) <span class=\"hljs-comment\"># &#x5582;&#x5165;&#x7684;&#x6570;&#x636e;</span>\n            avg_cost += (c / total_batch) <span class=\"hljs-comment\"># &#x6c42;&#x5e73;&#x5747;&#x635f;&#x5931;&#x503c;</span>\n\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;epoch: %d, cost=%f&quot;</span> % (epoch+<span class=\"hljs-number\">1</span>, avg_cost))\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;&#x8bad;&#x7ec3;&#x7ed3;&#x675f;!&quot;</span>)\n\n    <span class=\"hljs-comment\"># &#x6a21;&#x578b;&#x8bc4;&#x4f30;</span>\n    correct_pred = tf.equal(tf.argmax(pred_y, <span class=\"hljs-number\">1</span>), <span class=\"hljs-comment\"># &#x53d6;&#x51fa;&#x9884;&#x6d4b;&#x503c;&#x6700;&#x5927;&#x7684;&#x503c;&#x7684;&#x7d22;&#x5f15;</span>\n                            tf.argmax(y, <span class=\"hljs-number\">1</span>)) <span class=\"hljs-comment\"># &#x53d6;&#x51fa;&#x771f;&#x5b9e;&#x7ed3;&#x679c;&#x6700;&#x5927;&#x7684;&#x503c;&#x7684;&#x7d22;&#x5f15;</span>\n    <span class=\"hljs-comment\"># &#x5148;&#x5c06;&#x4e0a;&#x4e00;&#x884c;&#x5f97;&#x5230;&#x5e03;&#x5c14;&#x7c7b;&#x578b;&#x7684;&#x6570;&#x7ec4;&#x8fdb;&#x884c;&#x8f6c;&#x6362;&#xff0c;True&#x8f6c;&#x6362;&#x4e3a;1&#xff0c;False&#x8f6c;&#x4e3a;0</span>\n    <span class=\"hljs-comment\"># &#x7136;&#x540e;&#x6c42;&#x5747;&#x503c;(&#x5747;&#x503c;&#x7684;&#x8ba1;&#x7b97;&#x516c;&#x5f0f;&#x6b63;&#x597d;&#x548c;&#x51c6;&#x786e;&#x7387;&#x4e00;&#x6837;  &#x7d2f;&#x52a0;&#x503c;/&#x4e2a;&#x6570;)</span>\n    accuracy = tf.reduce_mean(tf.cast(correct_pred, tf.float32))\n    <span class=\"hljs-comment\"># &#x5582;&#x5165;&#x6d4b;&#x8bd5;&#x96c6;&#x4e2d;&#x7684;&#x56fe;&#x50cf;&#x3001;&#x6807;&#x7b7e;&#x8ba1;&#x7b97;accuracy&#x503c;</span>\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;accuracy:&quot;</span>, accuracy.<span class=\"hljs-built_in\">eval</span>({x:mnist.test.images,\n                                      y:mnist.test.labels}))\n    <span class=\"hljs-comment\"># &#x4fdd;&#x5b58;&#x6a21;&#x578b;</span>\n    save_path = saver.save(sess, model_path)\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;Model Saved:&quot;</span>, save_path)\n\n<span class=\"hljs-comment\"># &#x6a21;&#x578b;&#x6d4b;&#x8bd5;</span>\n<span class=\"hljs-keyword\">with</span> tf.Session() <span class=\"hljs-keyword\">as</span> sess:\n    sess.run(tf.global_variables_initializer())\n    saver.restore(sess, model_path) <span class=\"hljs-comment\"># &#x52a0;&#x8f7d;&#x6a21;&#x578b;</span>\n\n    <span class=\"hljs-comment\"># &#x8bfb;&#x53d6;&#x4e24;&#x4e2a;&#x6837;&#x672c;&#x8fdb;&#x884c;&#x6d4b;&#x8bd5;</span>\n    batch_xs, batch_ys = mnist.test.next_batch(<span class=\"hljs-number\">2</span>)\n    output = tf.argmax(pred_y, <span class=\"hljs-number\">1</span>) <span class=\"hljs-comment\"># &#x6267;&#x884c;&#x9884;&#x6d4b;&#xff0c;&#x5e76;&#x8fd4;&#x56de;&#x9884;&#x6d4b;&#x7ed3;&#x679c;&#x6700;&#x5927;&#x7684;&#x503c;&#x7684;&#x7d22;&#x5f15;</span>\n\n    output_val, predv = sess.run([output, pred_y], <span class=\"hljs-comment\"># &#x8981;&#x6267;&#x884c;&#x7684;op</span>\n                                 feed_dict={x:batch_xs}) <span class=\"hljs-comment\"># &#x9884;&#x6d4b;&#x65f6;&#x53ea;&#x9700;&#x8981;&#x4f20;&#x5165;&#x56fe;&#x50cf;</span>\n\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;&#x9884;&#x6d4b;&#x7ed3;&#x8bba;:\\n&quot;</span>, output_val, <span class=\"hljs-string\">&quot;\\n&quot;</span>)\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;&#x5b9e;&#x9645;&#x7ed3;&#x679c;:\\n&quot;</span>, batch_ys, <span class=\"hljs-string\">&quot;\\n&quot;</span>)\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;&#x9884;&#x6d4b;&#x6982;&#x7387;:\\n&quot;</span>, predv, <span class=\"hljs-string\">&quot;\\n&quot;</span>)\n\n    <span class=\"hljs-comment\"># &#x663e;&#x793a;&#x56fe;&#x7247;</span>\n    im = batch_xs[<span class=\"hljs-number\">0</span>]  <span class=\"hljs-comment\"># &#x7b2c;1&#x4e2a;&#x6d4b;&#x8bd5;&#x6837;&#x672c;&#x6570;&#x636e;</span>\n    im = im.reshape(-<span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">28</span>)\n    pylab.imshow(im)\n    pylab.show()\n\n    im = batch_xs[<span class=\"hljs-number\">1</span>]  <span class=\"hljs-comment\"># &#x7b2c;2&#x4e2a;&#x6d4b;&#x8bd5;&#x6837;&#x672c;&#x6570;&#x636e;</span>\n    im = im.reshape(-<span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">28</span>)\n    pylab.imshow(im)\n    pylab.show()\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"164,255"}}],"payload":{"tag":"h5","lines":"4,5"}}],"payload":{"tag":"h3","lines":"0,1"}},{})</script>
</body>
</html>
