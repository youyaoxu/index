<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets@11.11.1/styles/default.min.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.18.10/dist/browser/index.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/index.js"></script><script>(r => {
              setTimeout(r);
            })(function renderToolbar() {
  const {
    markmap,
    mm
  } = window;
  const {
    el
  } = markmap.Toolbar.create(mm);
  el.setAttribute('style', 'position:absolute;bottom:20px;right:20px');
  document.body.append(el);
})</script><script>((getMarkmap, getOptions, root2, jsonOptions) => {
              const markmap = getMarkmap();
              window.mm = markmap.Markmap.create(
                "svg#mindmap",
                (getOptions || markmap.deriveOptions)(jsonOptions),
                root2
              );
            })(() => window.markmap,null,{"content":"ReactDOM.render","children":[{"content":"ReactDOM.render","children":[{"content":"<pre data-lines=\"4,7\"><code>&#x521b;&#x5efa;`ReactRoot`&#xff0c;&#x5e76;&#x4e14;&#x6839;&#x636e;&#x60c5;&#x51b5;&#x8c03;&#x7528;`root.legacy_renderSubtreeIntoContainer`&#x6216;&#x8005;`root.render`&#xff0c;&#x524d;&#x8005;&#x662f;&#x9057;&#x7559;&#x7684; API &#x5c06;&#x6765;&#x5e94;&#x8be5;&#x4f1a;&#x5220;&#x9664;&#xff0c;&#x6839;&#x636e;`ReactDOM.render`&#x7684;&#x8c03;&#x7528;&#x60c5;&#x51b5;&#x4e5f;&#x53ef;&#x4ee5;&#x53d1;&#x73b0;`parentComponent`&#x662f;&#x5199;&#x6b7b;&#x7684;`null`\n\n`DOMRenderer.unbatchedUpdates`&#x5236;&#x5b9a;&#x4e0d;&#x4f7f;&#x7528;`batchedUpdates`&#xff0c;&#x56e0;&#x4e3a;&#x8fd9;&#x662f;&#x521d;&#x6b21;&#x6e32;&#x67d3;&#xff0c;&#x9700;&#x8981;&#x5c3d;&#x5feb;&#x5b8c;&#x6210;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"4,7"}},{"content":"<pre data-lines=\"8,61\"><code data-lines=\"8,61\"><span class=\"hljs-title class_\">ReactDOM</span> = {\n  <span class=\"hljs-title function_\">render</span>(<span class=\"hljs-params\">\n    <span class=\"hljs-attr\">element</span>: <span class=\"hljs-title class_\">React</span>&#x24;<span class=\"hljs-title class_\">Element</span>&lt;<span class=\"hljs-built_in\">any</span>&gt;,\n    <span class=\"hljs-attr\">container</span>: <span class=\"hljs-title class_\">DOMContainer</span>,\n    <span class=\"hljs-attr\">callback</span>: ?<span class=\"hljs-title class_\">Function</span>,\n  </span>) {\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-title function_\">legacyRenderSubtreeIntoContainer</span>(\n      <span class=\"hljs-literal\">null</span>,\n      element,\n      container,\n      <span class=\"hljs-literal\">false</span>,\n      callback,\n    )\n  },\n}\n\n<span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">legacyRenderSubtreeIntoContainer</span>(<span class=\"hljs-params\">\n  <span class=\"hljs-attr\">parentComponent</span>: ?<span class=\"hljs-title class_\">React</span>&#x24;<span class=\"hljs-title class_\">Component</span>&lt;<span class=\"hljs-built_in\">any</span>, <span class=\"hljs-built_in\">any</span>&gt;,\n  <span class=\"hljs-attr\">children</span>: <span class=\"hljs-title class_\">ReactNodeList</span>,\n  <span class=\"hljs-attr\">container</span>: <span class=\"hljs-title class_\">DOMContainer</span>,\n  <span class=\"hljs-attr\">forceHydrate</span>: <span class=\"hljs-built_in\">boolean</span>,\n  <span class=\"hljs-attr\">callback</span>: ?<span class=\"hljs-title class_\">Function</span>,\n</span>) {\n  <span class=\"hljs-keyword\">let</span> <span class=\"hljs-attr\">root</span>: <span class=\"hljs-title class_\">Root</span> = (container.<span class=\"hljs-property\">_reactRootContainer</span>: <span class=\"hljs-built_in\">any</span>)\n  <span class=\"hljs-keyword\">if</span> (!root) {\n    \n    root = container.<span class=\"hljs-property\">_reactRootContainer</span> = <span class=\"hljs-title function_\">legacyCreateRootFromDOMContainer</span>(\n      container,\n      forceHydrate,\n    )\n    <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-keyword\">typeof</span> callback === <span class=\"hljs-string\">&apos;function&apos;</span>) {\n      <span class=\"hljs-keyword\">const</span> originalCallback = callback\n      callback = <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>) {\n        <span class=\"hljs-keyword\">const</span> instance = <span class=\"hljs-title class_\">DOMRenderer</span>.<span class=\"hljs-title function_\">getPublicRootInstance</span>(root.<span class=\"hljs-property\">_internalRoot</span>)\n        originalCallback.<span class=\"hljs-title function_\">call</span>(instance)\n      }\n    }\n    \n    <span class=\"hljs-title class_\">DOMRenderer</span>.<span class=\"hljs-title function_\">unbatchedUpdates</span>(<span class=\"hljs-function\">() =&gt;</span> {\n      <span class=\"hljs-keyword\">if</span> (parentComponent != <span class=\"hljs-literal\">null</span>) {\n        \n      } <span class=\"hljs-keyword\">else</span> {\n        root.<span class=\"hljs-title function_\">render</span>(children, callback)\n      }\n    })\n  } <span class=\"hljs-keyword\">else</span> {\n    \n  }\n  <span class=\"hljs-keyword\">return</span> <span class=\"hljs-title class_\">DOMRenderer</span>.<span class=\"hljs-title function_\">getPublicRootInstance</span>(root.<span class=\"hljs-property\">_internalRoot</span>)\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"8,61"}},{"content":"<pre data-lines=\"62,67\"><code>&#x9996;&#x5148;&#x4f1a;&#x521b;&#x5efa;`ReactRoot`&#x5bf9;&#x8c61;&#xff0c;&#x7136;&#x540e;&#x8c03;&#x7528;&#x4ed6;&#x7684;`render`&#x65b9;&#x6cd5;\n\n&#x521b;&#x5efa;`ReactRoot`&#x7684;&#x65f6;&#x5019;&#x4f1a;&#x8c03;&#x7528;`DOMRenderer.createContainer`&#x521b;&#x5efa;`FiberRoot`&#xff0c;&#x5728;&#x540e;&#x671f;&#x8c03;&#x5ea6;&#x66f4;&#x65b0;&#x7684;&#x8fc7;&#x7a0b;&#x4e2d;&#x8fd9;&#x4e2a;&#x8282;&#x70b9;&#x975e;&#x5e38;&#x91cd;&#x8981;\n\n&#x8fd9;&#x4e24;&#x4e2a;&#x6570;&#x636e;&#x7ed3;&#x6784;&#x770b;[&#x8fd9;&#x91cc;](https://react.jokcy.me/book/api/react-structure.html)\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"62,67"}},{"content":"<pre data-lines=\"68,115\"><code data-lines=\"68,115\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">legacyCreateRootFromDOMContainer</span>(<span class=\"hljs-params\">\n  container: DOMContainer,\n  forceHydrate: boolean,\n</span>): <span class=\"hljs-title class_\">Root</span> {\n  <span class=\"hljs-keyword\">const</span> shouldHydrate =\n    forceHydrate || <span class=\"hljs-title function_\">shouldHydrateDueToLegacyHeuristic</span>(container)\n  \n  <span class=\"hljs-keyword\">if</span> (!shouldHydrate) {\n    <span class=\"hljs-keyword\">let</span> warned = <span class=\"hljs-literal\">false</span>\n    <span class=\"hljs-keyword\">let</span> rootSibling\n    <span class=\"hljs-keyword\">while</span> ((rootSibling = container.<span class=\"hljs-property\">lastChild</span>)) {\n      container.<span class=\"hljs-title function_\">removeChild</span>(rootSibling)\n    }\n  }\n  \n  <span class=\"hljs-keyword\">const</span> isConcurrent = <span class=\"hljs-literal\">false</span>\n  <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">ReactRoot</span>(container, isConcurrent, shouldHydrate)\n}\n\n<span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">ReactRoot</span>(<span class=\"hljs-params\">\n  container: Container,\n  isConcurrent: boolean,\n  hydrate: boolean,\n</span>) {\n  <span class=\"hljs-keyword\">const</span> root = <span class=\"hljs-title class_\">DOMRenderer</span>.<span class=\"hljs-title function_\">createContainer</span>(container, isConcurrent, hydrate)\n  <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">_internalRoot</span> = root\n}\n\n<span class=\"hljs-title class_\">ReactRoot</span>.<span class=\"hljs-property\"><span class=\"hljs-keyword\">prototype</span></span>.<span class=\"hljs-property\">render</span> = <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">\n  children: ReactNodeList,\n  callback: ?() =&gt; mixed,\n</span>): <span class=\"hljs-title class_\">Work</span> {\n  <span class=\"hljs-keyword\">const</span> root = <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">_internalRoot</span>\n  <span class=\"hljs-keyword\">const</span> work = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">ReactWork</span>()\n  callback = callback === <span class=\"hljs-literal\">undefined</span> ? <span class=\"hljs-literal\">null</span> : callback\n  <span class=\"hljs-keyword\">if</span> (__DEV__) {\n    <span class=\"hljs-title function_\">warnOnInvalidCallback</span>(callback, <span class=\"hljs-string\">&apos;render&apos;</span>)\n  }\n  <span class=\"hljs-keyword\">if</span> (callback !== <span class=\"hljs-literal\">null</span>) {\n    work.<span class=\"hljs-title function_\">then</span>(callback)\n  }\n  <span class=\"hljs-title class_\">DOMRenderer</span>.<span class=\"hljs-title function_\">updateContainer</span>(children, root, <span class=\"hljs-literal\">null</span>, work.<span class=\"hljs-property\">_onCommit</span>)\n  <span class=\"hljs-keyword\">return</span> work\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"68,115"}},{"content":"<pre data-lines=\"116,121\"><code>&#x5176;&#x4e2d;`DOMRenderer`&#x662f;`react-reconciler/src/ReactFiberReconciler`&#xff0c;&#x4ed6;&#x7684;`updateContainer`&#x5982;&#x4e0b;&#x5728;&#x8fd9;&#x91cc;&#x8ba1;&#x7b97;&#x4e86;&#x4e00;&#x4e2a;&#x65f6;&#x95f4;&#xff0c;&#x8fd9;&#x4e2a;&#x65f6;&#x95f4;&#x53eb;&#x505a;`expirationTime`&#xff0c;&#x987e;&#x540d;&#x601d;&#x4e49;&#x5c31;&#x662f;&#x8fd9;&#x6b21;&#x66f4;&#x65b0;&#x7684; **&#x8d85;&#x65f6;&#x65f6;&#x95f4;**&#x3002;\n\n&#x5173;&#x4e8e;&#x65f6;&#x95f4;&#x662f;&#x5982;&#x4f55;&#x8ba1;&#x7b97;&#x7684;[&#x770b;&#x8fd9;&#x91cc;](https://react.jokcy.me/book/update/expiration-time.html)\n\n&#x7136;&#x540e;&#x8c03;&#x7528;&#x4e86;`updateContainerAtExpirationTime`&#xff0c;&#x5728;&#x8fd9;&#x4e2a;&#x65b9;&#x6cd5;&#x91cc;&#x8c03;&#x7528;&#x4e86;`scheduleRootUpdate`&#x5c31;&#x975e;&#x5e38;&#x91cd;&#x8981;&#x4e86;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"116,121"}},{"content":"<pre data-lines=\"122,161\"><code data-lines=\"122,161\"><span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">updateContainer</span>(<span class=\"hljs-params\">\n  <span class=\"hljs-attr\">element</span>: <span class=\"hljs-title class_\">ReactNodeList</span>,\n  <span class=\"hljs-attr\">container</span>: <span class=\"hljs-title class_\">OpaqueRoot</span>,\n  <span class=\"hljs-attr\">parentComponent</span>: ?<span class=\"hljs-title class_\">React</span>&#x24;<span class=\"hljs-title class_\">Component</span>&lt;<span class=\"hljs-built_in\">any</span>, <span class=\"hljs-built_in\">any</span>&gt;,\n  <span class=\"hljs-attr\">callback</span>: ?<span class=\"hljs-title class_\">Function</span>,\n</span>): <span class=\"hljs-title class_\">ExpirationTime</span> {\n  <span class=\"hljs-keyword\">const</span> current = container.<span class=\"hljs-property\">current</span>\n  <span class=\"hljs-keyword\">const</span> currentTime = <span class=\"hljs-title function_\">requestCurrentTime</span>()\n  <span class=\"hljs-keyword\">const</span> expirationTime = <span class=\"hljs-title function_\">computeExpirationForFiber</span>(currentTime, current)\n  <span class=\"hljs-keyword\">return</span> <span class=\"hljs-title function_\">updateContainerAtExpirationTime</span>(\n    element,\n    container,\n    parentComponent,\n    expirationTime,\n    callback,\n  )\n}\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">updateContainerAtExpirationTime</span>(<span class=\"hljs-params\">\n  <span class=\"hljs-attr\">element</span>: <span class=\"hljs-title class_\">ReactNodeList</span>,\n  <span class=\"hljs-attr\">container</span>: <span class=\"hljs-title class_\">OpaqueRoot</span>,\n  <span class=\"hljs-attr\">parentComponent</span>: ?<span class=\"hljs-title class_\">React</span>&#x24;<span class=\"hljs-title class_\">Component</span>&lt;<span class=\"hljs-built_in\">any</span>, <span class=\"hljs-built_in\">any</span>&gt;,\n  <span class=\"hljs-attr\">expirationTime</span>: <span class=\"hljs-title class_\">ExpirationTime</span>,\n  <span class=\"hljs-attr\">callback</span>: ?<span class=\"hljs-title class_\">Function</span>,\n</span>) {\n  \n  <span class=\"hljs-keyword\">const</span> current = container.<span class=\"hljs-property\">current</span>\n  <span class=\"hljs-keyword\">const</span> context = <span class=\"hljs-title function_\">getContextForSubtree</span>(parentComponent)\n  <span class=\"hljs-keyword\">if</span> (container.<span class=\"hljs-property\">context</span> === <span class=\"hljs-literal\">null</span>) {\n    container.<span class=\"hljs-property\">context</span> = context\n  } <span class=\"hljs-keyword\">else</span> {\n    container.<span class=\"hljs-property\">pendingContext</span> = context\n  }\n\n  <span class=\"hljs-keyword\">return</span> <span class=\"hljs-title function_\">scheduleRootUpdate</span>(current, element, expirationTime, callback)\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"122,161"}},{"content":"<pre data-lines=\"162,167\"><code>&#x9996;&#x5148;&#x8981;&#x751f;&#x6210;&#x4e00;&#x4e2a;`update`&#xff0c;&#x4e0d;&#x7ba1;&#x4f60;&#x662f;`setState`&#x8fd8;&#x662f;`ReactDOM.render`&#x9020;&#x6210;&#x7684; React &#x66f4;&#x65b0;&#xff0c;&#x90fd;&#x4f1a;&#x751f;&#x6210;&#x4e00;&#x4e2a;&#x53eb;`update`&#x7684;&#x5bf9;&#x8c61;&#xff0c;&#x5e76;&#x4e14;&#x4f1a;&#x8d4b;&#x503c;&#x7ed9;`Fiber.updateQueue`\n\n&#x5173;&#x4e8e;`update`&#x8bf7;[&#x770b;&#x8fd9;&#x91cc;](https://react.jokcy.me/book/api/react-structure.html)\n\n&#x7136;&#x540e;&#x5c31;&#x662f;&#x8c03;&#x7528;`scheduleWork`&#x3002;&#x6ce8;&#x610f;&#x5230;&#x8fd9;&#x91cc;&#x4e4b;&#x524d;`setState`&#x548c;`ReactDOM.render`&#x662f;&#x4e0d;&#x4e00;&#x6837;&#xff0c;&#x4f46;&#x8fdb;&#x5165;`schedulerWork`&#x4e4b;&#x540e;&#xff0c;&#x5c31;&#x662f;&#x4efb;&#x52a1;&#x8c03;&#x5ea6;&#x7684;&#x4e8b;&#x60c5;&#x4e86;&#xff0c;&#x8ddf;&#x4e4b;&#x524d;&#x4f60;&#x662f;&#x600e;&#x4e48;&#x8c03;&#x7528;&#x7684;&#x6ca1;&#x6709;&#x4efb;&#x4f55;&#x5173;&#x7cfb;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"162,167"}},{"content":"<pre data-lines=\"168,196\"><code data-lines=\"168,196\"><span class=\"hljs-keyword\">function</span> scheduleRootUpdate(\n  <span class=\"hljs-keyword\">current</span>: Fiber,\n  element: ReactNodeList,\n  expirationTime: ExpirationTime,\n  callback: ?<span class=\"hljs-keyword\">Function</span>,\n) {\n  const <span class=\"hljs-keyword\">update</span> = createUpdate(expirationTime)\n\n  <span class=\"hljs-keyword\">update</span>.payload = { element }\n\n  callback = callback === undefined ? <span class=\"hljs-keyword\">null</span> : callback\n  <span class=\"hljs-keyword\">if</span> (callback !== <span class=\"hljs-keyword\">null</span>) {\n    warningWithoutStack(\n      typeof callback === <span class=\"hljs-string\">&apos;function&apos;</span>,\n      <span class=\"hljs-string\">&apos;render(...): Expected the last optional `callback` argument to be a &apos;</span> +\n        <span class=\"hljs-string\">&apos;function. Instead received: %s.&apos;</span>,\n      callback,\n    )\n    <span class=\"hljs-keyword\">update</span>.callback = callback\n  }\n  enqueueUpdate(<span class=\"hljs-keyword\">current</span>, <span class=\"hljs-keyword\">update</span>)\n\n  scheduleWork(<span class=\"hljs-keyword\">current</span>, expirationTime)\n  <span class=\"hljs-keyword\">return</span> expirationTime\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"168,196"}},{"content":"<img src=\"https://static.coursebetter.com/202112/Jokcy%E7%9A%84%E4%BA%8C%E7%BB%B4%E7%A0%81.png\" alt>","children":[],"payload":{"tag":"img","lines":"197,198"}},{"content":"<pre data-lines=\"199,200\"><code>&#x626b;&#x7801;&#x6dfb;&#x52a0;Jokcy&#xff0c;&#x66f4;&#x591a;&#x66f4;&#x65b0;&#x66f4;&#x4f18;&#x8d28;&#x7684;&#x524d;&#x7aef;&#x5b66;&#x4e60;&#x5185;&#x5bb9;&#x4e0d;&#x65ad;&#x66f4;&#x65b0;&#x4e2d;&#xff0c;&#x671f;&#x5f85;&#x4e0e;&#x4f60;&#x4e00;&#x8d77;&#x6210;&#x957f;&#xff01;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"199,200"}},{"content":"<img src=\"https://static.coursebetter.com/202112/Jokcy%E7%9A%84%E4%BA%8C%E7%BB%B4%E7%A0%81.png\" alt>","children":[],"payload":{"tag":"img","lines":"201,202"}}],"payload":{"tag":"h3","lines":"2,3"}}],"payload":{"tag":"h1","lines":"0,1"}},{})</script>
</body>
</html>
