<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets@11.11.1/styles/default.min.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.18.10/dist/browser/index.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/index.js"></script><script>(r => {
              setTimeout(r);
            })(function renderToolbar() {
  const {
    markmap,
    mm
  } = window;
  const {
    el
  } = markmap.Toolbar.create(mm);
  el.setAttribute('style', 'position:absolute;bottom:20px;right:20px');
  document.body.append(el);
})</script><script>((getMarkmap, getOptions, root2, jsonOptions) => {
              const markmap = getMarkmap();
              window.mm = markmap.Markmap.create(
                "svg#mindmap",
                (getOptions || markmap.deriveOptions)(jsonOptions),
                root2
              );
            })(() => window.markmap,null,{"content":"","children":[{"content":"&#x4f7f;&#x7528;&#x6307;&#x5357;","children":[{"content":"<pre data-lines=\"2,15\"><code data-lines=\"2,15\">&#x8def;&#x7531;\n&#x7f16;&#x5199;&#x4e2d;&#x95f4;&#x4ef6;\n&#x4f7f;&#x7528;&#x4e2d;&#x95f4;&#x4ef6;\n&#x91cd;&#x5199; Express API\n&#x4f7f;&#x7528;&#x6a21;&#x677f;&#x5f15;&#x64ce;\n&#x9519;&#x8bef;&#x5904;&#x7406;\n&#x8c03;&#x8bd5;\n&#x4ee3;&#x7406;&#x80cc;&#x540e;&#x7684; Express\n&#x8fc1;&#x79fb;&#x5230; Express 4\n&#x8fc1;&#x79fb;&#x5230; Express 5\n&#x6570;&#x636e;&#x5e93;&#x96c6;&#x6210;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2,15"}}],"payload":{"tag":"h1","lines":"0,1"}},{"content":"&#x8def;&#x7531;&#x4e2d;&#x82f1;","children":[{"content":"&#x8def;&#x7531;&#x65b9;&#x6cd5;&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"56,67\"><code class=\"language-js\"><span class=\"hljs-comment\">// GET method route</span>\napp.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;/&apos;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res</span>) =&gt;</span> {\n  res.<span class=\"hljs-title function_\">send</span>(<span class=\"hljs-string\">&apos;GET request to the homepage&apos;</span>)\n})\n\n<span class=\"hljs-comment\">// POST method route</span>\napp.<span class=\"hljs-title function_\">post</span>(<span class=\"hljs-string\">&apos;/&apos;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res</span>) =&gt;</span> {\n  res.<span class=\"hljs-title function_\">send</span>(<span class=\"hljs-string\">&apos;POST request to the homepage&apos;</span>)\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"56,67"}},{"content":"<pre data-lines=\"73,79\"><code class=\"language-js\">app.<span class=\"hljs-title function_\">all</span>(<span class=\"hljs-string\">&apos;/secret&apos;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res, next</span>) =&gt;</span> {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;Accessing the secret section ...&apos;</span>)\n  <span class=\"hljs-title function_\">next</span>() <span class=\"hljs-comment\">// pass control to the next handler</span>\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"73,79"}}],"payload":{"tag":"h2","lines":"50,51"}},{"content":"&#x8def;&#x7531;&#x8def;&#x5f84;&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"96,101\"><code class=\"language-js\">app.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;/&apos;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res</span>) =&gt;</span> {\n  res.<span class=\"hljs-title function_\">send</span>(<span class=\"hljs-string\">&apos;root&apos;</span>)\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"96,101"}},{"content":"<pre data-lines=\"104,109\"><code class=\"language-js\">app.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;/about&apos;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res</span>) =&gt;</span> {\n  res.<span class=\"hljs-title function_\">send</span>(<span class=\"hljs-string\">&apos;about&apos;</span>)\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"104,109"}},{"content":"<pre data-lines=\"112,117\"><code class=\"language-js\">app.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;/random.text&apos;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res</span>) =&gt;</span> {\n  res.<span class=\"hljs-title function_\">send</span>(<span class=\"hljs-string\">&apos;random.text&apos;</span>)\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"112,117"}},{"content":"<pre data-lines=\"122,127\"><code class=\"language-js\">app.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;/ab?cd&apos;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res</span>) =&gt;</span> {\n  res.<span class=\"hljs-title function_\">send</span>(<span class=\"hljs-string\">&apos;ab?cd&apos;</span>)\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"122,127"}},{"content":"<pre data-lines=\"130,135\"><code class=\"language-js\">app.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;/ab+cd&apos;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res</span>) =&gt;</span> {\n  res.<span class=\"hljs-title function_\">send</span>(<span class=\"hljs-string\">&apos;ab+cd&apos;</span>)\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"130,135"}},{"content":"<pre data-lines=\"138,143\"><code class=\"language-js\">app.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;/ab*cd&apos;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res</span>) =&gt;</span> {\n  res.<span class=\"hljs-title function_\">send</span>(<span class=\"hljs-string\">&apos;ab*cd&apos;</span>)\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"138,143"}},{"content":"<pre data-lines=\"146,151\"><code class=\"language-js\">app.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;/ab(cd)?e&apos;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res</span>) =&gt;</span> {\n  res.<span class=\"hljs-title function_\">send</span>(<span class=\"hljs-string\">&apos;ab(cd)?e&apos;</span>)\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"146,151"}},{"content":"<pre data-lines=\"156,161\"><code class=\"language-js\">app.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-regexp\">/a/</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res</span>) =&gt;</span> {\n  res.<span class=\"hljs-title function_\">send</span>(<span class=\"hljs-string\">&apos;/a/&apos;</span>)\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"156,161"}},{"content":"<pre data-lines=\"164,169\"><code class=\"language-js\">app.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-regexp\">/.*fly&#x24;/</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res</span>) =&gt;</span> {\n  res.<span class=\"hljs-title function_\">send</span>(<span class=\"hljs-string\">&apos;/.*fly&#x24;/&apos;</span>)\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"164,169"}}],"payload":{"tag":"h2","lines":"80,81"}},{"content":"&#x8def;&#x7531;&#x53c2;&#x6570;&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"174,179\"><code data-lines=\"174,179\">Route path: <span class=\"hljs-regexp\">/users/</span>:userId<span class=\"hljs-regexp\">/books/</span>:bookId\nRequest URL: http:<span class=\"hljs-regexp\">//</span>localhost:<span class=\"hljs-number\">3000</span><span class=\"hljs-regexp\">/users/</span><span class=\"hljs-number\">34</span><span class=\"hljs-regexp\">/books/</span><span class=\"hljs-number\">8989</span>\nreq.params: { <span class=\"hljs-string\">&quot;userId&quot;</span>: <span class=\"hljs-string\">&quot;34&quot;</span>, <span class=\"hljs-string\">&quot;bookId&quot;</span>: <span class=\"hljs-string\">&quot;8989&quot;</span> }\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"174,179"}},{"content":"<pre data-lines=\"182,187\"><code class=\"language-js\">app.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;/users/:userId/books/:bookId&apos;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res</span>) =&gt;</span> {\n  res.<span class=\"hljs-title function_\">send</span>(req.<span class=\"hljs-property\">params</span>)\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"182,187"}},{"content":"<pre data-lines=\"192,200\"><code class=\"language-js\"><span class=\"hljs-title class_\">Route</span> <span class=\"hljs-attr\">path</span>: <span class=\"hljs-regexp\">/flights/</span>:<span class=\"hljs-keyword\">from</span>-:to\n<span class=\"hljs-title class_\">Request</span> <span class=\"hljs-attr\">URL</span>: <span class=\"hljs-attr\">http</span>:<span class=\"hljs-comment\">//localhost:3000/flights/LAX-SFO</span>\nreq.<span class=\"hljs-property\">params</span>: { <span class=\"hljs-string\">&quot;from&quot;</span>: <span class=\"hljs-string\">&quot;LAX&quot;</span>, <span class=\"hljs-string\">&quot;to&quot;</span>: <span class=\"hljs-string\">&quot;SFO&quot;</span> }\n<span class=\"hljs-title class_\">Route</span> <span class=\"hljs-attr\">path</span>: <span class=\"hljs-regexp\">/plantae/</span>:genus.:species\n<span class=\"hljs-title class_\">Request</span> <span class=\"hljs-attr\">URL</span>: <span class=\"hljs-attr\">http</span>:<span class=\"hljs-comment\">//localhost:3000/plantae/Prunus.persica</span>\nreq.<span class=\"hljs-property\">params</span>: { <span class=\"hljs-string\">&quot;genus&quot;</span>: <span class=\"hljs-string\">&quot;Prunus&quot;</span>, <span class=\"hljs-string\">&quot;species&quot;</span>: <span class=\"hljs-string\">&quot;persica&quot;</span> }\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"192,200"}},{"content":"<pre data-lines=\"203,208\"><code class=\"language-js\"><span class=\"hljs-title class_\">Route</span> <span class=\"hljs-attr\">path</span>: <span class=\"hljs-regexp\">/user/</span>:<span class=\"hljs-title function_\">userId</span>(\\d+)\n<span class=\"hljs-title class_\">Request</span> <span class=\"hljs-attr\">URL</span>: <span class=\"hljs-attr\">http</span>:<span class=\"hljs-comment\">//localhost:3000/user/42</span>\nreq.<span class=\"hljs-property\">params</span>: {<span class=\"hljs-string\">&quot;userId&quot;</span>: <span class=\"hljs-string\">&quot;42&quot;</span>}\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"203,208"}}],"payload":{"tag":"h2","lines":"170,171"}},{"content":"&#x8def;&#x7531;&#x5904;&#x7406;&#x7a0b;&#x5e8f;&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"221,226\"><code class=\"language-js\">app.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;/example/a&apos;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res</span>) =&gt;</span> {\n  res.<span class=\"hljs-title function_\">send</span>(<span class=\"hljs-string\">&apos;Hello from A!&apos;</span>)\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"221,226"}},{"content":"<pre data-lines=\"229,237\"><code class=\"language-js\">app.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;/example/b&apos;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res, next</span>) =&gt;</span> {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;the response will be sent by the next function ...&apos;</span>)\n  <span class=\"hljs-title function_\">next</span>()\n}, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res</span>) =&gt;</span> {\n  res.<span class=\"hljs-title function_\">send</span>(<span class=\"hljs-string\">&apos;Hello from B!&apos;</span>)\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"229,237"}},{"content":"<pre data-lines=\"240,257\"><code class=\"language-js\"><span class=\"hljs-keyword\">const</span> cb0 = <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res, next</span>) {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;CB0&apos;</span>)\n  <span class=\"hljs-title function_\">next</span>()\n}\n\n<span class=\"hljs-keyword\">const</span> cb1 = <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res, next</span>) {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;CB1&apos;</span>)\n  <span class=\"hljs-title function_\">next</span>()\n}\n\n<span class=\"hljs-keyword\">const</span> cb2 = <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res</span>) {\n  res.<span class=\"hljs-title function_\">send</span>(<span class=\"hljs-string\">&apos;Hello from C!&apos;</span>)\n}\n\napp.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;/example/c&apos;</span>, [cb0, cb1, cb2])\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"240,257"}},{"content":"<pre data-lines=\"260,278\"><code class=\"language-js\"><span class=\"hljs-keyword\">const</span> cb0 = <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res, next</span>) {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;CB0&apos;</span>)\n  <span class=\"hljs-title function_\">next</span>()\n}\n\n<span class=\"hljs-keyword\">const</span> cb1 = <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res, next</span>) {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;CB1&apos;</span>)\n  <span class=\"hljs-title function_\">next</span>()\n}\n\napp.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;/example/d&apos;</span>, [cb0, cb1], <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res, next</span>) =&gt;</span> {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;the response will be sent by the next function ...&apos;</span>)\n  <span class=\"hljs-title function_\">next</span>()\n}, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res</span>) =&gt;</span> {\n  res.<span class=\"hljs-title function_\">send</span>(<span class=\"hljs-string\">&apos;Hello from D!&apos;</span>)\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"260,278"}}],"payload":{"tag":"h2","lines":"213,214"}},{"content":"&#x54cd;&#x5e94;&#x65b9;&#x6cd5;&#x4e2d;&#x82f1;","children":[],"payload":{"tag":"h2","lines":"279,280"}},{"content":"app.route()&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"300,312\"><code class=\"language-js\">app.<span class=\"hljs-title function_\">route</span>(<span class=\"hljs-string\">&apos;/book&apos;</span>)\n  .<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-function\">(<span class=\"hljs-params\">req, res</span>) =&gt;</span> {\n    res.<span class=\"hljs-title function_\">send</span>(<span class=\"hljs-string\">&apos;Get a random book&apos;</span>)\n  })\n  .<span class=\"hljs-title function_\">post</span>(<span class=\"hljs-function\">(<span class=\"hljs-params\">req, res</span>) =&gt;</span> {\n    res.<span class=\"hljs-title function_\">send</span>(<span class=\"hljs-string\">&apos;Add a book&apos;</span>)\n  })\n  .<span class=\"hljs-title function_\">put</span>(<span class=\"hljs-function\">(<span class=\"hljs-params\">req, res</span>) =&gt;</span> {\n    res.<span class=\"hljs-title function_\">send</span>(<span class=\"hljs-string\">&apos;Update the book&apos;</span>)\n  })\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"300,312"}}],"payload":{"tag":"h2","lines":"294,295"}},{"content":"express.Router&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"321,342\"><code class=\"language-js\">\n<span class=\"hljs-keyword\">const</span> express = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;express&apos;</span>)\n<span class=\"hljs-keyword\">const</span> router = express.<span class=\"hljs-title class_\">Router</span>()\n\n<span class=\"hljs-comment\">// middleware that is specific to this router</span>\nrouter.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-function\">(<span class=\"hljs-params\">req, res, next</span>) =&gt;</span> {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;Time: &apos;</span>, <span class=\"hljs-title class_\">Date</span>.<span class=\"hljs-title function_\">now</span>())\n  <span class=\"hljs-title function_\">next</span>()\n})\n<span class=\"hljs-comment\">// define the home page route</span>\nrouter.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;/&apos;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res</span>) =&gt;</span> {\n  res.<span class=\"hljs-title function_\">send</span>(<span class=\"hljs-string\">&apos;Birds home page&apos;</span>)\n})\n<span class=\"hljs-comment\">// define the about route</span>\nrouter.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;/about&apos;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res</span>) =&gt;</span> {\n  res.<span class=\"hljs-title function_\">send</span>(<span class=\"hljs-string\">&apos;About birds&apos;</span>)\n})\n\n<span class=\"hljs-variable language_\">module</span>.<span class=\"hljs-property\">exports</span> = router\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"321,342"}},{"content":"<pre data-lines=\"344,351\"><code class=\"language-js\"><span class=\"hljs-keyword\">const</span> birds = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;./birds&apos;</span>)\n\n<span class=\"hljs-comment\">// ...</span>\n\napp.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-string\">&apos;/birds&apos;</span>, birds)\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"344,351"}},{"content":"<pre data-lines=\"354,366\"><code data-lines=\"354,366\">\n&#x5c0f;&#x7ed3;\n\n&#x8def;&#x7531;&#x65b9;&#x6cd5;\n&#x8def;&#x7531;&#x8def;&#x5f84;\n&#x8def;&#x7531;&#x53c2;&#x6570;\n&#x8def;&#x7531;&#x5904;&#x7406;&#x7a0b;&#x5e8f;\n&#x54cd;&#x5e94;&#x65b9;&#x6cd5;\napp<span class=\"hljs-selector-class\">.route</span>()\nexpress<span class=\"hljs-selector-class\">.Router</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"354,366"}}],"payload":{"tag":"h2","lines":"313,314"}}],"payload":{"tag":"h1","lines":"16,17"}},{"content":"&#x7f16;&#x5199;&#x4e2d;&#x95f4;&#x4ef6;","children":[{"content":"<pre data-lines=\"371,379\"><code data-lines=\"371,379\">&#x6982;&#x8ff0;\n&#x793a;&#x4f8b;\n<span class=\"hljs-bullet\">- </span>&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570; myLogger\n<span class=\"hljs-bullet\">- </span>&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570; requestTime\n<span class=\"hljs-bullet\">- </span>&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570; validateCookies\n&#x53ef;&#x914d;&#x7f6e;&#x7684;&#x4e2d;&#x95f4;&#x4ef6;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"371,379"}},{"content":"&#x6982;&#x8ff0;","children":[{"content":"<pre data-lines=\"382,394\"><code>&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x662f;&#x5728;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x7684;&#x8bf7;&#x6c42;-&#x54cd;&#x5e94;&#x5468;&#x671f;&#x4e2d;&#x53ef;&#x4ee5;&#x8bbf;&#x95ee; &#x8bf7;&#x6c42;&#x5bf9;&#x8c61; (req)&#x3001;&#x54cd;&#x5e94;&#x5bf9;&#x8c61; (res) &#x548c; next &#x51fd;&#x6570;&#x7684;&#x51fd;&#x6570;&#x3002;next &#x51fd;&#x6570;&#x662f; Express &#x8def;&#x7531;&#x4e2d;&#x7684;&#x4e00;&#x4e2a;&#x51fd;&#x6570;&#xff0c;&#x5f53;&#x88ab;&#x8c03;&#x7528;&#x65f6;&#xff0c;&#x5b83;&#x4f1a;&#x5728;&#x5f53;&#x524d;&#x4e2d;&#x95f4;&#x4ef6;&#x4e4b;&#x540e;&#x6267;&#x884c;&#x4e2d;&#x95f4;&#x4ef6;&#x3002;\n\n&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x53ef;&#x4ee5;&#x6267;&#x884c;&#x4ee5;&#x4e0b;&#x4efb;&#x52a1;&#xff1a;\n\n- &#x6267;&#x884c;&#x4efb;&#x4f55;&#x4ee3;&#x7801;&#x3002;\n- &#x66f4;&#x6539;&#x8bf7;&#x6c42;&#x548c;&#x54cd;&#x5e94;&#x5bf9;&#x8c61;&#x3002;\n- &#x7ed3;&#x675f;&#x8bf7;&#x6c42;-&#x54cd;&#x5e94;&#x5468;&#x671f;&#x3002;\n- &#x8c03;&#x7528;&#x5806;&#x6808;&#x4e2d;&#x7684;&#x4e0b;&#x4e00;&#x4e2a;&#x4e2d;&#x95f4;&#x4ef6;&#x3002;\n\n&#x5982;&#x679c;&#x5f53;&#x524d;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x6ca1;&#x6709;&#x7ed3;&#x675f;&#x8bf7;&#x6c42;-&#x54cd;&#x5e94;&#x5faa;&#x73af;&#xff0c;&#x5b83;&#x5fc5;&#x987b;&#x8c03;&#x7528; next() &#x5c06;&#x63a7;&#x5236;&#x6743;&#x4f20;&#x9012;&#x7ed9;&#x4e0b;&#x4e00;&#x4e2a;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x3002;&#x5426;&#x5219;&#xff0c;&#x8bf7;&#x6c42;&#x5c06;&#x88ab;&#x6302;&#x8d77;&#x3002;\n\n&#x4e0b;&#x56fe;&#x663e;&#x793a;&#x4e86;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x8c03;&#x7528;&#x7684;&#x5143;&#x7d20;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"382,394"}}],"payload":{"tag":"h2","lines":"380,381"}},{"content":"&#x793a;&#x4f8b;","children":[{"content":"&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570; myLogger","children":[{"content":"<pre data-lines=\"410,431\"><code class=\"language-js\"><span class=\"hljs-keyword\">const</span> myLogger = <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res, next</span>) {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;LOGGED&apos;</span>)\n  <span class=\"hljs-title function_\">next</span>()\n}\n<span class=\"hljs-keyword\">const</span> express = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;express&apos;</span>)\n<span class=\"hljs-keyword\">const</span> app = <span class=\"hljs-title function_\">express</span>()\n\n<span class=\"hljs-keyword\">const</span> myLogger = <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res, next</span>) {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;LOGGED&apos;</span>)\n  <span class=\"hljs-title function_\">next</span>()\n}\n\napp.<span class=\"hljs-title function_\">use</span>(myLogger)\n\napp.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;/&apos;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res</span>) =&gt;</span> {\n  res.<span class=\"hljs-title function_\">send</span>(<span class=\"hljs-string\">&apos;Hello World!&apos;</span>)\n})\n\napp.<span class=\"hljs-title function_\">listen</span>(<span class=\"hljs-number\">3000</span>)\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"410,431"}}],"payload":{"tag":"h3","lines":"408,409"}},{"content":"&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570; requestTime","children":[{"content":"<pre data-lines=\"434,457\"><code class=\"language-js\"><span class=\"hljs-keyword\">const</span> requestTime = <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res, next</span>) {\n  req.<span class=\"hljs-property\">requestTime</span> = <span class=\"hljs-title class_\">Date</span>.<span class=\"hljs-title function_\">now</span>()\n  <span class=\"hljs-title function_\">next</span>()\n}\n<span class=\"hljs-keyword\">const</span> express = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;express&apos;</span>)\n<span class=\"hljs-keyword\">const</span> app = <span class=\"hljs-title function_\">express</span>()\n\n<span class=\"hljs-keyword\">const</span> requestTime = <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res, next</span>) {\n  req.<span class=\"hljs-property\">requestTime</span> = <span class=\"hljs-title class_\">Date</span>.<span class=\"hljs-title function_\">now</span>()\n  <span class=\"hljs-title function_\">next</span>()\n}\n\napp.<span class=\"hljs-title function_\">use</span>(requestTime)\n\napp.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;/&apos;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res</span>) =&gt;</span> {\n  <span class=\"hljs-keyword\">let</span> responseText = <span class=\"hljs-string\">&apos;Hello World!&lt;br&gt;&apos;</span>\n  responseText += <span class=\"hljs-string\">`&lt;small&gt;Requested at: <span class=\"hljs-subst\">&#x24;{req.requestTime}</span>&lt;/small&gt;`</span>\n  res.<span class=\"hljs-title function_\">send</span>(responseText)\n})\n\napp.<span class=\"hljs-title function_\">listen</span>(<span class=\"hljs-number\">3000</span>)\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"434,457"}}],"payload":{"tag":"h3","lines":"432,433"}},{"content":"&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570; validateCookies","children":[{"content":"<pre data-lines=\"460,490\"><code class=\"language-js\"><span class=\"hljs-keyword\">async</span> <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">cookieValidator</span> (<span class=\"hljs-params\">cookies</span>) {\n  <span class=\"hljs-keyword\">try</span> {\n    <span class=\"hljs-keyword\">await</span> <span class=\"hljs-title function_\">externallyValidateCookie</span>(cookies.<span class=\"hljs-property\">testCookie</span>)\n  } <span class=\"hljs-keyword\">catch</span> {\n    <span class=\"hljs-keyword\">throw</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Error</span>(<span class=\"hljs-string\">&apos;Invalid cookies&apos;</span>)\n  }\n}\n<span class=\"hljs-keyword\">const</span> express = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;express&apos;</span>)\n<span class=\"hljs-keyword\">const</span> cookieParser = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;cookie-parser&apos;</span>)\n<span class=\"hljs-keyword\">const</span> cookieValidator = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;./cookieValidator&apos;</span>)\n\n<span class=\"hljs-keyword\">const</span> app = <span class=\"hljs-title function_\">express</span>()\n\n<span class=\"hljs-keyword\">async</span> <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">validateCookies</span> (<span class=\"hljs-params\">req, res, next</span>) {\n  <span class=\"hljs-keyword\">await</span> <span class=\"hljs-title function_\">cookieValidator</span>(req.<span class=\"hljs-property\">cookies</span>)\n  <span class=\"hljs-title function_\">next</span>()\n}\n\napp.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-title function_\">cookieParser</span>())\n\napp.<span class=\"hljs-title function_\">use</span>(validateCookies)\n\n<span class=\"hljs-comment\">// error handler</span>\napp.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-function\">(<span class=\"hljs-params\">err, req, res, next</span>) =&gt;</span> {\n  res.<span class=\"hljs-title function_\">status</span>(<span class=\"hljs-number\">400</span>).<span class=\"hljs-title function_\">send</span>(err.<span class=\"hljs-property\">message</span>)\n})\n\napp.<span class=\"hljs-title function_\">listen</span>(<span class=\"hljs-number\">3000</span>)\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"460,490"}}],"payload":{"tag":"h3","lines":"458,459"}}],"payload":{"tag":"h2","lines":"395,396"}},{"content":"&#x53ef;&#x914d;&#x7f6e;&#x7684;&#x4e2d;&#x95f4;&#x4ef6;","children":[{"content":"<pre data-lines=\"493,504\"><code class=\"language-js\"><span class=\"hljs-variable language_\">module</span>.<span class=\"hljs-property\">exports</span> = <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">options</span>) {\n  <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res, next</span>) {\n    <span class=\"hljs-comment\">// Implement the middleware function based on the options object</span>\n    <span class=\"hljs-title function_\">next</span>()\n  }\n}\n<span class=\"hljs-keyword\">const</span> mw = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;./my-middleware.js&apos;</span>)\n\napp.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-title function_\">mw</span>({ <span class=\"hljs-attr\">option1</span>: <span class=\"hljs-string\">&apos;1&apos;</span>, <span class=\"hljs-attr\">option2</span>: <span class=\"hljs-string\">&apos;2&apos;</span> }))\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"493,504"}},{"content":"<pre data-lines=\"505,514\"><code data-lines=\"505,514\">&#x5c0f;&#x7ed3;\n\n&#x793a;&#x4f8b;\n<span class=\"hljs-bullet\">- </span>&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570; myLogger\n<span class=\"hljs-bullet\">- </span>&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570; requestTime\n<span class=\"hljs-bullet\">- </span>&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570; validateCookies\n&#x53ef;&#x914d;&#x7f6e;&#x7684;&#x4e2d;&#x95f4;&#x4ef6;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"505,514"}}],"payload":{"tag":"h2","lines":"491,492"}}],"payload":{"tag":"h1","lines":"367,368"}},{"content":"&#x4f7f;&#x7528;&#x4e2d;&#x95f4;&#x4ef6;&#x4e2d;&#x82f1;","children":[{"content":"","children":[{"content":"<pre data-lines=\"519,528\"><code data-lines=\"519,528\">&#x9884;&#x544a;\n\n&#x5e94;&#x7528;&#x7ea7;&#x4e2d;&#x95f4;&#x4ef6;\n&#x8def;&#x7531;&#x7ea7;&#x4e2d;&#x95f4;&#x4ef6;\n&#x9519;&#x8bef;&#x5904;&#x7406;&#x4e2d;&#x95f4;&#x4ef6;\n&#x5185;&#x7f6e;&#x4e2d;&#x95f4;&#x4ef6;\n&#x7b2c;&#x4e09;&#x65b9;&#x4e2d;&#x95f4;&#x4ef6;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"519,528"}},{"content":"<pre data-lines=\"529,553\"><code>Express &#x662f;&#x4e00;&#x4e2a;&#x8def;&#x7531;&#x548c;&#x4e2d;&#x95f4;&#x4ef6; Web &#x6846;&#x67b6;&#xff0c;&#x5176;&#x81ea;&#x8eab;&#x529f;&#x80fd;&#x6700;&#x5c11;&#xff1a;Express &#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x672c;&#x8d28;&#x4e0a;&#x662f;&#x4e00;&#x7cfb;&#x5217;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x8c03;&#x7528;&#x3002;\n\n&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x662f;&#x53ef;&#x4ee5;&#x8bbf;&#x95ee;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x8bf7;&#x6c42;-&#x54cd;&#x5e94;&#x5468;&#x671f;&#x4e2d;&#x7684; &#x8bf7;&#x6c42;&#x5bf9;&#x8c61; (req)&#x3001;&#x54cd;&#x5e94;&#x5bf9;&#x8c61; (res) &#x548c;&#x4e0b;&#x4e00;&#x4e2a;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x7684;&#x51fd;&#x6570;&#x3002;&#x4e0b;&#x4e00;&#x4e2a;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x901a;&#x5e38;&#x7531;&#x4e00;&#x4e2a;&#x540d;&#x4e3a; next &#x7684;&#x53d8;&#x91cf;&#x8868;&#x793a;&#x3002;\n\n&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x53ef;&#x4ee5;&#x6267;&#x884c;&#x4ee5;&#x4e0b;&#x4efb;&#x52a1;&#xff1a;\n\n- &#x6267;&#x884c;&#x4efb;&#x4f55;&#x4ee3;&#x7801;&#x3002;\n\n- &#x66f4;&#x6539;&#x8bf7;&#x6c42;&#x548c;&#x54cd;&#x5e94;&#x5bf9;&#x8c61;&#x3002;\n\n- &#x7ed3;&#x675f;&#x8bf7;&#x6c42;-&#x54cd;&#x5e94;&#x5468;&#x671f;&#x3002;\n\n- &#x8c03;&#x7528;&#x5806;&#x6808;&#x4e2d;&#x7684;&#x4e0b;&#x4e00;&#x4e2a;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x3002;\n\n&#x5982;&#x679c;&#x5f53;&#x524d;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x6ca1;&#x6709;&#x7ed3;&#x675f;&#x8bf7;&#x6c42;-&#x54cd;&#x5e94;&#x5faa;&#x73af;&#xff0c;&#x5b83;&#x5fc5;&#x987b;&#x8c03;&#x7528; next() &#x5c06;&#x63a7;&#x5236;&#x6743;&#x4f20;&#x9012;&#x7ed9;&#x4e0b;&#x4e00;&#x4e2a;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x3002;&#x5426;&#x5219;&#xff0c;&#x8bf7;&#x6c42;&#x5c06;&#x88ab;&#x6302;&#x8d77;&#x3002;\n\nExpress &#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x53ef;&#x4ee5;&#x4f7f;&#x7528;&#x4ee5;&#x4e0b;&#x7c7b;&#x578b;&#x7684;&#x4e2d;&#x95f4;&#x4ef6;&#xff1a;\n\n&#x5e94;&#x7528;&#x7ea7;&#x4e2d;&#x95f4;&#x4ef6;\n&#x8def;&#x7531;&#x7ea7;&#x4e2d;&#x95f4;&#x4ef6;\n&#x9519;&#x8bef;&#x5904;&#x7406;&#x4e2d;&#x95f4;&#x4ef6;\n&#x5185;&#x7f6e;&#x4e2d;&#x95f4;&#x4ef6;\n&#x7b2c;&#x4e09;&#x65b9;&#x4e2d;&#x95f4;&#x4ef6;\n&#x60a8;&#x53ef;&#x4ee5;&#x4f7f;&#x7528;&#x53ef;&#x9009;&#x7684;&#x6302;&#x8f7d;&#x8def;&#x5f84;&#x52a0;&#x8f7d;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x7ea7;&#x548c;&#x8def;&#x7531;&#x7ea7;&#x4e2d;&#x95f4;&#x4ef6;&#x3002;&#x60a8;&#x8fd8;&#x53ef;&#x4ee5;&#x5c06;&#x4e00;&#x7cfb;&#x5217;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x4e00;&#x8d77;&#x52a0;&#x8f7d;&#xff0c;&#x4ece;&#x800c;&#x5728;&#x6302;&#x8f7d;&#x70b9;&#x521b;&#x5efa;&#x4e2d;&#x95f4;&#x4ef6;&#x7cfb;&#x7edf;&#x7684;&#x5b50;&#x5806;&#x6808;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"529,553"}}],"payload":{"tag":"h2","lines":"517,518"}},{"content":"&#x5e94;&#x7528;&#x7ea7;&#x4e2d;&#x95f4;&#x4ef6;&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"555,558\"><code>&#x4f7f;&#x7528; app.use() &#x548c; app.METHOD() &#x51fd;&#x6570;&#x5c06;&#x5e94;&#x7528;&#x7ea7;&#x4e2d;&#x95f4;&#x4ef6;&#x7ed1;&#x5b9a;&#x5230; app &#x5bf9;&#x8c61; &#x7684;&#x5b9e;&#x4f8b;&#xff0c;&#x5176;&#x4e2d; METHOD &#x662f;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x5904;&#x7406;&#x7684;&#x8bf7;&#x6c42;&#x7684; HTTP &#x65b9;&#x6cd5;&#xff08;&#x5982; GET&#x3001;PUT &#x6216; POST&#xff09;&#xff0c;&#x5c0f;&#x5199;&#x3002;\n\n&#x6b64;&#x793a;&#x4f8b;&#x663e;&#x793a;&#x4e86;&#x4e00;&#x4e2a;&#x6ca1;&#x6709;&#x6302;&#x8f7d;&#x8def;&#x5f84;&#x7684;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x3002;&#x6bcf;&#x6b21;&#x5e94;&#x7528;&#x6536;&#x5230;&#x8bf7;&#x6c42;&#x65f6;&#x90fd;&#x4f1a;&#x6267;&#x884c;&#x8be5;&#x51fd;&#x6570;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"555,558"}},{"content":"<pre data-lines=\"559,568\"><code class=\"language-js\"><span class=\"hljs-keyword\">const</span> express = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;express&apos;</span>)\n<span class=\"hljs-keyword\">const</span> app = <span class=\"hljs-title function_\">express</span>()\n\napp.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-function\">(<span class=\"hljs-params\">req, res, next</span>) =&gt;</span> {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;Time:&apos;</span>, <span class=\"hljs-title class_\">Date</span>.<span class=\"hljs-title function_\">now</span>())\n  <span class=\"hljs-title function_\">next</span>()\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"559,568"}},{"content":"<pre data-lines=\"569,570\"><code>&#x8fd9;&#x4e2a;&#x4f8b;&#x5b50;&#x5c55;&#x793a;&#x4e86;&#x4e00;&#x4e2a;&#x6302;&#x8f7d;&#x5728; /user/:id &#x8def;&#x5f84;&#x4e0a;&#x7684;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x3002;&#x8be5;&#x51fd;&#x6570;&#x9488;&#x5bf9; /user/:id &#x8def;&#x5f84;&#x4e0a;&#x7684;&#x4efb;&#x4f55;&#x7c7b;&#x578b;&#x7684; HTTP &#x8bf7;&#x6c42;&#x6267;&#x884c;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"569,570"}},{"content":"<pre data-lines=\"571,577\"><code class=\"language-js\">app.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-string\">&apos;/user/:id&apos;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res, next</span>) =&gt;</span> {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;Request Type:&apos;</span>, req.<span class=\"hljs-property\">method</span>)\n  <span class=\"hljs-title function_\">next</span>()\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"571,577"}},{"content":"<pre data-lines=\"578,579\"><code>&#x8fd9;&#x4e2a;&#x4f8b;&#x5b50;&#x5c55;&#x793a;&#x4e86;&#x4e00;&#x4e2a;&#x8def;&#x7531;&#x548c;&#x5b83;&#x7684;&#x5904;&#x7406;&#x51fd;&#x6570;&#xff08;&#x4e2d;&#x95f4;&#x4ef6;&#x7cfb;&#x7edf;&#xff09;&#x3002;&#x8be5;&#x51fd;&#x6570;&#x5904;&#x7406;&#x5bf9; /user/:id &#x8def;&#x5f84;&#x7684; GET &#x8bf7;&#x6c42;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"578,579"}},{"content":"<pre data-lines=\"580,585\"><code class=\"language-js\">app.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;/user/:id&apos;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res, next</span>) =&gt;</span> {\n  res.<span class=\"hljs-title function_\">send</span>(<span class=\"hljs-string\">&apos;USER&apos;</span>)\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"580,585"}},{"content":"<pre data-lines=\"586,587\"><code>&#x8fd9;&#x662f;&#x4e00;&#x4e2a;&#x5728;&#x6302;&#x8f7d;&#x70b9;&#x52a0;&#x8f7d;&#x4e00;&#x7cfb;&#x5217;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x7684;&#x793a;&#x4f8b;&#xff0c;&#x5e26;&#x6709;&#x6302;&#x8f7d;&#x8def;&#x5f84;&#x3002;&#x5b83;&#x8bf4;&#x660e;&#x4e86;&#x4e00;&#x4e2a;&#x4e2d;&#x95f4;&#x4ef6;&#x5b50;&#x5806;&#x6808;&#xff0c;&#x5b83;&#x5c06;&#x4efb;&#x4f55;&#x7c7b;&#x578b;&#x7684; HTTP &#x8bf7;&#x6c42;&#x7684;&#x8bf7;&#x6c42;&#x4fe1;&#x606f;&#x6253;&#x5370;&#x5230; /user/:id &#x8def;&#x5f84;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"586,587"}},{"content":"<pre data-lines=\"588,597\"><code class=\"language-js\">app.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-string\">&apos;/user/:id&apos;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res, next</span>) =&gt;</span> {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;Request URL:&apos;</span>, req.<span class=\"hljs-property\">originalUrl</span>)\n  <span class=\"hljs-title function_\">next</span>()\n}, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res, next</span>) =&gt;</span> {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;Request Type:&apos;</span>, req.<span class=\"hljs-property\">method</span>)\n  <span class=\"hljs-title function_\">next</span>()\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"588,597"}},{"content":"<pre data-lines=\"598,601\"><code>&#x8def;&#x7531;&#x5904;&#x7406;&#x7a0b;&#x5e8f;&#x4f7f;&#x60a8;&#x80fd;&#x591f;&#x4e3a;&#x8def;&#x5f84;&#x5b9a;&#x4e49;&#x591a;&#x4e2a;&#x8def;&#x7531;&#x3002;&#x4e0b;&#x9762;&#x7684;&#x793a;&#x4f8b;&#x5b9a;&#x4e49;&#x4e86;&#x4e24;&#x6761;&#x5230; /user/:id &#x8def;&#x5f84;&#x7684; GET &#x8bf7;&#x6c42;&#x8def;&#x7531;&#x3002;&#x7b2c;&#x4e8c;&#x4e2a;&#x8def;&#x7531;&#x4e0d;&#x4f1a;&#x5f15;&#x8d77;&#x4efb;&#x4f55;&#x95ee;&#x9898;&#xff0c;&#x4f46;&#x5b83;&#x6c38;&#x8fdc;&#x4e0d;&#x4f1a;&#x88ab;&#x8c03;&#x7528;&#xff0c;&#x56e0;&#x4e3a;&#x7b2c;&#x4e00;&#x4e2a;&#x8def;&#x7531;&#x7ed3;&#x675f;&#x4e86;&#x8bf7;&#x6c42;-&#x54cd;&#x5e94;&#x5468;&#x671f;&#x3002;\n\n&#x6b64;&#x793a;&#x4f8b;&#x663e;&#x793a;&#x4e86;&#x4e00;&#x4e2a;&#x5904;&#x7406;&#x5bf9; /user/:id &#x8def;&#x5f84;&#x7684; GET &#x8bf7;&#x6c42;&#x7684;&#x4e2d;&#x95f4;&#x4ef6;&#x5b50;&#x5806;&#x6808;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"598,601"}},{"content":"<pre data-lines=\"602,615\"><code class=\"language-js\">app.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;/user/:id&apos;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res, next</span>) =&gt;</span> {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;ID:&apos;</span>, req.<span class=\"hljs-property\">params</span>.<span class=\"hljs-property\">id</span>)\n  <span class=\"hljs-title function_\">next</span>()\n}, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res, next</span>) =&gt;</span> {\n  res.<span class=\"hljs-title function_\">send</span>(<span class=\"hljs-string\">&apos;User Info&apos;</span>)\n})\n\n<span class=\"hljs-comment\">// handler for the /user/:id path, which prints the user ID</span>\napp.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;/user/:id&apos;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res, next</span>) =&gt;</span> {\n  res.<span class=\"hljs-title function_\">send</span>(req.<span class=\"hljs-property\">params</span>.<span class=\"hljs-property\">id</span>)\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"602,615"}},{"content":"<pre data-lines=\"616,619\"><code>&#x8981;&#x8df3;&#x8fc7;&#x8def;&#x7531;&#x4e2d;&#x95f4;&#x4ef6;&#x5806;&#x6808;&#x4e2d;&#x7684;&#x5176;&#x4f59;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#xff0c;&#x8bf7;&#x8c03;&#x7528; next(&apos;route&apos;) &#x5c06;&#x63a7;&#x5236;&#x6743;&#x4f20;&#x9012;&#x7ed9;&#x4e0b;&#x4e00;&#x4e2a;&#x8def;&#x7531;&#x3002;&#x6ce8;&#x610f;&#xff1a;next(&apos;route&apos;) &#x4ec5;&#x9002;&#x7528;&#x4e8e;&#x4f7f;&#x7528; app.METHOD() &#x6216; router.METHOD() &#x51fd;&#x6570;&#x52a0;&#x8f7d;&#x7684;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x3002;\n\n&#x6b64;&#x793a;&#x4f8b;&#x663e;&#x793a;&#x4e86;&#x4e00;&#x4e2a;&#x5904;&#x7406;&#x5bf9; /user/:id &#x8def;&#x5f84;&#x7684; GET &#x8bf7;&#x6c42;&#x7684;&#x4e2d;&#x95f4;&#x4ef6;&#x5b50;&#x5806;&#x6808;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"616,619"}},{"content":"<pre data-lines=\"620,636\"><code class=\"language-js\">app.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;/user/:id&apos;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res, next</span>) =&gt;</span> {\n  <span class=\"hljs-comment\">// if the user ID is 0, skip to the next route</span>\n  <span class=\"hljs-keyword\">if</span> (req.<span class=\"hljs-property\">params</span>.<span class=\"hljs-property\">id</span> === <span class=\"hljs-string\">&apos;0&apos;</span>) <span class=\"hljs-title function_\">next</span>(<span class=\"hljs-string\">&apos;route&apos;</span>)\n  <span class=\"hljs-comment\">// otherwise pass the control to the next middleware function in this stack</span>\n  <span class=\"hljs-keyword\">else</span> <span class=\"hljs-title function_\">next</span>()\n}, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res, next</span>) =&gt;</span> {\n  <span class=\"hljs-comment\">// send a regular response</span>\n  res.<span class=\"hljs-title function_\">send</span>(<span class=\"hljs-string\">&apos;regular&apos;</span>)\n})\n\n<span class=\"hljs-comment\">// handler for the /user/:id path, which sends a special response</span>\napp.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;/user/:id&apos;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res, next</span>) =&gt;</span> {\n  res.<span class=\"hljs-title function_\">send</span>(<span class=\"hljs-string\">&apos;special&apos;</span>)\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"620,636"}},{"content":"<pre data-lines=\"637,640\"><code>&#x4e2d;&#x95f4;&#x4ef6;&#x4e5f;&#x53ef;&#x4ee5;&#x5728;&#x6570;&#x7ec4;&#x4e2d;&#x58f0;&#x660e;&#x4ee5;&#x5b9e;&#x73b0;&#x53ef;&#x91cd;&#x7528;&#x6027;&#x3002;\n\n&#x6b64;&#x793a;&#x4f8b;&#x663e;&#x793a;&#x4e86;&#x4e00;&#x4e2a;&#x5e26;&#x6709;&#x4e2d;&#x95f4;&#x4ef6;&#x5b50;&#x5806;&#x6808;&#x7684;&#x6570;&#x7ec4;&#xff0c;&#x7528;&#x4e8e;&#x5904;&#x7406;&#x5bf9; /user/:id &#x8def;&#x5f84;&#x7684; GET &#x8bf7;&#x6c42;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"637,640"}},{"content":"<pre data-lines=\"641,657\"><code class=\"language-js\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">logOriginalUrl</span> (<span class=\"hljs-params\">req, res, next</span>) {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;Request URL:&apos;</span>, req.<span class=\"hljs-property\">originalUrl</span>)\n  <span class=\"hljs-title function_\">next</span>()\n}\n\n<span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">logMethod</span> (<span class=\"hljs-params\">req, res, next</span>) {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;Request Type:&apos;</span>, req.<span class=\"hljs-property\">method</span>)\n  <span class=\"hljs-title function_\">next</span>()\n}\n\n<span class=\"hljs-keyword\">const</span> logStuff = [logOriginalUrl, logMethod]\napp.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;/user/:id&apos;</span>, logStuff, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res, next</span>) =&gt;</span> {\n  res.<span class=\"hljs-title function_\">send</span>(<span class=\"hljs-string\">&apos;User Info&apos;</span>)\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"641,657"}}],"payload":{"tag":"h2","lines":"554,555"}},{"content":"&#x8def;&#x7531;&#x7ea7;&#x4e2d;&#x95f4;&#x4ef6;&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"660,666\"><code>&#x8def;&#x7531;&#x7ea7;&#x4e2d;&#x95f4;&#x4ef6;&#x7684;&#x5de5;&#x4f5c;&#x65b9;&#x5f0f;&#x4e0e;&#x5e94;&#x7528;&#x7ea7;&#x4e2d;&#x95f4;&#x4ef6;&#x76f8;&#x540c;&#xff0c;&#x53ea;&#x662f;&#x5b83;&#x7ed1;&#x5b9a;&#x5230; express.Router() &#x7684;&#x5b9e;&#x4f8b;&#x3002;\n\nconst router = express.Router()\n&#x4f7f;&#x7528; router.use() &#x548c; router.METHOD() &#x51fd;&#x6570;&#x52a0;&#x8f7d;&#x8def;&#x7531;&#x7ea7;&#x4e2d;&#x95f4;&#x4ef6;&#x3002;\n\n&#x4ee5;&#x4e0b;&#x793a;&#x4f8b;&#x4ee3;&#x7801;&#x901a;&#x8fc7;&#x4f7f;&#x7528;&#x8def;&#x7531;&#x7ea7;&#x4e2d;&#x95f4;&#x4ef6;&#x590d;&#x5236;&#x4e86;&#x4e0a;&#x9762;&#x663e;&#x793a;&#x7684;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x7ea7;&#x4e2d;&#x95f4;&#x4ef6;&#x7684;&#x4e2d;&#x95f4;&#x4ef6;&#x7cfb;&#x7edf;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"660,666"}},{"content":"<pre data-lines=\"667,707\"><code class=\"language-js\"><span class=\"hljs-keyword\">const</span> express = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;express&apos;</span>)\n<span class=\"hljs-keyword\">const</span> app = <span class=\"hljs-title function_\">express</span>()\n<span class=\"hljs-keyword\">const</span> router = express.<span class=\"hljs-title class_\">Router</span>()\n\n<span class=\"hljs-comment\">// a middleware function with no mount path. This code is executed for every request to the router</span>\nrouter.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-function\">(<span class=\"hljs-params\">req, res, next</span>) =&gt;</span> {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;Time:&apos;</span>, <span class=\"hljs-title class_\">Date</span>.<span class=\"hljs-title function_\">now</span>())\n  <span class=\"hljs-title function_\">next</span>()\n})\n\n<span class=\"hljs-comment\">// a middleware sub-stack shows request info for any type of HTTP request to the /user/:id path</span>\nrouter.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-string\">&apos;/user/:id&apos;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res, next</span>) =&gt;</span> {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;Request URL:&apos;</span>, req.<span class=\"hljs-property\">originalUrl</span>)\n  <span class=\"hljs-title function_\">next</span>()\n}, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res, next</span>) =&gt;</span> {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;Request Type:&apos;</span>, req.<span class=\"hljs-property\">method</span>)\n  <span class=\"hljs-title function_\">next</span>()\n})\n\n<span class=\"hljs-comment\">// a middleware sub-stack that handles GET requests to the /user/:id path</span>\nrouter.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;/user/:id&apos;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res, next</span>) =&gt;</span> {\n  <span class=\"hljs-comment\">// if the user ID is 0, skip to the next router</span>\n  <span class=\"hljs-keyword\">if</span> (req.<span class=\"hljs-property\">params</span>.<span class=\"hljs-property\">id</span> === <span class=\"hljs-string\">&apos;0&apos;</span>) <span class=\"hljs-title function_\">next</span>(<span class=\"hljs-string\">&apos;route&apos;</span>)\n  <span class=\"hljs-comment\">// otherwise pass control to the next middleware function in this stack</span>\n  <span class=\"hljs-keyword\">else</span> <span class=\"hljs-title function_\">next</span>()\n}, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res, next</span>) =&gt;</span> {\n  <span class=\"hljs-comment\">// render a regular page</span>\n  res.<span class=\"hljs-title function_\">render</span>(<span class=\"hljs-string\">&apos;regular&apos;</span>)\n})\n\n<span class=\"hljs-comment\">// handler for the /user/:id path, which renders a special page</span>\nrouter.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;/user/:id&apos;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res, next</span>) =&gt;</span> {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(req.<span class=\"hljs-property\">params</span>.<span class=\"hljs-property\">id</span>)\n  res.<span class=\"hljs-title function_\">render</span>(<span class=\"hljs-string\">&apos;special&apos;</span>)\n})\n\n<span class=\"hljs-comment\">// mount the router on the app</span>\napp.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-string\">&apos;/&apos;</span>, router)\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"667,707"}},{"content":"<pre data-lines=\"708,711\"><code>&#x8981;&#x8df3;&#x8fc7;&#x8def;&#x7531;&#x7684;&#x5176;&#x4f59;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#xff0c;&#x8bf7;&#x8c03;&#x7528; next(&apos;router&apos;) &#x5c06;&#x63a7;&#x5236;&#x6743;&#x4ece;&#x8def;&#x7531;&#x5b9e;&#x4f8b;&#x4f20;&#x56de;&#x3002;\n\n&#x6b64;&#x793a;&#x4f8b;&#x663e;&#x793a;&#x4e86;&#x4e00;&#x4e2a;&#x5904;&#x7406;&#x5bf9; /user/:id &#x8def;&#x5f84;&#x7684; GET &#x8bf7;&#x6c42;&#x7684;&#x4e2d;&#x95f4;&#x4ef6;&#x5b50;&#x5806;&#x6808;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"708,711"}},{"content":"<pre data-lines=\"712,732\"><code class=\"language-js\"><span class=\"hljs-keyword\">const</span> express = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;express&apos;</span>)\n<span class=\"hljs-keyword\">const</span> app = <span class=\"hljs-title function_\">express</span>()\n<span class=\"hljs-keyword\">const</span> router = express.<span class=\"hljs-title class_\">Router</span>()\n\n<span class=\"hljs-comment\">// predicate the router with a check and bail out when needed</span>\nrouter.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-function\">(<span class=\"hljs-params\">req, res, next</span>) =&gt;</span> {\n  <span class=\"hljs-keyword\">if</span> (!req.<span class=\"hljs-property\">headers</span>[<span class=\"hljs-string\">&apos;x-auth&apos;</span>]) <span class=\"hljs-keyword\">return</span> <span class=\"hljs-title function_\">next</span>(<span class=\"hljs-string\">&apos;router&apos;</span>)\n  <span class=\"hljs-title function_\">next</span>()\n})\n\nrouter.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;/user/:id&apos;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res</span>) =&gt;</span> {\n  res.<span class=\"hljs-title function_\">send</span>(<span class=\"hljs-string\">&apos;hello, user!&apos;</span>)\n})\n\n<span class=\"hljs-comment\">// use the router and 401 anything falling through</span>\napp.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-string\">&apos;/admin&apos;</span>, router, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res</span>) =&gt;</span> {\n  res.<span class=\"hljs-title function_\">sendStatus</span>(<span class=\"hljs-number\">401</span>)\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"712,732"}}],"payload":{"tag":"h2","lines":"658,659"}},{"content":"&#x9519;&#x8bef;&#x5904;&#x7406;&#x4e2d;&#x95f4;&#x4ef6;&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"735,738\"><code>&#x9519;&#x8bef;&#x5904;&#x7406;&#x4e2d;&#x95f4;&#x4ef6;&#x603b;&#x662f;&#x9700;&#x8981;&#x56db;&#x4e2a;&#x53c2;&#x6570;&#x3002;&#x60a8;&#x5fc5;&#x987b;&#x63d0;&#x4f9b;&#x56db;&#x4e2a;&#x53c2;&#x6570;&#x4ee5;&#x5c06;&#x5176;&#x6807;&#x8bc6;&#x4e3a;&#x9519;&#x8bef;&#x5904;&#x7406;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x3002;&#x5373;&#x4f7f;&#x60a8;&#x4e0d;&#x9700;&#x8981;&#x4f7f;&#x7528; next &#x5bf9;&#x8c61;&#xff0c;&#x60a8;&#x4e5f;&#x5fc5;&#x987b;&#x6307;&#x5b9a;&#x5b83;&#x6765;&#x7ef4;&#x62a4;&#x7b7e;&#x540d;&#x3002;&#x5426;&#x5219;&#xff0c;next &#x5bf9;&#x8c61;&#x5c06;&#x88ab;&#x89e3;&#x91ca;&#x4e3a;&#x5e38;&#x89c4;&#x4e2d;&#x95f4;&#x4ef6;&#xff0c;&#x65e0;&#x6cd5;&#x5904;&#x7406;&#x9519;&#x8bef;&#x3002;\n\n&#x4ee5;&#x4e0e;&#x5176;&#x4ed6;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x76f8;&#x540c;&#x7684;&#x65b9;&#x5f0f;&#x5b9a;&#x4e49;&#x9519;&#x8bef;&#x5904;&#x7406;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#xff0c;&#x9664;&#x4e86;&#x4f7f;&#x7528;&#x56db;&#x4e2a;&#x53c2;&#x6570;&#x800c;&#x4e0d;&#x662f;&#x4e09;&#x4e2a;&#x53c2;&#x6570;&#xff0c;&#x7279;&#x522b;&#x662f;&#x4f7f;&#x7528;&#x7b7e;&#x540d; (err, req, res, next))&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"735,738"}},{"content":"<pre data-lines=\"739,745\"><code class=\"language-js\">app.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-function\">(<span class=\"hljs-params\">err, req, res, next</span>) =&gt;</span> {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">error</span>(err.<span class=\"hljs-property\">stack</span>)\n  res.<span class=\"hljs-title function_\">status</span>(<span class=\"hljs-number\">500</span>).<span class=\"hljs-title function_\">send</span>(<span class=\"hljs-string\">&apos;Something broke!&apos;</span>)\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"739,745"}}],"payload":{"tag":"h2","lines":"733,734"}},{"content":"&#x5185;&#x7f6e;&#x4e2d;&#x95f4;&#x4ef6;&#x4e2d;&#x82f1;","children":[{"content":"express.static &#x63d0;&#x4f9b;&#x9759;&#x6001;&#x8d44;&#x6e90;&#xff0c;&#x4f8b;&#x5982; HTML &#x6587;&#x4ef6;&#x3001;&#x56fe;&#x50cf;&#x7b49;&#x3002;","children":[],"payload":{"tag":"li","lines":"754,755"}},{"content":"express.json &#x4f7f;&#x7528; JSON &#x6709;&#x6548;&#x8d1f;&#x8f7d;&#x89e3;&#x6790;&#x4f20;&#x5165;&#x8bf7;&#x6c42;&#x3002;&#x6ce8;&#x610f;&#xff1a;&#x53ef;&#x7528;&#x4e8e; Express 4.16.0+","children":[],"payload":{"tag":"li","lines":"755,756"}},{"content":"express.urlencoded &#x4f7f;&#x7528; URL &#x7f16;&#x7801;&#x7684;&#x8d1f;&#x8f7d;&#x89e3;&#x6790;&#x4f20;&#x5165;&#x7684;&#x8bf7;&#x6c42;&#x3002;&#x6ce8;&#x610f;&#xff1a;&#x53ef;&#x7528;&#x4e8e; Express 4.16.0+","children":[],"payload":{"tag":"li","lines":"756,758"}}],"payload":{"tag":"h2","lines":"748,749"}},{"content":"&#x7b2c;&#x4e09;&#x65b9;&#x4e2d;&#x95f4;&#x4ef6;&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"766,776\"><code class=\"language-js\">&#x24; npm install cookie-parser\n<span class=\"hljs-keyword\">const</span> express = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;express&apos;</span>)\n<span class=\"hljs-keyword\">const</span> app = <span class=\"hljs-title function_\">express</span>()\n<span class=\"hljs-keyword\">const</span> cookieParser = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;cookie-parser&apos;</span>)\n\n\n<span class=\"hljs-comment\">// load the cookie-parsing middleware</span>\napp.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-title function_\">cookieParser</span>())\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"766,776"}},{"content":"<pre data-lines=\"777,778\"><code>&#x6709;&#x5173; Express &#x5e38;&#x7528;&#x7684;&#x7b2c;&#x4e09;&#x65b9;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x7684;&#x90e8;&#x5206;&#x5217;&#x8868;&#xff0c;&#x8bf7;&#x53c2;&#x9605;&#xff1a;&#x7b2c;&#x4e09;&#x65b9;&#x4e2d;&#x95f4;&#x4ef6;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"777,778"}},{"content":"<pre data-lines=\"779,788\"><code data-lines=\"779,788\">&#x5c0f;&#x7ed3;\n\n&#x5e94;&#x7528;&#x7ea7;&#x4e2d;&#x95f4;&#x4ef6;\n&#x8def;&#x7531;&#x7ea7;&#x4e2d;&#x95f4;&#x4ef6;\n&#x9519;&#x8bef;&#x5904;&#x7406;&#x4e2d;&#x95f4;&#x4ef6;\n&#x5185;&#x7f6e;&#x4e2d;&#x95f4;&#x4ef6;\n&#x7b2c;&#x4e09;&#x65b9;&#x4e2d;&#x95f4;&#x4ef6;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"779,788"}}],"payload":{"tag":"h2","lines":"758,759"}}],"payload":{"tag":"h1","lines":"515,516"}},{"content":"&#x91cd;&#x5199; Express API&#x4e2d;&#x82f1;","children":[{"content":"","children":[{"content":"<pre data-lines=\"792,799\"><code data-lines=\"792,799\">&#x9884;&#x544a;\n\n&#x65b9;&#x6cd5;\n&#x5c5e;&#x6027;\n&#x539f;&#x578b;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"792,799"}},{"content":"<pre data-lines=\"800,807\"><code>Express API &#x7531;&#x8bf7;&#x6c42;&#x548c;&#x54cd;&#x5e94;&#x5bf9;&#x8c61;&#x7684;&#x5404;&#x79cd;&#x65b9;&#x6cd5;&#x548c;&#x5c5e;&#x6027;&#x7ec4;&#x6210;&#x3002;&#x8fd9;&#x4e9b;&#x662f;&#x7531;&#x539f;&#x578b;&#x7ee7;&#x627f;&#x7684;&#x3002;Express API &#x6709;&#x4e24;&#x4e2a;&#x6269;&#x5c55;&#x70b9;&#xff1a;\n\nexpress.request &#x548c; express.response &#x7684;&#x5168;&#x7403;&#x539f;&#x578b;&#x3002;\n\napp.request &#x548c; app.response &#x7684;&#x5e94;&#x7528;&#x7279;&#x5b9a;&#x539f;&#x578b;&#x3002;\n\n&#x66f4;&#x6539;&#x5168;&#x5c40;&#x539f;&#x578b;&#x5c06;&#x5f71;&#x54cd;&#x540c;&#x4e00;&#x8fdb;&#x7a0b;&#x4e2d;&#x6240;&#x6709;&#x5df2;&#x52a0;&#x8f7d;&#x7684; Express &#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x3002;&#x5982;&#x679c;&#x9700;&#x8981;&#xff0c;&#x53ef;&#x4ee5;&#x901a;&#x8fc7;&#x4ec5;&#x5728;&#x521b;&#x5efa;&#x65b0;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x540e;&#x66f4;&#x6539;&#x7279;&#x5b9a;&#x4e8e;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x7684;&#x539f;&#x578b;&#x6765;&#x8fdb;&#x884c;&#x7279;&#x5b9a;&#x4e8e;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x7684;&#x66f4;&#x6539;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"800,807"}}],"payload":{"tag":"h2","lines":"791,792"}},{"content":"&#x65b9;&#x6cd5;&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"810,813\"><code>&#x60a8;&#x53ef;&#x4ee5;&#x901a;&#x8fc7;&#x5206;&#x914d;&#x81ea;&#x5b9a;&#x4e49;&#x51fd;&#x6570;&#x6765;&#x7528;&#x81ea;&#x5df1;&#x7684;&#x65b9;&#x6cd5;&#x8986;&#x76d6;&#x73b0;&#x6709;&#x65b9;&#x6cd5;&#x7684;&#x7b7e;&#x540d;&#x548c;&#x884c;&#x4e3a;&#x3002;\n\n&#x4ee5;&#x4e0b;&#x662f;&#x8986;&#x76d6; res.sendStatus &#x884c;&#x4e3a;&#x7684;&#x793a;&#x4f8b;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"810,813"}},{"content":"<pre data-lines=\"814,822\"><code class=\"language-js\">app.<span class=\"hljs-property\">response</span>.<span class=\"hljs-property\">sendStatus</span> = <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">statusCode, type, message</span>) {\n  <span class=\"hljs-comment\">// code is intentionally kept simple for demonstration purpose</span>\n  <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-title function_\">contentType</span>(type)\n    .<span class=\"hljs-title function_\">status</span>(statusCode)\n    .<span class=\"hljs-title function_\">send</span>(message)\n}\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"814,822"}},{"content":"<pre data-lines=\"823,826\"><code>&#x4e0a;&#x8ff0;&#x5b9e;&#x73b0;&#x5b8c;&#x5168;&#x6539;&#x53d8;&#x4e86;res.sendStatus&#x7684;&#x539f;&#x59cb;&#x7b7e;&#x540d;&#x3002;&#x5b83;&#x73b0;&#x5728;&#x63a5;&#x53d7;&#x72b6;&#x6001;&#x4ee3;&#x7801;&#x3001;&#x7f16;&#x7801;&#x7c7b;&#x578b;&#x548c;&#x8981;&#x53d1;&#x9001;&#x5230;&#x5ba2;&#x6237;&#x7aef;&#x7684;&#x6d88;&#x606f;&#x3002;\n\n&#x73b0;&#x5728;&#x53ef;&#x4ee5;&#x8fd9;&#x6837;&#x4f7f;&#x7528;&#x88ab;&#x8986;&#x76d6;&#x7684;&#x65b9;&#x6cd5;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"823,826"}},{"content":"<pre data-lines=\"827,830\"><code class=\"language-js\">res.<span class=\"hljs-title function_\">sendStatus</span>(<span class=\"hljs-number\">404</span>, <span class=\"hljs-string\">&apos;application/json&apos;</span>, <span class=\"hljs-string\">&apos;{&quot;error&quot;:&quot;resource not found&quot;}&apos;</span>)\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"827,830"}}],"payload":{"tag":"h2","lines":"808,809"}},{"content":"&#x5c5e;&#x6027;&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"833,843\"><code>Express API &#x4e2d;&#x7684;&#x5c5e;&#x6027;&#x662f;&#xff1a;\n\n&#x5206;&#x914d;&#x7684;&#x5c5e;&#x6027;&#xff08;&#x4f8b;&#x5982;&#xff1a;req.baseUrl&#x3001;req.originalUrl&#xff09;\n&#x5b9a;&#x4e49;&#x4e3a;&#x83b7;&#x53d6;&#x5668;&#xff08;&#x4f8b;&#x5982;&#xff1a;req.secure&#x3001;req.ip&#xff09;\n\n&#x7531;&#x4e8e;&#x7c7b;&#x522b; 1 &#x4e0b;&#x7684;&#x5c5e;&#x6027;&#x662f;&#x5728;&#x5f53;&#x524d;&#x8bf7;&#x6c42;-&#x54cd;&#x5e94;&#x5468;&#x671f;&#x7684;&#x4e0a;&#x4e0b;&#x6587;&#x4e2d;&#x52a8;&#x6001;&#x5206;&#x914d;&#x7ed9; request &#x548c; response &#x5bf9;&#x8c61;&#x7684;&#xff0c;&#x56e0;&#x6b64;&#x5b83;&#x4eec;&#x7684;&#x884c;&#x4e3a;&#x4e0d;&#x80fd;&#x88ab;&#x8986;&#x76d6;&#x3002;\n\n&#x53ef;&#x4ee5;&#x4f7f;&#x7528; Express API &#x6269;&#x5c55; API &#x8986;&#x76d6;&#x7c7b;&#x522b; 2 &#x4e0b;&#x7684;&#x5c5e;&#x6027;&#x3002;\n\n&#x4ee5;&#x4e0b;&#x4ee3;&#x7801;&#x91cd;&#x5199;&#x4e86;&#x5982;&#x4f55;&#x5bfc;&#x51fa; req.ip &#x7684;&#x503c;&#x3002;&#x73b0;&#x5728;&#xff0c;&#x5b83;&#x53ea;&#x8fd4;&#x56de; Client-IP &#x8bf7;&#x6c42;&#x6807;&#x5934;&#x7684;&#x503c;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"833,843"}},{"content":"<pre data-lines=\"844,851\"><code class=\"language-js\"><span class=\"hljs-title class_\">Object</span>.<span class=\"hljs-title function_\">defineProperty</span>(app.<span class=\"hljs-property\">request</span>, <span class=\"hljs-string\">&apos;ip&apos;</span>, {\n  <span class=\"hljs-attr\">configurable</span>: <span class=\"hljs-literal\">true</span>,\n  <span class=\"hljs-attr\">enumerable</span>: <span class=\"hljs-literal\">true</span>,\n  <span class=\"hljs-title function_\">get</span> () { <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;Client-IP&apos;</span>) }\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"844,851"}}],"payload":{"tag":"h2","lines":"831,832"}},{"content":"&#x539f;&#x578b;&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"854,857\"><code>&#x4e3a;&#x4e86;&#x63d0;&#x4f9b; Express.js API&#xff0c;&#x4f20;&#x9012;&#x7ed9; Express.js&#xff08;&#x4f8b;&#x5982;&#x901a;&#x8fc7; app(req, res)&#xff09;&#x7684;&#x8bf7;&#x6c42;/&#x54cd;&#x5e94;&#x5bf9;&#x8c61;&#x9700;&#x8981;&#x4ece;&#x76f8;&#x540c;&#x7684;&#x539f;&#x578b;&#x94fe;&#x7ee7;&#x627f;&#x3002;&#x9ed8;&#x8ba4;&#x60c5;&#x51b5;&#x4e0b;&#xff0c;&#x8bf7;&#x6c42;&#x4e3a; http.IncomingRequest.prototype&#xff0c;&#x54cd;&#x5e94;&#x4e3a; http.ServerResponse.prototype&#x3002;\n\n&#x9664;&#x975e;&#x5fc5;&#x8981;&#xff0c;&#x5426;&#x5219;&#x5efa;&#x8bae;&#x4ec5;&#x5728;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x7ea7;&#x522b;&#x800c;&#x4e0d;&#x662f;&#x5168;&#x5c40;&#x6267;&#x884c;&#x6b64;&#x64cd;&#x4f5c;&#x3002;&#x6b64;&#x5916;&#xff0c;&#x8bf7;&#x6ce8;&#x610f;&#x6b63;&#x5728;&#x4f7f;&#x7528;&#x7684;&#x539f;&#x578b;&#x5c3d;&#x53ef;&#x80fd;&#x4e0e;&#x9ed8;&#x8ba4;&#x539f;&#x578b;&#x5339;&#x914d;&#x7684;&#x529f;&#x80fd;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"854,857"}},{"content":"<pre data-lines=\"858,864\"><code class=\"language-js\"><span class=\"hljs-comment\">// Use FakeRequest and FakeResponse in place of http.IncomingRequest and http.ServerResponse</span>\n<span class=\"hljs-comment\">// for the given app reference</span>\n<span class=\"hljs-title class_\">Object</span>.<span class=\"hljs-title function_\">setPrototypeOf</span>(<span class=\"hljs-title class_\">Object</span>.<span class=\"hljs-title function_\">getPrototypeOf</span>(app.<span class=\"hljs-property\">request</span>), <span class=\"hljs-title class_\">FakeRequest</span>.<span class=\"hljs-property\"><span class=\"hljs-keyword\">prototype</span></span>)\n<span class=\"hljs-title class_\">Object</span>.<span class=\"hljs-title function_\">setPrototypeOf</span>(<span class=\"hljs-title class_\">Object</span>.<span class=\"hljs-title function_\">getPrototypeOf</span>(app.<span class=\"hljs-property\">response</span>), <span class=\"hljs-title class_\">FakeResponse</span>.<span class=\"hljs-property\"><span class=\"hljs-keyword\">prototype</span></span>)\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"858,864"}},{"content":"<pre data-lines=\"865,872\"><code data-lines=\"865,872\">&#x5c0f;&#x7ed3;\n\n&#x65b9;&#x6cd5;\n&#x5c5e;&#x6027;\n&#x539f;&#x578b;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"865,872"}}],"payload":{"tag":"h2","lines":"852,853"}}],"payload":{"tag":"h1","lines":"789,790"}},{"content":"&#x4f7f;&#x7528;&#x6a21;&#x677f;&#x5f15;&#x64ce;&#x4e2d;&#x82f1;","children":[{"content":"&#x9ed8;&#x8ba4;&#x9519;&#x8bef;&#x5904;&#x7406;&#x7a0b;&#x5e8f;&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"1045,1064\"><code>Express &#x5e26;&#x6709;&#x4e00;&#x4e2a;&#x5185;&#x7f6e;&#x7684;&#x9519;&#x8bef;&#x5904;&#x7406;&#x7a0b;&#x5e8f;&#xff0c;&#x53ef;&#x4ee5;&#x5904;&#x7406;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x4e2d;&#x53ef;&#x80fd;&#x9047;&#x5230;&#x7684;&#x4efb;&#x4f55;&#x9519;&#x8bef;&#x3002;&#x8fd9;&#x4e2a;&#x9ed8;&#x8ba4;&#x7684;&#x9519;&#x8bef;&#x5904;&#x7406;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x88ab;&#x6dfb;&#x52a0;&#x5230;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x6808;&#x7684;&#x672b;&#x5c3e;&#x3002;\n\n&#x5982;&#x679c;&#x60a8;&#x5c06;&#x9519;&#x8bef;&#x4f20;&#x9012;&#x7ed9; next() &#x5e76;&#x4e14;&#x60a8;&#x6ca1;&#x6709;&#x5728;&#x81ea;&#x5b9a;&#x4e49;&#x9519;&#x8bef;&#x5904;&#x7406;&#x7a0b;&#x5e8f;&#x4e2d;&#x5904;&#x7406;&#x5b83;&#xff0c;&#x5b83;&#x5c06;&#x7531;&#x5185;&#x7f6e;&#x9519;&#x8bef;&#x5904;&#x7406;&#x7a0b;&#x5e8f;&#x5904;&#x7406;&#xff1b;&#x9519;&#x8bef;&#x5c06;&#x901a;&#x8fc7;&#x5806;&#x6808;&#x8ddf;&#x8e2a;&#x5199;&#x5165;&#x5ba2;&#x6237;&#x7aef;&#x3002;&#x5806;&#x6808;&#x8ddf;&#x8e2a;&#x4e0d;&#x5305;&#x542b;&#x5728;&#x751f;&#x4ea7;&#x73af;&#x5883;&#x4e2d;&#x3002;\n\n&#x5c06;&#x73af;&#x5883;&#x53d8;&#x91cf; NODE_ENV &#x8bbe;&#x7f6e;&#x4e3a; production&#xff0c;&#x4ee5;&#x5728;&#x751f;&#x4ea7;&#x6a21;&#x5f0f;&#x4e0b;&#x8fd0;&#x884c;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x3002;\n\n&#x5199;&#x5165;&#x9519;&#x8bef;&#x65f6;&#xff0c;&#x4f1a;&#x5728;&#x54cd;&#x5e94;&#x4e2d;&#x6dfb;&#x52a0;&#x4ee5;&#x4e0b;&#x4fe1;&#x606f;&#xff1a;\n\n- res.statusCode &#x7531; err.status&#xff08;&#x6216; err.statusCode&#xff09;&#x8bbe;&#x7f6e;&#x3002;&#x5982;&#x679c;&#x6b64;&#x503c;&#x8d85;&#x51fa; 4xx &#x6216; 5xx &#x8303;&#x56f4;&#xff0c;&#x5219;&#x5c06;&#x8bbe;&#x7f6e;&#x4e3a; 500&#x3002;\n\n- res.statusMessage &#x6839;&#x636e;&#x72b6;&#x6001;&#x7801;&#x8bbe;&#x7f6e;&#x3002;\n\n- &#x5728;&#x751f;&#x4ea7;&#x73af;&#x5883;&#x4e2d;&#xff0c;body &#x4e3a;&#x72b6;&#x6001;&#x7801;&#x6d88;&#x606f;&#x7684; HTML&#xff0c;&#x5426;&#x5219;&#x4e3a; err.stack&#x3002;\n\n- err.headers &#x5bf9;&#x8c61;&#x4e2d;&#x6307;&#x5b9a;&#x7684;&#x4efb;&#x4f55;&#x6807;&#x5934;&#x3002;\n\n&#x5982;&#x679c;&#x60a8;&#x5728;&#x5f00;&#x59cb;&#x7f16;&#x5199;&#x54cd;&#x5e94;&#x540e;&#x8c03;&#x7528; next() &#x5e76;&#x51fa;&#x73b0;&#x9519;&#x8bef;&#xff08;&#x4f8b;&#x5982;&#xff0c;&#x5982;&#x679c;&#x60a8;&#x5728;&#x5c06;&#x54cd;&#x5e94;&#x6d41;&#x5f0f;&#x4f20;&#x8f93;&#x5230;&#x5ba2;&#x6237;&#x7aef;&#x65f6;&#x9047;&#x5230;&#x9519;&#x8bef;&#xff09;&#xff0c;Express &#x9ed8;&#x8ba4;&#x9519;&#x8bef;&#x5904;&#x7406;&#x7a0b;&#x5e8f;&#x5c06;&#x5173;&#x95ed;&#x8fde;&#x63a5;&#x5e76;&#x4f7f;&#x8bf7;&#x6c42;&#x5931;&#x8d25;&#x3002;\n\n&#x56e0;&#x6b64;&#xff0c;&#x5f53;&#x60a8;&#x6dfb;&#x52a0;&#x81ea;&#x5b9a;&#x4e49;&#x9519;&#x8bef;&#x5904;&#x7406;&#x7a0b;&#x5e8f;&#x65f6;&#xff0c;&#x60a8;&#x5fc5;&#x987b;&#x59d4;&#x6258;&#x9ed8;&#x8ba4;&#x7684; Express &#x9519;&#x8bef;&#x5904;&#x7406;&#x7a0b;&#x5e8f;&#xff0c;&#x6b64;&#x65f6;&#x6807;&#x5934;&#x5df2;&#x53d1;&#x9001;&#x5230;&#x5ba2;&#x6237;&#x7aef;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1045,1064"}},{"content":"<pre data-lines=\"1065,1074\"><code class=\"language-js\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">errorHandler</span> (<span class=\"hljs-params\">err, req, res, next</span>) {\n  <span class=\"hljs-keyword\">if</span> (res.<span class=\"hljs-property\">headersSent</span>) {\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-title function_\">next</span>(err)\n  }\n  res.<span class=\"hljs-title function_\">status</span>(<span class=\"hljs-number\">500</span>)\n  res.<span class=\"hljs-title function_\">render</span>(<span class=\"hljs-string\">&apos;error&apos;</span>, { <span class=\"hljs-attr\">error</span>: err })\n}\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1065,1074"}},{"content":"<pre data-lines=\"1075,1076\"><code>&#x8bf7;&#x6ce8;&#x610f;&#xff0c;&#x5982;&#x679c;&#x60a8;&#x591a;&#x6b21;&#x8c03;&#x7528; next() &#x5e76;&#x5728;&#x4ee3;&#x7801;&#x4e2d;&#x51fa;&#x73b0;&#x9519;&#x8bef;&#xff0c;&#x5219;&#x53ef;&#x80fd;&#x4f1a;&#x89e6;&#x53d1;&#x9ed8;&#x8ba4;&#x9519;&#x8bef;&#x5904;&#x7406;&#x7a0b;&#x5e8f;&#xff0c;&#x5373;&#x4f7f;&#x81ea;&#x5b9a;&#x4e49;&#x9519;&#x8bef;&#x5904;&#x7406;&#x4e2d;&#x95f4;&#x4ef6;&#x5df2;&#x5230;&#x4f4d;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1075,1076"}}],"payload":{"tag":"h2","lines":"1043,1044"}},{"content":"&#x7f16;&#x5199;&#x9519;&#x8bef;&#x5904;&#x7406;&#x7a0b;&#x5e8f;&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"1079,1080\"><code>&#x4ee5;&#x4e0e;&#x5176;&#x4ed6;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x76f8;&#x540c;&#x7684;&#x65b9;&#x5f0f;&#x5b9a;&#x4e49;&#x9519;&#x8bef;&#x5904;&#x7406;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#xff0c;&#x9664;&#x4e86;&#x9519;&#x8bef;&#x5904;&#x7406;&#x51fd;&#x6570;&#x6709;&#x56db;&#x4e2a;&#x53c2;&#x6570;&#x800c;&#x4e0d;&#x662f;&#x4e09;&#x4e2a;&#xff1a;(err, req, res, next)&#x3002;&#x4f8b;&#x5982;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1079,1080"}},{"content":"<pre data-lines=\"1081,1087\"><code class=\"language-js\">app.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-function\">(<span class=\"hljs-params\">err, req, res, next</span>) =&gt;</span> {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">error</span>(err.<span class=\"hljs-property\">stack</span>)\n  res.<span class=\"hljs-title function_\">status</span>(<span class=\"hljs-number\">500</span>).<span class=\"hljs-title function_\">send</span>(<span class=\"hljs-string\">&apos;Something broke!&apos;</span>)\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1081,1087"}},{"content":"<pre data-lines=\"1088,1089\"><code>&#x5728;&#x5176;&#x4ed6; app.use() &#x548c;&#x8def;&#x7531;&#x8c03;&#x7528;&#x4e4b;&#x540e;&#xff0c;&#x60a8;&#x6700;&#x540e;&#x5b9a;&#x4e49;&#x9519;&#x8bef;&#x5904;&#x7406;&#x4e2d;&#x95f4;&#x4ef6;&#xff1b;&#x4f8b;&#x5982;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1088,1089"}},{"content":"<pre data-lines=\"1090,1103\"><code class=\"language-js\"><span class=\"hljs-keyword\">const</span> bodyParser = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;body-parser&apos;</span>)\n<span class=\"hljs-keyword\">const</span> methodOverride = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;method-override&apos;</span>)\n\napp.<span class=\"hljs-title function_\">use</span>(bodyParser.<span class=\"hljs-title function_\">urlencoded</span>({\n  <span class=\"hljs-attr\">extended</span>: <span class=\"hljs-literal\">true</span>\n}))\napp.<span class=\"hljs-title function_\">use</span>(bodyParser.<span class=\"hljs-title function_\">json</span>())\napp.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-title function_\">methodOverride</span>())\napp.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-function\">(<span class=\"hljs-params\">err, req, res, next</span>) =&gt;</span> {\n  <span class=\"hljs-comment\">// logic</span>\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1090,1103"}},{"content":"<pre data-lines=\"1104,1107\"><code>&#x6765;&#x81ea;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x7684;&#x54cd;&#x5e94;&#x53ef;&#x4ee5;&#x662f;&#x4efb;&#x4f55;&#x683c;&#x5f0f;&#xff0c;&#x4f8b;&#x5982; HTML &#x9519;&#x8bef;&#x9875;&#x9762;&#x3001;&#x7b80;&#x5355;&#x6d88;&#x606f;&#x6216; JSON &#x5b57;&#x7b26;&#x4e32;&#x3002;\n\n&#x51fa;&#x4e8e;&#x7ec4;&#x7ec7;&#xff08;&#x548c;&#x66f4;&#x9ad8;&#x7ea7;&#x522b;&#x7684;&#x6846;&#x67b6;&#xff09;&#x7684;&#x76ee;&#x7684;&#xff0c;&#x60a8;&#x53ef;&#x4ee5;&#x5b9a;&#x4e49;&#x51e0;&#x4e2a;&#x9519;&#x8bef;&#x5904;&#x7406;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#xff0c;&#x5c31;&#x50cf;&#x60a8;&#x4f7f;&#x7528;&#x5e38;&#x89c4;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x4e00;&#x6837;&#x3002;&#x4f8b;&#x5982;&#xff0c;&#x4e3a;&#x4f7f;&#x7528; XHR &#x548c;&#x4e0d;&#x4f7f;&#x7528; XHR &#x53d1;&#x51fa;&#x7684;&#x8bf7;&#x6c42;&#x5b9a;&#x4e49;&#x9519;&#x8bef;&#x5904;&#x7406;&#x7a0b;&#x5e8f;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1104,1107"}},{"content":"<pre data-lines=\"1108,1121\"><code class=\"language-js\"><span class=\"hljs-keyword\">const</span> bodyParser = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;body-parser&apos;</span>)\n<span class=\"hljs-keyword\">const</span> methodOverride = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;method-override&apos;</span>)\n\napp.<span class=\"hljs-title function_\">use</span>(bodyParser.<span class=\"hljs-title function_\">urlencoded</span>({\n  <span class=\"hljs-attr\">extended</span>: <span class=\"hljs-literal\">true</span>\n}))\napp.<span class=\"hljs-title function_\">use</span>(bodyParser.<span class=\"hljs-title function_\">json</span>())\napp.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-title function_\">methodOverride</span>())\napp.<span class=\"hljs-title function_\">use</span>(logErrors)\napp.<span class=\"hljs-title function_\">use</span>(clientErrorHandler)\napp.<span class=\"hljs-title function_\">use</span>(errorHandler)\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1108,1121"}},{"content":"<pre data-lines=\"1122,1123\"><code>&#x5728;&#x6b64;&#x793a;&#x4f8b;&#x4e2d;&#xff0c;&#x901a;&#x7528; logErrors &#x53ef;&#x80fd;&#x4f1a;&#x5c06;&#x8bf7;&#x6c42;&#x548c;&#x9519;&#x8bef;&#x4fe1;&#x606f;&#x5199;&#x5165; stderr&#xff0c;&#x4f8b;&#x5982;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1122,1123"}},{"content":"<pre data-lines=\"1124,1130\"><code class=\"language-js\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">logErrors</span> (<span class=\"hljs-params\">err, req, res, next</span>) {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">error</span>(err.<span class=\"hljs-property\">stack</span>)\n  <span class=\"hljs-title function_\">next</span>(err)\n}\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1124,1130"}},{"content":"<pre data-lines=\"1131,1134\"><code>&#x540c;&#x6837;&#x5728;&#x672c;&#x4f8b;&#x4e2d;&#xff0c;clientErrorHandler&#x5b9a;&#x4e49;&#x5982;&#x4e0b;&#xff1b;&#x5728;&#x8fd9;&#x79cd;&#x60c5;&#x51b5;&#x4e0b;&#xff0c;&#x9519;&#x8bef;&#x4f1a;&#x663e;&#x5f0f;&#x4f20;&#x9012;&#x7ed9;&#x4e0b;&#x4e00;&#x4e2a;&#x9519;&#x8bef;&#x3002;\n\n&#x8bf7;&#x6ce8;&#x610f;&#xff0c;&#x5f53;&#x4e0d;&#x5728;&#x9519;&#x8bef;&#x5904;&#x7406;&#x51fd;&#x6570;&#x4e2d;&#x8c03;&#x7528; &quot;next&quot; &#x65f6;&#xff0c;&#x60a8;&#x8d1f;&#x8d23;&#x7f16;&#x5199;&#xff08;&#x548c;&#x7ed3;&#x675f;&#xff09;&#x54cd;&#x5e94;&#x3002;&#x5426;&#x5219;&#xff0c;&#x8fd9;&#x4e9b;&#x8bf7;&#x6c42;&#x5c06; &quot;hang&quot; &#x5e76;&#x4e14;&#x6ca1;&#x6709;&#x8d44;&#x683c;&#x8fdb;&#x884c;&#x5783;&#x573e;&#x6536;&#x96c6;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1131,1134"}},{"content":"<pre data-lines=\"1135,1144\"><code class=\"language-js\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">clientErrorHandler</span> (<span class=\"hljs-params\">err, req, res, next</span>) {\n  <span class=\"hljs-keyword\">if</span> (req.<span class=\"hljs-property\">xhr</span>) {\n    res.<span class=\"hljs-title function_\">status</span>(<span class=\"hljs-number\">500</span>).<span class=\"hljs-title function_\">send</span>({ <span class=\"hljs-attr\">error</span>: <span class=\"hljs-string\">&apos;Something failed!&apos;</span> })\n  } <span class=\"hljs-keyword\">else</span> {\n    <span class=\"hljs-title function_\">next</span>(err)\n  }\n}\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1135,1144"}},{"content":"<pre data-lines=\"1145,1146\"><code>&#x5b9e;&#x73b0; &quot;catch-all&quot; errorHandler &#x51fd;&#x6570;&#x5982;&#x4e0b;&#xff08;&#x4f8b;&#x5982;&#xff09;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1145,1146"}},{"content":"<pre data-lines=\"1147,1153\"><code class=\"language-js\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">errorHandler</span> (<span class=\"hljs-params\">err, req, res, next</span>) {\n  res.<span class=\"hljs-title function_\">status</span>(<span class=\"hljs-number\">500</span>)\n  res.<span class=\"hljs-title function_\">render</span>(<span class=\"hljs-string\">&apos;error&apos;</span>, { <span class=\"hljs-attr\">error</span>: err })\n}\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1147,1153"}},{"content":"<pre data-lines=\"1154,1155\"><code>&#x5982;&#x679c;&#x60a8;&#x6709;&#x4e00;&#x4e2a;&#x5e26;&#x6709;&#x591a;&#x4e2a;&#x56de;&#x8c03;&#x51fd;&#x6570;&#x7684;&#x8def;&#x7531;&#x5904;&#x7406;&#x7a0b;&#x5e8f;&#xff0c;&#x60a8;&#x53ef;&#x4ee5;&#x4f7f;&#x7528; route &#x53c2;&#x6570;&#x8df3;&#x5230;&#x4e0b;&#x4e00;&#x4e2a;&#x8def;&#x7531;&#x5904;&#x7406;&#x7a0b;&#x5e8f;&#x3002;&#x4f8b;&#x5982;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1154,1155"}},{"content":"<pre data-lines=\"1156,1172\"><code class=\"language-js\">app.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;/a_route_behind_paywall&apos;</span>,\n  <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res, next</span>) =&gt;</span> {\n    <span class=\"hljs-keyword\">if</span> (!req.<span class=\"hljs-property\">user</span>.<span class=\"hljs-property\">hasPaid</span>) {\n      <span class=\"hljs-comment\">// continue handling this request</span>\n      <span class=\"hljs-title function_\">next</span>(<span class=\"hljs-string\">&apos;route&apos;</span>)\n    } <span class=\"hljs-keyword\">else</span> {\n      <span class=\"hljs-title function_\">next</span>()\n    }\n  }, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res, next</span>) =&gt;</span> {\n    <span class=\"hljs-title class_\">PaidContent</span>.<span class=\"hljs-title function_\">find</span>(<span class=\"hljs-function\">(<span class=\"hljs-params\">err, doc</span>) =&gt;</span> {\n      <span class=\"hljs-keyword\">if</span> (err) <span class=\"hljs-keyword\">return</span> <span class=\"hljs-title function_\">next</span>(err)\n      res.<span class=\"hljs-title function_\">json</span>(doc)\n    })\n  })\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1156,1172"}},{"content":"<pre data-lines=\"1172,1175\"><code>&#x5728;&#x6b64;&#x793a;&#x4f8b;&#x4e2d;&#xff0c;&#x5c06;&#x8df3;&#x8fc7; getPaidContent &#x5904;&#x7406;&#x7a0b;&#x5e8f;&#xff0c;&#x4f46; app &#x4e2d;&#x7528;&#x4e8e; /a_route_behind_paywall &#x7684;&#x4efb;&#x4f55;&#x5269;&#x4f59;&#x5904;&#x7406;&#x7a0b;&#x5e8f;&#x5c06;&#x7ee7;&#x7eed;&#x6267;&#x884c;&#x3002;\n\n&#x8c03;&#x7528; next() &#x548c; next(err) &#x8868;&#x793a;&#x5f53;&#x524d;&#x5904;&#x7406;&#x7a0b;&#x5e8f;&#x5df2;&#x5b8c;&#x6210;&#x4ee5;&#x53ca;&#x5904;&#x4e8e;&#x4ec0;&#x4e48;&#x72b6;&#x6001;&#x3002;next(err) &#x5c06;&#x8df3;&#x8fc7;&#x94fe;&#x4e2d;&#x6240;&#x6709;&#x5269;&#x4f59;&#x7684;&#x5904;&#x7406;&#x7a0b;&#x5e8f;&#xff0c;&#x9664;&#x4e86;&#x90a3;&#x4e9b;&#x8bbe;&#x7f6e;&#x4e3a;&#x5982;&#x4e0a;&#x6240;&#x8ff0;&#x5904;&#x7406;&#x9519;&#x8bef;&#x7684;&#x5904;&#x7406;&#x7a0b;&#x5e8f;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1172,1175"}},{"content":"<pre data-lines=\"1176,1183\"><code data-lines=\"1176,1183\">&#x5c0f;&#x7ed3;\n\n&#x6355;&#x6349;&#x9519;&#x8bef;\n&#x9ed8;&#x8ba4;&#x9519;&#x8bef;&#x5904;&#x7406;&#x7a0b;&#x5e8f;\n&#x7f16;&#x5199;&#x9519;&#x8bef;&#x5904;&#x7406;&#x7a0b;&#x5e8f;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1176,1183"}}],"payload":{"tag":"h2","lines":"1077,1078"}}],"payload":{"tag":"h1","lines":"873,874"}},{"content":"&#x8c03;&#x8bd5;&#x4e2d;&#x82f1;","children":[{"content":"","children":[{"content":"<pre data-lines=\"1193,1201\"><code>Express &#x5728;&#x5185;&#x90e8;&#x4f7f;&#x7528; debug &#x6a21;&#x5757;&#x6765;&#x8bb0;&#x5f55;&#x6709;&#x5173;&#x8def;&#x7531;&#x5339;&#x914d;&#x3001;&#x6b63;&#x5728;&#x4f7f;&#x7528;&#x7684;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x3001;\n&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x6a21;&#x5f0f;&#x4ee5;&#x53ca;&#x8bf7;&#x6c42;-&#x54cd;&#x5e94;&#x5468;&#x671f;&#x7684;&#x6d41;&#x7a0b;&#x7684;&#x4fe1;&#x606f;&#x3002;\n\ndebug &#x5c31;&#x50cf; console.log &#x7684;&#x589e;&#x5f3a;&#x7248;&#xff0c;&#x4f46;&#x4e0e; console.log &#x4e0d;&#x540c;&#x7684;&#x662f;&#xff0c;\n&#x60a8;&#x4e0d;&#x5fc5;&#x5728;&#x751f;&#x4ea7;&#x4ee3;&#x7801;&#x4e2d;&#x6ce8;&#x91ca;&#x6389; debug &#x65e5;&#x5fd7;&#x3002;&#x65e5;&#x5fd7;&#x8bb0;&#x5f55;&#x9ed8;&#x8ba4;&#x5173;&#x95ed;&#xff0c;\n&#x53ef;&#x4ee5;&#x4f7f;&#x7528; DEBUG &#x73af;&#x5883;&#x53d8;&#x91cf;&#x6709;&#x6761;&#x4ef6;&#x5730;&#x6253;&#x5f00;&#x3002;\n\n&#x8981;&#x67e5;&#x770b; Express &#x4e2d;&#x4f7f;&#x7528;&#x7684;&#x6240;&#x6709;&#x5185;&#x90e8;&#x65e5;&#x5fd7;&#xff0c;&#x8bf7;&#x5728;&#x542f;&#x52a8;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x65f6;&#x5c06; DEBUG &#x73af;&#x5883;&#x53d8;&#x91cf;&#x8bbe;&#x7f6e;&#x4e3a; express:*&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1193,1201"}},{"content":"<pre data-lines=\"1202,1205\"><code class=\"language-js\">&#x24; DEBUG=express:* node index.js\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1202,1205"}},{"content":"<pre data-lines=\"1208,1211\"><code class=\"language-bash\">&gt; <span class=\"hljs-built_in\">set</span> DEBUG=express:* &amp; node index.js\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1208,1211"}},{"content":"<pre data-lines=\"1212,1213\"><code>&#x5728; express &#x751f;&#x6210;&#x5668; &#x751f;&#x6210;&#x7684;&#x9ed8;&#x8ba4;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x4e0a;&#x8fd0;&#x884c;&#x6b64;&#x547d;&#x4ee4;&#x4f1a;&#x6253;&#x5370;&#x4ee5;&#x4e0b;&#x8f93;&#x51fa;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1212,1213"}},{"content":"<pre data-lines=\"1214,1257\"><code class=\"language-bash\">&#x24; DEBUG=express:* node ./bin/www\n  express:router:route new / +0ms\n  express:router:layer new / +1ms\n  express:router:route get / +1ms\n  express:router:layer new / +0ms\n  express:router:route new / +1ms\n  express:router:layer new / +0ms\n  express:router:route get / +0ms\n  express:router:layer new / +0ms\n  express:application compile etag weak +1ms\n  express:application compile query parser extended +0ms\n  express:application compile trust proxy <span class=\"hljs-literal\">false</span> +0ms\n  express:application booting <span class=\"hljs-keyword\">in</span> development mode +1ms\n  express:router use / query +0ms\n  express:router:layer new / +0ms\n  express:router use / expressInit +0ms\n  express:router:layer new / +0ms\n  express:router use / favicon +1ms\n  express:router:layer new / +0ms\n  express:router use / logger +0ms\n  express:router:layer new / +0ms\n  express:router use / jsonParser +0ms\n  express:router:layer new / +1ms\n  express:router use / urlencodedParser +0ms\n  express:router:layer new / +0ms\n  express:router use / cookieParser +0ms\n  express:router:layer new / +0ms\n  express:router use / stylus +90ms\n  express:router:layer new / +0ms\n  express:router use / serveStatic +0ms\n  express:router:layer new / +0ms\n  express:router use / router +0ms\n  express:router:layer new / +1ms\n  express:router use /users router +0ms\n  express:router:layer new /users +0ms\n  express:router use / &amp;lt;anonymous&amp;gt; +0ms\n  express:router:layer new / +0ms\n  express:router use / &amp;lt;anonymous&amp;gt; +0ms\n  express:router:layer new / +0ms\n  express:router use / &amp;lt;anonymous&amp;gt; +0ms\n  express:router:layer new / +0ms\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1214,1257"}},{"content":"<pre data-lines=\"1258,1259\"><code>&#x5f53;&#x5411;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x53d1;&#x51fa;&#x8bf7;&#x6c42;&#x65f6;&#xff0c;&#x60a8;&#x5c06;&#x770b;&#x5230; Express &#x4ee3;&#x7801;&#x4e2d;&#x6307;&#x5b9a;&#x7684;&#x65e5;&#x5fd7;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1258,1259"}},{"content":"<pre data-lines=\"1260,1277\"><code class=\"language-bash\">  express:router dispatching GET / +4h\n  express:router query  : / +2ms\n  express:router expressInit  : / +0ms\n  express:router favicon  : / +0ms\n  express:router logger  : / +1ms\n  express:router jsonParser  : / +0ms\n  express:router urlencodedParser  : / +1ms\n  express:router cookieParser  : / +0ms\n  express:router stylus  : / +0ms\n  express:router serveStatic  : / +2ms\n  express:router router  : / +2ms\n  express:router dispatching GET / +1ms\n  express:view lookup <span class=\"hljs-string\">&quot;index.pug&quot;</span> +338ms\n  express:view <span class=\"hljs-built_in\">stat</span> <span class=\"hljs-string\">&quot;/projects/example/views/index.pug&quot;</span> +0ms\n  express:view render <span class=\"hljs-string\">&quot;/projects/example/views/index.pug&quot;</span> +1ms\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1260,1277"}},{"content":"<pre data-lines=\"1278,1279\"><code>&#x8981;&#x4ec5;&#x67e5;&#x770b;&#x6765;&#x81ea;&#x8def;&#x7531;&#x5b9e;&#x73b0;&#x7684;&#x65e5;&#x5fd7;&#xff0c;&#x8bf7;&#x5c06; DEBUG &#x7684;&#x503c;&#x8bbe;&#x7f6e;&#x4e3a; express:router&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1278,1279"}}],"payload":{"tag":"h2","lines":"1192,1193"}},{"content":"express &#x751f;&#x6210;&#x7684;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"1283,1286\"><code>&#x7531; express &#x547d;&#x4ee4;&#x751f;&#x6210;&#x7684;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x4e5f;&#x4f7f;&#x7528; debug &#x6a21;&#x5757;&#xff0c;&#x5176;&#x8c03;&#x8bd5;&#x547d;&#x540d;&#x7a7a;&#x95f4;&#x7684;&#x8303;&#x56f4;&#x4e3a;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x7684;&#x540d;&#x79f0;&#x3002;\n\n&#x4f8b;&#x5982;&#xff0c;&#x5982;&#x679c;&#x60a8;&#x4f7f;&#x7528; &#x24; express sample-app &#x751f;&#x6210;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#xff0c;&#x5219;&#x53ef;&#x4ee5;&#x4f7f;&#x7528;&#x4ee5;&#x4e0b;&#x547d;&#x4ee4;&#x542f;&#x7528;&#x8c03;&#x8bd5;&#x8bed;&#x53e5;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1283,1286"}},{"content":"<pre data-lines=\"1287,1290\"><code class=\"language-bash\">&#x24; DEBUG=sample-app:* node ./bin/www\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1287,1290"}},{"content":"<pre data-lines=\"1291,1292\"><code>&#x60a8;&#x53ef;&#x4ee5;&#x901a;&#x8fc7;&#x5206;&#x914d;&#x4ee5;&#x9017;&#x53f7;&#x5206;&#x9694;&#x7684;&#x540d;&#x79f0;&#x5217;&#x8868;&#x6765;&#x6307;&#x5b9a;&#x591a;&#x4e2a;&#x8c03;&#x8bd5;&#x547d;&#x540d;&#x7a7a;&#x95f4;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1291,1292"}},{"content":"<pre data-lines=\"1293,1296\"><code class=\"language-bash\">&#x24; DEBUG=http,mail,express:* node index.js\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1293,1296"}}],"payload":{"tag":"h2","lines":"1281,1282"}},{"content":"&#x9ad8;&#x7ea7;&#x9009;&#x9879;&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"1298,1307\"><code>&#x901a;&#x8fc7; Node.js &#x8fd0;&#x884c;&#x65f6;&#xff0c;&#x60a8;&#x53ef;&#x4ee5;&#x8bbe;&#x7f6e;&#x4e00;&#x4e9b;&#x73af;&#x5883;&#x53d8;&#x91cf;&#x6765;&#x6539;&#x53d8;&#x8c03;&#x8bd5;&#x65e5;&#x5fd7;&#x7684;&#x884c;&#x4e3a;&#xff1a;\n\n&#x540d;&#x79f0;\t&#x76ee;&#x7684;\nDEBUG\t&#x542f;&#x7528;/&#x7981;&#x7528;&#x7279;&#x5b9a;&#x7684;&#x8c03;&#x8bd5;&#x547d;&#x540d;&#x7a7a;&#x95f4;&#x3002;\nDEBUG_COLORS\t&#x662f;&#x5426;&#x5728;&#x8c03;&#x8bd5;&#x8f93;&#x51fa;&#x4e2d;&#x4f7f;&#x7528;&#x989c;&#x8272;&#x3002;\nDEBUG_DEPTH\t&#x5bf9;&#x8c61;&#x68c0;&#x67e5;&#x6df1;&#x5ea6;&#x3002;\nDEBUG_FD\t&#x8981;&#x5c06;&#x8c03;&#x8bd5;&#x8f93;&#x51fa;&#x5199;&#x5165;&#x7684;&#x6587;&#x4ef6;&#x63cf;&#x8ff0;&#x7b26;&#x3002;\nDEBUG_SHOW_HIDDEN\t&#x663e;&#x793a;&#x68c0;&#x67e5;&#x5bf9;&#x8c61;&#x7684;&#x9690;&#x85cf;&#x5c5e;&#x6027;&#x3002;\n&#x6ce8;&#x610f;&#xff1a;&#x4ee5; DEBUG_ &#x5f00;&#x5934;&#x7684;&#x73af;&#x5883;&#x53d8;&#x91cf;&#x6700;&#x7ec8;&#x4f1a;&#x88ab;&#x8f6c;&#x6362;&#x4e3a;&#x4e0e; %o/%O &#x683c;&#x5f0f;&#x5316;&#x7a0b;&#x5e8f;&#x4e00;&#x8d77;&#x4f7f;&#x7528;&#x7684; Options &#x5bf9;&#x8c61;&#x3002;&#x6709;&#x5173;&#x5b8c;&#x6574;&#x5217;&#x8868;&#xff0c;&#x8bf7;&#x53c2;&#x9605; util.inspect() &#x7684; Node.js &#x6587;&#x6863;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1298,1307"}}],"payload":{"tag":"h2","lines":"1296,1297"}}],"payload":{"tag":"h1","lines":"1190,1191"}},{"content":"&#x4ee3;&#x7406;&#x80cc;&#x540e;&#x7684; Express&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"1310,1339\"><code>&#x5728;&#x53cd;&#x5411;&#x4ee3;&#x7406;&#x540e;&#x9762;&#x8fd0;&#x884c; Express &#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x65f6;&#xff0c;&#x67d0;&#x4e9b; Express API &#x53ef;&#x80fd;&#x8fd4;&#x56de;&#x4e0e;&#x9884;&#x671f;&#x4e0d;&#x540c;&#x7684;&#x503c;&#x3002;\n\n&#x4e3a;&#x4e86;&#x5bf9;&#x6b64;&#x8fdb;&#x884c;&#x8c03;&#x6574;&#xff0c;trust proxy &#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x8bbe;&#x7f6e;&#x53ef;&#x7528;&#x4e8e;&#x516c;&#x5f00;&#x7531; Express API &#x4e2d;&#x7684;&#x53cd;&#x5411;&#x4ee3;&#x7406;&#x63d0;&#x4f9b;&#x7684;&#x4fe1;&#x606f;&#x3002;\n\n&#x6700;&#x5e38;&#x89c1;&#x7684;&#x95ee;&#x9898;&#x662f;&#x516c;&#x5f00;&#x5ba2;&#x6237;&#x7aef; IP &#x5730;&#x5740;&#x7684;&#x5feb;&#x901f; API &#x53ef;&#x80fd;&#x4f1a;&#x663e;&#x793a;&#x53cd;&#x5411;&#x4ee3;&#x7406;&#x7684;&#x5185;&#x90e8; IP &#x5730;&#x5740;&#x3002;\n\n&#x914d;&#x7f6e; trust proxy &#x8bbe;&#x7f6e;&#x65f6;&#xff0c;&#x4e86;&#x89e3;&#x53cd;&#x5411;&#x4ee3;&#x7406;&#x7684;&#x786e;&#x5207;&#x8bbe;&#x7f6e;&#x975e;&#x5e38;&#x91cd;&#x8981;&#x3002;&#x7531;&#x4e8e;&#x6b64;&#x8bbe;&#x7f6e;&#x5c06;&#x4fe1;&#x4efb;&#x8bf7;&#x6c42;&#x4e2d;&#x63d0;&#x4f9b;&#x7684;&#x503c;&#xff0c;\n&#x56e0;&#x6b64; Express &#x4e2d;&#x7684;&#x8bbe;&#x7f6e;&#x7ec4;&#x5408;&#x4e0e;&#x53cd;&#x5411;&#x4ee3;&#x7406;&#x7684;&#x64cd;&#x4f5c;&#x65b9;&#x5f0f;&#x76f8;&#x5339;&#x914d;&#x975e;&#x5e38;&#x91cd;&#x8981;&#x3002;\n\n&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x8bbe;&#x7f6e; trust proxy &#x53ef;&#x4ee5;&#x8bbe;&#x7f6e;&#x4e3a;&#x4e0b;&#x8868;&#x4e2d;&#x5217;&#x51fa;&#x7684;&#x503c;&#x4e4b;&#x4e00;&#x3002;\n\n**&#x5e03;&#x5c14;&#x503c;**\n\n&#x5982;&#x679c;&#x662f; true&#xff0c;&#x5219;&#x5ba2;&#x6237;&#x7aef;&#x7684; IP &#x5730;&#x5740;&#x88ab;&#x7406;&#x89e3;&#x4e3a; X-Forwarded-For &#x6807;&#x5934;&#x4e2d;&#x6700;&#x5de6;&#x8fb9;&#x7684;&#x6761;&#x76ee;&#x3002;\n\n&#x5982;&#x679c;&#x662f;false&#xff0c;&#x5219;&#x5e94;&#x7528;&#x7406;&#x89e3;&#x4e3a;&#x76f4;&#x63a5;&#x9762;&#x5411;&#x5ba2;&#x6237;&#x7aef;&#xff0c;&#x5ba2;&#x6237;&#x7aef;&#x7684;IP&#x5730;&#x5740;&#x6765;&#x6e90;&#x4e8e;req.socket.remoteAddress&#x3002;&#x8fd9;&#x662f;&#x9ed8;&#x8ba4;&#x8bbe;&#x7f6e;&#x3002;\n\n&#x8bbe;&#x7f6e;&#x4e3a; true &#x65f6;&#xff0c;&#x52a1;&#x5fc5;&#x786e;&#x4fdd;&#x6700;&#x540e;&#x4e00;&#x4e2a;&#x53d7;&#x4fe1;&#x4efb;&#x7684;&#x53cd;&#x5411;&#x4ee3;&#x7406;&#x6b63;&#x5728;&#x5220;&#x9664;/&#x8986;&#x76d6;&#x4ee5;&#x4e0b;&#x6240;&#x6709; HTTP &#x6807;&#x5934;&#xff1a;\nX-Forwarded-For&#x3001;X-Forwarded-Host &#x548c; X-Forwarded-Proto&#xff0c;&#x5426;&#x5219;&#x5ba2;&#x6237;&#x7aef;&#x53ef;&#x80fd;&#x63d0;&#x4f9b;&#x4efb;&#x4f55;&#x503c;&#x3002;\n\n\n**IP &#x5730;&#x5740;**\n\n&#x4e00;&#x4e2a; IP &#x5730;&#x5740;&#x3001;&#x5b50;&#x7f51;&#x6216;&#x4e00;&#x7ec4; IP &#x5730;&#x5740;&#x548c;&#x5b50;&#x7f51;&#xff0c;&#x53ef;&#x4f5c;&#x4e3a;&#x53cd;&#x5411;&#x4ee3;&#x7406;&#x4fe1;&#x4efb;&#x3002;&#x4ee5;&#x4e0b;&#x5217;&#x8868;&#x663e;&#x793a;&#x4e86;&#x9884;&#x914d;&#x7f6e;&#x7684;&#x5b50;&#x7f51;&#x540d;&#x79f0;&#xff1a;\n\nloopback - 127.0.0.1/8&#xff0c;::1/128\nlinklocal - 169.254.0.0/16&#xff0c;fe80::/10\nuniquelocal - 10.0.0.0/8&#x3001;172.16.0.0/12&#x3001;192.168.0.0/16&#x3001;fc00::/7\n&#x60a8;&#x53ef;&#x4ee5;&#x901a;&#x8fc7;&#x4ee5;&#x4e0b;&#x4efb;&#x4e00;&#x65b9;&#x5f0f;&#x8bbe;&#x7f6e; IP &#x5730;&#x5740;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1310,1339"}},{"content":"<pre data-lines=\"1340,1346\"><code class=\"language-js\">app.<span class=\"hljs-title function_\">set</span>(<span class=\"hljs-string\">&apos;trust proxy&apos;</span>, <span class=\"hljs-string\">&apos;loopback&apos;</span>) <span class=\"hljs-comment\">// specify a single subnet</span>\napp.<span class=\"hljs-title function_\">set</span>(<span class=\"hljs-string\">&apos;trust proxy&apos;</span>, <span class=\"hljs-string\">&apos;loopback, 123.123.123.123&apos;</span>) <span class=\"hljs-comment\">// specify a subnet and an address</span>\napp.<span class=\"hljs-title function_\">set</span>(<span class=\"hljs-string\">&apos;trust proxy&apos;</span>, <span class=\"hljs-string\">&apos;loopback, linklocal, uniquelocal&apos;</span>) <span class=\"hljs-comment\">// specify multiple subnets as CSV</span>\napp.<span class=\"hljs-title function_\">set</span>(<span class=\"hljs-string\">&apos;trust proxy&apos;</span>, [<span class=\"hljs-string\">&apos;loopback&apos;</span>, <span class=\"hljs-string\">&apos;linklocal&apos;</span>, <span class=\"hljs-string\">&apos;uniquelocal&apos;</span>]) <span class=\"hljs-comment\">// specify multiple subnets as an array</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1340,1346"}},{"content":"<pre data-lines=\"1347,1348\"><code>&#x6307;&#x5b9a;&#x65f6;&#xff0c;IP &#x5730;&#x5740;&#x6216;&#x5b50;&#x7f51;&#x5c06;&#x88ab;&#x6392;&#x9664;&#x5728;&#x5730;&#x5740;&#x786e;&#x5b9a;&#x8fc7;&#x7a0b;&#x4e4b;&#x5916;&#xff0c;&#x5e76;&#x5c06;&#x79bb;&#x5e94;&#x7528;&#x670d;&#x52a1;&#x5668;&#x6700;&#x8fd1;&#x7684;&#x4e0d;&#x53d7;&#x4fe1;&#x4efb;&#x7684; IP &#x5730;&#x5740;&#x786e;&#x5b9a;&#x4e3a;&#x5ba2;&#x6237;&#x7aef;&#x7684; IP \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1347,1348"}},{"content":"<pre data-lines=\"1351,1364\"><code>**&#x6570;&#x5b57;**\n\n&#x4f7f;&#x7528;&#x8ddd;&#x79bb; Express &#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x6700;&#x591a; n &#x8df3;&#x6570;&#x7684;&#x5730;&#x5740;&#x3002;req.socket.remoteAddress &#x662f;&#x7b2c;&#x4e00;&#x8df3;&#xff0c;\n&#x5176;&#x4f59;&#x7684;&#x5728; X-Forwarded-For &#x6807;&#x5934;&#x4e2d;&#x4ece;&#x53f3;&#x5230;&#x5de6;&#x67e5;&#x627e;&#x3002;0 &#x7684;&#x503c;&#x610f;&#x5473;&#x7740;&#x7b2c;&#x4e00;&#x4e2a;&#x4e0d;&#x53d7;&#x4fe1;&#x4efb;&#x7684;&#x5730;&#x5740;&#x5c06;&#x662f; \nreq.socket.remoteAddress&#xff0c;&#x5373;&#x6ca1;&#x6709;&#x53cd;&#x5411;&#x4ee3;&#x7406;&#x3002;\n\n&#x4f7f;&#x7528;&#x6b64;&#x8bbe;&#x7f6e;&#x65f6;&#xff0c;&#x91cd;&#x8981;&#x7684;&#x662f;&#x8981;&#x786e;&#x4fdd; Express &#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x6ca1;&#x6709;&#x591a;&#x4e2a;&#x4e0d;&#x540c;&#x957f;&#x5ea6;&#x7684;&#x8def;&#x5f84;&#xff0c;&#x4ee5;&#x4fbf;&#x5ba2;&#x6237;&#x7aef;&#x53ef;&#x4ee5;&#x5c11;&#x4e8e;&#x914d;&#x7f6e;&#x7684;&#x8df3;&#x6570;&#xff0c;\n&#x5426;&#x5219;&#x5ba2;&#x6237;&#x7aef;&#x53ef;&#x80fd;&#x4f1a;&#x63d0;&#x4f9b;&#x4efb;&#x4f55;&#x503c;.\n\n\n**&#x51fd;&#x6570;**\n\n&#x81ea;&#x5b9a;&#x4e49;&#x4fe1;&#x4efb;&#x5b9e;&#x73b0;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1351,1364"}},{"content":"<pre data-lines=\"1365,1371\"><code class=\"language-js\">app.<span class=\"hljs-title function_\">set</span>(<span class=\"hljs-string\">&apos;trust proxy&apos;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">ip</span>) =&gt;</span> {\n  <span class=\"hljs-keyword\">if</span> (ip === <span class=\"hljs-string\">&apos;127.0.0.1&apos;</span> || ip === <span class=\"hljs-string\">&apos;123.123.123.123&apos;</span>) <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">true</span> <span class=\"hljs-comment\">// trusted IPs</span>\n  <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">false</span>\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1365,1371"}},{"content":"<pre data-lines=\"1372,1381\"><code>&#x542f;&#x7528; trust proxy &#x5c06;&#x4ea7;&#x751f;&#x4ee5;&#x4e0b;&#x5f71;&#x54cd;&#xff1a;\n\nreq.hostname &#x7684;&#x503c;&#x6765;&#x6e90;&#x4e8e; X-Forwarded-Host &#x5934;&#x4e2d;&#x8bbe;&#x7f6e;&#x7684;&#x503c;&#xff0c;&#x53ef;&#x4ee5;&#x7531;&#x5ba2;&#x6237;&#x7aef;&#x8bbe;&#x7f6e;&#xff0c;&#x4e5f;&#x53ef;&#x4ee5;&#x7531;&#x4ee3;&#x7406;&#x8bbe;&#x7f6e;&#x3002;\n\nX-Forwarded-Proto&#x53ef;&#x4ee5;&#x901a;&#x8fc7;&#x53cd;&#x5411;&#x4ee3;&#x7406;&#x6765;&#x544a;&#x8bc9;app&#x662f;https&#x8fd8;&#x662f;http&#xff0c;&#x751a;&#x81f3;&#x662f;&#x4e00;&#x4e2a;&#x65e0;&#x6548;&#x7684;&#x540d;&#x5b57;&#x3002;&#x8be5;&#x503c;&#x7531; req.protocol &#x53cd;&#x6620;&#x3002;\n\nreq.ip &#x548c; req.ips &#x503c;&#x662f;&#x6839;&#x636e;&#x5957;&#x63a5;&#x5b57;&#x5730;&#x5740;&#x548c; X-Forwarded-For &#x6807;&#x5934;&#x586b;&#x5145;&#x7684;&#xff0c;&#x4ece;&#x7b2c;&#x4e00;&#x4e2a;&#x4e0d;&#x53d7;&#x4fe1;&#x4efb;&#x7684;&#x5730;&#x5740;&#x5f00;&#x59cb;&#x3002;\n\ntrust proxy &#x8bbe;&#x7f6e;&#x662f;&#x4f7f;&#x7528; proxy-addr &#x5305;&#x5b9e;&#x73b0;&#x7684;&#x3002;&#x6709;&#x5173;&#x66f4;&#x591a;&#x4fe1;&#x606f;&#xff0c;&#x8bf7;&#x53c2;&#x9605;&#x5176;&#x6587;&#x6863;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1372,1381"}}],"payload":{"tag":"h1","lines":"1308,1309"}},{"content":"&#x8fc1;&#x79fb;&#x5230; Express 4","children":[{"content":"<pre data-lines=\"1386,1409\"><code data-lines=\"1386,1409\">&#x6982;&#x8ff0;\nExpress <span class=\"hljs-number\">4</span> &#x7684;&#x53d8;&#x5316;\n  Express &#x6838;&#x5fc3;&#x548c;&#x4e2d;&#x95f4;&#x4ef6;&#x7cfb;&#x7edf;&#x7684;&#x53d8;&#x5316;\n    app<span class=\"hljs-selector-class\">.use</span> &#x63a5;&#x53d7;&#x53c2;&#x6570;\n  &#x8def;&#x7531;&#x7cfb;&#x7edf;\n    app<span class=\"hljs-selector-class\">.route</span>() &#x65b9;&#x6cd5;\n    express<span class=\"hljs-selector-class\">.Router</span> &#x7c7b;\n  &#x5176;&#x4ed6;&#x53d8;&#x5316;  \n&#x5e94;&#x7528;&#x8fc1;&#x79fb;&#x793a;&#x4f8b;\n  &#x7248;&#x672c; <span class=\"hljs-number\">3</span> &#x5e94;&#x7528;&#x7a0b;&#x5e8f;\n    app<span class=\"hljs-selector-class\">.js</span>\n    package<span class=\"hljs-selector-class\">.json</span>\n  &#x8fc1;&#x79fb;&#x8fc7;&#x7a0b;\n  &#x7248;&#x672c; <span class=\"hljs-number\">4</span> &#x5e94;&#x7528;&#x7a0b;&#x5e8f;\n    package<span class=\"hljs-selector-class\">.json</span>\n    app<span class=\"hljs-selector-class\">.js</span>\n  &#x8fd0;&#x884c;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;\n&#x5347;&#x7ea7;&#x5230; Express <span class=\"hljs-number\">4</span> &#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x751f;&#x6210;&#x5668;\n  &#x5b89;&#x88c5;\n  &#x5e94;&#x7528;&#x751f;&#x6210;&#x5668;&#x7684;&#x53d8;&#x5316;\n  &#x793a;&#x4f8b;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1386,1409"}},{"content":"&#x6982;&#x8ff0;&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"1412,1421\"><code>Express 4 &#x662f; Express 3 &#x7684;&#x91cd;&#x5927;&#x53d8;&#x5316;&#x3002;&#x8fd9;&#x610f;&#x5473;&#x7740;&#x5982;&#x679c;&#x60a8;&#x5728;&#x5176;&#x4f9d;&#x8d56;&#x9879;&#x4e2d;&#x66f4;&#x65b0; Express &#x7248;&#x672c;&#xff0c;&#x73b0;&#x6709;&#x7684; Express 3 &#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x5c06;&#x65e0;&#x6cd5;&#x8fd0;&#x884c;&#x3002;\n\n&#x672c;&#x6587;&#x6db5;&#x76d6;&#xff1a;\n\n- Express 4 &#x7684;&#x53d8;&#x5316;&#x3002;\n\n- &#x5c06; Express 3 &#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x8fc1;&#x79fb;&#x5230; Express 4 &#x7684; &#x4e00;&#x4e2a;&#x4f8b;&#x5b50;&#x3002;\n\n- &#x5347;&#x7ea7;&#x5230; Express 4 &#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x751f;&#x6210;&#x5668;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1412,1421"}}],"payload":{"tag":"h2","lines":"1410,1411"}},{"content":"Express 4 &#x7684;&#x53d8;&#x5316;&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"1426,1439\"><code>Express 4&#x6709;&#x51e0;&#x4e2a;&#x91cd;&#x5927;&#x53d8;&#x5316;&#xff1a;\n\n- Express &#x6838;&#x5fc3;&#x548c;&#x4e2d;&#x95f4;&#x4ef6;&#x7cfb;&#x7edf;&#x7684;&#x53d8;&#x5316;&#x3002; &#x5bf9; Connect &#x548c;&#x5185;&#x7f6e;&#x4e2d;&#x95f4;&#x4ef6;&#x7684;&#x4f9d;&#x8d56;&#x88ab;&#x79fb;&#x9664;&#xff0c;&#x6240;&#x4ee5;&#x4f60;&#x5fc5;&#x987b;&#x81ea;&#x5df1;&#x6dfb;&#x52a0;&#x4e2d;&#x95f4;&#x4ef6;&#x3002;\n\n- &#x66f4;&#x6539;&#x8def;&#x7531;&#x7cfb;&#x7edf;&#x3002;\n\n- &#x5176;&#x4ed6;&#x5404;&#x79cd;&#x53d8;&#x5316;&#x3002;\n\n&#x4e5f;&#x53ef;&#x4ee5;&#x770b;&#x770b;&#xff1a;\n\n- 4.x &#x4e2d;&#x7684;&#x65b0;&#x529f;&#x80fd;\n\n- &#x4ece; 3.x &#x8fc1;&#x79fb;&#x5230; 4.x&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1426,1439"}},{"content":"Express &#x6838;&#x5fc3;&#x548c;&#x4e2d;&#x95f4;&#x4ef6;&#x7cfb;&#x7edf;&#x7684;&#x53d8;&#x5316;&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"1442,1453\"><code>Express 4 &#x4e0d;&#x518d;&#x4f9d;&#x8d56; Connect&#xff0c;&#x5e76;&#x4ece;&#x5176;&#x6838;&#x5fc3;&#x4e2d;&#x5220;&#x9664;&#x4e86;&#x6240;&#x6709;&#x5185;&#x7f6e;&#x4e2d;&#x95f4;&#x4ef6;&#xff0c;&#x9664;&#x4e86; express.static &#x529f;&#x80fd;&#x3002;&#x8fd9;&#x610f;&#x5473;&#x7740; Express &#x73b0;&#x5728;&#x662f;&#x4e00;&#x4e2a;&#x72ec;&#x7acb;&#x7684;&#x8def;&#x7531;&#x548c;&#x4e2d;&#x95f4;&#x4ef6; Web &#x6846;&#x67b6;&#xff0c;&#x5e76;&#x4e14; Express &#x7248;&#x672c;&#x63a7;&#x5236;&#x548c;&#x53d1;&#x5e03;&#x4e0d;&#x53d7;&#x4e2d;&#x95f4;&#x4ef6;&#x66f4;&#x65b0;&#x7684;&#x5f71;&#x54cd;&#x3002;\n\n&#x5982;&#x679c;&#x6ca1;&#x6709;&#x5185;&#x7f6e;&#x4e2d;&#x95f4;&#x4ef6;&#xff0c;&#x60a8;&#x5fc5;&#x987b;&#x663e;&#x5f0f;&#x6dfb;&#x52a0;&#x8fd0;&#x884c;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x6240;&#x9700;&#x7684;&#x6240;&#x6709;&#x4e2d;&#x95f4;&#x4ef6;&#x3002;&#x53ea;&#x9700;&#x6309;&#x7167;&#x4ee5;&#x4e0b;&#x6b65;&#x9aa4;&#x64cd;&#x4f5c;&#xff1a;\n\n- &#x5b89;&#x88c5;&#x6a21;&#x5757;&#xff1a;npm install --save &lt;module-name&gt;\n\n- &#x5728;&#x60a8;&#x7684;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x4e2d;&#xff0c;&#x9700;&#x8981;&#x6a21;&#x5757;&#xff1a;require(&apos;module-name&apos;)\n\n- &#x6839;&#x636e;&#x5176;&#x6587;&#x6863;&#x4f7f;&#x7528;&#x6a21;&#x5757;&#xff1a;app.use( ... )\n\n&#x4e0b;&#x8868;&#x5217;&#x51fa;&#x4e86; Express 3 &#x4e2d;&#x95f4;&#x4ef6;&#x53ca;&#x5176;&#x5728; Express 4 &#x4e2d;&#x7684;&#x5bf9;&#x5e94;&#x9879;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1442,1453"}},{"content":"<pre data-lines=\"1454,1516\"><code data-lines=\"1454,1516\">Express <span class=\"hljs-number\">3</span>\tExpress <span class=\"hljs-number\">4</span>\nexpress<span class=\"hljs-selector-class\">.bodyParser</span>\n\nbody-parser + multer\n\nexpress<span class=\"hljs-selector-class\">.compress</span>\n\ncompression\n\nexpress<span class=\"hljs-selector-class\">.cookieSession</span>\n\ncookie-session\n\nexpress<span class=\"hljs-selector-class\">.cookieParser</span>\n\ncookie-parser\n\nexpress<span class=\"hljs-selector-class\">.logger</span>\n\nmorgan\n\nexpress<span class=\"hljs-selector-class\">.session</span>\n\nexpress-session\n\nexpress<span class=\"hljs-selector-class\">.favicon</span>\n\nserve-favicon\n\nexpress<span class=\"hljs-selector-class\">.responseTime</span>\n\nresponse-<span class=\"hljs-selector-tag\">time</span>\n\nexpress<span class=\"hljs-selector-class\">.errorHandler</span>\n\nerrorhandler\n\nexpress<span class=\"hljs-selector-class\">.methodOverride</span>\n\nmethod-override\n\nexpress<span class=\"hljs-selector-class\">.timeout</span>\n\nconnect-timeout\n\nexpress<span class=\"hljs-selector-class\">.vhost</span>\n\nvhost\n\nexpress<span class=\"hljs-selector-class\">.csrf</span>\n\ncsurf\n\nexpress<span class=\"hljs-selector-class\">.directory</span>\n\nserve-index\n\nexpress<span class=\"hljs-selector-class\">.static</span>\n\nserve-static\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1454,1516"}},{"content":"<pre data-lines=\"1517,1521\"><code>&#x8fd9;&#x91cc;&#x662f; Express 4 &#x4e2d;&#x95f4;&#x4ef6;&#x7684; &#x5b8c;&#x6574;&#x5217;&#x8868;&#x3002;\n\n&#x5728;&#x5927;&#x591a;&#x6570;&#x60c5;&#x51b5;&#x4e0b;&#xff0c;&#x60a8;&#x53ef;&#x4ee5;&#x7b80;&#x5355;&#x5730;&#x5c06;&#x65e7;&#x7248;&#x672c; 3 &#x4e2d;&#x95f4;&#x4ef6;&#x66ff;&#x6362;&#x4e3a; Express 4 &#x5bf9;&#x5e94;&#x7684;&#x4e2d;&#x95f4;&#x4ef6;&#x3002;\n&#x6709;&#x5173;&#x8be6;&#x7ec6;&#x4fe1;&#x606f;&#xff0c;&#x8bf7;&#x53c2;&#x9605; GitHub &#x4e2d;&#x7684;&#x6a21;&#x5757;&#x6587;&#x6863;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1517,1521"}}],"payload":{"tag":"h3","lines":"1440,1441"}},{"content":"app.use &#x63a5;&#x53d7;&#x53c2;&#x6570;&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"1524,1525\"><code>&#x5728;&#x7248;&#x672c; 4 &#x4e2d;&#xff0c;&#x60a8;&#x53ef;&#x4ee5;&#x4f7f;&#x7528;&#x53ef;&#x53d8;&#x53c2;&#x6570;&#x6765;&#x5b9a;&#x4e49;&#x52a0;&#x8f7d;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x7684;&#x8def;&#x5f84;&#xff0c;&#x7136;&#x540e;&#x4ece;&#x8def;&#x7531;&#x5904;&#x7406;&#x7a0b;&#x5e8f;&#x4e2d;&#x8bfb;&#x53d6;&#x53c2;&#x6570;&#x7684;&#x503c;&#x3002;&#x4f8b;&#x5982;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1524,1525"}},{"content":"<pre data-lines=\"1526,1532\"><code class=\"language-js\">app.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-string\">&apos;/book/:id&apos;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res, next</span>) =&gt;</span> {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;ID:&apos;</span>, req.<span class=\"hljs-property\">params</span>.<span class=\"hljs-property\">id</span>)\n  <span class=\"hljs-title function_\">next</span>()\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1526,1532"}}],"payload":{"tag":"h3","lines":"1522,1523"}},{"content":"&#x8def;&#x7531;&#x7cfb;&#x7edf;&#x4e2d;&#x82f1;","children":[{"content":"app.route() &#x65b9;&#x6cd5;&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"1546,1549\"><code>&#x65b0;&#x7684; app.route() &#x65b9;&#x6cd5;&#x4f7f;&#x60a8;&#x80fd;&#x591f;&#x4e3a;&#x8def;&#x7531;&#x8def;&#x5f84;&#x521b;&#x5efa;&#x53ef;&#x94fe;&#x63a5;&#x7684;&#x8def;&#x7531;&#x5904;&#x7406;&#x7a0b;&#x5e8f;&#x3002;&#x56e0;&#x4e3a;&#x8def;&#x5f84;&#x662f;&#x5728;&#x5355;&#x4e2a;&#x4f4d;&#x7f6e;&#x6307;&#x5b9a;&#x7684;&#xff0c;&#x6240;&#x4ee5;&#x521b;&#x5efa;&#x6a21;&#x5757;&#x5316;&#x8def;&#x7531;&#x662f;&#x6709;&#x5e2e;&#x52a9;&#x7684;&#xff0c;&#x56e0;&#x4e3a;&#x8fd9;&#x6709;&#x52a9;&#x4e8e;&#x51cf;&#x5c11;&#x5197;&#x4f59;&#x548c;&#x62fc;&#x5199;&#x9519;&#x8bef;&#x3002;&#x6709;&#x5173;&#x8def;&#x7531;&#x7684;&#x66f4;&#x591a;&#x4fe1;&#x606f;&#xff0c;&#x8bf7;&#x53c2;&#x9605; Router() &#x6587;&#x6863;&#x3002;\n\n&#x8fd9;&#x662f;&#x4f7f;&#x7528; app.route() &#x51fd;&#x6570;&#x5b9a;&#x4e49;&#x7684;&#x94fe;&#x5f0f;&#x8def;&#x7531;&#x5904;&#x7406;&#x7a0b;&#x5e8f;&#x7684;&#x793a;&#x4f8b;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1546,1549"}},{"content":"<pre data-lines=\"1550,1562\"><code class=\"language-js\">app.<span class=\"hljs-title function_\">route</span>(<span class=\"hljs-string\">&apos;/book&apos;</span>)\n  .<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-function\">(<span class=\"hljs-params\">req, res</span>) =&gt;</span> {\n    res.<span class=\"hljs-title function_\">send</span>(<span class=\"hljs-string\">&apos;Get a random book&apos;</span>)\n  })\n  .<span class=\"hljs-title function_\">post</span>(<span class=\"hljs-function\">(<span class=\"hljs-params\">req, res</span>) =&gt;</span> {\n    res.<span class=\"hljs-title function_\">send</span>(<span class=\"hljs-string\">&apos;Add a book&apos;</span>)\n  })\n  .<span class=\"hljs-title function_\">put</span>(<span class=\"hljs-function\">(<span class=\"hljs-params\">req, res</span>) =&gt;</span> {\n    res.<span class=\"hljs-title function_\">send</span>(<span class=\"hljs-string\">&apos;Update the book&apos;</span>)\n  })\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1550,1562"}}],"payload":{"tag":"h4","lines":"1544,1545"}},{"content":"express.Router &#x7c7b;&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"1565,1570\"><code>&#x53e6;&#x4e00;&#x4e2a;&#x6709;&#x52a9;&#x4e8e;&#x7ec4;&#x7ec7;&#x8def;&#x7531;&#x7684;&#x7279;&#x6027;&#x662f;&#x4e00;&#x4e2a;&#x65b0;&#x7c7b; express.Router&#xff0c;&#x60a8;&#x53ef;&#x4ee5;&#x4f7f;&#x7528;&#x5b83;&#x6765;&#x521b;&#x5efa;&#x6a21;&#x5757;&#x5316;&#x7684;&#x53ef;&#x5b89;&#x88c5;&#x8def;&#x7531;&#x5904;&#x7406;&#x7a0b;&#x5e8f;&#x3002;&#x4e00;&#x4e2a;Router&#x5b9e;&#x4f8b;&#x662f;&#x4e00;&#x4e2a;&#x5b8c;&#x6574;&#x7684;&#x4e2d;&#x95f4;&#x4ef6;&#x548c;&#x8def;&#x7531;&#x7cfb;&#x7edf;&#xff1b;&#x56e0;&#x6b64;&#xff0c;&#x5b83;&#x901a;&#x5e38;&#x88ab;&#x79f0;&#x4e3a; &quot;mini-app&quot;&#x3002;\n\n&#x4ee5;&#x4e0b;&#x793a;&#x4f8b;&#x5c06;&#x8def;&#x7531;&#x521b;&#x5efa;&#x4e3a;&#x6a21;&#x5757;&#xff0c;&#x5728;&#x5176;&#x4e2d;&#x52a0;&#x8f7d;&#x4e2d;&#x95f4;&#x4ef6;&#xff0c;&#x5b9a;&#x4e49;&#x4e00;&#x4e9b;&#x8def;&#x7531;&#xff0c;&#x5e76;&#x5c06;&#x5176;&#x5b89;&#x88c5;&#x5728;&#x4e3b;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x7684;&#x8def;&#x5f84;&#x4e0a;&#x3002;\n\n&#x4f8b;&#x5982;&#xff0c;&#x5728;app&#x76ee;&#x5f55;&#x4e0b;&#x521b;&#x5efa;&#x4e00;&#x4e2a;&#x540d;&#x4e3a;birds.js&#x7684;&#x8def;&#x7531;&#x6587;&#x4ef6;&#xff0c;&#x5185;&#x5bb9;&#x5982;&#x4e0b;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1565,1570"}},{"content":"<pre data-lines=\"1571,1591\"><code class=\"language-js\"><span class=\"hljs-keyword\">var</span> express = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;express&apos;</span>)\n<span class=\"hljs-keyword\">var</span> router = express.<span class=\"hljs-title class_\">Router</span>()\n\n<span class=\"hljs-comment\">// middleware specific to this router</span>\nrouter.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-function\">(<span class=\"hljs-params\">req, res, next</span>) =&gt;</span> {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;Time: &apos;</span>, <span class=\"hljs-title class_\">Date</span>.<span class=\"hljs-title function_\">now</span>())\n  <span class=\"hljs-title function_\">next</span>()\n})\n<span class=\"hljs-comment\">// define the home page route</span>\nrouter.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;/&apos;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res</span>) =&gt;</span> {\n  res.<span class=\"hljs-title function_\">send</span>(<span class=\"hljs-string\">&apos;Birds home page&apos;</span>)\n})\n<span class=\"hljs-comment\">// define the about route</span>\nrouter.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;/about&apos;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">req, res</span>) =&gt;</span> {\n  res.<span class=\"hljs-title function_\">send</span>(<span class=\"hljs-string\">&apos;About birds&apos;</span>)\n})\n\n<span class=\"hljs-variable language_\">module</span>.<span class=\"hljs-property\">exports</span> = router\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1571,1591"}},{"content":"<pre data-lines=\"1592,1593\"><code>&#x7136;&#x540e;&#xff0c;&#x5728;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x4e2d;&#x52a0;&#x8f7d;&#x8def;&#x7531;&#x6a21;&#x5757;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1592,1593"}},{"content":"<pre data-lines=\"1594,1601\"><code class=\"language-js\"><span class=\"hljs-keyword\">var</span> birds = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;./birds&apos;</span>)\n\n<span class=\"hljs-comment\">// ...</span>\n\napp.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-string\">&apos;/birds&apos;</span>, birds)\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1594,1601"}},{"content":"<pre data-lines=\"1602,1603\"><code>&#x8be5;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x73b0;&#x5728;&#x5c06;&#x80fd;&#x591f;&#x5904;&#x7406;&#x5bf9; /birds &#x548c; /birds/about &#x8def;&#x5f84;&#x7684;&#x8bf7;&#x6c42;&#xff0c;&#x5e76;&#x5c06;&#x8c03;&#x7528;&#x7279;&#x5b9a;&#x4e8e;&#x8be5;&#x8def;&#x7531;&#x7684; timeLog &#x4e2d;&#x95f4;&#x4ef6;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1602,1603"}}],"payload":{"tag":"h4","lines":"1563,1564"}}],"payload":{"tag":"h3","lines":"1533,1534"}},{"content":"&#x5176;&#x4ed6;&#x53d8;&#x5316;","children":[{"content":"<pre data-lines=\"1606,1607\"><code>&#x4e0b;&#x8868;&#x5217;&#x51fa;&#x4e86; Express 4 &#x4e2d;&#x5176;&#x4ed6;&#x5c0f;&#x7684;&#x4f46;&#x91cd;&#x8981;&#x7684;&#x53d8;&#x5316;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1606,1607"}},{"content":"<pre data-lines=\"1608,1662\"><code data-lines=\"1608,1662\">&#x5bf9;&#x8c61;\t&#x63cf;&#x8ff0;\nNode<span class=\"hljs-selector-class\">.js</span>\n\nExpress <span class=\"hljs-number\">4</span> &#x9700;&#x8981; Node<span class=\"hljs-selector-class\">.js</span> <span class=\"hljs-number\">0.10</span><span class=\"hljs-selector-class\">.x</span> &#x6216;&#x66f4;&#x9ad8;&#x7248;&#x672c;&#xff0c;&#x5e76;&#x4e14;&#x5df2;&#x653e;&#x5f03;&#x5bf9; Node<span class=\"hljs-selector-class\">.js</span> <span class=\"hljs-number\">0.8</span><span class=\"hljs-selector-class\">.x</span> &#x7684;&#x652f;&#x6301;&#x3002;\n\nhttp<span class=\"hljs-selector-class\">.createServer</span>()\n\n&#x4e0d;&#x518d;&#x9700;&#x8981; http &#x6a21;&#x5757;&#xff0c;&#x9664;&#x975e;&#x60a8;&#x9700;&#x8981;&#x76f4;&#x63a5;&#x4f7f;&#x7528;&#x5b83;&#xff08;socket.io/SPDY/HTTPS&#xff09;&#x3002;&#x8be5;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x53ef;&#x4ee5;&#x4f7f;&#x7528; app<span class=\"hljs-selector-class\">.listen</span>() &#x529f;&#x80fd;&#x542f;&#x52a8;&#x3002;\n\napp<span class=\"hljs-selector-class\">.configure</span>()\n\napp<span class=\"hljs-selector-class\">.configure</span>() &#x529f;&#x80fd;&#x5df2;&#x88ab;&#x5220;&#x9664;&#x3002;&#x4f7f;&#x7528; process<span class=\"hljs-selector-class\">.env</span><span class=\"hljs-selector-class\">.NODE_ENV</span> &#x6216; app<span class=\"hljs-selector-class\">.get</span>(<span class=\"hljs-string\">&apos;env&apos;</span>) &#x529f;&#x80fd;&#x68c0;&#x6d4b;&#x73af;&#x5883;&#x5e76;&#x76f8;&#x5e94;&#x5730;&#x914d;&#x7f6e;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x3002;\n\njson spaces\n\nExpress <span class=\"hljs-number\">4</span> &#x4e2d;&#x9ed8;&#x8ba4;&#x7981;&#x7528; json spaces &#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x5c5e;&#x6027;&#x3002;\n\nreq<span class=\"hljs-selector-class\">.accepted</span>()\n\n&#x4f7f;&#x7528; req<span class=\"hljs-selector-class\">.accepts</span>()&#x3001;req<span class=\"hljs-selector-class\">.acceptsEncodings</span>()&#x3001;req<span class=\"hljs-selector-class\">.acceptsCharsets</span>() &#x548c; req<span class=\"hljs-selector-class\">.acceptsLanguages</span>()&#x3002;\n\nres<span class=\"hljs-selector-class\">.location</span>()\n\n&#x4e0d;&#x518d;&#x89e3;&#x6790;&#x76f8;&#x5bf9; URL&#x3002;\n\nreq<span class=\"hljs-selector-class\">.params</span>\n\n&#x4ee5;&#x524d;&#x662f;&#x4e00;&#x4e2a;&#x6570;&#x7ec4;&#xff1b;&#x73b0;&#x5728;&#x662f;&#x4e00;&#x4e2a;&#x5bf9;&#x8c61;&#x3002;\n\nres<span class=\"hljs-selector-class\">.locals</span>\n\n&#x4ee5;&#x524d;&#x662f;&#x4e00;&#x4e2a;&#x51fd;&#x6570;&#xff1b;&#x73b0;&#x5728;&#x662f;&#x4e00;&#x4e2a;&#x5bf9;&#x8c61;&#x3002;\n\nres<span class=\"hljs-selector-class\">.headerSent</span>\n\n&#x66f4;&#x6539;&#x4e3a; res.headersSent&#x3002;\n\napp<span class=\"hljs-selector-class\">.route</span>\n\n&#x73b0;&#x5728;&#x4ee5; app<span class=\"hljs-selector-class\">.mountpath</span> &#x7684;&#x5f62;&#x5f0f;&#x63d0;&#x4f9b;&#x3002;\n\nres<span class=\"hljs-selector-class\">.on</span>(<span class=\"hljs-string\">&apos;header&apos;</span>)\n\n&#x5df2;&#x79fb;&#x9664;&#x3002;\n\nres<span class=\"hljs-selector-class\">.charset</span>\n\n&#x5df2;&#x79fb;&#x9664;&#x3002;\n\nres<span class=\"hljs-selector-class\">.setHeader</span>(<span class=\"hljs-string\">&apos;Set-Cookie&apos;</span>, val)\n\n&#x529f;&#x80fd;&#x73b0;&#x5728;&#x4ec5;&#x9650;&#x4e8e;&#x8bbe;&#x7f6e;&#x57fa;&#x672c; cookie &#x503c;&#x3002;&#x4f7f;&#x7528; res<span class=\"hljs-selector-class\">.cookie</span>() &#x6765;&#x589e;&#x52a0;&#x529f;&#x80fd;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1608,1662"}}],"payload":{"tag":"h3","lines":"1604,1605"}}],"payload":{"tag":"h2","lines":"1422,1423"}},{"content":"&#x5e94;&#x7528;&#x8fc1;&#x79fb;&#x793a;&#x4f8b;&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"1667,1668\"><code>&#x8fd9;&#x662f;&#x5c06; Express 3 &#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x8fc1;&#x79fb;&#x5230; Express 4 &#x7684;&#x793a;&#x4f8b;&#x3002;&#x611f;&#x5174;&#x8da3;&#x7684;&#x6587;&#x4ef6;&#x662f; app.js &#x548c; package.json&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1667,1668"}},{"content":"&#x7248;&#x672c; 3 &#x5e94;&#x7528;&#x7a0b;&#x5e8f;","children":[{"content":"app.js&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"1673,1674\"><code>&#x8003;&#x8651;&#x5177;&#x6709;&#x4ee5;&#x4e0b; app.js &#x6587;&#x4ef6;&#x7684; Express v.3 &#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1673,1674"}},{"content":"<pre data-lines=\"1675,1708\"><code class=\"language-js\"><span class=\"hljs-keyword\">var</span> express = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;express&apos;</span>)\n<span class=\"hljs-keyword\">var</span> routes = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;./routes&apos;</span>)\n<span class=\"hljs-keyword\">var</span> user = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;./routes/user&apos;</span>)\n<span class=\"hljs-keyword\">var</span> http = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;http&apos;</span>)\n<span class=\"hljs-keyword\">var</span> path = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;path&apos;</span>)\n\n<span class=\"hljs-keyword\">var</span> app = <span class=\"hljs-title function_\">express</span>()\n\n<span class=\"hljs-comment\">// all environments</span>\napp.<span class=\"hljs-title function_\">set</span>(<span class=\"hljs-string\">&apos;port&apos;</span>, process.<span class=\"hljs-property\">env</span>.<span class=\"hljs-property\">PORT</span> || <span class=\"hljs-number\">3000</span>)\napp.<span class=\"hljs-title function_\">set</span>(<span class=\"hljs-string\">&apos;views&apos;</span>, path.<span class=\"hljs-title function_\">join</span>(__dirname, <span class=\"hljs-string\">&apos;views&apos;</span>))\napp.<span class=\"hljs-title function_\">set</span>(<span class=\"hljs-string\">&apos;view engine&apos;</span>, <span class=\"hljs-string\">&apos;pug&apos;</span>)\napp.<span class=\"hljs-title function_\">use</span>(express.<span class=\"hljs-title function_\">favicon</span>())\napp.<span class=\"hljs-title function_\">use</span>(express.<span class=\"hljs-title function_\">logger</span>(<span class=\"hljs-string\">&apos;dev&apos;</span>))\napp.<span class=\"hljs-title function_\">use</span>(express.<span class=\"hljs-title function_\">methodOverride</span>())\napp.<span class=\"hljs-title function_\">use</span>(express.<span class=\"hljs-title function_\">session</span>({ <span class=\"hljs-attr\">secret</span>: <span class=\"hljs-string\">&apos;your secret here&apos;</span> }))\napp.<span class=\"hljs-title function_\">use</span>(express.<span class=\"hljs-title function_\">bodyParser</span>())\napp.<span class=\"hljs-title function_\">use</span>(app.<span class=\"hljs-property\">router</span>)\napp.<span class=\"hljs-title function_\">use</span>(express.<span class=\"hljs-title function_\">static</span>(path.<span class=\"hljs-title function_\">join</span>(__dirname, <span class=\"hljs-string\">&apos;public&apos;</span>)))\n\n<span class=\"hljs-comment\">// development only</span>\n<span class=\"hljs-keyword\">if</span> (app.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;env&apos;</span>) === <span class=\"hljs-string\">&apos;development&apos;</span>) {\n  app.<span class=\"hljs-title function_\">use</span>(express.<span class=\"hljs-title function_\">errorHandler</span>())\n}\n\napp.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;/&apos;</span>, routes.<span class=\"hljs-property\">index</span>)\napp.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;/users&apos;</span>, user.<span class=\"hljs-property\">list</span>)\n\nhttp.<span class=\"hljs-title function_\">createServer</span>(app).<span class=\"hljs-title function_\">listen</span>(app.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;port&apos;</span>), <span class=\"hljs-function\">() =&gt;</span> {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;Express server listening on port &apos;</span> + app.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;port&apos;</span>))\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1675,1708"}}],"payload":{"tag":"h4","lines":"1671,1672"}},{"content":"package.json&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"1711,1712\"><code>&#x968f;&#x9644;&#x7684;&#x7248;&#x672c; 3 package.json &#x6587;&#x4ef6;&#x53ef;&#x80fd;&#x5982;&#x4e0b;&#x6240;&#x793a;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1711,1712"}},{"content":"<pre data-lines=\"1713,1727\"><code class=\"language-js\">{\n  <span class=\"hljs-string\">&quot;name&quot;</span>: <span class=\"hljs-string\">&quot;application-name&quot;</span>,\n  <span class=\"hljs-string\">&quot;version&quot;</span>: <span class=\"hljs-string\">&quot;0.0.1&quot;</span>,\n  <span class=\"hljs-string\">&quot;private&quot;</span>: <span class=\"hljs-literal\">true</span>,\n  <span class=\"hljs-string\">&quot;scripts&quot;</span>: {\n    <span class=\"hljs-string\">&quot;start&quot;</span>: <span class=\"hljs-string\">&quot;node app.js&quot;</span>\n  },\n  <span class=\"hljs-string\">&quot;dependencies&quot;</span>: {\n    <span class=\"hljs-string\">&quot;express&quot;</span>: <span class=\"hljs-string\">&quot;3.12.0&quot;</span>,\n    <span class=\"hljs-string\">&quot;pug&quot;</span>: <span class=\"hljs-string\">&quot;*&quot;</span>\n  }\n}\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1713,1727"}}],"payload":{"tag":"h4","lines":"1709,1710"}}],"payload":{"tag":"h3","lines":"1669,1670"}},{"content":"&#x8fc1;&#x79fb;&#x8fc7;&#x7a0b;&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"1730,1731\"><code>&#x901a;&#x8fc7;&#x5b89;&#x88c5; Express 4 &#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x6240;&#x9700;&#x7684;&#x4e2d;&#x95f4;&#x4ef6;&#x5e76;&#x4f7f;&#x7528;&#x4ee5;&#x4e0b;&#x547d;&#x4ee4;&#x5c06; Express &#x548c; Pug &#x66f4;&#x65b0;&#x5230;&#x5404;&#x81ea;&#x7684;&#x6700;&#x65b0;&#x7248;&#x672c;&#x6765;&#x5f00;&#x59cb;&#x8fc1;&#x79fb;&#x8fc7;&#x7a0b;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1730,1731"}},{"content":"<pre data-lines=\"1732,1735\"><code class=\"language-bash\">&#x24; npm install serve-favicon morgan method-override express-session body-parser multer errorhandler express@latest pug@latest --save\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1732,1735"}},{"content":"<pre data-lines=\"1736,1743\"><code>&#x5bf9; app.js &#x8fdb;&#x884c;&#x4ee5;&#x4e0b;&#x66f4;&#x6539;&#xff1a;\n\n&#x5185;&#x7f6e;&#x7684; Express &#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570; express.favicon&#x3001;express.logger&#x3001;express.methodOverride&#x3001;express.session&#x3001;express.bodyParser &#x548c; express.errorHandler &#x5728; express &#x5bf9;&#x8c61;&#x4e0a;&#x4e0d;&#x518d;&#x53ef;&#x7528;&#x3002;&#x60a8;&#x5fc5;&#x987b;&#x624b;&#x52a8;&#x5b89;&#x88c5;&#x5b83;&#x4eec;&#x7684;&#x66ff;&#x4ee3;&#x54c1;&#x5e76;&#x5c06;&#x5b83;&#x4eec;&#x52a0;&#x8f7d;&#x5230;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x4e2d;&#x3002;\n\n&#x60a8;&#x4e0d;&#x518d;&#x9700;&#x8981;&#x52a0;&#x8f7d; app.router &#x51fd;&#x6570;&#x3002;&#x5b83;&#x4e0d;&#x662f;&#x6709;&#x6548;&#x7684; Express 4 &#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x5bf9;&#x8c61;&#xff0c;&#x56e0;&#x6b64;&#x8bf7;&#x5220;&#x9664; app.use(app.router); &#x4ee3;&#x7801;&#x3002;\n\n&#x786e;&#x4fdd;&#x4ee5;&#x6b63;&#x786e;&#x7684;&#x987a;&#x5e8f;&#x52a0;&#x8f7d;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570; - &#x5728;&#x52a0;&#x8f7d;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x8def;&#x7531;&#x540e;&#x52a0;&#x8f7d; errorHandler&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1736,1743"}}],"payload":{"tag":"h3","lines":"1728,1729"}},{"content":"&#x7248;&#x672c; 4 &#x5e94;&#x7528;&#x7a0b;&#x5e8f;","children":[{"content":"package.json&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"1748,1749\"><code>&#x8fd0;&#x884c;&#x4e0a;&#x8ff0; npm &#x547d;&#x4ee4;&#x5c06;&#x66f4;&#x65b0; package.json&#xff0c;&#x5982;&#x4e0b;&#x6240;&#x793a;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1748,1749"}},{"content":"<pre data-lines=\"1750,1771\"><code class=\"language-json\"><span class=\"hljs-punctuation\">{</span>\n  <span class=\"hljs-attr\">&quot;name&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;application-name&quot;</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-attr\">&quot;version&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;0.0.1&quot;</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-attr\">&quot;private&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-literal\"><span class=\"hljs-keyword\">true</span></span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-attr\">&quot;scripts&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n    <span class=\"hljs-attr\">&quot;start&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;node app.js&quot;</span>\n  <span class=\"hljs-punctuation\">}</span><span class=\"hljs-punctuation\">,</span>\n  <span class=\"hljs-attr\">&quot;dependencies&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-punctuation\">{</span>\n    <span class=\"hljs-attr\">&quot;body-parser&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;^1.5.2&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-attr\">&quot;errorhandler&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;^1.1.1&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-attr\">&quot;express&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;^4.8.0&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-attr\">&quot;express-session&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;^1.7.2&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-attr\">&quot;pug&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;^2.0.0&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-attr\">&quot;method-override&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;^2.1.2&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-attr\">&quot;morgan&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;^1.2.2&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-attr\">&quot;multer&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;^0.1.3&quot;</span><span class=\"hljs-punctuation\">,</span>\n    <span class=\"hljs-attr\">&quot;serve-favicon&quot;</span><span class=\"hljs-punctuation\">:</span> <span class=\"hljs-string\">&quot;^2.0.1&quot;</span>\n  <span class=\"hljs-punctuation\">}</span>\n<span class=\"hljs-punctuation\">}</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1750,1771"}}],"payload":{"tag":"h4","lines":"1746,1747"}},{"content":"app.js&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"1774,1775\"><code>&#x7136;&#x540e;&#xff0c;&#x5220;&#x9664;&#x65e0;&#x6548;&#x4ee3;&#x7801;&#xff0c;&#x52a0;&#x8f7d;&#x6240;&#x9700;&#x7684;&#x4e2d;&#x95f4;&#x4ef6;&#xff0c;&#x5e76;&#x6839;&#x636e;&#x9700;&#x8981;&#x8fdb;&#x884c;&#x5176;&#x4ed6;&#x66f4;&#x6539;&#x3002;app.js &#x6587;&#x4ef6;&#x5c06;&#x5982;&#x4e0b;&#x6240;&#x793a;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1774,1775"}},{"content":"<pre data-lines=\"1776,1823\"><code class=\"language-js\"><span class=\"hljs-keyword\">var</span> http = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;http&apos;</span>)\n<span class=\"hljs-keyword\">var</span> express = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;express&apos;</span>)\n<span class=\"hljs-keyword\">var</span> routes = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;./routes&apos;</span>)\n<span class=\"hljs-keyword\">var</span> user = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;./routes/user&apos;</span>)\n<span class=\"hljs-keyword\">var</span> path = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;path&apos;</span>)\n\n<span class=\"hljs-keyword\">var</span> favicon = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;serve-favicon&apos;</span>)\n<span class=\"hljs-keyword\">var</span> logger = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;morgan&apos;</span>)\n<span class=\"hljs-keyword\">var</span> methodOverride = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;method-override&apos;</span>)\n<span class=\"hljs-keyword\">var</span> session = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;express-session&apos;</span>)\n<span class=\"hljs-keyword\">var</span> bodyParser = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;body-parser&apos;</span>)\n<span class=\"hljs-keyword\">var</span> multer = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;multer&apos;</span>)\n<span class=\"hljs-keyword\">var</span> errorHandler = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;errorhandler&apos;</span>)\n\n<span class=\"hljs-keyword\">var</span> app = <span class=\"hljs-title function_\">express</span>()\n\n<span class=\"hljs-comment\">// all environments</span>\napp.<span class=\"hljs-title function_\">set</span>(<span class=\"hljs-string\">&apos;port&apos;</span>, process.<span class=\"hljs-property\">env</span>.<span class=\"hljs-property\">PORT</span> || <span class=\"hljs-number\">3000</span>)\napp.<span class=\"hljs-title function_\">set</span>(<span class=\"hljs-string\">&apos;views&apos;</span>, path.<span class=\"hljs-title function_\">join</span>(__dirname, <span class=\"hljs-string\">&apos;views&apos;</span>))\napp.<span class=\"hljs-title function_\">set</span>(<span class=\"hljs-string\">&apos;view engine&apos;</span>, <span class=\"hljs-string\">&apos;pug&apos;</span>)\napp.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-title function_\">favicon</span>(path.<span class=\"hljs-title function_\">join</span>(__dirname, <span class=\"hljs-string\">&apos;/public/favicon.ico&apos;</span>)))\napp.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-title function_\">logger</span>(<span class=\"hljs-string\">&apos;dev&apos;</span>))\napp.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-title function_\">methodOverride</span>())\napp.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-title function_\">session</span>({\n  <span class=\"hljs-attr\">resave</span>: <span class=\"hljs-literal\">true</span>,\n  <span class=\"hljs-attr\">saveUninitialized</span>: <span class=\"hljs-literal\">true</span>,\n  <span class=\"hljs-attr\">secret</span>: <span class=\"hljs-string\">&apos;uwotm8&apos;</span>\n}))\napp.<span class=\"hljs-title function_\">use</span>(bodyParser.<span class=\"hljs-title function_\">json</span>())\napp.<span class=\"hljs-title function_\">use</span>(bodyParser.<span class=\"hljs-title function_\">urlencoded</span>({ <span class=\"hljs-attr\">extended</span>: <span class=\"hljs-literal\">true</span> }))\napp.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-title function_\">multer</span>())\napp.<span class=\"hljs-title function_\">use</span>(express.<span class=\"hljs-title function_\">static</span>(path.<span class=\"hljs-title function_\">join</span>(__dirname, <span class=\"hljs-string\">&apos;public&apos;</span>)))\n\napp.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;/&apos;</span>, routes.<span class=\"hljs-property\">index</span>)\napp.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;/users&apos;</span>, user.<span class=\"hljs-property\">list</span>)\n\n<span class=\"hljs-comment\">// error handling middleware should be loaded after the loading the routes</span>\n<span class=\"hljs-keyword\">if</span> (app.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;env&apos;</span>) === <span class=\"hljs-string\">&apos;development&apos;</span>) {\n  app.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-title function_\">errorHandler</span>())\n}\n\n<span class=\"hljs-keyword\">var</span> server = http.<span class=\"hljs-title function_\">createServer</span>(app)\nserver.<span class=\"hljs-title function_\">listen</span>(app.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;port&apos;</span>), <span class=\"hljs-function\">() =&gt;</span> {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;Express server listening on port &apos;</span> + app.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;port&apos;</span>))\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1776,1823"}},{"content":"<pre data-lines=\"1824,1825\"><code>&#x9664;&#x975e;&#x60a8;&#x9700;&#x8981;&#x76f4;&#x63a5;&#x4f7f;&#x7528; http &#x6a21;&#x5757;&#xff08;socket.io/SPDY/HTTPS&#xff09;&#xff0c;&#x5426;&#x5219;&#x4e0d;&#x9700;&#x8981;&#x52a0;&#x8f7d;&#x5b83;&#xff0c;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x53ef;&#x4ee5;&#x7b80;&#x5355;&#x5730;&#x4ee5;&#x8fd9;&#x79cd;&#x65b9;&#x5f0f;&#x542f;&#x52a8;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1824,1825"}},{"content":"<pre data-lines=\"1826,1831\"><code class=\"language-js\">app.<span class=\"hljs-title function_\">listen</span>(app.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;port&apos;</span>), <span class=\"hljs-function\">() =&gt;</span> {\n<span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;Express server listening on port &apos;</span> + app.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;port&apos;</span>))\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1826,1831"}}],"payload":{"tag":"h4","lines":"1772,1773"}}],"payload":{"tag":"h3","lines":"1744,1745"}},{"content":"&#x8fd0;&#x884c;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"1834,1835\"><code>&#x8fc1;&#x79fb;&#x8fc7;&#x7a0b;&#x5df2;&#x5b8c;&#x6210;&#xff0c;&#x8be5;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x73b0;&#x5728;&#x662f; Express 4 &#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x3002;&#x8981;&#x786e;&#x8ba4;&#xff0c;&#x8bf7;&#x4f7f;&#x7528;&#x4ee5;&#x4e0b;&#x547d;&#x4ee4;&#x542f;&#x52a8;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1834,1835"}},{"content":"<pre data-lines=\"1836,1839\"><code class=\"language-bash\">&#x24; node .\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1836,1839"}},{"content":"<pre data-lines=\"1840,1841\"><code>&#x52a0;&#x8f7d; http://localhost:3000 &#x5e76;&#x67e5;&#x770b; Express 4 &#x6b63;&#x5728;&#x5448;&#x73b0;&#x7684;&#x4e3b;&#x9875;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1840,1841"}}],"payload":{"tag":"h3","lines":"1832,1833"}}],"payload":{"tag":"h2","lines":"1663,1664"}},{"content":"&#x5347;&#x7ea7;&#x5230; Express 4 &#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x751f;&#x6210;&#x5668;&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"1846,1847\"><code>&#x751f;&#x6210; Express &#x5e94;&#x7528;&#x7684;&#x547d;&#x4ee4;&#x884c;&#x5de5;&#x5177;&#x4f9d;&#x7136;&#x662f; express&#xff0c;&#x4f46;&#x8981;&#x5347;&#x7ea7;&#x5230;&#x65b0;&#x7248;&#x672c;&#xff0c;&#x5fc5;&#x987b;&#x5378;&#x8f7d; Express 3 &#x5e94;&#x7528;&#x751f;&#x6210;&#x5668;&#xff0c;&#x7136;&#x540e;&#x5b89;&#x88c5;&#x65b0;&#x7684; express-generator&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1846,1847"}},{"content":"&#x5b89;&#x88c5;&#x4e2d;&#x82f1;","children":[{"content":"&#x793a;&#x4f8b;&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"1879,1880\"><code>&#x6267;&#x884c;&#x4ee5;&#x4e0b;&#x547d;&#x4ee4;&#x521b;&#x5efa; Express 4 &#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1879,1880"}},{"content":"<pre data-lines=\"1881,1884\"><code class=\"language-bash\">&#x24; express app4\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1881,1884"}},{"content":"<pre data-lines=\"1885,1891\"><code>&#x5982;&#x679c;&#x67e5;&#x770b; app4/app.js &#x6587;&#x4ef6;&#x7684;&#x5185;&#x5bb9;&#xff0c;&#x60a8;&#x4f1a;&#x6ce8;&#x610f;&#x5230;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x6240;&#x9700;&#x7684;&#x6240;&#x6709;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#xff08;express.static &#x9664;&#x5916;&#xff09;\n&#x90fd;&#x4f5c;&#x4e3a;&#x72ec;&#x7acb;&#x6a21;&#x5757;&#x52a0;&#x8f7d;&#xff0c;&#x5e76;&#x4e14; router &#x4e2d;&#x95f4;&#x4ef6;&#x4e0d;&#x518d;&#x663e;&#x5f0f;&#x52a0;&#x8f7d;&#x5230;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x4e2d;&#x3002;\n\n&#x60a8;&#x8fd8;&#x4f1a;&#x6ce8;&#x610f;&#x5230; app.js &#x6587;&#x4ef6;&#x73b0;&#x5728;&#x662f;&#x4e00;&#x4e2a; Node.js &#x6a21;&#x5757;&#xff0c;&#x4e0e;&#x65e7;&#x751f;&#x6210;&#x5668;&#x751f;&#x6210;&#x7684;&#x72ec;&#x7acb;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x4e0d;&#x540c;&#x3002;\n\n&#x5b89;&#x88c5;&#x4f9d;&#x8d56;&#x9879;&#x540e;&#xff0c;&#x4f7f;&#x7528;&#x4ee5;&#x4e0b;&#x547d;&#x4ee4;&#x542f;&#x52a8;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1885,1891"}},{"content":"<pre data-lines=\"1892,1895\"><code class=\"language-bash\">&#x24; npm start\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1892,1895"}},{"content":"<pre data-lines=\"1896,1904\"><code>&#x5982;&#x679c;&#x4f60;&#x67e5;&#x770b; package.json &#x6587;&#x4ef6;&#x4e2d;&#x7684; npm start &#x811a;&#x672c;&#xff0c;&#x4f60;&#x4f1a;&#x6ce8;&#x610f;&#x5230;&#x542f;&#x52a8;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x7684;&#x5b9e;&#x9645;&#x547d;&#x4ee4;&#x662f; node ./bin/www&#xff0c;\n&#x4ee5;&#x524d;&#x5728; Express 3 &#x4e2d;&#x662f; node app.js&#x3002;\n\n&#x56e0;&#x4e3a; Express 4 &#x751f;&#x6210;&#x5668;&#x751f;&#x6210;&#x7684; app.js &#x6587;&#x4ef6;&#x73b0;&#x5728;&#x662f;&#x4e00;&#x4e2a; Node.js &#x6a21;&#x5757;&#xff0c;&#x6240;&#x4ee5;&#x5b83;&#x4e0d;&#x80fd;&#x518d;&#x4f5c;&#x4e3a;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x72ec;&#x7acb;&#x542f;&#x52a8;&#xff08;&#x9664;&#x975e;&#x60a8;&#x4fee;&#x6539;&#x4ee3;&#x7801;&#xff09;&#x3002;&#x8be5;&#x6a21;&#x5757;&#x5fc5;&#x987b;&#x52a0;&#x8f7d;&#x5230; Node.js &#x6587;&#x4ef6;&#x4e2d;&#x5e76;&#x901a;&#x8fc7; Node.js &#x6587;&#x4ef6;&#x542f;&#x52a8;&#x3002;&#x5728;&#x8fd9;&#x79cd;&#x60c5;&#x51b5;&#x4e0b;&#xff0c;Node.js &#x6587;&#x4ef6;&#x662f; ./bin/www&#x3002;\n\nbin &#x76ee;&#x5f55;&#x548c;&#x65e0;&#x6269;&#x5c55;&#x540d;&#x7684; www &#x6587;&#x4ef6;&#x90fd;&#x4e0d;&#x662f;&#x521b;&#x5efa; Express &#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x6216;&#x542f;&#x52a8;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x6240;&#x5fc5;&#x9700;&#x7684;&#x3002;&#x5b83;&#x4eec;&#x53ea;&#x662f;&#x751f;&#x6210;&#x5668;&#x63d0;&#x51fa;&#x7684;&#x5efa;&#x8bae;&#xff0c;&#x56e0;&#x6b64;&#x8bf7;&#x968f;&#x610f;&#x4fee;&#x6539;&#x5b83;&#x4eec;&#x4ee5;&#x6ee1;&#x8db3;&#x60a8;&#x7684;&#x9700;&#x6c42;&#x3002;\n\n&#x8981;&#x6446;&#x8131; www &#x76ee;&#x5f55;&#x5e76;&#x4fdd;&#x7559; &quot;Express 3 way&quot;&#xff0c;&#x8bf7;&#x5220;&#x9664; app.js &#x6587;&#x4ef6;&#x672b;&#x5c3e;&#x7684; module.exports = app; &#x884c;&#xff0c;&#x7136;&#x540e;&#x5c06;&#x4ee5;&#x4e0b;&#x4ee3;&#x7801;&#x7c98;&#x8d34;&#x5230;&#x5176;&#x4f4d;&#x7f6e;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1896,1904"}},{"content":"<pre data-lines=\"1905,1912\"><code class=\"language-js\">app.<span class=\"hljs-title function_\">set</span>(<span class=\"hljs-string\">&apos;port&apos;</span>, process.<span class=\"hljs-property\">env</span>.<span class=\"hljs-property\">PORT</span> || <span class=\"hljs-number\">3000</span>)\n\n<span class=\"hljs-keyword\">var</span> server = app.<span class=\"hljs-title function_\">listen</span>(app.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;port&apos;</span>), <span class=\"hljs-function\">() =&gt;</span> {\n  <span class=\"hljs-title function_\">debug</span>(<span class=\"hljs-string\">&apos;Express server listening on port &apos;</span> + server.<span class=\"hljs-title function_\">address</span>().<span class=\"hljs-property\">port</span>)\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1905,1912"}},{"content":"<pre data-lines=\"1913,1914\"><code>&#x786e;&#x4fdd;&#x4f7f;&#x7528;&#x4ee5;&#x4e0b;&#x4ee3;&#x7801;&#x5728; app.js &#x6587;&#x4ef6;&#x7684;&#x9876;&#x90e8;&#x52a0;&#x8f7d; debug &#x6a21;&#x5757;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1913,1914"}},{"content":"<pre data-lines=\"1915,1918\"><code class=\"language-js\"><span class=\"hljs-keyword\">var</span> debug = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;debug&apos;</span>)(<span class=\"hljs-string\">&apos;app4&apos;</span>)\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1915,1918"}},{"content":"<pre data-lines=\"1919,1923\"><code>&#x63a5;&#x4e0b;&#x6765;&#xff0c;&#x5c06; package.json &#x6587;&#x4ef6;&#x4e2d;&#x7684; &quot;start&quot;: &quot;node ./bin/www&quot; &#x66f4;&#x6539;&#x4e3a; &quot;start&quot;: &quot;node app.js&quot;&#x3002;\n\n&#x60a8;&#x73b0;&#x5728;&#x5df2;&#x5c06; ./bin/www &#x7684;&#x529f;&#x80fd;&#x79fb;&#x56de; app.js&#x3002;&#x4e0d;&#x5efa;&#x8bae;&#x8fdb;&#x884c;&#x6b64;&#x66f4;&#x6539;&#xff0c;&#x4f46;&#x8be5;&#x7ec3;&#x4e60;&#x53ef;&#x5e2e;&#x52a9;&#x60a8;&#x4e86;&#x89e3; ./bin/www \n&#x6587;&#x4ef6;&#x7684;&#x5de5;&#x4f5c;&#x539f;&#x7406;&#x4ee5;&#x53ca; app.js &#x6587;&#x4ef6;&#x4e0d;&#x518d;&#x81ea;&#x884c;&#x542f;&#x52a8;&#x7684;&#x539f;&#x56e0;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1919,1923"}},{"content":"<pre data-lines=\"1924,1947\"><code data-lines=\"1924,1947\">&#x6982;&#x8ff0;\nExpress <span class=\"hljs-number\">4</span> &#x7684;&#x53d8;&#x5316;\n  Express &#x6838;&#x5fc3;&#x548c;&#x4e2d;&#x95f4;&#x4ef6;&#x7cfb;&#x7edf;&#x7684;&#x53d8;&#x5316;\n    app<span class=\"hljs-selector-class\">.use</span> &#x63a5;&#x53d7;&#x53c2;&#x6570;\n  &#x8def;&#x7531;&#x7cfb;&#x7edf;\n    app<span class=\"hljs-selector-class\">.route</span>() &#x65b9;&#x6cd5;\n    express<span class=\"hljs-selector-class\">.Router</span> &#x7c7b;\n  &#x5176;&#x4ed6;&#x53d8;&#x5316;  \n&#x5e94;&#x7528;&#x8fc1;&#x79fb;&#x793a;&#x4f8b;\n  &#x7248;&#x672c; <span class=\"hljs-number\">3</span> &#x5e94;&#x7528;&#x7a0b;&#x5e8f;\n    app<span class=\"hljs-selector-class\">.js</span>\n    package<span class=\"hljs-selector-class\">.json</span>\n  &#x8fc1;&#x79fb;&#x8fc7;&#x7a0b;\n  &#x7248;&#x672c; <span class=\"hljs-number\">4</span> &#x5e94;&#x7528;&#x7a0b;&#x5e8f;\n    package<span class=\"hljs-selector-class\">.json</span>\n    app<span class=\"hljs-selector-class\">.js</span>\n  &#x8fd0;&#x884c;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;\n&#x5347;&#x7ea7;&#x5230; Express <span class=\"hljs-number\">4</span> &#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x751f;&#x6210;&#x5668;\n  &#x5b89;&#x88c5;\n  &#x5e94;&#x7528;&#x751f;&#x6210;&#x5668;&#x7684;&#x53d8;&#x5316;\n  &#x793a;&#x4f8b;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1924,1947"}}],"payload":{"tag":"h4","lines":"1877,1878"}}],"payload":{"tag":"h3","lines":"1848,1849"}}],"payload":{"tag":"h2","lines":"1842,1843"}}],"payload":{"tag":"h1","lines":"1382,1383"}},{"content":"&#x8fc1;&#x79fb;&#x5230; Express 5","children":[{"content":"<pre data-lines=\"1952,1975\"><code data-lines=\"1952,1975\">&#x6982;&#x8ff0;\nExpress <span class=\"hljs-number\">5</span> &#x7684;&#x53d8;&#x5316;\n&#x5220;&#x9664;&#x7684;&#x65b9;&#x6cd5;&#x548c;&#x5c5e;&#x6027;\n  app<span class=\"hljs-selector-class\">.del</span>()\n  app<span class=\"hljs-selector-class\">.param</span>(fn)\n  &#x590d;&#x6570;&#x65b9;&#x6cd5;&#x540d;\n  app<span class=\"hljs-selector-class\">.param</span>(name, fn) &#x540d;&#x79f0;&#x4e2d;&#x7684;&#x524d;&#x5bfc;&#x5192;&#x53f7; (:)\n  req<span class=\"hljs-selector-class\">.param</span>(name)\n  res<span class=\"hljs-selector-class\">.json</span>(obj, status)\n  res<span class=\"hljs-selector-class\">.jsonp</span>(obj, status)\n  res<span class=\"hljs-selector-class\">.send</span>(<span class=\"hljs-selector-tag\">body</span>, status)\n  res<span class=\"hljs-selector-class\">.send</span>(status)\n  res<span class=\"hljs-selector-class\">.sendfile</span>()\n&#x6539;&#x53d8;\n  &#x8def;&#x5f84;&#x8def;&#x7531;&#x5339;&#x914d;&#x8bed;&#x6cd5;\n  &#x4ece;&#x4e2d;&#x95f4;&#x4ef6;&#x548c;&#x5904;&#x7406;&#x7a0b;&#x5e8f;&#x5904;&#x7406;&#x7684;&#x62d2;&#x7edd; promise\n  app<span class=\"hljs-selector-class\">.router</span>\n  req<span class=\"hljs-selector-class\">.host</span>\n  req<span class=\"hljs-selector-class\">.query</span>\n&#x6539;&#x8fdb;\n  res<span class=\"hljs-selector-class\">.render</span>()\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1952,1975"}},{"content":"&#x6982;&#x8ff0;&#x4e2d;&#x82f1;","children":[{"content":"","children":[{"content":"<pre data-lines=\"1980,1983\"><code>Express 5.0 &#x4ecd;&#x5904;&#x4e8e; beta &#x53d1;&#x5e03;&#x9636;&#x6bb5;&#xff0c;&#x4f46;&#x8fd9;&#x91cc;&#x662f;&#x53d1;&#x5e03;&#x4e2d;&#x5c06;&#x8981;&#x8fdb;&#x884c;&#x7684;&#x66f4;&#x6539;&#x4ee5;&#x53ca;&#x5982;&#x4f55;&#x5c06; Express 4 &#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x8fc1;&#x79fb;&#x5230; Express 5 &#x7684;&#x9884;&#x89c8;&#x3002;\n\n&#x8981;&#x5b89;&#x88c5;&#x6700;&#x65b0;&#x7684;&#x6d4b;&#x8bd5;&#x7248;&#x5e76;&#x9884;&#x89c8; Express 5&#xff0c;&#x8bf7;&#x5728;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x6839;&#x76ee;&#x5f55;&#x4e2d;&#x8f93;&#x5165;&#x4ee5;&#x4e0b;&#x547d;&#x4ee4;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1980,1983"}},{"content":"<pre data-lines=\"1984,1987\"><code class=\"language-bash\">&#x24; npm install <span class=\"hljs-string\">&quot;express@&gt;=5.0.0-beta.1&quot;</span> --save\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1984,1987"}},{"content":"<pre data-lines=\"1992,2029\"><code>**&#x5220;&#x9664;&#x7684;&#x65b9;&#x6cd5;&#x548c;&#x5c5e;&#x6027;**\n\n- app.del()\n\n- app.param(fn)\n\n- &#x590d;&#x6570;&#x65b9;&#x6cd5;&#x540d;\n\n- app.param(name, fn) &#x7684;&#x540d;&#x79f0;&#x53c2;&#x6570;&#x4e2d;&#x7684;&#x524d;&#x5bfc;&#x5192;&#x53f7;\n\n- req.param(name)\n\n- res.json(obj, status)\n\n- res.jsonp(obj, status)\n\n- res.send(body, status)\n\n- res.send(status)\n\n- res.sendfile()\n\n**&#x6539;&#x53d8;**\n\n- &#x8def;&#x5f84;&#x8def;&#x7531;&#x5339;&#x914d;&#x8bed;&#x6cd5;\n\n- &#x4ece;&#x4e2d;&#x95f4;&#x4ef6;&#x548c;&#x5904;&#x7406;&#x7a0b;&#x5e8f;&#x5904;&#x7406;&#x7684;&#x62d2;&#x7edd; promise\n\n- app.router\n\n- req.host\n\n- req.query\n\n**&#x6539;&#x8fdb;**\n\n- res.render()\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1992,2029"}}],"payload":{"tag":"h4","lines":"1978,1979"}},{"content":"&#x5220;&#x9664;&#x7684;&#x65b9;&#x6cd5;&#x548c;&#x5c5e;&#x6027;&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"2033,2034\"><code>&#x5982;&#x679c;&#x60a8;&#x5728;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x4e2d;&#x4f7f;&#x7528;&#x8fd9;&#x4e9b;&#x65b9;&#x6cd5;&#x6216;&#x5c5e;&#x6027;&#x4e2d;&#x7684;&#x4efb;&#x4f55;&#x4e00;&#x4e2a;&#xff0c;&#x5b83;&#x90fd;&#x4f1a;&#x5d29;&#x6e83;&#x3002;&#x56e0;&#x6b64;&#xff0c;&#x60a8;&#x9700;&#x8981;&#x5728;&#x66f4;&#x65b0;&#x5230;&#x7248;&#x672c; 5 &#x540e;&#x66f4;&#x6539;&#x60a8;&#x7684;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2033,2034"}}],"payload":{"tag":"h4","lines":"2031,2032"}},{"content":"app.del()&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"2037,2042\"><code>Express 5 &#x4e0d;&#x518d;&#x652f;&#x6301; app.del() &#x529f;&#x80fd;&#x3002;&#x5982;&#x679c;&#x60a8;&#x4f7f;&#x7528;&#x6b64;&#x51fd;&#x6570;&#xff0c;&#x5219;&#x4f1a;&#x5f15;&#x53d1;&#x9519;&#x8bef;&#x3002;\n&#x8981;&#x6ce8;&#x518c; HTTP DELETE &#x8def;&#x7531;&#xff0c;&#x8bf7;&#x6539;&#x7528; app.delete() &#x51fd;&#x6570;&#x3002;\n\n&#x6700;&#x521d;&#x4f7f;&#x7528; del &#x800c;&#x4e0d;&#x662f; delete&#xff0c;&#x56e0;&#x4e3a; delete &#x662f; JavaScript &#x4e2d;&#x7684;&#x4fdd;&#x7559;&#x5173;&#x952e;&#x5b57;&#x3002;\n&#x4f46;&#x662f;&#xff0c;&#x4ece; ECMAScript 6 &#x5f00;&#x59cb;&#xff0c;delete &#x548c;&#x5176;&#x4ed6;&#x4fdd;&#x7559;&#x5173;&#x952e;&#x5b57;&#x53ef;&#x4ee5;&#x5408;&#x6cd5;&#x5730;&#x7528;&#x4f5c;&#x5c5e;&#x6027;&#x540d;&#x79f0;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2037,2042"}}],"payload":{"tag":"h4","lines":"2035,2036"}},{"content":"app.param(fn)&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"2045,2047\"><code>app.param(fn) &#x7b7e;&#x540d;&#x7528;&#x4e8e;&#x4fee;&#x6539; app.param(name, fn) &#x51fd;&#x6570;&#x7684;&#x884c;&#x4e3a;&#x3002;\n&#x5b83;&#x81ea; v4.11.0 &#x8d77;&#x5df2;&#x88ab;&#x5f03;&#x7528;&#xff0c;Express 5 &#x6839;&#x672c;&#x4e0d;&#x518d;&#x652f;&#x6301;&#x5b83;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2045,2047"}}],"payload":{"tag":"h4","lines":"2043,2044"}},{"content":"&#x590d;&#x6570;&#x65b9;&#x6cd5;&#x540d;&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"2050,2057\"><code>&#x4ee5;&#x4e0b;&#x65b9;&#x6cd5;&#x540d;&#x79f0;&#x5df2;&#x590d;&#x6570;&#x3002;&#x5728; Express 4 &#x4e2d;&#xff0c;&#x4f7f;&#x7528;&#x65e7;&#x65b9;&#x6cd5;&#x4f1a;&#x5bfc;&#x81f4;&#x5f03;&#x7528;&#x8b66;&#x544a;&#x3002;Express 5 &#x6839;&#x672c;&#x4e0d;&#x518d;&#x652f;&#x6301;&#x5b83;&#x4eec;&#xff1a;\n\nreq.acceptsCharset() &#x88ab; req.acceptsCharsets() &#x53d6;&#x4ee3;&#x3002;\n\nreq.acceptsEncoding() &#x88ab; req.acceptsEncodings() &#x53d6;&#x4ee3;&#x3002;\n\nreq.acceptsLanguage() &#x88ab; req.acceptsLanguages() &#x53d6;&#x4ee3;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2050,2057"}}],"payload":{"tag":"h4","lines":"2048,2049"}},{"content":"app.param(name, fn) &#x540d;&#x79f0;&#x4e2d;&#x7684;&#x524d;&#x5bfc;&#x5192;&#x53f7; (:)&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"2060,2063\"><code>app.param(name, fn) &#x51fd;&#x6570;&#x540d;&#x79f0;&#x4e2d;&#x7684;&#x524d;&#x5bfc;&#x5192;&#x53f7;&#x5b57;&#x7b26; (:) &#x662f; Express 3 &#x7684;&#x6b8b;&#x4f59;&#xff0c;&#x4e3a;&#x4e86;&#x5411;&#x540e;&#x517c;&#x5bb9;&#xff0c;Express 4 &#x901a;&#x8fc7;&#x5f03;&#x7528;&#x901a;&#x77e5;&#x652f;&#x6301;&#x5b83;&#x3002;Express 5 &#x5c06;&#x9ed8;&#x9ed8;&#x5730;&#x5ffd;&#x7565;&#x5b83;&#x5e76;&#x4f7f;&#x7528; name &#x53c2;&#x6570;&#x800c;&#x4e0d;&#x7528;&#x5192;&#x53f7;&#x4f5c;&#x4e3a;&#x524d;&#x7f00;&#x3002;\n\n&#x5982;&#x679c;&#x60a8;&#x9075;&#x5faa; app.param &#x7684; Express 4 &#x6587;&#x6863;&#xff0c;&#x8fd9;&#x4e0d;&#x4f1a;&#x5f71;&#x54cd;&#x60a8;&#x7684;&#x4ee3;&#x7801;&#xff0c;&#x56e0;&#x4e3a;&#x5b83;&#x6ca1;&#x6709;&#x63d0;&#x53ca;&#x524d;&#x5bfc;&#x5192;&#x53f7;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2060,2063"}}],"payload":{"tag":"h4","lines":"2058,2059"}},{"content":"req.param(name)&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"2066,2067\"><code>&#x8fd9;&#x79cd;&#x68c0;&#x7d22;&#x8868;&#x5355;&#x6570;&#x636e;&#x7684;&#x6f5c;&#x5728;&#x6df7;&#x4e71;&#x548c;&#x5371;&#x9669;&#x65b9;&#x6cd5;&#x5df2;&#x88ab;&#x5220;&#x9664;&#x3002;&#x60a8;&#x73b0;&#x5728;&#x9700;&#x8981;&#x4e13;&#x95e8;&#x5728; req.params&#x3001;req.body &#x6216; req.query &#x5bf9;&#x8c61;&#x4e2d;&#x67e5;&#x627e;&#x63d0;&#x4ea4;&#x7684;&#x53c2;&#x6570;&#x540d;&#x79f0;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2066,2067"}}],"payload":{"tag":"h4","lines":"2064,2065"}},{"content":"res.json(obj, status)&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"2070,2071\"><code>Express 5 &#x4e0d;&#x518d;&#x652f;&#x6301;&#x7b7e;&#x540d; res.json(obj, status)&#x3002;&#x800c;&#x662f;&#xff0c;&#x8bbe;&#x7f6e;&#x72b6;&#x6001;&#xff0c;&#x7136;&#x540e;&#x5c06;&#x5176;&#x94fe;&#x63a5;&#x5230; res.json() &#x65b9;&#x6cd5;&#xff0c;&#x5982;&#x4e0b;&#x6240;&#x793a;&#xff1a;res.status(status).json(obj)&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2070,2071"}}],"payload":{"tag":"h4","lines":"2068,2069"}},{"content":"res.jsonp(obj, status)&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"2074,2075\"><code>Express 5 &#x4e0d;&#x518d;&#x652f;&#x6301;&#x7b7e;&#x540d; res.jsonp(obj, status)&#x3002;&#x800c;&#x662f;&#xff0c;&#x8bbe;&#x7f6e;&#x72b6;&#x6001;&#xff0c;&#x7136;&#x540e;&#x5c06;&#x5176;&#x94fe;&#x63a5;&#x5230; res.jsonp() &#x65b9;&#x6cd5;&#xff0c;&#x5982;&#x4e0b;&#x6240;&#x793a;&#xff1a;res.status(status).jsonp(obj)&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2074,2075"}}],"payload":{"tag":"h4","lines":"2072,2073"}},{"content":"res.send(body, status)&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"2078,2079\"><code>Express 5 &#x4e0d;&#x518d;&#x652f;&#x6301;&#x7b7e;&#x540d; res.send(obj, status)&#x3002;&#x800c;&#x662f;&#xff0c;&#x8bbe;&#x7f6e;&#x72b6;&#x6001;&#xff0c;&#x7136;&#x540e;&#x5c06;&#x5176;&#x94fe;&#x63a5;&#x5230; res.send() &#x65b9;&#x6cd5;&#xff0c;&#x5982;&#x4e0b;&#x6240;&#x793a;&#xff1a;res.status(status).send(obj)&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2078,2079"}}],"payload":{"tag":"h4","lines":"2076,2077"}},{"content":"res.send(status)&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"2082,2083\"><code>Express 5 &#x4e0d;&#x518d;&#x652f;&#x6301;&#x7b7e;&#x540d; res.send(status)&#xff0c;&#x5176;&#x4e2d; status &#x662f;&#x4e00;&#x4e2a;&#x6570;&#x5b57;&#x3002;&#x800c;&#x662f;&#x4f7f;&#x7528; res.sendStatus(statusCode) &#x51fd;&#x6570;&#xff0c;&#x8be5;&#x51fd;&#x6570;&#x8bbe;&#x7f6e; HTTP &#x54cd;&#x5e94;&#x6807;&#x5934;&#x72b6;&#x6001;&#x4ee3;&#x7801;&#x5e76;&#x53d1;&#x9001;&#x4ee3;&#x7801;&#x7684;&#x6587;&#x672c;&#x7248;&#x672c;&#xff1a;&quot;Not Found&quot;&#x3001;&quot;Internal Server Error&quot; &#x7b49;&#x3002;&#x5982;&#x679c;&#x60a8;&#x9700;&#x8981;&#x4f7f;&#x7528; res.send() &#x51fd;&#x6570;&#x53d1;&#x9001;&#x6570;&#x5b57;&#xff0c;&#x8bf7;&#x5f15;&#x7528;&#x8be5;&#x6570;&#x5b57;&#x4ee5;&#x5c06;&#x5176;&#x8f6c;&#x6362;&#x4e3a;&#x5b57;&#x7b26;&#x4e32;&#xff0c;&#x4ee5;&#x4fbf; Express &#x4e0d;&#x4f1a;&#x5c06;&#x5176;&#x89e3;&#x91ca;&#x4e3a;&#x5c1d;&#x8bd5;&#x4f7f;&#x7528;&#x4e0d;&#x53d7;&#x652f;&#x6301;&#x7684;&#x65e7;&#x7b7e;&#x540d;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2082,2083"}}],"payload":{"tag":"h4","lines":"2080,2081"}},{"content":"res.sendfile()&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"2086,2087\"><code>Express 5 &#x4e2d;&#x7684; res.sendfile() &#x529f;&#x80fd;&#x5df2;&#x88ab;&#x9a7c;&#x5cf0;&#x5f0f;&#x7248;&#x672c; res.sendFile() &#x53d6;&#x4ee3;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2086,2087"}}],"payload":{"tag":"h4","lines":"2084,2085"}}],"payload":{"tag":"h3","lines":"1976,1977"}},{"content":"&#x6539;&#x53d8;","children":[{"content":"&#x8def;&#x5f84;&#x8def;&#x7531;&#x5339;&#x914d;&#x8bed;&#x6cd5;&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"2093,2108\"><code>&#x8def;&#x5f84;&#x8def;&#x7531;&#x5339;&#x914d;&#x8bed;&#x6cd5;&#x662f;&#x6307;&#x5c06;&#x5b57;&#x7b26;&#x4e32;&#x4f5c;&#x4e3a;&#x7b2c;&#x4e00;&#x4e2a;&#x53c2;&#x6570;&#x63d0;&#x4f9b;&#x7ed9; app.all()&#x3001;app.use()&#x3001;app.METHOD()&#x3001;router.all()&#x3001;router.METHOD() &#x548c; router.use() API&#x3002;&#x5bf9;&#x8def;&#x5f84;&#x5b57;&#x7b26;&#x4e32;&#x4e0e;&#x4f20;&#x5165;&#x8bf7;&#x6c42;&#x7684;&#x5339;&#x914d;&#x65b9;&#x5f0f;&#x8fdb;&#x884c;&#x4e86;&#x4ee5;&#x4e0b;&#x66f4;&#x6539;&#xff1a;\n\n- &#x6dfb;&#x52a0;&#x65b0;&#x7684; ?&#x3001;* &#x548c; + &#x53c2;&#x6570;&#x4fee;&#x9970;&#x7b26;&#x3002;\n\n- &#x5339;&#x914d;&#x7ec4;&#x8868;&#x8fbe;&#x5f0f;&#x53ea;&#x662f; RegExp &#x8bed;&#x6cd5;&#x3002;\n- &#x4f8b;&#x5982;&#xff0c;(*) &#x4e0d;&#x518d;&#x6709;&#x6548;&#xff0c;&#x5fc5;&#x987b;&#x5199;&#x4e3a; (.*)&#x3002;\n\n- req.params &#x4e2d;&#x4e0d;&#x518d;&#x6309;&#x4f4d;&#x7f6e;&#x63d0;&#x4f9b;&#x547d;&#x540d;&#x5339;&#x914d;&#x7ec4;&#x3002;\n- /:foo(.*) &#x4ec5;&#x4f5c;&#x4e3a; req.params.foo &#x6355;&#x83b7;&#xff0c;&#x4e0d;&#x80fd;&#x4f5c;&#x4e3a; req.params[0] &#x4f7f;&#x7528;&#x3002;\n\n- &#x6b63;&#x5219;&#x8868;&#x8fbe;&#x5f0f;&#x53ea;&#x80fd;&#x5728;&#x5339;&#x914d;&#x7ec4;&#x4e2d;&#x4f7f;&#x7528;&#x3002;\n- /\\\\d+ &#x4e0d;&#x518d;&#x6709;&#x6548;&#xff0c;&#x5fc5;&#x987b;&#x5199;&#x6210; /(\\\\d+)&#x3002;\n\n- &#x5220;&#x9664;&#x4e86;&#x7279;&#x6b8a;&#x7684; * &#x8def;&#x5f84;&#x6bb5;&#x884c;&#x4e3a;&#x3002;\n- /foo/*/bar &#x5c06;&#x5339;&#x914d;&#x6587;&#x5b57; * &#x4f5c;&#x4e3a;&#x4e2d;&#x95f4;&#x6bb5;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2093,2108"}}],"payload":{"tag":"h4","lines":"2091,2092"}},{"content":"&#x4ece;&#x4e2d;&#x95f4;&#x4ef6;&#x548c;&#x5904;&#x7406;&#x7a0b;&#x5e8f;&#x5904;&#x7406;&#x7684;&#x62d2;&#x7edd; promise&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"2111,2116\"><code>&#x73b0;&#x5728;&#xff0c;&#x901a;&#x8fc7;&#x5c06;&#x88ab;&#x62d2;&#x7edd;&#x7684;&#x503c;&#x4f5c;&#x4e3a; Error &#x8f6c;&#x53d1;&#x7ed9;&#x9519;&#x8bef;&#x5904;&#x7406;&#x4e2d;&#x95f4;&#x4ef6;&#x6765;&#x5904;&#x7406;&#x8fd4;&#x56de;&#x88ab;&#x62d2;&#x7edd; promise &#x7684;&#x8bf7;&#x6c42;&#x4e2d;&#x95f4;&#x4ef6;&#x548c;&#x5904;&#x7406;&#x7a0b;&#x5e8f;&#x3002;\n&#x8fd9;&#x610f;&#x5473;&#x7740;&#x4f7f;&#x7528; async &#x51fd;&#x6570;&#x4f5c;&#x4e3a;&#x4e2d;&#x95f4;&#x4ef6;&#x548c;&#x5904;&#x7406;&#x7a0b;&#x5e8f;&#x6bd4;&#x4ee5;&#x5f80;&#x4efb;&#x4f55;&#x65f6;&#x5019;&#x90fd;&#x5bb9;&#x6613;&#x3002;&#x5f53;&#x5728; async &#x51fd;&#x6570;&#x4e2d;&#x629b;&#x51fa;&#x9519;&#x8bef;&#x6216;&#x5728;&#x5f02;&#x6b65;&#x51fd;&#x6570;&#x4e2d; awaited \n&#x88ab;&#x62d2;&#x7edd;&#x7684; Promise &#x65f6;&#xff0c;&#x8fd9;&#x4e9b;&#x9519;&#x8bef;&#x5c06;&#x50cf;&#x8c03;&#x7528; next(err) &#x4e00;&#x6837;&#x4f20;&#x9012;&#x7ed9;&#x9519;&#x8bef;&#x5904;&#x7406;&#x7a0b;&#x5e8f;&#x3002;\n\nExpress &#x5982;&#x4f55;&#x5904;&#x7406;&#x9519;&#x8bef;&#x7684;&#x8be6;&#x7ec6;&#x4fe1;&#x606f;&#x5728; &#x9519;&#x8bef;&#x5904;&#x7406;&#x6587;&#x6863; &#x4e2d;&#x8fdb;&#x884c;&#x4e86;&#x4ecb;&#x7ecd;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2111,2116"}}],"payload":{"tag":"h4","lines":"2109,2110"}},{"content":"app.router&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"2119,2120\"><code>&#x5728; Express 4 &#x4e2d;&#x5220;&#x9664;&#x7684; app.router &#x5bf9;&#x8c61;&#x5728; Express 5 &#x4e2d;&#x5377;&#x571f;&#x91cd;&#x6765;&#x3002;&#x5728;&#x65b0;&#x7248;&#x672c;&#x4e2d;&#xff0c;&#x6b64;&#x5bf9;&#x8c61;&#x53ea;&#x662f;&#x5bf9;&#x57fa;&#x672c; Express &#x8def;&#x7531;&#x7684;&#x5f15;&#x7528;&#xff0c;&#x8fd9;&#x4e0e; Express 3 &#x4e2d;&#x7684;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x5fc5;&#x987b;&#x663e;&#x5f0f;&#x52a0;&#x8f7d;&#x5b83;&#x4e0d;&#x540c;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2119,2120"}}],"payload":{"tag":"h4","lines":"2117,2118"}},{"content":"req.host&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"2123,2124\"><code>&#x5728; Express 4 &#x4e2d;&#xff0c;&#x5982;&#x679c;&#x7aef;&#x53e3;&#x53f7;&#x5b58;&#x5728;&#xff0c;req.host &#x51fd;&#x6570;&#x4f1a;&#x9519;&#x8bef;&#x5730;&#x5265;&#x79bb;&#x7aef;&#x53e3;&#x53f7;&#x3002;&#x5728; Express 5 &#x4e2d;&#xff0c;&#x7aef;&#x53e3;&#x53f7;&#x4fdd;&#x6301;&#x4e0d;&#x53d8;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2123,2124"}}],"payload":{"tag":"h4","lines":"2121,2122"}},{"content":"req.query&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"2127,2128\"><code>req.query &#x5c5e;&#x6027;&#x4e0d;&#x518d;&#x662f;&#x53ef;&#x5199;&#x5c5e;&#x6027;&#xff0c;&#x800c;&#x662f;&#x4e00;&#x4e2a; getter&#x3002;&#x9ed8;&#x8ba4;&#x67e5;&#x8be2;&#x89e3;&#x6790;&#x5668;&#x5df2;&#x4ece; &quot;extended&quot; &#x66f4;&#x6539;&#x4e3a; &quot;simple&quot;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2127,2128"}}],"payload":{"tag":"h4","lines":"2125,2126"}}],"payload":{"tag":"h3","lines":"2089,2090"}},{"content":"&#x6539;&#x8fdb;","children":[{"content":"res.render()&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"2133,2134\"><code>&#x6b64;&#x65b9;&#x6cd5;&#x73b0;&#x5728;&#x5bf9;&#x6240;&#x6709;&#x89c6;&#x56fe;&#x5f15;&#x64ce;&#x5f3a;&#x5236;&#x6267;&#x884c;&#x5f02;&#x6b65;&#x884c;&#x4e3a;&#xff0c;&#x907f;&#x514d;&#x7531;&#x5177;&#x6709;&#x540c;&#x6b65;&#x5b9e;&#x73b0;&#x4e14;&#x8fdd;&#x53cd;&#x63a8;&#x8350;&#x63a5;&#x53e3;&#x7684;&#x89c6;&#x56fe;&#x5f15;&#x64ce;&#x5f15;&#x8d77;&#x7684;&#x9519;&#x8bef;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2133,2134"}},{"content":"<pre data-lines=\"2135,2158\"><code data-lines=\"2135,2158\">&#x6982;&#x8ff0;\nExpress <span class=\"hljs-number\">5</span> &#x7684;&#x53d8;&#x5316;\n&#x5220;&#x9664;&#x7684;&#x65b9;&#x6cd5;&#x548c;&#x5c5e;&#x6027;\n  app<span class=\"hljs-selector-class\">.del</span>()\n  app<span class=\"hljs-selector-class\">.param</span>(fn)\n  &#x590d;&#x6570;&#x65b9;&#x6cd5;&#x540d;\n  app<span class=\"hljs-selector-class\">.param</span>(name, fn) &#x540d;&#x79f0;&#x4e2d;&#x7684;&#x524d;&#x5bfc;&#x5192;&#x53f7; (:)\n  req<span class=\"hljs-selector-class\">.param</span>(name)\n  res<span class=\"hljs-selector-class\">.json</span>(obj, status)\n  res<span class=\"hljs-selector-class\">.jsonp</span>(obj, status)\n  res<span class=\"hljs-selector-class\">.send</span>(<span class=\"hljs-selector-tag\">body</span>, status)\n  res<span class=\"hljs-selector-class\">.send</span>(status)\n  res<span class=\"hljs-selector-class\">.sendfile</span>()\n&#x6539;&#x53d8;\n  &#x8def;&#x5f84;&#x8def;&#x7531;&#x5339;&#x914d;&#x8bed;&#x6cd5;\n  &#x4ece;&#x4e2d;&#x95f4;&#x4ef6;&#x548c;&#x5904;&#x7406;&#x7a0b;&#x5e8f;&#x5904;&#x7406;&#x7684;&#x62d2;&#x7edd; promise\n  app<span class=\"hljs-selector-class\">.router</span>\n  req<span class=\"hljs-selector-class\">.host</span>\n  req<span class=\"hljs-selector-class\">.query</span>\n&#x6539;&#x8fdb;\n  res<span class=\"hljs-selector-class\">.render</span>()\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2135,2158"}}],"payload":{"tag":"h4","lines":"2131,2132"}}],"payload":{"tag":"h3","lines":"2129,2130"}}],"payload":{"tag":"h1","lines":"1948,1949"}},{"content":"&#x6570;&#x636e;&#x5e93;&#x96c6;&#x6210;&#x4e2d;&#x82f1;","children":[{"content":"","children":[{"content":"<pre data-lines=\"2163,2179\"><code data-lines=\"2163,2179\">&#x6570;&#x636e;&#x5e93;&#x96c6;&#x6210;\nCassandra\nCouchbase\nCouchDB\nLevelDB\nMySQL\nMongoDB\nNeo4j\nOracle\nPostgreSQL\nRedis\n<span class=\"hljs-keyword\">SQL</span> <span class=\"hljs-keyword\">Server</span>\nSQLite\nElasticsearch\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2163,2179"}},{"content":"<pre data-lines=\"2180,2181\"><code>&#x6dfb;&#x52a0;&#x5c06;&#x6570;&#x636e;&#x5e93;&#x8fde;&#x63a5;&#x5230; Express &#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x7684;&#x529f;&#x80fd;&#x53ea;&#x9700;&#x4e3a;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x4e2d;&#x7684;&#x6570;&#x636e;&#x5e93;&#x52a0;&#x8f7d;&#x9002;&#x5f53;&#x7684; Node.js &#x9a71;&#x52a8;&#x7a0b;&#x5e8f;&#x5373;&#x53ef;&#x3002;&#x672c;&#x6587;&#x6863;&#x7b80;&#x8981;&#x8bf4;&#x660e;&#x4e86;&#x5982;&#x4f55;&#x5728; Express &#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x4e2d;&#x4e3a;&#x6570;&#x636e;&#x5e93;&#x7cfb;&#x7edf;&#x6dfb;&#x52a0;&#x548c;&#x4f7f;&#x7528;&#x4e00;&#x4e9b;&#x6700;&#x6d41;&#x884c;&#x7684; Node.js &#x6a21;&#x5757;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2180,2181"}},{"content":"<pre data-lines=\"2196,2197\"><code>&#x8fd9;&#x4e9b;&#x6570;&#x636e;&#x5e93;&#x9a71;&#x52a8;&#x7a0b;&#x5e8f;&#x662f;&#x8bb8;&#x591a;&#x53ef;&#x7528;&#x7684;&#x9a71;&#x52a8;&#x7a0b;&#x5e8f;&#x4e4b;&#x4e00;&#x3002;&#x5982;&#x9700;&#x5176;&#x4ed6;&#x9009;&#x9879;&#xff0c;&#x8bf7;&#x5728; npm &#x7f51;&#x7ad9;&#x4e0a;&#x641c;&#x7d22;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2196,2197"}}],"payload":{"tag":"h2","lines":"2161,2162"}},{"content":"Cassandra&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"2200,2203\"><code>&#x6a21;&#x5757;&#xff1a;cassandra-driver\n\n&#x5b89;&#x88c5;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2200,2203"}},{"content":"<pre data-lines=\"2204,2207\"><code class=\"language-bash\">&#x24; npm install cassandra-driver\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2204,2207"}},{"content":"<pre data-lines=\"2210,2219\"><code class=\"language-js\"><span class=\"hljs-keyword\">const</span> cassandra = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;cassandra-driver&apos;</span>)\n<span class=\"hljs-keyword\">const</span> client = <span class=\"hljs-keyword\">new</span> cassandra.<span class=\"hljs-title class_\">Client</span>({ <span class=\"hljs-attr\">contactPoints</span>: [<span class=\"hljs-string\">&apos;localhost&apos;</span>] })\n\nclient.<span class=\"hljs-title function_\">execute</span>(<span class=\"hljs-string\">&apos;select key from system.local&apos;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">err, result</span>) =&gt;</span> {\n  <span class=\"hljs-keyword\">if</span> (err) <span class=\"hljs-keyword\">throw</span> err\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(result.<span class=\"hljs-property\">rows</span>[<span class=\"hljs-number\">0</span>])\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2210,2219"}}],"payload":{"tag":"h2","lines":"2198,2199"}},{"content":"Couchbase&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"2222,2225\"><code>&#x6a21;&#x5757;&#xff1a;couchnode\n\n&#x5b89;&#x88c5;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2222,2225"}},{"content":"<pre data-lines=\"2225,2228\"><code class=\"language-bash\">&#x24; npm install couchbase\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2225,2228"}},{"content":"<pre data-lines=\"2229,2253\"><code class=\"language-js\"><span class=\"hljs-keyword\">const</span> couchbase = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;couchbase&apos;</span>)\n<span class=\"hljs-keyword\">const</span> bucket = (<span class=\"hljs-keyword\">new</span> couchbase.<span class=\"hljs-title class_\">Cluster</span>(<span class=\"hljs-string\">&apos;http://localhost:8091&apos;</span>)).<span class=\"hljs-title function_\">openBucket</span>(<span class=\"hljs-string\">&apos;bucketName&apos;</span>)\n\n<span class=\"hljs-comment\">// add a document to a bucket</span>\nbucket.<span class=\"hljs-title function_\">insert</span>(<span class=\"hljs-string\">&apos;document-key&apos;</span>, { <span class=\"hljs-attr\">name</span>: <span class=\"hljs-string\">&apos;Matt&apos;</span>, <span class=\"hljs-attr\">shoeSize</span>: <span class=\"hljs-number\">13</span> }, <span class=\"hljs-function\">(<span class=\"hljs-params\">err, result</span>) =&gt;</span> {\n  <span class=\"hljs-keyword\">if</span> (err) {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(err)\n  } <span class=\"hljs-keyword\">else</span> {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(result)\n  }\n})\n\n<span class=\"hljs-comment\">// get all documents with shoe size 13</span>\n<span class=\"hljs-keyword\">const</span> n1ql = <span class=\"hljs-string\">&apos;SELECT d.* FROM `bucketName` d WHERE shoeSize = &#x24;1&apos;</span>\n<span class=\"hljs-keyword\">const</span> query = N1qlQuery.<span class=\"hljs-title function_\">fromString</span>(n1ql)\nbucket.<span class=\"hljs-title function_\">query</span>(query, [<span class=\"hljs-number\">13</span>], <span class=\"hljs-function\">(<span class=\"hljs-params\">err, result</span>) =&gt;</span> {\n  <span class=\"hljs-keyword\">if</span> (err) {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(err)\n  } <span class=\"hljs-keyword\">else</span> {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(result)\n  }\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2229,2253"}}],"payload":{"tag":"h2","lines":"2220,2221"}},{"content":"CouchDB&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"2256,2259\"><code>&#x6a21;&#x5757;&#xff1a;nano\n\n&#x5b89;&#x88c5;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2256,2259"}},{"content":"<pre data-lines=\"2260,2263\"><code class=\"language-bash\">&#x24; npm install nano\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2260,2263"}},{"content":"<pre data-lines=\"2266,2289\"><code class=\"language-js\"><span class=\"hljs-keyword\">const</span> nano = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;nano&apos;</span>)(<span class=\"hljs-string\">&apos;http://localhost:5984&apos;</span>)\nnano.<span class=\"hljs-property\">db</span>.<span class=\"hljs-title function_\">create</span>(<span class=\"hljs-string\">&apos;books&apos;</span>)\n<span class=\"hljs-keyword\">const</span> books = nano.<span class=\"hljs-property\">db</span>.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-string\">&apos;books&apos;</span>)\n\n<span class=\"hljs-comment\">// Insert a book document in the books database</span>\nbooks.<span class=\"hljs-title function_\">insert</span>({ <span class=\"hljs-attr\">name</span>: <span class=\"hljs-string\">&apos;The Art of war&apos;</span> }, <span class=\"hljs-literal\">null</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">err, body</span>) =&gt;</span> {\n  <span class=\"hljs-keyword\">if</span> (err) {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(err)\n  } <span class=\"hljs-keyword\">else</span> {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(body)\n  }\n})\n\n<span class=\"hljs-comment\">// Get a list of all books</span>\nbooks.<span class=\"hljs-title function_\">list</span>(<span class=\"hljs-function\">(<span class=\"hljs-params\">err, body</span>) =&gt;</span> {\n  <span class=\"hljs-keyword\">if</span> (err) {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(err)\n  } <span class=\"hljs-keyword\">else</span> {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(body.<span class=\"hljs-property\">rows</span>)\n  }\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2266,2289"}}],"payload":{"tag":"h2","lines":"2254,2255"}},{"content":"LevelDB&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"2292,2295\"><code>&#x6a21;&#x5757;&#xff1a;levelup\n\n&#x5b89;&#x88c5;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2292,2295"}},{"content":"<pre data-lines=\"2296,2299\"><code class=\"language-bash\">&#x24; npm install level levelup leveldown\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2296,2299"}},{"content":"<pre data-lines=\"2302,2316\"><code class=\"language-js\"><span class=\"hljs-keyword\">const</span> levelup = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;levelup&apos;</span>)\n<span class=\"hljs-keyword\">const</span> db = <span class=\"hljs-title function_\">levelup</span>(<span class=\"hljs-string\">&apos;./mydb&apos;</span>)\n\ndb.<span class=\"hljs-title function_\">put</span>(<span class=\"hljs-string\">&apos;name&apos;</span>, <span class=\"hljs-string\">&apos;LevelUP&apos;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">err</span>) =&gt;</span> {\n  <span class=\"hljs-keyword\">if</span> (err) <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;Ooops!&apos;</span>, err)\n\n  db.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;name&apos;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">err, value</span>) =&gt;</span> {\n    <span class=\"hljs-keyword\">if</span> (err) <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;Ooops!&apos;</span>, err)\n\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">`name=<span class=\"hljs-subst\">&#x24;{value}</span>`</span>)\n  })\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2302,2316"}}],"payload":{"tag":"h2","lines":"2290,2291"}},{"content":"MySQL&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"2319,2322\"><code>&#x6a21;&#x5757;&#xff1a;mysql\n\n&#x5b89;&#x88c5;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2319,2322"}},{"content":"<pre data-lines=\"2323,2326\"><code class=\"language-bash\">&#x24; npm install mysql\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2323,2326"}},{"content":"<pre data-lines=\"2329,2348\"><code class=\"language-js\"><span class=\"hljs-keyword\">const</span> mysql = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;mysql&apos;</span>)\n<span class=\"hljs-keyword\">const</span> connection = mysql.<span class=\"hljs-title function_\">createConnection</span>({\n  <span class=\"hljs-attr\">host</span>: <span class=\"hljs-string\">&apos;localhost&apos;</span>,\n  <span class=\"hljs-attr\">user</span>: <span class=\"hljs-string\">&apos;dbuser&apos;</span>,\n  <span class=\"hljs-attr\">password</span>: <span class=\"hljs-string\">&apos;s3kreee7&apos;</span>,\n  <span class=\"hljs-attr\">database</span>: <span class=\"hljs-string\">&apos;my_db&apos;</span>\n})\n\nconnection.<span class=\"hljs-title function_\">connect</span>()\n\nconnection.<span class=\"hljs-title function_\">query</span>(<span class=\"hljs-string\">&apos;SELECT 1 + 1 AS solution&apos;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">err, rows, fields</span>) =&gt;</span> {\n  <span class=\"hljs-keyword\">if</span> (err) <span class=\"hljs-keyword\">throw</span> err\n\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;The solution is: &apos;</span>, rows[<span class=\"hljs-number\">0</span>].<span class=\"hljs-property\">solution</span>)\n})\n\nconnection.<span class=\"hljs-title function_\">end</span>()\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2329,2348"}}],"payload":{"tag":"h2","lines":"2317,2318"}},{"content":"MongoDB&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"2351,2354\"><code>&#x6a21;&#x5757;&#xff1a;mongodb\n\n&#x5b89;&#x88c5;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2351,2354"}},{"content":"<pre data-lines=\"2355,2358\"><code class=\"language-bash\">&#x24; npm install mongodb\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2355,2358"}},{"content":"<pre data-lines=\"2361,2374\"><code class=\"language-js\"><span class=\"hljs-keyword\">const</span> <span class=\"hljs-title class_\">MongoClient</span> = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;mongodb&apos;</span>).<span class=\"hljs-property\">MongoClient</span>\n\n<span class=\"hljs-title class_\">MongoClient</span>.<span class=\"hljs-title function_\">connect</span>(<span class=\"hljs-string\">&apos;mongodb://localhost:27017/animals&apos;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">err, db</span>) =&gt;</span> {\n  <span class=\"hljs-keyword\">if</span> (err) <span class=\"hljs-keyword\">throw</span> err\n\n  db.<span class=\"hljs-title function_\">collection</span>(<span class=\"hljs-string\">&apos;mammals&apos;</span>).<span class=\"hljs-title function_\">find</span>().<span class=\"hljs-title function_\">toArray</span>(<span class=\"hljs-function\">(<span class=\"hljs-params\">err, result</span>) =&gt;</span> {\n    <span class=\"hljs-keyword\">if</span> (err) <span class=\"hljs-keyword\">throw</span> err\n\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(result)\n  })\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2361,2374"}},{"content":"<pre data-lines=\"2377,2392\"><code class=\"language-js\"><span class=\"hljs-keyword\">const</span> <span class=\"hljs-title class_\">MongoClient</span> = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;mongodb&apos;</span>).<span class=\"hljs-property\">MongoClient</span>\n\n<span class=\"hljs-title class_\">MongoClient</span>.<span class=\"hljs-title function_\">connect</span>(<span class=\"hljs-string\">&apos;mongodb://localhost:27017/animals&apos;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">err, client</span>) =&gt;</span> {\n  <span class=\"hljs-keyword\">if</span> (err) <span class=\"hljs-keyword\">throw</span> err\n\n  <span class=\"hljs-keyword\">const</span> db = client.<span class=\"hljs-title function_\">db</span>(<span class=\"hljs-string\">&apos;animals&apos;</span>)\n\n  db.<span class=\"hljs-title function_\">collection</span>(<span class=\"hljs-string\">&apos;mammals&apos;</span>).<span class=\"hljs-title function_\">find</span>().<span class=\"hljs-title function_\">toArray</span>(<span class=\"hljs-function\">(<span class=\"hljs-params\">err, result</span>) =&gt;</span> {\n    <span class=\"hljs-keyword\">if</span> (err) <span class=\"hljs-keyword\">throw</span> err\n\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(result)\n  })\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2377,2392"}}],"payload":{"tag":"h2","lines":"2349,2350"}},{"content":"Neo4j&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"2395,2398\"><code>&#x6a21;&#x5757;&#xff1a;neo4j-driver\n\n&#x5b89;&#x88c5;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2395,2398"}},{"content":"<pre data-lines=\"2399,2402\"><code class=\"language-bash\">&#x24; npm install neo4j-driver\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2399,2402"}},{"content":"<pre data-lines=\"2405,2421\"><code class=\"language-js\"><span class=\"hljs-keyword\">const</span> neo4j = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;neo4j-driver&apos;</span>)\n<span class=\"hljs-keyword\">const</span> driver = neo4j.<span class=\"hljs-title function_\">driver</span>(<span class=\"hljs-string\">&apos;neo4j://localhost:7687&apos;</span>, neo4j.<span class=\"hljs-property\">auth</span>.<span class=\"hljs-title function_\">basic</span>(<span class=\"hljs-string\">&apos;neo4j&apos;</span>, <span class=\"hljs-string\">&apos;letmein&apos;</span>))\n\n<span class=\"hljs-keyword\">const</span> session = driver.<span class=\"hljs-title function_\">session</span>()\n\nsession.<span class=\"hljs-title function_\">readTransaction</span>(<span class=\"hljs-function\">(<span class=\"hljs-params\">tx</span>) =&gt;</span> {\n  <span class=\"hljs-keyword\">return</span> tx.<span class=\"hljs-title function_\">run</span>(<span class=\"hljs-string\">&apos;MATCH (n) RETURN count(n) AS count&apos;</span>)\n    .<span class=\"hljs-title function_\">then</span>(<span class=\"hljs-function\">(<span class=\"hljs-params\">res</span>) =&gt;</span> {\n      <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(res.<span class=\"hljs-property\">records</span>[<span class=\"hljs-number\">0</span>].<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;count&apos;</span>))\n    })\n    .<span class=\"hljs-title function_\">catch</span>(<span class=\"hljs-function\">(<span class=\"hljs-params\">error</span>) =&gt;</span> {\n      <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(error)\n    })\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2405,2421"}}],"payload":{"tag":"h2","lines":"2393,2394"}},{"content":"Oracle&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"2424,2428\"><code>&#x6a21;&#x5757;&#xff1a;oracledb\n\n&#x5b89;&#x88c5;&#x4e2d;&#x82f1;\n&#x6ce8;&#xff1a;&#x67e5;&#x770b;&#x5b89;&#x88c5;&#x5148;&#x51b3;&#x6761;&#x4ef6;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2424,2428"}},{"content":"<pre data-lines=\"2429,2432\"><code class=\"language-bash\">&#x24; npm install oracledb\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2429,2432"}},{"content":"<pre data-lines=\"2435,2466\"><code class=\"language-js\"><span class=\"hljs-keyword\">const</span> oracledb = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;oracledb&apos;</span>)\n<span class=\"hljs-keyword\">const</span> config = {\n  <span class=\"hljs-attr\">user</span>: <span class=\"hljs-string\">&apos;&lt;your db user&gt;&apos;</span>,\n  <span class=\"hljs-attr\">password</span>: <span class=\"hljs-string\">&apos;&lt;your db password&gt;&apos;</span>,\n  <span class=\"hljs-attr\">connectString</span>: <span class=\"hljs-string\">&apos;localhost:1521/orcl&apos;</span>\n}\n\n<span class=\"hljs-keyword\">async</span> <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">getEmployee</span> (<span class=\"hljs-params\">empId</span>) {\n  <span class=\"hljs-keyword\">let</span> conn\n\n  <span class=\"hljs-keyword\">try</span> {\n    conn = <span class=\"hljs-keyword\">await</span> oracledb.<span class=\"hljs-title function_\">getConnection</span>(config)\n\n    <span class=\"hljs-keyword\">const</span> result = <span class=\"hljs-keyword\">await</span> conn.<span class=\"hljs-title function_\">execute</span>(\n      <span class=\"hljs-string\">&apos;select * from employees where employee_id = :id&apos;</span>,\n      [empId]\n    )\n\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(result.<span class=\"hljs-property\">rows</span>[<span class=\"hljs-number\">0</span>])\n  } <span class=\"hljs-keyword\">catch</span> (err) {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;Ouch!&apos;</span>, err)\n  } <span class=\"hljs-keyword\">finally</span> {\n    <span class=\"hljs-keyword\">if</span> (conn) { <span class=\"hljs-comment\">// conn assignment worked, need to close</span>\n      <span class=\"hljs-keyword\">await</span> conn.<span class=\"hljs-title function_\">close</span>()\n    }\n  }\n}\n\n<span class=\"hljs-title function_\">getEmployee</span>(<span class=\"hljs-number\">101</span>)\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2435,2466"}}],"payload":{"tag":"h2","lines":"2422,2423"}},{"content":"PostgreSQL&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"2469,2472\"><code>&#x6a21;&#x5757;&#xff1a;pg-promise\n\n&#x5b89;&#x88c5;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2469,2472"}},{"content":"<pre data-lines=\"2473,2476\"><code class=\"language-bash\">&#x24; npm install pg-promise\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2473,2476"}},{"content":"<pre data-lines=\"2479,2491\"><code class=\"language-js\"><span class=\"hljs-keyword\">const</span> pgp = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;pg-promise&apos;</span>)(<span class=\"hljs-comment\">/* options */</span>)\n<span class=\"hljs-keyword\">const</span> db = <span class=\"hljs-title function_\">pgp</span>(<span class=\"hljs-string\">&apos;postgres://username:password@host:port/database&apos;</span>)\n\ndb.<span class=\"hljs-title function_\">one</span>(<span class=\"hljs-string\">&apos;SELECT &#x24;1 AS value&apos;</span>, <span class=\"hljs-number\">123</span>)\n  .<span class=\"hljs-title function_\">then</span>(<span class=\"hljs-function\">(<span class=\"hljs-params\">data</span>) =&gt;</span> {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;DATA:&apos;</span>, data.<span class=\"hljs-property\">value</span>)\n  })\n  .<span class=\"hljs-title function_\">catch</span>(<span class=\"hljs-function\">(<span class=\"hljs-params\">error</span>) =&gt;</span> {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;ERROR:&apos;</span>, error)\n  })\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2479,2491"}}],"payload":{"tag":"h2","lines":"2467,2468"}},{"content":"Redis&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"2494,2497\"><code>&#x6a21;&#x5757;&#xff1a;redis\n\n&#x5b89;&#x88c5;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2494,2497"}},{"content":"<pre data-lines=\"2498,2501\"><code class=\"language-bash\">&#x24; npm install redis\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2498,2501"}},{"content":"<pre data-lines=\"2504,2526\"><code class=\"language-js\"><span class=\"hljs-keyword\">const</span> redis = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;redis&apos;</span>)\n<span class=\"hljs-keyword\">const</span> client = redis.<span class=\"hljs-title function_\">createClient</span>()\n\nclient.<span class=\"hljs-title function_\">on</span>(<span class=\"hljs-string\">&apos;error&apos;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">err</span>) =&gt;</span> {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">`Error <span class=\"hljs-subst\">&#x24;{err}</span>`</span>)\n})\n\nclient.<span class=\"hljs-title function_\">set</span>(<span class=\"hljs-string\">&apos;string key&apos;</span>, <span class=\"hljs-string\">&apos;string val&apos;</span>, redis.<span class=\"hljs-property\">print</span>)\nclient.<span class=\"hljs-title function_\">hset</span>(<span class=\"hljs-string\">&apos;hash key&apos;</span>, <span class=\"hljs-string\">&apos;hashtest 1&apos;</span>, <span class=\"hljs-string\">&apos;some value&apos;</span>, redis.<span class=\"hljs-property\">print</span>)\nclient.<span class=\"hljs-title function_\">hset</span>([<span class=\"hljs-string\">&apos;hash key&apos;</span>, <span class=\"hljs-string\">&apos;hashtest 2&apos;</span>, <span class=\"hljs-string\">&apos;some other value&apos;</span>], redis.<span class=\"hljs-property\">print</span>)\n\nclient.<span class=\"hljs-title function_\">hkeys</span>(<span class=\"hljs-string\">&apos;hash key&apos;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">err, replies</span>) =&gt;</span> {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">`<span class=\"hljs-subst\">&#x24;{replies.length}</span> replies:`</span>)\n\n  replies.<span class=\"hljs-title function_\">forEach</span>(<span class=\"hljs-function\">(<span class=\"hljs-params\">reply, i</span>) =&gt;</span> {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">`    <span class=\"hljs-subst\">&#x24;{i}</span>: <span class=\"hljs-subst\">&#x24;{reply}</span>`</span>)\n  })\n\n  client.<span class=\"hljs-title function_\">quit</span>()\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2504,2526"}}],"payload":{"tag":"h2","lines":"2492,2493"}},{"content":"SQL Server&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"2529,2532\"><code>&#x6a21;&#x5757;&#xff1a;tedious\n\n&#x5b89;&#x88c5;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2529,2532"}},{"content":"<pre data-lines=\"2533,2536\"><code class=\"language-bash\">&#x24; npm install tedious\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2533,2536"}},{"content":"<pre data-lines=\"2539,2587\"><code class=\"language-js\"><span class=\"hljs-keyword\">const</span> <span class=\"hljs-title class_\">Connection</span> = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;tedious&apos;</span>).<span class=\"hljs-property\">Connection</span>\n<span class=\"hljs-keyword\">const</span> <span class=\"hljs-title class_\">Request</span> = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;tedious&apos;</span>).<span class=\"hljs-property\">Request</span>\n\n<span class=\"hljs-keyword\">const</span> config = {\n  <span class=\"hljs-attr\">server</span>: <span class=\"hljs-string\">&apos;localhost&apos;</span>,\n  <span class=\"hljs-attr\">authentication</span>: {\n    <span class=\"hljs-attr\">type</span>: <span class=\"hljs-string\">&apos;default&apos;</span>,\n    <span class=\"hljs-attr\">options</span>: {\n      <span class=\"hljs-attr\">userName</span>: <span class=\"hljs-string\">&apos;your_username&apos;</span>, <span class=\"hljs-comment\">// update me</span>\n      <span class=\"hljs-attr\">password</span>: <span class=\"hljs-string\">&apos;your_password&apos;</span> <span class=\"hljs-comment\">// update me</span>\n    }\n  }\n}\n\n<span class=\"hljs-keyword\">const</span> connection = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Connection</span>(config)\n\nconnection.<span class=\"hljs-title function_\">on</span>(<span class=\"hljs-string\">&apos;connect&apos;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">err</span>) =&gt;</span> {\n  <span class=\"hljs-keyword\">if</span> (err) {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(err)\n  } <span class=\"hljs-keyword\">else</span> {\n    <span class=\"hljs-title function_\">executeStatement</span>()\n  }\n})\n\n<span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">executeStatement</span> (<span class=\"hljs-params\"></span>) {\n  request = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Request</span>(<span class=\"hljs-string\">&quot;select 123, &apos;hello world&apos;&quot;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">err, rowCount</span>) =&gt;</span> {\n    <span class=\"hljs-keyword\">if</span> (err) {\n      <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(err)\n    } <span class=\"hljs-keyword\">else</span> {\n      <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">`<span class=\"hljs-subst\">&#x24;{rowCount}</span> rows`</span>)\n    }\n    connection.<span class=\"hljs-title function_\">close</span>()\n  })\n\n  request.<span class=\"hljs-title function_\">on</span>(<span class=\"hljs-string\">&apos;row&apos;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">columns</span>) =&gt;</span> {\n    columns.<span class=\"hljs-title function_\">forEach</span>(<span class=\"hljs-function\">(<span class=\"hljs-params\">column</span>) =&gt;</span> {\n      <span class=\"hljs-keyword\">if</span> (column.<span class=\"hljs-property\">value</span> === <span class=\"hljs-literal\">null</span>) {\n        <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;NULL&apos;</span>)\n      } <span class=\"hljs-keyword\">else</span> {\n        <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(column.<span class=\"hljs-property\">value</span>)\n      }\n    })\n  })\n\n  connection.<span class=\"hljs-title function_\">execSql</span>(request)\n}\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2539,2587"}}],"payload":{"tag":"h2","lines":"2527,2528"}},{"content":"SQLite&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"2590,2593\"><code>&#x6a21;&#x5757;&#xff1a;sqlite3\n\n&#x5b89;&#x88c5;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2590,2593"}},{"content":"<pre data-lines=\"2594,2597\"><code class=\"language-bash\">&#x24; npm install sqlite3\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2594,2597"}},{"content":"<pre data-lines=\"2600,2621\"><code class=\"language-js\"><span class=\"hljs-keyword\">const</span> sqlite3 = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;sqlite3&apos;</span>).<span class=\"hljs-title function_\">verbose</span>()\n<span class=\"hljs-keyword\">const</span> db = <span class=\"hljs-keyword\">new</span> sqlite3.<span class=\"hljs-title class_\">Database</span>(<span class=\"hljs-string\">&apos;:memory:&apos;</span>)\n\ndb.<span class=\"hljs-title function_\">serialize</span>(<span class=\"hljs-function\">() =&gt;</span> {\n  db.<span class=\"hljs-title function_\">run</span>(<span class=\"hljs-string\">&apos;CREATE TABLE lorem (info TEXT)&apos;</span>)\n  <span class=\"hljs-keyword\">const</span> stmt = db.<span class=\"hljs-title function_\">prepare</span>(<span class=\"hljs-string\">&apos;INSERT INTO lorem VALUES (?)&apos;</span>)\n\n  <span class=\"hljs-keyword\">for</span> (<span class=\"hljs-keyword\">let</span> i = <span class=\"hljs-number\">0</span>; i &lt; <span class=\"hljs-number\">10</span>; i++) {\n    stmt.<span class=\"hljs-title function_\">run</span>(<span class=\"hljs-string\">`Ipsum <span class=\"hljs-subst\">&#x24;{i}</span>`</span>)\n  }\n\n  stmt.<span class=\"hljs-title function_\">finalize</span>()\n\n  db.<span class=\"hljs-title function_\">each</span>(<span class=\"hljs-string\">&apos;SELECT rowid AS id, info FROM lorem&apos;</span>, <span class=\"hljs-function\">(<span class=\"hljs-params\">err, row</span>) =&gt;</span> {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">`<span class=\"hljs-subst\">&#x24;{row.id}</span>: <span class=\"hljs-subst\">&#x24;{row.info}</span>`</span>)\n  })\n})\n\ndb.<span class=\"hljs-title function_\">close</span>()\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2600,2621"}}],"payload":{"tag":"h2","lines":"2588,2589"}},{"content":"Elasticsearch&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"2624,2627\"><code>&#x6a21;&#x5757;&#xff1a;elasticsearch\n\n&#x5b89;&#x88c5;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2624,2627"}},{"content":"<pre data-lines=\"2628,2631\"><code class=\"language-bash\">&#x24; npm install elasticsearch\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2628,2631"}},{"content":"<pre data-lines=\"2634,2657\"><code class=\"language-js\"><span class=\"hljs-keyword\">const</span> elasticsearch = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;elasticsearch&apos;</span>)\n<span class=\"hljs-keyword\">const</span> client = elasticsearch.<span class=\"hljs-title class_\">Client</span>({\n  <span class=\"hljs-attr\">host</span>: <span class=\"hljs-string\">&apos;localhost:9200&apos;</span>\n})\n\nclient.<span class=\"hljs-title function_\">search</span>({\n  <span class=\"hljs-attr\">index</span>: <span class=\"hljs-string\">&apos;books&apos;</span>,\n  <span class=\"hljs-attr\">type</span>: <span class=\"hljs-string\">&apos;book&apos;</span>,\n  <span class=\"hljs-attr\">body</span>: {\n    <span class=\"hljs-attr\">query</span>: {\n      <span class=\"hljs-attr\">multi_match</span>: {\n        <span class=\"hljs-attr\">query</span>: <span class=\"hljs-string\">&apos;express js&apos;</span>,\n        <span class=\"hljs-attr\">fields</span>: [<span class=\"hljs-string\">&apos;title&apos;</span>, <span class=\"hljs-string\">&apos;description&apos;</span>]\n      }\n    }\n  }\n}).<span class=\"hljs-title function_\">then</span>(<span class=\"hljs-function\">(<span class=\"hljs-params\">response</span>) =&gt;</span> {\n  <span class=\"hljs-keyword\">const</span> hits = response.<span class=\"hljs-property\">hits</span>.<span class=\"hljs-property\">hits</span>\n}, <span class=\"hljs-function\">(<span class=\"hljs-params\">error</span>) =&gt;</span> {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">trace</span>(error.<span class=\"hljs-property\">message</span>)\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2634,2657"}},{"content":"<pre data-lines=\"2658,2674\"><code data-lines=\"2658,2674\">&#x6570;&#x636e;&#x5e93;&#x96c6;&#x6210;\nCassandra\nCouchbase\nCouchDB\nLevelDB\nMySQL\nMongoDB\nNeo4j\nOracle\nPostgreSQL\nRedis\n<span class=\"hljs-keyword\">SQL</span> <span class=\"hljs-keyword\">Server</span>\nSQLite\nElasticsearch\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2658,2674"}}],"payload":{"tag":"h2","lines":"2622,2623"}}],"payload":{"tag":"h1","lines":"2159,2160"}}]},{})</script>
</body>
</html>
