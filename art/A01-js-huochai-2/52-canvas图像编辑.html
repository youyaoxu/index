<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>
<link rel="stylesheet" href="https://unpkg.com/markmap-toolbar@0.18.10/dist/style.css"><link rel="stylesheet" href="https://unpkg.com/@highlightjs/cdn-assets@11.11.1/styles/default.min.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://unpkg.com/d3@7.9.0/dist/d3.min.js"></script><script src="https://unpkg.com/markmap-view@0.18.10/dist/browser/index.js"></script><script src="https://unpkg.com/markmap-toolbar@0.18.10/dist/index.js"></script><script>(r => {
              setTimeout(r);
            })(function renderToolbar() {
  const {
    markmap,
    mm
  } = window;
  const {
    el
  } = markmap.Toolbar.create(mm);
  el.setAttribute('style', 'position:absolute;bottom:20px;right:20px');
  document.body.append(el);
})</script><script>((getMarkmap, getOptions, root2, jsonOptions) => {
              const markmap = getMarkmap();
              window.mm = markmap.Markmap.create(
                "svg#mindmap",
                (getOptions || markmap.deriveOptions)(jsonOptions),
                root2
              );
            })(() => window.markmap,null,{"content":"<a href=\"https://www.cnblogs.com/xiaohuochai/p/7442290.html\">&#x4f7f;&#x7528;canvas&#x8fdb;&#x884c;&#x56fe;&#x50cf;&#x7f16;&#x8f91;</a><img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAAoklEQVQ4T+2T4Q2CMBCFv27CBjgCG+gIjAAbOAIjOIJs4Ai6gRvIBpjXXCOp19T/8pJLoTneXcj3Ah91wAV4bu68xwXoAZ2EzEAmE9AWTB6AelRDyaAx9zgh0wE4ATczcTdIE7wl0oe7wX/8RMHigfQTB3fDdM1IEvYyONdIVEOSqDwCY2Z2NaS/UNbqMSQmvauUPlfbNKpBSdTUVyXSs/XyBlRCNBG20I28AAAAAElFTkSuQmCC\" alt=\"img\">","children":[{"content":"&#x524d;&#x9762;&#x7684;&#x8bdd;","children":[{"content":"<pre data-lines=\"4,5\"><code>&#x3000;&#x3000;&#x672c;&#x6587;&#x5c06;&#x5206;&#x4e3a;&#x51e0;&#x4e2a;&#x5c0f;&#x529f;&#x80fd;&#x7684;&#x5f62;&#x5f0f;&#x6765;&#x8be6;&#x7ec6;&#x4ecb;&#x7ecd;canvas&#x56fe;&#x50cf;&#x7f16;&#x8f91;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"4,5"}}],"payload":{"tag":"h3","lines":"2,3"}},{"content":"&#x7f29;&#x653e;","children":[{"content":"<pre data-lines=\"10,11\"><code>&#x3000;&#x3000;&#x4e0b;&#x9762;&#x662f;&#x4e00;&#x5f20;&#x5206;&#x6790;&#x56fe;&#xff0c;&#x5047;&#x8bbe;&#x9ed8;&#x8ba4;&#x60c5;&#x51b5;&#x4e0b;&#xff0c;&#x56fe;&#x7247;&#x548c;canvas&#x5bbd;&#x9ad8;&#x76f8;&#x540c;&#x3002;&#x56fe;&#x7247;&#x7684;&#x7f29;&#x653e;(scale)&#x8303;&#x56f4;&#x4e3a;0.5&#x5230;3&#xff0c;&#x7f29;&#x653e;&#x65f6;&#x6539;&#x53d8;&#x7684;&#x662f;&#x56fe;&#x7247;&#x7684;&#x5927;&#x5c0f;&#x548c;&#x56fe;&#x7247;&#x7684;&#x5750;&#x6807;&#x4f4d;&#x7f6e;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"10,11"}},{"content":"<pre data-lines=\"12,18\"><code data-lines=\"12,18\">W(&#x5bbd;) <span class=\"hljs-operator\">=</span> canvas.width * scale\nH(&#x9ad8;) <span class=\"hljs-operator\">=</span> canvas.height * scale\nx&#x5750;&#x6807; <span class=\"hljs-operator\">=</span> (W - canvas.width)/<span class=\"hljs-number\">2</span><span class=\"hljs-comment\">;</span>\ny&#x5750;&#x6807; <span class=\"hljs-operator\">=</span> (H - canvas.height)/<span class=\"hljs-number\">2</span><span class=\"hljs-comment\">;</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"12,18"}},{"content":"<img src=\"https://images2017.cnblogs.com/blog/740839/201708/740839-20170828071311874-1568389509.png\" alt=\"img\">","children":[],"payload":{"tag":"img","lines":"19,20"}},{"content":"<pre data-lines=\"21,22\"><code>&#x3000;&#x3000;&#x56e0;&#x6b64;&#xff0c;&#x4ee3;&#x7801;&#x5982;&#x4e0b;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"21,22"}},{"content":"<pre data-lines=\"25,59\"><code data-lines=\"25,59\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">canvas</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">&quot;drawing&quot;</span> <span class=\"hljs-attr\">style</span>=<span class=\"hljs-string\">&quot;border:1px solid black&quot;</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">p</span>&gt;</span>The canvas element is not supported!<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">p</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">canvas</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">br</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">input</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">&quot;scale-range&quot;</span> <span class=\"hljs-attr\">min</span>=<span class=\"hljs-string\">&quot;0.5&quot;</span> <span class=\"hljs-attr\">max</span>=<span class=\"hljs-string\">&quot;1.5&quot;</span> <span class=\"hljs-attr\">step</span>=<span class=\"hljs-string\">&quot;0.01&quot;</span> <span class=\"hljs-attr\">type</span>=<span class=\"hljs-string\">&quot;range&quot;</span> <span class=\"hljs-attr\">style</span>=<span class=\"hljs-string\">&quot;width:300px;&quot;</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">script</span>&gt;</span><span class=\"language-javascript\">\n<span class=\"hljs-keyword\">var</span> drawing = <span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-title function_\">getElementById</span>(<span class=\"hljs-string\">&apos;drawing&apos;</span>);\n<span class=\"hljs-keyword\">if</span>(drawing.<span class=\"hljs-property\">getContext</span>){\n  <span class=\"hljs-keyword\">var</span> context = drawing.<span class=\"hljs-title function_\">getContext</span>(<span class=\"hljs-string\">&apos;2d&apos;</span>);\n  <span class=\"hljs-keyword\">var</span> slider = <span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-title function_\">getElementById</span>(<span class=\"hljs-string\">&apos;scale-range&apos;</span>);\n  <span class=\"hljs-keyword\">var</span> W = <span class=\"hljs-number\">400</span>;\n  <span class=\"hljs-keyword\">var</span> H = <span class=\"hljs-number\">290</span>;  \n  drawing.<span class=\"hljs-property\">width</span> = W;  \n  drawing.<span class=\"hljs-property\">height</span> = H;\n  <span class=\"hljs-keyword\">var</span> image = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Image</span>();\n  image.<span class=\"hljs-property\">src</span>=<span class=\"hljs-string\">&quot;http://sandbox.runjs.cn/uploads/rs/26/ddzmgynp/chunfen.jpg&quot;</span>;\n  image.<span class=\"hljs-property\">onload</span> = <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>){\n    <span class=\"hljs-title function_\">drawImgByScale</span>(slider.<span class=\"hljs-property\">value</span>);\n    slider.<span class=\"hljs-property\">onmousemove</span> = <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>){\n      <span class=\"hljs-title function_\">drawImgByScale</span>(slider.<span class=\"hljs-property\">value</span>);\n    }\n  }\n  <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">drawImgByScale</span>(<span class=\"hljs-params\">scale</span>){\n    <span class=\"hljs-keyword\">var</span> imgW = W * scale;\n    <span class=\"hljs-keyword\">var</span> imgH = H * scale;\n    <span class=\"hljs-keyword\">var</span> dx =(W - imgW)/<span class=\"hljs-number\">2</span>;\n    <span class=\"hljs-keyword\">var</span> dy =(H - imgH)/<span class=\"hljs-number\">2</span>;\n    context.<span class=\"hljs-title function_\">clearRect</span>(<span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">0</span>,W,H);\n    context.<span class=\"hljs-title function_\">drawImage</span>(image,dx,dy,imgW,imgH);\n  }\n} \n</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">script</span>&gt;</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"25,59"}}],"payload":{"tag":"h3","lines":"8,9"}},{"content":"&#x6c34;&#x5370;","children":[{"content":"<pre data-lines=\"68,69\"><code>&#x3000;&#x3000;&#x5229;&#x7528;canvas&#x53ef;&#x4ee5;&#x5b9e;&#x73b0;&#x5411;&#x56fe;&#x7247;&#x6dfb;&#x52a0;&#x6c34;&#x5370;&#x7684;&#x529f;&#x80fd;&#xff0c;&#x5148;&#x901a;&#x8fc7;[file&#x63a7;&#x4ef6;](http://www.cnblogs.com/xiaohuochai/p/6543019.html)&#x7684;reader&#x9009;&#x62e9;&#x56fe;&#x7247;&#xff0c;&#x7136;&#x540e;&#x4f7f;&#x7528;canvas&#x6dfb;&#x52a0;&#x56fe;&#x7247;&#x53ca;&#x6c34;&#x5370;&#xff0c;&#x5e76;&#x4e14;&#x4f7f;&#x7528;toDataURL()&#x548c;[a&#x6807;&#x7b7e;](http://www.cnblogs.com/xiaohuochai/p/5007282.html)&#x5b9e;&#x73b0;&#x6dfb;&#x52a0;&#x6c34;&#x5370;&#x540e;&#x7684;&#x56fe;&#x7247;&#x7684;&#x4e0b;&#x8f7d;&#x529f;&#x80fd;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"68,69"}},{"content":"<pre data-lines=\"72,136\"><code data-lines=\"72,136\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">canvas</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">&quot;drawing&quot;</span> <span class=\"hljs-attr\">style</span>=<span class=\"hljs-string\">&quot;width:300px;border:1px solid black&quot;</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">p</span>&gt;</span>The canvas element is not supported!<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">p</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">canvas</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span>&gt;</span>\n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">span</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">input</span> <span class=\"hljs-attr\">type</span>=<span class=\"hljs-string\">&quot;file&quot;</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">&quot;addImgHelper&quot;</span> <span class=\"hljs-attr\">style</span>=<span class=\"hljs-string\">&quot;display:none&quot;</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">button</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">&quot;addImg&quot;</span>&gt;</span>&#x9009;&#x62e9;&#x56fe;&#x7247;<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">button</span>&gt;</span>\n  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">span</span>&gt;</span>\n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">span</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">button</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">&quot;addWaterMark&quot;</span> <span class=\"hljs-attr\">disabled</span>&gt;</span>&#x6dfb;&#x52a0;&#x6c34;&#x5370;<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">button</span>&gt;</span>  \n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">span</span>&gt;</span>&#x6c34;&#x5370;&#x6587;&#x5b57;&#x4e3a;<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">span</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">input</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">&quot;waterMarkWords&quot;</span> <span class=\"hljs-attr\">type</span>=<span class=\"hljs-string\">&quot;text&quot;</span> <span class=\"hljs-attr\">value</span>=<span class=\"hljs-string\">&quot;&#x5c0f;&#x706b;&#x67f4;&#x7684;&#x84dd;&#x8272;&#x7406;&#x60f3;&quot;</span>&gt;</span>      \n  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">span</span>&gt;</span>\n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">span</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">button</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">&quot;downloadImg&quot;</span> <span class=\"hljs-attr\">disabled</span>&gt;</span>&#x4e0b;&#x8f7d;&#x56fe;&#x7247;<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">button</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">a</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">&quot;downloadImgHelper&quot;</span> <span class=\"hljs-attr\">href</span>=<span class=\"hljs-string\">&quot;#&quot;</span> <span class=\"hljs-attr\">download</span>=<span class=\"hljs-string\">&quot;&#x5e26;&#x6c34;&#x5370;&#x56fe;&#x7247;&quot;</span> <span class=\"hljs-attr\">style</span>=<span class=\"hljs-string\">&quot;display:none&quot;</span>&gt;</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">a</span>&gt;</span>   \n  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">span</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">script</span>&gt;</span><span class=\"language-javascript\">\n<span class=\"hljs-keyword\">if</span>(drawing.<span class=\"hljs-property\">getContext</span>){\n  <span class=\"hljs-keyword\">var</span> cxt = drawing.<span class=\"hljs-title function_\">getContext</span>(<span class=\"hljs-string\">&apos;2d&apos;</span>);\n  <span class=\"hljs-keyword\">var</span> W,H;  \n  addImg.<span class=\"hljs-property\">onclick</span> = <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>){\n    addImgHelper.<span class=\"hljs-title function_\">click</span>();\n  }\n  addImgHelper.<span class=\"hljs-property\">onchange</span> = <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>){\n    addWaterMark.<span class=\"hljs-property\">disabled</span> = <span class=\"hljs-literal\">true</span>;\n    downloadImg.<span class=\"hljs-property\">disabled</span> = <span class=\"hljs-literal\">true</span>;\n    <span class=\"hljs-keyword\">var</span> file = addImgHelper.<span class=\"hljs-property\">files</span>[<span class=\"hljs-number\">0</span>];\n    <span class=\"hljs-keyword\">if</span>(file &amp;&amp; <span class=\"hljs-regexp\">/image/</span>.<span class=\"hljs-title function_\">test</span>(file.<span class=\"hljs-property\">type</span>)){\n      <span class=\"hljs-keyword\">var</span> reader = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">FileReader</span>();\n      reader.<span class=\"hljs-title function_\">readAsDataURL</span>(file);\n      reader.<span class=\"hljs-property\">onload</span> = <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>){\n        <span class=\"hljs-keyword\">var</span> img = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Image</span>();\n        img.<span class=\"hljs-property\">src</span>= reader.<span class=\"hljs-property\">result</span>;\n        img.<span class=\"hljs-property\">onload</span> = <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>){\n          addWaterMark.<span class=\"hljs-property\">disabled</span> = <span class=\"hljs-literal\">false</span>;\n          drawing.<span class=\"hljs-property\">width</span> = W = img.<span class=\"hljs-property\">width</span>;\n          drawing.<span class=\"hljs-property\">height</span> = H = img.<span class=\"hljs-property\">height</span>;\n          cxt.<span class=\"hljs-title function_\">drawImage</span>(img,<span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">0</span>);\n          addWaterMark.<span class=\"hljs-property\">onclick</span> = <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>){\n              downloadImg.<span class=\"hljs-property\">disabled</span> = <span class=\"hljs-literal\">false</span>;\n              cxt.<span class=\"hljs-title function_\">clearRect</span>(<span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">0</span>,W,H);\n              cxt.<span class=\"hljs-title function_\">drawImage</span>(img,<span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">0</span>);    \n              <span class=\"hljs-keyword\">var</span> str = waterMarkWords.<span class=\"hljs-property\">value</span>;\n              cxt.<span class=\"hljs-property\">font</span> = <span class=\"hljs-string\">&quot;bold 50px Arial&quot;</span>;\n              cxt.<span class=\"hljs-property\">lineWidth</span> = <span class=\"hljs-string\">&apos;1&apos;</span>;\n              cxt.<span class=\"hljs-property\">fillStyle</span> = <span class=\"hljs-string\">&apos;rgba(255,255,255,0.5)&apos;</span>;\n              cxt.<span class=\"hljs-property\">textBaseline</span> = <span class=\"hljs-string\">&quot;bottom&quot;</span>;\n              cxt.<span class=\"hljs-property\">textAlign</span> = <span class=\"hljs-string\">&apos;end&apos;</span>;\n              cxt.<span class=\"hljs-title function_\">fillText</span>(str,W-<span class=\"hljs-number\">10</span>,H-<span class=\"hljs-number\">10</span>,W/<span class=\"hljs-number\">2</span>);   \n              downloadImg.<span class=\"hljs-property\">onclick</span> = <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>){\n                downloadImgHelper.<span class=\"hljs-property\">href</span>  =  drawing.<span class=\"hljs-title function_\">toDataURL</span>(<span class=\"hljs-string\">&apos;image/png&apos;</span>);\n                downloadImgHelper.<span class=\"hljs-title function_\">click</span>();       \n              }   \n          }  \n        }\n      }      \n    }            \n  }               \n}\n</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">script</span>&gt;</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"72,136"}}],"payload":{"tag":"h3","lines":"66,67"}},{"content":"&#x653e;&#x5927;&#x955c;","children":[{"content":"<pre data-lines=\"145,146\"><code>&#x3000;&#x3000;&#x4e0b;&#x9762;&#x6765;&#x5b9e;&#x73b0;&#x4e00;&#x4e2a;&#x653e;&#x5927;&#x955c;&#x7684;&#x6548;&#x679c;&#xff0c;&#x9f20;&#x6807;&#x6309;&#x4e0b;&#x5e76;&#x79fb;&#x52a8;&#x65f6;&#xff0c;&#x663e;&#x793a;&#x5f53;&#x524d;&#x56fe;&#x7247;&#x533a;&#x57df;&#x7684;&#x653e;&#x5927;&#x6548;&#x679c;&#xff0c;&#x62ac;&#x8d77;&#x540e;&#x6548;&#x679c;&#x6d88;&#x5931;&#x3002;&#x653e;&#x5927;&#x955c;&#x6548;&#x679c;&#x4e3b;&#x8981;&#x4f7f;&#x7528;&#x79bb;&#x5c4f;canvas&#x7684;&#x6280;&#x672f;&#xff0c;&#x79bb;&#x5c4f;canvas&#x653e;&#x7f6e;&#x7684;&#x662f;&#x56fe;&#x7247;&#x7684;&#x653e;&#x5927;&#x7248;&#xff0c;&#x800c;&#x666e;&#x901a;canvas&#x5219;&#x653e;&#x7f6e;&#x56fe;&#x7247;&#x7684;&#x6b63;&#x5e38;&#x7248;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"145,146"}},{"content":"<pre data-lines=\"149,211\"><code data-lines=\"149,211\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">canvas</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">&quot;drawing&quot;</span> <span class=\"hljs-attr\">style</span>=<span class=\"hljs-string\">&quot;border:1px solid black&quot;</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">p</span>&gt;</span>The canvas element is not supported!<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">p</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">canvas</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">canvas</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">&quot;drawingOff&quot;</span> <span class=\"hljs-attr\">style</span>=<span class=\"hljs-string\">&quot;display:none&quot;</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">p</span>&gt;</span>The canvas element is not supported!<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">p</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">canvas</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">script</span>&gt;</span><span class=\"language-javascript\">\n<span class=\"hljs-keyword\">if</span>(drawing.<span class=\"hljs-property\">getContext</span>){\n  <span class=\"hljs-keyword\">var</span> cxt = drawing.<span class=\"hljs-title function_\">getContext</span>(<span class=\"hljs-string\">&apos;2d&apos;</span>);\n  <span class=\"hljs-keyword\">var</span> cxtOff = drawingOff.<span class=\"hljs-title function_\">getContext</span>(<span class=\"hljs-string\">&apos;2d&apos;</span>);\n  <span class=\"hljs-keyword\">var</span> W,H; \n  <span class=\"hljs-keyword\">var</span> scale = <span class=\"hljs-number\">1.5</span>; \n  <span class=\"hljs-keyword\">var</span> img = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Image</span>();\n  img.<span class=\"hljs-property\">src</span>=<span class=\"hljs-string\">&quot;http://sandbox.runjs.cn/uploads/rs/26/ddzmgynp/chunfen.jpg&quot;</span>;\n  img.<span class=\"hljs-property\">onload</span> = <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>){\n    W = img.<span class=\"hljs-property\">width</span>;\n    H = img.<span class=\"hljs-property\">height</span>;\n    drawing.<span class=\"hljs-property\">width</span> = W/scale;\n    drawing.<span class=\"hljs-property\">height</span> = H/scale;\n    drawingOff.<span class=\"hljs-property\">width</span> = W;\n    drawingOff.<span class=\"hljs-property\">height</span> = H;\n    cxt.<span class=\"hljs-title function_\">drawImage</span>(img,<span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">0</span>,W/scale,H/scale);\n    cxtOff.<span class=\"hljs-title function_\">drawImage</span>(img,<span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">0</span>);\n    drawing.<span class=\"hljs-property\">onmousedown</span> = <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">e</span>){\n      e = e || event;\n      <span class=\"hljs-keyword\">var</span> x0 = <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">offsetLeft</span>;\n      <span class=\"hljs-keyword\">var</span> y0 = <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">offsetTop</span>; \n      <span class=\"hljs-title function_\">drawMagnifier</span>(e);\n      drawing.<span class=\"hljs-property\">onmousemove</span> = <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">e</span>){\n        <span class=\"hljs-title function_\">drawMagnifier</span>(e);\n      }\n      <span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-property\">onmouseup</span> = <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">e</span>){\n        cxt.<span class=\"hljs-title function_\">clearRect</span>(<span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">0</span>,W/scale,H/scale);\n        cxt.<span class=\"hljs-title function_\">drawImage</span>(img,<span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">0</span>,W/scale,H/scale);\n        drawing.<span class=\"hljs-property\">onmousemove</span> = <span class=\"hljs-literal\">null</span>;\n      }        \n      <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">drawMagnifier</span>(<span class=\"hljs-params\">e</span>){\n        cxt.<span class=\"hljs-title function_\">clearRect</span>(<span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">0</span>,W/scale,H/scale);\n        cxt.<span class=\"hljs-title function_\">drawImage</span>(img,<span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">0</span>,W/scale,H/scale);\n        <span class=\"hljs-keyword\">var</span> x = (e.<span class=\"hljs-property\">clientX</span>-x0);\n        <span class=\"hljs-keyword\">var</span> y = (e.<span class=\"hljs-property\">clientY</span>-y0);        \n        <span class=\"hljs-keyword\">var</span> r = <span class=\"hljs-number\">40</span>;\n        <span class=\"hljs-keyword\">var</span> dx = x - r;\n        <span class=\"hljs-keyword\">var</span> dy = y - r;\n        <span class=\"hljs-keyword\">var</span> sx = x*scale - r;\n        <span class=\"hljs-keyword\">var</span> sy = y*scale - r;\n        cxt.<span class=\"hljs-title function_\">save</span>();\n        cxt.<span class=\"hljs-title function_\">beginPath</span>();\n        cxt.<span class=\"hljs-title function_\">arc</span>(x,y,r,<span class=\"hljs-number\">0</span>,<span class=\"hljs-title class_\">Math</span>.<span class=\"hljs-property\">PI</span>*<span class=\"hljs-number\">2</span>);\n        cxt.<span class=\"hljs-property\">lineWidth</span> = <span class=\"hljs-number\">4</span>;\n        cxt.<span class=\"hljs-property\">strokeStyle</span> = <span class=\"hljs-string\">&apos;#069&apos;</span>;\n        cxt.<span class=\"hljs-title function_\">stroke</span>();\n        cxt.<span class=\"hljs-title function_\">clip</span>();\n        cxt.<span class=\"hljs-title function_\">drawImage</span>(drawingOff,sx,sy,<span class=\"hljs-number\">2</span>*r,<span class=\"hljs-number\">2</span>*r,dx,dy,<span class=\"hljs-number\">2</span>*r,<span class=\"hljs-number\">2</span>*r);\n        cxt.<span class=\"hljs-title function_\">restore</span>();         \n      }\n    }\n  } \n}\n</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">script</span>&gt;</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"149,211"}},{"content":"<pre data-lines=\"214,215\"><code>\t&#x3000;&#x3000;&#x6309;&#x4e0b;&#x9f20;&#x6807;&#x540e;&#x4e0d;&#x677e;&#x5f00;&#xff0c;&#x5373;&#x53ef;&#x51fa;&#x73b0;&#x653e;&#x5927;&#x955c;&#x6548;&#x679c;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"214,215"}}],"payload":{"tag":"h3","lines":"143,144"}},{"content":"&#x6ee4;&#x955c;","children":[{"content":"<pre data-lines=\"222,223\"><code>&#x3000;&#x3000;&#x4e0b;&#x9762;&#x5229;&#x7528;canvas&#x7684;getImageData()&#x65b9;&#x6cd5;&#xff0c;&#x83b7;&#x53d6;&#x539f;&#x59cb;&#x56fe;&#x50cf;&#x6570;&#x636e;&#xff0c;&#x901a;&#x8fc7;&#x5bf9;&#x56fe;&#x50cf;&#x6570;&#x636e;&#x8fdb;&#x884c;&#x4fee;&#x6539;&#xff0c;&#x7136;&#x540e;&#x8f93;&#x51fa;&#x4fee;&#x6539;&#x540e;&#x7684;&#x56fe;&#x50cf;&#x6570;&#x636e;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"222,223"}},{"content":"<pre data-lines=\"226,312\"><code data-lines=\"226,312\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">canvas</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">&quot;drawing1&quot;</span> <span class=\"hljs-attr\">style</span>=<span class=\"hljs-string\">&quot;border:1px solid black&quot;</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">p</span>&gt;</span>The canvas element is not supported!<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">p</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">canvas</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">canvas</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">&quot;drawing2&quot;</span> <span class=\"hljs-attr\">style</span>=<span class=\"hljs-string\">&quot;border:1px solid black&quot;</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">p</span>&gt;</span>The canvas element is not supported!<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">p</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">canvas</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">br</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">button</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">&quot;noGreen&quot;</span>&gt;</span>&#x65e0;&#x7eff;&#x8272;<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">button</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">button</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">&quot;noBlue&quot;</span>&gt;</span>&#x65e0;&#x84dd;&#x8272;<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">button</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">button</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">&quot;toGrey&quot;</span>&gt;</span>&#x7070;&#x5ea6;<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">button</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">button</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">&quot;toBlackWhite&quot;</span>&gt;</span>&#x9ed1;&#x767d;<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">button</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">button</span> <span class=\"hljs-attr\">id</span>=<span class=\"hljs-string\">&quot;reverse&quot;</span>&gt;</span>&#x53cd;&#x8272;<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">button</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">script</span>&gt;</span><span class=\"language-javascript\">\n<span class=\"hljs-keyword\">if</span>(drawing1.<span class=\"hljs-property\">getContext</span>){\n  <span class=\"hljs-keyword\">var</span> cxt1 = drawing1.<span class=\"hljs-title function_\">getContext</span>(<span class=\"hljs-string\">&apos;2d&apos;</span>);\n  <span class=\"hljs-keyword\">var</span> cxt2 = drawing2.<span class=\"hljs-title function_\">getContext</span>(<span class=\"hljs-string\">&apos;2d&apos;</span>);\n  <span class=\"hljs-keyword\">var</span> img = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Image</span>();\n  img.<span class=\"hljs-property\">src</span>=<span class=\"hljs-string\">&quot;chunfen.jpg&quot;</span>;\n  img.<span class=\"hljs-property\">onload</span> = <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>){\n    cxt1.<span class=\"hljs-title function_\">drawImage</span>(img,<span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">0</span>);\n    <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">filter</span>(<span class=\"hljs-params\">fn</span>){\n      <span class=\"hljs-keyword\">var</span> imageData = cxt1.<span class=\"hljs-title function_\">getImageData</span>(<span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">0</span>,img.<span class=\"hljs-property\">width</span>,img.<span class=\"hljs-property\">height</span>); \n      cxt2.<span class=\"hljs-title function_\">clearRect</span>(<span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">0</span>,drawing2.<span class=\"hljs-property\">width</span>,drawing2.<span class=\"hljs-property\">height</span>); \n      <span class=\"hljs-keyword\">var</span> data = imageData.<span class=\"hljs-property\">data</span>;\n      <span class=\"hljs-keyword\">for</span>(<span class=\"hljs-keyword\">var</span> i = <span class=\"hljs-number\">0</span>, len = data.<span class=\"hljs-property\">length</span>; i &lt; len; i+=<span class=\"hljs-number\">4</span>){\n        <span class=\"hljs-title function_\">fn</span>(data,i)\n      }\n      imageData.<span class=\"hljs-property\">data</span> = data;\n      cxt2.<span class=\"hljs-title function_\">putImageData</span>(imageData,<span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">0</span>); \n    }\n    <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">fnNoGreen</span>(<span class=\"hljs-params\">data,i</span>){\n      data[i+<span class=\"hljs-number\">1</span>] = <span class=\"hljs-number\">0</span>;\n    }\n    <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">fnNoBlue</span>(<span class=\"hljs-params\">data,i</span>){\n      data[i+<span class=\"hljs-number\">2</span>] = <span class=\"hljs-number\">0</span>;\n    } \n    <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">fnReverse</span>(<span class=\"hljs-params\">data,i</span>){\n      <span class=\"hljs-keyword\">var</span> red = data[i];\n      <span class=\"hljs-keyword\">var</span> green = data[i+<span class=\"hljs-number\">1</span>];\n      <span class=\"hljs-keyword\">var</span> blue = data[i+<span class=\"hljs-number\">2</span>];\n      <span class=\"hljs-keyword\">var</span> alpha = data[i+<span class=\"hljs-number\">3</span>];\n      data[i] = <span class=\"hljs-number\">255</span> - red;\n      data[i+<span class=\"hljs-number\">1</span>] = <span class=\"hljs-number\">255</span> - green;\n      data[i+<span class=\"hljs-number\">2</span>] = <span class=\"hljs-number\">255</span> - blue;\n    }       \n    <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">fnToGrey</span>(<span class=\"hljs-params\">data,i</span>){\n      <span class=\"hljs-keyword\">var</span> red = data[i];\n      <span class=\"hljs-keyword\">var</span> green = data[i+<span class=\"hljs-number\">1</span>];\n      <span class=\"hljs-keyword\">var</span> blue = data[i+<span class=\"hljs-number\">2</span>];\n      <span class=\"hljs-keyword\">var</span> alpha = data[i+<span class=\"hljs-number\">3</span>];\n      <span class=\"hljs-keyword\">var</span> average = <span class=\"hljs-title class_\">Math</span>.<span class=\"hljs-title function_\">floor</span>((red+green+blue)/<span class=\"hljs-number\">3</span>);\n      data[i] = data[i+<span class=\"hljs-number\">1</span>] = data[i+<span class=\"hljs-number\">2</span>] = average;      \n    }    \n    <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">fnToBlackWhite</span>(<span class=\"hljs-params\">data,i</span>){\n      <span class=\"hljs-keyword\">var</span> red = data[i];\n      <span class=\"hljs-keyword\">var</span> green = data[i+<span class=\"hljs-number\">1</span>];\n      <span class=\"hljs-keyword\">var</span> blue = data[i+<span class=\"hljs-number\">2</span>];\n      <span class=\"hljs-keyword\">var</span> alpha = data[i+<span class=\"hljs-number\">3</span>];\n      <span class=\"hljs-keyword\">var</span> average = <span class=\"hljs-title class_\">Math</span>.<span class=\"hljs-title function_\">floor</span>((red+green+blue)/<span class=\"hljs-number\">3</span>);\n      <span class=\"hljs-keyword\">if</span>(average &gt; <span class=\"hljs-number\">255</span>/<span class=\"hljs-number\">2</span>){\n        <span class=\"hljs-keyword\">var</span> result = <span class=\"hljs-number\">255</span>;\n      }<span class=\"hljs-keyword\">else</span>{\n        <span class=\"hljs-keyword\">var</span> result = <span class=\"hljs-number\">0</span>;\n      }\n      data[i] = data[i+<span class=\"hljs-number\">1</span>] = data[i+<span class=\"hljs-number\">2</span>] = result;        \n    }\n    toGrey.<span class=\"hljs-property\">onclick</span> = <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>){\n      <span class=\"hljs-title function_\">filter</span>(fnToGrey);\n    }\n    noGreen.<span class=\"hljs-property\">onclick</span> = <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>){\n      <span class=\"hljs-title function_\">filter</span>(fnNoGreen);\n    }  \n    noBlue.<span class=\"hljs-property\">onclick</span> = <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>){\n      <span class=\"hljs-title function_\">filter</span>(fnNoBlue);\n    }  \n    toBlackWhite.<span class=\"hljs-property\">onclick</span> = <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>){\n      <span class=\"hljs-title function_\">filter</span>(fnToBlackWhite);\n    }\n    reverse.<span class=\"hljs-property\">onclick</span> = <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>){\n      <span class=\"hljs-title function_\">filter</span>(fnReverse);\n    }  \n  }\n}\n</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">script</span>&gt;</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"226,312"}}],"payload":{"tag":"h3","lines":"220,221"}},{"content":"&#x9a6c;&#x8d5b;&#x514b;&#x6548;&#x679c;","children":[{"content":"<pre data-lines=\"321,324\"><code>&#x3010;&#x666e;&#x901a;&#x6a21;&#x7cca;&#x6548;&#x679c;&#x3011;\n\n&#x3000;&#x3000;&#x666e;&#x901a;&#x6a21;&#x7cca;&#x6548;&#x679c;&#x4e0d;&#x4ec5;&#x9700;&#x8981;&#x4f7f;&#x7528;&#x5f53;&#x524d;&#x50cf;&#x7d20;&#x70b9;&#xff0c;&#x8fd8;&#x9700;&#x8981;&#x4f7f;&#x7528;&#x5468;&#x56f4;&#x7684;&#x50cf;&#x7d20;&#x70b9;&#xff0c;&#x5e76;&#x628a;&#x8fd9;&#x4e9b;&#x50cf;&#x7d20;&#x70b9;&#x90fd;&#x8d4b;&#x4e88;&#x5e73;&#x5747;&#x503c;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"321,324"}},{"content":"<pre data-lines=\"327,359\"><code data-lines=\"327,359\">   function <span class=\"hljs-title function_\">fnToBlur</span><span class=\"hljs-params\">(n)</span>{\n      cxt2.clearRect(<span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">0</span>,drawing2.width,drawing2.height); \n      <span class=\"hljs-type\">var</span> <span class=\"hljs-variable\">imageData</span> <span class=\"hljs-operator\">=</span> cxt1.getImageData(<span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">0</span>,drawing2.width,drawing2.height); \n      <span class=\"hljs-type\">var</span> <span class=\"hljs-variable\">tempImageData</span> <span class=\"hljs-operator\">=</span> imageData;\n      <span class=\"hljs-type\">var</span> <span class=\"hljs-variable\">data</span> <span class=\"hljs-operator\">=</span> imageData.data;\n      <span class=\"hljs-type\">var</span> <span class=\"hljs-variable\">tempData</span> <span class=\"hljs-operator\">=</span> tempImageData.data;\n      <span class=\"hljs-type\">var</span> <span class=\"hljs-variable\">blurR</span> <span class=\"hljs-operator\">=</span> n;\n      <span class=\"hljs-type\">var</span> <span class=\"hljs-variable\">totalnum</span> <span class=\"hljs-operator\">=</span> (<span class=\"hljs-number\">2</span>*blurR + <span class=\"hljs-number\">1</span>)*(<span class=\"hljs-number\">2</span>*blurR + <span class=\"hljs-number\">1</span>);\n      <span class=\"hljs-keyword\">for</span>(<span class=\"hljs-type\">var</span> <span class=\"hljs-variable\">i</span> <span class=\"hljs-operator\">=</span> blurR; i &lt; drawing2.height - blurR; i++){\n        <span class=\"hljs-keyword\">for</span>(<span class=\"hljs-type\">var</span> <span class=\"hljs-variable\">j</span> <span class=\"hljs-operator\">=</span> blurR; j &lt; drawing2.width - blurR; j++){\n          <span class=\"hljs-type\">var</span> <span class=\"hljs-variable\">totalr</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">0</span>, totalg = <span class=\"hljs-number\">0</span>, totalb = <span class=\"hljs-number\">0</span>;\n          <span class=\"hljs-keyword\">for</span>(<span class=\"hljs-type\">var</span> <span class=\"hljs-variable\">dx</span> <span class=\"hljs-operator\">=</span> -blurR; dx &lt;= blurR; dx++){\n            <span class=\"hljs-keyword\">for</span>(<span class=\"hljs-type\">var</span> <span class=\"hljs-variable\">dy</span> <span class=\"hljs-operator\">=</span> -blurR; dy &lt;= blurR; dy++){\n              <span class=\"hljs-type\">var</span> <span class=\"hljs-variable\">x</span> <span class=\"hljs-operator\">=</span> i + dx;\n              <span class=\"hljs-type\">var</span> <span class=\"hljs-variable\">y</span> <span class=\"hljs-operator\">=</span> j + dy;\n              <span class=\"hljs-type\">var</span> <span class=\"hljs-variable\">p</span> <span class=\"hljs-operator\">=</span> x*drawing2.width + y;\n              totalr += tempData[p*<span class=\"hljs-number\">4</span>+<span class=\"hljs-number\">0</span>];\n              totalg += tempData[p*<span class=\"hljs-number\">4</span>+<span class=\"hljs-number\">1</span>];\n              totalb += tempData[p*<span class=\"hljs-number\">4</span>+<span class=\"hljs-number\">2</span>];\n            }\n          }\n          <span class=\"hljs-type\">var</span> <span class=\"hljs-variable\">p</span> <span class=\"hljs-operator\">=</span> i*drawing2.width + j;\n          data[p*<span class=\"hljs-number\">4</span>+<span class=\"hljs-number\">0</span>] = totalr / totalnum;\n          data[p*<span class=\"hljs-number\">4</span>+<span class=\"hljs-number\">1</span>] = totalg / totalnum;\n          data[p*<span class=\"hljs-number\">4</span>+<span class=\"hljs-number\">2</span>] = totalb / totalnum;\n        }\n      }\n      imageData.data = data;\n      cxt2.putImageData(imageData,<span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">0</span>); \n    }\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"327,359"}},{"content":"<pre data-lines=\"362,365\"><code>&#x3010;&#x9a6c;&#x8d5b;&#x514b;&#x6548;&#x679c;&#x3011;\n\n&#x3000;&#x3000;&#x9a6c;&#x8d5b;&#x514b;&#x6548;&#x679c;&#x5219;&#x662f;&#x628a;&#x4e00;&#x5757;&#x533a;&#x57df;&#x7684;&#x503c;&#xff0c;&#x5168;&#x90e8;&#x90fd;&#x8d4b;&#x4e88;&#x5e73;&#x5747;&#x503c;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"362,365"}},{"content":"<pre data-lines=\"368,410\"><code data-lines=\"368,410\">    function <span class=\"hljs-title function_\">fnToMosaic</span><span class=\"hljs-params\">(n)</span>{\n      cxt2.clearRect(<span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">0</span>,drawing2.width,drawing2.height); \n      <span class=\"hljs-type\">var</span> <span class=\"hljs-variable\">imageData</span> <span class=\"hljs-operator\">=</span> cxt1.getImageData(<span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">0</span>,drawing2.width,drawing2.height); \n      <span class=\"hljs-type\">var</span> <span class=\"hljs-variable\">tempImageData</span> <span class=\"hljs-operator\">=</span> imageData;\n      <span class=\"hljs-type\">var</span> <span class=\"hljs-variable\">data</span> <span class=\"hljs-operator\">=</span> imageData.data;\n      <span class=\"hljs-type\">var</span> <span class=\"hljs-variable\">tempData</span> <span class=\"hljs-operator\">=</span> tempImageData.data;\n      <span class=\"hljs-type\">var</span> <span class=\"hljs-variable\">size</span> <span class=\"hljs-operator\">=</span> n;\n      <span class=\"hljs-type\">var</span> <span class=\"hljs-variable\">totalnum</span> <span class=\"hljs-operator\">=</span> size*size;\n      <span class=\"hljs-keyword\">for</span>(<span class=\"hljs-type\">var</span> <span class=\"hljs-variable\">i</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">0</span>; i &lt; drawing2.height; i+=size){\n        <span class=\"hljs-keyword\">for</span>(<span class=\"hljs-type\">var</span> <span class=\"hljs-variable\">j</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">0</span>; j &lt; drawing2.width; j+=size){\n          <span class=\"hljs-type\">var</span> <span class=\"hljs-variable\">totalr</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">0</span>, totalg = <span class=\"hljs-number\">0</span>, totalb = <span class=\"hljs-number\">0</span>;\n          <span class=\"hljs-keyword\">for</span>(<span class=\"hljs-type\">var</span> <span class=\"hljs-variable\">dx</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">0</span>; dx &lt; size; dx++){\n            <span class=\"hljs-keyword\">for</span>(<span class=\"hljs-type\">var</span> <span class=\"hljs-variable\">dy</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">0</span>; dy &lt; size; dy++){\n              <span class=\"hljs-type\">var</span> <span class=\"hljs-variable\">x</span> <span class=\"hljs-operator\">=</span> i + dx;\n              <span class=\"hljs-type\">var</span> <span class=\"hljs-variable\">y</span> <span class=\"hljs-operator\">=</span> j + dy;\n              <span class=\"hljs-type\">var</span> <span class=\"hljs-variable\">p</span> <span class=\"hljs-operator\">=</span> x*drawing2.width + y;\n              totalr += tempData[p*<span class=\"hljs-number\">4</span>+<span class=\"hljs-number\">0</span>];\n              totalg += tempData[p*<span class=\"hljs-number\">4</span>+<span class=\"hljs-number\">1</span>];\n              totalb += tempData[p*<span class=\"hljs-number\">4</span>+<span class=\"hljs-number\">2</span>];\n            }\n          }\n          <span class=\"hljs-type\">var</span> <span class=\"hljs-variable\">p</span> <span class=\"hljs-operator\">=</span> i*drawing2.width + j;\n          <span class=\"hljs-type\">var</span> <span class=\"hljs-variable\">resr</span> <span class=\"hljs-operator\">=</span> totalr / totalnum;\n          <span class=\"hljs-type\">var</span> <span class=\"hljs-variable\">resg</span> <span class=\"hljs-operator\">=</span> totalg / totalnum;\n          <span class=\"hljs-type\">var</span> <span class=\"hljs-variable\">resb</span> <span class=\"hljs-operator\">=</span> totalb / totalnum;\n          <span class=\"hljs-keyword\">for</span>(<span class=\"hljs-type\">var</span> <span class=\"hljs-variable\">dx</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">0</span>; dx &lt; size; dx++){\n            <span class=\"hljs-keyword\">for</span>(<span class=\"hljs-type\">var</span> <span class=\"hljs-variable\">dy</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">0</span>; dy &lt; size; dy++){\n              <span class=\"hljs-type\">var</span> <span class=\"hljs-variable\">x</span> <span class=\"hljs-operator\">=</span> i + dx;\n              <span class=\"hljs-type\">var</span> <span class=\"hljs-variable\">y</span> <span class=\"hljs-operator\">=</span> j + dy;\n              <span class=\"hljs-type\">var</span> <span class=\"hljs-variable\">p</span> <span class=\"hljs-operator\">=</span> x*drawing2.width + y;\n              data[p*<span class=\"hljs-number\">4</span>+<span class=\"hljs-number\">0</span>]= resr;\n              data[p*<span class=\"hljs-number\">4</span>+<span class=\"hljs-number\">1</span>]= resg;\n              data[p*<span class=\"hljs-number\">4</span>+<span class=\"hljs-number\">2</span>]= resb;\n            }\n          }\n        }\n      }\n      imageData.data = data;\n      cxt2.putImageData(imageData,<span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">0</span>); \n    }    \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"368,410"}},{"content":"<pre data-lines=\"413,414\"><code>&#x3000;&#x3000;&#x4e0b;&#x9762;&#x662f;&#x4e00;&#x4e2a;&#x5b9e;&#x4f8b;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"413,414"}},{"content":"<pre data-lines=\"417,523\"><code data-lines=\"417,523\">&lt;canvas id=<span class=\"hljs-string\">&quot;drawing1&quot;</span> style=<span class=\"hljs-string\">&quot;border:1px solid black&quot;</span>&gt;\n    &lt;p&gt;The canvas element is not supported!&lt;/p&gt;\n&lt;/canvas&gt;\n&lt;canvas id=<span class=\"hljs-string\">&quot;drawing2&quot;</span> style=<span class=\"hljs-string\">&quot;border:1px solid black&quot;</span>&gt;\n    &lt;p&gt;The canvas element is not supported!&lt;/p&gt;\n&lt;/canvas&gt;\n&lt;br&gt;\n&lt;button id=<span class=\"hljs-string\">&quot;toLightBlur&quot;</span>&gt;&#x8f7b;&#x5ea6;&#x6a21;&#x7cca;&lt;/button&gt;\n&lt;button id=<span class=\"hljs-string\">&quot;toHeavyBlur&quot;</span>&gt;&#x91cd;&#x5ea6;&#x6a21;&#x7cca;&lt;/button&gt;\n&lt;button id=<span class=\"hljs-string\">&quot;toLightMosaic&quot;</span>&gt;&#x8f7b;&#x5ea6;&#x9a6c;&#x8d5b;&#x514b;&lt;/button&gt;\n&lt;button id=<span class=\"hljs-string\">&quot;toHeavyMosaic&quot;</span>&gt;&#x91cd;&#x5ea6;&#x9a6c;&#x8d5b;&#x514b;&lt;/button&gt;\n&lt;script&gt;\nif(drawing1.getContext){\n  <span class=\"hljs-keyword\">var</span> <span class=\"hljs-variable\">cxt1</span> = drawing1.getContext(<span class=\"hljs-string\">&apos;2d&apos;</span>)<span class=\"hljs-comment\">;</span>\n  <span class=\"hljs-keyword\">var</span> <span class=\"hljs-variable\">cxt2</span> = drawing2.getContext(<span class=\"hljs-string\">&apos;2d&apos;</span>)<span class=\"hljs-comment\">;</span>\n  <span class=\"hljs-keyword\">var</span> <span class=\"hljs-variable\">img</span> = new Image()<span class=\"hljs-comment\">;</span>\n  img.src=<span class=\"hljs-string\">&quot;chunfen.jpg&quot;</span><span class=\"hljs-comment\">;</span>\n  img.onload = <span class=\"hljs-keyword\">function</span>(){\n    cxt1.drawImage(img,<span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">0</span>)<span class=\"hljs-comment\">;</span>\n    toLightBlur.onclick = <span class=\"hljs-keyword\">function</span>(){\n      fnToBlur(<span class=\"hljs-number\">1</span>)<span class=\"hljs-comment\">;</span>\n    }\n    toHeavyBlur.onclick = <span class=\"hljs-keyword\">function</span>(){\n      fnToBlur(<span class=\"hljs-number\">3</span>)<span class=\"hljs-comment\">;</span>\n    }   \n    toLightMosaic.onclick = <span class=\"hljs-keyword\">function</span>(){\n      fnToMosaic(<span class=\"hljs-number\">4</span>)<span class=\"hljs-comment\">;</span>\n    } \n    toHeavyMosaic.onclick = <span class=\"hljs-keyword\">function</span>(){\n      fnToMosaic(<span class=\"hljs-number\">9</span>)<span class=\"hljs-comment\">;</span>\n    }     \n    <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">fnToBlur</span>(n){\n      cxt2.clearRect(<span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">0</span>,drawing2.width,drawing2.height)<span class=\"hljs-comment\">; </span>\n      <span class=\"hljs-keyword\">var</span> <span class=\"hljs-variable\">imageData</span> = cxt1.getImageData(<span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">0</span>,drawing2.width,drawing2.height)<span class=\"hljs-comment\">; </span>\n      <span class=\"hljs-keyword\">var</span> <span class=\"hljs-variable\">tempImageData</span> = imageData<span class=\"hljs-comment\">;</span>\n      <span class=\"hljs-keyword\">var</span> <span class=\"hljs-variable\">data</span> = imageData.data<span class=\"hljs-comment\">;</span>\n      <span class=\"hljs-keyword\">var</span> <span class=\"hljs-variable\">tempData</span> = tempImageData.data<span class=\"hljs-comment\">;</span>\n      <span class=\"hljs-keyword\">var</span> <span class=\"hljs-variable\">blurR</span> = n<span class=\"hljs-comment\">;</span>\n      <span class=\"hljs-keyword\">var</span> <span class=\"hljs-variable\">totalnum</span> = (<span class=\"hljs-number\">2</span>*blurR + <span class=\"hljs-number\">1</span>)*(<span class=\"hljs-number\">2</span>*blurR + <span class=\"hljs-number\">1</span>)<span class=\"hljs-comment\">;</span>\n      for(<span class=\"hljs-keyword\">var</span> <span class=\"hljs-variable\">i</span> = blurR<span class=\"hljs-comment\">; i &lt; drawing2.height - blurR; i++){</span>\n        for(<span class=\"hljs-keyword\">var</span> <span class=\"hljs-variable\">j</span> = blurR<span class=\"hljs-comment\">; j &lt; drawing2.width - blurR; j++){</span>\n          <span class=\"hljs-keyword\">var</span> <span class=\"hljs-variable\">totalr</span> = <span class=\"hljs-number\">0</span>, totalg = <span class=\"hljs-number\">0</span>, totalb = <span class=\"hljs-number\">0</span><span class=\"hljs-comment\">;</span>\n          for(<span class=\"hljs-keyword\">var</span> <span class=\"hljs-variable\">dx</span> = -blurR<span class=\"hljs-comment\">; dx &lt;= blurR; dx++){</span>\n            for(<span class=\"hljs-keyword\">var</span> <span class=\"hljs-variable\">dy</span> = -blurR<span class=\"hljs-comment\">; dy &lt;= blurR; dy++){</span>\n              <span class=\"hljs-keyword\">var</span> <span class=\"hljs-variable\">x</span> = i + dx<span class=\"hljs-comment\">;</span>\n              <span class=\"hljs-keyword\">var</span> <span class=\"hljs-variable\">y</span> = j + dy<span class=\"hljs-comment\">;</span>\n              <span class=\"hljs-keyword\">var</span> <span class=\"hljs-variable\">p</span> = x*drawing2.width + y<span class=\"hljs-comment\">;</span>\n              totalr += tempData[p*<span class=\"hljs-number\">4</span>+<span class=\"hljs-number\">0</span>]<span class=\"hljs-comment\">;</span>\n              totalg += tempData[p*<span class=\"hljs-number\">4</span>+<span class=\"hljs-number\">1</span>]<span class=\"hljs-comment\">;</span>\n              totalb += tempData[p*<span class=\"hljs-number\">4</span>+<span class=\"hljs-number\">2</span>]<span class=\"hljs-comment\">;</span>\n            }\n          }\n          <span class=\"hljs-keyword\">var</span> <span class=\"hljs-variable\">p</span> = i*drawing2.width + j<span class=\"hljs-comment\">;</span>\n          data[p*<span class=\"hljs-number\">4</span>+<span class=\"hljs-number\">0</span>] = totalr / totalnum<span class=\"hljs-comment\">;</span>\n          data[p*<span class=\"hljs-number\">4</span>+<span class=\"hljs-number\">1</span>] = totalg / totalnum<span class=\"hljs-comment\">;</span>\n          data[p*<span class=\"hljs-number\">4</span>+<span class=\"hljs-number\">2</span>] = totalb / totalnum<span class=\"hljs-comment\">;</span>\n        }\n      }\n      imageData.data = data<span class=\"hljs-comment\">;</span>\n      cxt2.putImageData(imageData,<span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">0</span>)<span class=\"hljs-comment\">; </span>\n    }\n    <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">fnToMosaic</span>(n){\n      cxt2.clearRect(<span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">0</span>,drawing2.width,drawing2.height)<span class=\"hljs-comment\">; </span>\n      <span class=\"hljs-keyword\">var</span> <span class=\"hljs-variable\">imageData</span> = cxt1.getImageData(<span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">0</span>,drawing2.width,drawing2.height)<span class=\"hljs-comment\">; </span>\n      <span class=\"hljs-keyword\">var</span> <span class=\"hljs-variable\">tempImageData</span> = imageData<span class=\"hljs-comment\">;</span>\n      <span class=\"hljs-keyword\">var</span> <span class=\"hljs-variable\">data</span> = imageData.data<span class=\"hljs-comment\">;</span>\n      <span class=\"hljs-keyword\">var</span> <span class=\"hljs-variable\">tempData</span> = tempImageData.data<span class=\"hljs-comment\">;</span>\n      <span class=\"hljs-keyword\">var</span> <span class=\"hljs-variable\">size</span> = n<span class=\"hljs-comment\">;</span>\n      <span class=\"hljs-keyword\">var</span> <span class=\"hljs-variable\">totalnum</span> = size*size<span class=\"hljs-comment\">;</span>\n      for(<span class=\"hljs-keyword\">var</span> <span class=\"hljs-variable\">i</span> = <span class=\"hljs-number\">0</span><span class=\"hljs-comment\">; i &lt; drawing2.height; i+=size){</span>\n        for(<span class=\"hljs-keyword\">var</span> <span class=\"hljs-variable\">j</span> = <span class=\"hljs-number\">0</span><span class=\"hljs-comment\">; j &lt; drawing2.width; j+=size){</span>\n          <span class=\"hljs-keyword\">var</span> <span class=\"hljs-variable\">totalr</span> = <span class=\"hljs-number\">0</span>, totalg = <span class=\"hljs-number\">0</span>, totalb = <span class=\"hljs-number\">0</span><span class=\"hljs-comment\">;</span>\n          for(<span class=\"hljs-keyword\">var</span> <span class=\"hljs-variable\">dx</span> = <span class=\"hljs-number\">0</span><span class=\"hljs-comment\">; dx &lt; size; dx++){</span>\n            for(<span class=\"hljs-keyword\">var</span> <span class=\"hljs-variable\">dy</span> = <span class=\"hljs-number\">0</span><span class=\"hljs-comment\">; dy &lt; size; dy++){</span>\n              <span class=\"hljs-keyword\">var</span> <span class=\"hljs-variable\">x</span> = i + dx<span class=\"hljs-comment\">;</span>\n              <span class=\"hljs-keyword\">var</span> <span class=\"hljs-variable\">y</span> = j + dy<span class=\"hljs-comment\">;</span>\n              <span class=\"hljs-keyword\">var</span> <span class=\"hljs-variable\">p</span> = x*drawing2.width + y<span class=\"hljs-comment\">;</span>\n              totalr += tempData[p*<span class=\"hljs-number\">4</span>+<span class=\"hljs-number\">0</span>]<span class=\"hljs-comment\">;</span>\n              totalg += tempData[p*<span class=\"hljs-number\">4</span>+<span class=\"hljs-number\">1</span>]<span class=\"hljs-comment\">;</span>\n              totalb += tempData[p*<span class=\"hljs-number\">4</span>+<span class=\"hljs-number\">2</span>]<span class=\"hljs-comment\">;</span>\n            }\n          }\n          <span class=\"hljs-keyword\">var</span> <span class=\"hljs-variable\">p</span> = i*drawing2.width + j<span class=\"hljs-comment\">;</span>\n          <span class=\"hljs-keyword\">var</span> <span class=\"hljs-variable\">resr</span> = totalr / totalnum<span class=\"hljs-comment\">;</span>\n          <span class=\"hljs-keyword\">var</span> <span class=\"hljs-variable\">resg</span> = totalg / totalnum<span class=\"hljs-comment\">;</span>\n          <span class=\"hljs-keyword\">var</span> <span class=\"hljs-variable\">resb</span> = totalb / totalnum<span class=\"hljs-comment\">;</span>\n          for(<span class=\"hljs-keyword\">var</span> <span class=\"hljs-variable\">dx</span> = <span class=\"hljs-number\">0</span><span class=\"hljs-comment\">; dx &lt; size; dx++){</span>\n            for(<span class=\"hljs-keyword\">var</span> <span class=\"hljs-variable\">dy</span> = <span class=\"hljs-number\">0</span><span class=\"hljs-comment\">; dy &lt; size; dy++){</span>\n              <span class=\"hljs-keyword\">var</span> <span class=\"hljs-variable\">x</span> = i + dx<span class=\"hljs-comment\">;</span>\n              <span class=\"hljs-keyword\">var</span> <span class=\"hljs-variable\">y</span> = j + dy<span class=\"hljs-comment\">;</span>\n              <span class=\"hljs-keyword\">var</span> <span class=\"hljs-variable\">p</span> = x*drawing2.width + y<span class=\"hljs-comment\">;</span>\n              data[p*<span class=\"hljs-number\">4</span>+<span class=\"hljs-number\">0</span>]= resr<span class=\"hljs-comment\">;</span>\n              data[p*<span class=\"hljs-number\">4</span>+<span class=\"hljs-number\">1</span>]= resg<span class=\"hljs-comment\">;</span>\n              data[p*<span class=\"hljs-number\">4</span>+<span class=\"hljs-number\">2</span>]= resb<span class=\"hljs-comment\">;</span>\n            }\n          }\n        }\n      }\n      imageData.data = data<span class=\"hljs-comment\">;</span>\n      cxt2.putImageData(imageData,<span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">0</span>)<span class=\"hljs-comment\">; </span>\n    }    \n  }\n}\n&lt;/script&gt;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"417,523"}}],"payload":{"tag":"h3","lines":"319,320"}}],"payload":{"tag":"h1","lines":"0,1"}},{})</script>
</body>
</html>
