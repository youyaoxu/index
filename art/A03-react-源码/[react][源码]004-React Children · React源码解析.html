<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets@11.11.1/styles/default.min.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.18.10/dist/browser/index.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/index.js"></script><script>(r => {
              setTimeout(r);
            })(function renderToolbar() {
  const {
    markmap,
    mm
  } = window;
  const {
    el
  } = markmap.Toolbar.create(mm);
  el.setAttribute('style', 'position:absolute;bottom:20px;right:20px');
  document.body.append(el);
})</script><script>((getMarkmap, getOptions, root2, jsonOptions) => {
              const markmap = getMarkmap();
              window.mm = markmap.Markmap.create(
                "svg#mindmap",
                (getOptions || markmap.deriveOptions)(jsonOptions),
                root2
              );
            })(() => window.markmap,null,{"content":"React Children","children":[{"content":"&#x5f00;&#x59cb;","children":[{"content":"<pre data-lines=\"12,38\"><code data-lines=\"12,38\"><span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">mapChildren</span><span class=\"hljs-params\">(children, func, context)</span> </span>{\n  <span class=\"hljs-keyword\">if</span> (children == <span class=\"hljs-keyword\">null</span>) {\n    <span class=\"hljs-keyword\">return</span> children\n  }\n  <span class=\"hljs-keyword\">const</span> result = []\n  mapIntoWithKeyPrefixInternal(children, result, <span class=\"hljs-keyword\">null</span>, func, context)\n  <span class=\"hljs-keyword\">return</span> result\n}\n\n<span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">mapIntoWithKeyPrefixInternal</span><span class=\"hljs-params\">(children, <span class=\"hljs-keyword\">array</span>, prefix, func, context)</span> </span>{\n  <span class=\"hljs-keyword\">let</span> escapedPrefix = <span class=\"hljs-string\">&apos;&apos;</span>\n  <span class=\"hljs-keyword\">if</span> (prefix != <span class=\"hljs-keyword\">null</span>) {\n    escapedPrefix = escapeUserProvidedKey(prefix) + <span class=\"hljs-string\">&apos;/&apos;</span>\n  }\n  <span class=\"hljs-keyword\">const</span> traverseContext = getPooledTraverseContext(\n    <span class=\"hljs-keyword\">array</span>,\n    escapedPrefix,\n    func,\n    context,\n  )\n  traverseAllChildren(children, mapSingleChildIntoContext, traverseContext)\n  releaseTraverseContext(traverseContext)\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"12,38"}},{"content":"<pre data-lines=\"39,42\"><code>`map`&#x548c;`forEach`&#x7684;&#x6700;&#x5927;&#x533a;&#x522b;&#x5c31;&#x662f;&#x6709;&#x6ca1;&#x6709;`return result`&#x3002;\n\n`getPooledTraverseContext`&#x5c31;&#x662f;&#x4ece;`pool`&#x91cc;&#x9762;&#x627e;&#x4e00;&#x4e2a;&#x5bf9;&#x8c61;&#xff0c;`releaseTraverseContext`&#x4f1a;&#x628a;&#x5f53;&#x524d;&#x7684;`context`&#x5bf9;&#x8c61;&#x6e05;&#x7a7a;&#x7136;&#x540e;&#x653e;&#x56de;&#x5230;`pool`&#x4e2d;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"39,42"}},{"content":"<pre data-lines=\"43,67\"><code data-lines=\"43,67\">const POOL_SIZE = <span class=\"hljs-number\">10</span>\nconst traverseContextPool = []\n<span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">getPooledTraverseContext</span>(<span class=\"hljs-params\"></span>) {\n  \n  <span class=\"hljs-keyword\">if</span> (traverseContextPool.<span class=\"hljs-built_in\">length</span>) {\n    const traverseContext = traverseContextPool.<span class=\"hljs-built_in\">pop</span>()\n    \n    <span class=\"hljs-keyword\">return</span> traverseContext\n  } <span class=\"hljs-keyword\">else</span> {\n    <span class=\"hljs-keyword\">return</span> {\n      \n    }\n  }\n}\n\n<span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">releaseTraverseContext</span>(<span class=\"hljs-params\">traverseContext</span>) {\n  \n  <span class=\"hljs-keyword\">if</span> (traverseContextPool.<span class=\"hljs-built_in\">length</span> &lt; POOL_SIZE) {\n    traverseContextPool.<span class=\"hljs-built_in\">push</span>(traverseContext)\n  }\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"43,67"}},{"content":"<pre data-lines=\"68,69\"><code>&#x90a3;&#x4e48;&#x6309;&#x7167;&#x8fd9;&#x4e2a;&#x6d41;&#x7a0b;&#x6765;&#x770b;&#xff0c;&#x662f;&#x4e0d;&#x662f;`pool`&#x6c38;&#x8fdc;&#x90fd;&#x53ea;&#x6709;&#x4e00;&#x4e2a;&#x503c;&#x5462;&#xff0c;&#x6bd5;&#x7adf;&#x63a8;&#x51fa;&#x4e4b;&#x540e;&#x64cd;&#x4f5c;&#x5b8c;&#x4e86;&#x5c31;&#x63a8;&#x5165;&#x4e86;&#xff0c;&#x8fd9;&#x4e48;&#x5faa;&#x73af;&#x7740;&#x3002;&#x7b54;&#x6848;&#x80af;&#x5b9a;&#x662f;&#x5426;&#x7684;&#xff0c;&#x8fd9;&#x5c31;&#x8981;&#x8bb2;&#x5230;`React.Children.map`&#x7684;&#x4e00;&#x4e2a;&#x7279;&#x6027;&#x4e86;&#xff0c;&#x90a3;&#x5c31;&#x662f;&#x5bf9;&#x6bcf;&#x4e2a;&#x8282;&#x70b9;&#x7684;`map`&#x8fd4;&#x56de;&#x7684;&#x5982;&#x679c;&#x662f;&#x6570;&#x7ec4;&#xff0c;&#x90a3;&#x4e48;&#x8fd8;&#x4f1a;&#x7ee7;&#x7eed;&#x5c55;&#x5f00;&#xff0c;&#x8fd9;&#x662f;&#x4e00;&#x4e2a;&#x9012;&#x5f52;&#x7684;&#x8fc7;&#x7a0b;&#x3002;&#x63a5;&#x4e0b;&#x53bb;&#x6211;&#x4eec;&#x5c31;&#x6765;&#x770b;&#x770b;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"68,69"}},{"content":"<pre data-lines=\"70,148\"><code data-lines=\"70,148\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">traverseAllChildren</span>(<span class=\"hljs-params\">children, callback, traverseContext</span>) {\n  <span class=\"hljs-keyword\">if</span> (children == <span class=\"hljs-literal\">null</span>) {\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-number\">0</span>\n  }\n\n  <span class=\"hljs-keyword\">return</span> <span class=\"hljs-title function_\">traverseAllChildrenImpl</span>(children, <span class=\"hljs-string\">&apos;&apos;</span>, callback, traverseContext)\n}\n\n<span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">traverseAllChildrenImpl</span>(<span class=\"hljs-params\">\n  children,\n  nameSoFar,\n  callback,\n  traverseContext,\n</span>) {\n  <span class=\"hljs-keyword\">const</span> <span class=\"hljs-keyword\">type</span> = <span class=\"hljs-keyword\">typeof</span> children\n\n  <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-keyword\">type</span> === <span class=\"hljs-string\">&apos;undefined&apos;</span> || <span class=\"hljs-keyword\">type</span> === <span class=\"hljs-string\">&apos;boolean&apos;</span>) {\n    children = <span class=\"hljs-literal\">null</span>\n  }\n\n  <span class=\"hljs-keyword\">let</span> invokeCallback = <span class=\"hljs-literal\">false</span>\n\n  <span class=\"hljs-keyword\">if</span> (children === <span class=\"hljs-literal\">null</span>) {\n    invokeCallback = <span class=\"hljs-literal\">true</span>\n  } <span class=\"hljs-keyword\">else</span> {\n    <span class=\"hljs-keyword\">switch</span> (<span class=\"hljs-keyword\">type</span>) {\n      <span class=\"hljs-keyword\">case</span> <span class=\"hljs-string\">&apos;string&apos;</span>:\n      <span class=\"hljs-keyword\">case</span> <span class=\"hljs-string\">&apos;number&apos;</span>:\n        invokeCallback = <span class=\"hljs-literal\">true</span>\n        <span class=\"hljs-keyword\">break</span>\n      <span class=\"hljs-keyword\">case</span> <span class=\"hljs-string\">&apos;object&apos;</span>:\n        <span class=\"hljs-keyword\">switch</span> (children.<span class=\"hljs-property\">&#x24;&#x24;typeof</span>) {\n          <span class=\"hljs-keyword\">case</span> <span class=\"hljs-attr\">REACT_ELEMENT_TYPE</span>:\n          <span class=\"hljs-keyword\">case</span> <span class=\"hljs-attr\">REACT_PORTAL_TYPE</span>:\n            invokeCallback = <span class=\"hljs-literal\">true</span>\n        }\n    }\n  }\n\n  <span class=\"hljs-keyword\">if</span> (invokeCallback) {\n    <span class=\"hljs-title function_\">callback</span>(\n      traverseContext,\n      children,\n      nameSoFar === <span class=\"hljs-string\">&apos;&apos;</span> ? <span class=\"hljs-variable constant_\">SEPARATOR</span> + <span class=\"hljs-title function_\">getComponentKey</span>(children, <span class=\"hljs-number\">0</span>) : nameSoFar,\n    )\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-number\">1</span>\n  }\n\n  <span class=\"hljs-keyword\">let</span> child\n  <span class=\"hljs-keyword\">let</span> nextName\n  <span class=\"hljs-keyword\">let</span> subtreeCount = <span class=\"hljs-number\">0</span> \n  <span class=\"hljs-keyword\">const</span> nextNamePrefix = nameSoFar === <span class=\"hljs-string\">&apos;&apos;</span> ? <span class=\"hljs-variable constant_\">SEPARATOR</span> : nameSoFar + <span class=\"hljs-variable constant_\">SUBSEPARATOR</span>\n\n  <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-title class_\">Array</span>.<span class=\"hljs-title function_\">isArray</span>(children)) {\n    <span class=\"hljs-keyword\">for</span> (<span class=\"hljs-keyword\">let</span> i = <span class=\"hljs-number\">0</span>; i &lt; children.<span class=\"hljs-property\">length</span>; i++) {\n      child = children[i]\n      nextName = nextNamePrefix + <span class=\"hljs-title function_\">getComponentKey</span>(child, i)\n      subtreeCount += <span class=\"hljs-title function_\">traverseAllChildrenImpl</span>(\n        child,\n        nextName,\n        callback,\n        traverseContext,\n      )\n    }\n  } <span class=\"hljs-keyword\">else</span> {\n    <span class=\"hljs-keyword\">const</span> iteratorFn = <span class=\"hljs-title function_\">getIteratorFn</span>(children)\n    <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-keyword\">typeof</span> iteratorFn === <span class=\"hljs-string\">&apos;function&apos;</span>) {\n      \n    } <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-keyword\">type</span> === <span class=\"hljs-string\">&apos;object&apos;</span>) {\n      \n    }\n  }\n\n  <span class=\"hljs-keyword\">return</span> subtreeCount\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"70,148"}},{"content":"<pre data-lines=\"149,150\"><code>&#x8fd9;&#x91cc;&#x5c31;&#x662f;&#x4e00;&#x5c42;&#x9012;&#x5f52;&#x4e86;&#xff0c;&#x5bf9;&#x4e8e;&#x53ef;&#x5faa;&#x73af;&#x7684;`children`&#xff0c;&#x90fd;&#x4f1a;&#x91cd;&#x590d;&#x8c03;&#x7528;`traverseAllChildrenImpl`&#xff0c;&#x76f4;&#x5230;&#x662f;&#x4e00;&#x4e2a;&#x8282;&#x70b9;&#x7684;&#x60c5;&#x51b5;&#xff0c;&#x7136;&#x540e;&#x8c03;&#x7528;`callback`&#xff0c;&#x4e5f;&#x5c31;&#x662f;`mapSingleChildIntoContext`\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"149,150"}},{"content":"<pre data-lines=\"151,174\"><code data-lines=\"151,174\"><span class=\"hljs-keyword\">function</span> mapSingleChildIntoContext(bookKeeping, child, childKey) {\n  const { result, keyPrefix, func, <span class=\"hljs-keyword\">context</span> } = bookKeeping\n\n  <span class=\"hljs-keyword\">let</span> mappedChild = func.call(<span class=\"hljs-keyword\">context</span>, child, bookKeeping<span class=\"hljs-built_in\">.count</span>++)\n  <span class=\"hljs-keyword\">if</span> (Array.isArray(mappedChild)) {\n    mapIntoWithKeyPrefixInternal(mappedChild, result, childKey, c =&gt; c)\n  } <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span> (mappedChild != null) {\n    <span class=\"hljs-keyword\">if</span> (isValidElement(mappedChild)) {\n      mappedChild = cloneAndReplaceKey(\n        mappedChild,\n        keyPrefix +\n          (mappedChild<span class=\"hljs-built_in\">.key</span> &amp;&amp; (!child || child<span class=\"hljs-built_in\">.key</span> !== mappedChild<span class=\"hljs-built_in\">.key</span>)\n            ? escapeUserProvidedKey(mappedChild<span class=\"hljs-built_in\">.key</span>) + <span class=\"hljs-string\">&apos;/&apos;</span>\n            : <span class=\"hljs-string\">&apos;&apos;</span>) +\n          childKey,\n      )\n    }\n    result.push(mappedChild)\n  }\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"151,174"}},{"content":"<pre data-lines=\"175,185\"><code>`mapSingleChildIntoContext`&#x8fd9;&#x4e2a;&#x65b9;&#x6cd5;&#x5176;&#x5b9e;&#x5c31;&#x662f;&#x8c03;&#x7528;`React.Children.map(children, callback)`&#x8fd9;&#x91cc;&#x7684;`callback`&#xff0c;&#x5c31;&#x662f;&#x6211;&#x4eec;&#x4f20;&#x5165;&#x7684;&#x7b2c;&#x4e8c;&#x4e2a;&#x53c2;&#x6570;&#xff0c;&#x5e76;&#x5f97;&#x5230;`map`&#x4e4b;&#x540e;&#x7684;&#x7ed3;&#x679c;&#x3002;&#x6ce8;&#x610f;&#x91cd;&#x70b9;&#x6765;&#x4e86;&#xff0c;**&#x5982;&#x679c;`map`&#x4e4b;&#x540e;&#x7684;&#x8282;&#x70b9;&#x8fd8;&#x662f;&#x4e00;&#x4e2a;&#x6570;&#x7ec4;&#xff0c;&#x90a3;&#x4e48;&#x518d;&#x6b21;&#x8fdb;&#x5165;`mapIntoWithKeyPrefixInternal`&#xff0c;&#x90a3;&#x4e48;&#x8fd9;&#x4e2a;&#x65f6;&#x5019;&#x6211;&#x4eec;&#x5c31;&#x4f1a;&#x518d;&#x6b21;&#x4ece;`pool`&#x91cc;&#x9762;&#x53bb;`context`&#x4e86;&#xff0c;&#x800c;`pool`&#x7684;&#x610f;&#x4e49;&#x5927;&#x6982;&#x4e5f;&#x5c31;&#x662f;&#x5728;&#x8fd9;&#x91cc;&#x4e86;&#xff0c;&#x5982;&#x679c;&#x5faa;&#x73af;&#x5d4c;&#x5957;&#x591a;&#x4e86;&#xff0c;&#x53ef;&#x4ee5;&#x51cf;&#x5c11;&#x5f88;&#x591a;&#x5bf9;&#x8c61;&#x521b;&#x5efa;&#x548c;`gc`&#x7684;&#x635f;&#x8017;&#x3002;** \n\n&#x800c;&#x5982;&#x679c;&#x4e0d;&#x662f;&#x6570;&#x7ec4;&#x5e76;&#x4e14;&#x662f;&#x4e00;&#x4e2a;&#x5408;&#x89c4;&#x7684;`ReactElement`&#xff0c;&#x5c31;&#x89e6;&#x8fbe;&#x9876;&#x70b9;&#x4e86;&#xff0c;&#x66ff;&#x6362;&#x4e00;&#x4e0b;`key`&#x5c31;&#x63a8;&#x5165;`result`&#x4e86;&#x3002;\n\nReact &#x8fd9;&#x4e48;&#x5b9e;&#x73b0;&#x4e3b;&#x8981;&#x662f;&#x4e24;&#x4e2a;&#x76ee;&#x7684;&#xff1a;\n\n1.  &#x62c6;&#x5206;`map`&#x51fa;&#x6765;&#x7684;&#x6570;&#x7ec4;\n2.  &#x56e0;&#x4e3a;&#x5bf9;`Children`&#x7684;&#x5904;&#x7406;&#x4e00;&#x822c;&#x5728;`render`&#x91cc;&#x9762;&#xff0c;&#x6240;&#x4ee5;&#x4f1a;&#x6bd4;&#x8f83;&#x9891;&#x7e41;&#xff0c;&#x6240;&#x4ee5;&#x8bbe;&#x7f6e;&#x4e00;&#x4e2a;`pool`&#x51cf;&#x5c11;&#x58f0;&#x660e;&#x548c;`gc`&#x7684;&#x5f00;&#x9500;\n\n&#x8fd9;&#x5c31;&#x662f;`Children.map`&#x7684;&#x5b9e;&#x73b0;&#xff0c;&#x867d;&#x7136;&#x4e0d;&#x7b97;&#x4ec0;&#x4e48;&#x7279;&#x522b;&#x795e;&#x5947;&#x7684;&#x4ee3;&#x7801;&#xff0c;&#x4f46;&#x662f;&#x9605;&#x8bfb;&#x4e00;&#x4e0b;&#x8fd8;&#x662f;&#x633a;&#x6709;&#x610f;&#x601d;&#x7684;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"175,185"}}],"payload":{"tag":"h3","lines":"10,11"}}],"payload":{"tag":"h1","lines":"0,1"}},{})</script>
</body>
</html>
