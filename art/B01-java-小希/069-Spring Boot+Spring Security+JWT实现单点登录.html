<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets@11.11.1/styles/default.min.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.18.10/dist/browser/index.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/index.js"></script><script>(r => {
              setTimeout(r);
            })(function renderToolbar() {
  const {
    markmap,
    mm
  } = window;
  const {
    el
  } = markmap.Toolbar.create(mm);
  el.setAttribute('style', 'position:absolute;bottom:20px;right:20px');
  document.body.append(el);
})</script><script>((getMarkmap, getOptions, root2, jsonOptions) => {
              const markmap = getMarkmap();
              window.mm = markmap.Markmap.create(
                "svg#mindmap",
                (getOptions || markmap.deriveOptions)(jsonOptions),
                root2
              );
            })(() => window.markmap,null,{"content":"Spring Boot+Spring Security+JWT&#x5b9e;&#x73b0;&#x5355;&#x70b9;&#x767b;&#x5f55;","children":[{"content":"1.1&#x3001;SSO","children":[{"content":"<pre data-lines=\"5,12\"><code>SSO&#x672f;&#x8bed;&#x4ecb;&#x7ecd;&#xff1a;\n\n[&#x5355;&#x70b9;&#x767b;&#x5f55;](https://so.csdn.net/so/search?q=%E5%8D%95%E7%82%B9%E7%99%BB%E5%BD%95&amp;spm=1001.2101.3001.7020)(SingleSignOn&#xff0c;SSO)&#xff0c;&#x5c31;&#x662f;&#x901a;&#x8fc7;&#x7528;&#x6237;&#x7684;&#x4e00;&#x6b21;&#x6027;&#x9274;&#x522b;&#x767b;&#x5f55;&#x3002;&#x5f53;&#x7528;&#x6237;&#x5728;&#x8eab;&#x4efd;&#x8ba4;&#x8bc1;&#x670d;&#x52a1;&#x5668;&#x4e0a;&#x767b;&#x5f55;&#x4e00;&#x6b21;&#x4ee5;&#x540e;&#xff0c;&#x5373;&#x53ef;&#x83b7;&#x5f97;&#x8bbf;&#x95ee;&#x5355;&#x70b9;&#x767b;&#x5f55;&#x7cfb;&#x7edf;&#x4e2d;&#x5176;&#x4ed6;&#x5173;&#x8054;&#x7cfb;&#x7edf;&#x548c;&#x5e94;&#x7528;&#x8f6f;&#x4ef6;&#x7684;&#x6743;&#x9650;&#xff0c;&#x540c;&#x65f6;&#x8fd9;&#x79cd;&#x5b9e;&#x73b0;&#x662f;&#x4e0d;&#x9700;&#x8981;&#x7ba1;&#x7406;&#x5458;&#x5bf9;&#x7528;&#x6237;&#x7684;&#x767b;&#x5f55;&#x72b6;&#x6001;&#x6216;&#x5176;&#x4ed6;&#x4fe1;&#x606f;&#x8fdb;&#x884c;&#x4fee;&#x6539;&#x7684;&#xff0c;&#x8fd9;&#x610f;&#x5473;&#x7740;&#x5728;&#x591a;&#x4e2a;&#x5e94;&#x7528;&#x7cfb;&#x7edf;&#x4e2d;&#xff0c;&#x7528;&#x6237;&#x53ea;&#x9700;&#x4e00;&#x6b21;&#x767b;&#x5f55;&#x5c31;&#x53ef;&#x4ee5;&#x8bbf;&#x95ee;&#x6240;&#x6709;&#x76f8;&#x4e92;&#x4fe1;&#x4efb;&#x7684;&#x5e94;&#x7528;&#x7cfb;&#x7edf;&#x3002;&#x8fd9;&#x79cd;&#x65b9;&#x5f0f;&#x51cf;&#x5c11;&#x4e86;&#x7531;&#x767b;&#x5f55;&#x4ea7;&#x751f;&#x7684;&#x65f6;&#x95f4;&#x6d88;&#x8017;&#xff0c;&#x8f85;&#x52a9;&#x4e86;&#x7528;&#x6237;&#x7ba1;&#x7406;&#xff0c;&#x662f;&#x76ee;&#x524d;&#x6bd4;&#x8f83;&#x6d41;&#x884c;&#x7684;&#x4e00;&#x79cd;&#x5206;&#x5e03;&#x5f0f;&#x767b;&#x5f55;&#x65b9;&#x5f0f;&#x3002;\n\nSSO&#x5b9e;&#x73b0;&#x6d41;&#x7a0b;&#xff1a;\n\n&#x9996;&#x5148;&#xff0c;&#x6211;&#x4eec;&#x8981;&#x660e;&#x786e;&#xff0c;&#x5728;&#x5206;&#x5e03;&#x5f0f;&#x9879;&#x76ee;&#x4e2d;&#xff0c;&#x6bcf;&#x53f0;&#x670d;&#x52a1;&#x5668;&#x90fd;&#x6709;&#x5404;&#x81ea;&#x72ec;&#x7acb;&#x7684;session&#xff0c;&#x800c;&#x8fd9;&#x4e9b;session&#x4e4b;&#x95f4;&#x662f;&#x65e0;&#x6cd5;&#x76f4;&#x63a5;&#x5171;&#x4eab;&#x8d44;&#x6e90;&#x7684;&#xff0c;&#x6240;&#x4ee5;&#xff0c;session&#x901a;&#x5e38;&#x4e0d;&#x80fd;&#x88ab;&#x4f5c;&#x4e3a;&#x5355;&#x70b9;&#x767b;&#x5f55;&#x7684;&#x6280;&#x672f;&#x65b9;&#x6848;&#x3002;&#x6700;&#x5408;&#x7406;&#x7684;&#x5355;&#x70b9;&#x767b;&#x5f55;&#x65b9;&#x6848;&#x6d41;&#x7a0b;&#x5982;&#x4e0b;&#x56fe;&#x6240;&#x793a;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"5,12"}},{"content":"<img src=\"https://img-blog.csdnimg.cn/img_convert/678b989efc79d06a1ac1d1107b6cb22d.png\" alt>","children":[],"payload":{"tag":"img","lines":"13,14"}},{"content":"<pre data-lines=\"15,19\"><code>&#x5355;&#x70b9;&#x767b;&#x5f55;&#x7684;&#x5b9e;&#x73b0;&#x5206;&#x4e24;&#x5927;&#x73af;&#x8282;&#xff1a;\n\n*   &#x7528;&#x6237;&#x8ba4;&#x8bc1;&#xff1a;&#x8fd9;&#x4e00;&#x73af;&#x8282;&#x4e3b;&#x8981;&#x662f;&#x7528;&#x6237;&#x5411;&#x8ba4;&#x8bc1;&#x670d;&#x52a1;&#x5668;&#x53d1;&#x8d77;&#x8ba4;&#x8bc1;&#x8bf7;&#x6c42;&#xff0c;&#x8ba4;&#x8bc1;&#x670d;&#x52a1;&#x5668;&#x7ed9;&#x7528;&#x6237;&#x8fd4;&#x56de;&#x4e00;&#x4e2a;&#x6210;&#x529f;&#x7684;&#x4ee4;&#x724c;token&#xff0c; &#x4e3b;&#x8981;&#x5728;&#x8ba4;&#x8bc1;&#x670d;&#x52a1;&#x5668;&#x4e2d;&#x5b8c;&#x6210;&#xff0c;&#x5373;&#x56fe;&#x4e2d;&#x7684;A&#x7cfb;&#x7edf;&#xff0c;&#x6ce8;&#x610f;A&#x7cfb;&#x7edf;&#x53ea;&#x80fd;&#x6709;&#x4e00;&#x4e2a;&#x3002;\n*   &#x8eab;&#x4efd;&#x6821;&#x9a8c;&#xff1a;&#x8fd9;&#x4e00;&#x73af;&#x8282;&#x662f;&#x7528;&#x6237;&#x643a;&#x5e26;token&#x53bb;&#x8bbf;&#x95ee;&#x5176;&#x4ed6;&#x670d;&#x52a1;&#x5668;&#x65f6;&#xff0c;&#x5728;&#x5176;&#x4ed6;&#x670d;&#x52a1;&#x5668;&#x4e2d;&#x8981;&#x5bf9;token&#x7684;&#x771f;&#x4f2a;&#x8fdb;&#x884c;&#x68c0;&#x9a8c;&#xff0c;&#x4e3b;&#x8981;&#x5728;&#x8d44;&#x6e90;&#x670d;&#x52a1;&#x5668;&#x4e2d;&#x5b8c;&#x6210;&#xff0c;&#x5373;&#x56fe;&#x4e2d;&#x7684;B&#x7cfb;&#x7edf;&#xff0c;&#x8fd9;&#x91cc;B&#x7cfb;&#x7edf;&#x53ef;&#x4ee5;&#x6709;&#x5f88;&#x591a;&#x4e2a;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"15,19"}}],"payload":{"tag":"h2","lines":"2,4"}},{"content":"1.2&#x3001;JWT","children":[{"content":"<pre data-lines=\"23,32\"><code>&#x4ece;&#x5206;&#x5e03;&#x5f0f;&#x8ba4;&#x8bc1;&#x6d41;&#x7a0b;&#x4e2d;&#xff0c;&#x6211;&#x4eec;&#x4e0d;&#x96be;&#x53d1;&#x73b0;&#xff0c;&#x8fd9;&#x4e2d;&#x95f4;&#x8d77;&#x6700;&#x5173;&#x952e;&#x4f5c;&#x7528;&#x7684;&#x5c31;&#x662f;token&#xff0c;token&#x7684;&#x5b89;&#x5168;&#x4e0e;&#x5426;&#xff0c;&#x76f4;&#x63a5;&#x5173;&#x7cfb;&#x5230;&#x7cfb;&#x7edf;&#x7684;&#x5065;&#x58ee;&#x6027;&#xff0c;&#x8fd9;&#x91cc;&#x6211;&#x4eec;&#x9009;&#x62e9;&#x4f7f;&#x7528;JWT&#x6765;&#x5b9e;&#x73b0;token&#x7684;&#x751f;&#x6210;&#x548c;&#x6821;&#x9a8c;&#x3002;JWT&#xff0c;&#x5168;&#x79f0;JSON Web Token&#xff0c;&#x5b98;&#x7f51;&#x5730;&#x5740;&#xff1a;https://jwt.io&#xff0c;&#x662f;&#x4e00;&#x6b3e;&#x51fa;&#x8272;&#x7684;&#x5206;&#x5e03;&#x5f0f;&#x8eab;&#x4efd;&#x6821;&#x9a8c;&#x65b9;&#x6848;&#xff0c;&#x53ef;&#x4ee5;&#x751f;&#x6210;token&#xff0c;&#x4e5f;&#x53ef;&#x4ee5;&#x89e3;&#x6790;&#x68c0;&#x9a8c;token&#x3002;\n\nJWT&#x751f;&#x6210;&#x7684;token&#x7531;&#x4e09;&#x90e8;&#x5206;&#x7ec4;&#x6210;&#xff1a;\n\n*   &#x5934;&#x90e8;&#xff1a;&#x4e3b;&#x8981;&#x8bbe;&#x7f6e;&#x4e00;&#x4e9b;&#x89c4;&#x8303;&#x4fe1;&#x606f;&#xff0c;&#x7b7e;&#x540d;&#x90e8;&#x5206;&#x7684;&#x7f16;&#x7801;&#x683c;&#x5f0f;&#x5c31;&#x5728;&#x5934;&#x90e8;&#x4e2d;&#x58f0;&#x660e;&#x3002;\n*   &#x8f7d;&#x8377;&#xff1a;token&#x4e2d;&#x5b58;&#x653e;&#x6709;&#x6548;&#x4fe1;&#x606f;&#x7684;&#x90e8;&#x5206;&#xff0c;&#x6bd4;&#x5982;&#x7528;&#x6237;&#x540d;&#xff0c;&#x7528;&#x6237;&#x89d2;&#x8272;&#xff0c;&#x8fc7;&#x671f;&#x65f6;&#x95f4;&#x7b49;&#xff0c;&#x4f46;&#x662f;&#x4e0d;&#x8981;&#x653e;&#x5bc6;&#x7801;&#xff0c;&#x4f1a;&#x6cc4;&#x9732;&#x5bc6;&#x7801;&#x3002;\n*   &#x7b7e;&#x540d;&#xff1a;&#x5c06;&#x5934;&#x90e8;&#x4e0e;&#x8f7d;&#x8377;&#x5206;&#x522b;&#x91c7;&#x7528;base64&#x7f16;&#x7801;&#x540e;&#xff0c;&#x7528;&#x201c;.&#x201d;&#x76f8;&#x8fde;&#xff0c;&#x518d;&#x52a0;&#x5165;&#x76d0;&#xff0c;&#x6700;&#x540e;&#x4f7f;&#x7528;&#x5934;&#x90e8;&#x58f0;&#x660e;&#x7684;&#x7f16;&#x7801;&#x7c7b;&#x578b;&#x8fdb;&#x884c;&#x7f16;&#x7801;&#xff0c;&#x5c31;&#x5f97;&#x5230;&#x4e86;&#x7b7e;&#x540d;&#x3002;\n\n&#x90a3;&#x4e48;&#xff0c;&#x4e00;&#x4e2a;&#x5b8c;&#x6574;&#x7684;jwt&#x5b57;&#x7b26;&#x4e32;&#x5230;&#x5e95;&#x957f;&#x6210;&#x4ec0;&#x4e48;&#x6837;&#x5462;&#xff1f;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"23,32"}},{"content":"<img src=\"https://img-blog.csdnimg.cn/img_convert/b851b38ed7b77a2faf736b64a90f8781.png\" alt>","children":[],"payload":{"tag":"img","lines":"33,34"}},{"content":"<pre data-lines=\"35,40\"><code>JWT&#x751f;&#x6210;&#x7684;token&#x7684;&#x5b89;&#x5168;&#x6027;&#x5206;&#x6790;&#xff1a;\n\n&#x4ece;JWT&#x751f;&#x6210;&#x7684;token&#x7ec4;&#x6210;&#x4e0a;&#x6765;&#x770b;&#xff0c;&#x8981;&#x60f3;&#x907f;&#x514d;token&#x88ab;&#x4f2a;&#x9020;&#xff0c;&#x4e3b;&#x8981;&#x5c31;&#x5f97;&#x770b;&#x7b7e;&#x540d;&#x90e8;&#x5206;&#x4e86;&#xff0c;&#x800c;&#x7b7e;&#x540d;&#x90e8;&#x5206;&#x53c8;&#x6709;&#x4e09;&#x90e8;&#x5206;&#x7ec4;&#x6210;&#xff0c;&#x5176;&#x4e2d;&#x5934;&#x90e8;&#x548c;&#x8f7d;&#x8377;&#x7684;base64&#x7f16;&#x7801;&#xff0c;&#x51e0;&#x4e4e;&#x662f;&#x900f;&#x660e;&#x7684;&#xff0c;&#x6beb;&#x65e0;&#x5b89;&#x5168;&#x6027;&#x53ef;&#x8a00;&#xff0c;&#x90a3;&#x4e48;&#x6700;&#x7ec8;&#x5b88;&#x62a4;token&#x5b89;&#x5168;&#x7684;&#x91cd;&#x62c5;&#x5c31;&#x843d;&#x5728;&#x4e86;&#x52a0;&#x5165;&#x7684;&#x76d0;&#x4e0a;&#x9762;&#x4e86;&#xff0c;&#x8bd5;&#x60f3;&#xff0c;&#x5982;&#x679c;&#x751f;&#x6210;token&#x6240;&#x7528;&#x7684;&#x76d0;&#x4e0e;&#x89e3;&#x6790;token&#x65f6;&#x52a0;&#x5165;&#x7684;&#x76d0;&#x662f;&#x4e00;&#x6837;&#x7684;&#x3002;&#x5c82;&#x4e0d;&#x662f;&#x7c7b;&#x4f3c;&#x4e8e;&#x4e2d;&#x56fd;&#x4eba;&#x6c11;&#x94f6;&#x884c;&#x628a;&#x4eba;&#x6c11;&#x5e01;&#x9632;&#x4f2a;&#x6280;&#x672f;&#x516c;&#x5f00;&#x4e86;&#xff1f;&#x5927;&#x5bb6;&#x53ef;&#x4ee5;&#x7528;&#x8fd9;&#x4e2a;&#x76d0;&#x6765;&#x89e3;&#x6790;token&#xff0c;&#x5c31;&#x80fd;&#x7528;&#x6765;&#x4f2a;&#x9020;token&#x3002; &#x8fd9;&#x65f6;&#xff0c;&#x6211;&#x4eec;&#x5c31;&#x9700;&#x8981;&#x5bf9;&#x76d0;&#x91c7;&#x7528;&#x975e;&#x5bf9;&#x79f0;&#x52a0;&#x5bc6;&#x7684;&#x65b9;&#x5f0f;&#x8fdb;&#x884c;&#x52a0;&#x5bc6;&#xff0c;&#x4ee5;&#x8fbe;&#x5230;&#x751f;&#x6210;token&#x4e0e;&#x6821;&#x9a8c;token&#x65b9;&#x6240;&#x7528;&#x7684;&#x76d0;&#x4e0d;&#x4e00;&#x81f4;&#x7684;&#x5b89;&#x5168;&#x6548;&#x679c;&#xff01;\n\n&gt; &#x6ce8;&#x610f;&#xff1a;&#x52a0;&#x76d0;&#x7684;&#x610f;&#x601d;&#x5c31;&#x662f;&#x8ba9;&#x5473;&#x9053;&#x6539;&#x53d8;&#xff0c;&#x4e5f;&#x5c31;&#x662f;&#x8ba9;&#x901a;&#x8fc7;&#x52a0;&#x76d0;&#x6765;&#x63d0;&#x9ad8;token&#x7684;&#x590d;&#x6742;&#x5ea6;&#xff0c;&#x8ba9;token&#x66f4;&#x52a0;&#x5b89;&#x5168;&#xff0c;&#x8fd9;&#x4e2a;&#x76d0;&#x4f60;&#x53ef;&#x4ee5;&#x4efb;&#x610f;&#x6307;&#x5b9a;&#xff0c;&#x5168;&#x51ed;&#x81ea;&#x5df1;&#x548c;&#x9879;&#x76ee;&#x9700;&#x6c42;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"35,40"}}],"payload":{"tag":"h2","lines":"20,22"}},{"content":"1.3&#x3001;RSA","children":[{"content":"<pre data-lines=\"44,62\"><code>RSA&#x672f;&#x8bed;&#x4ecb;&#x7ecd;&#xff1a;\n\n1976&#x5e74;&#xff0c;&#x4e24;&#x4f4d;&#x7f8e;&#x56fd;&#x8ba1;&#x7b97;&#x673a;&#x5b66;&#x5bb6;Whitfield Diffie &#x548c; Martin Hellman&#xff0c;&#x63d0;&#x51fa;&#x4e86;&#x4e00;&#x79cd;&#x5d2d;&#x65b0;&#x6784;&#x601d;&#xff0c;&#x53ef;&#x4ee5;&#x5728;&#x4e0d;&#x76f4;&#x63a5;&#x4f20;&#x9012;&#x5bc6;&#x94a5;&#x7684;&#x60c5;&#x51b5;&#x4e0b;&#xff0c;&#x5b8c;&#x6210;&#x89e3;&#x5bc6;&#x3002;&#x8fd9;&#x88ab;&#x79f0;&#x4e3a;&quot;Diffie-Hellman&#x5bc6;&#x94a5;&#x4ea4;&#x6362;&#x7b97;&#x6cd5;&quot;&#x3002;&#x8fd9;&#x4e2a;&#x7b97;&#x6cd5;&#x542f;&#x53d1;&#x4e86;&#x5176;&#x4ed6;&#x79d1;&#x5b66;&#x5bb6;&#x3002;&#x4eba;&#x4eec;&#x8ba4;&#x8bc6;&#x5230;&#xff0c;&#x52a0;&#x5bc6;&#x548c;&#x89e3;&#x5bc6;&#x53ef;&#x4ee5;&#x4f7f;&#x7528;&#x4e0d;&#x540c;&#x7684;&#x89c4;&#x5219;&#xff0c;&#x53ea;&#x8981;&#x8fd9;&#x4e24;&#x79cd;&#x89c4;&#x5219;&#x4e4b;&#x95f4;&#x5b58;&#x5728;&#x67d0;&#x79cd;&#x5bf9;&#x5e94;&#x5173;&#x7cfb;&#x5373;&#x53ef;&#xff0c;&#x8fd9;&#x6837;&#x5c31;&#x907f;&#x514d;&#x4e86;&#x76f4;&#x63a5;&#x4f20;&#x9012;&#x5bc6;&#x94a5;&#x3002;&#x8fd9;&#x79cd;&#x65b0;&#x7684;&#x52a0;&#x5bc6;&#x6a21;&#x5f0f;&#x88ab;&#x79f0;&#x4e3a;&quot;&#x975e;&#x5bf9;&#x79f0;&#x52a0;&#x5bc6;&#x7b97;&#x6cd5;&quot;&#x3002;\n\n*   &#xff08;1&#xff09;&#x4e59;&#x65b9;&#x751f;&#x6210;&#x4e24;&#x628a;&#x5bc6;&#x94a5;&#xff08;&#x516c;&#x94a5;&#x548c;&#x79c1;&#x94a5;&#xff09;&#x3002;&#x516c;&#x94a5;&#x662f;&#x516c;&#x5f00;&#x7684;&#xff0c;&#x4efb;&#x4f55;&#x4eba;&#x90fd;&#x53ef;&#x4ee5;&#x83b7;&#x5f97;&#xff0c;&#x79c1;&#x94a5;&#x5219;&#x662f;&#x4fdd;&#x5bc6;&#x7684;&#x3002;\n*   &#xff08;2&#xff09;&#x7532;&#x65b9;&#x83b7;&#x53d6;&#x4e59;&#x65b9;&#x7684;&#x516c;&#x94a5;&#xff0c;&#x7136;&#x540e;&#x7528;&#x5b83;&#x5bf9;&#x4fe1;&#x606f;&#x52a0;&#x5bc6;&#x3002;\n*   &#xff08;3&#xff09;&#x4e59;&#x65b9;&#x5f97;&#x5230;&#x52a0;&#x5bc6;&#x540e;&#x7684;&#x4fe1;&#x606f;&#xff0c;&#x7528;&#x79c1;&#x94a5;&#x89e3;&#x5bc6;&#x3002;\n\nRSA&#x662f;1977&#x5e74;&#x7531;&#x7f57;&#x7eb3;&#x5fb7;&#xb7;&#x674e;&#x7ef4;&#x65af;&#x7279;&#xff08;Ron Rivest&#xff09;&#x3001;&#x963f;&#x8fea;&#xb7;&#x8428;&#x83ab;&#x5c14;&#xff08;Adi Shamir&#xff09;&#x548c;&#x4f26;&#x7eb3;&#x5fb7;&#xb7;&#x963f;&#x5fb7;&#x66fc;&#xff08;Leonard Adleman&#xff09;&#x4e00;&#x8d77;&#x63d0;&#x51fa;&#x7684;&#xff0c;&#x5f53;&#x65f6;&#x4ed6;&#x4eec;&#x4e09;&#x4eba;&#x90fd;&#x5728;&#x9ebb;&#x7701;&#x7406;&#x5de5;&#x5b66;&#x9662;&#x5de5;&#x4f5c;&#xff0c;RSA&#x5c31;&#x662f;&#x4ed6;&#x4eec;&#x4e09;&#x4eba;&#x59d3;&#x6c0f;&#x5f00;&#x5934;&#x5b57;&#x6bcd;&#x62fc;&#x5728;&#x4e00;&#x8d77;&#x7ec4;&#x6210;&#x7684; &#x3002;&#x4ece;&#x90a3;&#x65f6;&#x76f4;&#x5230;&#x73b0;&#x5728;&#xff0c;RSA&#x7b97;&#x6cd5;&#x4e00;&#x76f4;&#x662f;&#x6700;&#x5e7f;&#x4e3a;&#x4f7f;&#x7528;&#x7684;&quot;&#x975e;&#x5bf9;&#x79f0;&#x52a0;&#x5bc6;&#x7b97;&#x6cd5;&quot;&#x3002;&#x6beb;&#x4e0d;&#x5938;&#x5f20;&#x5730;&#x8bf4;&#xff0c;&#x53ea;&#x8981;&#x6709;&#x8ba1;&#x7b97;&#x673a;&#x7f51;&#x7edc;&#x7684;&#x5730;&#x65b9;&#xff0c;&#x5c31;&#x6709;RSA&#x7b97;&#x6cd5;&#x3002;&#x8fd9;&#x79cd;&#x7b97;&#x6cd5;&#x975e;&#x5e38;&#x53ef;&#x9760;&#xff0c;&#x5bc6;&#x94a5;&#x8d8a;&#x957f;&#xff0c;&#x5b83;&#x5c31;&#x8d8a;&#x96be;&#x7834;&#x89e3;&#x3002;&#x6839;&#x636e;&#x5df2;&#x7ecf;&#x62ab;&#x9732;&#x7684;&#x6587;&#x732e;&#xff0c;&#x76ee;&#x524d;&#x88ab;&#x7834;&#x89e3;&#x7684;&#x6700;&#x957f;RSA&#x5bc6;&#x94a5;&#x662f;768&#x4e2a;&#x4e8c;&#x8fdb;&#x5236;&#x4f4d;&#x3002;&#x4e5f;&#x5c31;&#x662f;&#x8bf4;&#xff0c;&#x957f;&#x5ea6;&#x8d85;&#x8fc7;768&#x4f4d;&#x7684;&#x5bc6;&#x94a5;&#xff0c;&#x8fd8;&#x65e0;&#x6cd5;&#x7834;&#x89e3;&#xff08;&#x81f3;&#x5c11;&#x6ca1;&#x4eba;&#x516c;&#x5f00;&#x5ba3;&#x5e03;&#xff09;&#x3002;&#x56e0;&#x6b64;&#x53ef;&#x4ee5;&#x8ba4;&#x4e3a;&#xff0c;1024&#x4f4d;&#x7684;RSA&#x5bc6;&#x94a5;&#x57fa;&#x672c;&#x5b89;&#x5168;&#xff0c;2048&#x4f4d;&#x7684;&#x5bc6;&#x94a5;&#x6781;&#x5176;&#x5b89;&#x5168;&#x3002;\n\nRSA&#x4f7f;&#x7528;&#x6d41;&#x7a0b;&#xff1a;\n\n&#x57fa;&#x672c;&#x4f7f;&#x7528;&#x6d41;&#x7a0b;&#xff0c;&#x540c;&#x65f6;&#x751f;&#x6210;&#x4e24;&#x628a;&#x5bc6;&#x94a5;&#xff1a;&#x79c1;&#x94a5;&#x548c;&#x516c;&#x94a5;&#xff0c;&#x79c1;&#x94a5;&#x4fdd;&#x5b58;&#x8d77;&#x6765;&#xff0c;&#x516c;&#x94a5;&#x53ef;&#x4ee5;&#x4e0b;&#x53d1;&#x7ed9;&#x4fe1;&#x4efb;&#x5ba2;&#x6237;&#x7aef;\n\n*   &#x79c1;&#x94a5;&#x52a0;&#x5bc6;&#xff0c;&#x6301;&#x6709;&#x79c1;&#x94a5;&#x6216;&#x516c;&#x94a5;&#x624d;&#x53ef;&#x4ee5;&#x89e3;&#x5bc6;\n*   &#x516c;&#x94a5;&#x52a0;&#x5bc6;&#xff0c;&#x6301;&#x6709;&#x79c1;&#x94a5;&#x624d;&#x53ef;&#x89e3;&#x5bc6;\n\n&#x56e0;&#x6b64;&#xff0c;&#x6211;&#x4eec;&#x8ba4;&#x8bc1;&#x670d;&#x52a1;&#x4e00;&#x822c;&#x5b58;&#x653e;&#x79c1;&#x94a5;&#x548c;&#x516c;&#x94a5;&#xff0c;&#x800c;&#x8d44;&#x6e90;&#x670d;&#x52a1;&#x4e00;&#x822c;&#x5b58;&#x653e;&#x516c;&#x94a5;&#x3002;&#x79c1;&#x94a5;&#x8d1f;&#x8d23;&#x52a0;&#x5bc6;&#xff0c;&#x516c;&#x94a5;&#x8d1f;&#x8d23;&#x89e3;&#x5bc6;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"44,62"}},{"content":"<img src=\"https://img-blog.csdnimg.cn/img_convert/c61aa8b2a2a068f665e8879f451ff4ca.png\" alt>","children":[],"payload":{"tag":"img","lines":"63,64"}}],"payload":{"tag":"h2","lines":"41,43"}},{"content":"2.1&#x3001;&#x5206;&#x6790;&#x96c6;&#x4e2d;&#x5f0f;&#x8ba4;&#x8bc1;&#x6d41;&#x7a0b;","children":[{"content":"&#x7528;&#x6237;&#x8ba4;&#x8bc1;&#xff1a;&#x4f7f;&#x7528;UsernamePasswordAuthenticationFilter&#x8fc7;&#x6ee4;&#x5668;&#x4e2d;attemptAuthentication&#x65b9;&#x6cd5;&#x5b9e;&#x73b0;&#x8ba4;&#x8bc1;&#x529f;&#x80fd;&#xff0c;&#x8be5;&#x8fc7;&#x6ee4;&#x5668;&#x7236;&#x7c7b;&#x4e2d;successfulAuthentication&#x65b9;&#x6cd5;&#x5b9e;&#x73b0;&#x8ba4;&#x8bc1;&#x6210;&#x529f;&#x540e;&#x7684;&#x64cd;&#x4f5c;&#x3002;","children":[],"payload":{"tag":"li","lines":"68,69"}},{"content":"&#x8eab;&#x4efd;&#x6821;&#x9a8c;&#xff1a;&#x4f7f;&#x7528;BasicAuthenticationFilter&#x8fc7;&#x6ee4;&#x5668;&#x4e2d;doFilterInternal&#x65b9;&#x6cd5;&#x9a8c;&#x8bc1;&#x662f;&#x5426;&#x767b;&#x5f55;&#xff0c;&#x4ee5;&#x51b3;&#x5b9a;&#x80fd;&#x5426;&#x8fdb;&#x5165;&#x540e;&#x7eed;&#x8fc7;&#x6ee4;&#x5668;&#x3002;","children":[],"payload":{"tag":"li","lines":"69,71"}}],"payload":{"tag":"h2","lines":"65,67"}},{"content":"2.2&#x3001;&#x5206;&#x6790;&#x5206;&#x5e03;&#x5f0f;&#x8ba4;&#x8bc1;&#x6d41;&#x7a0b;","children":[{"content":"&#x7528;&#x6237;&#x8ba4;&#x8bc1;&#xff1a;&#x5206;&#x5e03;&#x5f0f;&#x9879;&#x76ee;&#x591a;&#x6570;&#x662f;&#x524d;&#x540e;&#x7aef;&#x5206;&#x79bb;&#x7684;&#x67b6;&#x6784;&#x8bbe;&#x8ba1;&#xff0c;&#x6211;&#x4eec;&#x8981;&#x6ee1;&#x8db3;&#x53ef;&#x4ee5;&#x63a5;&#x53d7;&#x5f02;&#x6b65;post&#x7684;&#x8ba4;&#x8bc1;&#x8bf7;&#x6c42;&#x53c2;&#x6570;&#xff0c;&#x9700;&#x8981;&#x4fee;&#x6539;UsernamePasswordAuthenticationFilter&#x8fc7;&#x6ee4;&#x5668;&#x4e2d;attemptAuthentication&#x65b9;&#x6cd5;&#xff0c;&#x8ba9;&#x5176;&#x80fd;&#x591f;&#x63a5;&#x6536;&#x8bf7;&#x6c42;&#x4f53;&#x3002;&#x53e6;&#x5916;&#xff0c;&#x9ed8;&#x8ba4;successfulAuthentication&#x65b9;&#x6cd5;&#x5728;&#x8ba4;&#x8bc1;&#x901a;&#x8fc7;&#x540e;&#xff0c;&#x662f;&#x628a;&#x7528;&#x6237;&#x4fe1;&#x606f;&#x76f4;&#x63a5;&#x653e;&#x5165;session&#x5c31;&#x5b8c;&#x4e8b;&#x4e86;&#xff0c;&#x73b0;&#x5728;&#x6211;&#x4eec;&#x9700;&#x8981;&#x4fee;&#x6539;&#x8fd9;&#x4e2a;&#x65b9;&#x6cd5;&#xff0c;&#x5728;&#x8ba4;&#x8bc1;&#x901a;&#x8fc7;&#x540e;&#x751f;&#x6210;token&#x5e76;&#x8fd4;&#x56de;&#x7ed9;&#x7528;&#x6237;&#x3002;","children":[],"payload":{"tag":"li","lines":"74,75"}},{"content":"&#x8eab;&#x4efd;&#x6821;&#x9a8c;&#xff1a; &#x539f;&#x6765;BasicAuthenticationFilter&#x8fc7;&#x6ee4;&#x5668;&#x4e2d;doFilterInternal&#x65b9;&#x6cd5;&#x6821;&#x9a8c;&#x7528;&#x6237;&#x662f;&#x5426;&#x767b;&#x5f55;&#xff0c;&#x5c31;&#x662f;&#x770b;session&#x4e2d;&#x662f;&#x5426;&#x6709;&#x7528;&#x6237;&#x4fe1;&#x606f;&#xff0c;&#x6211;&#x4eec;&#x8981;&#x4fee;&#x6539;&#x4e3a;&#xff0c;&#x9a8c;&#x8bc1;&#x7528;&#x6237;&#x643a;&#x5e26;&#x7684;token&#x662f;&#x5426;&#x5408;&#x6cd5;&#xff0c;&#x5e76;&#x89e3;&#x6790;&#x51fa;&#x7528;&#x6237;&#x4fe1;&#x606f;&#xff0c;&#x4ea4;&#x7ed9;SpringSecurity&#xff0c;&#x4ee5;&#x4fbf;&#x4e8e;&#x540e;&#x7eed;&#x7684;&#x6388;&#x6743;&#x529f;&#x80fd;&#x53ef;&#x4ee5;&#x6b63;&#x5e38;&#x4f7f;&#x7528;&#x3002;","children":[],"payload":{"tag":"li","lines":"75,77"}}],"payload":{"tag":"h2","lines":"71,73"}},{"content":"3.1&#x3001;&#x4ecb;&#x7ecd;&#x7236;&#x5de5;&#x7a0b;","children":[{"content":"<pre data-lines=\"80,81\"><code>&#x4e3a;&#x4e86;&#x65b9;&#x4fbf;&#x5927;&#x5bb6;&#x80fd;&#x591f;&#x5feb;&#x901f;&#x8fdb;&#x884c;&#x5b66;&#x4e60;&#xff0c;&#x6211;&#x5df2;&#x7ecf;&#x63d0;&#x524d;&#x642d;&#x5efa;&#x597d;&#x4e86;&#x4e00;&#x4e2a;&#x57fa;&#x672c;&#x5de5;&#x7a0b;&#xff0c;&#x5de5;&#x7a0b;&#x4ee3;&#x7801;&#x5728;&#x914d;&#x5957;&#x8d44;&#x6599;&#x4e2d;&#xff0c;&#x540d;&#x79f0;&#x53eb;`&#x5355;&#x70b9;&#x767b;&#x5f55;&#x57fa;&#x7840;&#x4ee3;&#x7801;`&#xff0c;&#x8fd9;&#x53ea;&#x662f;&#x4e00;&#x4e2a;&#x666e;&#x901a;&#x7684;`Spring Boot`&#x5de5;&#x7a0b;&#xff0c;&#x8be5;&#x5de5;&#x7a0b;&#x7531;&#x56db;&#x4e2a;&#x5b50;&#x6a21;&#x5757;&#x7ec4;&#x6210;&#xff0c;&#x4e00;&#x4e2a;&#x8ba4;&#x8bc1;&#x670d;&#x52a1;&#x6a21;&#x5757;&#xff0c;&#x4e00;&#x4e2a;&#x901a;&#x7528;&#x5de5;&#x5177;&#x6a21;&#x5757;&#xff0c;&#x4e00;&#x4e2a;&#x8ba2;&#x5355;&#x8d44;&#x6e90;&#x6a21;&#x5757;&#xff0c;&#x4e00;&#x4e2a;&#x4ea7;&#x54c1;&#x8d44;&#x6e90;&#x6a21;&#x5757;&#xff0c;&#x6211;&#x5df2;&#x7ecf;&#x5e2e;&#x5927;&#x5bb6;&#x521b;&#x5efa;&#x597d;&#x4e86;&#x57fa;&#x672c;&#x7684;&#x5305;&#x7ed3;&#x6784;&#xff0c;&#x5e76;&#x5728;&#x7236;&#x5de5;&#x7a0b;&#x4e2d;&#x5bf9;`Spring Boot`&#x7684;&#x7248;&#x672c;&#x8fdb;&#x884c;&#x4e86;&#x7ba1;&#x7406;&#xff0c;&#x5728;&#x63a5;&#x4e0b;&#x6765;&#x7684;&#x4ee3;&#x7801;&#x5c55;&#x793a;&#x73af;&#x8282;&#x4e2d;&#xff0c;&#x6211;&#x5e76;&#x4e0d;&#x4f1a;&#x5c55;&#x793a;&#x5168;&#x90e8;&#x4ee3;&#x7801;&#xff0c;&#x6211;&#x53ea;&#x5c55;&#x793a;&#x6838;&#x5fc3;&#x4ee3;&#x7801;&#xff0c;&#x5b8c;&#x6574;&#x4ee3;&#x7801;&#x6211;&#x4f1a;&#x7ed9;&#x51fa;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"80,81"}},{"content":"<img src=\"https://img-blog.csdnimg.cn/img_convert/96edd6deab17b599cdc3b2846c7155ae.png\" alt>","children":[],"payload":{"tag":"img","lines":"82,83"}},{"content":"<img src=\"https://img-blog.csdnimg.cn/img_convert/62e31479d7966d6f93b269784723e5a4.png\" alt>","children":[],"payload":{"tag":"img","lines":"84,85"}}],"payload":{"tag":"h2","lines":"77,79"}},{"content":"3.2&#x3001;&#x5bfc;&#x5165;&#x6570;&#x636e;&#x5e93;","children":[{"content":"<pre data-lines=\"89,144\"><code class=\"language-sql\"><span class=\"hljs-keyword\">DROP</span> DATABASE IF <span class=\"hljs-keyword\">EXISTS</span> `test`;\n\n<span class=\"hljs-keyword\">CREATE</span> DATABASE `test`;\n\nUSE `test`;\n\n<span class=\"hljs-keyword\">DROP</span> <span class=\"hljs-keyword\">TABLE</span> IF <span class=\"hljs-keyword\">EXISTS</span> `sys_role`;\n\n<span class=\"hljs-keyword\">CREATE TABLE</span> `sys_role` (\n  `id` <span class=\"hljs-type\">INT</span>(<span class=\"hljs-number\">11</span>) <span class=\"hljs-keyword\">NOT NULL</span> AUTO_INCREMENT COMMENT <span class=\"hljs-string\">&apos;&#x89d2;&#x8272;&#x7f16;&#x53f7;&apos;</span>,\n  `name` <span class=\"hljs-type\">VARCHAR</span>(<span class=\"hljs-number\">32</span>) <span class=\"hljs-keyword\">NOT NULL</span> COMMENT <span class=\"hljs-string\">&apos;&#x89d2;&#x8272;&#x540d;&#x79f0;&apos;</span>,\n  `<span class=\"hljs-keyword\">desc</span>` <span class=\"hljs-type\">VARCHAR</span>(<span class=\"hljs-number\">32</span>) <span class=\"hljs-keyword\">NOT NULL</span> COMMENT <span class=\"hljs-string\">&apos;&#x89d2;&#x8272;&#x63cf;&#x8ff0;&apos;</span>,\n  <span class=\"hljs-keyword\">PRIMARY KEY</span> (`id`)\n) ENGINE<span class=\"hljs-operator\">=</span>INNODB AUTO_INCREMENT<span class=\"hljs-operator\">=</span><span class=\"hljs-number\">5</span> <span class=\"hljs-keyword\">DEFAULT</span> CHARSET<span class=\"hljs-operator\">=</span>utf8;\n\n<span class=\"hljs-keyword\">INSERT  INTO</span> `sys_role`(`id`,`name`,`<span class=\"hljs-keyword\">desc</span>`) <span class=\"hljs-keyword\">VALUES</span> (<span class=\"hljs-number\">1</span>,<span class=\"hljs-string\">&apos;ROLE_USER&apos;</span>,<span class=\"hljs-string\">&apos;&#x7528;&#x6237;&#x6743;&#x9650;&apos;</span>);\n<span class=\"hljs-keyword\">INSERT  INTO</span> `sys_role`(`id`,`name`,`<span class=\"hljs-keyword\">desc</span>`) <span class=\"hljs-keyword\">VALUES</span> (<span class=\"hljs-number\">2</span>,<span class=\"hljs-string\">&apos;ROLE_ADMIN&apos;</span>,<span class=\"hljs-string\">&apos;&#x7ba1;&#x7406;&#x6743;&#x9650;&apos;</span>);\n<span class=\"hljs-keyword\">INSERT  INTO</span> `sys_role`(`id`,`name`,`<span class=\"hljs-keyword\">desc</span>`) <span class=\"hljs-keyword\">VALUES</span> (<span class=\"hljs-number\">3</span>,<span class=\"hljs-string\">&apos;ROLE_PRODUCT&apos;</span>,<span class=\"hljs-string\">&apos;&#x4ea7;&#x54c1;&#x6743;&#x9650;&apos;</span>);\n<span class=\"hljs-keyword\">INSERT  INTO</span> `sys_role`(`id`,`name`,`<span class=\"hljs-keyword\">desc</span>`) <span class=\"hljs-keyword\">VALUES</span> (<span class=\"hljs-number\">4</span>,<span class=\"hljs-string\">&apos;ROLE_ORDER&apos;</span>,<span class=\"hljs-string\">&apos;&#x8ba2;&#x5355;&#x6743;&#x9650;&apos;</span>);\n\n<span class=\"hljs-keyword\">DROP</span> <span class=\"hljs-keyword\">TABLE</span> IF <span class=\"hljs-keyword\">EXISTS</span> `sys_user`;\n\n<span class=\"hljs-keyword\">CREATE TABLE</span> `sys_user` (\n  `id` <span class=\"hljs-type\">INT</span>(<span class=\"hljs-number\">11</span>) <span class=\"hljs-keyword\">NOT NULL</span> AUTO_INCREMENT COMMENT <span class=\"hljs-string\">&apos;&#x7528;&#x6237;&#x7f16;&#x53f7;&apos;</span>,\n  `username` <span class=\"hljs-type\">VARCHAR</span>(<span class=\"hljs-number\">32</span>) <span class=\"hljs-keyword\">NOT NULL</span> COMMENT <span class=\"hljs-string\">&apos;&#x7528;&#x6237;&#x540d;&#x79f0;&apos;</span>,\n  `password` <span class=\"hljs-type\">VARCHAR</span>(<span class=\"hljs-number\">128</span>) <span class=\"hljs-keyword\">NOT NULL</span> COMMENT <span class=\"hljs-string\">&apos;&#x7528;&#x6237;&#x5bc6;&#x7801;&apos;</span>,\n  `status` <span class=\"hljs-type\">INT</span>(<span class=\"hljs-number\">1</span>) <span class=\"hljs-keyword\">NOT NULL</span> <span class=\"hljs-keyword\">DEFAULT</span> <span class=\"hljs-string\">&apos;1&apos;</span> COMMENT <span class=\"hljs-string\">&apos;&#x7528;&#x6237;&#x72b6;&#x6001;&#xff08;0&#xff1a;&#x5173;&#x95ed;&#x3001;1&#xff1a;&#x5f00;&#x542f;&#xff09;&apos;</span>,\n  <span class=\"hljs-keyword\">PRIMARY KEY</span> (`id`)\n) ENGINE<span class=\"hljs-operator\">=</span>INNODB AUTO_INCREMENT<span class=\"hljs-operator\">=</span><span class=\"hljs-number\">4</span> <span class=\"hljs-keyword\">DEFAULT</span> CHARSET<span class=\"hljs-operator\">=</span>utf8;\n\n<span class=\"hljs-keyword\">INSERT  INTO</span> `sys_user`(`id`,`username`,`password`,`status`) <span class=\"hljs-keyword\">VALUES</span> (<span class=\"hljs-number\">1</span>,<span class=\"hljs-string\">&apos;zhangsan&apos;</span>,<span class=\"hljs-string\">&apos;&#x24;2a&#x24;10&#x24;M7fmKpMZEkkzrTBiKie.EeAKZhQDrWAltpCA1y/py5AU/8lyiNB8y&apos;</span>,<span class=\"hljs-number\">0</span>);\n<span class=\"hljs-keyword\">INSERT  INTO</span> `sys_user`(`id`,`username`,`password`,`status`) <span class=\"hljs-keyword\">VALUES</span> (<span class=\"hljs-number\">2</span>,<span class=\"hljs-string\">&apos;lisi&apos;</span>,<span class=\"hljs-string\">&apos;&#x24;2a&#x24;10&#x24;M7fmKpMZEkkzrTBiKie.EeAKZhQDrWAltpCA1y/py5AU/8lyiNB8y&apos;</span>,<span class=\"hljs-number\">1</span>);\n<span class=\"hljs-keyword\">INSERT  INTO</span> `sys_user`(`id`,`username`,`password`,`status`) <span class=\"hljs-keyword\">VALUES</span> (<span class=\"hljs-number\">3</span>,<span class=\"hljs-string\">&apos;wangwu&apos;</span>,<span class=\"hljs-string\">&apos;&#x24;2a&#x24;10&#x24;M7fmKpMZEkkzrTBiKie.EeAKZhQDrWAltpCA1y/py5AU/8lyiNB8y&apos;</span>,<span class=\"hljs-number\">2</span>);\n<span class=\"hljs-keyword\">INSERT  INTO</span> `sys_user`(`id`,`username`,`password`,`status`) <span class=\"hljs-keyword\">VALUES</span> (<span class=\"hljs-number\">4</span>,<span class=\"hljs-string\">&apos;zhaoliu&apos;</span>,<span class=\"hljs-string\">&apos;&#x24;2a&#x24;10&#x24;M7fmKpMZEkkzrTBiKie.EeAKZhQDrWAltpCA1y/py5AU/8lyiNB8y&apos;</span>,<span class=\"hljs-number\">3</span>);\n<span class=\"hljs-keyword\">INSERT  INTO</span> `sys_user`(`id`,`username`,`password`,`status`) <span class=\"hljs-keyword\">VALUES</span> (<span class=\"hljs-number\">5</span>,<span class=\"hljs-string\">&apos;xiaoqi&apos;</span>,<span class=\"hljs-string\">&apos;&#x24;2a&#x24;10&#x24;M7fmKpMZEkkzrTBiKie.EeAKZhQDrWAltpCA1y/py5AU/8lyiNB8y&apos;</span>,<span class=\"hljs-number\">4</span>);\n\n<span class=\"hljs-keyword\">DROP</span> <span class=\"hljs-keyword\">TABLE</span> IF <span class=\"hljs-keyword\">EXISTS</span> `sys_user_role`;\n\n<span class=\"hljs-keyword\">CREATE TABLE</span> `sys_user_role` (\n  `uid` <span class=\"hljs-type\">INT</span>(<span class=\"hljs-number\">11</span>) <span class=\"hljs-keyword\">NOT NULL</span> COMMENT <span class=\"hljs-string\">&apos;&#x7528;&#x6237;&#x7f16;&#x53f7;&apos;</span>,\n  `rid` <span class=\"hljs-type\">INT</span>(<span class=\"hljs-number\">11</span>) <span class=\"hljs-keyword\">NOT NULL</span> COMMENT <span class=\"hljs-string\">&apos;&#x89d2;&#x8272;&#x7f16;&#x53f7;&apos;</span>,\n  <span class=\"hljs-keyword\">PRIMARY KEY</span> (`uid`,`rid`)\n) ENGINE<span class=\"hljs-operator\">=</span>INNODB <span class=\"hljs-keyword\">DEFAULT</span> CHARSET<span class=\"hljs-operator\">=</span>utf8;\n\n<span class=\"hljs-keyword\">INSERT  INTO</span> `sys_user_role`(`uid`,`rid`) <span class=\"hljs-keyword\">VALUES</span> (<span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">1</span>);\n<span class=\"hljs-keyword\">INSERT  INTO</span> `sys_user_role`(`uid`,`rid`) <span class=\"hljs-keyword\">VALUES</span> (<span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">3</span>);\n<span class=\"hljs-keyword\">INSERT  INTO</span> `sys_user_role`(`uid`,`rid`) <span class=\"hljs-keyword\">VALUES</span> (<span class=\"hljs-number\">2</span>,<span class=\"hljs-number\">1</span>);\n<span class=\"hljs-keyword\">INSERT  INTO</span> `sys_user_role`(`uid`,`rid`) <span class=\"hljs-keyword\">VALUES</span> (<span class=\"hljs-number\">2</span>,<span class=\"hljs-number\">4</span>);\n<span class=\"hljs-keyword\">INSERT  INTO</span> `sys_user_role`(`uid`,`rid`) <span class=\"hljs-keyword\">VALUES</span> (<span class=\"hljs-number\">3</span>,<span class=\"hljs-number\">1</span>);\n<span class=\"hljs-keyword\">INSERT  INTO</span> `sys_user_role`(`uid`,`rid`) <span class=\"hljs-keyword\">VALUES</span> (<span class=\"hljs-number\">3</span>,<span class=\"hljs-number\">2</span>);\n<span class=\"hljs-keyword\">INSERT  INTO</span> `sys_user_role`(`uid`,`rid`) <span class=\"hljs-keyword\">VALUES</span> (<span class=\"hljs-number\">3</span>,<span class=\"hljs-number\">3</span>);\n<span class=\"hljs-keyword\">INSERT  INTO</span> `sys_user_role`(`uid`,`rid`) <span class=\"hljs-keyword\">VALUES</span> (<span class=\"hljs-number\">3</span>,<span class=\"hljs-number\">4</span>);\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"89,144"}},{"content":"<pre data-lines=\"145,148\"><code>&gt; &#x6ce8;&#x610f;&#xff1a;&#x4e00;&#x5b9a;&#x4e00;&#x5b9a;&#x8981;&#x6ce8;&#x610f;&#xff0c;&#x6211;&#x8fd9;&#x91cc;&#x7684;&#x6570;&#x636e;&#x5e93;&#x662f;mysql5.5&#xff0c;&#x5e76;&#x4e14;&#x6211;&#x7684;&#x7aef;&#x53e3;&#x4e3a;3309&#x800c;&#x4e0d;&#x662f;3306&#xff0c;&#x63a5;&#x4e0b;&#x6765;&#x7684;`application.yaml`&#x4e2d;&#x5bf9;&#x6570;&#x636e;&#x6e90;&#x7684;&#x914d;&#x7f6e;&#x4e00;&#x5b9a;&#x8981;&#x6ce8;&#x610f;&#x4fee;&#x6539;&#x3002;\n\n&gt; &#x6ce8;&#x610f;&#xff1a;&#x672c;&#x7ae0;&#x8282;&#x6240;&#x6709;&#x64cd;&#x4f5c;&#x5747;&#x5728;`sso-common`&#x4e2d;&#x8fdb;&#x884c;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"145,148"}}],"payload":{"tag":"h2","lines":"86,88"}},{"content":"4.1&#x3001;&#x5bfc;&#x5165;&#x4f9d;&#x8d56;","children":[{"content":"<pre data-lines=\"152,153\"><code>pom.xml\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"152,153"}},{"content":"<pre data-lines=\"154,216\"><code class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependencies</span>&gt;</span>\n    \n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>io.jsonwebtoken<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>jjwt-api<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>0.11.2<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>io.jsonwebtoken<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>jjwt-impl<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>0.11.2<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">scope</span>&gt;</span>runtime<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">scope</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>io.jsonwebtoken<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>jjwt-jackson<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>0.11.2<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">scope</span>&gt;</span>runtime<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">scope</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span>\n    \n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>jackson-core<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>2.11.4<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>jackson-databind<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>2.11.4<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>com.fasterxml.jackson.core<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>jackson-annotations<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>2.11.4<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span>\n    \n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>joda-time<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>joda-time<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>2.10.9<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span>\n    \n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>org.projectlombok<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>lombok<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>1.18.16<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span>\n\n    \n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>spring-boot-starter-logging<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span>\n    \n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>spring-boot-starter-test<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependencies</span>&gt;</span>\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"154,216"}}],"payload":{"tag":"h2","lines":"149,151"}},{"content":"4.2&#x3001;&#x7edf;&#x4e00;&#x683c;&#x5f0f;","children":[{"content":"4.2.1&#x3001;&#x7edf;&#x4e00;&#x8f7d;&#x8377;&#x5bf9;&#x8c61;","children":[{"content":"<pre data-lines=\"222,223\"><code>com.caochenlei.domain.Payload\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"222,223"}},{"content":"<pre data-lines=\"224,234\"><code class=\"language-java\">\n<span class=\"hljs-meta\">@Data</span>\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">Payload</span>&lt;T&gt; <span class=\"hljs-keyword\">implements</span> <span class=\"hljs-title class_\">Serializable</span> {\n    <span class=\"hljs-keyword\">private</span> String id;\n    <span class=\"hljs-keyword\">private</span> T userInfo;\n    <span class=\"hljs-keyword\">private</span> Date expiration;\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"224,234"}}],"payload":{"tag":"h3","lines":"220,221"}},{"content":"4.2.2&#x3001;&#x7edf;&#x4e00;&#x8fd4;&#x56de;&#x7ed3;&#x679c;","children":[{"content":"<pre data-lines=\"237,238\"><code>com.caochenlei.domain.Result\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"237,238"}},{"content":"<pre data-lines=\"239,251\"><code class=\"language-java\">\n<span class=\"hljs-meta\">@Data</span>\n<span class=\"hljs-meta\">@NoArgsConstructor</span>\n<span class=\"hljs-meta\">@AllArgsConstructor</span>\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">Result</span> <span class=\"hljs-keyword\">implements</span> <span class=\"hljs-title class_\">Serializable</span> {\n    <span class=\"hljs-keyword\">private</span> Integer code;\n    <span class=\"hljs-keyword\">private</span> String msg;\n    <span class=\"hljs-keyword\">private</span> Object data;\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"239,251"}}],"payload":{"tag":"h3","lines":"235,236"}}],"payload":{"tag":"h2","lines":"217,219"}},{"content":"4.3&#x3001;&#x5e38;&#x7528;&#x5de5;&#x5177;","children":[{"content":"4.3.1&#x3001;Json&#x5de5;&#x5177;&#x7c7b;","children":[{"content":"<pre data-lines=\"257,258\"><code>com.caochenlei.utils.JsonUtils\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"257,258"}},{"content":"<pre data-lines=\"259,333\"><code class=\"language-java\">\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">JsonUtils</span> {\n    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">final</span> <span class=\"hljs-type\">Logger</span> <span class=\"hljs-variable\">logger</span> <span class=\"hljs-operator\">=</span> LoggerFactory.getLogger(JsonUtils.class);\n    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">final</span> <span class=\"hljs-type\">ObjectMapper</span> <span class=\"hljs-variable\">mapper</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">ObjectMapper</span>();\n\n    \n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> String <span class=\"hljs-title function_\">toString</span><span class=\"hljs-params\">(Object obj)</span> {\n        <span class=\"hljs-keyword\">if</span> (obj == <span class=\"hljs-literal\">null</span>) {\n            <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">null</span>;\n        }\n        <span class=\"hljs-keyword\">if</span> (obj.getClass() == String.class) {\n            <span class=\"hljs-keyword\">return</span> (String) obj;\n        }\n        <span class=\"hljs-keyword\">try</span> {\n            <span class=\"hljs-keyword\">return</span> mapper.writeValueAsString(obj);\n        } <span class=\"hljs-keyword\">catch</span> (JsonProcessingException e) {\n            logger.error(<span class=\"hljs-string\">&quot;json&#x5e8f;&#x5217;&#x5316;&#x51fa;&#x9519;&#xff1a;&quot;</span> + obj, e);\n            <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">null</span>;\n        }\n    }\n\n    \n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> &lt;T&gt; T <span class=\"hljs-title function_\">toBean</span><span class=\"hljs-params\">(String json, Class&lt;T&gt; tClass)</span> {\n        <span class=\"hljs-keyword\">try</span> {\n            <span class=\"hljs-keyword\">return</span> mapper.readValue(json, tClass);\n        } <span class=\"hljs-keyword\">catch</span> (IOException e) {\n            logger.error(<span class=\"hljs-string\">&quot;json&#x89e3;&#x6790;&#x51fa;&#x9519;&#xff1a;&quot;</span> + json, e);\n            <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">null</span>;\n        }\n    }\n\n    \n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> &lt;T&gt; T <span class=\"hljs-title function_\">toBean</span><span class=\"hljs-params\">(InputStream inputStream, Class&lt;T&gt; tClass)</span> {\n        <span class=\"hljs-keyword\">try</span> {\n            <span class=\"hljs-keyword\">return</span> mapper.readValue(inputStream, tClass);\n        } <span class=\"hljs-keyword\">catch</span> (IOException e) {\n            logger.error(<span class=\"hljs-string\">&quot;json&#x89e3;&#x6790;&#x51fa;&#x9519;&#xff1a;&quot;</span> + inputStream, e);\n            <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">null</span>;\n        }\n    }\n\n    \n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> &lt;E&gt; List&lt;E&gt; <span class=\"hljs-title function_\">toList</span><span class=\"hljs-params\">(String json, Class&lt;E&gt; eClass)</span> {\n        <span class=\"hljs-keyword\">try</span> {\n            <span class=\"hljs-keyword\">return</span> mapper.readValue(json, mapper.getTypeFactory().constructCollectionType(List.class, eClass));\n        } <span class=\"hljs-keyword\">catch</span> (IOException e) {\n            logger.error(<span class=\"hljs-string\">&quot;json&#x89e3;&#x6790;&#x51fa;&#x9519;&#xff1a;&quot;</span> + json, e);\n            <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">null</span>;\n        }\n    }\n\n    \n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> &lt;K, V&gt; Map&lt;K, V&gt; <span class=\"hljs-title function_\">toMap</span><span class=\"hljs-params\">(String json, Class&lt;K&gt; kClass, Class&lt;V&gt; vClass)</span> {\n        <span class=\"hljs-keyword\">try</span> {\n            <span class=\"hljs-keyword\">return</span> mapper.readValue(json, mapper.getTypeFactory().constructMapType(Map.class, kClass, vClass));\n        } <span class=\"hljs-keyword\">catch</span> (IOException e) {\n            logger.error(<span class=\"hljs-string\">&quot;json&#x89e3;&#x6790;&#x51fa;&#x9519;&#xff1a;&quot;</span> + json, e);\n            <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">null</span>;\n        }\n    }\n\n    \n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> &lt;T&gt; T <span class=\"hljs-title function_\">nativeRead</span><span class=\"hljs-params\">(String json, TypeReference&lt;T&gt; type)</span> {\n        <span class=\"hljs-keyword\">try</span> {\n            <span class=\"hljs-keyword\">return</span> mapper.readValue(json, type);\n        } <span class=\"hljs-keyword\">catch</span> (IOException e) {\n            logger.error(<span class=\"hljs-string\">&quot;json&#x89e3;&#x6790;&#x51fa;&#x9519;&#xff1a;&quot;</span> + json, e);\n            <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">null</span>;\n        }\n    }\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"259,333"}}],"payload":{"tag":"h3","lines":"255,256"}},{"content":"4.3.2&#x3001;Jwt&#x5de5;&#x5177;&#x7c7b;","children":[{"content":"<pre data-lines=\"336,337\"><code>com.caochenlei.utils.JwtUtils\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"336,337"}},{"content":"<pre data-lines=\"338,398\"><code class=\"language-java\">\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">JwtUtils</span> {\n    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">final</span> <span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">JWT_PAYLOAD_USER_KEY</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;user&quot;</span>;\n\n    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">static</span> String <span class=\"hljs-title function_\">createJTI</span><span class=\"hljs-params\">()</span> {\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">String</span>(Base64.getEncoder().encode(UUID.randomUUID().toString().getBytes()));\n    }\n\n    \n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> String <span class=\"hljs-title function_\">generateTokenExpireInMinutes</span><span class=\"hljs-params\">(Object userInfo, PrivateKey privateKey, <span class=\"hljs-type\">int</span> expire)</span> {\n        <span class=\"hljs-keyword\">return</span> Jwts.builder()\n                .claim(JWT_PAYLOAD_USER_KEY, JsonUtils.toString(userInfo))\n                .setId(createJTI())\n                .setExpiration(DateTime.now().plusMinutes(expire).toDate())\n                .signWith(privateKey, SignatureAlgorithm.RS256)\n                .compact();\n    }\n\n    \n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> String <span class=\"hljs-title function_\">generateTokenExpireInSeconds</span><span class=\"hljs-params\">(Object userInfo, PrivateKey privateKey, <span class=\"hljs-type\">int</span> expire)</span> {\n        <span class=\"hljs-keyword\">return</span> Jwts.builder()\n                .claim(JWT_PAYLOAD_USER_KEY, JsonUtils.toString(userInfo))\n                .setId(createJTI())\n                .setExpiration(DateTime.now().plusSeconds(expire).toDate())\n                .signWith(privateKey, SignatureAlgorithm.RS256)\n                .compact();\n    }\n\n    \n    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">static</span> Jws&lt;Claims&gt; <span class=\"hljs-title function_\">parserToken</span><span class=\"hljs-params\">(String token, PublicKey publicKey)</span> {\n        <span class=\"hljs-keyword\">return</span> Jwts.parserBuilder()\n                .setSigningKey(publicKey)\n                .build()\n                .parseClaimsJws(token);\n    }\n\n    \n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> &lt;T&gt; Payload&lt;T&gt; <span class=\"hljs-title function_\">getInfoFromToken</span><span class=\"hljs-params\">(String token, PublicKey publicKey, Class&lt;T&gt; userType)</span> {\n        Jws&lt;Claims&gt; claimsJws = parserToken(token, publicKey);\n        <span class=\"hljs-type\">Claims</span> <span class=\"hljs-variable\">body</span> <span class=\"hljs-operator\">=</span> claimsJws.getBody();\n        Payload&lt;T&gt; claims = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Payload</span>&lt;&gt;();\n        claims.setId(body.getId());\n        claims.setUserInfo(JsonUtils.toBean(body.get(JWT_PAYLOAD_USER_KEY).toString(), userType));\n        claims.setExpiration(body.getExpiration());\n        <span class=\"hljs-keyword\">return</span> claims;\n    }\n\n    \n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> &lt;T&gt; Payload&lt;T&gt; <span class=\"hljs-title function_\">getInfoFromToken</span><span class=\"hljs-params\">(String token, PublicKey publicKey)</span> {\n        Jws&lt;Claims&gt; claimsJws = parserToken(token, publicKey);\n        <span class=\"hljs-type\">Claims</span> <span class=\"hljs-variable\">body</span> <span class=\"hljs-operator\">=</span> claimsJws.getBody();\n        Payload&lt;T&gt; claims = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Payload</span>&lt;&gt;();\n        claims.setId(body.getId());\n        claims.setExpiration(body.getExpiration());\n        <span class=\"hljs-keyword\">return</span> claims;\n    }\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"338,398"}}],"payload":{"tag":"h3","lines":"334,335"}},{"content":"4.3.3&#x3001;Rsa&#x5de5;&#x5177;&#x7c7b;","children":[{"content":"<pre data-lines=\"401,402\"><code>com.caochenlei.utils.RsaUtils\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"401,402"}},{"content":"<pre data-lines=\"403,470\"><code class=\"language-java\">\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">RsaUtils</span> {\n    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">final</span> <span class=\"hljs-type\">int</span> <span class=\"hljs-variable\">DEFAULT_KEY_SIZE</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">2048</span>;\n\n    \n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> PublicKey <span class=\"hljs-title function_\">getPublicKey</span><span class=\"hljs-params\">(String filename)</span> <span class=\"hljs-keyword\">throws</span> Exception {\n        <span class=\"hljs-type\">byte</span>[] bytes = readFile(filename);\n        <span class=\"hljs-keyword\">return</span> getPublicKey(bytes);\n    }\n\n    \n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> PrivateKey <span class=\"hljs-title function_\">getPrivateKey</span><span class=\"hljs-params\">(String filename)</span> <span class=\"hljs-keyword\">throws</span> Exception {\n        <span class=\"hljs-type\">byte</span>[] bytes = readFile(filename);\n        <span class=\"hljs-keyword\">return</span> getPrivateKey(bytes);\n    }\n\n    \n    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">static</span> PublicKey <span class=\"hljs-title function_\">getPublicKey</span><span class=\"hljs-params\">(<span class=\"hljs-type\">byte</span>[] bytes)</span> <span class=\"hljs-keyword\">throws</span> Exception {\n        bytes = Base64.getDecoder().decode(bytes);\n        <span class=\"hljs-type\">X509EncodedKeySpec</span> <span class=\"hljs-variable\">spec</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">X509EncodedKeySpec</span>(bytes);\n        <span class=\"hljs-type\">KeyFactory</span> <span class=\"hljs-variable\">factory</span> <span class=\"hljs-operator\">=</span> KeyFactory.getInstance(<span class=\"hljs-string\">&quot;RSA&quot;</span>);\n        <span class=\"hljs-keyword\">return</span> factory.generatePublic(spec);\n    }\n\n    \n    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">static</span> PrivateKey <span class=\"hljs-title function_\">getPrivateKey</span><span class=\"hljs-params\">(<span class=\"hljs-type\">byte</span>[] bytes)</span> <span class=\"hljs-keyword\">throws</span> NoSuchAlgorithmException, InvalidKeySpecException {\n        bytes = Base64.getDecoder().decode(bytes);\n        <span class=\"hljs-type\">PKCS8EncodedKeySpec</span> <span class=\"hljs-variable\">spec</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">PKCS8EncodedKeySpec</span>(bytes);\n        <span class=\"hljs-type\">KeyFactory</span> <span class=\"hljs-variable\">factory</span> <span class=\"hljs-operator\">=</span> KeyFactory.getInstance(<span class=\"hljs-string\">&quot;RSA&quot;</span>);\n        <span class=\"hljs-keyword\">return</span> factory.generatePrivate(spec);\n    }\n\n    \n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">generateKey</span><span class=\"hljs-params\">(String publicKeyFilename, String privateKeyFilename, String secret, <span class=\"hljs-type\">int</span> keySize)</span> <span class=\"hljs-keyword\">throws</span> Exception {\n        <span class=\"hljs-type\">KeyPairGenerator</span> <span class=\"hljs-variable\">keyPairGenerator</span> <span class=\"hljs-operator\">=</span> KeyPairGenerator.getInstance(<span class=\"hljs-string\">&quot;RSA&quot;</span>);\n        <span class=\"hljs-type\">SecureRandom</span> <span class=\"hljs-variable\">secureRandom</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">SecureRandom</span>(secret.getBytes());\n        keyPairGenerator.initialize(Math.max(keySize, DEFAULT_KEY_SIZE), secureRandom);\n        <span class=\"hljs-type\">KeyPair</span> <span class=\"hljs-variable\">keyPair</span> <span class=\"hljs-operator\">=</span> keyPairGenerator.genKeyPair();\n        \n        <span class=\"hljs-type\">byte</span>[] publicKeyBytes = keyPair.getPublic().getEncoded();\n        publicKeyBytes = Base64.getEncoder().encode(publicKeyBytes);\n        writeFile(publicKeyFilename, publicKeyBytes);\n        \n        <span class=\"hljs-type\">byte</span>[] privateKeyBytes = keyPair.getPrivate().getEncoded();\n        privateKeyBytes = Base64.getEncoder().encode(privateKeyBytes);\n        writeFile(privateKeyFilename, privateKeyBytes);\n    }\n\n    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-type\">byte</span>[] readFile(String fileName) <span class=\"hljs-keyword\">throws</span> Exception {\n        <span class=\"hljs-keyword\">return</span> Files.readAllBytes(<span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">File</span>(fileName).toPath());\n    }\n\n    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">writeFile</span><span class=\"hljs-params\">(String destPath, <span class=\"hljs-type\">byte</span>[] bytes)</span> <span class=\"hljs-keyword\">throws</span> IOException {\n        <span class=\"hljs-type\">File</span> <span class=\"hljs-variable\">dest</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">File</span>(destPath);\n        <span class=\"hljs-type\">File</span> <span class=\"hljs-variable\">parentFile</span> <span class=\"hljs-operator\">=</span> dest.getParentFile();\n        <span class=\"hljs-keyword\">if</span> (!parentFile.exists()) {\n            parentFile.mkdirs();\n        }\n        <span class=\"hljs-keyword\">if</span> (!dest.exists()) {\n            dest.createNewFile();\n        }\n        Files.write(dest.toPath(), bytes);\n    }\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"403,470"}}],"payload":{"tag":"h3","lines":"399,400"}}],"payload":{"tag":"h2","lines":"252,254"}},{"content":"4.4&#x3001;&#x751f;&#x6210;&#x5bc6;&#x94a5;","children":[{"content":"<pre data-lines=\"474,475\"><code>com.caochenlei.utils.RsaUtilsTest\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"474,475"}},{"content":"<pre data-lines=\"476,489\"><code class=\"language-java\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">RsaUtilsTest</span> {\n    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">publicFile</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;D:\\\\auth_key\\\\rsa_key.pub&quot;</span>;\n    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">privateFile</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;D:\\\\auth_key\\\\rsa_key&quot;</span>;\n    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">secret</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-string\">&quot;CaoChenLeiSecret&quot;</span>;\n\n    <span class=\"hljs-meta\">@Test</span>\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">generateKey</span><span class=\"hljs-params\">()</span> <span class=\"hljs-keyword\">throws</span> Exception {\n        RsaUtils.generateKey(publicFile, privateFile, secret, <span class=\"hljs-number\">2048</span>);\n    }\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"476,489"}},{"content":"<img src=\"https://img-blog.csdnimg.cn/img_convert/793e973a29d83e77b2c99598e928c15c.png\" alt>","children":[],"payload":{"tag":"img","lines":"490,491"}},{"content":"<pre data-lines=\"492,493\"><code>&gt; &#x6ce8;&#x610f;&#xff1a;&#x672c;&#x7ae0;&#x8282;&#x6240;&#x6709;&#x64cd;&#x4f5c;&#x5747;&#x5728;`sso-auth-server`&#x4e2d;&#x8fdb;&#x884c;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"492,493"}}],"payload":{"tag":"h2","lines":"471,473"}},{"content":"5.1&#x3001;&#x5bfc;&#x5165;&#x4f9d;&#x8d56;","children":[{"content":"<pre data-lines=\"497,498\"><code>pom.xml\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"497,498"}},{"content":"<pre data-lines=\"499,528\"><code class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependencies</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>spring-boot-starter-web<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>spring-boot-starter-security<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>org.mybatis.spring.boot<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>2.1.4<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>mysql<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>mysql-connector-java<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>5.1.49<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span>\n    \n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>com.caochenlei<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>sso-common<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>1.0-SNAPSHOT<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependencies</span>&gt;</span>\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"499,528"}}],"payload":{"tag":"h2","lines":"494,496"}},{"content":"5.2&#x3001;&#x7f16;&#x5199;&#x914d;&#x7f6e;&#x6587;&#x4ef6;","children":[{"content":"<pre data-lines=\"532,541\"><code>application.yaml\n\n**&#x4e00;&#x5b9a;&#x4e00;&#x5b9a;&#x8981;&#x6ce8;&#x610f;&#xff1a;** \n\n1.  &#x670d;&#x52a1;&#x7aef;&#x53e3;\n2.  &#x5e94;&#x7528;&#x540d;&#x79f0;\n3.  &#x6570;&#x636e;&#x5e93;&#x5730;&#x5740;\n4.  &#x6570;&#x636e;&#x5e93;&#x5bc6;&#x7801;\n5.  &#x79c1;&#x94a5;&#x7684;&#x8def;&#x5f84;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"532,541"}},{"content":"<pre data-lines=\"542,566\"><code class=\"language-yaml\"><span class=\"hljs-attr\">server:</span>\n  <span class=\"hljs-attr\">port:</span> <span class=\"hljs-number\">9001</span>\n  <span class=\"hljs-attr\">servlet:</span>\n    <span class=\"hljs-attr\">application-display-name:</span> <span class=\"hljs-string\">sso-auth-server</span>\n<span class=\"hljs-attr\">spring:</span>\n  <span class=\"hljs-attr\">datasource:</span>\n    <span class=\"hljs-attr\">driver-class-name:</span> <span class=\"hljs-string\">com.mysql.jdbc.Driver</span>\n    <span class=\"hljs-attr\">url:</span> <span class=\"hljs-string\">jdbc:mysql://localhost:3309/test</span>\n    <span class=\"hljs-attr\">username:</span> <span class=\"hljs-string\">root</span>\n    <span class=\"hljs-attr\">password:</span> <span class=\"hljs-string\">root</span>\n<span class=\"hljs-attr\">mybatis:</span>\n  <span class=\"hljs-attr\">type-aliases-package:</span> <span class=\"hljs-string\">com.caochenlei.domain</span>\n  <span class=\"hljs-attr\">configuration:</span>\n    <span class=\"hljs-attr\">map-underscore-to-camel-case:</span> <span class=\"hljs-literal\">true</span>\n<span class=\"hljs-attr\">logging:</span>\n  <span class=\"hljs-attr\">level:</span>\n    <span class=\"hljs-attr\">com.caochenlei:</span> <span class=\"hljs-string\">debug</span>\n\n<span class=\"hljs-attr\">rsa:</span>\n  <span class=\"hljs-attr\">key:</span>\n    <span class=\"hljs-attr\">privateKeyPath:</span> <span class=\"hljs-string\">D:\\auth_key\\rsa_key</span>\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"542,566"}}],"payload":{"tag":"h2","lines":"529,531"}},{"content":"5.3&#x3001;&#x7f16;&#x5199;&#x5c5e;&#x6027;&#x7c7b;","children":[{"content":"<pre data-lines=\"570,571\"><code>com.caochenlei.prop.RsaKeyProperties\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"570,571"}},{"content":"<pre data-lines=\"572,595\"><code class=\"language-java\"><span class=\"hljs-meta\">@Data</span>\n<span class=\"hljs-meta\">@ConfigurationProperties(prefix = &quot;rsa.key&quot;, ignoreInvalidFields = true)</span>\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">RsaKeyProperties</span> {\n    <span class=\"hljs-keyword\">private</span> String publicKeyPath;\n    <span class=\"hljs-keyword\">private</span> String privateKeyPath;\n\n    <span class=\"hljs-keyword\">private</span> PublicKey publicKey;\n    <span class=\"hljs-keyword\">private</span> PrivateKey privateKey;\n\n    \n    <span class=\"hljs-meta\">@PostConstruct</span>\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">loadRsaKey</span><span class=\"hljs-params\">()</span> <span class=\"hljs-keyword\">throws</span> Exception {\n        <span class=\"hljs-keyword\">if</span> (publicKeyPath != <span class=\"hljs-literal\">null</span>) {\n            publicKey = RsaUtils.getPublicKey(publicKeyPath);\n        }\n        <span class=\"hljs-keyword\">if</span> (privateKeyPath != <span class=\"hljs-literal\">null</span>) {\n            privateKey = RsaUtils.getPrivateKey(privateKeyPath);\n        }\n    }\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"572,595"}},{"content":"<pre data-lines=\"596,597\"><code>com.caochenlei.AuthServerApplication\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"596,597"}},{"content":"<pre data-lines=\"598,608\"><code class=\"language-java\"><span class=\"hljs-meta\">@SpringBootApplication</span>\n<span class=\"hljs-meta\">@EnableConfigurationProperties(RsaKeyProperties.class)</span>\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">AuthServerApplication</span> {\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">main</span><span class=\"hljs-params\">(String[] args)</span> {\n        SpringApplication.run(AuthServerApplication.class, args);\n    }\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"598,608"}}],"payload":{"tag":"h2","lines":"567,569"}},{"content":"5.4&#x3001;&#x7f16;&#x5199;&#x5de5;&#x5177;&#x7c7b;","children":[{"content":"<pre data-lines=\"612,613\"><code>com.caochenlei.utils.RequestUtils\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"612,613"}},{"content":"<pre data-lines=\"614,631\"><code class=\"language-java\">\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">RequestUtils</span> {\n    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">final</span> <span class=\"hljs-type\">Logger</span> <span class=\"hljs-variable\">logger</span> <span class=\"hljs-operator\">=</span> LoggerFactory.getLogger(RequestUtils.class);\n\n    \n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> &lt;T&gt; T <span class=\"hljs-title function_\">read</span><span class=\"hljs-params\">(HttpServletRequest request, Class&lt;T&gt; clazz)</span> {\n        <span class=\"hljs-keyword\">try</span> {\n            <span class=\"hljs-keyword\">return</span> JsonUtils.toBean(request.getInputStream(), clazz);\n        } <span class=\"hljs-keyword\">catch</span> (Exception e) {\n            logger.error(<span class=\"hljs-string\">&quot;&#x8bfb;&#x53d6;&#x51fa;&#x9519;&#xff1a;&quot;</span> + clazz, e);\n            <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">null</span>;\n        }\n    }\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"614,631"}},{"content":"<pre data-lines=\"632,633\"><code>com.caochenlei.utils.ResponseUtils\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"632,633"}},{"content":"<pre data-lines=\"634,658\"><code class=\"language-java\">\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">ResponseUtils</span> {\n    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">final</span> <span class=\"hljs-type\">Logger</span> <span class=\"hljs-variable\">logger</span> <span class=\"hljs-operator\">=</span> LoggerFactory.getLogger(ResponseUtils.class);\n\n    \n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">write</span><span class=\"hljs-params\">(HttpServletResponse response, <span class=\"hljs-type\">int</span> status, String msg)</span> {\n        <span class=\"hljs-keyword\">try</span> {\n            response.setHeader(<span class=\"hljs-string\">&quot;Access-Control-Allow-Origin&quot;</span>, <span class=\"hljs-string\">&quot;*&quot;</span>);\n            response.setHeader(<span class=\"hljs-string\">&quot;Cache-Control&quot;</span>, <span class=\"hljs-string\">&quot;no-cache&quot;</span>);\n            response.setCharacterEncoding(<span class=\"hljs-string\">&quot;UTF-8&quot;</span>);\n            response.setContentType(<span class=\"hljs-string\">&quot;application/json&quot;</span>);\n            response.setStatus(status);\n            <span class=\"hljs-type\">PrintWriter</span> <span class=\"hljs-variable\">out</span> <span class=\"hljs-operator\">=</span> response.getWriter();\n            out.write(JsonUtils.toString(<span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Result</span>(status, msg, <span class=\"hljs-literal\">null</span>)));\n            out.flush();\n            out.close();\n        } <span class=\"hljs-keyword\">catch</span> (Exception e) {\n            logger.error(<span class=\"hljs-string\">&quot;&#x54cd;&#x5e94;&#x51fa;&#x9519;&#xff1a;&quot;</span> + msg, e);\n        }\n    }\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"634,658"}}],"payload":{"tag":"h2","lines":"609,611"}},{"content":"5.5&#x3001;&#x7f16;&#x5199;&#x5b9e;&#x4f53;&#x7c7b;","children":[{"content":"<pre data-lines=\"662,663\"><code>com.caochenlei.domain.SysUser\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"662,663"}},{"content":"<pre data-lines=\"664,709\"><code class=\"language-java\"><span class=\"hljs-meta\">@Data</span>\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">SysUser</span> <span class=\"hljs-keyword\">implements</span> <span class=\"hljs-title class_\">UserDetails</span> {\n    <span class=\"hljs-keyword\">private</span> Integer id;\n    <span class=\"hljs-keyword\">private</span> String username;\n    <span class=\"hljs-keyword\">private</span> String password;\n    <span class=\"hljs-keyword\">private</span> Integer status;\n    <span class=\"hljs-keyword\">private</span> List&lt;SysRole&gt; sysRoles;\n\n    <span class=\"hljs-meta\">@JsonIgnore</span>\n    <span class=\"hljs-meta\">@Override</span>\n    <span class=\"hljs-keyword\">public</span> Collection&lt;? <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title class_\">GrantedAuthority</span>&gt; getAuthorities() {\n        <span class=\"hljs-keyword\">return</span> sysRoles;\n    }\n\n    \n    <span class=\"hljs-meta\">@JsonIgnore</span>\n    <span class=\"hljs-meta\">@Override</span>\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-type\">boolean</span> <span class=\"hljs-title function_\">isAccountNonExpired</span><span class=\"hljs-params\">()</span> {\n        <span class=\"hljs-keyword\">return</span> status != <span class=\"hljs-number\">1</span>;\n    }\n\n    \n    <span class=\"hljs-meta\">@JsonIgnore</span>\n    <span class=\"hljs-meta\">@Override</span>\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-type\">boolean</span> <span class=\"hljs-title function_\">isAccountNonLocked</span><span class=\"hljs-params\">()</span> {\n        <span class=\"hljs-keyword\">return</span> status != <span class=\"hljs-number\">2</span>;\n    }\n\n    \n    <span class=\"hljs-meta\">@JsonIgnore</span>\n    <span class=\"hljs-meta\">@Override</span>\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-type\">boolean</span> <span class=\"hljs-title function_\">isCredentialsNonExpired</span><span class=\"hljs-params\">()</span> {\n        <span class=\"hljs-keyword\">return</span> status != <span class=\"hljs-number\">3</span>;\n    }\n\n    \n    <span class=\"hljs-meta\">@JsonIgnore</span>\n    <span class=\"hljs-meta\">@Override</span>\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-type\">boolean</span> <span class=\"hljs-title function_\">isEnabled</span><span class=\"hljs-params\">()</span> {\n        <span class=\"hljs-keyword\">return</span> status != <span class=\"hljs-number\">4</span>;\n    }\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"664,709"}},{"content":"<pre data-lines=\"710,711\"><code>com.caochenlei.domain.SysRole\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"710,711"}},{"content":"<pre data-lines=\"712,727\"><code class=\"language-java\"><span class=\"hljs-meta\">@Data</span>\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">SysRole</span> <span class=\"hljs-keyword\">implements</span> <span class=\"hljs-title class_\">GrantedAuthority</span> {\n    <span class=\"hljs-keyword\">private</span> Integer id;\n    <span class=\"hljs-keyword\">private</span> String name;\n    <span class=\"hljs-keyword\">private</span> String desc;\n\n    <span class=\"hljs-meta\">@JsonIgnore</span>\n    <span class=\"hljs-meta\">@Override</span>\n    <span class=\"hljs-keyword\">public</span> String <span class=\"hljs-title function_\">getAuthority</span><span class=\"hljs-params\">()</span> {\n        <span class=\"hljs-keyword\">return</span> name;\n    }\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"712,727"}}],"payload":{"tag":"h2","lines":"659,661"}},{"content":"5.6&#x3001;&#x7f16;&#x5199;&#x6620;&#x5c04;&#x63a5;&#x53e3;","children":[{"content":"<pre data-lines=\"731,732\"><code>com.caochenlei.mapper.SysUserMapper\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"731,732"}},{"content":"<pre data-lines=\"733,755\"><code class=\"language-java\"><span class=\"hljs-meta\">@Mapper</span>\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">interface</span> <span class=\"hljs-title class_\">SysUserMapper</span> {\n    \n    <span class=\"hljs-meta\">@Select(&quot;select * from `sys_user` where `username` = #{username}&quot;)</span>\n    <span class=\"hljs-meta\">@Results({\n            \n            @Result(property = &quot;id&quot;, column = &quot;id&quot;, id = true),\n            \n            @Result(property = &quot;username&quot;, column = &quot;username&quot;),\n            @Result(property = &quot;password&quot;, column = &quot;password&quot;),\n            @Result(property = &quot;status&quot;, column = &quot;status&quot;),\n            \n            @Result(property = &quot;sysRoles&quot;, column = &quot;id&quot;,\n                    javaType = List.class,\n                    many = @Many(select = &quot;com.caochenlei.mapper.SysRoleMapper.findByUid&quot;)\n            )\n    })</span>\n    SysUser <span class=\"hljs-title function_\">findByUsername</span><span class=\"hljs-params\">(String username)</span>;\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"733,755"}},{"content":"<pre data-lines=\"756,757\"><code>com.caochenlei.mapper.SysRoleMapper\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"756,757"}},{"content":"<pre data-lines=\"758,769\"><code class=\"language-java\"><span class=\"hljs-meta\">@Mapper</span>\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">interface</span> <span class=\"hljs-title class_\">SysRoleMapper</span> {\n    \n    <span class=\"hljs-meta\">@Select(&quot;select * from `sys_role` where id in (&quot; +\n            &quot;  select rid from `sys_user_role` where uid = #{uid}&quot; +\n            &quot;)&quot;)</span>\n    List&lt;SysRole&gt; <span class=\"hljs-title function_\">findByUid</span><span class=\"hljs-params\">(Integer uid)</span>;\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"758,769"}}],"payload":{"tag":"h2","lines":"728,730"}},{"content":"5.7&#x3001;&#x7f16;&#x5199;&#x670d;&#x52a1;&#x63a5;&#x53e3;","children":[{"content":"<pre data-lines=\"773,774\"><code>com.caochenlei.service.SysUserDetailsService\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"773,774"}},{"content":"<pre data-lines=\"775,781\"><code class=\"language-java\"><span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">interface</span> <span class=\"hljs-title class_\">SysUserDetailsService</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title class_\">UserDetailsService</span> {\n\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"775,781"}},{"content":"<pre data-lines=\"782,783\"><code>com.caochenlei.service.impl.SysUserDetailsServiceImpl\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"782,783"}},{"content":"<pre data-lines=\"784,804\"><code class=\"language-java\"><span class=\"hljs-meta\">@Service</span>\n<span class=\"hljs-meta\">@Transactional</span>\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">SysUserDetailsServiceImpl</span> <span class=\"hljs-keyword\">implements</span> <span class=\"hljs-title class_\">SysUserDetailsService</span> {\n    <span class=\"hljs-meta\">@Autowired(required = false)</span>\n    <span class=\"hljs-keyword\">private</span> SysUserMapper sysUserMapper;\n\n    <span class=\"hljs-meta\">@Override</span>\n    <span class=\"hljs-keyword\">public</span> UserDetails <span class=\"hljs-title function_\">loadUserByUsername</span><span class=\"hljs-params\">(String username)</span> <span class=\"hljs-keyword\">throws</span> UsernameNotFoundException {\n        \n        <span class=\"hljs-type\">SysUser</span> <span class=\"hljs-variable\">sysUser</span> <span class=\"hljs-operator\">=</span> sysUserMapper.findByUsername(username);\n        \n        <span class=\"hljs-keyword\">if</span> (sysUser == <span class=\"hljs-literal\">null</span>) {\n            <span class=\"hljs-keyword\">throw</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">UsernameNotFoundException</span>(<span class=\"hljs-string\">&quot;user not exist.&quot;</span>);\n        }\n        <span class=\"hljs-keyword\">return</span> sysUser;\n    }\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"784,804"}}],"payload":{"tag":"h2","lines":"770,772"}},{"content":"5.8&#x3001;&#x7f16;&#x5199;&#x8ba4;&#x8bc1;&#x8fc7;&#x6ee4;&#x5668;","children":[{"content":"<pre data-lines=\"808,809\"><code>com.caochenlei.filter.JwtAuthenticationFilter\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"808,809"}},{"content":"<pre data-lines=\"810,869\"><code class=\"language-java\">\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">JwtAuthenticationFilter</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title class_\">UsernamePasswordAuthenticationFilter</span> {\n    <span class=\"hljs-keyword\">private</span> AuthenticationManager authenticationManager;\n    <span class=\"hljs-keyword\">private</span> RsaKeyProperties prop;\n\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-title function_\">JwtAuthenticationFilter</span><span class=\"hljs-params\">(AuthenticationManager authenticationManager, RsaKeyProperties prop)</span> {\n        <span class=\"hljs-built_in\">this</span>.authenticationManager = authenticationManager;\n        <span class=\"hljs-built_in\">this</span>.prop = prop;\n    }\n\n    <span class=\"hljs-meta\">@Override</span>\n    <span class=\"hljs-keyword\">public</span> Authentication <span class=\"hljs-title function_\">attemptAuthentication</span><span class=\"hljs-params\">(HttpServletRequest request, HttpServletResponse response)</span> <span class=\"hljs-keyword\">throws</span> AuthenticationException {\n        <span class=\"hljs-type\">SysUser</span> <span class=\"hljs-variable\">sysUser</span> <span class=\"hljs-operator\">=</span> RequestUtils.read(request, SysUser.class);\n        <span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">username</span> <span class=\"hljs-operator\">=</span> sysUser.getUsername();\n        username = username != <span class=\"hljs-literal\">null</span> ? username : <span class=\"hljs-string\">&quot;&quot;</span>;\n        <span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">password</span> <span class=\"hljs-operator\">=</span> sysUser.getPassword();\n        password = password != <span class=\"hljs-literal\">null</span> ? password : <span class=\"hljs-string\">&quot;&quot;</span>;\n        <span class=\"hljs-type\">UsernamePasswordAuthenticationToken</span> <span class=\"hljs-variable\">authRequest</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">UsernamePasswordAuthenticationToken</span>(username, password);\n        <span class=\"hljs-keyword\">return</span> authenticationManager.authenticate(authRequest);\n    }\n\n    \n    <span class=\"hljs-meta\">@Override</span>\n    <span class=\"hljs-keyword\">protected</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">successfulAuthentication</span><span class=\"hljs-params\">(HttpServletRequest request, HttpServletResponse response, FilterChain chain, Authentication authResult)</span> <span class=\"hljs-keyword\">throws</span> IOException, ServletException {\n        <span class=\"hljs-type\">SysUser</span> <span class=\"hljs-variable\">sysUser</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">SysUser</span>();\n        sysUser.setUsername(authResult.getName());\n        sysUser.setSysRoles(<span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">ArrayList</span>(authResult.getAuthorities()));\n        <span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">token</span> <span class=\"hljs-operator\">=</span> JwtUtils.generateTokenExpireInMinutes(sysUser, prop.getPrivateKey(), <span class=\"hljs-number\">24</span> * <span class=\"hljs-number\">60</span>);\n        response.addHeader(<span class=\"hljs-string\">&quot;Authorization&quot;</span>, <span class=\"hljs-string\">&quot;Bearer &quot;</span> + token);\n        ResponseUtils.write(response, HttpServletResponse.SC_OK, <span class=\"hljs-string\">&quot;&#x7528;&#x6237;&#x8ba4;&#x8bc1;&#x901a;&#x8fc7;&#xff01;&quot;</span>);\n    }\n\n    \n    <span class=\"hljs-meta\">@Override</span>\n    <span class=\"hljs-keyword\">protected</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">unsuccessfulAuthentication</span><span class=\"hljs-params\">(HttpServletRequest request, HttpServletResponse response, AuthenticationException failed)</span> <span class=\"hljs-keyword\">throws</span> IOException, ServletException {\n        \n        SecurityContextHolder.clearContext();\n        System.out.println(failed);\n        \n        <span class=\"hljs-keyword\">if</span> (failed <span class=\"hljs-keyword\">instanceof</span> InternalAuthenticationServiceException) {\n            ResponseUtils.write(response, HttpServletResponse.SC_FORBIDDEN, <span class=\"hljs-string\">&quot;&#x8ba4;&#x8bc1;&#x670d;&#x52a1;&#x4e0d;&#x6b63;&#x5e38;&#xff01;&quot;</span>);\n        } <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span> (failed <span class=\"hljs-keyword\">instanceof</span> UsernameNotFoundException) {\n            ResponseUtils.write(response, HttpServletResponse.SC_FORBIDDEN, <span class=\"hljs-string\">&quot;&#x7528;&#x6237;&#x8d26;&#x6237;&#x4e0d;&#x5b58;&#x5728;&#xff01;&quot;</span>);\n        } <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span> (failed <span class=\"hljs-keyword\">instanceof</span> BadCredentialsException) {\n            ResponseUtils.write(response, HttpServletResponse.SC_FORBIDDEN, <span class=\"hljs-string\">&quot;&#x7528;&#x6237;&#x5bc6;&#x7801;&#x662f;&#x9519;&#x7684;&#xff01;&quot;</span>);\n        } <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span> (failed <span class=\"hljs-keyword\">instanceof</span> AccountExpiredException) {\n            ResponseUtils.write(response, HttpServletResponse.SC_FORBIDDEN, <span class=\"hljs-string\">&quot;&#x7528;&#x6237;&#x8d26;&#x6237;&#x5df2;&#x8fc7;&#x671f;&#xff01;&quot;</span>);\n        } <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span> (failed <span class=\"hljs-keyword\">instanceof</span> LockedException) {\n            ResponseUtils.write(response, HttpServletResponse.SC_FORBIDDEN, <span class=\"hljs-string\">&quot;&#x7528;&#x6237;&#x8d26;&#x6237;&#x5df2;&#x88ab;&#x9501;&#xff01;&quot;</span>);\n        } <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span> (failed <span class=\"hljs-keyword\">instanceof</span> CredentialsExpiredException) {\n            ResponseUtils.write(response, HttpServletResponse.SC_FORBIDDEN, <span class=\"hljs-string\">&quot;&#x7528;&#x6237;&#x5bc6;&#x7801;&#x5df2;&#x5931;&#x6548;&#xff01;&quot;</span>);\n        } <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span> (failed <span class=\"hljs-keyword\">instanceof</span> DisabledException) {\n            ResponseUtils.write(response, HttpServletResponse.SC_FORBIDDEN, <span class=\"hljs-string\">&quot;&#x7528;&#x6237;&#x8d26;&#x6237;&#x5df2;&#x88ab;&#x9501;&#xff01;&quot;</span>);\n        }\n    }\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"810,869"}}],"payload":{"tag":"h2","lines":"805,807"}},{"content":"5.9&#x3001;&#x7f16;&#x5199;&#x5b89;&#x5168;&#x914d;&#x7f6e;&#x7c7b;","children":[{"content":"<pre data-lines=\"873,874\"><code>com.caochenlei.config.WebSecurityConfig\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"873,874"}},{"content":"<pre data-lines=\"875,917\"><code class=\"language-java\"><span class=\"hljs-meta\">@Configuration</span>\n<span class=\"hljs-meta\">@EnableWebSecurity</span>\n<span class=\"hljs-meta\">@EnableGlobalMethodSecurity(securedEnabled = true)</span>\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">WebSecurityConfig</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title class_\">WebSecurityConfigurerAdapter</span> {\n    <span class=\"hljs-meta\">@Autowired</span>\n    <span class=\"hljs-keyword\">private</span> SysUserDetailsService sysUserDetailsService;\n    <span class=\"hljs-meta\">@Autowired</span>\n    <span class=\"hljs-keyword\">private</span> RsaKeyProperties prop;\n\n    <span class=\"hljs-meta\">@Bean</span>\n    <span class=\"hljs-keyword\">public</span> BCryptPasswordEncoder <span class=\"hljs-title function_\">passwordEncoder</span><span class=\"hljs-params\">()</span> {\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">BCryptPasswordEncoder</span>();\n    }\n\n    <span class=\"hljs-keyword\">public</span> AuthenticationProvider <span class=\"hljs-title function_\">daoAuthenticationProvider</span><span class=\"hljs-params\">()</span> {\n        <span class=\"hljs-type\">DaoAuthenticationProvider</span> <span class=\"hljs-variable\">daoAuthenticationProvider</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">DaoAuthenticationProvider</span>();\n        daoAuthenticationProvider.setUserDetailsService(sysUserDetailsService);\n        daoAuthenticationProvider.setPasswordEncoder(passwordEncoder());\n        daoAuthenticationProvider.setHideUserNotFoundExceptions(<span class=\"hljs-literal\">false</span>);\n        <span class=\"hljs-keyword\">return</span> daoAuthenticationProvider;\n    }\n\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">configure</span><span class=\"hljs-params\">(AuthenticationManagerBuilder auth)</span> <span class=\"hljs-keyword\">throws</span> Exception {\n        auth.authenticationProvider(daoAuthenticationProvider());\n    }\n\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">configure</span><span class=\"hljs-params\">(HttpSecurity http)</span> <span class=\"hljs-keyword\">throws</span> Exception {\n        \n        http.csrf().disable();\n        \n        http.cors().disable();\n        \n        http.sessionManagement().disable();\n        \n        http.formLogin().disable();\n        \n        http.addFilter(<span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">JwtAuthenticationFilter</span>(<span class=\"hljs-built_in\">super</span>.authenticationManager(), prop));\n    }\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"875,917"}},{"content":"<pre data-lines=\"918,919\"><code>&gt; &#x6ce8;&#x610f;&#xff1a;&#x672c;&#x7ae0;&#x8282;&#x6240;&#x6709;&#x64cd;&#x4f5c;&#x5747;&#x5728;`sso-source-order`&#x4e2d;&#x8fdb;&#x884c;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"918,919"}}],"payload":{"tag":"h2","lines":"870,872"}},{"content":"6.1&#x3001;&#x5bfc;&#x5165;&#x4f9d;&#x8d56;","children":[{"content":"<pre data-lines=\"923,924\"><code>pom.xml\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"923,924"}},{"content":"<pre data-lines=\"925,954\"><code class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependencies</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>spring-boot-starter-web<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>spring-boot-starter-security<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>org.mybatis.spring.boot<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>2.1.4<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>mysql<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>mysql-connector-java<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>5.1.49<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span>\n    \n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>com.caochenlei<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>sso-common<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>1.0-SNAPSHOT<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependencies</span>&gt;</span>\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"925,954"}}],"payload":{"tag":"h2","lines":"920,922"}},{"content":"6.2&#x3001;&#x7f16;&#x5199;&#x914d;&#x7f6e;&#x6587;&#x4ef6;","children":[{"content":"<pre data-lines=\"958,967\"><code>application.yaml\n\n**&#x4e00;&#x5b9a;&#x4e00;&#x5b9a;&#x8981;&#x6ce8;&#x610f;&#xff1a;** \n\n1.  &#x670d;&#x52a1;&#x7aef;&#x53e3;\n2.  &#x5e94;&#x7528;&#x540d;&#x79f0;\n3.  &#x6570;&#x636e;&#x5e93;&#x5730;&#x5740;\n4.  &#x6570;&#x636e;&#x5e93;&#x5bc6;&#x7801;\n5.  &#x516c;&#x94a5;&#x7684;&#x8def;&#x5f84;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"958,967"}},{"content":"<pre data-lines=\"968,992\"><code class=\"language-yaml\"><span class=\"hljs-attr\">server:</span>\n  <span class=\"hljs-attr\">port:</span> <span class=\"hljs-number\">9002</span>\n  <span class=\"hljs-attr\">servlet:</span>\n    <span class=\"hljs-attr\">application-display-name:</span> <span class=\"hljs-string\">sso-source-order</span>\n<span class=\"hljs-attr\">spring:</span>\n  <span class=\"hljs-attr\">datasource:</span>\n    <span class=\"hljs-attr\">driver-class-name:</span> <span class=\"hljs-string\">com.mysql.jdbc.Driver</span>\n    <span class=\"hljs-attr\">url:</span> <span class=\"hljs-string\">jdbc:mysql://localhost:3309/test</span>\n    <span class=\"hljs-attr\">username:</span> <span class=\"hljs-string\">root</span>\n    <span class=\"hljs-attr\">password:</span> <span class=\"hljs-string\">root</span>\n<span class=\"hljs-attr\">mybatis:</span>\n  <span class=\"hljs-attr\">type-aliases-package:</span> <span class=\"hljs-string\">com.caochenlei.domain</span>\n  <span class=\"hljs-attr\">configuration:</span>\n    <span class=\"hljs-attr\">map-underscore-to-camel-case:</span> <span class=\"hljs-literal\">true</span>\n<span class=\"hljs-attr\">logging:</span>\n  <span class=\"hljs-attr\">level:</span>\n    <span class=\"hljs-attr\">com.caochenlei:</span> <span class=\"hljs-string\">debug</span>\n\n<span class=\"hljs-attr\">rsa:</span>\n  <span class=\"hljs-attr\">key:</span>\n    <span class=\"hljs-attr\">publicKeyPath:</span> <span class=\"hljs-string\">D:\\auth_key\\rsa_key.pub</span>\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"968,992"}}],"payload":{"tag":"h2","lines":"955,957"}},{"content":"6.3&#x3001;&#x7f16;&#x5199;&#x5c5e;&#x6027;&#x7c7b;","children":[{"content":"<pre data-lines=\"996,997\"><code>com.caochenlei.prop.RsaKeyProperties\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"996,997"}},{"content":"<pre data-lines=\"998,1021\"><code class=\"language-java\"><span class=\"hljs-meta\">@Data</span>\n<span class=\"hljs-meta\">@ConfigurationProperties(prefix = &quot;rsa.key&quot;, ignoreInvalidFields = true)</span>\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">RsaKeyProperties</span> {\n    <span class=\"hljs-keyword\">private</span> String publicKeyPath;\n    <span class=\"hljs-keyword\">private</span> String privateKeyPath;\n\n    <span class=\"hljs-keyword\">private</span> PublicKey publicKey;\n    <span class=\"hljs-keyword\">private</span> PrivateKey privateKey;\n\n    \n    <span class=\"hljs-meta\">@PostConstruct</span>\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">loadRsaKey</span><span class=\"hljs-params\">()</span> <span class=\"hljs-keyword\">throws</span> Exception {\n        <span class=\"hljs-keyword\">if</span> (publicKeyPath != <span class=\"hljs-literal\">null</span>) {\n            publicKey = RsaUtils.getPublicKey(publicKeyPath);\n        }\n        <span class=\"hljs-keyword\">if</span> (privateKeyPath != <span class=\"hljs-literal\">null</span>) {\n            privateKey = RsaUtils.getPrivateKey(privateKeyPath);\n        }\n    }\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"998,1021"}},{"content":"<pre data-lines=\"1022,1023\"><code>com.caochenlei.SourceOrderApplication&#xff08;&#x8fd9;&#x91cc;&#x6ce8;&#x610f;&#x542f;&#x52a8;&#x7c7b;&#x540d;&#x79f0;&#xff09;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1022,1023"}},{"content":"<pre data-lines=\"1024,1034\"><code class=\"language-java\"><span class=\"hljs-meta\">@SpringBootApplication</span>\n<span class=\"hljs-meta\">@EnableConfigurationProperties(RsaKeyProperties.class)</span>\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">SourceOrderApplication</span> {\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">main</span><span class=\"hljs-params\">(String[] args)</span> {\n        SpringApplication.run(SourceOrderApplication.class, args);\n    }\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1024,1034"}}],"payload":{"tag":"h2","lines":"993,995"}},{"content":"6.4&#x3001;&#x7f16;&#x5199;&#x5de5;&#x5177;&#x7c7b;","children":[{"content":"<pre data-lines=\"1038,1039\"><code>com.caochenlei.utils.RequestUtils\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1038,1039"}},{"content":"<pre data-lines=\"1040,1057\"><code class=\"language-java\">\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">RequestUtils</span> {\n    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">final</span> <span class=\"hljs-type\">Logger</span> <span class=\"hljs-variable\">logger</span> <span class=\"hljs-operator\">=</span> LoggerFactory.getLogger(RequestUtils.class);\n\n    \n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> &lt;T&gt; T <span class=\"hljs-title function_\">read</span><span class=\"hljs-params\">(HttpServletRequest request, Class&lt;T&gt; clazz)</span> {\n        <span class=\"hljs-keyword\">try</span> {\n            <span class=\"hljs-keyword\">return</span> JsonUtils.toBean(request.getInputStream(), clazz);\n        } <span class=\"hljs-keyword\">catch</span> (Exception e) {\n            logger.error(<span class=\"hljs-string\">&quot;&#x8bfb;&#x53d6;&#x51fa;&#x9519;&#xff1a;&quot;</span> + clazz, e);\n            <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">null</span>;\n        }\n    }\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1040,1057"}},{"content":"<pre data-lines=\"1058,1059\"><code>com.caochenlei.utils.ResponseUtils\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1058,1059"}},{"content":"<pre data-lines=\"1060,1084\"><code class=\"language-java\">\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">ResponseUtils</span> {\n    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">final</span> <span class=\"hljs-type\">Logger</span> <span class=\"hljs-variable\">logger</span> <span class=\"hljs-operator\">=</span> LoggerFactory.getLogger(ResponseUtils.class);\n\n    \n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">write</span><span class=\"hljs-params\">(HttpServletResponse response, <span class=\"hljs-type\">int</span> status, String msg)</span> {\n        <span class=\"hljs-keyword\">try</span> {\n            response.setHeader(<span class=\"hljs-string\">&quot;Access-Control-Allow-Origin&quot;</span>, <span class=\"hljs-string\">&quot;*&quot;</span>);\n            response.setHeader(<span class=\"hljs-string\">&quot;Cache-Control&quot;</span>, <span class=\"hljs-string\">&quot;no-cache&quot;</span>);\n            response.setCharacterEncoding(<span class=\"hljs-string\">&quot;UTF-8&quot;</span>);\n            response.setContentType(<span class=\"hljs-string\">&quot;application/json&quot;</span>);\n            response.setStatus(status);\n            <span class=\"hljs-type\">PrintWriter</span> <span class=\"hljs-variable\">out</span> <span class=\"hljs-operator\">=</span> response.getWriter();\n            out.write(JsonUtils.toString(<span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Result</span>(status, msg, <span class=\"hljs-literal\">null</span>)));\n            out.flush();\n            out.close();\n        } <span class=\"hljs-keyword\">catch</span> (Exception e) {\n            logger.error(<span class=\"hljs-string\">&quot;&#x54cd;&#x5e94;&#x51fa;&#x9519;&#xff1a;&quot;</span> + msg, e);\n        }\n    }\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1060,1084"}}],"payload":{"tag":"h2","lines":"1035,1037"}},{"content":"6.5&#x3001;&#x7f16;&#x5199;&#x9a8c;&#x8bc1;&#x8fc7;&#x6ee4;&#x5668;","children":[{"content":"<pre data-lines=\"1088,1089\"><code>com.caochenlei.filter.JwtVerificationFilter\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1088,1089"}},{"content":"<pre data-lines=\"1090,1129\"><code class=\"language-java\">\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">JwtVerificationFilter</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title class_\">BasicAuthenticationFilter</span> {\n    <span class=\"hljs-keyword\">private</span> RsaKeyProperties prop;\n\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-title function_\">JwtVerificationFilter</span><span class=\"hljs-params\">(AuthenticationManager authenticationManager, RsaKeyProperties prop)</span> {\n        <span class=\"hljs-built_in\">super</span>(authenticationManager);\n        <span class=\"hljs-built_in\">this</span>.prop = prop;\n    }\n\n    <span class=\"hljs-meta\">@Override</span>\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">doFilterInternal</span><span class=\"hljs-params\">(HttpServletRequest request, HttpServletResponse response, FilterChain chain)</span> <span class=\"hljs-keyword\">throws</span> IOException, ServletException {\n        <span class=\"hljs-keyword\">try</span> {\n            <span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">header</span> <span class=\"hljs-operator\">=</span> request.getHeader(<span class=\"hljs-string\">&quot;Authorization&quot;</span>);\n            <span class=\"hljs-keyword\">if</span> (header == <span class=\"hljs-literal\">null</span> || !header.startsWith(<span class=\"hljs-string\">&quot;Bearer &quot;</span>)) {\n                \n                chain.doFilter(request, response);\n                ResponseUtils.write(response, HttpServletResponse.SC_FORBIDDEN, <span class=\"hljs-string\">&quot;&#x7528;&#x6237;&#x975e;&#x6cd5;&#x767b;&#x5f55;&#xff01;&quot;</span>);\n            } <span class=\"hljs-keyword\">else</span> {\n                \n                <span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">token</span> <span class=\"hljs-operator\">=</span> header.replace(<span class=\"hljs-string\">&quot;Bearer &quot;</span>, <span class=\"hljs-string\">&quot;&quot;</span>);\n                \n                Payload&lt;SysUser&gt; payload = JwtUtils.getInfoFromToken(token, prop.getPublicKey(), SysUser.class);\n                <span class=\"hljs-type\">SysUser</span> <span class=\"hljs-variable\">sysUser</span> <span class=\"hljs-operator\">=</span> payload.getUserInfo();\n                <span class=\"hljs-keyword\">if</span> (sysUser != <span class=\"hljs-literal\">null</span>) {\n                    <span class=\"hljs-type\">UsernamePasswordAuthenticationToken</span> <span class=\"hljs-variable\">authResult</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">UsernamePasswordAuthenticationToken</span>(sysUser.getUsername(), <span class=\"hljs-literal\">null</span>, sysUser.getAuthorities());\n                    SecurityContextHolder.getContext().setAuthentication(authResult);\n                    chain.doFilter(request, response);\n                } <span class=\"hljs-keyword\">else</span> {\n                    ResponseUtils.write(response, HttpServletResponse.SC_FORBIDDEN, <span class=\"hljs-string\">&quot;&#x7528;&#x6237;&#x9a8c;&#x8bc1;&#x5931;&#x8d25;&#xff01;&quot;</span>);\n                }\n            }\n        } <span class=\"hljs-keyword\">catch</span> (ExpiredJwtException e) {\n            ResponseUtils.write(response, HttpServletResponse.SC_FORBIDDEN, <span class=\"hljs-string\">&quot;&#x8bf7;&#x60a8;&#x91cd;&#x65b0;&#x767b;&#x5f55;&#xff01;&quot;</span>);\n        }\n    }\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1090,1129"}}],"payload":{"tag":"h2","lines":"1085,1087"}},{"content":"6.6&#x3001;&#x7f16;&#x5199;&#x5b89;&#x5168;&#x914d;&#x7f6e;&#x7c7b;","children":[{"content":"<pre data-lines=\"1133,1134\"><code>com.caochenlei.config.WebSecurityConfig\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1133,1134"}},{"content":"<pre data-lines=\"1135,1158\"><code class=\"language-java\"><span class=\"hljs-meta\">@Configuration</span>\n<span class=\"hljs-meta\">@EnableWebSecurity</span>\n<span class=\"hljs-meta\">@EnableGlobalMethodSecurity(securedEnabled = true)</span>\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">WebSecurityConfig</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title class_\">WebSecurityConfigurerAdapter</span> {\n    <span class=\"hljs-meta\">@Autowired</span>\n    <span class=\"hljs-keyword\">private</span> RsaKeyProperties prop;\n\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">configure</span><span class=\"hljs-params\">(HttpSecurity http)</span> <span class=\"hljs-keyword\">throws</span> Exception {\n        \n        http.csrf().disable();\n        \n        http.cors().disable();\n        \n        http.sessionManagement().disable();\n        \n        http.formLogin().disable();\n        \n        http.addFilter(<span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">JwtVerificationFilter</span>(<span class=\"hljs-built_in\">super</span>.authenticationManager(), prop));\n    }\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1135,1158"}}],"payload":{"tag":"h2","lines":"1130,1132"}},{"content":"6.7&#x3001;&#x914d;&#x5168;&#x5c40;&#x5f02;&#x5e38;&#x5904;&#x7406;","children":[{"content":"<pre data-lines=\"1162,1163\"><code>com.caochenlei.exception.GlobalExceptionHandler\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1162,1163"}},{"content":"<pre data-lines=\"1164,1179\"><code class=\"language-java\"><span class=\"hljs-meta\">@RestControllerAdvice</span>\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">GlobalExceptionHandler</span> {\n    <span class=\"hljs-meta\">@ExceptionHandler(AccessDeniedException.class)</span>\n    <span class=\"hljs-keyword\">public</span> Result <span class=\"hljs-title function_\">accessDeniedException</span><span class=\"hljs-params\">()</span> {\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Result</span>(<span class=\"hljs-number\">403</span>, <span class=\"hljs-string\">&quot;&#x7528;&#x6237;&#x6743;&#x9650;&#x4e0d;&#x8db3;&#xff01;&quot;</span>, <span class=\"hljs-literal\">null</span>);\n    }\n\n    <span class=\"hljs-meta\">@ExceptionHandler(RuntimeException.class)</span>\n    <span class=\"hljs-keyword\">public</span> Result <span class=\"hljs-title function_\">serverException</span><span class=\"hljs-params\">()</span> {\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Result</span>(<span class=\"hljs-number\">500</span>, <span class=\"hljs-string\">&quot;&#x670d;&#x52a1;&#x51fa;&#x73b0;&#x5f02;&#x5e38;&#xff01;&quot;</span>, <span class=\"hljs-literal\">null</span>);\n    }\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1164,1179"}}],"payload":{"tag":"h2","lines":"1159,1161"}},{"content":"6.8&#x3001;&#x8ba2;&#x5355;&#x8d44;&#x6e90;&#x63a7;&#x5236;&#x5668;","children":[{"content":"<pre data-lines=\"1183,1184\"><code>com.caochenlei.controller.OrderController\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1183,1184"}},{"content":"<pre data-lines=\"1185,1197\"><code class=\"language-java\"><span class=\"hljs-meta\">@RestController</span>\n<span class=\"hljs-meta\">@RequestMapping(&quot;/order&quot;)</span>\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">OrderController</span> {\n    <span class=\"hljs-meta\">@Secured({&quot;ROLE_ADMIN&quot;,&quot;ROLE_ORDER&quot;})</span>\n    <span class=\"hljs-meta\">@RequestMapping(&quot;/info&quot;)</span>\n    <span class=\"hljs-keyword\">public</span> String <span class=\"hljs-title function_\">info</span><span class=\"hljs-params\">()</span> {\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-string\">&quot;Order Controller ...&quot;</span>;\n    }\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1185,1197"}},{"content":"<pre data-lines=\"1198,1199\"><code>&gt; &#x6ce8;&#x610f;&#xff1a;&#x672c;&#x7ae0;&#x8282;&#x6240;&#x6709;&#x64cd;&#x4f5c;&#x5747;&#x5728;`sso-source-product`&#x4e2d;&#x8fdb;&#x884c;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1198,1199"}}],"payload":{"tag":"h2","lines":"1180,1182"}},{"content":"7.1&#x3001;&#x5bfc;&#x5165;&#x4f9d;&#x8d56;","children":[{"content":"<pre data-lines=\"1203,1204\"><code>pom.xml\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1203,1204"}},{"content":"<pre data-lines=\"1205,1234\"><code class=\"language-xml\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependencies</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>spring-boot-starter-web<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>org.springframework.boot<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>spring-boot-starter-security<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>org.mybatis.spring.boot<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>mybatis-spring-boot-starter<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>2.1.4<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>mysql<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>mysql-connector-java<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>5.1.49<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span>\n    \n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">dependency</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">groupId</span>&gt;</span>com.caochenlei<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">groupId</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">artifactId</span>&gt;</span>sso-common<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">artifactId</span>&gt;</span>\n        <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">version</span>&gt;</span>1.0-SNAPSHOT<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">version</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependency</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">dependencies</span>&gt;</span>\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1205,1234"}}],"payload":{"tag":"h2","lines":"1200,1202"}},{"content":"7.2&#x3001;&#x7f16;&#x5199;&#x914d;&#x7f6e;&#x6587;&#x4ef6;","children":[{"content":"<pre data-lines=\"1238,1247\"><code>application.yaml\n\n**&#x4e00;&#x5b9a;&#x4e00;&#x5b9a;&#x8981;&#x6ce8;&#x610f;&#xff1a;** \n\n1.  &#x670d;&#x52a1;&#x7aef;&#x53e3;\n2.  &#x5e94;&#x7528;&#x540d;&#x79f0;\n3.  &#x6570;&#x636e;&#x5e93;&#x5730;&#x5740;\n4.  &#x6570;&#x636e;&#x5e93;&#x5bc6;&#x7801;\n5.  &#x516c;&#x94a5;&#x7684;&#x8def;&#x5f84;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1238,1247"}},{"content":"<pre data-lines=\"1248,1272\"><code class=\"language-yaml\"><span class=\"hljs-attr\">server:</span>\n  <span class=\"hljs-attr\">port:</span> <span class=\"hljs-number\">9003</span>\n  <span class=\"hljs-attr\">servlet:</span>\n    <span class=\"hljs-attr\">application-display-name:</span> <span class=\"hljs-string\">sso-source-product</span>\n<span class=\"hljs-attr\">spring:</span>\n  <span class=\"hljs-attr\">datasource:</span>\n    <span class=\"hljs-attr\">driver-class-name:</span> <span class=\"hljs-string\">com.mysql.jdbc.Driver</span>\n    <span class=\"hljs-attr\">url:</span> <span class=\"hljs-string\">jdbc:mysql://localhost:3309/test</span>\n    <span class=\"hljs-attr\">username:</span> <span class=\"hljs-string\">root</span>\n    <span class=\"hljs-attr\">password:</span> <span class=\"hljs-string\">root</span>\n<span class=\"hljs-attr\">mybatis:</span>\n  <span class=\"hljs-attr\">type-aliases-package:</span> <span class=\"hljs-string\">com.caochenlei.domain</span>\n  <span class=\"hljs-attr\">configuration:</span>\n    <span class=\"hljs-attr\">map-underscore-to-camel-case:</span> <span class=\"hljs-literal\">true</span>\n<span class=\"hljs-attr\">logging:</span>\n  <span class=\"hljs-attr\">level:</span>\n    <span class=\"hljs-attr\">com.caochenlei:</span> <span class=\"hljs-string\">debug</span>\n\n<span class=\"hljs-attr\">rsa:</span>\n  <span class=\"hljs-attr\">key:</span>\n    <span class=\"hljs-attr\">publicKeyPath:</span> <span class=\"hljs-string\">D:\\auth_key\\rsa_key.pub</span>\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1248,1272"}}],"payload":{"tag":"h2","lines":"1235,1237"}},{"content":"7.3&#x3001;&#x7f16;&#x5199;&#x5c5e;&#x6027;&#x7c7b;","children":[{"content":"<pre data-lines=\"1276,1277\"><code>com.caochenlei.prop.RsaKeyProperties\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1276,1277"}},{"content":"<pre data-lines=\"1278,1301\"><code class=\"language-java\"><span class=\"hljs-meta\">@Data</span>\n<span class=\"hljs-meta\">@ConfigurationProperties(prefix = &quot;rsa.key&quot;, ignoreInvalidFields = true)</span>\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">RsaKeyProperties</span> {\n    <span class=\"hljs-keyword\">private</span> String publicKeyPath;\n    <span class=\"hljs-keyword\">private</span> String privateKeyPath;\n\n    <span class=\"hljs-keyword\">private</span> PublicKey publicKey;\n    <span class=\"hljs-keyword\">private</span> PrivateKey privateKey;\n\n    \n    <span class=\"hljs-meta\">@PostConstruct</span>\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">loadRsaKey</span><span class=\"hljs-params\">()</span> <span class=\"hljs-keyword\">throws</span> Exception {\n        <span class=\"hljs-keyword\">if</span> (publicKeyPath != <span class=\"hljs-literal\">null</span>) {\n            publicKey = RsaUtils.getPublicKey(publicKeyPath);\n        }\n        <span class=\"hljs-keyword\">if</span> (privateKeyPath != <span class=\"hljs-literal\">null</span>) {\n            privateKey = RsaUtils.getPrivateKey(privateKeyPath);\n        }\n    }\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1278,1301"}},{"content":"<pre data-lines=\"1302,1303\"><code>com.caochenlei.SourceProductApplication&#xff08;&#x8fd9;&#x91cc;&#x6ce8;&#x610f;&#x542f;&#x52a8;&#x7c7b;&#x540d;&#x79f0;&#xff09;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1302,1303"}},{"content":"<pre data-lines=\"1304,1314\"><code class=\"language-java\"><span class=\"hljs-meta\">@SpringBootApplication</span>\n<span class=\"hljs-meta\">@EnableConfigurationProperties(RsaKeyProperties.class)</span>\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">SourceProductApplication</span> {\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">main</span><span class=\"hljs-params\">(String[] args)</span> {\n        SpringApplication.run(SourceProductApplication.class, args);\n    }\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1304,1314"}}],"payload":{"tag":"h2","lines":"1273,1275"}},{"content":"7.4&#x3001;&#x7f16;&#x5199;&#x5de5;&#x5177;&#x7c7b;","children":[{"content":"<pre data-lines=\"1318,1319\"><code>com.caochenlei.utils.RequestUtils\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1318,1319"}},{"content":"<pre data-lines=\"1320,1337\"><code class=\"language-java\">\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">RequestUtils</span> {\n    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">final</span> <span class=\"hljs-type\">Logger</span> <span class=\"hljs-variable\">logger</span> <span class=\"hljs-operator\">=</span> LoggerFactory.getLogger(RequestUtils.class);\n\n    \n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> &lt;T&gt; T <span class=\"hljs-title function_\">read</span><span class=\"hljs-params\">(HttpServletRequest request, Class&lt;T&gt; clazz)</span> {\n        <span class=\"hljs-keyword\">try</span> {\n            <span class=\"hljs-keyword\">return</span> JsonUtils.toBean(request.getInputStream(), clazz);\n        } <span class=\"hljs-keyword\">catch</span> (Exception e) {\n            logger.error(<span class=\"hljs-string\">&quot;&#x8bfb;&#x53d6;&#x51fa;&#x9519;&#xff1a;&quot;</span> + clazz, e);\n            <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">null</span>;\n        }\n    }\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1320,1337"}},{"content":"<pre data-lines=\"1338,1339\"><code>com.caochenlei.utils.ResponseUtils\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1338,1339"}},{"content":"<pre data-lines=\"1340,1364\"><code class=\"language-java\">\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">ResponseUtils</span> {\n    <span class=\"hljs-keyword\">private</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">final</span> <span class=\"hljs-type\">Logger</span> <span class=\"hljs-variable\">logger</span> <span class=\"hljs-operator\">=</span> LoggerFactory.getLogger(ResponseUtils.class);\n\n    \n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">static</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">write</span><span class=\"hljs-params\">(HttpServletResponse response, <span class=\"hljs-type\">int</span> status, String msg)</span> {\n        <span class=\"hljs-keyword\">try</span> {\n            response.setHeader(<span class=\"hljs-string\">&quot;Access-Control-Allow-Origin&quot;</span>, <span class=\"hljs-string\">&quot;*&quot;</span>);\n            response.setHeader(<span class=\"hljs-string\">&quot;Cache-Control&quot;</span>, <span class=\"hljs-string\">&quot;no-cache&quot;</span>);\n            response.setCharacterEncoding(<span class=\"hljs-string\">&quot;UTF-8&quot;</span>);\n            response.setContentType(<span class=\"hljs-string\">&quot;application/json&quot;</span>);\n            response.setStatus(status);\n            <span class=\"hljs-type\">PrintWriter</span> <span class=\"hljs-variable\">out</span> <span class=\"hljs-operator\">=</span> response.getWriter();\n            out.write(JsonUtils.toString(<span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Result</span>(status, msg, <span class=\"hljs-literal\">null</span>)));\n            out.flush();\n            out.close();\n        } <span class=\"hljs-keyword\">catch</span> (Exception e) {\n            logger.error(<span class=\"hljs-string\">&quot;&#x54cd;&#x5e94;&#x51fa;&#x9519;&#xff1a;&quot;</span> + msg, e);\n        }\n    }\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1340,1364"}}],"payload":{"tag":"h2","lines":"1315,1317"}},{"content":"7.5&#x3001;&#x7f16;&#x5199;&#x9a8c;&#x8bc1;&#x8fc7;&#x6ee4;&#x5668;","children":[{"content":"<pre data-lines=\"1368,1369\"><code>com.caochenlei.filter.JwtVerificationFilter\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1368,1369"}},{"content":"<pre data-lines=\"1370,1409\"><code class=\"language-java\">\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">JwtVerificationFilter</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title class_\">BasicAuthenticationFilter</span> {\n    <span class=\"hljs-keyword\">private</span> RsaKeyProperties prop;\n\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-title function_\">JwtVerificationFilter</span><span class=\"hljs-params\">(AuthenticationManager authenticationManager, RsaKeyProperties prop)</span> {\n        <span class=\"hljs-built_in\">super</span>(authenticationManager);\n        <span class=\"hljs-built_in\">this</span>.prop = prop;\n    }\n\n    <span class=\"hljs-meta\">@Override</span>\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">doFilterInternal</span><span class=\"hljs-params\">(HttpServletRequest request, HttpServletResponse response, FilterChain chain)</span> <span class=\"hljs-keyword\">throws</span> IOException, ServletException {\n        <span class=\"hljs-keyword\">try</span> {\n            <span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">header</span> <span class=\"hljs-operator\">=</span> request.getHeader(<span class=\"hljs-string\">&quot;Authorization&quot;</span>);\n            <span class=\"hljs-keyword\">if</span> (header == <span class=\"hljs-literal\">null</span> || !header.startsWith(<span class=\"hljs-string\">&quot;Bearer &quot;</span>)) {\n                \n                chain.doFilter(request, response);\n                ResponseUtils.write(response, HttpServletResponse.SC_FORBIDDEN, <span class=\"hljs-string\">&quot;&#x7528;&#x6237;&#x975e;&#x6cd5;&#x767b;&#x5f55;&#xff01;&quot;</span>);\n            } <span class=\"hljs-keyword\">else</span> {\n                \n                <span class=\"hljs-type\">String</span> <span class=\"hljs-variable\">token</span> <span class=\"hljs-operator\">=</span> header.replace(<span class=\"hljs-string\">&quot;Bearer &quot;</span>, <span class=\"hljs-string\">&quot;&quot;</span>);\n                \n                Payload&lt;SysUser&gt; payload = JwtUtils.getInfoFromToken(token, prop.getPublicKey(), SysUser.class);\n                <span class=\"hljs-type\">SysUser</span> <span class=\"hljs-variable\">sysUser</span> <span class=\"hljs-operator\">=</span> payload.getUserInfo();\n                <span class=\"hljs-keyword\">if</span> (sysUser != <span class=\"hljs-literal\">null</span>) {\n                    <span class=\"hljs-type\">UsernamePasswordAuthenticationToken</span> <span class=\"hljs-variable\">authResult</span> <span class=\"hljs-operator\">=</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">UsernamePasswordAuthenticationToken</span>(sysUser.getUsername(), <span class=\"hljs-literal\">null</span>, sysUser.getAuthorities());\n                    SecurityContextHolder.getContext().setAuthentication(authResult);\n                    chain.doFilter(request, response);\n                } <span class=\"hljs-keyword\">else</span> {\n                    ResponseUtils.write(response, HttpServletResponse.SC_FORBIDDEN, <span class=\"hljs-string\">&quot;&#x7528;&#x6237;&#x9a8c;&#x8bc1;&#x5931;&#x8d25;&#xff01;&quot;</span>);\n                }\n            }\n        } <span class=\"hljs-keyword\">catch</span> (ExpiredJwtException e) {\n            ResponseUtils.write(response, HttpServletResponse.SC_FORBIDDEN, <span class=\"hljs-string\">&quot;&#x8bf7;&#x60a8;&#x91cd;&#x65b0;&#x767b;&#x5f55;&#xff01;&quot;</span>);\n        }\n    }\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1370,1409"}}],"payload":{"tag":"h2","lines":"1365,1367"}},{"content":"7.6&#x3001;&#x7f16;&#x5199;&#x5b89;&#x5168;&#x914d;&#x7f6e;&#x7c7b;","children":[{"content":"<pre data-lines=\"1413,1414\"><code>com.caochenlei.config.WebSecurityConfig\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1413,1414"}},{"content":"<pre data-lines=\"1415,1438\"><code class=\"language-java\"><span class=\"hljs-meta\">@Configuration</span>\n<span class=\"hljs-meta\">@EnableWebSecurity</span>\n<span class=\"hljs-meta\">@EnableGlobalMethodSecurity(securedEnabled = true)</span>\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">WebSecurityConfig</span> <span class=\"hljs-keyword\">extends</span> <span class=\"hljs-title class_\">WebSecurityConfigurerAdapter</span> {\n    <span class=\"hljs-meta\">@Autowired</span>\n    <span class=\"hljs-keyword\">private</span> RsaKeyProperties prop;\n\n    <span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">void</span> <span class=\"hljs-title function_\">configure</span><span class=\"hljs-params\">(HttpSecurity http)</span> <span class=\"hljs-keyword\">throws</span> Exception {\n        \n        http.csrf().disable();\n        \n        http.cors().disable();\n        \n        http.sessionManagement().disable();\n        \n        http.formLogin().disable();\n        \n        http.addFilter(<span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">JwtVerificationFilter</span>(<span class=\"hljs-built_in\">super</span>.authenticationManager(), prop));\n    }\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1415,1438"}}],"payload":{"tag":"h2","lines":"1410,1412"}},{"content":"7.7&#x3001;&#x914d;&#x5168;&#x5c40;&#x5f02;&#x5e38;&#x5904;&#x7406;","children":[{"content":"<pre data-lines=\"1442,1443\"><code>com.caochenlei.exception.GlobalExceptionHandler\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1442,1443"}},{"content":"<pre data-lines=\"1444,1459\"><code class=\"language-java\"><span class=\"hljs-meta\">@RestControllerAdvice</span>\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">GlobalExceptionHandler</span> {\n    <span class=\"hljs-meta\">@ExceptionHandler(AccessDeniedException.class)</span>\n    <span class=\"hljs-keyword\">public</span> Result <span class=\"hljs-title function_\">accessDeniedException</span><span class=\"hljs-params\">()</span> {\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Result</span>(<span class=\"hljs-number\">403</span>, <span class=\"hljs-string\">&quot;&#x7528;&#x6237;&#x6743;&#x9650;&#x4e0d;&#x8db3;&#xff01;&quot;</span>, <span class=\"hljs-literal\">null</span>);\n    }\n\n    <span class=\"hljs-meta\">@ExceptionHandler(RuntimeException.class)</span>\n    <span class=\"hljs-keyword\">public</span> Result <span class=\"hljs-title function_\">serverException</span><span class=\"hljs-params\">()</span> {\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Result</span>(<span class=\"hljs-number\">500</span>, <span class=\"hljs-string\">&quot;&#x670d;&#x52a1;&#x51fa;&#x73b0;&#x5f02;&#x5e38;&#xff01;&quot;</span>, <span class=\"hljs-literal\">null</span>);\n    }\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1444,1459"}}],"payload":{"tag":"h2","lines":"1439,1441"}},{"content":"7.8&#x3001;&#x4ea7;&#x54c1;&#x8d44;&#x6e90;&#x63a7;&#x5236;&#x5668;","children":[{"content":"<pre data-lines=\"1463,1464\"><code>com.caochenlei.controller.OrderController\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1463,1464"}},{"content":"<pre data-lines=\"1465,1477\"><code class=\"language-java\"><span class=\"hljs-meta\">@RestController</span>\n<span class=\"hljs-meta\">@RequestMapping(&quot;/product&quot;)</span>\n<span class=\"hljs-keyword\">public</span> <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">ProductController</span> {\n    <span class=\"hljs-meta\">@Secured({&quot;ROLE_ADMIN&quot;, &quot;ROLE_PRODUCT&quot;})</span>\n    <span class=\"hljs-meta\">@RequestMapping(&quot;/info&quot;)</span>\n    <span class=\"hljs-keyword\">public</span> String <span class=\"hljs-title function_\">info</span><span class=\"hljs-params\">()</span> {\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-string\">&quot;Productr Controller ...&quot;</span>;\n    }\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1465,1477"}}],"payload":{"tag":"h2","lines":"1460,1462"}},{"content":"8.1&#x3001;&#x8ba4;&#x8bc1;&#x670d;&#x52a1;&#x6d4b;&#x8bd5;","children":[{"content":"<img src=\"https://img-blog.csdnimg.cn/img_convert/858c29d3d19ab377a8d894264a46ad2a.png\" alt>","children":[],"payload":{"tag":"img","lines":"1481,1482"}}],"payload":{"tag":"h2","lines":"1478,1480"}},{"content":"8.2&#x3001;&#x8ba2;&#x5355;&#x8d44;&#x6e90;&#x6d4b;&#x8bd5;","children":[{"content":"<img src=\"https://img-blog.csdnimg.cn/img_convert/d57c1947374d0d4aeea79000727be850.png\" alt>","children":[],"payload":{"tag":"img","lines":"1486,1487"}}],"payload":{"tag":"h2","lines":"1483,1485"}},{"content":"8.3&#x3001;&#x4ea7;&#x54c1;&#x8d44;&#x6e90;&#x6d4b;&#x8bd5;","children":[{"content":"<img src=\"https://img-blog.csdnimg.cn/img_convert/fdf131b345081d58632b261b26dbd2d2.png\" alt>","children":[],"payload":{"tag":"img","lines":"1491,1492"}}],"payload":{"tag":"h2","lines":"1488,1490"}},{"content":"8.4&#x3001;&#x7528;&#x6237;&#x72b6;&#x6001;&#x6d4b;&#x8bd5;","children":[{"content":"<pre data-lines=\"1496,1497\"><code>&#x5f20;&#x4e09;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1496,1497"}},{"content":"<img src=\"https://img-blog.csdnimg.cn/img_convert/938e7b6787846d02ce45b6a3f2cc789e.png\" alt>","children":[],"payload":{"tag":"img","lines":"1498,1499"}},{"content":"<pre data-lines=\"1500,1501\"><code>&#x674e;&#x56db;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1500,1501"}},{"content":"<img src=\"https://img-blog.csdnimg.cn/img_convert/b7e4d66773f1e4a35b49865600d4b880.png\" alt>","children":[],"payload":{"tag":"img","lines":"1502,1503"}},{"content":"<pre data-lines=\"1504,1505\"><code>&#x738b;&#x4e94;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1504,1505"}},{"content":"<img src=\"https://img-blog.csdnimg.cn/img_convert/d32192f0eb9f596ff603492fe3508949.png\" alt>","children":[],"payload":{"tag":"img","lines":"1506,1507"}},{"content":"<pre data-lines=\"1508,1509\"><code>&#x8d75;&#x516d;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1508,1509"}},{"content":"<img src=\"https://img-blog.csdnimg.cn/img_convert/80624cf417db22c1a90178d0f68347e8.png\" alt>","children":[],"payload":{"tag":"img","lines":"1510,1511"}},{"content":"<img src=\"https://img-blog.csdnimg.cn/img_convert/73e6067147594d8f99e39712f1b1b42e.png\" alt>","children":[],"payload":{"tag":"img","lines":"1514,1515"}},{"content":"<pre data-lines=\"1516,1517\"><code>&#x8001;&#x516b;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1516,1517"}},{"content":"<img src=\"https://img-blog.csdnimg.cn/img_convert/851b93513e927a017fba9c176bfe376e.png\" alt>","children":[],"payload":{"tag":"img","lines":"1518,1519"}},{"content":"<pre data-lines=\"1520,1521\"><code>&#x5bc6;&#x7801;&#x9519;&#x8bef;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1520,1521"}},{"content":"<img src=\"https://img-blog.csdnimg.cn/img_convert/9b18b29ffb6b447df1fc9d4f12e8131a.png\" alt>","children":[],"payload":{"tag":"img","lines":"1522,1523"}}],"payload":{"tag":"h2","lines":"1493,1495"}}],"payload":{"tag":"h1","lines":"0,1"}},{})</script>
</body>
</html>
