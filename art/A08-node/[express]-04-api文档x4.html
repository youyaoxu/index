<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets@11.11.1/styles/default.min.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.18.10/dist/browser/index.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/index.js"></script><script>(r => {
              setTimeout(r);
            })(function renderToolbar() {
  const {
    markmap,
    mm
  } = window;
  const {
    el
  } = markmap.Toolbar.create(mm);
  el.setAttribute('style', 'position:absolute;bottom:20px;right:20px');
  document.body.append(el);
})</script><script>((getMarkmap, getOptions, root2, jsonOptions) => {
              const markmap = getMarkmap();
              window.mm = markmap.Markmap.create(
                "svg#mindmap",
                (getOptions || markmap.deriveOptions)(jsonOptions),
                root2
              );
            })(() => window.markmap,null,{"content":"","children":[{"content":"API &#x6587;&#x6863; 4.x","children":[],"payload":{"tag":"h1","lines":"0,1"}},{"content":"express()","children":[{"content":"<pre data-lines=\"4,10\"><code data-lines=\"4,10\">&#x5e94;&#x7528;\n&#x8bf7;&#x6c42;\n&#x54cd;&#x5e94;\n&#x8def;&#x7531;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"4,10"}}],"payload":{"tag":"h1","lines":"2,3"}},{"content":"express()","children":[{"content":"","children":[{"content":"<pre data-lines=\"14,22\"><code data-lines=\"14,22\">express<span class=\"hljs-selector-class\">.json</span>(<span class=\"hljs-selector-attr\">[options]</span>)\nexpress<span class=\"hljs-selector-class\">.raw</span>(<span class=\"hljs-selector-attr\">[options]</span>)\nexpress<span class=\"hljs-selector-class\">.Router</span>(<span class=\"hljs-selector-attr\">[options]</span>)\nexpress<span class=\"hljs-selector-class\">.static</span>(root, <span class=\"hljs-selector-attr\">[options]</span>)\nexpress<span class=\"hljs-selector-class\">.text</span>(<span class=\"hljs-selector-attr\">[options]</span>)\nexpress<span class=\"hljs-selector-class\">.urlencoded</span>(<span class=\"hljs-selector-attr\">[options]</span>)\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"14,22"}},{"content":"<pre data-lines=\"23,24\"><code>&#x521b;&#x5efa;&#x4e00;&#x4e2a; Express &#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x3002;express() &#x51fd;&#x6570;&#x662f; express &#x6a21;&#x5757;&#x5bfc;&#x51fa;&#x7684;&#x9876;&#x7ea7;&#x51fd;&#x6570;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"23,24"}},{"content":"<pre data-lines=\"25,29\"><code class=\"language-js\"><span class=\"hljs-keyword\">var</span> express = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;express&apos;</span>)\n<span class=\"hljs-keyword\">var</span> app = <span class=\"hljs-title function_\">express</span>()\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"25,29"}}],"payload":{"tag":"h2","lines":"13,14"}},{"content":"express.json([options])&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"32,43\"><code>&#x6b64;&#x4e2d;&#x95f4;&#x4ef6;&#x5728; Express v4.16.0 &#x53ca;&#x66f4;&#x9ad8;&#x7248;&#x672c;&#x4e2d;&#x53ef;&#x7528;&#x3002;\n\n&#x8fd9;&#x662f; Express &#x4e2d;&#x5185;&#x7f6e;&#x7684;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x3002;&#x5b83;&#x4f7f;&#x7528; JSON &#x6709;&#x6548;&#x8d1f;&#x8f7d;&#x89e3;&#x6790;&#x4f20;&#x5165;&#x8bf7;&#x6c42;&#xff0c;&#x5e76;&#x4e14;&#x57fa;&#x4e8e; body-parser&#x3002;\n\n&#x8fd4;&#x56de;&#x4ec5;&#x89e3;&#x6790; JSON &#x5e76;&#x4e14;&#x4ec5;&#x67e5;&#x770b; Content-Type &#x6807;&#x5934;&#x4e0e; type &#x9009;&#x9879;&#x5339;&#x914d;&#x7684;&#x8bf7;&#x6c42;&#x7684;&#x4e2d;&#x95f4;&#x4ef6;&#x3002;&#x6b64;&#x89e3;&#x6790;&#x5668;&#x63a5;&#x53d7;&#x6b63;&#x6587;&#x7684;&#x4efb;&#x4f55;&#x200b;&#x200b; Unicode &#x7f16;&#x7801;&#xff0c;&#x5e76;&#x652f;&#x6301; gzip &#x548c; deflate &#x7f16;&#x7801;&#x7684;&#x81ea;&#x52a8;&#x81a8;&#x80c0;&#x3002;\n\n&#x5305;&#x542b;&#x89e3;&#x6790;&#x6570;&#x636e;&#x7684;&#x65b0; body &#x5bf9;&#x8c61;&#x5728;&#x4e2d;&#x95f4;&#x4ef6;&#xff08;&#x5373; req.body&#xff09;&#x4e4b;&#x540e;&#x586b;&#x5145;&#x5230; request &#x5bf9;&#x8c61;&#x4e0a;&#xff0c;&#x5982;&#x679c;&#x6ca1;&#x6709;&#x8981;&#x89e3;&#x6790;&#x7684;&#x4e3b;&#x4f53;&#x3001;Content-Type &#x4e0d;&#x5339;&#x914d;&#x6216;&#x53d1;&#x751f;&#x9519;&#x8bef;&#xff0c;&#x5219;&#x586b;&#x5145;&#x4e00;&#x4e2a;&#x7a7a;&#x5bf9;&#x8c61;&#xff08;{}&#xff09;&#x3002;\n\n&#x7531;&#x4e8e; req.body &#x7684;&#x5f62;&#x72b6;&#x57fa;&#x4e8e;&#x7528;&#x6237;&#x63a7;&#x5236;&#x7684;&#x8f93;&#x5165;&#xff0c;&#x56e0;&#x6b64;&#x8be5;&#x5bf9;&#x8c61;&#x4e2d;&#x7684;&#x6240;&#x6709;&#x5c5e;&#x6027;&#x548c;&#x503c;&#x90fd;&#x662f;&#x4e0d;&#x53ef;&#x4fe1;&#x7684;&#xff0c;&#x5e94;&#x8be5;&#x5728;&#x4fe1;&#x4efb;&#x4e4b;&#x524d;&#x8fdb;&#x884c;&#x9a8c;&#x8bc1;&#x3002;&#x4f8b;&#x5982;&#xff0c;req.body.foo.toString() &#x53ef;&#x80fd;&#x4ee5;&#x591a;&#x79cd;&#x65b9;&#x5f0f;&#x5931;&#x8d25;&#xff0c;&#x4f8b;&#x5982; foo &#x53ef;&#x80fd;&#x4e0d;&#x5b58;&#x5728;&#x6216;&#x53ef;&#x80fd;&#x4e0d;&#x662f;&#x5b57;&#x7b26;&#x4e32;&#xff0c;toString &#x53ef;&#x80fd;&#x4e0d;&#x662f;&#x51fd;&#x6570;&#xff0c;&#x800c;&#x662f;&#x5b57;&#x7b26;&#x4e32;&#x6216;&#x5176;&#x4ed6;&#x7528;&#x6237;&#x8f93;&#x5165;&#x3002;\n\n&#x4e0b;&#x8868;&#x63cf;&#x8ff0;&#x4e86;&#x53ef;&#x9009; options &#x5bf9;&#x8c61;&#x7684;&#x5c5e;&#x6027;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"32,43"}},{"content":"<pre data-lines=\"44,53\"><code data-lines=\"44,53\">&#x5c5e;&#x6027;\t&#x63cf;&#x8ff0;\t&#x7c7b;&#x578b;\t&#x9ed8;&#x8ba4;\ninflate\t&#x542f;&#x7528;&#x6216;&#x7981;&#x7528;&#x5904;&#x7406;&#x653e;&#x6c14;&#xff08;&#x538b;&#x7f29;&#xff09;&#x7684;&#x4e3b;&#x4f53;&#xff1b;&#x5f53;&#x7981;&#x7528;&#x65f6;&#xff0c;&#x762a;&#x7684;&#x4e3b;&#x4f53;&#x4f1a;&#x88ab;&#x62d2;&#x7edd;&#x3002;\t&#x5e03;&#x5c14;&#x503c;\t<span class=\"hljs-keyword\">true</span>\n<span class=\"hljs-keyword\">limit</span>\t&#x63a7;&#x5236;&#x6700;&#x5927;&#x8bf7;&#x6c42;&#x6b63;&#x6587;&#x5927;&#x5c0f;&#x3002;&#x5982;&#x679c;&#x8fd9;&#x662f;&#x4e00;&#x4e2a;&#x6570;&#x5b57;&#xff0c;&#x5219;&#x8be5;&#x503c;&#x6307;&#x5b9a;&#x5b57;&#x8282;&#x6570;&#xff1b;&#x5982;&#x679c;&#x662f;&#x5b57;&#x7b26;&#x4e32;&#xff0c;&#x5219;&#x5c06;&#x503c;&#x4f20;&#x9012;&#x7ed9;bytes&#x5e93;&#x8fdb;&#x884c;&#x89e3;&#x6790;&#x3002;\t&#x6df7;&#x5408;\t&quot;100kb&quot;\nreviver\treviver &#x9009;&#x9879;&#x4f5c;&#x4e3a;&#x7b2c;&#x4e8c;&#x4e2a;&#x53c2;&#x6570;&#x76f4;&#x63a5;&#x4f20;&#x9012;&#x7ed9; <span class=\"hljs-type\">JSON</span>.parse&#x3002;&#x60a8;&#x53ef;&#x4ee5;&#x627e;&#x5230;&#x6709;&#x5173;&#x6b64;&#x8bba;&#x70b9; &#x5728;&#x5173;&#x4e8e; <span class=\"hljs-type\">JSON</span>.parse &#x7684; MDN &#x6587;&#x6863;&#x4e2d; &#x7684;&#x66f4;&#x591a;&#x4fe1;&#x606f;&#x3002;\t&#x51fd;&#x6570;\t<span class=\"hljs-keyword\">null</span>\n<span class=\"hljs-keyword\">strict</span>\t&#x542f;&#x7528;&#x6216;&#x7981;&#x7528;&#x4ec5;&#x63a5;&#x53d7;&#x6570;&#x7ec4;&#x548c;&#x5bf9;&#x8c61;&#xff1b;&#x7981;&#x7528;&#x65f6;&#x5c06;&#x63a5;&#x53d7; <span class=\"hljs-type\">JSON</span>.parse &#x63a5;&#x53d7;&#x7684;&#x4efb;&#x4f55;&#x5185;&#x5bb9;&#x3002;\t&#x5e03;&#x5c14;&#x503c;\t<span class=\"hljs-keyword\">true</span>\n<span class=\"hljs-keyword\">type</span>\t&#x8fd9;&#x7528;&#x4e8e;&#x786e;&#x5b9a;&#x4e2d;&#x95f4;&#x4ef6;&#x5c06;&#x89e3;&#x6790;&#x7684;&#x5a92;&#x4f53;&#x7c7b;&#x578b;&#x3002;&#x6b64;&#x9009;&#x9879;&#x53ef;&#x4ee5;&#x662f;&#x5b57;&#x7b26;&#x4e32;&#x3001;&#x5b57;&#x7b26;&#x4e32;&#x6570;&#x7ec4;&#x6216;&#x51fd;&#x6570;&#x3002;&#x5982;&#x679c;&#x4e0d;&#x662f;&#x51fd;&#x6570;&#xff0c;&#x5219; <span class=\"hljs-keyword\">type</span> &#x9009;&#x9879;&#x76f4;&#x63a5;&#x4f20;&#x9012;&#x7ed9; <span class=\"hljs-keyword\">type</span>-<span class=\"hljs-keyword\">is</span> &#x5e93;&#xff0c;&#x5b83;&#x53ef;&#x4ee5;&#x662f;&#x6269;&#x5c55;&#x540d;&#xff08;&#x5982; <span class=\"hljs-type\">json</span>&#xff09;&#x3001;mime &#x7c7b;&#x578b;&#xff08;&#x5982; application/<span class=\"hljs-type\">json</span>&#xff09;&#x6216;&#x5e26;&#x6709;&#x901a;&#x914d;&#x7b26;&#x7684; mime &#x7c7b;&#x578b;&#xff08;&#x5982; *<span class=\"hljs-comment\">/* &#x6216; */</span><span class=\"hljs-type\">json</span>&#xff09;&#x3002;&#x5982;&#x679c;&#x662f;&#x51fd;&#x6570;&#xff0c;&#x5219; <span class=\"hljs-keyword\">type</span> &#x9009;&#x9879;&#x88ab;&#x79f0;&#x4e3a; fn(req)&#xff0c;&#x5982;&#x679c;&#x8bf7;&#x6c42;&#x8fd4;&#x56de;&#x771f;&#x503c;&#xff0c;&#x5219;&#x89e3;&#x6790;&#x8bf7;&#x6c42;&#x3002;\t&#x6df7;&#x5408;\t&quot;application/json&quot;\nverify\t&#x6b64;&#x9009;&#x9879;&#xff08;&#x5982;&#x679c;&#x63d0;&#x4f9b;&#xff09;&#x79f0;&#x4e3a; verify(req, res, buf, <span class=\"hljs-keyword\">encoding</span>)&#xff0c;&#x5176;&#x4e2d; buf &#x662f;&#x539f;&#x59cb;&#x8bf7;&#x6c42;&#x6b63;&#x6587;&#x7684; Buffer&#xff0c;<span class=\"hljs-keyword\">encoding</span> &#x662f;&#x8bf7;&#x6c42;&#x7684;&#x7f16;&#x7801;&#x3002;&#x53ef;&#x4ee5;&#x901a;&#x8fc7;&#x629b;&#x51fa;&#x9519;&#x8bef;&#x6765;&#x4e2d;&#x6b62;&#x89e3;&#x6790;&#x3002;\t&#x51fd;&#x6570;\tundefined\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"44,53"}}],"payload":{"tag":"h2","lines":"30,31"}},{"content":"express.raw([options])","children":[{"content":"<pre data-lines=\"56,67\"><code>&#x6b64;&#x4e2d;&#x95f4;&#x4ef6;&#x5728; Express v4.17.0 &#x53ca;&#x66f4;&#x9ad8;&#x7248;&#x672c;&#x4e2d;&#x53ef;&#x7528;&#x3002;\n\n&#x8fd9;&#x662f; Express &#x4e2d;&#x5185;&#x7f6e;&#x7684;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x3002;&#x5b83;&#x5c06;&#x4f20;&#x5165;&#x7684;&#x8bf7;&#x6c42;&#x6709;&#x6548;&#x8d1f;&#x8f7d;&#x89e3;&#x6790;&#x4e3a; Buffer&#xff0c;&#x5e76;&#x57fa;&#x4e8e; body-parser&#x3002;\n\n&#x8fd4;&#x56de;&#x5c06;&#x6240;&#x6709;&#x4e3b;&#x4f53;&#x89e3;&#x6790;&#x4e3a; Buffer &#x5e76;&#x4ec5;&#x67e5;&#x770b; Content-Type &#x6807;&#x5934;&#x4e0e; type &#x9009;&#x9879;&#x5339;&#x914d;&#x7684;&#x8bf7;&#x6c42;&#x7684;&#x4e2d;&#x95f4;&#x4ef6;&#x3002;&#x6b64;&#x89e3;&#x6790;&#x5668;&#x63a5;&#x53d7;&#x6b63;&#x6587;&#x7684;&#x4efb;&#x4f55;&#x200b;&#x200b; Unicode &#x7f16;&#x7801;&#xff0c;&#x5e76;&#x652f;&#x6301; gzip &#x548c; deflate &#x7f16;&#x7801;&#x7684;&#x81ea;&#x52a8;&#x81a8;&#x80c0;&#x3002;\n\n&#x5305;&#x542b;&#x89e3;&#x6790;&#x6570;&#x636e;&#x7684;&#x65b0; body Buffer &#x586b;&#x5145;&#x5728;&#x4e2d;&#x95f4;&#x4ef6;&#x4e4b;&#x540e;&#x7684; request &#x5bf9;&#x8c61;&#xff08;&#x5373; req.body&#xff09;&#x4e0a;&#xff0c;&#x5982;&#x679c;&#x6ca1;&#x6709;&#x8981;&#x89e3;&#x6790;&#x7684;&#x4e3b;&#x4f53;&#x3001;Content-Type &#x4e0d;&#x5339;&#x914d;&#x6216;&#x53d1;&#x751f;&#x9519;&#x8bef;&#xff0c;&#x5219;&#x586b;&#x5145;&#x4e00;&#x4e2a;&#x7a7a;&#x5bf9;&#x8c61;&#xff08;{}&#xff09;&#x3002;\n\n&#x7531;&#x4e8e; req.body &#x7684;&#x5f62;&#x72b6;&#x57fa;&#x4e8e;&#x7528;&#x6237;&#x63a7;&#x5236;&#x7684;&#x8f93;&#x5165;&#xff0c;&#x56e0;&#x6b64;&#x8be5;&#x5bf9;&#x8c61;&#x4e2d;&#x7684;&#x6240;&#x6709;&#x5c5e;&#x6027;&#x548c;&#x503c;&#x90fd;&#x662f;&#x4e0d;&#x53ef;&#x4fe1;&#x7684;&#xff0c;&#x5e94;&#x8be5;&#x5728;&#x4fe1;&#x4efb;&#x4e4b;&#x524d;&#x8fdb;&#x884c;&#x9a8c;&#x8bc1;&#x3002;&#x4f8b;&#x5982;&#xff0c;req.body.toString() &#x53ef;&#x80fd;&#x4ee5;&#x591a;&#x79cd;&#x65b9;&#x5f0f;&#x5931;&#x8d25;&#xff0c;&#x4f8b;&#x5982;&#x5806;&#x53e0;&#x591a;&#x4e2a;&#x89e3;&#x6790;&#x5668; req.body &#x53ef;&#x80fd;&#x6765;&#x81ea;&#x4e0d;&#x540c;&#x7684;&#x89e3;&#x6790;&#x5668;&#x3002;&#x5efa;&#x8bae;&#x5728;&#x8c03;&#x7528;&#x7f13;&#x51b2;&#x533a;&#x65b9;&#x6cd5;&#x4e4b;&#x524d;&#x6d4b;&#x8bd5; req.body &#x662f; Buffer&#x3002;\n\n&#x4e0b;&#x8868;&#x63cf;&#x8ff0;&#x4e86;&#x53ef;&#x9009; options &#x5bf9;&#x8c61;&#x7684;&#x5c5e;&#x6027;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"56,67"}},{"content":"<pre data-lines=\"68,75\"><code data-lines=\"68,75\">&#x5c5e;&#x6027;\t&#x63cf;&#x8ff0;\t&#x7c7b;&#x578b;\t&#x9ed8;&#x8ba4;\ninflate\t&#x542f;&#x7528;&#x6216;&#x7981;&#x7528;&#x5904;&#x7406;&#x653e;&#x6c14;&#xff08;&#x538b;&#x7f29;&#xff09;&#x7684;&#x4e3b;&#x4f53;&#xff1b;&#x5f53;&#x7981;&#x7528;&#x65f6;&#xff0c;&#x762a;&#x7684;&#x4e3b;&#x4f53;&#x4f1a;&#x88ab;&#x62d2;&#x7edd;&#x3002;\t&#x5e03;&#x5c14;&#x503c;\t<span class=\"hljs-literal\">true</span>\nlimit\t&#x63a7;&#x5236;&#x6700;&#x5927;&#x8bf7;&#x6c42;&#x6b63;&#x6587;&#x5927;&#x5c0f;&#x3002;&#x5982;&#x679c;&#x8fd9;&#x662f;&#x4e00;&#x4e2a;&#x6570;&#x5b57;&#xff0c;&#x5219;&#x8be5;&#x503c;&#x6307;&#x5b9a;&#x5b57;&#x8282;&#x6570;&#xff1b;&#x5982;&#x679c;&#x662f;&#x5b57;&#x7b26;&#x4e32;&#xff0c;&#x5219;&#x5c06;&#x503c;&#x4f20;&#x9012;&#x7ed9;bytes&#x5e93;&#x8fdb;&#x884c;&#x89e3;&#x6790;&#x3002;\t&#x6df7;&#x5408;\t<span class=\"hljs-string\">&quot;100kb&quot;</span>\n<span class=\"hljs-keyword\">type</span>\t<span class=\"hljs-type\">&#x8fd9;&#x7528;&#x4e8e;&#x786e;&#x5b9a;&#x4e2d;&#x95f4;&#x4ef6;&#x5c06;&#x89e3;&#x6790;&#x7684;&#x5a92;&#x4f53;&#x7c7b;&#x578b;&#x3002;&#x6b64;&#x9009;&#x9879;&#x53ef;&#x4ee5;&#x662f;&#x5b57;&#x7b26;&#x4e32;&#x3001;&#x5b57;&#x7b26;&#x4e32;&#x6570;&#x7ec4;&#x6216;&#x51fd;&#x6570;&#x3002;&#x5982;&#x679c;&#x4e0d;&#x662f;&#x51fd;&#x6570;&#xff0c;&#x5219; </span><span class=\"hljs-keyword\">type</span> <span class=\"hljs-type\">&#x9009;&#x9879;&#x76f4;&#x63a5;&#x4f20;&#x9012;&#x7ed9; </span><span class=\"hljs-keyword\">type</span>-<span class=\"hljs-keyword\">is</span> &#x5e93;&#xff0c;&#x5b83;&#x53ef;&#x4ee5;&#x662f;&#x6269;&#x5c55;&#x540d;&#xff08;&#x5982; bin&#xff09;&#x3001;mime &#x7c7b;&#x578b;&#xff08;&#x5982; application/octet-stream&#xff09;&#x6216;&#x5e26;&#x6709;&#x901a;&#x914d;&#x7b26;&#x7684; mime &#x7c7b;&#x578b;&#xff08;&#x5982; */* &#x6216; application/*&#xff09;&#x3002;&#x5982;&#x679c;&#x662f;&#x51fd;&#x6570;&#xff0c;&#x5219; <span class=\"hljs-keyword\">type</span> <span class=\"hljs-type\">&#x9009;&#x9879;&#x88ab;&#x79f0;&#x4e3a; </span>fn(req)&#xff0c;&#x5982;&#x679c;&#x8bf7;&#x6c42;&#x8fd4;&#x56de;&#x771f;&#x503c;&#xff0c;&#x5219;&#x89e3;&#x6790;&#x8bf7;&#x6c42;&#x3002;\t&#x6df7;&#x5408;\t<span class=\"hljs-string\">&quot;application/octet-stream&quot;</span>\nverify\t&#x6b64;&#x9009;&#x9879;&#xff08;&#x5982;&#x679c;&#x63d0;&#x4f9b;&#xff09;&#x79f0;&#x4e3a; verify(req, res, buf, encoding)&#xff0c;&#x5176;&#x4e2d; buf &#x662f;&#x539f;&#x59cb;&#x8bf7;&#x6c42;&#x6b63;&#x6587;&#x7684; Buffer&#xff0c;encoding &#x662f;&#x8bf7;&#x6c42;&#x7684;&#x7f16;&#x7801;&#x3002;&#x53ef;&#x4ee5;&#x901a;&#x8fc7;&#x629b;&#x51fa;&#x9519;&#x8bef;&#x6765;&#x4e2d;&#x6b62;&#x89e3;&#x6790;&#x3002;\t&#x51fd;&#x6570;\tundefined\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"68,75"}}],"payload":{"tag":"h2","lines":"54,55"}},{"content":"express.Router([options])&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"78,79\"><code>&#x521b;&#x5efa;&#x4e00;&#x4e2a;&#x65b0;&#x7684; router &#x5bf9;&#x8c61;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"78,79"}},{"content":"<pre data-lines=\"80,83\"><code class=\"language-js\"><span class=\"hljs-keyword\">var</span> router = express.<span class=\"hljs-title class_\">Router</span>([options])\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"80,83"}},{"content":"<pre data-lines=\"84,85\"><code>&#x53ef;&#x9009;&#x7684; options &#x53c2;&#x6570;&#x6307;&#x5b9a;&#x8def;&#x7531;&#x7684;&#x884c;&#x4e3a;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"84,85"}},{"content":"<pre data-lines=\"86,92\"><code data-lines=\"86,92\">&#x5c5e;&#x6027;\t&#x63cf;&#x8ff0;\t&#x9ed8;&#x8ba4;\t&#x53ef;&#x7528;&#x6027;\ncaseSensitive\t&#x542f;&#x7528;&#x533a;&#x5206;&#x5927;&#x5c0f;&#x5199;&#x3002;\t&#x9ed8;&#x8ba4;&#x7981;&#x7528;&#xff0c;&#x5c06; <span class=\"hljs-string\">&quot;/Foo&quot;</span> &#x548c; <span class=\"hljs-string\">&quot;/foo&quot;</span> &#x89c6;&#x4e3a;&#x76f8;&#x540c;&#x3002;\t\nmergeParams\t&#x4fdd;&#x7559;&#x6765;&#x81ea;&#x7236;&#x8def;&#x7531;&#x7684; req.<span class=\"hljs-keyword\">params</span> &#x503c;&#x3002;&#x5982;&#x679c;&#x7236;&#x9879;&#x548c;&#x5b50;&#x9879;&#x7684;&#x53c2;&#x6570;&#x540d;&#x79f0;&#x51b2;&#x7a81;&#xff0c;&#x5219;&#x5b50;&#x9879;&#x7684;&#x503c;&#x4f18;&#x5148;&#x3002;\t<span class=\"hljs-literal\">false</span>\t<span class=\"hljs-number\">4.5</span>.<span class=\"hljs-number\">0</span>+\nstrict\t&#x542f;&#x7528;&#x4e25;&#x683c;&#x8def;&#x7531;&#x3002;\t&#x9ed8;&#x8ba4;&#x60c5;&#x51b5;&#x4e0b;&#x7981;&#x7528;&#xff0c;&#x8def;&#x7531;&#x5bf9; <span class=\"hljs-string\">&quot;/foo&quot;</span> &#x548c; <span class=\"hljs-string\">&quot;/foo/&quot;</span> &#x7684;&#x5904;&#x7406;&#x76f8;&#x540c;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"86,92"}},{"content":"<pre data-lines=\"93,96\"><code>&#x60a8;&#x53ef;&#x4ee5;&#x50cf;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x4e00;&#x6837;&#x5c06;&#x4e2d;&#x95f4;&#x4ef6;&#x548c; HTTP &#x65b9;&#x6cd5;&#x8def;&#x7531;&#xff08;&#x4f8b;&#x5982; get&#x3001;put&#x3001;post &#x7b49;&#xff09;&#x6dfb;&#x52a0;&#x5230; router&#x3002;\n\n&#x6709;&#x5173;&#x8be6;&#x7ec6;&#x4fe1;&#x606f;&#xff0c;&#x8bf7;&#x53c2;&#x9605; &#x8def;&#x7531;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"93,96"}}],"payload":{"tag":"h2","lines":"76,77"}},{"content":"express.static(root, [options])&#x4e2d;&#x82f1;","children":[{"content":"","children":[{"content":"<pre data-lines=\"101,108\"><code>&#x8fd9;&#x662f; Express &#x4e2d;&#x5185;&#x7f6e;&#x7684;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x3002;&#x5b83;&#x63d0;&#x4f9b;&#x9759;&#x6001;&#x6587;&#x4ef6;&#xff0c;&#x57fa;&#x4e8e; serve-static&#x3002;\n\n&#x6ce8;&#x610f;&#xff1a;&#x4e3a;&#x83b7;&#x5f97;&#x6700;&#x4f73;&#x6548;&#x679c;&#xff0c;&#x4f7f;&#x7528;&#x53cd;&#x5411;&#x4ee3;&#x7406; &#x7f13;&#x5b58;&#x4ee5;&#x63d0;&#x9ad8;&#x670d;&#x52a1;&#x9759;&#x6001;&#x8d44;&#x4ea7;&#x7684;&#x6027;&#x80fd;&#x3002;\n\nroot &#x53c2;&#x6570;&#x6307;&#x5b9a;&#x63d0;&#x4f9b;&#x9759;&#x6001;&#x8d44;&#x4ea7;&#x7684;&#x6839;&#x76ee;&#x5f55;&#x3002;&#x8be5;&#x51fd;&#x6570;&#x901a;&#x8fc7;&#x5c06; req.url &#x4e0e;&#x63d0;&#x4f9b;&#x7684; root &#x76ee;&#x5f55;&#x7ec4;&#x5408;&#x6765;&#x786e;&#x5b9a;&#x8981;&#x670d;&#x52a1;&#x7684;&#x6587;&#x4ef6;&#x3002;&#x5f53;&#x627e;&#x4e0d;&#x5230;&#x6587;&#x4ef6;&#x65f6;&#xff0c;&#x5b83;&#x4e0d;&#x4f1a;&#x53d1;&#x9001; 404 &#x54cd;&#x5e94;&#xff0c;&#x800c;&#x662f;&#x8c03;&#x7528; next() &#x4ee5;&#x7ee7;&#x7eed;&#x4e0b;&#x4e00;&#x4e2a;&#x4e2d;&#x95f4;&#x4ef6;&#xff0c;&#x4ece;&#x800c;&#x5141;&#x8bb8;&#x5806;&#x53e0;&#x548c;&#x56de;&#x9000;&#x3002;\n\n&#x4e0b;&#x8868;&#x63cf;&#x8ff0;&#x4e86; options &#x5bf9;&#x8c61;&#x7684;&#x5c5e;&#x6027;&#x3002;&#x53e6;&#x89c1; &#x4e0b;&#x9762;&#x7684;&#x4f8b;&#x5b50;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"101,108"}},{"content":"<pre data-lines=\"109,130\"><code data-lines=\"109,130\">&#x5c5e;&#x6027;\t&#x63cf;&#x8ff0;\t&#x7c7b;&#x578b;\t&#x9ed8;&#x8ba4;\ndotfiles\t&#x786e;&#x5b9a;&#x5982;&#x4f55;&#x5904;&#x7406;&#x70b9;&#x6587;&#x4ef6;&#xff08;&#x4ee5;&#x70b9; <span class=\"hljs-string\">&quot;.&quot;</span> &#x5f00;&#x5934;&#x7684;&#x6587;&#x4ef6;&#x6216;&#x76ee;&#x5f55;&#xff09;&#x3002;\n\n&#x89c1;&#x4e0b;&#x6587;dotfiles&#x3002;\t&#x5b57;&#x7b26;&#x4e32;\t<span class=\"hljs-string\">&quot;ignore&quot;</span>\netag\t&#x542f;&#x7528;&#x6216;&#x7981;&#x7528; etag &#x751f;&#x6210;\n\n&#x6ce8;&#x610f;&#xff1a;express.<span class=\"hljs-keyword\">static</span> &#x603b;&#x662f;&#x53d1;&#x9001;&#x5f31; ETag&#x3002;\t&#x5e03;&#x5c14;&#x503c;\t<span class=\"hljs-keyword\">true</span>\nextensions\t&#x8bbe;&#x7f6e;&#x6587;&#x4ef6;&#x6269;&#x5c55;&#x540d;&#x540e;&#x5907;&#xff1a;&#x5982;&#x679c;&#x627e;&#x4e0d;&#x5230;&#x6587;&#x4ef6;&#xff0c;&#x8bf7;&#x641c;&#x7d22;&#x5177;&#x6709;&#x6307;&#x5b9a;&#x6269;&#x5c55;&#x540d;&#x7684;&#x6587;&#x4ef6;&#x5e76;&#x63d0;&#x4f9b;&#x7b2c;&#x4e00;&#x4e2a;&#x627e;&#x5230;&#x7684;&#x6587;&#x4ef6;&#x3002;&#x793a;&#x4f8b;&#xff1a;[<span class=\"hljs-string\">&apos;html&apos;</span>, <span class=\"hljs-string\">&apos;htm&apos;</span>]&#x3002;\t&#x6df7;&#x5408;\t<span class=\"hljs-keyword\">false</span>\nfallthrough\t&#x8ba9;&#x5ba2;&#x6237;&#x7aef;&#x9519;&#x8bef;&#x4f5c;&#x4e3a;&#x672a;&#x5904;&#x7406;&#x7684;&#x8bf7;&#x6c42;&#x901a;&#x8fc7;&#xff0c;&#x5426;&#x5219;&#x8f6c;&#x53d1;&#x5ba2;&#x6237;&#x7aef;&#x9519;&#x8bef;&#x3002;\n\n&#x89c1;&#x4e0b;&#x6587;fallthrough&#x3002;\t&#x5e03;&#x5c14;&#x503c;\t<span class=\"hljs-keyword\">true</span>\n<span class=\"hljs-keyword\">immutable</span>\t&#x5728; Cache-Control &#x54cd;&#x5e94;&#x6807;&#x5934;&#x4e2d;&#x542f;&#x7528;&#x6216;&#x7981;&#x7528; <span class=\"hljs-keyword\">immutable</span> &#x6307;&#x4ee4;&#x3002;&#x5982;&#x679c;&#x542f;&#x7528;&#xff0c;&#x8fd8;&#x5e94;&#x6307;&#x5b9a; maxAge &#x9009;&#x9879;&#x4ee5;&#x542f;&#x7528;&#x7f13;&#x5b58;&#x3002;<span class=\"hljs-keyword\">immutable</span> &#x6307;&#x4ee4;&#x5c06;&#x963b;&#x6b62;&#x53d7;&#x652f;&#x6301;&#x7684;&#x5ba2;&#x6237;&#x7aef;&#x5728; maxAge &#x9009;&#x9879;&#x7684;&#x751f;&#x547d;&#x5468;&#x671f;&#x5185;&#x53d1;&#x51fa;&#x6761;&#x4ef6;&#x8bf7;&#x6c42;&#x4ee5;&#x68c0;&#x67e5;&#x6587;&#x4ef6;&#x662f;&#x5426;&#x5df2;&#x66f4;&#x6539;&#x3002;\t&#x5e03;&#x5c14;&#x503c;\t<span class=\"hljs-keyword\">false</span>\nindex\t&#x53d1;&#x9001;&#x6307;&#x5b9a;&#x7684;&#x76ee;&#x5f55;&#x7d22;&#x5f15;&#x6587;&#x4ef6;&#x3002;&#x8bbe;&#x7f6e;&#x4e3a; <span class=\"hljs-keyword\">false</span> &#x4ee5;&#x7981;&#x7528;&#x76ee;&#x5f55;&#x7d22;&#x5f15;&#x3002;\t&#x6df7;&#x5408;\t<span class=\"hljs-string\">&quot;index.html&quot;</span>\nlastModified\t&#x5c06; Last-Modified &#x6807;&#x5934;&#x8bbe;&#x7f6e;&#x4e3a;&#x64cd;&#x4f5c;&#x7cfb;&#x7edf;&#x4e0a;&#x6587;&#x4ef6;&#x7684;&#x6700;&#x540e;&#x4fee;&#x6539;&#x65e5;&#x671f;&#x3002;\t&#x5e03;&#x5c14;&#x503c;\t<span class=\"hljs-keyword\">true</span>\nmaxAge\t&#x8bbe;&#x7f6e; Cache-Control &#x6807;&#x5934;&#x7684; max-age &#x5c5e;&#x6027;&#xff08;&#x4ee5;&#x6beb;&#x79d2;&#x4e3a;&#x5355;&#x4f4d;&#xff09;&#x6216; ms &#x683c;&#x5f0f; &#x4e2d;&#x7684;&#x5b57;&#x7b26;&#x4e32;&#x3002;\t&#x6570;&#x5b57;\t<span class=\"hljs-number\">0</span>\nredirect\t&#x5f53;&#x8def;&#x5f84;&#x540d;&#x662f;&#x76ee;&#x5f55;&#x65f6;&#xff0c;&#x91cd;&#x5b9a;&#x5411;&#x5230;&#x5c3e;&#x968f; <span class=\"hljs-string\">&quot;/&quot;</span>&#x3002;\t&#x5e03;&#x5c14;&#x503c;\t<span class=\"hljs-keyword\">true</span>\nsetHeaders\t&#x7528;&#x4e8e;&#x8bbe;&#x7f6e; HTTP &#x6807;&#x5934;&#x4ee5;&#x4e0e;&#x6587;&#x4ef6;&#x4e00;&#x8d77;&#x670d;&#x52a1;&#x7684;&#x529f;&#x80fd;&#x3002;\n\n&#x89c1;&#x4e0b;&#x6587;setHeaders&#x3002;\t&#x51fd;&#x6570;\t\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"109,130"}},{"content":"<pre data-lines=\"131,132\"><code>&#x6709;&#x5173;&#x8be6;&#x7ec6;&#x4fe1;&#x606f;&#xff0c;&#x8bf7;&#x53c2;&#x9605; &#x5728; Express &#x4e2d;&#x63d0;&#x4f9b;&#x9759;&#x6001;&#x6587;&#x4ef6;&#x3002;&#x548c;&#x4f7f;&#x7528;&#x4e2d;&#x95f4;&#x4ef6; - &#x5185;&#x7f6e;&#x4e2d;&#x95f4;&#x4ef6;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"131,132"}}],"payload":{"tag":"h3","lines":"99,100"}},{"content":"dotfiles&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"135,142\"><code>&#x6b64;&#x9009;&#x9879;&#x7684;&#x53ef;&#x80fd;&#x503c;&#x4e3a;&#xff1a;\n\n- &quot;allow&quot; - &#x5bf9;&#x70b9;&#x6587;&#x4ef6;&#x6ca1;&#x6709;&#x7279;&#x6b8a;&#x5904;&#x7406;&#x3002;\n- &quot;deny&quot; - &#x62d2;&#x7edd;&#x5bf9;&#x70b9;&#x6587;&#x4ef6;&#x7684;&#x8bf7;&#x6c42;&#xff0c;&#x4ee5; 403 &#x54cd;&#x5e94;&#xff0c;&#x7136;&#x540e;&#x8c03;&#x7528; next()&#x3002;\n- &quot;ignore&quot; - &#x5c31;&#x597d;&#x50cf;&#x70b9;&#x6587;&#x4ef6;&#x4e0d;&#x5b58;&#x5728;&#x4e00;&#x6837;&#xff0c;&#x7528; 404 &#x54cd;&#x5e94;&#xff0c;&#x7136;&#x540e;&#x8c03;&#x7528; next()&#x3002;\n\n&#x6ce8;&#x610f;&#xff1a;&#x4f7f;&#x7528;&#x9ed8;&#x8ba4;&#x503c;&#xff0c;&#x5b83;&#x4e0d;&#x4f1a;&#x5ffd;&#x7565;&#x4ee5;&#x70b9;&#x5f00;&#x5934;&#x7684;&#x76ee;&#x5f55;&#x4e2d;&#x7684;&#x6587;&#x4ef6;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"135,142"}}],"payload":{"tag":"h3","lines":"133,134"}},{"content":"fallthrough&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"145,150\"><code>&#x5f53;&#x6b64;&#x9009;&#x9879;&#x4e3a; true &#x65f6;&#xff0c;&#x5ba2;&#x6237;&#x7aef;&#x9519;&#x8bef;&#xff08;&#x4f8b;&#x5982;&#x9519;&#x8bef;&#x8bf7;&#x6c42;&#x6216;&#x5bf9;&#x4e0d;&#x5b58;&#x5728;&#x6587;&#x4ef6;&#x7684;&#x8bf7;&#x6c42;&#xff09;&#x5c06;&#x5bfc;&#x81f4;&#x6b64;&#x4e2d;&#x95f4;&#x4ef6;&#x7b80;&#x5355;&#x5730;&#x8c03;&#x7528; next() &#x4ee5;&#x8c03;&#x7528;&#x5806;&#x6808;&#x4e2d;&#x7684;&#x4e0b;&#x4e00;&#x4e2a;&#x4e2d;&#x95f4;&#x4ef6;&#x3002;&#x5f53;&#x4e3a; false &#x65f6;&#xff0c;&#x8fd9;&#x4e9b;&#x9519;&#x8bef;&#xff08;&#x751a;&#x81f3;&#x662f; 404&#xff09;&#x5c06;&#x8c03;&#x7528; next(err)&#x3002;\n\n&#x5c06;&#x6b64;&#x9009;&#x9879;&#x8bbe;&#x7f6e;&#x4e3a; true&#xff0c;&#x4ee5;&#x4fbf;&#x60a8;&#x53ef;&#x4ee5;&#x5c06;&#x591a;&#x4e2a;&#x7269;&#x7406;&#x76ee;&#x5f55;&#x6620;&#x5c04;&#x5230;&#x540c;&#x4e00;&#x4e2a; Web &#x5730;&#x5740;&#x6216;&#x8def;&#x7531;&#x4ee5;&#x586b;&#x5145;&#x4e0d;&#x5b58;&#x5728;&#x7684;&#x6587;&#x4ef6;&#x3002;\n\n&#x5982;&#x679c;&#x60a8;&#x5df2;&#x5c06;&#x6b64;&#x4e2d;&#x95f4;&#x4ef6;&#x5b89;&#x88c5;&#x5728;&#x4e25;&#x683c;&#x8bbe;&#x8ba1;&#x4e3a;&#x5355;&#x4e2a;&#x6587;&#x4ef6;&#x7cfb;&#x7edf;&#x76ee;&#x5f55;&#x7684;&#x8def;&#x5f84;&#x4e0a;&#xff0c;&#x8bf7;&#x4f7f;&#x7528; false&#xff0c;&#x8fd9;&#x5141;&#x8bb8;&#x77ed;&#x8def; 404 &#x4ee5;&#x51cf;&#x5c11;&#x5f00;&#x9500;&#x3002;&#x8fd9;&#x4e2a;&#x4e2d;&#x95f4;&#x4ef6;&#x4e5f;&#x4f1a;&#x54cd;&#x5e94;&#x6240;&#x6709;&#x7684;&#x65b9;&#x6cd5;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"145,150"}}],"payload":{"tag":"h3","lines":"143,144"}},{"content":"setHeaders&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"153,156\"><code>&#x5bf9;&#x4e8e;&#x6b64;&#x9009;&#x9879;&#xff0c;&#x6307;&#x5b9a;&#x4e00;&#x4e2a;&#x51fd;&#x6570;&#x6765;&#x8bbe;&#x7f6e;&#x81ea;&#x5b9a;&#x4e49;&#x54cd;&#x5e94;&#x6807;&#x5934;&#x3002;&#x5bf9;&#x6807;&#x5934;&#x7684;&#x66f4;&#x6539;&#x5fc5;&#x987b;&#x540c;&#x6b65;&#x53d1;&#x751f;&#x3002;\n\n&#x8be5;&#x51fd;&#x6570;&#x7684;&#x7b7e;&#x540d;&#x662f;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"153,156"}},{"content":"<pre data-lines=\"157,160\"><code data-lines=\"157,160\"><span class=\"hljs-function\"><span class=\"hljs-title\">fn</span><span class=\"hljs-params\">(res, path, stat)</span></span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"157,160"}},{"content":"<pre data-lines=\"161,166\"><code>&#x53c2;&#x6570;&#xff1a;\n\n- res&#xff0c;&#x54cd;&#x5e94;&#x5bf9;&#x8c61;&#x3002;\n- path&#xff0c;&#x6b63;&#x5728;&#x53d1;&#x9001;&#x7684;&#x6587;&#x4ef6;&#x8def;&#x5f84;&#x3002;\n- stat&#xff0c;&#x6b63;&#x5728;&#x53d1;&#x9001;&#x7684;&#x6587;&#x4ef6;&#x7684; stat &#x5bf9;&#x8c61;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"161,166"}}],"payload":{"tag":"h3","lines":"151,152"}},{"content":"express.static &#x793a;&#x4f8b;&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"169,170\"><code>&#x4e0b;&#x9762;&#x662f;&#x4e00;&#x4e2a;&#x5c06; express.static &#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x4e0e;&#x7cbe;&#x5fc3;&#x8bbe;&#x8ba1;&#x7684;&#x9009;&#x9879;&#x5bf9;&#x8c61;&#x4e00;&#x8d77;&#x4f7f;&#x7528;&#x7684;&#x793a;&#x4f8b;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"169,170"}},{"content":"<pre data-lines=\"171,186\"><code class=\"language-js\"><span class=\"hljs-keyword\">var</span> options = {\n  <span class=\"hljs-attr\">dotfiles</span>: <span class=\"hljs-string\">&apos;ignore&apos;</span>,\n  <span class=\"hljs-attr\">etag</span>: <span class=\"hljs-literal\">false</span>,\n  <span class=\"hljs-attr\">extensions</span>: [<span class=\"hljs-string\">&apos;htm&apos;</span>, <span class=\"hljs-string\">&apos;html&apos;</span>],\n  <span class=\"hljs-attr\">index</span>: <span class=\"hljs-literal\">false</span>,\n  <span class=\"hljs-attr\">maxAge</span>: <span class=\"hljs-string\">&apos;1d&apos;</span>,\n  <span class=\"hljs-attr\">redirect</span>: <span class=\"hljs-literal\">false</span>,\n  <span class=\"hljs-attr\">setHeaders</span>: <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">res, path, stat</span>) {\n    res.<span class=\"hljs-title function_\">set</span>(<span class=\"hljs-string\">&apos;x-timestamp&apos;</span>, <span class=\"hljs-title class_\">Date</span>.<span class=\"hljs-title function_\">now</span>())\n  }\n}\n\napp.<span class=\"hljs-title function_\">use</span>(express.<span class=\"hljs-title function_\">static</span>(<span class=\"hljs-string\">&apos;public&apos;</span>, options))\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"171,186"}}],"payload":{"tag":"h3","lines":"167,168"}}],"payload":{"tag":"h2","lines":"97,98"}},{"content":"express.text([options])&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"189,200\"><code>&#x6b64;&#x4e2d;&#x95f4;&#x4ef6;&#x5728; Express v4.17.0 &#x53ca;&#x66f4;&#x9ad8;&#x7248;&#x672c;&#x4e2d;&#x53ef;&#x7528;&#x3002;\n\n&#x8fd9;&#x662f; Express &#x4e2d;&#x5185;&#x7f6e;&#x7684;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x3002;&#x5b83;&#x5c06;&#x4f20;&#x5165;&#x7684;&#x8bf7;&#x6c42;&#x8d1f;&#x8f7d;&#x89e3;&#x6790;&#x4e3a;&#x5b57;&#x7b26;&#x4e32;&#xff0c;&#x5e76;&#x4e14;&#x57fa;&#x4e8e; body-parser&#x3002;\n\n&#x8fd4;&#x56de;&#x5c06;&#x6240;&#x6709;&#x4e3b;&#x4f53;&#x89e3;&#x6790;&#x4e3a;&#x5b57;&#x7b26;&#x4e32;&#x5e76;&#x4ec5;&#x67e5;&#x770b; Content-Type &#x6807;&#x5934;&#x4e0e; type &#x9009;&#x9879;&#x5339;&#x914d;&#x7684;&#x8bf7;&#x6c42;&#x7684;&#x4e2d;&#x95f4;&#x4ef6;&#x3002;&#x6b64;&#x89e3;&#x6790;&#x5668;&#x63a5;&#x53d7;&#x6b63;&#x6587;&#x7684;&#x4efb;&#x4f55;&#x200b;&#x200b; Unicode &#x7f16;&#x7801;&#xff0c;&#x5e76;&#x652f;&#x6301; gzip &#x548c; deflate &#x7f16;&#x7801;&#x7684;&#x81ea;&#x52a8;&#x81a8;&#x80c0;&#x3002;\n\n&#x5728;&#x4e2d;&#x95f4;&#x4ef6;&#xff08;&#x5373; req.body&#xff09;&#x4e4b;&#x540e;&#x7684; request &#x5bf9;&#x8c61;&#x4e0a;&#x586b;&#x5145;&#x4e00;&#x4e2a;&#x5305;&#x542b;&#x89e3;&#x6790;&#x6570;&#x636e;&#x7684;&#x65b0; body &#x5b57;&#x7b26;&#x4e32;&#xff0c;&#x5982;&#x679c;&#x6ca1;&#x6709;&#x8981;&#x89e3;&#x6790;&#x7684;&#x4e3b;&#x4f53;&#x3001;Content-Type &#x4e0d;&#x5339;&#x914d;&#x6216;&#x53d1;&#x751f;&#x9519;&#x8bef;&#xff0c;&#x5219;&#x586b;&#x5145;&#x4e00;&#x4e2a;&#x7a7a;&#x5bf9;&#x8c61;&#xff08;{}&#xff09;&#x3002;\n\n&#x7531;&#x4e8e; req.body &#x7684;&#x5f62;&#x72b6;&#x57fa;&#x4e8e;&#x7528;&#x6237;&#x63a7;&#x5236;&#x7684;&#x8f93;&#x5165;&#xff0c;&#x56e0;&#x6b64;&#x8be5;&#x5bf9;&#x8c61;&#x4e2d;&#x7684;&#x6240;&#x6709;&#x5c5e;&#x6027;&#x548c;&#x503c;&#x90fd;&#x662f;&#x4e0d;&#x53ef;&#x4fe1;&#x7684;&#xff0c;&#x5e94;&#x8be5;&#x5728;&#x4fe1;&#x4efb;&#x4e4b;&#x524d;&#x8fdb;&#x884c;&#x9a8c;&#x8bc1;&#x3002;&#x4f8b;&#x5982;&#xff0c;req.body.trim() &#x53ef;&#x80fd;&#x4ee5;&#x591a;&#x79cd;&#x65b9;&#x5f0f;&#x5931;&#x8d25;&#xff0c;&#x4f8b;&#x5982;&#x5806;&#x53e0;&#x591a;&#x4e2a;&#x89e3;&#x6790;&#x5668; req.body &#x53ef;&#x80fd;&#x6765;&#x81ea;&#x4e0d;&#x540c;&#x7684;&#x89e3;&#x6790;&#x5668;&#x3002;&#x5efa;&#x8bae;&#x5728;&#x8c03;&#x7528;&#x5b57;&#x7b26;&#x4e32;&#x65b9;&#x6cd5;&#x4e4b;&#x524d;&#x6d4b;&#x8bd5; req.body &#x662f;&#x4e00;&#x4e2a;&#x5b57;&#x7b26;&#x4e32;&#x3002;\n\n&#x4e0b;&#x8868;&#x63cf;&#x8ff0;&#x4e86;&#x53ef;&#x9009; options &#x5bf9;&#x8c61;&#x7684;&#x5c5e;&#x6027;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"189,200"}},{"content":"<pre data-lines=\"201,209\"><code data-lines=\"201,209\">&#x5c5e;&#x6027;\t&#x63cf;&#x8ff0;\t&#x7c7b;&#x578b;\t&#x9ed8;&#x8ba4;\ndefaultCharset\t&#x5982;&#x679c;&#x8bf7;&#x6c42;&#x7684; Content-<span class=\"hljs-keyword\">Type</span> <span class=\"hljs-type\">&#x6807;&#x5934;&#x4e2d;&#x672a;&#x6307;&#x5b9a;&#x5b57;&#x7b26;&#x96c6;&#xff0c;&#x5219;&#x4e3a;&#x6587;&#x672c;&#x5185;&#x5bb9;&#x6307;&#x5b9a;&#x9ed8;&#x8ba4;&#x5b57;&#x7b26;&#x96c6;&#x3002;\t</span>&#x5b57;&#x7b26;&#x4e32;\t<span class=\"hljs-string\">&quot;utf-8&quot;</span>\ninflate\t&#x542f;&#x7528;&#x6216;&#x7981;&#x7528;&#x5904;&#x7406;&#x653e;&#x6c14;&#xff08;&#x538b;&#x7f29;&#xff09;&#x7684;&#x4e3b;&#x4f53;&#xff1b;&#x5f53;&#x7981;&#x7528;&#x65f6;&#xff0c;&#x762a;&#x7684;&#x4e3b;&#x4f53;&#x4f1a;&#x88ab;&#x62d2;&#x7edd;&#x3002;\t&#x5e03;&#x5c14;&#x503c;\t<span class=\"hljs-literal\">true</span>\nlimit\t&#x63a7;&#x5236;&#x6700;&#x5927;&#x8bf7;&#x6c42;&#x6b63;&#x6587;&#x5927;&#x5c0f;&#x3002;&#x5982;&#x679c;&#x8fd9;&#x662f;&#x4e00;&#x4e2a;&#x6570;&#x5b57;&#xff0c;&#x5219;&#x8be5;&#x503c;&#x6307;&#x5b9a;&#x5b57;&#x8282;&#x6570;&#xff1b;&#x5982;&#x679c;&#x662f;&#x5b57;&#x7b26;&#x4e32;&#xff0c;&#x5219;&#x5c06;&#x503c;&#x4f20;&#x9012;&#x7ed9;bytes&#x5e93;&#x8fdb;&#x884c;&#x89e3;&#x6790;&#x3002;\t&#x6df7;&#x5408;\t<span class=\"hljs-string\">&quot;100kb&quot;</span>\n<span class=\"hljs-keyword\">type</span>\t<span class=\"hljs-type\">&#x8fd9;&#x7528;&#x4e8e;&#x786e;&#x5b9a;&#x4e2d;&#x95f4;&#x4ef6;&#x5c06;&#x89e3;&#x6790;&#x7684;&#x5a92;&#x4f53;&#x7c7b;&#x578b;&#x3002;&#x6b64;&#x9009;&#x9879;&#x53ef;&#x4ee5;&#x662f;&#x5b57;&#x7b26;&#x4e32;&#x3001;&#x5b57;&#x7b26;&#x4e32;&#x6570;&#x7ec4;&#x6216;&#x51fd;&#x6570;&#x3002;&#x5982;&#x679c;&#x4e0d;&#x662f;&#x51fd;&#x6570;&#xff0c;&#x5219; </span><span class=\"hljs-keyword\">type</span> <span class=\"hljs-type\">&#x9009;&#x9879;&#x76f4;&#x63a5;&#x4f20;&#x9012;&#x7ed9; </span><span class=\"hljs-keyword\">type</span>-<span class=\"hljs-keyword\">is</span> &#x5e93;&#xff0c;&#x5b83;&#x53ef;&#x4ee5;&#x662f;&#x6269;&#x5c55;&#x540d;&#xff08;&#x5982; txt&#xff09;&#x3001;mime &#x7c7b;&#x578b;&#xff08;&#x5982; text/plain&#xff09;&#x6216;&#x5e26;&#x6709;&#x901a;&#x914d;&#x7b26;&#x7684; mime &#x7c7b;&#x578b;&#xff08;&#x5982; */* &#x6216; text/*&#xff09;&#x3002;&#x5982;&#x679c;&#x662f;&#x51fd;&#x6570;&#xff0c;&#x5219; <span class=\"hljs-keyword\">type</span> <span class=\"hljs-type\">&#x9009;&#x9879;&#x88ab;&#x79f0;&#x4e3a; </span>fn(req)&#xff0c;&#x5982;&#x679c;&#x8bf7;&#x6c42;&#x8fd4;&#x56de;&#x771f;&#x503c;&#xff0c;&#x5219;&#x89e3;&#x6790;&#x8bf7;&#x6c42;&#x3002;\t&#x6df7;&#x5408;\t<span class=\"hljs-string\">&quot;text/plain&quot;</span>\nverify\t&#x6b64;&#x9009;&#x9879;&#xff08;&#x5982;&#x679c;&#x63d0;&#x4f9b;&#xff09;&#x79f0;&#x4e3a; verify(req, res, buf, encoding)&#xff0c;&#x5176;&#x4e2d; buf &#x662f;&#x539f;&#x59cb;&#x8bf7;&#x6c42;&#x6b63;&#x6587;&#x7684; Buffer&#xff0c;encoding &#x662f;&#x8bf7;&#x6c42;&#x7684;&#x7f16;&#x7801;&#x3002;&#x53ef;&#x4ee5;&#x901a;&#x8fc7;&#x629b;&#x51fa;&#x9519;&#x8bef;&#x6765;&#x4e2d;&#x6b62;&#x89e3;&#x6790;&#x3002;\t&#x51fd;&#x6570;\tundefined\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"201,209"}}],"payload":{"tag":"h2","lines":"187,188"}},{"content":"express.urlencoded([options])&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"212,223\"><code>&#x6b64;&#x4e2d;&#x95f4;&#x4ef6;&#x5728; Express v4.16.0 &#x53ca;&#x66f4;&#x9ad8;&#x7248;&#x672c;&#x4e2d;&#x53ef;&#x7528;&#x3002;\n\n&#x8fd9;&#x662f; Express &#x4e2d;&#x5185;&#x7f6e;&#x7684;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x3002;&#x5b83;&#x4f7f;&#x7528; urlencoded &#x6709;&#x6548;&#x8d1f;&#x8f7d;&#x89e3;&#x6790;&#x4f20;&#x5165;&#x7684;&#x8bf7;&#x6c42;&#xff0c;&#x5e76;&#x4e14;&#x57fa;&#x4e8e; body-parser&#x3002;\n\n&#x8fd4;&#x56de;&#x4ec5;&#x89e3;&#x6790; urlencoded &#x6b63;&#x6587;&#x5e76;&#x4ec5;&#x67e5;&#x770b; Content-Type &#x6807;&#x5934;&#x4e0e; type &#x9009;&#x9879;&#x5339;&#x914d;&#x7684;&#x8bf7;&#x6c42;&#x7684;&#x4e2d;&#x95f4;&#x4ef6;&#x3002;&#x6b64;&#x89e3;&#x6790;&#x5668;&#x4ec5;&#x63a5;&#x53d7;&#x6b63;&#x6587;&#x7684; UTF-8 &#x7f16;&#x7801;&#xff0c;&#x5e76;&#x652f;&#x6301; gzip &#x548c; deflate &#x7f16;&#x7801;&#x7684;&#x81ea;&#x52a8;&#x81a8;&#x80c0;&#x3002;\n\n&#x5305;&#x542b;&#x89e3;&#x6790;&#x6570;&#x636e;&#x7684;&#x65b0; body &#x5bf9;&#x8c61;&#x5728;&#x4e2d;&#x95f4;&#x4ef6;&#xff08;&#x5373; req.body&#xff09;&#x4e4b;&#x540e;&#x586b;&#x5145;&#x5230; request &#x5bf9;&#x8c61;&#x4e0a;&#xff0c;&#x5982;&#x679c;&#x6ca1;&#x6709;&#x8981;&#x89e3;&#x6790;&#x7684;&#x4e3b;&#x4f53;&#x3001;Content-Type &#x4e0d;&#x5339;&#x914d;&#x6216;&#x53d1;&#x751f;&#x9519;&#x8bef;&#xff0c;&#x5219;&#x586b;&#x5145;&#x4e00;&#x4e2a;&#x7a7a;&#x5bf9;&#x8c61;&#xff08;{}&#xff09;&#x3002;&#x8be5;&#x5bf9;&#x8c61;&#x5c06;&#x5305;&#x542b;&#x952e;&#x503c;&#x5bf9;&#xff0c;&#x5176;&#x4e2d;&#x503c;&#x53ef;&#x4ee5;&#x662f;&#x5b57;&#x7b26;&#x4e32;&#x6216;&#x6570;&#x7ec4;&#xff08;&#x5f53; extended &#x4e3a; false &#x65f6;&#xff09;&#x6216;&#x4efb;&#x4f55;&#x7c7b;&#x578b;&#xff08;&#x5f53; extended &#x4e3a; true &#x65f6;&#xff09;&#x3002;\n\n&#x7531;&#x4e8e; req.body &#x7684;&#x5f62;&#x72b6;&#x57fa;&#x4e8e;&#x7528;&#x6237;&#x63a7;&#x5236;&#x7684;&#x8f93;&#x5165;&#xff0c;&#x56e0;&#x6b64;&#x8be5;&#x5bf9;&#x8c61;&#x4e2d;&#x7684;&#x6240;&#x6709;&#x5c5e;&#x6027;&#x548c;&#x503c;&#x90fd;&#x662f;&#x4e0d;&#x53ef;&#x4fe1;&#x7684;&#xff0c;&#x5e94;&#x8be5;&#x5728;&#x4fe1;&#x4efb;&#x4e4b;&#x524d;&#x8fdb;&#x884c;&#x9a8c;&#x8bc1;&#x3002;&#x4f8b;&#x5982;&#xff0c;req.body.foo.toString() &#x53ef;&#x80fd;&#x4ee5;&#x591a;&#x79cd;&#x65b9;&#x5f0f;&#x5931;&#x8d25;&#xff0c;&#x4f8b;&#x5982; foo &#x53ef;&#x80fd;&#x4e0d;&#x5b58;&#x5728;&#x6216;&#x53ef;&#x80fd;&#x4e0d;&#x662f;&#x5b57;&#x7b26;&#x4e32;&#xff0c;toString &#x53ef;&#x80fd;&#x4e0d;&#x662f;&#x51fd;&#x6570;&#xff0c;&#x800c;&#x662f;&#x5b57;&#x7b26;&#x4e32;&#x6216;&#x5176;&#x4ed6;&#x7528;&#x6237;&#x8f93;&#x5165;&#x3002;\n\n&#x4e0b;&#x8868;&#x63cf;&#x8ff0;&#x4e86;&#x53ef;&#x9009; options &#x5bf9;&#x8c61;&#x7684;&#x5c5e;&#x6027;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"212,223"}},{"content":"<pre data-lines=\"224,233\"><code data-lines=\"224,233\">&#x5c5e;&#x6027;\t&#x63cf;&#x8ff0;\t&#x7c7b;&#x578b;\t&#x9ed8;&#x8ba4;\nextended\t&#x6b64;&#x9009;&#x9879;&#x5141;&#x8bb8;&#x5728;&#x4f7f;&#x7528; querystring &#x5e93;&#xff08;&#x5f53; <span class=\"hljs-keyword\">false</span>&#xff09;&#x6216; qs &#x5e93;&#xff08;&#x5f53; <span class=\"hljs-keyword\">true</span>&#xff09;&#x89e3;&#x6790; URL &#x7f16;&#x7801;&#x6570;&#x636e;&#x4e4b;&#x95f4;&#x8fdb;&#x884c;&#x9009;&#x62e9;&#x3002;&quot;extended&quot; &#x8bed;&#x6cd5;&#x5141;&#x8bb8;&#x5c06;&#x4e30;&#x5bcc;&#x7684;&#x5bf9;&#x8c61;&#x548c;&#x6570;&#x7ec4;&#x7f16;&#x7801;&#x4e3a; URL &#x7f16;&#x7801;&#x683c;&#x5f0f;&#xff0c;&#x4ece;&#x800c;&#x63d0;&#x4f9b;&#x7c7b;&#x4f3c; <span class=\"hljs-type\">JSON</span> &#x7684; URL &#x7f16;&#x7801;&#x4f53;&#x9a8c;&#x3002;&#x6b32;&#x4e86;&#x89e3;&#x66f4;&#x591a;&#x4fe1;&#x606f;&#xff0c;&#x8bf7; &#x67e5;&#x770b; qs &#x5e93;&#x3002;\t&#x5e03;&#x5c14;&#x503c;\t<span class=\"hljs-keyword\">true</span>\ninflate\t&#x542f;&#x7528;&#x6216;&#x7981;&#x7528;&#x5904;&#x7406;&#x653e;&#x6c14;&#xff08;&#x538b;&#x7f29;&#xff09;&#x7684;&#x4e3b;&#x4f53;&#xff1b;&#x5f53;&#x7981;&#x7528;&#x65f6;&#xff0c;&#x762a;&#x7684;&#x4e3b;&#x4f53;&#x4f1a;&#x88ab;&#x62d2;&#x7edd;&#x3002;\t&#x5e03;&#x5c14;&#x503c;\t<span class=\"hljs-keyword\">true</span>\n<span class=\"hljs-keyword\">limit</span>\t&#x63a7;&#x5236;&#x6700;&#x5927;&#x8bf7;&#x6c42;&#x6b63;&#x6587;&#x5927;&#x5c0f;&#x3002;&#x5982;&#x679c;&#x8fd9;&#x662f;&#x4e00;&#x4e2a;&#x6570;&#x5b57;&#xff0c;&#x5219;&#x8be5;&#x503c;&#x6307;&#x5b9a;&#x5b57;&#x8282;&#x6570;&#xff1b;&#x5982;&#x679c;&#x662f;&#x5b57;&#x7b26;&#x4e32;&#xff0c;&#x5219;&#x5c06;&#x503c;&#x4f20;&#x9012;&#x7ed9;bytes&#x5e93;&#x8fdb;&#x884c;&#x89e3;&#x6790;&#x3002;\t&#x6df7;&#x5408;\t&quot;100kb&quot;\nparameterLimit\t&#x6b64;&#x9009;&#x9879;&#x63a7;&#x5236; URL &#x7f16;&#x7801;&#x6570;&#x636e;&#x4e2d;&#x5141;&#x8bb8;&#x7684;&#x6700;&#x5927;&#x53c2;&#x6570;&#x6570;&#x3002;&#x5982;&#x679c;&#x8bf7;&#x6c42;&#x5305;&#x542b;&#x7684;&#x53c2;&#x6570;&#x591a;&#x4e8e;&#x8be5;&#x503c;&#xff0c;&#x5219;&#x4f1a;&#x5f15;&#x53d1;&#x9519;&#x8bef;&#x3002;\t&#x6570;&#x5b57;\t<span class=\"hljs-number\">1000</span>\n<span class=\"hljs-keyword\">type</span>\t&#x8fd9;&#x7528;&#x4e8e;&#x786e;&#x5b9a;&#x4e2d;&#x95f4;&#x4ef6;&#x5c06;&#x89e3;&#x6790;&#x7684;&#x5a92;&#x4f53;&#x7c7b;&#x578b;&#x3002;&#x6b64;&#x9009;&#x9879;&#x53ef;&#x4ee5;&#x662f;&#x5b57;&#x7b26;&#x4e32;&#x3001;&#x5b57;&#x7b26;&#x4e32;&#x6570;&#x7ec4;&#x6216;&#x51fd;&#x6570;&#x3002;&#x5982;&#x679c;&#x4e0d;&#x662f;&#x51fd;&#x6570;&#xff0c;&#x5219; <span class=\"hljs-keyword\">type</span> &#x9009;&#x9879;&#x76f4;&#x63a5;&#x4f20;&#x9012;&#x7ed9; <span class=\"hljs-keyword\">type</span>-<span class=\"hljs-keyword\">is</span> &#x5e93;&#xff0c;&#x5b83;&#x53ef;&#x4ee5;&#x662f;&#x6269;&#x5c55;&#x540d;&#xff08;&#x5982; urlencoded&#xff09;&#x3001;mime &#x7c7b;&#x578b;&#xff08;&#x5982; application/x-www-form-urlencoded&#xff09;&#x6216;&#x5e26;&#x6709;&#x901a;&#x914d;&#x7b26;&#x7684; mime &#x7c7b;&#x578b;&#xff08;&#x5982; */x-www-form-urlencoded&#xff09;&#x3002;&#x5982;&#x679c;&#x662f;&#x51fd;&#x6570;&#xff0c;&#x5219; <span class=\"hljs-keyword\">type</span> &#x9009;&#x9879;&#x88ab;&#x79f0;&#x4e3a; fn(req)&#xff0c;&#x5982;&#x679c;&#x8bf7;&#x6c42;&#x8fd4;&#x56de;&#x771f;&#x503c;&#xff0c;&#x5219;&#x89e3;&#x6790;&#x8bf7;&#x6c42;&#x3002;\t&#x6df7;&#x5408;\t&quot;application/x-www-form-urlencoded&quot;\nverify\t&#x6b64;&#x9009;&#x9879;&#xff08;&#x5982;&#x679c;&#x63d0;&#x4f9b;&#xff09;&#x79f0;&#x4e3a; verify(req, res, buf, <span class=\"hljs-keyword\">encoding</span>)&#xff0c;&#x5176;&#x4e2d; buf &#x662f;&#x539f;&#x59cb;&#x8bf7;&#x6c42;&#x6b63;&#x6587;&#x7684; Buffer&#xff0c;<span class=\"hljs-keyword\">encoding</span> &#x662f;&#x8bf7;&#x6c42;&#x7684;&#x7f16;&#x7801;&#x3002;&#x53ef;&#x4ee5;&#x901a;&#x8fc7;&#x629b;&#x51fa;&#x9519;&#x8bef;&#x6765;&#x4e2d;&#x6b62;&#x89e3;&#x6790;&#x3002;\t&#x51fd;&#x6570;\tundefined\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"224,233"}}],"payload":{"tag":"h2","lines":"210,211"}}],"payload":{"tag":"h1","lines":"11,12"}},{"content":"&#x5e94;&#x7528;","children":[{"content":"","children":[{"content":"<pre data-lines=\"238,263\"><code data-lines=\"238,263\">app<span class=\"hljs-selector-class\">.locals</span>\napp<span class=\"hljs-selector-class\">.mountpath</span>\napp<span class=\"hljs-selector-class\">.on</span>(<span class=\"hljs-string\">&apos;mount&apos;</span>, <span class=\"hljs-built_in\">callback</span>(parent))\napp<span class=\"hljs-selector-class\">.all</span>(<span class=\"hljs-selector-tag\">path</span>, callback <span class=\"hljs-selector-attr\">[, callback ...]</span>)\napp<span class=\"hljs-selector-class\">.delete</span>(<span class=\"hljs-selector-tag\">path</span>, callback <span class=\"hljs-selector-attr\">[, callback ...]</span>)\napp<span class=\"hljs-selector-class\">.disable</span>(name)\napp<span class=\"hljs-selector-class\">.disabled</span>(name)\napp<span class=\"hljs-selector-class\">.enable</span>(name)\napp<span class=\"hljs-selector-class\">.enabled</span>(name)\napp<span class=\"hljs-selector-class\">.engine</span>(ext, callback)\napp<span class=\"hljs-selector-class\">.get</span>(name)\napp<span class=\"hljs-selector-class\">.get</span>(<span class=\"hljs-selector-tag\">path</span>, callback <span class=\"hljs-selector-attr\">[, callback ...]</span>)\napp<span class=\"hljs-selector-class\">.listen</span>(<span class=\"hljs-selector-tag\">path</span>, <span class=\"hljs-selector-attr\">[callback]</span>)\napp<span class=\"hljs-selector-class\">.listen</span>(<span class=\"hljs-selector-attr\">[port[, host[, backlog]</span>]]<span class=\"hljs-selector-attr\">[, callback]</span>)\napp<span class=\"hljs-selector-class\">.METHOD</span>(<span class=\"hljs-selector-tag\">path</span>, callback <span class=\"hljs-selector-attr\">[, callback ...]</span>)\napp<span class=\"hljs-selector-class\">.param</span>(<span class=\"hljs-selector-attr\">[name]</span>, callback)\napp<span class=\"hljs-selector-class\">.path</span>()\napp<span class=\"hljs-selector-class\">.post</span>(<span class=\"hljs-selector-tag\">path</span>, callback <span class=\"hljs-selector-attr\">[, callback ...]</span>)\napp<span class=\"hljs-selector-class\">.put</span>(<span class=\"hljs-selector-tag\">path</span>, callback <span class=\"hljs-selector-attr\">[, callback ...]</span>)\napp<span class=\"hljs-selector-class\">.render</span>(view, <span class=\"hljs-selector-attr\">[locals]</span>, callback)\napp<span class=\"hljs-selector-class\">.route</span>(path)\napp<span class=\"hljs-selector-class\">.set</span>(name, value)\napp<span class=\"hljs-selector-class\">.use</span>(<span class=\"hljs-selector-attr\">[path,]</span> callback <span class=\"hljs-selector-attr\">[, callback...]</span>)\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"238,263"}},{"content":"<pre data-lines=\"264,265\"><code>app &#x5bf9;&#x8c61;&#x901a;&#x5e38;&#x8868;&#x793a; Express &#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x3002;&#x901a;&#x8fc7;&#x8c03;&#x7528; Express &#x6a21;&#x5757;&#x5bfc;&#x51fa;&#x7684;&#x9876;&#x7ea7; express() &#x51fd;&#x6570;&#x6765;&#x521b;&#x5efa;&#x5b83;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"264,265"}},{"content":"<pre data-lines=\"266,276\"><code class=\"language-js\"><span class=\"hljs-keyword\">var</span> express = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;express&apos;</span>)\n<span class=\"hljs-keyword\">var</span> app = <span class=\"hljs-title function_\">express</span>()\n\napp.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;/&apos;</span>, <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res</span>) {\n  res.<span class=\"hljs-title function_\">send</span>(<span class=\"hljs-string\">&apos;hello world&apos;</span>)\n})\n\napp.<span class=\"hljs-title function_\">listen</span>(<span class=\"hljs-number\">3000</span>)\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"266,276"}},{"content":"<pre data-lines=\"277,287\"><code>app &#x5bf9;&#x8c61;&#x5177;&#x6709;&#x7528;&#x4e8e;\n\n- &#x8def;&#x7531; HTTP &#x8bf7;&#x6c42;&#xff1b; &#x4f8b;&#x5982;&#xff0c;&#x53c2;&#x89c1; app.METHOD &#x548c; app.param&#x3002;\n- &#x914d;&#x7f6e;&#x4e2d;&#x95f4;&#x4ef6;&#xff1b; &#x89c1; app.route&#x3002;\n- &#x6e32;&#x67d3; HTML &#x89c6;&#x56fe;&#xff1b; &#x89c1; app.render&#x3002;\n- &#x6ce8;&#x518c;&#x6a21;&#x677f;&#x5f15;&#x64ce;&#xff1b; &#x89c1; app.engine&#x3002;\n\n&#x5b83;&#x8fd8;&#x5177;&#x6709;&#x5f71;&#x54cd;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x884c;&#x4e3a;&#x65b9;&#x5f0f;&#x7684;&#x8bbe;&#x7f6e;&#xff08;&#x5c5e;&#x6027;&#xff09;&#xff1b;&#x6709;&#x5173;&#x8be6;&#x7ec6;&#x4fe1;&#x606f;&#xff0c;&#x8bf7;&#x53c2;&#x9605; &#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x8bbe;&#x7f6e;&#x3002;\n\n&gt; Express &#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x5bf9;&#x8c61;&#x53ef;&#x4ee5;&#x4ece; &#x8bf7;&#x6c42;&#x5bf9;&#x8c61; &#x548c; &#x54cd;&#x5e94;&#x5bf9;&#x8c61; &#x5206;&#x522b;&#x79f0;&#x4e3a; req.app &#x548c; res.app&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"277,287"}}],"payload":{"tag":"h2","lines":"236,237"}},{"content":"app.locals&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"290,291\"><code>app.locals &#x5bf9;&#x8c61;&#x7684;&#x5c5e;&#x6027;&#x662f;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x4e2d;&#x7684;&#x5c40;&#x90e8;&#x53d8;&#x91cf;&#xff0c;&#x5e76;&#x4e14;&#x53ef;&#x4ee5;&#x5728;&#x4f7f;&#x7528; res.render &#x5448;&#x73b0;&#x7684;&#x6a21;&#x677f;&#x4e2d;&#x4f7f;&#x7528;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"290,291"}},{"content":"<pre data-lines=\"292,299\"><code class=\"language-js\"><span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">dir</span>(app.<span class=\"hljs-property\">locals</span>.<span class=\"hljs-property\">title</span>)\n<span class=\"hljs-comment\">// =&gt; &apos;My App&apos;</span>\n\n<span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">dir</span>(app.<span class=\"hljs-property\">locals</span>.<span class=\"hljs-property\">email</span>)\n<span class=\"hljs-comment\">// =&gt; &apos;me@myapp.com&apos;</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"292,299"}},{"content":"<pre data-lines=\"300,303\"><code>&#x8bbe;&#x7f6e;&#x540e;&#xff0c;app.locals &#x5c5e;&#x6027;&#x7684;&#x503c;&#x5c06;&#x5728;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x7684;&#x6574;&#x4e2a;&#x751f;&#x547d;&#x5468;&#x671f;&#x4e2d;&#x4fdd;&#x6301;&#x4e0d;&#x53d8;&#xff0c;&#x800c; res.locals &#x5c5e;&#x6027;&#x4ec5;&#x5728;&#x8bf7;&#x6c42;&#x7684;&#x751f;&#x547d;&#x5468;&#x671f;&#x5185;&#x6709;&#x6548;&#x3002;\n\n&#x60a8;&#x53ef;&#x4ee5;&#x8bbf;&#x95ee;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x4e2d;&#x5448;&#x73b0;&#x7684;&#x6a21;&#x677f;&#x4e2d;&#x7684;&#x5c40;&#x90e8;&#x53d8;&#x91cf;&#x3002;&#x8fd9;&#x5bf9;&#x4e8e;&#x4e3a;&#x6a21;&#x677f;&#x4ee5;&#x53ca;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x7ea7;&#x6570;&#x636e;&#x63d0;&#x4f9b;&#x5e2e;&#x52a9;&#x51fd;&#x6570;&#x5f88;&#x6709;&#x7528;&#x3002;&#x5c40;&#x90e8;&#x53d8;&#x91cf;&#x53ef;&#x901a;&#x8fc7; req.app.locals &#x5728;&#x4e2d;&#x95f4;&#x4ef6;&#x4e2d;&#x4f7f;&#x7528;&#xff08;&#x53c2;&#x89c1; req.app&#xff09;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"300,303"}},{"content":"<pre data-lines=\"304,309\"><code class=\"language-js\">app.<span class=\"hljs-property\">locals</span>.<span class=\"hljs-property\">title</span> = <span class=\"hljs-string\">&apos;My App&apos;</span>\napp.<span class=\"hljs-property\">locals</span>.<span class=\"hljs-property\">strftime</span> = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;strftime&apos;</span>)\napp.<span class=\"hljs-property\">locals</span>.<span class=\"hljs-property\">email</span> = <span class=\"hljs-string\">&apos;me@myapp.com&apos;</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"304,309"}}],"payload":{"tag":"h2","lines":"288,289"}},{"content":"app.mountpath&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"312,315\"><code>app.mountpath &#x5c5e;&#x6027;&#x5305;&#x542b;&#x4e00;&#x4e2a;&#x6216;&#x591a;&#x4e2a;&#x5b89;&#x88c5;&#x5b50;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x7684;&#x8def;&#x5f84;&#x6a21;&#x5f0f;&#x3002;\n\n&#x5b50;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x662f; express &#x7684;&#x4e00;&#x4e2a;&#x5b9e;&#x4f8b;&#xff0c;&#x53ef;&#x7528;&#x4e8e;&#x5904;&#x7406;&#x5bf9;&#x8def;&#x7531;&#x7684;&#x8bf7;&#x6c42;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"312,315"}},{"content":"<pre data-lines=\"316,329\"><code class=\"language-js\"><span class=\"hljs-keyword\">var</span> express = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;express&apos;</span>)\n\n<span class=\"hljs-keyword\">var</span> app = <span class=\"hljs-title function_\">express</span>() <span class=\"hljs-comment\">// the main app</span>\n<span class=\"hljs-keyword\">var</span> admin = <span class=\"hljs-title function_\">express</span>() <span class=\"hljs-comment\">// the sub app</span>\n\nadmin.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;/&apos;</span>, <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res</span>) {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(admin.<span class=\"hljs-property\">mountpath</span>) <span class=\"hljs-comment\">// /admin</span>\n  res.<span class=\"hljs-title function_\">send</span>(<span class=\"hljs-string\">&apos;Admin Homepage&apos;</span>)\n})\n\napp.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-string\">&apos;/admin&apos;</span>, admin) <span class=\"hljs-comment\">// mount the sub app</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"316,329"}},{"content":"<pre data-lines=\"330,333\"><code>&#x5b83;&#x7c7b;&#x4f3c;&#x4e8e; req &#x5bf9;&#x8c61;&#x7684; baseUrl &#x5c5e;&#x6027;&#xff0c;&#x9664;&#x4e86; req.baseUrl &#x8fd4;&#x56de;&#x5339;&#x914d;&#x7684; URL &#x8def;&#x5f84;&#xff0c;&#x800c;&#x4e0d;&#x662f;&#x5339;&#x914d;&#x7684;&#x6a21;&#x5f0f;&#x3002;\n\n&#x5982;&#x679c;&#x5b50;&#x5e94;&#x7528;&#x6302;&#x8f7d;&#x5728;&#x591a;&#x4e2a;&#x8def;&#x5f84;&#x6a21;&#x5f0f;&#x4e0a;&#xff0c;app.mountpath &#x8fd4;&#x56de;&#x5176;&#x6302;&#x8f7d;&#x7684;&#x6a21;&#x5f0f;&#x5217;&#x8868;&#xff0c;&#x5982;&#x4e0b;&#x4f8b;&#x6240;&#x793a;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"330,333"}},{"content":"<pre data-lines=\"334,351\"><code class=\"language-js\"><span class=\"hljs-keyword\">var</span> admin = <span class=\"hljs-title function_\">express</span>()\n\nadmin.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;/&apos;</span>, <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res</span>) {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">dir</span>(admin.<span class=\"hljs-property\">mountpath</span>) <span class=\"hljs-comment\">// [ &apos;/adm*n&apos;, &apos;/manager&apos; ]</span>\n  res.<span class=\"hljs-title function_\">send</span>(<span class=\"hljs-string\">&apos;Admin Homepage&apos;</span>)\n})\n\n<span class=\"hljs-keyword\">var</span> secret = <span class=\"hljs-title function_\">express</span>()\nsecret.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;/&apos;</span>, <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res</span>) {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(secret.<span class=\"hljs-property\">mountpath</span>) <span class=\"hljs-comment\">// /secr*t</span>\n  res.<span class=\"hljs-title function_\">send</span>(<span class=\"hljs-string\">&apos;Admin Secret&apos;</span>)\n})\n\nadmin.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-string\">&apos;/secr*t&apos;</span>, secret) <span class=\"hljs-comment\">// load the &apos;secret&apos; router on &apos;/secr*t&apos;, on the &apos;admin&apos; sub app</span>\napp.<span class=\"hljs-title function_\">use</span>([<span class=\"hljs-string\">&apos;/adm*n&apos;</span>, <span class=\"hljs-string\">&apos;/manager&apos;</span>], admin) <span class=\"hljs-comment\">// load the &apos;admin&apos; router on &apos;/adm*n&apos; and &apos;/manager&apos;, on the paren</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"334,351"}}],"payload":{"tag":"h2","lines":"310,311"}},{"content":"app.on(&apos;mount&apos;, callback(parent))&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"354,363\"><code>&#x5f53;&#x5b50;&#x5e94;&#x7528;&#x5b89;&#x88c5;&#x5728;&#x7236;&#x5e94;&#x7528;&#x4e0a;&#x65f6;&#xff0c;mount &#x4e8b;&#x4ef6;&#x4f1a;&#x5728;&#x5b50;&#x5e94;&#x7528;&#x4e0a;&#x89e6;&#x53d1;&#x3002;&#x7236;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x88ab;&#x4f20;&#x9012;&#x7ed9;&#x56de;&#x8c03;&#x51fd;&#x6570;&#x3002;\n\n&#x6ce8;&#x610f;\n\n&#x5b50;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x5c06;&#xff1a;\n\n&#x4e0d;&#x7ee7;&#x627f;&#x5177;&#x6709;&#x9ed8;&#x8ba4;&#x503c;&#x7684;&#x8bbe;&#x7f6e;&#x503c;&#x3002;&#x60a8;&#x5fc5;&#x987b;&#x5728;&#x5b50;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x4e2d;&#x8bbe;&#x7f6e;&#x8be5;&#x503c;&#x3002;\n&#x7ee7;&#x627f;&#x8bbe;&#x7f6e;&#x7684;&#x503c;&#xff0c;&#x6ca1;&#x6709;&#x9ed8;&#x8ba4;&#x503c;&#x3002;\n&#x8be6;&#x89c1; &#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x8bbe;&#x7f6e;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"354,363"}},{"content":"<pre data-lines=\"364,378\"><code class=\"language-js\"><span class=\"hljs-keyword\">var</span> admin = <span class=\"hljs-title function_\">express</span>()\n\nadmin.<span class=\"hljs-title function_\">on</span>(<span class=\"hljs-string\">&apos;mount&apos;</span>, <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">parent</span>) {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;Admin Mounted&apos;</span>)\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(parent) <span class=\"hljs-comment\">// refers to the parent app</span>\n})\n\nadmin.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;/&apos;</span>, <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res</span>) {\n  res.<span class=\"hljs-title function_\">send</span>(<span class=\"hljs-string\">&apos;Admin Homepage&apos;</span>)\n})\n\napp.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-string\">&apos;/admin&apos;</span>, admin)\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"364,378"}}],"payload":{"tag":"h2","lines":"352,353"}},{"content":"app.all(path, callback [, callback ...])&#x4e2d;&#x82f1;","children":[{"content":"&#x793a;&#x4f8b;&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"422,423\"><code>&#x65e0;&#x8bba;&#x4f7f;&#x7528; GET&#x3001;POST&#x3001;PUT&#x3001;DELETE &#x8fd8;&#x662f;&#x4efb;&#x4f55;&#x5176;&#x4ed6; HTTP &#x8bf7;&#x6c42;&#x65b9;&#x6cd5;&#xff0c;&#x5bf9; /secret &#x7684;&#x8bf7;&#x6c42;&#x90fd;&#x4f1a;&#x6267;&#x884c;&#x4ee5;&#x4e0b;&#x56de;&#x8c03;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"422,423"}},{"content":"<pre data-lines=\"424,430\"><code class=\"language-js\">app.<span class=\"hljs-title function_\">all</span>(<span class=\"hljs-string\">&apos;/secret&apos;</span>, <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res, next</span>) {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;Accessing the secret section ...&apos;</span>)\n  <span class=\"hljs-title function_\">next</span>() <span class=\"hljs-comment\">// pass control to the next handler</span>\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"424,430"}},{"content":"<pre data-lines=\"431,432\"><code>app.all() &#x65b9;&#x6cd5;&#x5bf9;&#x4e8e;&#x4e3a;&#x7279;&#x5b9a;&#x8def;&#x5f84;&#x524d;&#x7f00;&#x6216;&#x4efb;&#x610f;&#x5339;&#x914d;&#x6620;&#x5c04; &quot;global&quot; &#x903b;&#x8f91;&#x5f88;&#x6709;&#x7528;&#x3002;&#x4f8b;&#x5982;&#xff0c;&#x5982;&#x679c;&#x60a8;&#x5c06;&#x4ee5;&#x4e0b;&#x5185;&#x5bb9;&#x653e;&#x5728;&#x6240;&#x6709;&#x5176;&#x4ed6;&#x8def;&#x7531;&#x5b9a;&#x4e49;&#x7684;&#x9876;&#x90e8;&#xff0c;&#x5219;&#x8981;&#x6c42;&#x4ece;&#x8be5;&#x70b9;&#x5f00;&#x59cb;&#x7684;&#x6240;&#x6709;&#x8def;&#x7531;&#x90fd;&#x9700;&#x8981;&#x8eab;&#x4efd;&#x9a8c;&#x8bc1;&#xff0c;&#x5e76;&#x81ea;&#x52a8;&#x52a0;&#x8f7d;&#x7528;&#x6237;&#x3002;&#x8bf7;&#x8bb0;&#x4f4f;&#xff0c;&#x8fd9;&#x4e9b;&#x56de;&#x8c03;&#x4e0d;&#x5fc5;&#x5145;&#x5f53;&#x7aef;&#x70b9;&#xff1a;loadUser &#x53ef;&#x4ee5;&#x6267;&#x884c;&#x4efb;&#x52a1;&#xff0c;&#x7136;&#x540e;&#x8c03;&#x7528; next() &#x4ee5;&#x7ee7;&#x7eed;&#x5339;&#x914d;&#x540e;&#x7eed;&#x8def;&#x7531;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"431,432"}},{"content":"<pre data-lines=\"433,436\"><code class=\"language-js\">app.<span class=\"hljs-title function_\">all</span>(<span class=\"hljs-string\">&apos;*&apos;</span>, requireAuthentication, loadUser)\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"433,436"}},{"content":"<pre data-lines=\"439,443\"><code class=\"language-js\">app.<span class=\"hljs-title function_\">all</span>(<span class=\"hljs-string\">&apos;*&apos;</span>, requireAuthentication)\napp.<span class=\"hljs-title function_\">all</span>(<span class=\"hljs-string\">&apos;*&apos;</span>, loadUser)\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"439,443"}},{"content":"<pre data-lines=\"444,445\"><code>&#x53e6;&#x4e00;&#x4e2a;&#x793a;&#x4f8b;&#x662f;&#x5217;&#x5165;&#x767d;&#x540d;&#x5355;&#x7684; &quot;global&quot; &#x529f;&#x80fd;&#x3002;&#x8be5;&#x793a;&#x4f8b;&#x4e0e;&#x4e0a;&#x9762;&#x7684;&#x793a;&#x4f8b;&#x7c7b;&#x4f3c;&#xff0c;&#x4f46;&#x5b83;&#x4ec5;&#x9650;&#x5236;&#x4ee5; &quot;/api&quot; &#x5f00;&#x5934;&#x7684;&#x8def;&#x5f84;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"444,445"}},{"content":"<pre data-lines=\"446,449\"><code class=\"language-js\">app.<span class=\"hljs-title function_\">all</span>(<span class=\"hljs-string\">&apos;/api/*&apos;</span>, requireAuthentication)\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"446,449"}}],"payload":{"tag":"h3","lines":"420,421"}}],"payload":{"tag":"h2","lines":"379,380"}},{"content":"app.delete(path, callback [, callback ...])&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"452,453\"><code>&#x4f7f;&#x7528;&#x6307;&#x5b9a;&#x7684;&#x56de;&#x8c03;&#x51fd;&#x6570;&#x5c06; HTTP DELETE &#x8bf7;&#x6c42;&#x8def;&#x7531;&#x5230;&#x6307;&#x5b9a;&#x8def;&#x5f84;&#x3002;&#x6709;&#x5173;&#x8be6;&#x7ec6;&#x4fe1;&#x606f;&#xff0c;&#x8bf7;&#x53c2;&#x9605; &#x8def;&#x7531;&#x6307;&#x5357;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"452,453"}},{"content":"<pre data-lines=\"454,490\"><code data-lines=\"454,490\">&#x53c2;&#x6570;\t&#x63cf;&#x8ff0;\t&#x9ed8;&#x8ba4;\n<span class=\"hljs-built_in\">path</span>\n\n&#x8c03;&#x7528;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x7684;&#x8def;&#x5f84;&#xff1b;&#x53ef;&#x4ee5;&#x662f;&#x4ee5;&#x4e0b;&#x4efb;&#x4f55;&#x4e00;&#x79cd;&#xff1a;\n\n&#x8868;&#x793a;&#x8def;&#x5f84;&#x7684;&#x5b57;&#x7b26;&#x4e32;&#x3002;\n\n&#x8def;&#x5f84;&#x6a21;&#x5f0f;&#x3002;\n\n&#x5339;&#x914d;&#x8def;&#x5f84;&#x7684;&#x6b63;&#x5219;&#x8868;&#x8fbe;&#x5f0f;&#x6a21;&#x5f0f;&#x3002;\n\n&#x4ee5;&#x4e0a;&#x4efb;&#x4f55;&#x4e00;&#x79cd;&#x7ec4;&#x5408;&#x7684;&#x6570;&#x7ec4;&#x3002;\n\n&#x4f8b;&#x5982;&#xff0c;&#x53c2;&#x89c1; &#x8def;&#x5f84;&#x793a;&#x4f8b;&#x3002;\n\n<span class=\"hljs-string\">&apos;/&apos;</span>&#xff08;&#x6839;&#x8def;&#x5f84;&#xff09;\n\ncallback\n\n&#x56de;&#x8c03;&#x51fd;&#x6570;&#xff1b;&#x53ef;&#x4ee5;&#x662f;&#xff1a;\n\n&#x4e00;&#x4e2a;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x3002;\n\n&#x4e00;&#x7cfb;&#x5217;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#xff08;&#x4ee5;&#x9017;&#x53f7;&#x5206;&#x9694;&#xff09;&#x3002;\n\n&#x4e00;&#x7ec4;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x3002;\n\n&#x4ee5;&#x4e0a;&#x6240;&#x6709;&#x7684;&#x7ec4;&#x5408;&#x3002;\n\n&#x60a8;&#x53ef;&#x4ee5;&#x63d0;&#x4f9b;&#x591a;&#x4e2a;&#x56de;&#x8c03;&#x51fd;&#x6570;&#xff0c;&#x5176;&#x884c;&#x4e3a;&#x7c7b;&#x4f3c;&#x4e8e;&#x4e2d;&#x95f4;&#x4ef6;&#xff0c;&#x53ea;&#x662f;&#x8fd9;&#x4e9b;&#x56de;&#x8c03;&#x53ef;&#x4ee5;&#x8c03;&#x7528; <span class=\"hljs-built_in\">next</span>(<span class=\"hljs-string\">&apos;route&apos;</span>) &#x4ee5;&#x7ed5;&#x8fc7;&#x5269;&#x4f59;&#x7684;&#x8def;&#x7531;&#x56de;&#x8c03;&#x3002;&#x60a8;&#x53ef;&#x4ee5;&#x4f7f;&#x7528;&#x6b64;&#x673a;&#x5236;&#x5bf9;&#x8def;&#x7531;&#x65bd;&#x52a0;&#x5148;&#x51b3;&#x6761;&#x4ef6;&#xff0c;&#x7136;&#x540e;&#x5982;&#x679c;&#x6ca1;&#x6709;&#x7406;&#x7531;&#x7ee7;&#x7eed;&#x5f53;&#x524d;&#x8def;&#x7531;&#xff0c;&#x5219;&#x5c06;&#x63a7;&#x5236;&#x6743;&#x4f20;&#x9012;&#x7ed9;&#x540e;&#x7eed;&#x8def;&#x7531;&#x3002;\n\n&#x7531;&#x4e8e; router &#x548c; app &#x5b9e;&#x73b0;&#x4e86;&#x4e2d;&#x95f4;&#x4ef6;&#x63a5;&#x53e3;&#xff0c;&#x60a8;&#x53ef;&#x4ee5;&#x50cf;&#x4f7f;&#x7528;&#x4efb;&#x4f55;&#x5176;&#x4ed6;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x4e00;&#x6837;&#x4f7f;&#x7528;&#x5b83;&#x4eec;&#x3002;\n\n&#x4f8b;&#x5982;&#xff0c;&#x53c2;&#x89c1; &#x4e2d;&#x95f4;&#x4ef6;&#x56de;&#x8c03;&#x51fd;&#x6570;&#x793a;&#x4f8b;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"454,490"}},{"content":"<pre data-lines=\"493,498\"><code class=\"language-js\">app.<span class=\"hljs-title function_\">delete</span>(<span class=\"hljs-string\">&apos;/&apos;</span>, <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res</span>) {\n  res.<span class=\"hljs-title function_\">send</span>(<span class=\"hljs-string\">&apos;DELETE request to homepage&apos;</span>)\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"493,498"}}],"payload":{"tag":"h2","lines":"450,451"}},{"content":"app.disable(name)&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"501,504\"><code>&#x5c06;&#x5e03;&#x5c14;&#x8bbe;&#x7f6e; name &#x8bbe;&#x7f6e;&#x4e3a; false&#xff0c;&#x5176;&#x4e2d; name &#x662f; &#x5e94;&#x7528;&#x8bbe;&#x7f6e;&#x8868; &#x7684;&#x5c5e;&#x6027;&#x4e4b;&#x4e00;&#x3002;&#x4e3a;&#x5e03;&#x5c14;&#x5c5e;&#x6027;&#x8c03;&#x7528; app.set(&apos;foo&apos;, false) &#x4e0e;&#x8c03;&#x7528; app.disable(&apos;foo&apos;) &#x76f8;&#x540c;&#x3002;\n\n&#x4f8b;&#x5982;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"501,504"}},{"content":"<pre data-lines=\"505,510\"><code class=\"language-js\">app.<span class=\"hljs-title function_\">disable</span>(<span class=\"hljs-string\">&apos;trust proxy&apos;</span>)\napp.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;trust proxy&apos;</span>)\n<span class=\"hljs-comment\">// =&gt; false</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"505,510"}}],"payload":{"tag":"h2","lines":"499,500"}},{"content":"app.disabled(name)&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"513,514\"><code>&#x5982;&#x679c;&#x7981;&#x7528;&#x5e03;&#x5c14;&#x8bbe;&#x7f6e; name (false)&#xff0c;&#x5219;&#x8fd4;&#x56de; true&#xff0c;&#x5176;&#x4e2d; name &#x662f; &#x5e94;&#x7528;&#x8bbe;&#x7f6e;&#x8868; &#x7684;&#x5c5e;&#x6027;&#x4e4b;&#x4e00;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"513,514"}},{"content":"<pre data-lines=\"515,523\"><code class=\"language-js\">app.<span class=\"hljs-title function_\">disabled</span>(<span class=\"hljs-string\">&apos;trust proxy&apos;</span>)\n<span class=\"hljs-comment\">// =&gt; true</span>\n\napp.<span class=\"hljs-title function_\">enable</span>(<span class=\"hljs-string\">&apos;trust proxy&apos;</span>)\napp.<span class=\"hljs-title function_\">disabled</span>(<span class=\"hljs-string\">&apos;trust proxy&apos;</span>)\n<span class=\"hljs-comment\">// =&gt; false</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"515,523"}}],"payload":{"tag":"h2","lines":"511,512"}},{"content":"app.enable(name)&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"526,527\"><code>&#x5c06;&#x5e03;&#x5c14;&#x8bbe;&#x7f6e; name &#x8bbe;&#x7f6e;&#x4e3a; true&#xff0c;&#x5176;&#x4e2d; name &#x662f; &#x5e94;&#x7528;&#x8bbe;&#x7f6e;&#x8868; &#x7684;&#x5c5e;&#x6027;&#x4e4b;&#x4e00;&#x3002;&#x4e3a;&#x5e03;&#x5c14;&#x5c5e;&#x6027;&#x8c03;&#x7528; app.set(&apos;foo&apos;, true) &#x4e0e;&#x8c03;&#x7528; app.enable(&apos;foo&apos;) &#x76f8;&#x540c;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"526,527"}},{"content":"<pre data-lines=\"528,533\"><code class=\"language-js\">app.<span class=\"hljs-title function_\">enable</span>(<span class=\"hljs-string\">&apos;trust proxy&apos;</span>)\napp.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;trust proxy&apos;</span>)\n<span class=\"hljs-comment\">// =&gt; true</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"528,533"}}],"payload":{"tag":"h2","lines":"524,525"}},{"content":"app.enabled(name)&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"536,537\"><code>&#x5982;&#x679c;&#x542f;&#x7528;&#x4e86;&#x8bbe;&#x7f6e; name (true)&#xff0c;&#x5219;&#x8fd4;&#x56de; true&#xff0c;&#x5176;&#x4e2d; name &#x662f; &#x5e94;&#x7528;&#x8bbe;&#x7f6e;&#x8868; &#x7684;&#x5c5e;&#x6027;&#x4e4b;&#x4e00;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"536,537"}},{"content":"<pre data-lines=\"538,546\"><code class=\"language-js\">app.<span class=\"hljs-title function_\">enabled</span>(<span class=\"hljs-string\">&apos;trust proxy&apos;</span>)\n<span class=\"hljs-comment\">// =&gt; false</span>\n\napp.<span class=\"hljs-title function_\">enable</span>(<span class=\"hljs-string\">&apos;trust proxy&apos;</span>)\napp.<span class=\"hljs-title function_\">enabled</span>(<span class=\"hljs-string\">&apos;trust proxy&apos;</span>)\n<span class=\"hljs-comment\">// =&gt; true</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"538,546"}}],"payload":{"tag":"h2","lines":"534,535"}},{"content":"app.engine(ext, callback)&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"549,552\"><code>&#x5c06;&#x7ed9;&#x5b9a;&#x7684;&#x6a21;&#x677f;&#x5f15;&#x64ce; callback &#x6ce8;&#x518c;&#x4e3a; ext&#x3002;\n\n&#x9ed8;&#x8ba4;&#x60c5;&#x51b5;&#x4e0b;&#xff0c;Express &#x4f1a;&#x6839;&#x636e;&#x6587;&#x4ef6;&#x6269;&#x5c55;&#x540d; require() &#x5f15;&#x64ce;&#x3002;&#x4f8b;&#x5982;&#xff0c;&#x5982;&#x679c;&#x60a8;&#x5c1d;&#x8bd5;&#x6e32;&#x67d3; &quot;foo.pug&quot; &#x6587;&#x4ef6;&#xff0c;Express &#x4f1a;&#x5728;&#x5185;&#x90e8;&#x8c03;&#x7528;&#x4ee5;&#x4e0b;&#x5185;&#x5bb9;&#xff0c;&#x5e76;&#x5728;&#x540e;&#x7eed;&#x8c03;&#x7528;&#x4e2d;&#x7f13;&#x5b58; require() &#x4ee5;&#x63d0;&#x9ad8;&#x6027;&#x80fd;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"549,552"}},{"content":"<pre data-lines=\"553,556\"><code class=\"language-js\">app.<span class=\"hljs-title function_\">engine</span>(<span class=\"hljs-string\">&apos;pug&apos;</span>, <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;pug&apos;</span>).<span class=\"hljs-property\">__express</span>)\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"553,556"}},{"content":"<pre data-lines=\"557,560\"><code>&#x5bf9;&#x4e8e;&#x4e0d;&#x63d0;&#x4f9b;&#x5f00;&#x7bb1;&#x5373;&#x7528;&#x7684; .__express &#x7684;&#x5f15;&#x64ce;&#xff0c;&#x6216;&#x8005;&#x5982;&#x679c;&#x60a8;&#x5e0c;&#x671b; &quot;map&quot; &#x4e3a;&#x6a21;&#x677f;&#x5f15;&#x64ce;&#x63d0;&#x4f9b;&#x4e0d;&#x540c;&#x7684;&#x6269;&#x5c55;&#xff0c;&#x8bf7;&#x4f7f;&#x7528;&#x6b64;&#x65b9;&#x6cd5;&#x3002;\n\n&#x4f8b;&#x5982;&#xff0c;&#x8981;&#x5c06; EJS &#x6a21;&#x677f;&#x5f15;&#x64ce;&#x6620;&#x5c04;&#x5230; &quot;.html&quot; &#x6587;&#x4ef6;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"557,560"}},{"content":"<pre data-lines=\"561,564\"><code class=\"language-js\">app.<span class=\"hljs-title function_\">engine</span>(<span class=\"hljs-string\">&apos;html&apos;</span>, <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;ejs&apos;</span>).<span class=\"hljs-property\">renderFile</span>)\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"561,564"}},{"content":"<pre data-lines=\"565,568\"><code>&#x5728;&#x8fd9;&#x79cd;&#x60c5;&#x51b5;&#x4e0b;&#xff0c;EJS &#x63d0;&#x4f9b;&#x4e86;&#x4e00;&#x4e2a; .renderFile() &#x65b9;&#x6cd5;&#xff0c;&#x5176;&#x7b7e;&#x540d;&#x4e0e; Express &#x671f;&#x671b;&#x7684;&#x76f8;&#x540c;&#xff1a;(path, options, callback)&#xff0c;&#x4f46;&#x8bf7;&#x6ce8;&#x610f;&#xff0c;&#x5b83;&#x5728;&#x5185;&#x90e8;&#x5c06;&#x6b64;&#x65b9;&#x6cd5;&#x522b;&#x540d;&#x4e3a; ejs.__express&#xff0c;&#x56e0;&#x6b64;&#x5982;&#x679c;&#x60a8;&#x4f7f;&#x7528; &quot;.ejs&quot; &#x6269;&#x5c55;&#xff0c;&#x5219;&#x65e0;&#x9700;&#x6267;&#x884c;&#x4efb;&#x4f55;&#x64cd;&#x4f5c;&#x3002;\n\n&#x4e00;&#x4e9b;&#x6a21;&#x677f;&#x5f15;&#x64ce;&#x4e0d;&#x9075;&#x5faa;&#x8fd9;&#x4e2a;&#x7ea6;&#x5b9a;&#x3002;consolidate.js &#x5e93;&#x6620;&#x5c04; Node &#x6a21;&#x677f;&#x5f15;&#x64ce;&#x4ee5;&#x9075;&#x5faa;&#x6b64;&#x7ea6;&#x5b9a;&#xff0c;&#x56e0;&#x6b64;&#x5b83;&#x4eec;&#x53ef;&#x4ee5;&#x4e0e; Express &#x65e0;&#x7f1d;&#x534f;&#x4f5c;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"565,568"}},{"content":"<pre data-lines=\"569,574\"><code class=\"language-js\"><span class=\"hljs-keyword\">var</span> engines = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;consolidate&apos;</span>)\napp.<span class=\"hljs-title function_\">engine</span>(<span class=\"hljs-string\">&apos;haml&apos;</span>, engines.<span class=\"hljs-property\">haml</span>)\napp.<span class=\"hljs-title function_\">engine</span>(<span class=\"hljs-string\">&apos;html&apos;</span>, engines.<span class=\"hljs-property\">hogan</span>)\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"569,574"}}],"payload":{"tag":"h2","lines":"547,548"}},{"content":"app.get(name)&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"577,578\"><code>&#x8fd4;&#x56de; name &#x5e94;&#x7528;&#x8bbe;&#x7f6e;&#x7684;&#x503c;&#xff0c;&#x5176;&#x4e2d; name &#x662f; &#x5e94;&#x7528;&#x8bbe;&#x7f6e;&#x8868; &#x4e2d;&#x7684;&#x5b57;&#x7b26;&#x4e32;&#x4e4b;&#x4e00;&#x3002;&#x4f8b;&#x5982;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"577,578"}},{"content":"<pre data-lines=\"579,587\"><code class=\"language-js\">app.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;title&apos;</span>)\n<span class=\"hljs-comment\">// =&gt; undefined</span>\n\napp.<span class=\"hljs-title function_\">set</span>(<span class=\"hljs-string\">&apos;title&apos;</span>, <span class=\"hljs-string\">&apos;My Site&apos;</span>)\napp.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;title&apos;</span>)\n<span class=\"hljs-comment\">// =&gt; &quot;My Site&quot;</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"579,587"}}],"payload":{"tag":"h2","lines":"575,576"}},{"content":"app.get(path, callback [, callback ...])&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"590,591\"><code>&#x4f7f;&#x7528;&#x6307;&#x5b9a;&#x7684;&#x56de;&#x8c03;&#x51fd;&#x6570;&#x5c06; HTTP GET &#x8bf7;&#x6c42;&#x8def;&#x7531;&#x5230;&#x6307;&#x5b9a;&#x8def;&#x5f84;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"590,591"}},{"content":"<pre data-lines=\"592,628\"><code data-lines=\"592,628\">&#x53c2;&#x6570;\t&#x63cf;&#x8ff0;\t&#x9ed8;&#x8ba4;\n<span class=\"hljs-built_in\">path</span>\n\n&#x8c03;&#x7528;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x7684;&#x8def;&#x5f84;&#xff1b;&#x53ef;&#x4ee5;&#x662f;&#x4ee5;&#x4e0b;&#x4efb;&#x4f55;&#x4e00;&#x79cd;&#xff1a;\n\n&#x8868;&#x793a;&#x8def;&#x5f84;&#x7684;&#x5b57;&#x7b26;&#x4e32;&#x3002;\n\n&#x8def;&#x5f84;&#x6a21;&#x5f0f;&#x3002;\n\n&#x5339;&#x914d;&#x8def;&#x5f84;&#x7684;&#x6b63;&#x5219;&#x8868;&#x8fbe;&#x5f0f;&#x6a21;&#x5f0f;&#x3002;\n\n&#x4ee5;&#x4e0a;&#x4efb;&#x4f55;&#x4e00;&#x79cd;&#x7ec4;&#x5408;&#x7684;&#x6570;&#x7ec4;&#x3002;\n\n&#x4f8b;&#x5982;&#xff0c;&#x53c2;&#x89c1; &#x8def;&#x5f84;&#x793a;&#x4f8b;&#x3002;\n\n<span class=\"hljs-string\">&apos;/&apos;</span>&#xff08;&#x6839;&#x8def;&#x5f84;&#xff09;\n\ncallback\n\n&#x56de;&#x8c03;&#x51fd;&#x6570;&#xff1b;&#x53ef;&#x4ee5;&#x662f;&#xff1a;\n\n&#x4e00;&#x4e2a;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x3002;\n\n&#x4e00;&#x7cfb;&#x5217;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#xff08;&#x4ee5;&#x9017;&#x53f7;&#x5206;&#x9694;&#xff09;&#x3002;\n\n&#x4e00;&#x7ec4;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x3002;\n\n&#x4ee5;&#x4e0a;&#x6240;&#x6709;&#x7684;&#x7ec4;&#x5408;&#x3002;\n\n&#x60a8;&#x53ef;&#x4ee5;&#x63d0;&#x4f9b;&#x591a;&#x4e2a;&#x56de;&#x8c03;&#x51fd;&#x6570;&#xff0c;&#x5176;&#x884c;&#x4e3a;&#x7c7b;&#x4f3c;&#x4e8e;&#x4e2d;&#x95f4;&#x4ef6;&#xff0c;&#x53ea;&#x662f;&#x8fd9;&#x4e9b;&#x56de;&#x8c03;&#x53ef;&#x4ee5;&#x8c03;&#x7528; <span class=\"hljs-built_in\">next</span>(<span class=\"hljs-string\">&apos;route&apos;</span>) &#x4ee5;&#x7ed5;&#x8fc7;&#x5269;&#x4f59;&#x7684;&#x8def;&#x7531;&#x56de;&#x8c03;&#x3002;&#x60a8;&#x53ef;&#x4ee5;&#x4f7f;&#x7528;&#x6b64;&#x673a;&#x5236;&#x5bf9;&#x8def;&#x7531;&#x65bd;&#x52a0;&#x5148;&#x51b3;&#x6761;&#x4ef6;&#xff0c;&#x7136;&#x540e;&#x5982;&#x679c;&#x6ca1;&#x6709;&#x7406;&#x7531;&#x7ee7;&#x7eed;&#x5f53;&#x524d;&#x8def;&#x7531;&#xff0c;&#x5219;&#x5c06;&#x63a7;&#x5236;&#x6743;&#x4f20;&#x9012;&#x7ed9;&#x540e;&#x7eed;&#x8def;&#x7531;&#x3002;\n\n&#x7531;&#x4e8e; router &#x548c; app &#x5b9e;&#x73b0;&#x4e86;&#x4e2d;&#x95f4;&#x4ef6;&#x63a5;&#x53e3;&#xff0c;&#x60a8;&#x53ef;&#x4ee5;&#x50cf;&#x4f7f;&#x7528;&#x4efb;&#x4f55;&#x5176;&#x4ed6;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x4e00;&#x6837;&#x4f7f;&#x7528;&#x5b83;&#x4eec;&#x3002;\n\n&#x4f8b;&#x5982;&#xff0c;&#x53c2;&#x89c1; &#x4e2d;&#x95f4;&#x4ef6;&#x56de;&#x8c03;&#x51fd;&#x6570;&#x793a;&#x4f8b;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"592,628"}},{"content":"<pre data-lines=\"629,634\"><code data-lines=\"629,634\">app.<span class=\"hljs-built_in\">get</span>(<span class=\"hljs-string\">&apos;/&apos;</span>, <span class=\"hljs-keyword\">function</span> (req, <span class=\"hljs-keyword\">res</span>) {\n  <span class=\"hljs-keyword\">res</span>.send(<span class=\"hljs-string\">&apos;GET request to homepage&apos;</span>)\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"629,634"}}],"payload":{"tag":"h2","lines":"588,589"}},{"content":"app.listen(path, [callback])&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"637,638\"><code>&#x542f;&#x52a8;&#x4e00;&#x4e2a; UNIX &#x5957;&#x63a5;&#x5b57;&#x5e76;&#x76d1;&#x542c;&#x7ed9;&#x5b9a;&#x8def;&#x5f84;&#x4e0a;&#x7684;&#x8fde;&#x63a5;&#x3002;&#x6b64;&#x65b9;&#x6cd5;&#x4e0e; Node &#x7684; http.Server.listen() &#x76f8;&#x540c;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"637,638"}},{"content":"<pre data-lines=\"639,644\"><code class=\"language-js\"><span class=\"hljs-keyword\">var</span> express = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;express&apos;</span>)\n<span class=\"hljs-keyword\">var</span> app = <span class=\"hljs-title function_\">express</span>()\napp.<span class=\"hljs-title function_\">listen</span>(<span class=\"hljs-string\">&apos;/tmp/sock&apos;</span>)\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"639,644"}}],"payload":{"tag":"h2","lines":"635,636"}},{"content":"app.listen([port[, host[, backlog]]][, callback])&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"647,650\"><code>&#x7ed1;&#x5b9a;&#x5e76;&#x76d1;&#x542c;&#x6307;&#x5b9a;&#x4e3b;&#x673a;&#x548c;&#x7aef;&#x53e3;&#x4e0a;&#x7684;&#x8fde;&#x63a5;&#x3002;&#x6b64;&#x65b9;&#x6cd5;&#x4e0e; Node &#x7684; http.Server.listen() &#x76f8;&#x540c;&#x3002;\n\n&#x5982;&#x679c;&#x7aef;&#x53e3;&#x88ab;&#x7701;&#x7565;&#x6216;&#x4e3a; 0&#xff0c;&#x64cd;&#x4f5c;&#x7cfb;&#x7edf;&#x5c06;&#x5206;&#x914d;&#x4e00;&#x4e2a;&#x4efb;&#x610f;&#x672a;&#x4f7f;&#x7528;&#x7684;&#x7aef;&#x53e3;&#xff0c;&#x8fd9;&#x5bf9;&#x4e8e;&#x81ea;&#x52a8;&#x5316;&#x4efb;&#x52a1;&#xff08;&#x6d4b;&#x8bd5;&#x7b49;&#xff09;&#x7b49;&#x60c5;&#x51b5;&#x5f88;&#x6709;&#x7528;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"647,650"}},{"content":"<pre data-lines=\"651,656\"><code class=\"language-js\"><span class=\"hljs-keyword\">var</span> express = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;express&apos;</span>)\n<span class=\"hljs-keyword\">var</span> app = <span class=\"hljs-title function_\">express</span>()\napp.<span class=\"hljs-title function_\">listen</span>(<span class=\"hljs-number\">3000</span>)\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"651,656"}},{"content":"<pre data-lines=\"657,658\"><code>express() &#x8fd4;&#x56de;&#x7684; app &#x5b9e;&#x9645;&#x4e0a;&#x662f;&#x4e00;&#x4e2a; JavaScript Function&#xff0c;&#x65e8;&#x5728;&#x4f5c;&#x4e3a;&#x56de;&#x8c03;&#x4f20;&#x9012;&#x7ed9; Node &#x7684; HTTP &#x670d;&#x52a1;&#x5668;&#x6765;&#x5904;&#x7406;&#x8bf7;&#x6c42;&#x3002;&#x8fd9;&#x4f7f;&#x5f97;&#x4e3a;&#x200b;&#x200b;&#x60a8;&#x7684;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x7684; HTTP &#x548c; HTTPS &#x7248;&#x672c;&#x63d0;&#x4f9b;&#x76f8;&#x540c;&#x7684;&#x4ee3;&#x7801;&#x5e93;&#x53d8;&#x5f97;&#x5f88;&#x5bb9;&#x6613;&#xff0c;&#x56e0;&#x4e3a;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x4e0d;&#x4f1a;&#x4ece;&#x8fd9;&#x4e9b;&#x7248;&#x672c;&#x7ee7;&#x627f;&#xff08;&#x5b83;&#x53ea;&#x662f;&#x4e00;&#x4e2a;&#x56de;&#x8c03;&#xff09;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"657,658"}},{"content":"<pre data-lines=\"659,668\"><code class=\"language-js\"><span class=\"hljs-keyword\">var</span> express = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;express&apos;</span>)\n<span class=\"hljs-keyword\">var</span> https = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;https&apos;</span>)\n<span class=\"hljs-keyword\">var</span> http = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;http&apos;</span>)\n<span class=\"hljs-keyword\">var</span> app = <span class=\"hljs-title function_\">express</span>()\n\nhttp.<span class=\"hljs-title function_\">createServer</span>(app).<span class=\"hljs-title function_\">listen</span>(<span class=\"hljs-number\">80</span>)\nhttps.<span class=\"hljs-title function_\">createServer</span>(options, app).<span class=\"hljs-title function_\">listen</span>(<span class=\"hljs-number\">443</span>)\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"659,668"}},{"content":"<pre data-lines=\"669,670\"><code>app.listen() &#x65b9;&#x6cd5;&#x8fd4;&#x56de;&#x4e00;&#x4e2a; http.Server &#x5bf9;&#x8c61;&#xff0c;&#x5e76;&#x4e14;&#xff08;&#x5bf9;&#x4e8e; HTTP&#xff09;&#x662f;&#x4ee5;&#x4e0b;&#x7684;&#x4fbf;&#x6377;&#x65b9;&#x6cd5;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"669,670"}},{"content":"<pre data-lines=\"671,677\"><code class=\"language-js\">app.<span class=\"hljs-property\">listen</span> = <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\"></span>) {\n  <span class=\"hljs-keyword\">var</span> server = http.<span class=\"hljs-title function_\">createServer</span>(<span class=\"hljs-variable language_\">this</span>)\n  <span class=\"hljs-keyword\">return</span> server.<span class=\"hljs-property\">listen</span>.<span class=\"hljs-title function_\">apply</span>(server, <span class=\"hljs-variable language_\">arguments</span>)\n}\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"671,677"}},{"content":"<pre data-lines=\"678,679\"><code>&#x6ce8;&#x610f;&#xff1a;Node &#x7684; http.Server.listen() &#x65b9;&#x6cd5;&#x7684;&#x6240;&#x6709;&#x5f62;&#x5f0f;&#x5176;&#x5b9e;&#x90fd;&#x662f;&#x652f;&#x6301;&#x7684;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"678,679"}}],"payload":{"tag":"h2","lines":"645,646"}},{"content":"app.METHOD(path, callback [, callback ...])&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"682,683\"><code>&#x8def;&#x7531; HTTP &#x8bf7;&#x6c42;&#xff0c;&#x5176;&#x4e2d; METHOD &#x662f;&#x8bf7;&#x6c42;&#x7684; HTTP &#x65b9;&#x6cd5;&#xff0c;&#x5982; GET&#x3001;PUT&#x3001;POST &#x7b49;&#xff0c;&#x5c0f;&#x5199;&#x3002;&#x56e0;&#x6b64;&#xff0c;&#x5b9e;&#x9645;&#x7684;&#x65b9;&#x6cd5;&#x662f; app.get()&#x3001;app.post()&#x3001;app.put() &#x7b49;&#x7b49;&#x3002;&#x6709;&#x5173;&#x5b8c;&#x6574;&#x5217;&#x8868;&#xff0c;&#x8bf7;&#x53c2;&#x89c1;&#x4e0b;&#x9762;&#x7684; &#x8def;&#x7531;&#x65b9;&#x6cd5;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"682,683"}},{"content":"<pre data-lines=\"684,719\"><code data-lines=\"684,719\"><span class=\"hljs-built_in\">path</span>\n\n&#x8c03;&#x7528;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x7684;&#x8def;&#x5f84;&#xff1b;&#x53ef;&#x4ee5;&#x662f;&#x4ee5;&#x4e0b;&#x4efb;&#x4f55;&#x4e00;&#x79cd;&#xff1a;\n\n&#x8868;&#x793a;&#x8def;&#x5f84;&#x7684;&#x5b57;&#x7b26;&#x4e32;&#x3002;\n\n&#x8def;&#x5f84;&#x6a21;&#x5f0f;&#x3002;\n\n&#x5339;&#x914d;&#x8def;&#x5f84;&#x7684;&#x6b63;&#x5219;&#x8868;&#x8fbe;&#x5f0f;&#x6a21;&#x5f0f;&#x3002;\n\n&#x4ee5;&#x4e0a;&#x4efb;&#x4f55;&#x4e00;&#x79cd;&#x7ec4;&#x5408;&#x7684;&#x6570;&#x7ec4;&#x3002;\n\n&#x4f8b;&#x5982;&#xff0c;&#x53c2;&#x89c1; &#x8def;&#x5f84;&#x793a;&#x4f8b;&#x3002;\n\n<span class=\"hljs-string\">&apos;/&apos;</span>&#xff08;&#x6839;&#x8def;&#x5f84;&#xff09;\n\ncallback\n\n&#x56de;&#x8c03;&#x51fd;&#x6570;&#xff1b;&#x53ef;&#x4ee5;&#x662f;&#xff1a;\n\n&#x4e00;&#x4e2a;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x3002;\n\n&#x4e00;&#x7cfb;&#x5217;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#xff08;&#x4ee5;&#x9017;&#x53f7;&#x5206;&#x9694;&#xff09;&#x3002;\n\n&#x4e00;&#x7ec4;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x3002;\n\n&#x4ee5;&#x4e0a;&#x6240;&#x6709;&#x7684;&#x7ec4;&#x5408;&#x3002;\n\n&#x60a8;&#x53ef;&#x4ee5;&#x63d0;&#x4f9b;&#x591a;&#x4e2a;&#x56de;&#x8c03;&#x51fd;&#x6570;&#xff0c;&#x5176;&#x884c;&#x4e3a;&#x7c7b;&#x4f3c;&#x4e8e;&#x4e2d;&#x95f4;&#x4ef6;&#xff0c;&#x53ea;&#x662f;&#x8fd9;&#x4e9b;&#x56de;&#x8c03;&#x53ef;&#x4ee5;&#x8c03;&#x7528; <span class=\"hljs-built_in\">next</span>(<span class=\"hljs-string\">&apos;route&apos;</span>) &#x4ee5;&#x7ed5;&#x8fc7;&#x5269;&#x4f59;&#x7684;&#x8def;&#x7531;&#x56de;&#x8c03;&#x3002;&#x60a8;&#x53ef;&#x4ee5;&#x4f7f;&#x7528;&#x6b64;&#x673a;&#x5236;&#x5bf9;&#x8def;&#x7531;&#x65bd;&#x52a0;&#x5148;&#x51b3;&#x6761;&#x4ef6;&#xff0c;&#x7136;&#x540e;&#x5982;&#x679c;&#x6ca1;&#x6709;&#x7406;&#x7531;&#x7ee7;&#x7eed;&#x5f53;&#x524d;&#x8def;&#x7531;&#xff0c;&#x5219;&#x5c06;&#x63a7;&#x5236;&#x6743;&#x4f20;&#x9012;&#x7ed9;&#x540e;&#x7eed;&#x8def;&#x7531;&#x3002;\n\n&#x7531;&#x4e8e; router &#x548c; app &#x5b9e;&#x73b0;&#x4e86;&#x4e2d;&#x95f4;&#x4ef6;&#x63a5;&#x53e3;&#xff0c;&#x60a8;&#x53ef;&#x4ee5;&#x50cf;&#x4f7f;&#x7528;&#x4efb;&#x4f55;&#x5176;&#x4ed6;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x4e00;&#x6837;&#x4f7f;&#x7528;&#x5b83;&#x4eec;&#x3002;\n\n&#x4f8b;&#x5982;&#xff0c;&#x53c2;&#x89c1; &#x4e2d;&#x95f4;&#x4ef6;&#x56de;&#x8c03;&#x51fd;&#x6570;&#x793a;&#x4f8b;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"684,719"}}],"payload":{"tag":"h2","lines":"680,681"}},{"content":"&#x8def;&#x7531;&#x65b9;&#x6cd5;&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"721,722\"><code>Express &#x652f;&#x6301;&#x4ee5;&#x4e0b;&#x4e0e; HTTP &#x540c;&#x540d;&#x65b9;&#x6cd5;&#x5bf9;&#x5e94;&#x7684;&#x8def;&#x7531;&#x65b9;&#x6cd5;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"721,722"}},{"content":"<pre data-lines=\"723,748\"><code data-lines=\"723,748\">checkout\n<span class=\"hljs-keyword\">copy</span>\n<span class=\"hljs-keyword\">delete</span>\n<span class=\"hljs-keyword\">get</span>\nhead\n<span class=\"hljs-keyword\">lock</span>\nmerge\nmkactivity\nmkcol\n<span class=\"hljs-keyword\">move</span>\nm-<span class=\"hljs-keyword\">search</span>\n<span class=\"hljs-keyword\">notify</span>\n<span class=\"hljs-keyword\">options</span>\npatch\npost\npurge\nput\nreport\n<span class=\"hljs-keyword\">search</span>\nsubscribe\ntrace\nunlock\nunsubscribe\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"723,748"}},{"content":"<pre data-lines=\"749,758\"><code>API &#x6587;&#x6863;&#x4ec5;&#x9488;&#x5bf9;&#x6700;&#x6d41;&#x884c;&#x7684; HTTP &#x65b9;&#x6cd5; app.get()&#x3001;app.post()&#x3001;app.put() &#x548c; app.delete() &#x6709;&#x660e;&#x786e;&#x7684;&#x6761;&#x76ee;&#x3002;&#x4f46;&#x662f;&#xff0c;&#x4e0a;&#x9762;&#x5217;&#x51fa;&#x7684;&#x5176;&#x4ed6;&#x65b9;&#x6cd5;&#x7684;&#x5de5;&#x4f5c;&#x65b9;&#x5f0f;&#x5b8c;&#x5168;&#x76f8;&#x540c;&#x3002;\n\n&#x8981;&#x8def;&#x7531;&#x8f6c;&#x6362;&#x4e3a;&#x65e0;&#x6548; JavaScript &#x53d8;&#x91cf;&#x540d;&#x7684;&#x65b9;&#x6cd5;&#xff0c;&#x8bf7;&#x4f7f;&#x7528;&#x65b9;&#x62ec;&#x53f7;&#x8868;&#x793a;&#x6cd5;&#x3002;&#x4f8b;&#x5982;&#xff0c;app[&apos;m-search&apos;](&apos;/&apos;, function ...&#x3002;\n\n&#x5982;&#x679c; app.get() &#x4e4b;&#x524d;&#x7684;&#x8def;&#x5f84;&#x6ca1;&#x6709;&#x8c03;&#x7528; app.head()&#xff0c;&#x5219;&#x9664;&#x4e86; GET &#x65b9;&#x6cd5;&#x4e4b;&#x5916;&#xff0c;&#x8fd8;&#x4f1a;&#x4e3a; HTTP HEAD &#x65b9;&#x6cd5;&#x81ea;&#x52a8;&#x8c03;&#x7528; app.get() &#x51fd;&#x6570;&#x3002;\n\n&#x65b9;&#x6cd5; app.all() &#x4e0d;&#x662f;&#x4ece;&#x4efb;&#x4f55; HTTP &#x65b9;&#x6cd5;&#x6d3e;&#x751f;&#x7684;&#xff0c;&#x800c;&#x662f;&#x5728;&#x6307;&#x5b9a;&#x8def;&#x5f84;&#x4e3a;&#x6240;&#x6709; HTTP &#x8bf7;&#x6c42;&#x65b9;&#x6cd5;&#x52a0;&#x8f7d;&#x4e2d;&#x95f4;&#x4ef6;&#x3002;&#x6709;&#x5173;&#x8be6;&#x7ec6;&#x4fe1;&#x606f;&#xff0c;&#x8bf7;&#x53c2;&#x9605; app.all&#x3002;\n\n&#x6709;&#x5173;&#x8def;&#x7531;&#x7684;&#x66f4;&#x591a;&#x4fe1;&#x606f;&#xff0c;&#x8bf7;&#x53c2;&#x9605; &#x8def;&#x7531;&#x6307;&#x5357;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"749,758"}}],"payload":{"tag":"h2","lines":"720,721"}},{"content":"app.param([name], callback)&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"761,768\"><code data-lines=\"761,768\">&#x7ed9;&#x8def;&#x7531;&#x53c2;&#x6570;&#x6dfb;&#x52a0;&#x56de;&#x8c03;&#x89e6;&#x53d1;&#x5668;&#xff0c;&#x5176;&#x4e2d;name&#x4e3a;&#x53c2;&#x6570;&#x540d;&#x79f0;&#x6216;&#x53c2;&#x6570;&#x6570;&#x7ec4;&#xff0c;callback&#x4e3a;&#x56de;&#x8c03;&#x51fd;&#x6570;&#x3002;&#x56de;&#x8c03;&#x51fd;&#x6570;&#x7684;&#x53c2;&#x6570;&#x4f9d;&#x6b21;&#x662f;&#x8bf7;&#x6c42;&#x5bf9;&#x8c61;&#x3001;&#x54cd;&#x5e94;&#x5bf9;&#x8c61;&#x3001;&#x4e0b;&#x4e00;&#x4e2a;&#x4e2d;&#x95f4;&#x4ef6;&#x3001;&#x53c2;&#x6570;&#x7684;&#x503c;&#x548c;&#x53c2;&#x6570;&#x7684;&#x540d;&#x79f0;&#x3002;\n\n&#x5982;&#x679c; name &#x662f;&#x4e00;&#x4e2a;&#x6570;&#x7ec4;&#xff0c;&#x5219;&#x4e3a;&#x5176;&#x4e2d;&#x58f0;&#x660e;&#x7684;&#x6bcf;&#x4e2a;&#x53c2;&#x6570;&#x6ce8;&#x518c; callback &#x89e6;&#x53d1;&#x5668;&#xff0c;&#x6309;&#x7167;&#x5b83;&#x4eec;&#x7684;&#x58f0;&#x660e;&#x987a;&#x5e8f;&#x3002;&#x6b64;&#x5916;&#xff0c;&#x5bf9;&#x4e8e;&#x9664;&#x6700;&#x540e;&#x4e00;&#x4e2a;&#x4e4b;&#x5916;&#x7684;&#x6bcf;&#x4e2a;&#x58f0;&#x660e;&#x7684;&#x53c2;&#x6570;&#xff0c;&#x5728;&#x56de;&#x8c03;&#x4e2d;&#x8c03;&#x7528; next &#x5c06;&#x4e3a;&#x4e0b;&#x4e00;&#x4e2a;&#x58f0;&#x660e;&#x7684;&#x53c2;&#x6570;&#x8c03;&#x7528;&#x56de;&#x8c03;&#x3002;&#x5bf9;&#x4e8e;&#x6700;&#x540e;&#x4e00;&#x4e2a;&#x53c2;&#x6570;&#xff0c;&#x5bf9; next &#x7684;&#x8c03;&#x7528;&#x5c06;&#x8c03;&#x7528;&#x5f53;&#x524d;&#x6b63;&#x5728;&#x5904;&#x7406;&#x7684;&#x8def;&#x7531;&#x7684;&#x4e0b;&#x4e00;&#x4e2a;&#x4e2d;&#x95f4;&#x4ef6;&#xff0c;&#x5c31;&#x50cf; name &#x53ea;&#x662f;&#x4e00;&#x4e2a;&#x5b57;&#x7b26;&#x4e32;&#x4e00;&#x6837;&#x3002;\n\n&#x4f8b;&#x5982;&#xff0c;&#x5f53; :<span class=\"hljs-keyword\">user</span> <span class=\"hljs-title\">&#x51fa;&#x73b0;&#x5728;&#x8def;&#x7531;&#x8def;&#x5f84;&#x4e2d;&#x65f6;&#xff0c;&#x60a8;&#x53ef;&#x4ee5;&#x6620;&#x5c04;&#x7528;&#x6237;&#x52a0;&#x8f7d;&#x903b;&#x8f91;&#x4ee5;&#x81ea;&#x52a8;&#x5c06; req</span>.<span class=\"hljs-keyword\">user</span> <span class=\"hljs-title\">&#x63d0;&#x4f9b;&#x7ed9;&#x8def;&#x7531;&#xff0c;&#x6216;&#x5bf9;&#x53c2;&#x6570;&#x8f93;&#x5165;&#x6267;&#x884c;&#x9a8c;&#x8bc1;&#x3002;\n</span></code></pre>","children":[],"payload":{"tag":"pre","lines":"761,768"}},{"content":"<pre data-lines=\"769,784\"><code class=\"language-js\">app.<span class=\"hljs-title function_\">param</span>(<span class=\"hljs-string\">&apos;user&apos;</span>, <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res, next, id</span>) {\n  <span class=\"hljs-comment\">// try to get the user details from the User model and attach it to the request object</span>\n  <span class=\"hljs-title class_\">User</span>.<span class=\"hljs-title function_\">find</span>(id, <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">err, user</span>) {\n    <span class=\"hljs-keyword\">if</span> (err) {\n      <span class=\"hljs-title function_\">next</span>(err)\n    } <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span> (user) {\n      req.<span class=\"hljs-property\">user</span> = user\n      <span class=\"hljs-title function_\">next</span>()\n    } <span class=\"hljs-keyword\">else</span> {\n      <span class=\"hljs-title function_\">next</span>(<span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Error</span>(<span class=\"hljs-string\">&apos;failed to load user&apos;</span>))\n    }\n  })\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"769,784"}},{"content":"<pre data-lines=\"784,789\"><code data-lines=\"784,789\">&#x53c2;&#x6570;&#x56de;&#x8c03;&#x51fd;&#x6570;&#x5728;&#x5b9a;&#x4e49;&#x5b83;&#x4eec;&#x7684;&#x8def;&#x7531;&#x4e0a;&#x662f;&#x672c;&#x5730;&#x7684;&#x3002;&#x5b83;&#x4eec;&#x4e0d;&#x4f1a;&#x88ab;&#x5b89;&#x88c5;&#x7684;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x6216;&#x8def;&#x7531;&#x7ee7;&#x627f;&#x3002;&#x56e0;&#x6b64;&#xff0c;&#x5728; <span class=\"hljs-keyword\">app</span> &#x4e0a;&#x5b9a;&#x4e49;&#x7684;&#x53c2;&#x6570;&#x56de;&#x8c03;&#x5c06;&#x4ec5;&#x7531;&#x5728; <span class=\"hljs-keyword\">app</span> &#x8def;&#x7531;&#x4e0a;&#x5b9a;&#x4e49;&#x7684;&#x8def;&#x7531;&#x53c2;&#x6570;&#x89e6;&#x53d1;&#x3002;\n\n&#x6240;&#x6709;&#x53c2;&#x6570;&#x56de;&#x8c03;&#x5c06;&#x5728;&#x53c2;&#x6570;&#x51fa;&#x73b0;&#x7684;&#x4efb;&#x4f55;&#x8def;&#x7531;&#x7684;&#x4efb;&#x4f55;&#x5904;&#x7406;&#x7a0b;&#x5e8f;&#x4e4b;&#x524d;&#x8c03;&#x7528;&#xff0c;&#x5e76;&#x4e14;&#x5b83;&#x4eec;&#x5728;&#x8bf7;&#x6c42;-&#x54cd;&#x5e94;&#x5468;&#x671f;&#x4e2d;&#x4ec5;&#x88ab;&#x8c03;&#x7528;&#x4e00;&#x6b21;&#xff0c;&#x5373;&#x4f7f;&#x53c2;&#x6570;&#x5728;&#x591a;&#x4e2a;&#x8def;&#x7531;&#x4e2d;&#x5339;&#x914d;&#xff0c;&#x5982;&#x4e0b;&#x4f8b;&#x6240;&#x793a;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"784,789"}},{"content":"<pre data-lines=\"789,805\"><code class=\"language-js\">app.<span class=\"hljs-title function_\">param</span>(<span class=\"hljs-string\">&apos;id&apos;</span>, <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res, next, id</span>) {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;CALLED ONLY ONCE&apos;</span>)\n  <span class=\"hljs-title function_\">next</span>()\n})\n\napp.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;/user/:id&apos;</span>, <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res, next</span>) {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;although this matches&apos;</span>)\n  <span class=\"hljs-title function_\">next</span>()\n})\n\napp.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;/user/:id&apos;</span>, <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res</span>) {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;and this matches too&apos;</span>)\n  res.<span class=\"hljs-title function_\">end</span>()\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"789,805"}},{"content":"<pre data-lines=\"806,811\"><code data-lines=\"806,811\">CALLED ONLY ONCE\nalthough <span class=\"hljs-keyword\">this</span> matches\nand <span class=\"hljs-keyword\">this</span> matches too\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"806,811"}},{"content":"<pre data-lines=\"811,827\"><code class=\"language-js\">app.<span class=\"hljs-title function_\">param</span>([<span class=\"hljs-string\">&apos;id&apos;</span>, <span class=\"hljs-string\">&apos;page&apos;</span>], <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res, next, value</span>) {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;CALLED ONLY ONCE with&apos;</span>, value)\n  <span class=\"hljs-title function_\">next</span>()\n})\n\napp.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;/user/:id/:page&apos;</span>, <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res, next</span>) {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;although this matches&apos;</span>)\n  <span class=\"hljs-title function_\">next</span>()\n})\n\napp.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;/user/:id/:page&apos;</span>, <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res</span>) {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;and this matches too&apos;</span>)\n  res.<span class=\"hljs-title function_\">end</span>()\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"811,827"}},{"content":"<pre data-lines=\"828,829\"><code>&#x5728; GET /user/42/3 &#x4e0a;&#xff0c;&#x6253;&#x5370;&#x4ee5;&#x4e0b;&#x5185;&#x5bb9;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"828,829"}},{"content":"<pre data-lines=\"830,836\"><code data-lines=\"830,836\"><span class=\"hljs-keyword\">CALLED</span> <span class=\"hljs-keyword\">ONLY</span> ONCE <span class=\"hljs-keyword\">with</span> <span class=\"hljs-number\">42</span>\n<span class=\"hljs-keyword\">CALLED</span> <span class=\"hljs-keyword\">ONLY</span> ONCE <span class=\"hljs-keyword\">with</span> <span class=\"hljs-number\">3</span>\nalthough this <span class=\"hljs-keyword\">matches</span>\n<span class=\"hljs-keyword\">and</span> this <span class=\"hljs-keyword\">matches</span> too\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"830,836"}},{"content":"<pre data-lines=\"837,848\"><code data-lines=\"837,848\">&#x4ee5;&#x4e0b;&#x90e8;&#x5206;&#x63cf;&#x8ff0;&#x4e86; app.<span class=\"hljs-built_in\">param</span>(callback)&#xff0c;&#x81ea; v4<span class=\"hljs-number\">.11</span><span class=\"hljs-number\">.0</span> &#x8d77;&#x5df2;&#x5f03;&#x7528;&#x3002;\n\napp.<span class=\"hljs-built_in\">param</span>(name, callback) &#x65b9;&#x6cd5;&#x7684;&#x884c;&#x4e3a;&#x53ef;&#x4ee5;&#x901a;&#x8fc7;&#x53ea;&#x5411; app.<span class=\"hljs-built_in\">param</span>() &#x4f20;&#x9012;&#x4e00;&#x4e2a;&#x51fd;&#x6570;&#x6765;&#x5b8c;&#x5168;&#x6539;&#x53d8;&#x3002;&#x8fd9;&#x4e2a;&#x51fd;&#x6570;&#x662f; app.<span class=\"hljs-built_in\">param</span>(name, callback) &#x5e94;&#x8be5;&#x5982;&#x4f55;&#x8868;&#x73b0;&#x7684;&#x81ea;&#x5b9a;&#x4e49;&#x5b9e;&#x73b0;&#x2014;&#x2014;&#x5b83;&#x63a5;&#x53d7;&#x4e24;&#x4e2a;&#x53c2;&#x6570;&#x5e76;&#x4e14;&#x5fc5;&#x987b;&#x8fd4;&#x56de;&#x4e00;&#x4e2a;&#x4e2d;&#x95f4;&#x4ef6;&#x3002;\n\n&#x6b64;&#x51fd;&#x6570;&#x7684;&#x7b2c;&#x4e00;&#x4e2a;&#x53c2;&#x6570;&#x662f;&#x5e94;&#x6355;&#x83b7;&#x7684; <span class=\"hljs-built_in\">URL</span> &#x53c2;&#x6570;&#x7684;&#x540d;&#x79f0;&#xff0c;&#x7b2c;&#x4e8c;&#x4e2a;&#x53c2;&#x6570;&#x53ef;&#x4ee5;&#x662f;&#x4efb;&#x4f55;&#x53ef;&#x80fd;&#x7528;&#x4e8e;&#x8fd4;&#x56de;&#x4e2d;&#x95f4;&#x4ef6;&#x5b9e;&#x73b0;&#x7684; JavaScript &#x5bf9;&#x8c61;&#x3002;\n\n&#x51fd;&#x6570;&#x8fd4;&#x56de;&#x7684;&#x4e2d;&#x95f4;&#x4ef6;&#x51b3;&#x5b9a;&#x4e86;&#x6355;&#x83b7; <span class=\"hljs-built_in\">URL</span> &#x53c2;&#x6570;&#x65f6;&#x53d1;&#x751f;&#x7684;&#x884c;&#x4e3a;&#x3002;\n\n&#x5728;&#x6b64;&#x793a;&#x4f8b;&#x4e2d;&#xff0c;&#x5c06; app.<span class=\"hljs-built_in\">param</span>(name, callback) &#x7b7e;&#x540d;&#x4fee;&#x6539;&#x4e3a; app.<span class=\"hljs-built_in\">param</span>(name, accessId)&#x3002;app.<span class=\"hljs-built_in\">param</span>() &#x73b0;&#x5728;&#x5c06;&#x63a5;&#x53d7;&#x540d;&#x79f0;&#x548c;&#x53f7;&#x7801;&#xff0c;&#x800c;&#x4e0d;&#x662f;&#x63a5;&#x53d7;&#x540d;&#x79f0;&#x548c;&#x56de;&#x8c03;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"837,848"}},{"content":"<pre data-lines=\"849,876\"><code class=\"language-js\"><span class=\"hljs-keyword\">var</span> express = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;express&apos;</span>)\n<span class=\"hljs-keyword\">var</span> app = <span class=\"hljs-title function_\">express</span>()\n\n<span class=\"hljs-comment\">// customizing the behavior of app.param()</span>\napp.<span class=\"hljs-title function_\">param</span>(<span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">param, option</span>) {\n  <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res, next, val</span>) {\n    <span class=\"hljs-keyword\">if</span> (val === option) {\n      <span class=\"hljs-title function_\">next</span>()\n    } <span class=\"hljs-keyword\">else</span> {\n      <span class=\"hljs-title function_\">next</span>(<span class=\"hljs-string\">&apos;route&apos;</span>)\n    }\n  }\n})\n\n<span class=\"hljs-comment\">// using the customized app.param()</span>\napp.<span class=\"hljs-title function_\">param</span>(<span class=\"hljs-string\">&apos;id&apos;</span>, <span class=\"hljs-number\">1337</span>)\n\n<span class=\"hljs-comment\">// route to trigger the capture</span>\napp.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;/user/:id&apos;</span>, <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res</span>) {\n  res.<span class=\"hljs-title function_\">send</span>(<span class=\"hljs-string\">&apos;OK&apos;</span>)\n})\n\napp.<span class=\"hljs-title function_\">listen</span>(<span class=\"hljs-number\">3000</span>, <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\"></span>) {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;Ready&apos;</span>)\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"849,876"}},{"content":"<pre data-lines=\"877,878\"><code>&#x5728;&#x6b64;&#x793a;&#x4f8b;&#x4e2d;&#xff0c;app.param(name, callback) &#x7b7e;&#x540d;&#x4fdd;&#x6301;&#x4e0d;&#x53d8;&#xff0c;&#x4f46;&#x6ca1;&#x6709;&#x4f7f;&#x7528;&#x4e2d;&#x95f4;&#x4ef6;&#x56de;&#x8c03;&#xff0c;&#x800c;&#x662f;&#x5b9a;&#x4e49;&#x4e86;&#x81ea;&#x5b9a;&#x4e49;&#x6570;&#x636e;&#x7c7b;&#x578b;&#x68c0;&#x67e5;&#x51fd;&#x6570;&#x6765;&#x9a8c;&#x8bc1;&#x7528;&#x6237; ID &#x7684;&#x6570;&#x636e;&#x7c7b;&#x578b;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"877,878"}},{"content":"<pre data-lines=\"879,894\"><code class=\"language-js\">app.<span class=\"hljs-title function_\">param</span>(<span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">param, validator</span>) {\n  <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res, next, val</span>) {\n    <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-title function_\">validator</span>(val)) {\n      <span class=\"hljs-title function_\">next</span>()\n    } <span class=\"hljs-keyword\">else</span> {\n      <span class=\"hljs-title function_\">next</span>(<span class=\"hljs-string\">&apos;route&apos;</span>)\n    }\n  }\n})\n\napp.<span class=\"hljs-title function_\">param</span>(<span class=\"hljs-string\">&apos;id&apos;</span>, <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">candidate</span>) {\n  <span class=\"hljs-keyword\">return</span> !<span class=\"hljs-built_in\">isNaN</span>(<span class=\"hljs-built_in\">parseFloat</span>(candidate)) &amp;&amp; <span class=\"hljs-built_in\">isFinite</span>(candidate)\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"879,894"}},{"content":"<pre data-lines=\"894,897\"><code>&apos;.&apos; &#x5b57;&#x7b26;&#x4e0d;&#x80fd;&#x7528;&#x4e8e;&#x6355;&#x83b7;&#x6b63;&#x5219;&#x8868;&#x8fbe;&#x5f0f;&#x4e2d;&#x7684;&#x5b57;&#x7b26;&#x3002;&#x4f8b;&#x5982;&#x4f60;&#x4e0d;&#x80fd;&#x4f7f;&#x7528; &apos;/user-.+/&apos; &#x6765;&#x6355;&#x83b7; &apos;users-gami&apos;&#xff0c;&#x4f7f;&#x7528; [\\\\s\\\\S] &#x6216; [\\\\w\\\\W] &#x4ee3;&#x66ff;&#xff08;&#x5982;&#x5728; &apos;/user-[\\\\s\\\\S]+/&apos;&#x3002;\n\n&#x4f8b;&#x5b50;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"894,897"}},{"content":"<pre data-lines=\"898,908\"><code class=\"language-js\"><span class=\"hljs-comment\">// captures &apos;1-a_6&apos; but not &apos;543-azser-sder&apos;</span>\nrouter.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;/[0-9]+-[[\\\\w]]*&apos;</span>, <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res, next</span>) { <span class=\"hljs-title function_\">next</span>() })\n\n<span class=\"hljs-comment\">// captures &apos;1-a_6&apos; and &apos;543-az(ser&quot;-sder&apos; but not &apos;5-a s&apos;</span>\nrouter.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;/[0-9]+-[[\\\\S]]*&apos;</span>, <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res, next</span>) { <span class=\"hljs-title function_\">next</span>() })\n\n<span class=\"hljs-comment\">// captures all (equivalent to &apos;.*&apos;)</span>\nrouter.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;[[\\\\s\\\\S]]*&apos;</span>, <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res, next</span>) { <span class=\"hljs-title function_\">next</span>() })\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"898,908"}}],"payload":{"tag":"h2","lines":"759,760"}},{"content":"app.path()&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"911,912\"><code>&#x8fd4;&#x56de;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x7684;&#x89c4;&#x8303;&#x8def;&#x5f84;&#xff0c;&#x4e00;&#x4e2a;&#x5b57;&#x7b26;&#x4e32;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"911,912"}},{"content":"<pre data-lines=\"913,925\"><code class=\"language-js\"><span class=\"hljs-keyword\">var</span> app = <span class=\"hljs-title function_\">express</span>()\n<span class=\"hljs-keyword\">var</span> blog = <span class=\"hljs-title function_\">express</span>()\n<span class=\"hljs-keyword\">var</span> blogAdmin = <span class=\"hljs-title function_\">express</span>()\n\napp.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-string\">&apos;/blog&apos;</span>, blog)\nblog.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-string\">&apos;/admin&apos;</span>, blogAdmin)\n\n<span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">dir</span>(app.<span class=\"hljs-title function_\">path</span>()) <span class=\"hljs-comment\">// &apos;&apos;</span>\n<span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">dir</span>(blog.<span class=\"hljs-title function_\">path</span>()) <span class=\"hljs-comment\">// &apos;/blog&apos;</span>\n<span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">dir</span>(blogAdmin.<span class=\"hljs-title function_\">path</span>()) <span class=\"hljs-comment\">// &apos;/blog/admin&apos;</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"913,925"}},{"content":"<pre data-lines=\"926,927\"><code>&#x5728;&#x6302;&#x8f7d;&#x5e94;&#x7528;&#x7684;&#x590d;&#x6742;&#x60c5;&#x51b5;&#x4e0b;&#xff0c;&#x8fd9;&#x79cd;&#x65b9;&#x6cd5;&#x7684;&#x884c;&#x4e3a;&#x4f1a;&#x53d8;&#x5f97;&#x975e;&#x5e38;&#x590d;&#x6742;&#xff1a;&#x901a;&#x5e38;&#x6700;&#x597d;&#x4f7f;&#x7528; req.baseUrl &#x6765;&#x83b7;&#x53d6;&#x5e94;&#x7528;&#x7684;&#x89c4;&#x8303;&#x8def;&#x5f84;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"926,927"}}],"payload":{"tag":"h2","lines":"909,910"}},{"content":"app.post(path, callback [, callback ...])&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"930,933\"><code>&#x4f7f;&#x7528;&#x6307;&#x5b9a;&#x7684;&#x56de;&#x8c03;&#x51fd;&#x6570;&#x5c06; HTTP POST &#x8bf7;&#x6c42;&#x8def;&#x7531;&#x5230;&#x6307;&#x5b9a;&#x8def;&#x5f84;&#x3002;&#x6709;&#x5173;&#x8be6;&#x7ec6;&#x4fe1;&#x606f;&#xff0c;&#x8bf7;&#x53c2;&#x9605; &#x8def;&#x7531;&#x6307;&#x5357;&#x3002;\n\n&#x53c2;&#x6570;&#x4e2d;&#x82f1;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"930,933"}},{"content":"<pre data-lines=\"933,971\"><code data-lines=\"933,971\">&#x53c2;&#x6570;\t&#x63cf;&#x8ff0;\t&#x9ed8;&#x8ba4;\n<span class=\"hljs-built_in\">path</span>\n\n&#x8c03;&#x7528;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x7684;&#x8def;&#x5f84;&#xff1b;&#x53ef;&#x4ee5;&#x662f;&#x4ee5;&#x4e0b;&#x4efb;&#x4f55;&#x4e00;&#x79cd;&#xff1a;\n\n&#x8868;&#x793a;&#x8def;&#x5f84;&#x7684;&#x5b57;&#x7b26;&#x4e32;&#x3002;\n\n&#x8def;&#x5f84;&#x6a21;&#x5f0f;&#x3002;\n\n&#x5339;&#x914d;&#x8def;&#x5f84;&#x7684;&#x6b63;&#x5219;&#x8868;&#x8fbe;&#x5f0f;&#x6a21;&#x5f0f;&#x3002;\n\n&#x4ee5;&#x4e0a;&#x4efb;&#x4f55;&#x4e00;&#x79cd;&#x7ec4;&#x5408;&#x7684;&#x6570;&#x7ec4;&#x3002;\n\n&#x4f8b;&#x5982;&#xff0c;&#x53c2;&#x89c1; &#x8def;&#x5f84;&#x793a;&#x4f8b;&#x3002;\n\n<span class=\"hljs-string\">&apos;/&apos;</span>&#xff08;&#x6839;&#x8def;&#x5f84;&#xff09;\n\ncallback\n\n&#x56de;&#x8c03;&#x51fd;&#x6570;&#xff1b;&#x53ef;&#x4ee5;&#x662f;&#xff1a;\n\n&#x4e00;&#x4e2a;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x3002;\n\n&#x4e00;&#x7cfb;&#x5217;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#xff08;&#x4ee5;&#x9017;&#x53f7;&#x5206;&#x9694;&#xff09;&#x3002;\n\n&#x4e00;&#x7ec4;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x3002;\n\n&#x4ee5;&#x4e0a;&#x6240;&#x6709;&#x7684;&#x7ec4;&#x5408;&#x3002;\n\n&#x60a8;&#x53ef;&#x4ee5;&#x63d0;&#x4f9b;&#x591a;&#x4e2a;&#x56de;&#x8c03;&#x51fd;&#x6570;&#xff0c;&#x5176;&#x884c;&#x4e3a;&#x7c7b;&#x4f3c;&#x4e8e;&#x4e2d;&#x95f4;&#x4ef6;&#xff0c;&#x53ea;&#x662f;&#x8fd9;&#x4e9b;&#x56de;&#x8c03;&#x53ef;&#x4ee5;&#x8c03;&#x7528; <span class=\"hljs-built_in\">next</span>(<span class=\"hljs-string\">&apos;route&apos;</span>) &#x4ee5;&#x7ed5;&#x8fc7;&#x5269;&#x4f59;&#x7684;&#x8def;&#x7531;&#x56de;&#x8c03;&#x3002;&#x60a8;&#x53ef;&#x4ee5;&#x4f7f;&#x7528;&#x6b64;&#x673a;&#x5236;&#x5bf9;&#x8def;&#x7531;&#x65bd;&#x52a0;&#x5148;&#x51b3;&#x6761;&#x4ef6;&#xff0c;&#x7136;&#x540e;&#x5982;&#x679c;&#x6ca1;&#x6709;&#x7406;&#x7531;&#x7ee7;&#x7eed;&#x5f53;&#x524d;&#x8def;&#x7531;&#xff0c;&#x5219;&#x5c06;&#x63a7;&#x5236;&#x6743;&#x4f20;&#x9012;&#x7ed9;&#x540e;&#x7eed;&#x8def;&#x7531;&#x3002;\n\n&#x7531;&#x4e8e; router &#x548c; app &#x5b9e;&#x73b0;&#x4e86;&#x4e2d;&#x95f4;&#x4ef6;&#x63a5;&#x53e3;&#xff0c;&#x60a8;&#x53ef;&#x4ee5;&#x50cf;&#x4f7f;&#x7528;&#x4efb;&#x4f55;&#x5176;&#x4ed6;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x4e00;&#x6837;&#x4f7f;&#x7528;&#x5b83;&#x4eec;&#x3002;\n\n&#x4f8b;&#x5982;&#xff0c;&#x53c2;&#x89c1; &#x4e2d;&#x95f4;&#x4ef6;&#x56de;&#x8c03;&#x51fd;&#x6570;&#x793a;&#x4f8b;&#x3002;\n\n&#x65e0;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"933,971"}},{"content":"<pre data-lines=\"973,978\"><code class=\"language-js\">app.<span class=\"hljs-title function_\">post</span>(<span class=\"hljs-string\">&apos;/&apos;</span>, <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res</span>) {\n  res.<span class=\"hljs-title function_\">send</span>(<span class=\"hljs-string\">&apos;POST request to homepage&apos;</span>)\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"973,978"}}],"payload":{"tag":"h2","lines":"928,929"}},{"content":"app.put(path, callback [, callback ...])&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"981,982\"><code>&#x4f7f;&#x7528;&#x6307;&#x5b9a;&#x7684;&#x56de;&#x8c03;&#x51fd;&#x6570;&#x5c06; HTTP PUT &#x8bf7;&#x6c42;&#x8def;&#x7531;&#x5230;&#x6307;&#x5b9a;&#x8def;&#x5f84;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"981,982"}},{"content":"<pre data-lines=\"983,1022\"><code data-lines=\"983,1022\"> &#x53c2;&#x6570;&#x4e2d;&#x82f1;\n&#x53c2;&#x6570;\t&#x63cf;&#x8ff0;\t&#x9ed8;&#x8ba4;\n<span class=\"hljs-built_in\">path</span>\n\n&#x8c03;&#x7528;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x7684;&#x8def;&#x5f84;&#xff1b;&#x53ef;&#x4ee5;&#x662f;&#x4ee5;&#x4e0b;&#x4efb;&#x4f55;&#x4e00;&#x79cd;&#xff1a;\n\n&#x8868;&#x793a;&#x8def;&#x5f84;&#x7684;&#x5b57;&#x7b26;&#x4e32;&#x3002;\n\n&#x8def;&#x5f84;&#x6a21;&#x5f0f;&#x3002;\n\n&#x5339;&#x914d;&#x8def;&#x5f84;&#x7684;&#x6b63;&#x5219;&#x8868;&#x8fbe;&#x5f0f;&#x6a21;&#x5f0f;&#x3002;\n\n&#x4ee5;&#x4e0a;&#x4efb;&#x4f55;&#x4e00;&#x79cd;&#x7ec4;&#x5408;&#x7684;&#x6570;&#x7ec4;&#x3002;\n\n&#x4f8b;&#x5982;&#xff0c;&#x53c2;&#x89c1; &#x8def;&#x5f84;&#x793a;&#x4f8b;&#x3002;\n\n<span class=\"hljs-string\">&apos;/&apos;</span>&#xff08;&#x6839;&#x8def;&#x5f84;&#xff09;\n\ncallback\n\n&#x56de;&#x8c03;&#x51fd;&#x6570;&#xff1b;&#x53ef;&#x4ee5;&#x662f;&#xff1a;\n\n&#x4e00;&#x4e2a;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x3002;\n\n&#x4e00;&#x7cfb;&#x5217;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#xff08;&#x4ee5;&#x9017;&#x53f7;&#x5206;&#x9694;&#xff09;&#x3002;\n\n&#x4e00;&#x7ec4;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x3002;\n\n&#x4ee5;&#x4e0a;&#x6240;&#x6709;&#x7684;&#x7ec4;&#x5408;&#x3002;\n\n&#x60a8;&#x53ef;&#x4ee5;&#x63d0;&#x4f9b;&#x591a;&#x4e2a;&#x56de;&#x8c03;&#x51fd;&#x6570;&#xff0c;&#x5176;&#x884c;&#x4e3a;&#x7c7b;&#x4f3c;&#x4e8e;&#x4e2d;&#x95f4;&#x4ef6;&#xff0c;&#x53ea;&#x662f;&#x8fd9;&#x4e9b;&#x56de;&#x8c03;&#x53ef;&#x4ee5;&#x8c03;&#x7528; <span class=\"hljs-built_in\">next</span>(<span class=\"hljs-string\">&apos;route&apos;</span>) &#x4ee5;&#x7ed5;&#x8fc7;&#x5269;&#x4f59;&#x7684;&#x8def;&#x7531;&#x56de;&#x8c03;&#x3002;&#x60a8;&#x53ef;&#x4ee5;&#x4f7f;&#x7528;&#x6b64;&#x673a;&#x5236;&#x5bf9;&#x8def;&#x7531;&#x65bd;&#x52a0;&#x5148;&#x51b3;&#x6761;&#x4ef6;&#xff0c;&#x7136;&#x540e;&#x5982;&#x679c;&#x6ca1;&#x6709;&#x7406;&#x7531;&#x7ee7;&#x7eed;&#x5f53;&#x524d;&#x8def;&#x7531;&#xff0c;&#x5219;&#x5c06;&#x63a7;&#x5236;&#x6743;&#x4f20;&#x9012;&#x7ed9;&#x540e;&#x7eed;&#x8def;&#x7531;&#x3002;\n\n&#x7531;&#x4e8e; router &#x548c; app &#x5b9e;&#x73b0;&#x4e86;&#x4e2d;&#x95f4;&#x4ef6;&#x63a5;&#x53e3;&#xff0c;&#x60a8;&#x53ef;&#x4ee5;&#x50cf;&#x4f7f;&#x7528;&#x4efb;&#x4f55;&#x5176;&#x4ed6;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x4e00;&#x6837;&#x4f7f;&#x7528;&#x5b83;&#x4eec;&#x3002;\n\n&#x4f8b;&#x5982;&#xff0c;&#x53c2;&#x89c1; &#x4e2d;&#x95f4;&#x4ef6;&#x56de;&#x8c03;&#x51fd;&#x6570;&#x793a;&#x4f8b;&#x3002;\n\n&#x65e0;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"983,1022"}},{"content":"<pre data-lines=\"1024,1029\"><code class=\"language-js\">app.<span class=\"hljs-title function_\">put</span>(<span class=\"hljs-string\">&apos;/&apos;</span>, <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res</span>) {\n  res.<span class=\"hljs-title function_\">send</span>(<span class=\"hljs-string\">&apos;PUT request to homepage&apos;</span>)\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1024,1029"}}],"payload":{"tag":"h2","lines":"979,980"}},{"content":"app.render(view, [locals], callback)&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"1031,1038\"><code data-lines=\"1031,1038\">&#x901a;&#x8fc7; callback &#x51fd;&#x6570;&#x8fd4;&#x56de;&#x89c6;&#x56fe;&#x7684;&#x5448;&#x73b0; HTML&#x3002;&#x5b83;&#x63a5;&#x53d7;&#x4e00;&#x4e2a;&#x53ef;&#x9009;&#x53c2;&#x6570;&#xff0c;&#x8be5;&#x53c2;&#x6570;&#x662f;&#x4e00;&#x4e2a;&#x5305;&#x542b;&#x89c6;&#x56fe;&#x5c40;&#x90e8;&#x53d8;&#x91cf;&#x7684;&#x5bf9;&#x8c61;&#x3002;&#x5b83;&#x548c; res.<span class=\"hljs-built_in\">render</span>() &#x4e00;&#x6837;&#xff0c;&#x53ea;&#x662f;&#x5b83;&#x4e0d;&#x80fd;&#x81ea;&#x5df1;&#x5c06;&#x6e32;&#x67d3;&#x89c6;&#x56fe;&#x53d1;&#x9001;&#x7ed9;&#x5ba2;&#x6237;&#x7aef;&#x3002;\n\n&#x5c06; app.<span class=\"hljs-built_in\">render</span>() &#x89c6;&#x4e3a;&#x751f;&#x6210;&#x6e32;&#x67d3;&#x89c6;&#x56fe;&#x5b57;&#x7b26;&#x4e32;&#x7684;&#x5b9e;&#x7528;&#x51fd;&#x6570;&#x3002;res.<span class=\"hljs-built_in\">render</span>() &#x5728;&#x5185;&#x90e8;&#x4f7f;&#x7528; app.<span class=\"hljs-built_in\">render</span>() &#x6765;&#x6e32;&#x67d3;&#x89c6;&#x56fe;&#x3002;\n\n&#x5c40;&#x90e8;&#x53d8;&#x91cf; cache &#x4fdd;&#x7559;&#x7528;&#x4e8e;&#x542f;&#x7528;&#x89c6;&#x56fe;&#x7f13;&#x5b58;&#x3002;&#x8bbe;&#x7f6e;&#x4e3a;<span class=\"hljs-literal\">true</span>&#xff0c;&#x5982;&#x679c;&#x4f60;&#x60f3;&#x5728;&#x5f00;&#x53d1;&#x8fc7;&#x7a0b;&#x4e2d;&#x7f13;&#x5b58;&#x89c6;&#x56fe;&#xff1b;&#x9ed8;&#x8ba4;&#x60c5;&#x51b5;&#x4e0b;&#xff0c;&#x89c6;&#x56fe;&#x7f13;&#x5b58;&#x5728;&#x751f;&#x4ea7;&#x4e2d;&#x542f;&#x7528;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1031,1038"}},{"content":"<pre data-lines=\"1038,1047\"><code class=\"language-js\">app.<span class=\"hljs-title function_\">render</span>(<span class=\"hljs-string\">&apos;email&apos;</span>, <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">err, html</span>) {\n  <span class=\"hljs-comment\">// ...</span>\n})\n\napp.<span class=\"hljs-title function_\">render</span>(<span class=\"hljs-string\">&apos;email&apos;</span>, { <span class=\"hljs-attr\">name</span>: <span class=\"hljs-string\">&apos;Tobi&apos;</span> }, <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">err, html</span>) {\n  <span class=\"hljs-comment\">// ...</span>\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1038,1047"}}],"payload":{"tag":"h2","lines":"1029,1030"}},{"content":"app.route(path)&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"1050,1051\"><code>&#x8fd4;&#x56de;&#x5355;&#x4e2a;&#x8def;&#x7531;&#x7684;&#x5b9e;&#x4f8b;&#xff0c;&#x7136;&#x540e;&#x60a8;&#x53ef;&#x4ee5;&#x4f7f;&#x7528;&#x5b83;&#x6765;&#x5904;&#x7406;&#x5e26;&#x6709;&#x53ef;&#x9009;&#x4e2d;&#x95f4;&#x4ef6;&#x7684; HTTP &#x52a8;&#x8bcd;&#x3002;&#x4f7f;&#x7528; app.route() &#x6765;&#x907f;&#x514d;&#x91cd;&#x590d;&#x7684;&#x8def;&#x7531;&#x540d;&#x79f0;&#xff08;&#x4ece;&#x800c;&#x907f;&#x514d;&#x62fc;&#x5199;&#x9519;&#x8bef;&#xff09;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1050,1051"}},{"content":"<pre data-lines=\"1052,1067\"><code class=\"language-js\"><span class=\"hljs-keyword\">var</span> app = <span class=\"hljs-title function_\">express</span>()\n\napp.<span class=\"hljs-title function_\">route</span>(<span class=\"hljs-string\">&apos;/events&apos;</span>)\n  .<span class=\"hljs-title function_\">all</span>(<span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res, next</span>) {\n    <span class=\"hljs-comment\">// runs for all HTTP verbs first</span>\n    <span class=\"hljs-comment\">// think of it as route specific middleware!</span>\n  })\n  .<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res, next</span>) {\n    res.<span class=\"hljs-title function_\">json</span>({})\n  })\n  .<span class=\"hljs-title function_\">post</span>(<span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res, next</span>) {\n    <span class=\"hljs-comment\">// maybe add a new event...</span>\n  })\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1052,1067"}}],"payload":{"tag":"h2","lines":"1048,1049"}},{"content":"app.set(name, value)&#x4e2d;&#x82f1;","children":[{"content":"trust proxy &#x8bbe;&#x7f6e;&#x9009;&#x9879;&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"1242,1243\"><code>&#x9605;&#x8bfb; &#x4ee3;&#x7406;&#x80cc;&#x540e;&#x7684; Express &#x4e86;&#x89e3;&#x66f4;&#x591a;&#x4fe1;&#x606f;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1242,1243"}},{"content":"<pre data-lines=\"1244,1290\"><code data-lines=\"1244,1290\">&#x7c7b;&#x578b;\t&#x503c;\n&#x5e03;&#x5c14;&#x503c;\n\n&#x5982;&#x679c;&#x662f; <span class=\"hljs-keyword\">true</span>&#xff0c;&#x5219;&#x5ba2;&#x6237;&#x7aef;&#x7684; IP &#x5730;&#x5740;&#x88ab;&#x7406;&#x89e3;&#x4e3a; X-Forwarded-* &#x6807;&#x5934;&#x4e2d;&#x6700;&#x5de6;&#x8fb9;&#x7684;&#x6761;&#x76ee;&#x3002;\n\n&#x5982;&#x679c;&#x662f;<span class=\"hljs-keyword\">false</span>&#xff0c;&#x5219;&#x5e94;&#x7528;&#x7406;&#x89e3;&#x4e3a;&#x76f4;&#x63a5;&#x9762;&#x5411;&#x4e92;&#x8054;&#x7f51;&#xff0c;&#x5ba2;&#x6237;&#x7aef;&#x7684;IP&#x5730;&#x5740;&#x6765;&#x6e90;&#x4e8e;req.<span class=\"hljs-keyword\">connection</span>.remoteAddress&#x3002;&#x8fd9;&#x662f;&#x9ed8;&#x8ba4;&#x8bbe;&#x7f6e;&#x3002;\n\n&#x5b57;&#x7b26;&#x4e32;\n&#x5305;&#x542b;&#x9017;&#x53f7;&#x5206;&#x9694;&#x503c;&#x7684;&#x5b57;&#x7b26;&#x4e32;\n&#x5b57;&#x7b26;&#x4e32;&#x6570;&#x7ec4;\n\n&#x8981;&#x4fe1;&#x4efb;&#x7684; IP &#x5730;&#x5740;&#x3001;&#x5b50;&#x7f51;&#x6216; IP &#x5730;&#x5740;&#x6570;&#x7ec4;&#x548c;&#x5b50;&#x7f51;&#x3002;&#x9884;&#x914d;&#x7f6e;&#x7684;&#x5b50;&#x7f51;&#x540d;&#x79f0;&#x4e3a;&#xff1a;\n\nloopback - <span class=\"hljs-number\">127.0</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.1</span>/<span class=\"hljs-number\">8</span>&#xff0c;::<span class=\"hljs-number\">1</span>/<span class=\"hljs-number\">128</span>\nlinklocal - <span class=\"hljs-number\">169.254</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.0</span>/<span class=\"hljs-number\">16</span>&#xff0c;fe80::/<span class=\"hljs-number\">10</span>\nuniquelocal - <span class=\"hljs-number\">10.0</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.0</span>/<span class=\"hljs-number\">8</span>&#x3001;<span class=\"hljs-number\">172.16</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.0</span>/<span class=\"hljs-number\">12</span>&#x3001;<span class=\"hljs-number\">192.168</span><span class=\"hljs-number\">.0</span><span class=\"hljs-number\">.0</span>/<span class=\"hljs-number\">16</span>&#x3001;fc00::/<span class=\"hljs-number\">7</span>\n&#x901a;&#x8fc7;&#x4ee5;&#x4e0b;&#x4efb;&#x4e00;&#x65b9;&#x5f0f;&#x8bbe;&#x7f6e; IP &#x5730;&#x5740;&#xff1a;\n\n&#x6307;&#x5b9a;&#x5355;&#x4e2a;&#x5b50;&#x7f51;&#xff1a;\n\napp.<span class=\"hljs-keyword\">set</span>(<span class=\"hljs-string\">&apos;trust proxy&apos;</span>, <span class=\"hljs-string\">&apos;loopback&apos;</span>)\n&#x6307;&#x5b9a;&#x5b50;&#x7f51;&#x548c;&#x5730;&#x5740;&#xff1a;\n\napp.<span class=\"hljs-keyword\">set</span>(<span class=\"hljs-string\">&apos;trust proxy&apos;</span>, <span class=\"hljs-string\">&apos;loopback, 123.123.123.123&apos;</span>)\n&#x5c06;&#x591a;&#x4e2a;&#x5b50;&#x7f51;&#x6307;&#x5b9a;&#x4e3a; CSV&#xff1a;\n\napp.<span class=\"hljs-keyword\">set</span>(<span class=\"hljs-string\">&apos;trust proxy&apos;</span>, <span class=\"hljs-string\">&apos;loopback, linklocal, uniquelocal&apos;</span>)\n&#x5c06;&#x591a;&#x4e2a;&#x5b50;&#x7f51;&#x6307;&#x5b9a;&#x4e3a;&#x6570;&#x7ec4;&#xff1a;\n\napp.<span class=\"hljs-keyword\">set</span>(<span class=\"hljs-string\">&apos;trust proxy&apos;</span>, [<span class=\"hljs-string\">&apos;loopback&apos;</span>, <span class=\"hljs-string\">&apos;linklocal&apos;</span>, <span class=\"hljs-string\">&apos;uniquelocal&apos;</span>])\n&#x6307;&#x5b9a;&#x65f6;&#xff0c;IP &#x5730;&#x5740;&#x6216;&#x5b50;&#x7f51;&#x5c06;&#x88ab;&#x6392;&#x9664;&#x5728;&#x5730;&#x5740;&#x786e;&#x5b9a;&#x8fc7;&#x7a0b;&#x4e4b;&#x5916;&#xff0c;&#x5e76;&#x5c06;&#x79bb;&#x5e94;&#x7528;&#x670d;&#x52a1;&#x5668;&#x6700;&#x8fd1;&#x7684;&#x4e0d;&#x53d7;&#x4fe1;&#x4efb;&#x7684; IP &#x5730;&#x5740;&#x786e;&#x5b9a;&#x4e3a;&#x5ba2;&#x6237;&#x7aef;&#x7684; IP &#x5730;&#x5740;&#x3002;\n\n&#x6570;&#x5b57;\n\n&#x4fe1;&#x4efb;&#x6765;&#x81ea;&#x524d;&#x7aef;&#x4ee3;&#x7406;&#x670d;&#x52a1;&#x5668;&#x7684; nth &#x8dc3;&#x70b9;&#x4f5c;&#x4e3a;&#x5ba2;&#x6237;&#x7aef;&#x3002;\n\n&#x51fd;&#x6570;\n\n&#x81ea;&#x5b9a;&#x4e49;&#x4fe1;&#x4efb;&#x5b9e;&#x73b0;&#x3002;&#x4ec5;&#x5f53;&#x60a8;&#x77e5;&#x9053;&#x81ea;&#x5df1;&#x5728;&#x505a;&#x4ec0;&#x4e48;&#x65f6;&#x624d;&#x4f7f;&#x7528;&#x5b83;&#x3002;\n\napp.<span class=\"hljs-keyword\">set</span>(<span class=\"hljs-string\">&apos;trust proxy&apos;</span>, <span class=\"hljs-keyword\">function</span> (ip) {\n  <span class=\"hljs-keyword\">if</span> (ip === <span class=\"hljs-string\">&apos;127.0.0.1&apos;</span> || ip === <span class=\"hljs-string\">&apos;123.123.123.123&apos;</span>) <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">true</span> // <span class=\"hljs-keyword\">trusted</span> IPs\n  <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">false</span>\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1244,1290"}}],"payload":{"tag":"h3","lines":"1240,1241"}},{"content":"etag &#x8bbe;&#x7f6e;&#x9009;&#x9879;&#x4e2d;&#x82f1;","children":[{"content":"<pre data-lines=\"1292,1295\"><code>&#x6ce8;&#x610f;&#xff1a;&#x8fd9;&#x4e9b;&#x8bbe;&#x7f6e;&#x4ec5;&#x9002;&#x7528;&#x4e8e;&#x52a8;&#x6001;&#x6587;&#x4ef6;&#xff0c;&#x4e0d;&#x9002;&#x7528;&#x4e8e;&#x9759;&#x6001;&#x6587;&#x4ef6;&#x3002;express.static &#x4e2d;&#x95f4;&#x4ef6;&#x4f1a;&#x5ffd;&#x7565;&#x8fd9;&#x4e9b;&#x8bbe;&#x7f6e;&#x3002;\n\nETag &#x529f;&#x80fd;&#x662f;&#x4f7f;&#x7528; etag &#x5305;&#x5b9e;&#x73b0;&#x7684;&#x3002;&#x6709;&#x5173;&#x66f4;&#x591a;&#x4fe1;&#x606f;&#xff0c;&#x8bf7;&#x53c2;&#x9605;&#x5176;&#x6587;&#x6863;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1292,1295"}},{"content":"<pre data-lines=\"1296,1316\"><code data-lines=\"1296,1316\">&#x7c7b;&#x578b;\t&#x503c;\n&#x5e03;&#x5c14;&#x503c;\n\ntrue &#x542f;&#x7528;&#x5f31; ETag&#x3002;&#x8fd9;&#x662f;&#x9ed8;&#x8ba4;&#x8bbe;&#x7f6e;&#x3002;false &#x5b8c;&#x5168;&#x7981;&#x7528; ETag&#x3002;\n\n&#x5b57;&#x7b26;&#x4e32;\n\n&#x5982;&#x679c; <span class=\"hljs-string\">&quot;strong&quot;</span>&#xff0c;&#x542f;&#x7528;&#x5f3a; ETag&#x3002;&#x5982;&#x679c; <span class=\"hljs-string\">&quot;weak&quot;</span>&#xff0c;&#x542f;&#x7528;&#x5f31; ETag&#x3002;\n\n&#x51fd;&#x6570;\n\n&#x81ea;&#x5b9a;&#x4e49; ETag &#x51fd;&#x6570;&#x5b9e;&#x73b0;&#x3002;&#x4ec5;&#x5f53;&#x60a8;&#x77e5;&#x9053;&#x81ea;&#x5df1;&#x5728;&#x505a;&#x4ec0;&#x4e48;&#x65f6;&#x624d;&#x4f7f;&#x7528;&#x5b83;&#x3002;\n\napp<span class=\"hljs-selector-class\">.set</span>(<span class=\"hljs-string\">&apos;etag&apos;</span>, function (<span class=\"hljs-selector-tag\">body</span>, encoding) {\n  return <span class=\"hljs-built_in\">generateHash</span>(<span class=\"hljs-selector-tag\">body</span>, encoding) <span class=\"hljs-comment\">// consider the function is defined</span>\n})\n app<span class=\"hljs-selector-class\">.use</span>(<span class=\"hljs-selector-attr\">[path,]</span> callback <span class=\"hljs-selector-attr\">[, callback...]</span>)&#x4e2d;&#x82f1;\n&#x5728;&#x6307;&#x5b9a;&#x8def;&#x5f84;&#x6302;&#x8f7d;&#x6307;&#x5b9a;&#x7684; &#x4e2d;&#x95f4;&#x4ef6; &#x51fd;&#x6570;&#x6216;&#x51fd;&#x6570;&#xff1a;&#x5f53;&#x8bf7;&#x6c42;&#x8def;&#x5f84;&#x7684;&#x57fa;&#x6570;&#x4e0e; <span class=\"hljs-selector-tag\">path</span> &#x5339;&#x914d;&#x65f6;&#x6267;&#x884c;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1296,1316"}},{"content":"<pre data-lines=\"1317,1318\"><code>&#x53c2;&#x6570;&#x4e2d;&#x82f1;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1317,1318"}},{"content":"<pre data-lines=\"1319,1357\"><code data-lines=\"1319,1357\">&#x53c2;&#x6570;\t&#x63cf;&#x8ff0;\t&#x9ed8;&#x8ba4;\n<span class=\"hljs-built_in\">path</span>\n\n&#x8c03;&#x7528;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x7684;&#x8def;&#x5f84;&#xff1b;&#x53ef;&#x4ee5;&#x662f;&#x4ee5;&#x4e0b;&#x4efb;&#x4f55;&#x4e00;&#x79cd;&#xff1a;\n\n&#x8868;&#x793a;&#x8def;&#x5f84;&#x7684;&#x5b57;&#x7b26;&#x4e32;&#x3002;\n\n&#x8def;&#x5f84;&#x6a21;&#x5f0f;&#x3002;\n\n&#x5339;&#x914d;&#x8def;&#x5f84;&#x7684;&#x6b63;&#x5219;&#x8868;&#x8fbe;&#x5f0f;&#x6a21;&#x5f0f;&#x3002;\n\n&#x4ee5;&#x4e0a;&#x4efb;&#x4f55;&#x4e00;&#x79cd;&#x7ec4;&#x5408;&#x7684;&#x6570;&#x7ec4;&#x3002;\n\n&#x4f8b;&#x5982;&#xff0c;&#x53c2;&#x89c1; &#x8def;&#x5f84;&#x793a;&#x4f8b;&#x3002;\n\n<span class=\"hljs-string\">&apos;/&apos;</span>&#xff08;&#x6839;&#x8def;&#x5f84;&#xff09;\n\ncallback\n\n&#x56de;&#x8c03;&#x51fd;&#x6570;&#xff1b;&#x53ef;&#x4ee5;&#x662f;&#xff1a;\n\n&#x4e00;&#x4e2a;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x3002;\n\n&#x4e00;&#x7cfb;&#x5217;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#xff08;&#x4ee5;&#x9017;&#x53f7;&#x5206;&#x9694;&#xff09;&#x3002;\n\n&#x4e00;&#x7ec4;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x3002;\n\n&#x4ee5;&#x4e0a;&#x6240;&#x6709;&#x7684;&#x7ec4;&#x5408;&#x3002;\n\n&#x60a8;&#x53ef;&#x4ee5;&#x63d0;&#x4f9b;&#x591a;&#x4e2a;&#x56de;&#x8c03;&#x51fd;&#x6570;&#xff0c;&#x5176;&#x884c;&#x4e3a;&#x7c7b;&#x4f3c;&#x4e8e;&#x4e2d;&#x95f4;&#x4ef6;&#xff0c;&#x53ea;&#x662f;&#x8fd9;&#x4e9b;&#x56de;&#x8c03;&#x53ef;&#x4ee5;&#x8c03;&#x7528; <span class=\"hljs-built_in\">next</span>(<span class=\"hljs-string\">&apos;route&apos;</span>) &#x4ee5;&#x7ed5;&#x8fc7;&#x5269;&#x4f59;&#x7684;&#x8def;&#x7531;&#x56de;&#x8c03;&#x3002;&#x60a8;&#x53ef;&#x4ee5;&#x4f7f;&#x7528;&#x6b64;&#x673a;&#x5236;&#x5bf9;&#x8def;&#x7531;&#x65bd;&#x52a0;&#x5148;&#x51b3;&#x6761;&#x4ef6;&#xff0c;&#x7136;&#x540e;&#x5982;&#x679c;&#x6ca1;&#x6709;&#x7406;&#x7531;&#x7ee7;&#x7eed;&#x5f53;&#x524d;&#x8def;&#x7531;&#xff0c;&#x5219;&#x5c06;&#x63a7;&#x5236;&#x6743;&#x4f20;&#x9012;&#x7ed9;&#x540e;&#x7eed;&#x8def;&#x7531;&#x3002;\n\n&#x7531;&#x4e8e; router &#x548c; app &#x5b9e;&#x73b0;&#x4e86;&#x4e2d;&#x95f4;&#x4ef6;&#x63a5;&#x53e3;&#xff0c;&#x60a8;&#x53ef;&#x4ee5;&#x50cf;&#x4f7f;&#x7528;&#x4efb;&#x4f55;&#x5176;&#x4ed6;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x4e00;&#x6837;&#x4f7f;&#x7528;&#x5b83;&#x4eec;&#x3002;\n\n&#x4f8b;&#x5982;&#xff0c;&#x53c2;&#x89c1; &#x4e2d;&#x95f4;&#x4ef6;&#x56de;&#x8c03;&#x51fd;&#x6570;&#x793a;&#x4f8b;&#x3002;\n\n&#x65e0;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1319,1357"}},{"content":"<pre data-lines=\"1358,1362\"><code>&#x63cf;&#x8ff0;&#x4e2d;&#x82f1;\n&#x8def;&#x7531;&#x5c06;&#x5339;&#x914d;&#x7d27;&#x968f;&#x5176;&#x8def;&#x5f84;&#x7684;&#x4efb;&#x4f55;&#x8def;&#x5f84;&#xff0c;&#x5e76;&#x5e26;&#x6709; &quot;/&quot;&#x3002;&#x4f8b;&#x5982;&#xff1a;app.use(&apos;/apple&apos;, ...) &#x5c06;&#x5339;&#x914d; &quot;/apple&quot;&#x3001;&quot;/apple/images&quot;&#x3001;&quot;/apple/images/news&quot; &#x7b49;&#x3002;\n\n&#x7531;&#x4e8e; path &#x9ed8;&#x8ba4;&#x4e3a; &quot;/&quot;&#xff0c;&#x56e0;&#x6b64;&#x5bf9;&#x4e8e;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x7684;&#x6bcf;&#x4e2a;&#x8bf7;&#x6c42;&#xff0c;&#x90fd;&#x4f1a;&#x6267;&#x884c;&#x6ca1;&#x6709;&#x8def;&#x5f84;&#x6302;&#x8f7d;&#x7684;&#x4e2d;&#x95f4;&#x4ef6;&#x3002;&#x4f8b;&#x5982;&#xff0c;&#x8fd9;&#x4e2a;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x5c06;&#x4e3a;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x7684;&#x6bcf;&#x4e2a;&#x8bf7;&#x6c42;&#x6267;&#x884c;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1358,1362"}},{"content":"<pre data-lines=\"1363,1369\"><code class=\"language-js\">app.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res, next</span>) {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;Time: %d&apos;</span>, <span class=\"hljs-title class_\">Date</span>.<span class=\"hljs-title function_\">now</span>())\n  <span class=\"hljs-title function_\">next</span>()\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1363,1369"}},{"content":"<pre data-lines=\"1370,1379\"><code>&#x6ce8;&#x610f;\n\n&#x5b50;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x5c06;&#xff1a;\n\n&#x4e0d;&#x7ee7;&#x627f;&#x5177;&#x6709;&#x9ed8;&#x8ba4;&#x503c;&#x7684;&#x8bbe;&#x7f6e;&#x503c;&#x3002;&#x60a8;&#x5fc5;&#x987b;&#x5728;&#x5b50;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x4e2d;&#x8bbe;&#x7f6e;&#x8be5;&#x503c;&#x3002;\n&#x7ee7;&#x627f;&#x8bbe;&#x7f6e;&#x7684;&#x503c;&#xff0c;&#x6ca1;&#x6709;&#x9ed8;&#x8ba4;&#x503c;&#x3002;\n&#x8be6;&#x89c1; &#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x8bbe;&#x7f6e;&#x3002;\n\n&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x662f;&#x6309;&#x987a;&#x5e8f;&#x6267;&#x884c;&#x7684;&#xff0c;&#x56e0;&#x6b64;&#x4e2d;&#x95f4;&#x4ef6;&#x5305;&#x542b;&#x7684;&#x987a;&#x5e8f;&#x5f88;&#x91cd;&#x8981;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1370,1379"}},{"content":"<pre data-lines=\"1380,1391\"><code class=\"language-js\"><span class=\"hljs-comment\">// this middleware will not allow the request to go beyond it</span>\napp.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res, next</span>) {\n  res.<span class=\"hljs-title function_\">send</span>(<span class=\"hljs-string\">&apos;Hello World&apos;</span>)\n})\n\n<span class=\"hljs-comment\">// requests will never reach this route</span>\napp.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;/&apos;</span>, <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res</span>) {\n  res.<span class=\"hljs-title function_\">send</span>(<span class=\"hljs-string\">&apos;Welcome&apos;</span>)\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1380,1391"}}],"payload":{"tag":"h3","lines":"1290,1291"}}],"payload":{"tag":"h2","lines":"1068,1069"}},{"content":"&#x9519;&#x8bef;&#x5904;&#x7406;&#x4e2d;&#x95f4;&#x4ef6;","children":[{"content":"<pre data-lines=\"1394,1397\"><code>&#x9519;&#x8bef;&#x5904;&#x7406;&#x4e2d;&#x95f4;&#x4ef6;&#x603b;&#x662f;&#x9700;&#x8981;&#x56db;&#x4e2a;&#x53c2;&#x6570;&#x3002;&#x60a8;&#x5fc5;&#x987b;&#x63d0;&#x4f9b;&#x56db;&#x4e2a;&#x53c2;&#x6570;&#x4ee5;&#x5c06;&#x5176;&#x6807;&#x8bc6;&#x4e3a;&#x9519;&#x8bef;&#x5904;&#x7406;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x3002;&#x5373;&#x4f7f;&#x60a8;&#x4e0d;&#x9700;&#x8981;&#x4f7f;&#x7528; next &#x5bf9;&#x8c61;&#xff0c;&#x60a8;&#x4e5f;&#x5fc5;&#x987b;&#x6307;&#x5b9a;&#x5b83;&#x6765;&#x7ef4;&#x62a4;&#x7b7e;&#x540d;&#x3002;&#x5426;&#x5219;&#xff0c;next &#x5bf9;&#x8c61;&#x5c06;&#x88ab;&#x89e3;&#x91ca;&#x4e3a;&#x5e38;&#x89c4;&#x4e2d;&#x95f4;&#x4ef6;&#xff0c;&#x65e0;&#x6cd5;&#x5904;&#x7406;&#x9519;&#x8bef;&#x3002;&#x6709;&#x5173;&#x9519;&#x8bef;&#x5904;&#x7406;&#x4e2d;&#x95f4;&#x4ef6;&#x7684;&#x8be6;&#x7ec6;&#x4fe1;&#x606f;&#xff0c;&#x8bf7;&#x53c2;&#x89c1;&#xff1a;&#x9519;&#x8bef;&#x5904;&#x7406;&#x3002;\n\n&#x4ee5;&#x4e0e;&#x5176;&#x4ed6;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x76f8;&#x540c;&#x7684;&#x65b9;&#x5f0f;&#x5b9a;&#x4e49;&#x9519;&#x8bef;&#x5904;&#x7406;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#xff0c;&#x9664;&#x4e86;&#x4f7f;&#x7528;&#x56db;&#x4e2a;&#x53c2;&#x6570;&#x800c;&#x4e0d;&#x662f;&#x4e09;&#x4e2a;&#x53c2;&#x6570;&#xff0c;&#x7279;&#x522b;&#x662f;&#x4f7f;&#x7528;&#x7b7e;&#x540d; (err, req, res, next))&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1394,1397"}},{"content":"<pre data-lines=\"1398,1404\"><code class=\"language-js\">app.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">err, req, res, next</span>) {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">error</span>(err.<span class=\"hljs-property\">stack</span>)\n  res.<span class=\"hljs-title function_\">status</span>(<span class=\"hljs-number\">500</span>).<span class=\"hljs-title function_\">send</span>(<span class=\"hljs-string\">&apos;Something broke!&apos;</span>)\n})\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1398,1404"}},{"content":"<pre data-lines=\"1405,1407\"><code>&#x8def;&#x5f84;&#x793a;&#x4f8b;&#x4e2d;&#x82f1;\n&#x4e0b;&#x8868;&#x63d0;&#x4f9b;&#x4e86;&#x4e00;&#x4e9b;&#x7528;&#x4e8e;&#x6302;&#x8f7d;&#x4e2d;&#x95f4;&#x4ef6;&#x7684;&#x6709;&#x6548; path &#x503c;&#x7684;&#x7b80;&#x5355;&#x793a;&#x4f8b;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1405,1407"}},{"content":"<pre data-lines=\"1408,1526\"><code data-lines=\"1408,1526\">&#x7c7b;&#x578b;\t&#x4f8b;&#x5b50;\n&#x8def;&#x5f84;\n\n&#x8fd9;&#x5c06;&#x5339;&#x914d;&#x4ee5; /abcd &#x5f00;&#x5934;&#x7684;&#x8def;&#x5f84;&#xff1a;\n\napp.use(<span class=\"hljs-string\">&apos;/abcd&apos;</span>, <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-params\">(req, res, next)</span> <span class=\"hljs-comment\">{\n  next()\n}</span>)\n&#x8def;&#x5f84;&#x6a21;&#x5f0f;\n\n&#x8fd9;&#x5c06;&#x5339;&#x914d;&#x4ee5; /<span class=\"hljs-title\">abcd</span> &#x548c; /<span class=\"hljs-title\">abd</span> &#x5f00;&#x5934;&#x7684;&#x8def;&#x5f84;&#xff1a;\n\n<span class=\"hljs-title\">app</span>.<span class=\"hljs-title\">use</span><span class=\"hljs-params\">(<span class=\"hljs-string\">&apos;/abc?d&apos;</span>, <span class=\"hljs-keyword\">function</span> (req, res, next)</span> <span class=\"hljs-comment\">{\n  next()\n}</span>)\n&#x8fd9;&#x5c06;&#x5339;&#x914d;&#x4ee5; /<span class=\"hljs-title\">abcd</span>&#x3001;/<span class=\"hljs-title\">abbcd</span>&#x3001;/<span class=\"hljs-title\">abbbbbcd</span> &#x7b49;&#x5f00;&#x5934;&#x7684;&#x8def;&#x5f84;&#xff1a;\n\n<span class=\"hljs-title\">app</span>.<span class=\"hljs-title\">use</span><span class=\"hljs-params\">(<span class=\"hljs-string\">&apos;/ab+cd&apos;</span>, <span class=\"hljs-keyword\">function</span> (req, res, next)</span> <span class=\"hljs-comment\">{\n  next()\n}</span>)\n&#x8fd9;&#x5c06;&#x5339;&#x914d;&#x4ee5; /<span class=\"hljs-title\">abcd</span>&#x3001;/<span class=\"hljs-title\">abxcd</span>&#x3001;/<span class=\"hljs-title\">abFOOcd</span>&#x3001;/<span class=\"hljs-title\">abbArcd</span> &#x7b49;&#x5f00;&#x5934;&#x7684;&#x8def;&#x5f84;&#xff1a;\n\n<span class=\"hljs-title\">app</span>.<span class=\"hljs-title\">use</span><span class=\"hljs-params\">(<span class=\"hljs-string\">&apos;/ab*cd&apos;</span>, <span class=\"hljs-keyword\">function</span> (req, res, next)</span> <span class=\"hljs-comment\">{\n  next()\n}</span>)\n&#x8fd9;&#x5c06;&#x5339;&#x914d;&#x4ee5; /<span class=\"hljs-title\">ad</span> &#x548c; /<span class=\"hljs-title\">abcd</span> &#x5f00;&#x5934;&#x7684;&#x8def;&#x5f84;&#xff1a;\n\n<span class=\"hljs-title\">app</span>.<span class=\"hljs-title\">use</span><span class=\"hljs-params\">(<span class=\"hljs-string\">&apos;/a(bc)?d&apos;</span>, <span class=\"hljs-keyword\">function</span> (req, res, next)</span> <span class=\"hljs-comment\">{\n  next()\n}</span>)\n&#x6b63;&#x5219;&#x8868;&#x8fbe;&#x5f0f;\n\n&#x8fd9;&#x5c06;&#x5339;&#x914d;&#x4ee5; /<span class=\"hljs-title\">abc</span> &#x548c; /<span class=\"hljs-title\">xyz</span> &#x5f00;&#x5934;&#x7684;&#x8def;&#x5f84;&#xff1a;\n\n<span class=\"hljs-title\">app</span>.<span class=\"hljs-title\">use</span><span class=\"hljs-params\">(/\\/abc|\\/xyz/, <span class=\"hljs-keyword\">function</span> (req, res, next)</span> <span class=\"hljs-comment\">{\n  next()\n}</span>)\n&#x6570;&#x7ec4;\n\n&#x8fd9;&#x5c06;&#x5339;&#x914d;&#x4ee5; /<span class=\"hljs-title\">abcd</span>&#x3001;/<span class=\"hljs-title\">xyza</span>&#x3001;/<span class=\"hljs-title\">lmn</span> &#x548c; /<span class=\"hljs-title\">pqr</span> &#x5f00;&#x5934;&#x7684;&#x8def;&#x5f84;&#xff1a;\n\n<span class=\"hljs-title\">app</span>.<span class=\"hljs-title\">use</span><span class=\"hljs-params\">([<span class=\"hljs-string\">&apos;/abcd&apos;</span>, <span class=\"hljs-string\">&apos;/xyza&apos;</span>, /\\/lmn|\\/pqr/], <span class=\"hljs-keyword\">function</span> (req, res, next)</span> <span class=\"hljs-comment\">{\n  next()\n}</span>)\n &#x4e2d;&#x95f4;&#x4ef6;&#x56de;&#x8c03;&#x51fd;&#x6570;&#x793a;&#x4f8b;&#x4e2d;&#x82f1;\n&#x4e0b;&#x8868;&#x63d0;&#x4f9b;&#x4e86;&#x53ef;&#x7528;&#x4f5c; <span class=\"hljs-title\">app</span>.<span class=\"hljs-title\">use</span><span class=\"hljs-params\">()</span>&#x3001;<span class=\"hljs-title\">app</span>.<span class=\"hljs-title\">METHOD</span><span class=\"hljs-params\">()</span> &#x548c; <span class=\"hljs-title\">app</span>.<span class=\"hljs-title\">all</span><span class=\"hljs-params\">()</span> &#x7684; <span class=\"hljs-title\">callback</span> &#x53c2;&#x6570;&#x7684;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x7684;&#x4e00;&#x4e9b;&#x7b80;&#x5355;&#x793a;&#x4f8b;&#x3002;&#x5c3d;&#x7ba1;&#x8fd9;&#x4e9b;&#x793a;&#x4f8b;&#x9002;&#x7528;&#x4e8e; <span class=\"hljs-title\">app</span>.<span class=\"hljs-title\">use</span><span class=\"hljs-params\">()</span>&#xff0c;&#x4f46;&#x5b83;&#x4eec;&#x4e5f;&#x9002;&#x7528;&#x4e8e; <span class=\"hljs-title\">app</span>.<span class=\"hljs-title\">use</span><span class=\"hljs-params\">()</span>&#x3001;<span class=\"hljs-title\">app</span>.<span class=\"hljs-title\">METHOD</span><span class=\"hljs-params\">()</span> &#x548c; <span class=\"hljs-title\">app</span>.<span class=\"hljs-title\">all</span><span class=\"hljs-params\">()</span>&#x3002;\n\n&#x7528;&#x6cd5;\t&#x4f8b;&#x5b50;\n&#x5355;&#x4e00;&#x4e2d;&#x95f4;&#x4ef6;\n\n&#x60a8;&#x53ef;&#x4ee5;&#x5728;&#x672c;&#x5730;&#x5b9a;&#x4e49;&#x548c;&#x6302;&#x8f7d;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x3002;\n\n<span class=\"hljs-title\">app</span>.<span class=\"hljs-title\">use</span><span class=\"hljs-params\">(<span class=\"hljs-keyword\">function</span> (req, res, next)</span> <span class=\"hljs-comment\">{\n  next()\n}</span>)\n&#x8def;&#x7531;&#x662f;&#x6709;&#x6548;&#x7684;&#x4e2d;&#x95f4;&#x4ef6;&#x3002;\n\n<span class=\"hljs-title\">var</span> <span class=\"hljs-title\">router</span> = <span class=\"hljs-title\">express</span>.<span class=\"hljs-title\">Router</span><span class=\"hljs-params\">()</span>\n<span class=\"hljs-title\">router</span>.<span class=\"hljs-title\">get</span><span class=\"hljs-params\">(<span class=\"hljs-string\">&apos;/&apos;</span>, <span class=\"hljs-keyword\">function</span> (req, res, next)</span> <span class=\"hljs-comment\">{\n  next()\n}</span>)\n<span class=\"hljs-title\">app</span>.<span class=\"hljs-title\">use</span><span class=\"hljs-params\">(router)</span>\n<span class=\"hljs-title\">Express</span> &#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x662f;&#x6709;&#x6548;&#x7684;&#x4e2d;&#x95f4;&#x4ef6;&#x3002;\n\n<span class=\"hljs-title\">var</span> <span class=\"hljs-title\">subApp</span> = <span class=\"hljs-title\">express</span><span class=\"hljs-params\">()</span>\n<span class=\"hljs-title\">subApp</span>.<span class=\"hljs-title\">get</span><span class=\"hljs-params\">(<span class=\"hljs-string\">&apos;/&apos;</span>, <span class=\"hljs-keyword\">function</span> (req, res, next)</span> <span class=\"hljs-comment\">{\n  next()\n}</span>)\n<span class=\"hljs-title\">app</span>.<span class=\"hljs-title\">use</span><span class=\"hljs-params\">(subApp)</span>\n&#x7cfb;&#x5217;&#x4e2d;&#x95f4;&#x4ef6;\n\n&#x60a8;&#x53ef;&#x4ee5;&#x5728;&#x540c;&#x4e00;&#x6302;&#x8f7d;&#x8def;&#x5f84;&#x4e2d;&#x6307;&#x5b9a;&#x591a;&#x4e2a;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x3002;\n\n<span class=\"hljs-title\">var</span> <span class=\"hljs-title\">r1</span> = <span class=\"hljs-title\">express</span>.<span class=\"hljs-title\">Router</span><span class=\"hljs-params\">()</span>\n<span class=\"hljs-title\">r1</span>.<span class=\"hljs-title\">get</span><span class=\"hljs-params\">(<span class=\"hljs-string\">&apos;/&apos;</span>, <span class=\"hljs-keyword\">function</span> (req, res, next)</span> <span class=\"hljs-comment\">{\n  next()\n}</span>)\n\n<span class=\"hljs-title\">var</span> <span class=\"hljs-title\">r2</span> = <span class=\"hljs-title\">express</span>.<span class=\"hljs-title\">Router</span><span class=\"hljs-params\">()</span>\n<span class=\"hljs-title\">r2</span>.<span class=\"hljs-title\">get</span><span class=\"hljs-params\">(<span class=\"hljs-string\">&apos;/&apos;</span>, <span class=\"hljs-keyword\">function</span> (req, res, next)</span> <span class=\"hljs-comment\">{\n  next()\n}</span>)\n\n<span class=\"hljs-title\">app</span>.<span class=\"hljs-title\">use</span><span class=\"hljs-params\">(r1, r2)</span>\n&#x6570;&#x7ec4;\n\n&#x4f7f;&#x7528;&#x6570;&#x7ec4;&#x5bf9;&#x4e2d;&#x95f4;&#x4ef6;&#x8fdb;&#x884c;&#x903b;&#x8f91;&#x5206;&#x7ec4;&#x3002;\n\n<span class=\"hljs-title\">var</span> <span class=\"hljs-title\">r1</span> = <span class=\"hljs-title\">express</span>.<span class=\"hljs-title\">Router</span><span class=\"hljs-params\">()</span>\n<span class=\"hljs-title\">r1</span>.<span class=\"hljs-title\">get</span><span class=\"hljs-params\">(<span class=\"hljs-string\">&apos;/&apos;</span>, <span class=\"hljs-keyword\">function</span> (req, res, next)</span> <span class=\"hljs-comment\">{\n  next()\n}</span>)\n\n<span class=\"hljs-title\">var</span> <span class=\"hljs-title\">r2</span> = <span class=\"hljs-title\">express</span>.<span class=\"hljs-title\">Router</span><span class=\"hljs-params\">()</span>\n<span class=\"hljs-title\">r2</span>.<span class=\"hljs-title\">get</span><span class=\"hljs-params\">(<span class=\"hljs-string\">&apos;/&apos;</span>, <span class=\"hljs-keyword\">function</span> (req, res, next)</span> <span class=\"hljs-comment\">{\n  next()\n}</span>)\n\n<span class=\"hljs-title\">app</span>.<span class=\"hljs-title\">use</span><span class=\"hljs-params\">([r1, r2])</span>\n&#x7ec4;&#x5408;\n\n&#x60a8;&#x53ef;&#x4ee5;&#x7ed3;&#x5408;&#x4e0a;&#x8ff0;&#x6240;&#x6709;&#x6302;&#x8f7d;&#x4e2d;&#x95f4;&#x4ef6;&#x7684;&#x65b9;&#x5f0f;&#x3002;\n\n<span class=\"hljs-title\">function</span> <span class=\"hljs-title\">mw1</span> <span class=\"hljs-params\">(req, res, next)</span> <span class=\"hljs-comment\">{ next() }</span>\n<span class=\"hljs-title\">function</span> <span class=\"hljs-title\">mw2</span> <span class=\"hljs-params\">(req, res, next)</span> <span class=\"hljs-comment\">{ next() }</span>\n\n<span class=\"hljs-title\">var</span> <span class=\"hljs-title\">r1</span> = <span class=\"hljs-title\">express</span>.<span class=\"hljs-title\">Router</span><span class=\"hljs-params\">()</span>\n<span class=\"hljs-title\">r1</span>.<span class=\"hljs-title\">get</span><span class=\"hljs-params\">(<span class=\"hljs-string\">&apos;/&apos;</span>, <span class=\"hljs-keyword\">function</span> (req, res, next)</span> <span class=\"hljs-comment\">{ next() }</span>)\n\n<span class=\"hljs-title\">var</span> <span class=\"hljs-title\">r2</span> = <span class=\"hljs-title\">express</span>.<span class=\"hljs-title\">Router</span><span class=\"hljs-params\">()</span>\n<span class=\"hljs-title\">r2</span>.<span class=\"hljs-title\">get</span><span class=\"hljs-params\">(<span class=\"hljs-string\">&apos;/&apos;</span>, <span class=\"hljs-keyword\">function</span> (req, res, next)</span> <span class=\"hljs-comment\">{ next() }</span>)\n\n<span class=\"hljs-title\">var</span> <span class=\"hljs-title\">subApp</span> = <span class=\"hljs-title\">express</span><span class=\"hljs-params\">()</span>\n<span class=\"hljs-title\">subApp</span>.<span class=\"hljs-title\">get</span><span class=\"hljs-params\">(<span class=\"hljs-string\">&apos;/&apos;</span>, <span class=\"hljs-keyword\">function</span> (req, res, next)</span> <span class=\"hljs-comment\">{ next() }</span>)\n\n<span class=\"hljs-title\">app</span>.<span class=\"hljs-title\">use</span><span class=\"hljs-params\">(mw1, [mw2, r1, r2], subApp)</span>\n</span></code></pre>","children":[],"payload":{"tag":"pre","lines":"1408,1526"}},{"content":"<pre data-lines=\"1527,1530\"><code>&#x4ee5;&#x4e0b;&#x662f;&#x5728; Express &#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x4e2d;&#x4f7f;&#x7528; express.static &#x4e2d;&#x95f4;&#x4ef6;&#x7684;&#x4e00;&#x4e9b;&#x793a;&#x4f8b;&#x3002;\n\n&#x4ece;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x76ee;&#x5f55;&#x4e2d;&#x7684; &quot;public&quot; &#x76ee;&#x5f55;&#x4e3a;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x63d0;&#x4f9b;&#x9759;&#x6001;&#x5185;&#x5bb9;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1527,1530"}},{"content":"<pre data-lines=\"1531,1535\"><code class=\"language-js\"><span class=\"hljs-comment\">// GET /style.css etc</span>\napp.<span class=\"hljs-title function_\">use</span>(express.<span class=\"hljs-title function_\">static</span>(path.<span class=\"hljs-title function_\">join</span>(__dirname, <span class=\"hljs-string\">&apos;public&apos;</span>)))\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1531,1535"}},{"content":"<pre data-lines=\"1536,1537\"><code>&#x4ec5;&#x5f53;&#x8bf7;&#x6c42;&#x8def;&#x5f84;&#x4ee5; &quot;/static&quot; &#x4e3a;&#x524d;&#x7f00;&#x65f6;&#xff0c;&#x5c06;&#x4e2d;&#x95f4;&#x4ef6;&#x5b89;&#x88c5;&#x5728; &quot;/static&quot; &#x4ee5;&#x63d0;&#x4f9b;&#x9759;&#x6001;&#x5185;&#x5bb9;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1536,1537"}},{"content":"<pre data-lines=\"1538,1542\"><code class=\"language-js\"><span class=\"hljs-comment\">// GET /static/style.css etc.</span>\napp.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-string\">&apos;/static&apos;</span>, express.<span class=\"hljs-title function_\">static</span>(path.<span class=\"hljs-title function_\">join</span>(__dirname, <span class=\"hljs-string\">&apos;public&apos;</span>)))\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1538,1542"}},{"content":"<pre data-lines=\"1543,1544\"><code>&#x901a;&#x8fc7;&#x5728;&#x9759;&#x6001;&#x4e2d;&#x95f4;&#x4ef6;&#x4e4b;&#x540e;&#x52a0;&#x8f7d;&#x8bb0;&#x5f55;&#x5668;&#x4e2d;&#x95f4;&#x4ef6;&#x6765;&#x7981;&#x7528;&#x9759;&#x6001;&#x5185;&#x5bb9;&#x8bf7;&#x6c42;&#x7684;&#x65e5;&#x5fd7;&#x8bb0;&#x5f55;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1543,1544"}},{"content":"<pre data-lines=\"1545,1549\"><code class=\"language-js\">app.<span class=\"hljs-title function_\">use</span>(express.<span class=\"hljs-title function_\">static</span>(path.<span class=\"hljs-title function_\">join</span>(__dirname, <span class=\"hljs-string\">&apos;public&apos;</span>)))\napp.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-title function_\">logger</span>())\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1545,1549"}},{"content":"<pre data-lines=\"1550,1551\"><code>&#x63d0;&#x4f9b;&#x6765;&#x81ea;&#x591a;&#x4e2a;&#x76ee;&#x5f55;&#x7684;&#x9759;&#x6001;&#x6587;&#x4ef6;&#xff0c;&#x4f46; &quot;./public&quot; &#x4f18;&#x5148;&#x4e8e;&#x5176;&#x4ed6;&#x76ee;&#x5f55;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1550,1551"}},{"content":"<pre data-lines=\"1552,1557\"><code class=\"language-js\">app.<span class=\"hljs-title function_\">use</span>(express.<span class=\"hljs-title function_\">static</span>(path.<span class=\"hljs-title function_\">join</span>(__dirname, <span class=\"hljs-string\">&apos;public&apos;</span>)))\napp.<span class=\"hljs-title function_\">use</span>(express.<span class=\"hljs-title function_\">static</span>(path.<span class=\"hljs-title function_\">join</span>(__dirname, <span class=\"hljs-string\">&apos;files&apos;</span>)))\napp.<span class=\"hljs-title function_\">use</span>(express.<span class=\"hljs-title function_\">static</span>(path.<span class=\"hljs-title function_\">join</span>(__dirname, <span class=\"hljs-string\">&apos;uploads&apos;</span>)))\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1552,1557"}},{"content":"<pre data-lines=\"1559,1584\"><code data-lines=\"1559,1584\">app<span class=\"hljs-selector-class\">.locals</span>\napp<span class=\"hljs-selector-class\">.mountpath</span>\napp<span class=\"hljs-selector-class\">.on</span>(<span class=\"hljs-string\">&apos;mount&apos;</span>, <span class=\"hljs-built_in\">callback</span>(parent))\napp<span class=\"hljs-selector-class\">.all</span>(<span class=\"hljs-selector-tag\">path</span>, callback <span class=\"hljs-selector-attr\">[, callback ...]</span>)\napp<span class=\"hljs-selector-class\">.delete</span>(<span class=\"hljs-selector-tag\">path</span>, callback <span class=\"hljs-selector-attr\">[, callback ...]</span>)\napp<span class=\"hljs-selector-class\">.disable</span>(name)\napp<span class=\"hljs-selector-class\">.disabled</span>(name)\napp<span class=\"hljs-selector-class\">.enable</span>(name)\napp<span class=\"hljs-selector-class\">.enabled</span>(name)\napp<span class=\"hljs-selector-class\">.engine</span>(ext, callback)\napp<span class=\"hljs-selector-class\">.get</span>(name)\napp<span class=\"hljs-selector-class\">.get</span>(<span class=\"hljs-selector-tag\">path</span>, callback <span class=\"hljs-selector-attr\">[, callback ...]</span>)\napp<span class=\"hljs-selector-class\">.listen</span>(<span class=\"hljs-selector-tag\">path</span>, <span class=\"hljs-selector-attr\">[callback]</span>)\napp<span class=\"hljs-selector-class\">.listen</span>(<span class=\"hljs-selector-attr\">[port[, host[, backlog]</span>]]<span class=\"hljs-selector-attr\">[, callback]</span>)\napp<span class=\"hljs-selector-class\">.METHOD</span>(<span class=\"hljs-selector-tag\">path</span>, callback <span class=\"hljs-selector-attr\">[, callback ...]</span>)\napp<span class=\"hljs-selector-class\">.param</span>(<span class=\"hljs-selector-attr\">[name]</span>, callback)\napp<span class=\"hljs-selector-class\">.path</span>()\napp<span class=\"hljs-selector-class\">.post</span>(<span class=\"hljs-selector-tag\">path</span>, callback <span class=\"hljs-selector-attr\">[, callback ...]</span>)\napp<span class=\"hljs-selector-class\">.put</span>(<span class=\"hljs-selector-tag\">path</span>, callback <span class=\"hljs-selector-attr\">[, callback ...]</span>)\napp<span class=\"hljs-selector-class\">.render</span>(view, <span class=\"hljs-selector-attr\">[locals]</span>, callback)\napp<span class=\"hljs-selector-class\">.route</span>(path)\napp<span class=\"hljs-selector-class\">.set</span>(name, value)\napp<span class=\"hljs-selector-class\">.use</span>(<span class=\"hljs-selector-attr\">[path,]</span> callback <span class=\"hljs-selector-attr\">[, callback...]</span>)\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1559,1584"}}],"payload":{"tag":"h2","lines":"1392,1393"}}],"payload":{"tag":"h1","lines":"234,235"}},{"content":"&#x8bf7;&#x6c42;","children":[{"content":"<pre data-lines=\"1592,1623\"><code data-lines=\"1592,1623\">req<span class=\"hljs-selector-class\">.app</span>\nreq<span class=\"hljs-selector-class\">.baseUrl</span>\nreq<span class=\"hljs-selector-class\">.body</span>\nreq<span class=\"hljs-selector-class\">.cookies</span>\nreq<span class=\"hljs-selector-class\">.fresh</span>\nreq<span class=\"hljs-selector-class\">.hostname</span>\nreq<span class=\"hljs-selector-class\">.ip</span>\nreq<span class=\"hljs-selector-class\">.ips</span>\nreq<span class=\"hljs-selector-class\">.method</span>\nreq<span class=\"hljs-selector-class\">.originalUrl</span>\nreq<span class=\"hljs-selector-class\">.params</span>\nreq<span class=\"hljs-selector-class\">.path</span>\nreq<span class=\"hljs-selector-class\">.protocol</span>\nreq<span class=\"hljs-selector-class\">.query</span>\nreq<span class=\"hljs-selector-class\">.res</span>\nreq<span class=\"hljs-selector-class\">.route</span>\nreq<span class=\"hljs-selector-class\">.secure</span>\nreq<span class=\"hljs-selector-class\">.signedCookies</span>\nreq<span class=\"hljs-selector-class\">.stale</span>\nreq<span class=\"hljs-selector-class\">.subdomains</span>\nreq<span class=\"hljs-selector-class\">.xhr</span>\nreq<span class=\"hljs-selector-class\">.accepts</span>(types)\nreq<span class=\"hljs-selector-class\">.acceptsCharsets</span>(charset <span class=\"hljs-selector-attr\">[, ...]</span>)\nreq<span class=\"hljs-selector-class\">.acceptsEncodings</span>(encoding <span class=\"hljs-selector-attr\">[, ...]</span>)\nreq<span class=\"hljs-selector-class\">.acceptsLanguages</span>(lang <span class=\"hljs-selector-attr\">[, ...]</span>)\nreq<span class=\"hljs-selector-class\">.get</span>(field)\nreq<span class=\"hljs-selector-class\">.is</span>(type)\nreq<span class=\"hljs-selector-class\">.param</span>(name <span class=\"hljs-selector-attr\">[, defaultValue]</span>)\nreq<span class=\"hljs-selector-class\">.range</span>(size<span class=\"hljs-selector-attr\">[, options]</span>)\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1592,1623"}},{"content":"<pre data-lines=\"1624,1983\"><code data-lines=\"1624,1983\">req &#x5bf9;&#x8c61;&#x8868;&#x793a; HTTP &#x8bf7;&#x6c42;&#xff0c;&#x5e76;&#x5177;&#x6709;&#x8bf7;&#x6c42;&#x67e5;&#x8be2;&#x5b57;&#x7b26;&#x4e32;&#x3001;&#x53c2;&#x6570;&#x3001;&#x6b63;&#x6587;&#x3001;HTTP &#x6807;&#x5934;&#x7b49;&#x7684;&#x5c5e;&#x6027;&#x3002;&#x5728;&#x672c;&#x6587;&#x6863;&#x4e2d;&#xff0c;&#x6309;&#x7167;&#x60ef;&#x4f8b;&#xff0c;&#x8be5;&#x5bf9;&#x8c61;&#x59cb;&#x7ec8;&#x79f0;&#x4e3a; req&#xff08;HTTP &#x54cd;&#x5e94;&#x4e3a; res&#xff09;&#xff0c;&#x4f46;&#x5176;&#x5b9e;&#x9645;&#x540d;&#x79f0;&#x7531;&#x60a8;&#x6b63;&#x5728;&#x4f7f;&#x7528;&#x7684;&#x56de;&#x8c03;&#x51fd;&#x6570;&#x7684;&#x53c2;&#x6570;&#x786e;&#x5b9a;&#x3002;\n\n&#x4f8b;&#x5982;&#xff1a;\n\napp.get(<span class=\"hljs-string\">&apos;/user/:id&apos;</span>, <span class=\"hljs-keyword\">function</span> (req, res) {\n  res.send(<span class=\"hljs-string\">&apos;user &apos;</span> + req.params.id)\n})\n&#x4f46;&#x4f60;&#x4e5f;&#x53ef;&#x4ee5;&#x62e5;&#x6709;&#xff1a;\n\napp.get(<span class=\"hljs-string\">&apos;/user/:id&apos;</span>, <span class=\"hljs-keyword\">function</span> (request, response) {\n  response.send(<span class=\"hljs-string\">&apos;user &apos;</span> + request.params.id)\n})\nreq&#x5bf9;&#x8c61;&#x662f;Node&#x81ea;&#x5e26;&#x8bf7;&#x6c42;&#x5bf9;&#x8c61;&#x7684;&#x589e;&#x5f3a;&#x7248;&#xff0c;&#x652f;&#x6301;&#x6240;&#x6709;&#x5185;&#x7f6e;&#x5b57;&#x6bb5;&#x548c;&#x65b9;&#x6cd5;&#x3002;\n\n req.app&#x4e2d;&#x82f1;\n&#x6b64;&#x5c5e;&#x6027;&#x5305;&#x542b;&#x5bf9;&#x4f7f;&#x7528;&#x4e2d;&#x95f4;&#x4ef6;&#x7684; Express &#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x5b9e;&#x4f8b;&#x7684;&#x5f15;&#x7528;&#x3002;\n\n&#x5982;&#x679c;&#x60a8;&#x9075;&#x5faa;&#x521b;&#x5efa;&#x4e00;&#x4e2a;&#x6a21;&#x5757;&#x7684;&#x6a21;&#x5f0f;&#xff0c;&#x8be5;&#x6a21;&#x5757;&#x4ec5;&#x5bfc;&#x51fa;&#x4e00;&#x4e2a;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x5e76;&#x5728;&#x4e3b;&#x6587;&#x4ef6;&#x4e2d; require()&#xff0c;&#x5219;&#x4e2d;&#x95f4;&#x4ef6;&#x53ef;&#x4ee5;&#x901a;&#x8fc7; req.app &#x8bbf;&#x95ee; Express &#x5b9e;&#x4f8b;\n\n&#x4f8b;&#x5982;&#xff1a;\n\n<span class=\"hljs-regexp\">//</span> index.js\napp.get(<span class=\"hljs-string\">&apos;/viewdirectory&apos;</span>, require(<span class=\"hljs-string\">&apos;./mymiddleware.js&apos;</span>))\n<span class=\"hljs-regexp\">//</span> mymiddleware.js\nmodule.exports = <span class=\"hljs-keyword\">function</span> (req, res) {\n  res.send(<span class=\"hljs-string\">&apos;The views directory is &apos;</span> + req.app.get(<span class=\"hljs-string\">&apos;views&apos;</span>))\n}\n req.baseUrl&#x4e2d;&#x82f1;\n&#x5b89;&#x88c5;&#x8def;&#x7531;&#x5b9e;&#x4f8b;&#x7684; URL &#x8def;&#x5f84;&#x3002;\n\nreq.baseUrl &#x5c5e;&#x6027;&#x7c7b;&#x4f3c;&#x4e8e; app &#x5bf9;&#x8c61;&#x7684; mountpath &#x5c5e;&#x6027;&#xff0c;&#x9664;&#x4e86; app.mountpath &#x8fd4;&#x56de;&#x5339;&#x914d;&#x7684;&#x8def;&#x5f84;&#x6a21;&#x5f0f;&#x3002;\n\n&#x4f8b;&#x5982;&#xff1a;\n\nvar greet = express.Router()\n\ngreet.get(<span class=\"hljs-string\">&apos;/jp&apos;</span>, <span class=\"hljs-keyword\">function</span> (req, res) {\n  console.log(req.baseUrl) <span class=\"hljs-regexp\">//</span> /greet\n  res.send(<span class=\"hljs-string\">&apos;Konichiwa!&apos;</span>)\n})\n\napp.use(<span class=\"hljs-string\">&apos;/greet&apos;</span>, greet) <span class=\"hljs-regexp\">//</span> load the router on <span class=\"hljs-string\">&apos;/greet&apos;</span>\n&#x5373;&#x4f7f;&#x60a8;&#x4f7f;&#x7528;&#x8def;&#x5f84;&#x6a21;&#x5f0f;&#x6216;&#x4e00;&#x7ec4;&#x8def;&#x5f84;&#x6a21;&#x5f0f;&#x6765;&#x52a0;&#x8f7d;&#x8def;&#x7531;&#xff0c;baseUrl &#x5c5e;&#x6027;&#x4e5f;&#x4f1a;&#x8fd4;&#x56de;&#x5339;&#x914d;&#x7684;&#x5b57;&#x7b26;&#x4e32;&#xff0c;&#x800c;&#x4e0d;&#x662f;&#x6a21;&#x5f0f;&#x3002;&#x5728;&#x4ee5;&#x4e0b;&#x793a;&#x4f8b;&#x4e2d;&#xff0c;greet &#x8def;&#x7531;&#x52a0;&#x8f7d;&#x5728;&#x4e24;&#x4e2a;&#x8def;&#x5f84;&#x6a21;&#x5f0f;&#x4e0a;&#x3002;\n\napp.use([<span class=\"hljs-string\">&apos;/gre+t&apos;</span>, <span class=\"hljs-string\">&apos;/hel{2}o&apos;</span>], greet) <span class=\"hljs-regexp\">//</span> load the router on <span class=\"hljs-string\">&apos;/gre+t&apos;</span> and <span class=\"hljs-string\">&apos;/hel{2}o&apos;</span>\n&#x5f53;&#x5411; <span class=\"hljs-regexp\">/greet/</span>jp &#x53d1;&#x51fa;&#x8bf7;&#x6c42;&#x65f6;&#xff0c;req.baseUrl &#x662f; <span class=\"hljs-string\">&quot;/greet&quot;</span>&#x3002;&#x5f53;&#x5411; <span class=\"hljs-regexp\">/hello/</span>jp &#x53d1;&#x51fa;&#x8bf7;&#x6c42;&#x65f6;&#xff0c;req.baseUrl &#x662f; <span class=\"hljs-string\">&quot;/hello&quot;</span>&#x3002;\n\n req.body&#x4e2d;&#x82f1;\n&#x5305;&#x542b;&#x5728;&#x8bf7;&#x6c42;&#x6b63;&#x6587;&#x4e2d;&#x63d0;&#x4ea4;&#x7684;&#x6570;&#x636e;&#x952e;&#x503c;&#x5bf9;&#x3002;&#x9ed8;&#x8ba4;&#x60c5;&#x51b5;&#x4e0b;&#xff0c;&#x5b83;&#x662f; undefined&#xff0c;&#x5e76;&#x5728;&#x60a8;&#x4f7f;&#x7528; express.json() &#x6216; express.urlencoded() &#x7b49;&#x6b63;&#x6587;&#x89e3;&#x6790;&#x4e2d;&#x95f4;&#x4ef6;&#x65f6;&#x586b;&#x5145;&#x3002;\n\n&#x7531;&#x4e8e; req.body &#x7684;&#x5f62;&#x72b6;&#x57fa;&#x4e8e;&#x7528;&#x6237;&#x63a7;&#x5236;&#x7684;&#x8f93;&#x5165;&#xff0c;&#x56e0;&#x6b64;&#x8be5;&#x5bf9;&#x8c61;&#x4e2d;&#x7684;&#x6240;&#x6709;&#x5c5e;&#x6027;&#x548c;&#x503c;&#x90fd;&#x662f;&#x4e0d;&#x53ef;&#x4fe1;&#x7684;&#xff0c;&#x5e94;&#x8be5;&#x5728;&#x4fe1;&#x4efb;&#x4e4b;&#x524d;&#x8fdb;&#x884c;&#x9a8c;&#x8bc1;&#x3002;&#x4f8b;&#x5982;&#xff0c;req.body.foo.toString() &#x53ef;&#x80fd;&#x4ee5;&#x591a;&#x79cd;&#x65b9;&#x5f0f;&#x5931;&#x8d25;&#xff0c;&#x4f8b;&#x5982; foo &#x53ef;&#x80fd;&#x4e0d;&#x5b58;&#x5728;&#x6216;&#x53ef;&#x80fd;&#x4e0d;&#x662f;&#x5b57;&#x7b26;&#x4e32;&#xff0c;toString &#x53ef;&#x80fd;&#x4e0d;&#x662f;&#x51fd;&#x6570;&#xff0c;&#x800c;&#x662f;&#x5b57;&#x7b26;&#x4e32;&#x6216;&#x5176;&#x4ed6;&#x7528;&#x6237;&#x8f93;&#x5165;&#x3002;\n\n&#x4ee5;&#x4e0b;&#x793a;&#x4f8b;&#x663e;&#x793a;&#x5982;&#x4f55;&#x4f7f;&#x7528;&#x6b63;&#x6587;&#x89e3;&#x6790;&#x4e2d;&#x95f4;&#x4ef6;&#x586b;&#x5145; req.body&#x3002;\n\nvar express = require(<span class=\"hljs-string\">&apos;express&apos;</span>)\n\nvar app = express()\n\napp.use(express.json()) <span class=\"hljs-regexp\">//</span> <span class=\"hljs-keyword\">for</span> parsing application/json\napp.use(express.urlencoded({ extended: true })) <span class=\"hljs-regexp\">//</span> <span class=\"hljs-keyword\">for</span> parsing application/x-www-form-urlencoded\n\napp.post(<span class=\"hljs-string\">&apos;/profile&apos;</span>, <span class=\"hljs-keyword\">function</span> (req, res, <span class=\"hljs-keyword\">next</span>) {\n  console.log(req.body)\n  res.json(req.body)\n})\n req.cookies&#x4e2d;&#x82f1;\n&#x4f7f;&#x7528; cookie-parser &#x4e2d;&#x95f4;&#x4ef6;&#x65f6;&#xff0c;&#x8be5;&#x5c5e;&#x6027;&#x662f;&#x4e00;&#x4e2a;&#x5305;&#x542b;&#x8bf7;&#x6c42;&#x53d1;&#x9001;&#x7684; cookie &#x7684;&#x5bf9;&#x8c61;&#x3002;&#x5982;&#x679c;&#x8bf7;&#x6c42;&#x4e0d;&#x5305;&#x542b; cookie&#xff0c;&#x5219;&#x9ed8;&#x8ba4;&#x4e3a; {}&#x3002;\n\n<span class=\"hljs-regexp\">//</span> Cookie: name=tj\nconsole.dir(req.cookies.name)\n<span class=\"hljs-regexp\">//</span> =&gt; <span class=\"hljs-string\">&apos;tj&apos;</span>\n&#x5982;&#x679c; cookie &#x5df2;&#x7b7e;&#x540d;&#xff0c;&#x5219;&#x5fc5;&#x987b;&#x4f7f;&#x7528; req.signedCookies&#x3002;\n\n&#x6709;&#x5173;&#x66f4;&#x591a;&#x4fe1;&#x606f;&#x3001;&#x95ee;&#x9898;&#x6216;&#x7591;&#x8651;&#xff0c;&#x8bf7;&#x53c2;&#x9605; cookie-parser&#x3002;\n\n req.fresh&#x4e2d;&#x82f1;\n&#x5f53;&#x54cd;&#x5e94;&#x5728;&#x5ba2;&#x6237;&#x7aef;&#x7684;&#x7f13;&#x5b58;&#x4e2d;&#x4ecd;&#x7136;&#x662f; <span class=\"hljs-string\">&quot;fresh&quot;</span> &#x65f6;&#xff0c;&#x8fd4;&#x56de; true&#xff0c;&#x5426;&#x5219;&#x8fd4;&#x56de; false&#xff0c;&#x8868;&#x793a;&#x5ba2;&#x6237;&#x7aef;&#x7f13;&#x5b58;&#x73b0;&#x5728;&#x5df2;&#x7ecf;&#x8fc7;&#x65f6;&#xff0c;&#x5e94;&#x8be5;&#x53d1;&#x9001;&#x5b8c;&#x6574;&#x7684;&#x54cd;&#x5e94;&#x3002;\n\n&#x5f53;&#x5ba2;&#x6237;&#x7aef;&#x53d1;&#x9001; Cache-Control: no-cache &#x8bf7;&#x6c42;&#x5934;&#x6307;&#x793a;&#x7aef;&#x5230;&#x7aef;&#x7684;&#x91cd;&#x65b0;&#x52a0;&#x8f7d;&#x8bf7;&#x6c42;&#x65f6;&#xff0c;&#x8be5;&#x6a21;&#x5757;&#x5c06;&#x8fd4;&#x56de; false &#x4ee5;&#x4f7f;&#x5904;&#x7406;&#x8fd9;&#x4e9b;&#x8bf7;&#x6c42;&#x900f;&#x660e;&#x3002;\n\n&#x6709;&#x5173;&#x7f13;&#x5b58;&#x9a8c;&#x8bc1;&#x5982;&#x4f55;&#x5de5;&#x4f5c;&#x7684;&#x66f4;&#x591a;&#x8be6;&#x7ec6;&#x4fe1;&#x606f;&#xff0c;&#x8bf7;&#x53c2;&#x9605; HTTP/<span class=\"hljs-number\">1.1</span> &#x7f13;&#x5b58;&#x89c4;&#x8303;&#x3002;\n\nconsole.dir(req.fresh)\n<span class=\"hljs-regexp\">//</span> =&gt; true\n req.hostname&#x4e2d;&#x82f1;\n&#x5305;&#x542b;&#x4ece; Host HTTP &#x6807;&#x5934;&#x6d3e;&#x751f;&#x7684;&#x4e3b;&#x673a;&#x540d;&#x3002;\n\n&#x5f53; trust proxy &#x8bbe;&#x7f6e; &#x4e0d;&#x8ba1;&#x7b97;&#x4e3a; false &#x65f6;&#xff0c;&#x6b64;&#x5c5e;&#x6027;&#x5c06;&#x6539;&#x4e3a;&#x4ece; X-Forwarded-Host &#x6807;&#x5934;&#x5b57;&#x6bb5;&#x4e2d;&#x83b7;&#x53d6;&#x503c;&#x3002;&#x6b64;&#x6807;&#x5934;&#x53ef;&#x4ee5;&#x7531;&#x5ba2;&#x6237;&#x7aef;&#x6216;&#x4ee3;&#x7406;&#x8bbe;&#x7f6e;&#x3002;\n\n&#x5982;&#x679c;&#x8bf7;&#x6c42;&#x4e2d;&#x6709;&#x591a;&#x4e2a; X-Forwarded-Host &#x6807;&#x5934;&#xff0c;&#x5219;&#x4f7f;&#x7528;&#x7b2c;&#x4e00;&#x4e2a;&#x6807;&#x5934;&#x7684;&#x503c;&#x3002;&#x8fd9;&#x5305;&#x62ec;&#x4e00;&#x4e2a;&#x5e26;&#x6709;&#x9017;&#x53f7;&#x5206;&#x9694;&#x503c;&#x7684;&#x6807;&#x5934;&#xff0c;&#x5176;&#x4e2d;&#x4f7f;&#x7528;&#x4e86;&#x7b2c;&#x4e00;&#x4e2a;&#x503c;&#x3002;\n\n&#x5728; Express v4.<span class=\"hljs-number\">17.0</span> &#x4e4b;&#x524d;&#xff0c;X-Forwarded-Host &#x4e0d;&#x80fd;&#x5305;&#x542b;&#x591a;&#x4e2a;&#x503c;&#x6216;&#x591a;&#x6b21;&#x51fa;&#x73b0;&#x3002;\n\n<span class=\"hljs-regexp\">//</span> Host: <span class=\"hljs-string\">&quot;example.com:3000&quot;</span>\nconsole.dir(req.hostname)\n<span class=\"hljs-regexp\">//</span> =&gt; <span class=\"hljs-string\">&apos;example.com&apos;</span>\n req.ip&#x4e2d;&#x82f1;\n&#x5305;&#x542b;&#x8bf7;&#x6c42;&#x7684;&#x8fdc;&#x7a0b; IP &#x5730;&#x5740;&#x3002;\n\n&#x5f53; trust proxy &#x8bbe;&#x7f6e; &#x4e0d;&#x8ba1;&#x7b97;&#x4e3a; false &#x65f6;&#xff0c;&#x6b64;&#x5c5e;&#x6027;&#x7684;&#x503c;&#x6d3e;&#x751f;&#x81ea; X-Forwarded-For &#x6807;&#x5934;&#x4e2d;&#x6700;&#x5de6;&#x4fa7;&#x7684;&#x6761;&#x76ee;&#x3002;&#x6b64;&#x6807;&#x5934;&#x53ef;&#x4ee5;&#x7531;&#x5ba2;&#x6237;&#x7aef;&#x6216;&#x4ee3;&#x7406;&#x8bbe;&#x7f6e;&#x3002;\n\nconsole.dir(req.ip)\n<span class=\"hljs-regexp\">//</span> =&gt; <span class=\"hljs-string\">&apos;127.0.0.1&apos;</span>\n req.ips&#x4e2d;&#x82f1;\n&#x5f53; trust proxy &#x8bbe;&#x7f6e; &#x4e0d;&#x8bc4;&#x4f30;&#x4e3a; false &#x65f6;&#xff0c;&#x6b64;&#x5c5e;&#x6027;&#x5305;&#x542b; X-Forwarded-For &#x8bf7;&#x6c42;&#x6807;&#x5934;&#x4e2d;&#x6307;&#x5b9a;&#x7684; IP &#x5730;&#x5740;&#x6570;&#x7ec4;&#x3002;&#x5426;&#x5219;&#xff0c;&#x5b83;&#x5305;&#x542b;&#x4e00;&#x4e2a;&#x7a7a;&#x6570;&#x7ec4;&#x3002;&#x6b64;&#x6807;&#x5934;&#x53ef;&#x4ee5;&#x7531;&#x5ba2;&#x6237;&#x7aef;&#x6216;&#x4ee3;&#x7406;&#x8bbe;&#x7f6e;&#x3002;\n\n&#x4f8b;&#x5982;&#xff0c;&#x5982;&#x679c; X-Forwarded-For &#x662f; client, proxy1, proxy2&#xff0c;&#x5219; req.ips &#x5c06;&#x662f; [<span class=\"hljs-string\">&quot;client&quot;</span>, <span class=\"hljs-string\">&quot;proxy1&quot;</span>, <span class=\"hljs-string\">&quot;proxy2&quot;</span>]&#xff0c;&#x5176;&#x4e2d; proxy2 &#x662f;&#x6700;&#x4e0b;&#x6e38;&#x7684;&#x3002;\n\n req.method&#x4e2d;&#x82f1;\n&#x5305;&#x542b;&#x4e0e;&#x8bf7;&#x6c42;&#x7684; HTTP &#x65b9;&#x6cd5;&#x5bf9;&#x5e94;&#x7684;&#x5b57;&#x7b26;&#x4e32;&#xff1a;GET&#x3001;POST&#x3001;PUT &#x7b49;&#x3002;\n\n req.originalUrl&#x4e2d;&#x82f1;\nreq.url &#x4e0d;&#x662f;&#x539f;&#x751f;&#x7684; Express &#x5c5e;&#x6027;&#xff0c;&#x5b83;&#x7ee7;&#x627f;&#x81ea; Node &#x7684; http &#x6a21;&#x5757;&#x3002;\n\n&#x8fd9;&#x4e2a;&#x5c5e;&#x6027;&#x5f88;&#x50cf;req.url&#xff1b;&#x4f46;&#x662f;&#xff0c;&#x5b83;&#x4fdd;&#x7559;&#x4e86;&#x539f;&#x59cb;&#x8bf7;&#x6c42; URL&#xff0c;&#x5141;&#x8bb8;&#x60a8;&#x51fa;&#x4e8e;&#x5185;&#x90e8;&#x8def;&#x7531;&#x76ee;&#x7684;&#x81ea;&#x7531;&#x91cd;&#x5199; req.url&#x3002;&#x4f8b;&#x5982;&#xff0c;app.use() &#x7684; <span class=\"hljs-string\">&quot;mounting&quot;</span> &#x7279;&#x6027;&#x5c06;&#x91cd;&#x5199; req.url &#x4ee5;&#x5265;&#x79bb;&#x6302;&#x8f7d;&#x70b9;&#x3002;\n\n<span class=\"hljs-regexp\">//</span> GET /search?q=something\nconsole.dir(req.originalUrl)\n<span class=\"hljs-regexp\">//</span> =&gt; <span class=\"hljs-string\">&apos;/search?q=something&apos;</span>\nreq.originalUrl &#x5728;&#x4e2d;&#x95f4;&#x4ef6;&#x548c;&#x8def;&#x7531;&#x5bf9;&#x8c61;&#x4e2d;&#x90fd;&#x53ef;&#x7528;&#xff0c;&#x5e76;&#x4e14;&#x662f; req.baseUrl &#x548c; req.url &#x7684;&#x7ec4;&#x5408;&#x3002;&#x8003;&#x8651;&#x4ee5;&#x4e0b;&#x793a;&#x4f8b;&#xff1a;\n\napp.use(<span class=\"hljs-string\">&apos;/admin&apos;</span>, <span class=\"hljs-keyword\">function</span> (req, res, <span class=\"hljs-keyword\">next</span>) { <span class=\"hljs-regexp\">//</span> GET <span class=\"hljs-string\">&apos;http://www.example.com/admin/new?sort=desc&apos;</span>\n  console.dir(req.originalUrl) <span class=\"hljs-regexp\">//</span> <span class=\"hljs-string\">&apos;/admin/new?sort=desc&apos;</span>\n  console.dir(req.baseUrl) <span class=\"hljs-regexp\">//</span> <span class=\"hljs-string\">&apos;/admin&apos;</span>\n  console.dir(req.path) <span class=\"hljs-regexp\">//</span> <span class=\"hljs-string\">&apos;/new&apos;</span>\n  <span class=\"hljs-keyword\">next</span>()\n})\n req.params&#x4e2d;&#x82f1;\n&#x6b64;&#x5c5e;&#x6027;&#x662f;&#x4e00;&#x4e2a;&#x5305;&#x542b;&#x6620;&#x5c04;&#x5230; &#x547d;&#x540d;&#x8def;&#x7531; <span class=\"hljs-string\">&quot;parameters&quot;</span> &#x7684;&#x5c5e;&#x6027;&#x7684;&#x5bf9;&#x8c61;&#x3002;&#x4f8b;&#x5982;&#xff0c;&#x5982;&#x679c;&#x60a8;&#x6709;&#x8def;&#x7531; <span class=\"hljs-regexp\">/user/</span>:name&#xff0c;&#x5219; <span class=\"hljs-string\">&quot;name&quot;</span> &#x5c5e;&#x6027;&#x53ef;&#x7528;&#x4f5c; req.params.name&#x3002;&#x6b64;&#x5bf9;&#x8c61;&#x9ed8;&#x8ba4;&#x4e3a; {}&#x3002;\n\n<span class=\"hljs-regexp\">//</span> GET <span class=\"hljs-regexp\">/user/</span>tj\nconsole.dir(req.params.name)\n<span class=\"hljs-regexp\">//</span> =&gt; <span class=\"hljs-string\">&apos;tj&apos;</span>\n&#x5f53;&#x60a8;&#x5bf9;&#x8def;&#x7531;&#x5b9a;&#x4e49;&#x4f7f;&#x7528;&#x6b63;&#x5219;&#x8868;&#x8fbe;&#x5f0f;&#x65f6;&#xff0c;&#x6355;&#x83b7;&#x7ec4;&#x4f7f;&#x7528; req.params[n] &#x5728;&#x6570;&#x7ec4;&#x4e2d;&#x63d0;&#x4f9b;&#xff0c;&#x5176;&#x4e2d; n &#x662f; nth &#x6355;&#x83b7;&#x7ec4;&#x3002;&#x6b64;&#x89c4;&#x5219;&#x9002;&#x7528;&#x4e8e;&#x5e26;&#x6709;&#x5b57;&#x7b26;&#x4e32;&#x8def;&#x7531;&#x7684;&#x672a;&#x547d;&#x540d;&#x901a;&#x914d;&#x7b26;&#x5339;&#x914d;&#xff0c;&#x4f8b;&#x5982; <span class=\"hljs-regexp\">/file/</span>*&#xff1a;\n\n<span class=\"hljs-regexp\">//</span> GET <span class=\"hljs-regexp\">/file/</span>javascripts/jquery.js\nconsole.dir(req.params[<span class=\"hljs-number\">0</span>])\n<span class=\"hljs-regexp\">//</span> =&gt; <span class=\"hljs-string\">&apos;javascripts/jquery.js&apos;</span>\n&#x5982;&#x679c;&#x60a8;&#x9700;&#x8981;&#x66f4;&#x6539; req.params &#x4e2d;&#x7684;&#x952e;&#xff0c;&#x8bf7;&#x4f7f;&#x7528; app.param &#x5904;&#x7406;&#x7a0b;&#x5e8f;&#x3002;&#x66f4;&#x6539;&#x4ec5;&#x9002;&#x7528;&#x4e8e;&#x5df2;&#x5728;&#x8def;&#x7531;&#x8def;&#x5f84;&#x4e2d;&#x5b9a;&#x4e49;&#x7684; &#x53c2;&#x6570;&#x3002;\n\n&#x5728;&#x4e2d;&#x95f4;&#x4ef6;&#x6216;&#x8def;&#x7531;&#x5904;&#x7406;&#x7a0b;&#x5e8f;&#x4e2d;&#x5bf9; req.params &#x5bf9;&#x8c61;&#x6240;&#x505a;&#x7684;&#x4efb;&#x4f55;&#x66f4;&#x6539;&#x90fd;&#x5c06;&#x88ab;&#x91cd;&#x7f6e;&#x3002;\n\n&#x6ce8;&#x610f;&#xff1a;Express &#x81ea;&#x52a8;&#x89e3;&#x7801; req.params &#x4e2d;&#x7684;&#x503c;&#xff08;&#x4f7f;&#x7528; decodeURIComponent&#xff09;&#x3002;\n\n req.path&#x4e2d;&#x82f1;\n&#x5305;&#x542b;&#x8bf7;&#x6c42; URL &#x7684;&#x8def;&#x5f84;&#x90e8;&#x5206;&#x3002;\n\n<span class=\"hljs-regexp\">//</span> example.com/users?sort=desc\nconsole.dir(req.path)\n<span class=\"hljs-regexp\">//</span> =&gt; <span class=\"hljs-string\">&apos;/users&apos;</span>\n&#x4ece;&#x4e2d;&#x95f4;&#x4ef6;&#x8c03;&#x7528;&#x65f6;&#xff0c;&#x6302;&#x8f7d;&#x70b9;&#x4e0d;&#x5305;&#x542b;&#x5728; req.path &#x4e2d;&#x3002;&#x6709;&#x5173;&#x8be6;&#x7ec6;&#x4fe1;&#x606f;&#xff0c;&#x8bf7;&#x53c2;&#x9605; app.use()&#x3002;\n\n req.protocol&#x4e2d;&#x82f1;\n&#x5305;&#x542b;&#x8bf7;&#x6c42;&#x534f;&#x8bae;&#x5b57;&#x7b26;&#x4e32;&#xff1a;http &#x6216;&#xff08;&#x5bf9;&#x4e8e; TLS &#x8bf7;&#x6c42;&#xff09;https&#x3002;\n\n&#x5f53; trust proxy &#x8bbe;&#x7f6e; &#x4e0d;&#x8ba1;&#x7b97;&#x4e3a; false &#x65f6;&#xff0c;&#x6b64;&#x5c5e;&#x6027;&#x5c06;&#x4f7f;&#x7528; X-Forwarded-Proto &#x6807;&#x5934;&#x5b57;&#x6bb5;&#x7684;&#x503c;&#xff08;&#x5982;&#x679c;&#x5b58;&#x5728;&#xff09;&#x3002;&#x6b64;&#x6807;&#x5934;&#x53ef;&#x4ee5;&#x7531;&#x5ba2;&#x6237;&#x7aef;&#x6216;&#x4ee3;&#x7406;&#x8bbe;&#x7f6e;&#x3002;\n\nconsole.dir(req.protocol)\n<span class=\"hljs-regexp\">//</span> =&gt; <span class=\"hljs-string\">&apos;http&apos;</span>\n req.query&#x4e2d;&#x82f1;\n&#x6b64;&#x5c5e;&#x6027;&#x662f;&#x4e00;&#x4e2a;&#x5bf9;&#x8c61;&#xff0c;&#x5176;&#x4e2d;&#x5305;&#x542b;&#x8def;&#x7531;&#x4e2d;&#x6bcf;&#x4e2a;&#x67e5;&#x8be2;&#x5b57;&#x7b26;&#x4e32;&#x53c2;&#x6570;&#x7684;&#x5c5e;&#x6027;&#x3002;&#x5f53; &#x67e5;&#x8be2;&#x89e3;&#x6790;&#x5668; &#x8bbe;&#x7f6e;&#x4e3a;&#x7981;&#x7528;&#x65f6;&#xff0c;&#x5b83;&#x662f;&#x4e00;&#x4e2a;&#x7a7a;&#x5bf9;&#x8c61; {}&#xff0c;&#x5426;&#x5219;&#x5b83;&#x662f;&#x914d;&#x7f6e;&#x7684;&#x67e5;&#x8be2;&#x89e3;&#x6790;&#x5668;&#x7684;&#x7ed3;&#x679c;&#x3002;\n\n&#x7531;&#x4e8e; req.query &#x7684;&#x5f62;&#x72b6;&#x57fa;&#x4e8e;&#x7528;&#x6237;&#x63a7;&#x5236;&#x7684;&#x8f93;&#x5165;&#xff0c;&#x56e0;&#x6b64;&#x8be5;&#x5bf9;&#x8c61;&#x4e2d;&#x7684;&#x6240;&#x6709;&#x5c5e;&#x6027;&#x548c;&#x503c;&#x90fd;&#x662f;&#x4e0d;&#x53ef;&#x4fe1;&#x7684;&#xff0c;&#x5e94;&#x8be5;&#x5728;&#x4fe1;&#x4efb;&#x4e4b;&#x524d;&#x8fdb;&#x884c;&#x9a8c;&#x8bc1;&#x3002;&#x4f8b;&#x5982;&#xff0c;req.query.foo.toString() &#x53ef;&#x80fd;&#x4ee5;&#x591a;&#x79cd;&#x65b9;&#x5f0f;&#x5931;&#x8d25;&#xff0c;&#x4f8b;&#x5982; foo &#x53ef;&#x80fd;&#x4e0d;&#x5b58;&#x5728;&#x6216;&#x53ef;&#x80fd;&#x4e0d;&#x662f;&#x5b57;&#x7b26;&#x4e32;&#xff0c;toString &#x53ef;&#x80fd;&#x4e0d;&#x662f;&#x51fd;&#x6570;&#xff0c;&#x800c;&#x662f;&#x5b57;&#x7b26;&#x4e32;&#x6216;&#x5176;&#x4ed6;&#x7528;&#x6237;&#x8f93;&#x5165;&#x3002;\n\n&#x53ef;&#x4ee5;&#x4f7f;&#x7528; &#x67e5;&#x8be2;&#x89e3;&#x6790;&#x5668;&#x5e94;&#x7528;&#x8bbe;&#x7f6e; &#x914d;&#x7f6e;&#x6b64;&#x5c5e;&#x6027;&#x7684;&#x503c;&#xff0c;&#x4ee5;&#x6309;&#x7167;&#x60a8;&#x7684;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x9700;&#x8981;&#x7684;&#x65b9;&#x5f0f;&#x5de5;&#x4f5c;&#x3002;&#x4e00;&#x4e2a;&#x975e;&#x5e38;&#x6d41;&#x884c;&#x7684;&#x67e5;&#x8be2;&#x5b57;&#x7b26;&#x4e32;&#x89e3;&#x6790;&#x5668;&#x662f; qs &#x6a21;&#x5757;&#xff0c;&#x8fd9;&#x662f;&#x9ed8;&#x8ba4;&#x4f7f;&#x7528;&#x7684;&#x3002;qs &#x6a21;&#x5757;&#x53ef;&#x4ee5;&#x901a;&#x8fc7;&#x8bb8;&#x591a;&#x8bbe;&#x7f6e;&#x8fdb;&#x884c;&#x914d;&#x7f6e;&#xff0c;&#x5e76;&#x4e14;&#x53ef;&#x80fd;&#x9700;&#x8981;&#x4f7f;&#x7528;&#x4e0e;&#x9ed8;&#x8ba4;&#x8bbe;&#x7f6e;&#x4e0d;&#x540c;&#x7684;&#x8bbe;&#x7f6e;&#x6765;&#x586b;&#x5145; req.query&#xff1a;\n\nvar qs = require(<span class=\"hljs-string\">&apos;qs&apos;</span>)\napp.setting(<span class=\"hljs-string\">&apos;query parser&apos;</span>, <span class=\"hljs-keyword\">function</span> (str) {\n  return qs.parse(str, { <span class=\"hljs-regexp\">/* custom options */</span> })\n})\n&#x67e5;&#x770b; &#x67e5;&#x8be2;&#x89e3;&#x6790;&#x5668;&#x5e94;&#x7528;&#x8bbe;&#x7f6e; &#x6587;&#x6863;&#x4ee5;&#x4e86;&#x89e3;&#x5176;&#x4ed6;&#x81ea;&#x5b9a;&#x4e49;&#x9009;&#x9879;&#x3002;\n\n req.res&#x4e2d;&#x82f1;\n&#x6b64;&#x5c5e;&#x6027;&#x5305;&#x542b;&#x5bf9;&#x4e0e;&#x6b64;&#x8bf7;&#x6c42;&#x5bf9;&#x8c61;&#x76f8;&#x5173;&#x7684; &#x54cd;&#x5e94;&#x5bf9;&#x8c61; &#x7684;&#x5f15;&#x7528;&#x3002;\n\n req.route&#x4e2d;&#x82f1;\n&#x5305;&#x542b;&#x5f53;&#x524d;&#x5339;&#x914d;&#x7684;&#x8def;&#x7531;&#xff0c;&#x4e00;&#x4e2a;&#x5b57;&#x7b26;&#x4e32;&#x3002;&#x4f8b;&#x5982;&#xff1a;\n\napp.get(<span class=\"hljs-string\">&apos;/user/:id?&apos;</span>, <span class=\"hljs-keyword\">function</span> userIdHandler (req, res) {\n  console.log(req.route)\n  res.send(<span class=\"hljs-string\">&apos;GET&apos;</span>)\n})\n&#x4e0a;&#x4e00;&#x4e2a;&#x7247;&#x6bb5;&#x7684;&#x793a;&#x4f8b;&#x8f93;&#x51fa;&#xff1a;\n\n{ path: <span class=\"hljs-string\">&apos;/user/:id?&apos;</span>,\n  stack:\n   [ { handle: [Function: userIdHandler],\n       name: <span class=\"hljs-string\">&apos;userIdHandler&apos;</span>,\n       params: undefined,\n       path: undefined,\n       keys: [],\n       regexp: <span class=\"hljs-regexp\">/^\\/?&#x24;/i</span>,\n       method: <span class=\"hljs-string\">&apos;get&apos;</span> } ],\n  methods: { get: true } }\n req.secure&#x4e2d;&#x82f1;\n&#x5982;&#x679c;&#x5efa;&#x7acb;&#x4e86; TLS &#x8fde;&#x63a5;&#xff0c;&#x5219;&#x4e3a; true &#x7684;&#x5e03;&#x5c14;&#x5c5e;&#x6027;&#x3002;&#x76f8;&#x5f53;&#x4e8e;&#xff1a;\n\nconsole.dir(req.protocol === <span class=\"hljs-string\">&apos;https&apos;</span>)\n<span class=\"hljs-regexp\">//</span> =&gt; true\n req.signedCookies&#x4e2d;&#x82f1;\n&#x4f7f;&#x7528; cookie-parser &#x4e2d;&#x95f4;&#x4ef6;&#x65f6;&#xff0c;&#x6b64;&#x5c5e;&#x6027;&#x5305;&#x542b;&#x8bf7;&#x6c42;&#x53d1;&#x9001;&#x7684;&#x5df2;&#x7b7e;&#x540d; cookie&#xff0c;&#x672a;&#x7b7e;&#x540d;&#x4e14;&#x53ef;&#x4f9b;&#x4f7f;&#x7528;&#x3002;&#x7b7e;&#x540d;&#x7684; cookie &#x9a7b;&#x7559;&#x5728;&#x4e0d;&#x540c;&#x7684;&#x5bf9;&#x8c61;&#x4e2d;&#x4ee5;&#x663e;&#x793a;&#x5f00;&#x53d1;&#x4eba;&#x5458;&#x7684;&#x610f;&#x56fe;&#xff1b;&#x5426;&#x5219;&#xff0c;&#x53ef;&#x80fd;&#x4f1a;&#x5bf9; req.cookie &#x503c;&#x8fdb;&#x884c;&#x6076;&#x610f;&#x653b;&#x51fb;&#xff08;&#x8fd9;&#x5f88;&#x5bb9;&#x6613;&#x88ab;&#x6b3a;&#x9a97;&#xff09;&#x3002;&#x8bf7;&#x6ce8;&#x610f;&#xff0c;&#x5bf9; cookie &#x8fdb;&#x884c;&#x7b7e;&#x540d;&#x4e0d;&#x4f1a;&#x4f7f;&#x5176;&#x6210;&#x4e3a; <span class=\"hljs-string\">&quot;hidden&quot;</span> &#x6216;&#x52a0;&#x5bc6;&#xff1b;&#x4f46;&#x53ea;&#x662f;&#x9632;&#x6b62;&#x7be1;&#x6539;&#xff08;&#x56e0;&#x4e3a;&#x7528;&#x4e8e;&#x7b7e;&#x540d;&#x7684;&#x79d8;&#x5bc6;&#x662f;&#x79c1;&#x4eba;&#x7684;&#xff09;&#x3002;\n\n&#x5982;&#x679c;&#x672a;&#x53d1;&#x9001;&#x7b7e;&#x540d; cookie&#xff0c;&#x5219;&#x8be5;&#x5c5e;&#x6027;&#x9ed8;&#x8ba4;&#x4e3a; {}&#x3002;\n\n<span class=\"hljs-regexp\">//</span> Cookie: user=tobi.CP7AWaXDfAKIRfH49dQzKJx7sKzzSoPq7/AcBBRVwlI3\nconsole.dir(req.signedCookies.user)\n<span class=\"hljs-regexp\">//</span> =&gt; <span class=\"hljs-string\">&apos;tobi&apos;</span>\n&#x6709;&#x5173;&#x66f4;&#x591a;&#x4fe1;&#x606f;&#x3001;&#x95ee;&#x9898;&#x6216;&#x7591;&#x8651;&#xff0c;&#x8bf7;&#x53c2;&#x9605; cookie-parser&#x3002;\n\n req.stale&#x4e2d;&#x82f1;\n&#x8868;&#x793a;&#x8bf7;&#x6c42;&#x662f;&#x5426;&#x4e3a;<span class=\"hljs-string\">&quot;stale,&quot;</span>&#xff0c;&#x4e0e;req.fresh&#x76f8;&#x53cd;&#x3002;&#x6709;&#x5173;&#x8be6;&#x7ec6;&#x4fe1;&#x606f;&#xff0c;&#x8bf7;&#x53c2;&#x9605; req.fresh&#x3002;\n\nconsole.dir(req.stale)\n<span class=\"hljs-regexp\">//</span> =&gt; true\n req.subdomains&#x4e2d;&#x82f1;\n&#x8bf7;&#x6c42;&#x57df;&#x540d;&#x4e2d;&#x7684;&#x5b50;&#x57df;&#x6570;&#x7ec4;&#x3002;\n\n<span class=\"hljs-regexp\">//</span> Host: <span class=\"hljs-string\">&quot;tobi.ferrets.example.com&quot;</span>\nconsole.dir(req.subdomains)\n<span class=\"hljs-regexp\">//</span> =&gt; [<span class=\"hljs-string\">&apos;ferrets&apos;</span>, <span class=\"hljs-string\">&apos;tobi&apos;</span>]\n&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x5c5e;&#x6027; subdomain offset&#xff0c;&#x9ed8;&#x8ba4;&#x4e3a; <span class=\"hljs-number\">2</span>&#xff0c;&#x7528;&#x4e8e;&#x786e;&#x5b9a;&#x5b50;&#x57df;&#x6bb5;&#x7684;&#x5f00;&#x59cb;&#x3002;&#x8981;&#x66f4;&#x6539;&#x6b64;&#x884c;&#x4e3a;&#xff0c;&#x8bf7;&#x4f7f;&#x7528; app.set &#x66f4;&#x6539;&#x5176;&#x503c;&#x3002;\n\n req.xhr&#x4e2d;&#x82f1;\n&#x5982;&#x679c;&#x8bf7;&#x6c42;&#x7684; X-Requested-With &#x6807;&#x5934;&#x5b57;&#x6bb5;&#x4e3a; <span class=\"hljs-string\">&quot;XMLHttpRequest&quot;</span>&#xff0c;&#x5219;&#x4e3a; true &#x7684;&#x5e03;&#x5c14;&#x5c5e;&#x6027;&#xff0c;&#x8868;&#x793a;&#x8be5;&#x8bf7;&#x6c42;&#x662f;&#x7531; jQuery &#x7b49;&#x5ba2;&#x6237;&#x7aef;&#x5e93;&#x53d1;&#x51fa;&#x7684;&#x3002;\n\nconsole.dir(req.xhr)\n<span class=\"hljs-regexp\">//</span> =&gt; true\n req.accepts(types)&#x4e2d;&#x82f1;\n&#x6839;&#x636e;&#x8bf7;&#x6c42;&#x7684; Accept HTTP &#x6807;&#x5934;&#x5b57;&#x6bb5;&#x68c0;&#x67e5;&#x6307;&#x5b9a;&#x7684;&#x5185;&#x5bb9;&#x7c7b;&#x578b;&#x662f;&#x5426;&#x53ef;&#x63a5;&#x53d7;&#x3002;&#x8be5;&#x65b9;&#x6cd5;&#x8fd4;&#x56de;&#x6700;&#x4f73;&#x5339;&#x914d;&#xff0c;&#x6216;&#x8005;&#x5982;&#x679c;&#x6307;&#x5b9a;&#x7684;&#x5185;&#x5bb9;&#x7c7b;&#x578b;&#x90fd;&#x4e0d;&#x53ef;&#x63a5;&#x53d7;&#xff0c;&#x5219;&#x8fd4;&#x56de; false&#xff08;&#x5728;&#x8fd9;&#x79cd;&#x60c5;&#x51b5;&#x4e0b;&#xff0c;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x5e94;&#x4ee5; <span class=\"hljs-number\">406</span> <span class=\"hljs-string\">&quot;Not Acceptable&quot;</span> &#x54cd;&#x5e94;&#xff09;&#x3002;\n\ntype &#x503c;&#x53ef;&#x4ee5;&#x662f;&#x5355;&#x4e2a; MIME &#x7c7b;&#x578b;&#x5b57;&#x7b26;&#x4e32;&#xff08;&#x4f8b;&#x5982; <span class=\"hljs-string\">&quot;application/json&quot;</span>&#xff09;&#x3001;&#x6269;&#x5c55;&#x540d;&#xff08;&#x4f8b;&#x5982; <span class=\"hljs-string\">&quot;json&quot;</span>&#xff09;&#x3001;&#x9017;&#x53f7;&#x5206;&#x9694;&#x7684;&#x5217;&#x8868;&#x6216;&#x6570;&#x7ec4;&#x3002;&#x5bf9;&#x4e8e;&#x5217;&#x8868;&#x6216;&#x6570;&#x7ec4;&#xff0c;&#x8be5;&#x65b9;&#x6cd5;&#x8fd4;&#x56de;&#x6700;&#x4f73;&#x5339;&#x914d;&#xff08;&#x5982;&#x679c;&#x6709;&#xff09;&#x3002;\n\n<span class=\"hljs-regexp\">//</span> Accept: text/html\nreq.accepts(<span class=\"hljs-string\">&apos;html&apos;</span>)\n<span class=\"hljs-regexp\">//</span> =&gt; <span class=\"hljs-string\">&quot;html&quot;</span>\n\n<span class=\"hljs-regexp\">//</span> Accept: text<span class=\"hljs-regexp\">/*, application/</span>json\nreq.accepts(<span class=\"hljs-string\">&apos;html&apos;</span>)\n<span class=\"hljs-regexp\">//</span> =&gt; <span class=\"hljs-string\">&quot;html&quot;</span>\nreq.accepts(<span class=\"hljs-string\">&apos;text/html&apos;</span>)\n<span class=\"hljs-regexp\">//</span> =&gt; <span class=\"hljs-string\">&quot;text/html&quot;</span>\nreq.accepts([<span class=\"hljs-string\">&apos;json&apos;</span>, <span class=\"hljs-string\">&apos;text&apos;</span>])\n<span class=\"hljs-regexp\">//</span> =&gt; <span class=\"hljs-string\">&quot;json&quot;</span>\nreq.accepts(<span class=\"hljs-string\">&apos;application/json&apos;</span>)\n<span class=\"hljs-regexp\">//</span> =&gt; <span class=\"hljs-string\">&quot;application/json&quot;</span>\n\n<span class=\"hljs-regexp\">//</span> Accept: text<span class=\"hljs-regexp\">/*, application/</span>json\nreq.accepts(<span class=\"hljs-string\">&apos;image/png&apos;</span>)\nreq.accepts(<span class=\"hljs-string\">&apos;png&apos;</span>)\n<span class=\"hljs-regexp\">//</span> =&gt; false\n\n<span class=\"hljs-regexp\">//</span> Accept: text<span class=\"hljs-regexp\">/*;q=.5, application/</span>json\nreq.accepts([<span class=\"hljs-string\">&apos;html&apos;</span>, <span class=\"hljs-string\">&apos;json&apos;</span>])\n<span class=\"hljs-regexp\">//</span> =&gt; <span class=\"hljs-string\">&quot;json&quot;</span>\n&#x5982;&#x9700;&#x66f4;&#x591a;&#x4fe1;&#x606f;&#xff0c;&#x6216;&#x8005;&#x5982;&#x679c;&#x60a8;&#x6709;&#x95ee;&#x9898;&#x6216;&#x7591;&#x8651;&#xff0c;&#x8bf7;&#x53c2;&#x9605; accepts&#x3002;\n\n req.acceptsCharsets(charset [, ...])&#x4e2d;&#x82f1;\n&#x6839;&#x636e;&#x8bf7;&#x6c42;&#x7684; Accept-Charset HTTP &#x6807;&#x5934;&#x5b57;&#x6bb5;&#xff0c;&#x8fd4;&#x56de;&#x6307;&#x5b9a;&#x5b57;&#x7b26;&#x96c6;&#x7684;&#x7b2c;&#x4e00;&#x4e2a;&#x63a5;&#x53d7;&#x7684;&#x5b57;&#x7b26;&#x96c6;&#x3002;&#x5982;&#x679c;&#x4e0d;&#x63a5;&#x53d7;&#x4efb;&#x4f55;&#x6307;&#x5b9a;&#x7684;&#x5b57;&#x7b26;&#x96c6;&#xff0c;&#x5219;&#x8fd4;&#x56de; false&#x3002;\n\n&#x5982;&#x9700;&#x66f4;&#x591a;&#x4fe1;&#x606f;&#xff0c;&#x6216;&#x8005;&#x5982;&#x679c;&#x60a8;&#x6709;&#x95ee;&#x9898;&#x6216;&#x7591;&#x8651;&#xff0c;&#x8bf7;&#x53c2;&#x9605; accepts&#x3002;\n\n req.acceptsEncodings(encoding [, ...])&#x4e2d;&#x82f1;\n&#x6839;&#x636e;&#x8bf7;&#x6c42;&#x7684; Accept-Encoding HTTP &#x6807;&#x5934;&#x5b57;&#x6bb5;&#xff0c;&#x8fd4;&#x56de;&#x6307;&#x5b9a;&#x7f16;&#x7801;&#x7684;&#x7b2c;&#x4e00;&#x4e2a;&#x63a5;&#x53d7;&#x7684;&#x7f16;&#x7801;&#x3002;&#x5982;&#x679c;&#x4e0d;&#x63a5;&#x53d7;&#x4efb;&#x4f55;&#x6307;&#x5b9a;&#x7684;&#x7f16;&#x7801;&#xff0c;&#x5219;&#x8fd4;&#x56de; false&#x3002;\n\n&#x5982;&#x9700;&#x66f4;&#x591a;&#x4fe1;&#x606f;&#xff0c;&#x6216;&#x8005;&#x5982;&#x679c;&#x60a8;&#x6709;&#x95ee;&#x9898;&#x6216;&#x7591;&#x8651;&#xff0c;&#x8bf7;&#x53c2;&#x9605; accepts&#x3002;\n\n req.acceptsLanguages(lang [, ...])&#x4e2d;&#x82f1;\n&#x6839;&#x636e;&#x8bf7;&#x6c42;&#x7684; Accept-Language HTTP &#x6807;&#x5934;&#x5b57;&#x6bb5;&#xff0c;&#x8fd4;&#x56de;&#x6307;&#x5b9a;&#x8bed;&#x8a00;&#x4e2d;&#x7b2c;&#x4e00;&#x4e2a;&#x63a5;&#x53d7;&#x7684;&#x8bed;&#x8a00;&#x3002;&#x5982;&#x679c;&#x4e0d;&#x63a5;&#x53d7;&#x4efb;&#x4f55;&#x6307;&#x5b9a;&#x7684;&#x8bed;&#x8a00;&#xff0c;&#x5219;&#x8fd4;&#x56de; false&#x3002;\n\n&#x5982;&#x9700;&#x66f4;&#x591a;&#x4fe1;&#x606f;&#xff0c;&#x6216;&#x8005;&#x5982;&#x679c;&#x60a8;&#x6709;&#x95ee;&#x9898;&#x6216;&#x7591;&#x8651;&#xff0c;&#x8bf7;&#x53c2;&#x9605; accepts&#x3002;\n\n req.get(field)&#x4e2d;&#x82f1;\n&#x8fd4;&#x56de;&#x6307;&#x5b9a;&#x7684; HTTP &#x8bf7;&#x6c42;&#x5934;&#x5b57;&#x6bb5;&#xff08;&#x4e0d;&#x533a;&#x5206;&#x5927;&#x5c0f;&#x5199;&#x7684;&#x5339;&#x914d;&#xff09;&#x3002;Referrer &#x548c; Referer &#x5b57;&#x6bb5;&#x53ef;&#x4ee5;&#x4e92;&#x6362;&#x3002;\n\nreq.get(<span class=\"hljs-string\">&apos;Content-Type&apos;</span>)\n<span class=\"hljs-regexp\">//</span> =&gt; <span class=\"hljs-string\">&quot;text/plain&quot;</span>\n\nreq.get(<span class=\"hljs-string\">&apos;content-type&apos;</span>)\n<span class=\"hljs-regexp\">//</span> =&gt; <span class=\"hljs-string\">&quot;text/plain&quot;</span>\n\nreq.get(<span class=\"hljs-string\">&apos;Something&apos;</span>)\n<span class=\"hljs-regexp\">//</span> =&gt; undefined\n&#x522b;&#x540d;&#x4e3a; req.header(field)&#x3002;\n\n req.is(type)&#x4e2d;&#x82f1;\n&#x5982;&#x679c;&#x4f20;&#x5165;&#x8bf7;&#x6c42;&#x7684; <span class=\"hljs-string\">&quot;Content-Type&quot;</span> HTTP &#x6807;&#x5934;&#x5b57;&#x6bb5;&#x4e0e; type &#x53c2;&#x6570;&#x6307;&#x5b9a;&#x7684; MIME &#x7c7b;&#x578b;&#x5339;&#x914d;&#xff0c;&#x5219;&#x8fd4;&#x56de;&#x5339;&#x914d;&#x7684;&#x5185;&#x5bb9;&#x7c7b;&#x578b;&#x3002;&#x5982;&#x679c;&#x8bf7;&#x6c42;&#x6ca1;&#x6709;&#x6b63;&#x6587;&#xff0c;&#x5219;&#x8fd4;&#x56de; null&#x3002;&#x5426;&#x5219;&#x8fd4;&#x56de; false&#x3002;\n\n<span class=\"hljs-regexp\">//</span> With Content-Type: text/html; charset=utf-<span class=\"hljs-number\">8</span>\nreq.is(<span class=\"hljs-string\">&apos;html&apos;</span>)\n<span class=\"hljs-regexp\">//</span> =&gt; <span class=\"hljs-string\">&apos;html&apos;</span>\nreq.is(<span class=\"hljs-string\">&apos;text/html&apos;</span>)\n<span class=\"hljs-regexp\">//</span> =&gt; <span class=\"hljs-string\">&apos;text/html&apos;</span>\nreq.is(<span class=\"hljs-string\">&apos;text/*&apos;</span>)\n<span class=\"hljs-regexp\">//</span> =&gt; <span class=\"hljs-string\">&apos;text/*&apos;</span>\n\n<span class=\"hljs-regexp\">//</span> When Content-Type is application/json\nreq.is(<span class=\"hljs-string\">&apos;json&apos;</span>)\n<span class=\"hljs-regexp\">//</span> =&gt; <span class=\"hljs-string\">&apos;json&apos;</span>\nreq.is(<span class=\"hljs-string\">&apos;application/json&apos;</span>)\n<span class=\"hljs-regexp\">//</span> =&gt; <span class=\"hljs-string\">&apos;application/json&apos;</span>\nreq.is(<span class=\"hljs-string\">&apos;application/*&apos;</span>)\n<span class=\"hljs-regexp\">//</span> =&gt; <span class=\"hljs-string\">&apos;application/*&apos;</span>\n\nreq.is(<span class=\"hljs-string\">&apos;html&apos;</span>)\n<span class=\"hljs-regexp\">//</span> =&gt; false\n&#x5982;&#x9700;&#x66f4;&#x591a;&#x4fe1;&#x606f;&#xff0c;&#x6216;&#x8005;&#x5982;&#x679c;&#x60a8;&#x6709;&#x95ee;&#x9898;&#x6216;&#x7591;&#x8651;&#xff0c;&#x8bf7;&#x53c2;&#x9605; type-is&#x3002;\n\n req.param(name [, defaultValue])&#x4e2d;&#x82f1;\n&#x5df2;&#x5f03;&#x7528;&#x3002;&#x6839;&#x636e;&#x9700;&#x8981;&#x4f7f;&#x7528; req.params&#x3001;req.body &#x6216; req.query&#x3002;\n\n&#x8fd4;&#x56de;&#x53c2;&#x6570; name &#x7684;&#x503c;&#xff08;&#x5982;&#x679c;&#x5b58;&#x5728;&#xff09;&#x3002;\n\n<span class=\"hljs-regexp\">//</span> ?name=tobi\nreq.param(<span class=\"hljs-string\">&apos;name&apos;</span>)\n<span class=\"hljs-regexp\">//</span> =&gt; <span class=\"hljs-string\">&quot;tobi&quot;</span>\n\n<span class=\"hljs-regexp\">//</span> POST name=tobi\nreq.param(<span class=\"hljs-string\">&apos;name&apos;</span>)\n<span class=\"hljs-regexp\">//</span> =&gt; <span class=\"hljs-string\">&quot;tobi&quot;</span>\n\n<span class=\"hljs-regexp\">//</span> <span class=\"hljs-regexp\">/user/</span>tobi <span class=\"hljs-keyword\">for</span> <span class=\"hljs-regexp\">/user/</span>:name\nreq.param(<span class=\"hljs-string\">&apos;name&apos;</span>)\n<span class=\"hljs-regexp\">//</span> =&gt; <span class=\"hljs-string\">&quot;tobi&quot;</span>\n&#x67e5;&#x627e;&#x6309;&#x4ee5;&#x4e0b;&#x987a;&#x5e8f;&#x6267;&#x884c;&#xff1a;\n\nreq.params\nreq.body\nreq.query\n&#x6216;&#x8005;&#xff0c;&#x5982;&#x679c;&#x5728;&#x4efb;&#x4f55;&#x8bf7;&#x6c42;&#x5bf9;&#x8c61;&#x4e2d;&#x90fd;&#x627e;&#x4e0d;&#x5230;&#x8be5;&#x53c2;&#x6570;&#xff0c;&#x60a8;&#x53ef;&#x4ee5;&#x6307;&#x5b9a; defaultValue &#x6765;&#x8bbe;&#x7f6e;&#x9ed8;&#x8ba4;&#x503c;&#x3002;\n\n&#x4e3a;&#x4e86;&#x6e05;&#x695a;&#x8d77;&#x89c1;&#xff0c;&#x5e94;&#x8be5;&#x4f18;&#x5148;&#x76f4;&#x63a5;&#x8bbf;&#x95ee; req.body&#x3001;req.params &#x548c; req.query - &#x9664;&#x975e;&#x60a8;&#x771f;&#x6b63;&#x63a5;&#x53d7;&#x6765;&#x81ea;&#x6bcf;&#x4e2a;&#x5bf9;&#x8c61;&#x7684;&#x8f93;&#x5165;&#x3002;\n\n&#x5fc5;&#x987b;&#x52a0;&#x8f7d;&#x6b63;&#x6587;&#x89e3;&#x6790;&#x4e2d;&#x95f4;&#x4ef6;&#x624d;&#x80fd;&#x4f7f; req.param() &#x4ee5;&#x53ef;&#x9884;&#x6d4b;&#x7684;&#x65b9;&#x5f0f;&#x5de5;&#x4f5c;&#x3002;&#x8be6;&#x60c5;&#x8bf7;&#x53c2;&#x9605; req.body&#x3002;\n\n req.range(size[, options])&#x4e2d;&#x82f1;\nRange &#x6807;&#x5934;&#x89e3;&#x6790;&#x5668;&#x3002;\n\nsize &#x53c2;&#x6570;&#x662f;&#x8d44;&#x6e90;&#x7684;&#x6700;&#x5927;&#x5927;&#x5c0f;&#x3002;\n\noptions &#x53c2;&#x6570;&#x662f;&#x4e00;&#x4e2a;&#x53ef;&#x4ee5;&#x5177;&#x6709;&#x4ee5;&#x4e0b;&#x5c5e;&#x6027;&#x7684;&#x5bf9;&#x8c61;&#x3002;\n\n&#x5c5e;&#x6027;\t&#x7c7b;&#x578b;\t&#x63cf;&#x8ff0;\ncombine\t&#x5e03;&#x5c14;&#x503c;\t&#x6307;&#x5b9a;&#x662f;&#x5426;&#x5e94;&#x5408;&#x5e76;&#x91cd;&#x53e0;&#x548c;&#x76f8;&#x90bb;&#x8303;&#x56f4;&#xff0c;&#x9ed8;&#x8ba4;&#x4e3a; false&#x3002;&#x5f53; true &#x65f6;&#xff0c;&#x8303;&#x56f4;&#x5c06;&#x88ab;&#x7ec4;&#x5408;&#x5e76;&#x8fd4;&#x56de;&#xff0c;&#x5c31;&#x597d;&#x50cf;&#x5b83;&#x4eec;&#x5728;&#x6807;&#x9898;&#x4e2d;&#x4ee5;&#x8fd9;&#x79cd;&#x65b9;&#x5f0f;&#x6307;&#x5b9a;&#x4e00;&#x6837;&#x3002;\n&#x5c06;&#x8fd4;&#x56de;&#x4e00;&#x4e2a;&#x8303;&#x56f4;&#x6570;&#x7ec4;&#x6216;&#x6307;&#x793a;&#x89e3;&#x6790;&#x9519;&#x8bef;&#x7684;&#x8d1f;&#x6570;&#x3002;\n\n-<span class=\"hljs-number\">2</span> &#x8868;&#x793a;&#x683c;&#x5f0f;&#x9519;&#x8bef;&#x7684;&#x6807;&#x5934;&#x5b57;&#x7b26;&#x4e32;\n-<span class=\"hljs-number\">1</span> &#x8868;&#x793a;&#x65e0;&#x6cd5;&#x6ee1;&#x8db3;&#x7684;&#x8303;&#x56f4;\n<span class=\"hljs-regexp\">//</span> parse header from request\nvar range = req.range(<span class=\"hljs-number\">1000</span>)\n\n<span class=\"hljs-regexp\">//</span> the type of the range\n<span class=\"hljs-keyword\">if</span> (range.type === <span class=\"hljs-string\">&apos;bytes&apos;</span>) {\n  <span class=\"hljs-regexp\">//</span> the ranges\n  range.forEach(<span class=\"hljs-keyword\">function</span> (r) {\n    <span class=\"hljs-regexp\">//</span> <span class=\"hljs-keyword\">do</span> something with r.start and r.end\n  })\n}\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1624,1983"}},{"content":"<pre data-lines=\"1984,2015\"><code data-lines=\"1984,2015\">req<span class=\"hljs-selector-class\">.app</span>\nreq<span class=\"hljs-selector-class\">.baseUrl</span>\nreq<span class=\"hljs-selector-class\">.body</span>\nreq<span class=\"hljs-selector-class\">.cookies</span>\nreq<span class=\"hljs-selector-class\">.fresh</span>\nreq<span class=\"hljs-selector-class\">.hostname</span>\nreq<span class=\"hljs-selector-class\">.ip</span>\nreq<span class=\"hljs-selector-class\">.ips</span>\nreq<span class=\"hljs-selector-class\">.method</span>\nreq<span class=\"hljs-selector-class\">.originalUrl</span>\nreq<span class=\"hljs-selector-class\">.params</span>\nreq<span class=\"hljs-selector-class\">.path</span>\nreq<span class=\"hljs-selector-class\">.protocol</span>\nreq<span class=\"hljs-selector-class\">.query</span>\nreq<span class=\"hljs-selector-class\">.res</span>\nreq<span class=\"hljs-selector-class\">.route</span>\nreq<span class=\"hljs-selector-class\">.secure</span>\nreq<span class=\"hljs-selector-class\">.signedCookies</span>\nreq<span class=\"hljs-selector-class\">.stale</span>\nreq<span class=\"hljs-selector-class\">.subdomains</span>\nreq<span class=\"hljs-selector-class\">.xhr</span>\nreq<span class=\"hljs-selector-class\">.accepts</span>(types)\nreq<span class=\"hljs-selector-class\">.acceptsCharsets</span>(charset <span class=\"hljs-selector-attr\">[, ...]</span>)\nreq<span class=\"hljs-selector-class\">.acceptsEncodings</span>(encoding <span class=\"hljs-selector-attr\">[, ...]</span>)\nreq<span class=\"hljs-selector-class\">.acceptsLanguages</span>(lang <span class=\"hljs-selector-attr\">[, ...]</span>)\nreq<span class=\"hljs-selector-class\">.get</span>(field)\nreq<span class=\"hljs-selector-class\">.is</span>(type)\nreq<span class=\"hljs-selector-class\">.param</span>(name <span class=\"hljs-selector-attr\">[, defaultValue]</span>)\nreq<span class=\"hljs-selector-class\">.range</span>(size<span class=\"hljs-selector-attr\">[, options]</span>)\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1984,2015"}}],"payload":{"tag":"h1","lines":"1588,1589"}},{"content":"&#x54cd;&#x5e94;","children":[{"content":"<pre data-lines=\"2018,2045\"><code data-lines=\"2018,2045\">res<span class=\"hljs-selector-class\">.app</span>\nres<span class=\"hljs-selector-class\">.headersSent</span>\nres<span class=\"hljs-selector-class\">.locals</span>\nres<span class=\"hljs-selector-class\">.append</span>(field <span class=\"hljs-selector-attr\">[, value]</span>)\nres<span class=\"hljs-selector-class\">.attachment</span>(<span class=\"hljs-selector-attr\">[filename]</span>)\nres<span class=\"hljs-selector-class\">.cookie</span>(name, value <span class=\"hljs-selector-attr\">[, options]</span>)\nres<span class=\"hljs-selector-class\">.clearCookie</span>(name <span class=\"hljs-selector-attr\">[, options]</span>)\nres<span class=\"hljs-selector-class\">.download</span>(<span class=\"hljs-selector-tag\">path</span> <span class=\"hljs-selector-attr\">[, filename]</span> <span class=\"hljs-selector-attr\">[, options]</span> <span class=\"hljs-selector-attr\">[, fn]</span>)\nres<span class=\"hljs-selector-class\">.end</span>(<span class=\"hljs-selector-attr\">[data]</span> <span class=\"hljs-selector-attr\">[, encoding]</span>)\nres<span class=\"hljs-selector-class\">.format</span>(object)\nres<span class=\"hljs-selector-class\">.get</span>(field)\nres<span class=\"hljs-selector-class\">.json</span>(<span class=\"hljs-selector-attr\">[body]</span>)\nres<span class=\"hljs-selector-class\">.jsonp</span>(<span class=\"hljs-selector-attr\">[body]</span>)\nres<span class=\"hljs-selector-class\">.links</span>(links)\nres<span class=\"hljs-selector-class\">.location</span>(path)\nres<span class=\"hljs-selector-class\">.redirect</span>(<span class=\"hljs-selector-attr\">[status,]</span> path)\nres<span class=\"hljs-selector-class\">.render</span>(view <span class=\"hljs-selector-attr\">[, locals]</span> <span class=\"hljs-selector-attr\">[, callback]</span>)\nres<span class=\"hljs-selector-class\">.req</span>\nres<span class=\"hljs-selector-class\">.send</span>(<span class=\"hljs-selector-attr\">[body]</span>)\nres<span class=\"hljs-selector-class\">.sendFile</span>(<span class=\"hljs-selector-tag\">path</span> <span class=\"hljs-selector-attr\">[, options]</span> <span class=\"hljs-selector-attr\">[, fn]</span>)\nres<span class=\"hljs-selector-class\">.sendStatus</span>(statusCode)\nres<span class=\"hljs-selector-class\">.set</span>(field <span class=\"hljs-selector-attr\">[, value]</span>)\nres<span class=\"hljs-selector-class\">.status</span>(code)\nres<span class=\"hljs-selector-class\">.type</span>(type)\nres<span class=\"hljs-selector-class\">.vary</span>(field)\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2018,2045"}},{"content":"<pre data-lines=\"2046,2492\"><code data-lines=\"2046,2492\">res &#x5bf9;&#x8c61;&#x8868;&#x793a; Express &#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x5728;&#x6536;&#x5230; HTTP &#x8bf7;&#x6c42;&#x65f6;&#x53d1;&#x9001;&#x7684; HTTP &#x54cd;&#x5e94;&#x3002;\n\n&#x5728;&#x672c;&#x6587;&#x6863;&#x4e2d;&#xff0c;&#x6309;&#x7167;&#x60ef;&#x4f8b;&#xff0c;&#x8be5;&#x5bf9;&#x8c61;&#x59cb;&#x7ec8;&#x79f0;&#x4e3a; res&#xff08;HTTP &#x8bf7;&#x6c42;&#x4e3a; req&#xff09;&#xff0c;&#x4f46;&#x5176;&#x5b9e;&#x9645;&#x540d;&#x79f0;&#x7531;&#x60a8;&#x6b63;&#x5728;&#x4f7f;&#x7528;&#x7684;&#x56de;&#x8c03;&#x51fd;&#x6570;&#x7684;&#x53c2;&#x6570;&#x786e;&#x5b9a;&#x3002;\n\n&#x4f8b;&#x5982;&#xff1a;\n\napp.<span class=\"hljs-keyword\">get</span>(<span class=\"hljs-string\">&apos;/user/:id&apos;</span>, <span class=\"hljs-keyword\">function</span> (req, res) {\n  res.send(<span class=\"hljs-string\">&apos;user &apos;</span> + req.params.id)\n})\n&#x4f46;&#x4f60;&#x4e5f;&#x53ef;&#x4ee5;&#x62e5;&#x6709;&#xff1a;\n\napp.<span class=\"hljs-keyword\">get</span>(<span class=\"hljs-string\">&apos;/user/:id&apos;</span>, <span class=\"hljs-keyword\">function</span> (request, response) {\n  response.send(<span class=\"hljs-string\">&apos;user &apos;</span> + request.params.id)\n})\nres&#x5bf9;&#x8c61;&#x662f;Node&#x81ea;&#x5e26;&#x54cd;&#x5e94;&#x5bf9;&#x8c61;&#x7684;&#x589e;&#x5f3a;&#x7248;&#xff0c;&#x652f;&#x6301;&#x6240;&#x6709;&#x5185;&#x7f6e;&#x5b57;&#x6bb5;&#x548c;&#x65b9;&#x6cd5;&#x3002;\n\n res.app&#x4e2d;&#x82f1;\n&#x6b64;&#x5c5e;&#x6027;&#x5305;&#x542b;&#x5bf9;&#x4f7f;&#x7528;&#x4e2d;&#x95f4;&#x4ef6;&#x7684; Express &#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x5b9e;&#x4f8b;&#x7684;&#x5f15;&#x7528;&#x3002;\n\nres.app &#x4e0e;&#x8bf7;&#x6c42;&#x5bf9;&#x8c61;&#x4e2d;&#x7684; req.app &#x5c5e;&#x6027;&#x76f8;&#x540c;&#x3002;\n\n res.headersSent&#x4e2d;&#x82f1;\n&#x6307;&#x793a;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x662f;&#x5426;&#x4e3a;&#x54cd;&#x5e94;&#x53d1;&#x9001; HTTP &#x6807;&#x5934;&#x7684;&#x5e03;&#x5c14;&#x5c5e;&#x6027;&#x3002;\n\napp.<span class=\"hljs-keyword\">get</span>(<span class=\"hljs-string\">&apos;/&apos;</span>, <span class=\"hljs-keyword\">function</span> (req, res) {\n  console.dir(res.headersSent) // <span class=\"hljs-keyword\">false</span>\n  res.send(<span class=\"hljs-string\">&apos;OK&apos;</span>)\n  console.dir(res.headersSent) // <span class=\"hljs-keyword\">true</span>\n})\n res.locals&#x4e2d;&#x82f1;\n&#x4f7f;&#x7528;&#x6b64;&#x5c5e;&#x6027;&#x8bbe;&#x7f6e;&#x5728;&#x4f7f;&#x7528; res.render &#x5448;&#x73b0;&#x7684;&#x6a21;&#x677f;&#x4e2d;&#x53ef;&#x8bbf;&#x95ee;&#x7684;&#x53d8;&#x91cf;&#x3002;res.locals &#x4e0a;&#x8bbe;&#x7f6e;&#x7684;&#x53d8;&#x91cf;&#x5728;&#x5355;&#x4e2a;&#x8bf7;&#x6c42;-&#x54cd;&#x5e94;&#x5468;&#x671f;&#x5185;&#x53ef;&#x7528;&#xff0c;&#x5e76;&#x4e14;&#x4e0d;&#x4f1a;&#x5728;&#x8bf7;&#x6c42;&#x4e4b;&#x95f4;&#x5171;&#x4eab;&#x3002;\n\n&#x4e3a;&#x4e86;&#x4fdd;&#x7559;&#x5c40;&#x90e8;&#x53d8;&#x91cf;&#x4ee5;&#x7528;&#x4e8e;&#x8bf7;&#x6c42;&#x4e4b;&#x95f4;&#x7684;&#x6a21;&#x677f;&#x6e32;&#x67d3;&#xff0c;&#x8bf7;&#x6539;&#x7528; app.locals&#x3002;\n\n&#x6b64;&#x5c5e;&#x6027;&#x5bf9;&#x4e8e;&#x5411;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x4e2d;&#x5448;&#x73b0;&#x7684;&#x6a21;&#x677f;&#x516c;&#x5f00;&#x8bf7;&#x6c42;&#x7ea7;&#x4fe1;&#x606f;&#xff08;&#x4f8b;&#x5982;&#x8bf7;&#x6c42;&#x8def;&#x5f84;&#x540d;&#x79f0;&#x3001;&#x7ecf;&#x8fc7;&#x8eab;&#x4efd;&#x9a8c;&#x8bc1;&#x7684;&#x7528;&#x6237;&#x3001;&#x7528;&#x6237;&#x8bbe;&#x7f6e;&#x7b49;&#xff09;&#x5f88;&#x6709;&#x7528;&#x3002;\n\napp.use(<span class=\"hljs-keyword\">function</span> (req, res, next) {\n  // Make `<span class=\"hljs-keyword\">user</span>` <span class=\"hljs-keyword\">and</span> `authenticated` available <span class=\"hljs-keyword\">in</span> templates\n  res.locals.<span class=\"hljs-keyword\">user</span> = req.<span class=\"hljs-keyword\">user</span>\n  res.locals.authenticated = !req.<span class=\"hljs-keyword\">user</span>.anonymous\n  next()\n})\n res.append(field [, <span class=\"hljs-keyword\">value</span>])&#x4e2d;&#x82f1;\nExpress v4<span class=\"hljs-number\">.11</span><span class=\"hljs-number\">.0</span>+ &#x652f;&#x6301; res.append()\n\n&#x5c06;&#x6307;&#x5b9a;&#x7684; <span class=\"hljs-keyword\">value</span> &#x9644;&#x52a0;&#x5230; HTTP &#x54cd;&#x5e94;&#x6807;&#x5934; field&#x3002;&#x5982;&#x679c;&#x5c1a;&#x672a;&#x8bbe;&#x7f6e;&#x6807;&#x5934;&#xff0c;&#x5219;&#x4f1a;&#x521b;&#x5efa;&#x5177;&#x6709;&#x6307;&#x5b9a;&#x503c;&#x7684;&#x6807;&#x5934;&#x3002;<span class=\"hljs-keyword\">value</span> &#x53c2;&#x6570;&#x53ef;&#x4ee5;&#x662f;&#x5b57;&#x7b26;&#x4e32;&#x6216;&#x6570;&#x7ec4;&#x3002;\n\n&#x6ce8;&#x610f;&#xff1a;&#x5728; res.append() &#x4e4b;&#x540e;&#x8c03;&#x7528; res.<span class=\"hljs-keyword\">set</span>() &#x4f1a;&#x91cd;&#x7f6e;&#x4e4b;&#x524d;&#x8bbe;&#x7f6e;&#x7684; <span class=\"hljs-keyword\">header</span> &#x503c;&#x3002;\n\nres.append(<span class=\"hljs-string\">&apos;Link&apos;</span>, [<span class=\"hljs-string\">&apos;&lt;http://localhost/&gt;&apos;</span>, <span class=\"hljs-string\">&apos;&lt;http://localhost:3000/&gt;&apos;</span>])\nres.append(<span class=\"hljs-string\">&apos;Set-Cookie&apos;</span>, <span class=\"hljs-string\">&apos;foo=bar; Path=/; HttpOnly&apos;</span>)\nres.append(<span class=\"hljs-string\">&apos;Warning&apos;</span>, <span class=\"hljs-string\">&apos;199 Miscellaneous warning&apos;</span>)\n res.attachment([filename])&#x4e2d;&#x82f1;\n&#x5c06; HTTP &#x54cd;&#x5e94; Content-Disposition &#x6807;&#x5934;&#x5b57;&#x6bb5;&#x8bbe;&#x7f6e;&#x4e3a; &quot;attachment&quot;&#x3002;&#x5982;&#x679c;&#x7ed9;&#x51fa;&#x4e86; filename&#xff0c;&#x90a3;&#x4e48;&#x5b83;&#x4f1a;&#x6839;&#x636e;&#x6269;&#x5c55;&#x540d;&#x901a;&#x8fc7; res.<span class=\"hljs-keyword\">type</span>() &#x8bbe;&#x7f6e; Content-<span class=\"hljs-keyword\">Type</span>&#xff0c;&#x5e76;&#x8bbe;&#x7f6e; Content-Disposition &quot;filename=&quot; &#x53c2;&#x6570;&#x3002;\n\nres.attachment()\n// Content-Disposition: attachment\n\nres.attachment(<span class=\"hljs-string\">&apos;path/to/logo.png&apos;</span>)\n// Content-Disposition: attachment; filename=&quot;logo.png&quot;\n// Content-<span class=\"hljs-keyword\">Type</span>: image/png\n res.cookie(<span class=\"hljs-type\">name</span>, <span class=\"hljs-keyword\">value</span> [, <span class=\"hljs-keyword\">options</span>])&#x4e2d;&#x82f1;\n&#x5c06; cookie <span class=\"hljs-type\">name</span> &#x8bbe;&#x7f6e;&#x4e3a; <span class=\"hljs-keyword\">value</span>&#x3002;<span class=\"hljs-keyword\">value</span> &#x53c2;&#x6570;&#x53ef;&#x4ee5;&#x662f;&#x5b57;&#x7b26;&#x4e32;&#x6216;&#x8f6c;&#x6362;&#x4e3a; <span class=\"hljs-type\">JSON</span> &#x7684;&#x5bf9;&#x8c61;&#x3002;\n\n<span class=\"hljs-keyword\">options</span> &#x53c2;&#x6570;&#x662f;&#x4e00;&#x4e2a;&#x53ef;&#x4ee5;&#x5177;&#x6709;&#x4ee5;&#x4e0b;&#x5c5e;&#x6027;&#x7684;&#x5bf9;&#x8c61;&#x3002;\n\n&#x5c5e;&#x6027;\t&#x7c7b;&#x578b;\t&#x63cf;&#x8ff0;\n<span class=\"hljs-keyword\">domain</span>\t&#x5b57;&#x7b26;&#x4e32;\tcookie &#x7684;&#x57df;&#x540d;&#x3002;&#x9ed8;&#x8ba4;&#x4e3a;&#x5e94;&#x7528;&#x7684;&#x57df;&#x540d;&#x3002;\nencode\t&#x51fd;&#x6570;\t&#x7528;&#x4e8e; cookie &#x503c;&#x7f16;&#x7801;&#x7684;&#x540c;&#x6b65;&#x51fd;&#x6570;&#x3002;&#x9ed8;&#x8ba4;&#x4e3a; encodeURIComponent&#x3002;\nexpires\t&#x65e5;&#x671f;\t&#x683c;&#x6797;&#x5a01;&#x6cbb;&#x6807;&#x51c6;&#x65f6;&#x95f4; cookie &#x7684;&#x5230;&#x671f;&#x65e5;&#x671f;&#x3002;&#x5982;&#x679c;&#x672a;&#x6307;&#x5b9a;&#x6216;&#x8bbe;&#x7f6e;&#x4e3a; <span class=\"hljs-number\">0</span>&#xff0c;&#x5219;&#x521b;&#x5efa;&#x4f1a;&#x8bdd; cookie&#x3002;\nhttpOnly\t&#x5e03;&#x5c14;&#x503c;\t&#x5c06; cookie &#x6807;&#x8bb0;&#x4e3a;&#x53ea;&#x80fd;&#x7531; Web &#x670d;&#x52a1;&#x5668;&#x8bbf;&#x95ee;&#x3002;\nmaxAge\t&#x6570;&#x5b57;\t&#x65b9;&#x4fbf;&#x7684;&#x9009;&#x9879;&#xff0c;&#x7528;&#x4e8e;&#x8bbe;&#x7f6e;&#x76f8;&#x5bf9;&#x4e8e;&#x5f53;&#x524d;&#x65f6;&#x95f4;&#x7684;&#x5230;&#x671f;&#x65f6;&#x95f4;&#xff08;&#x4ee5;&#x6beb;&#x79d2;&#x4e3a;&#x5355;&#x4f4d;&#xff09;&#x3002;\n<span class=\"hljs-type\">path</span>\t&#x5b57;&#x7b26;&#x4e32;\tcookie &#x7684;&#x8def;&#x5f84;&#x3002;&#x9ed8;&#x8ba4;&#x4e3a; &quot;/&quot;&#x3002;\npriority\t&#x5b57;&#x7b26;&#x4e32;\t&quot;Priority&quot; <span class=\"hljs-keyword\">Set</span>-Cookie &#x5c5e;&#x6027;&#x7684;&#x503c;&#x3002;\nsecure\t&#x5e03;&#x5c14;&#x503c;\t&#x5c06; cookie &#x6807;&#x8bb0;&#x4e3a;&#x4ec5;&#x4e0e; HTTPS &#x4e00;&#x8d77;&#x4f7f;&#x7528;&#x3002;\nsigned\t&#x5e03;&#x5c14;&#x503c;\t&#x6307;&#x793a;&#x662f;&#x5426;&#x5e94;&#x8be5;&#x5bf9; cookie &#x8fdb;&#x884c;&#x7b7e;&#x540d;&#x3002;\nsameSite\t&#x5e03;&#x5c14;&#x503c;&#x6216;&#x5b57;&#x7b26;&#x4e32;\t&quot;SameSite&quot; <span class=\"hljs-keyword\">Set</span>-Cookie &#x5c5e;&#x6027;&#x7684;&#x503c;&#x3002;&#x66f4;&#x591a;&#x4fe1;&#x606f;&#x8bf7;&#x53c2;&#x89c1; https://tools.ietf.org/html/draft-ietf-httpbis-cookie-same-site<span class=\"hljs-number\">-00</span>#section<span class=\"hljs-number\">-4.1</span><span class=\"hljs-number\">.1</span>&#x3002;\nres.cookie() &#x6240;&#x505a;&#x7684;&#x53ea;&#x662f;&#x4f7f;&#x7528;&#x63d0;&#x4f9b;&#x7684;&#x9009;&#x9879;&#x8bbe;&#x7f6e; HTTP <span class=\"hljs-keyword\">Set</span>-Cookie &#x6807;&#x5934;&#x3002;&#x4efb;&#x4f55;&#x672a;&#x6307;&#x5b9a;&#x7684;&#x9009;&#x9879;&#x9ed8;&#x8ba4;&#x4e3a; RFC <span class=\"hljs-number\">6265</span> &#x4e2d;&#x89c4;&#x5b9a;&#x7684;&#x503c;&#x3002;\n\n&#x4f8b;&#x5982;&#xff1a;\n\nres.cookie(<span class=\"hljs-string\">&apos;name&apos;</span>, <span class=\"hljs-string\">&apos;tobi&apos;</span>, { <span class=\"hljs-keyword\">domain</span>: <span class=\"hljs-string\">&apos;.example.com&apos;</span>, <span class=\"hljs-type\">path</span>: <span class=\"hljs-string\">&apos;/admin&apos;</span>, secure: <span class=\"hljs-keyword\">true</span> })\nres.cookie(<span class=\"hljs-string\">&apos;rememberme&apos;</span>, <span class=\"hljs-string\">&apos;1&apos;</span>, { expires: <span class=\"hljs-built_in\">new</span> <span class=\"hljs-type\">Date</span>(<span class=\"hljs-type\">Date</span>.now() + <span class=\"hljs-number\">900000</span>), httpOnly: <span class=\"hljs-keyword\">true</span> })\n&#x60a8;&#x53ef;&#x4ee5;&#x901a;&#x8fc7;&#x591a;&#x6b21;&#x8c03;&#x7528; res.cookie &#x5728;&#x5355;&#x4e2a;&#x54cd;&#x5e94;&#x4e2d;&#x8bbe;&#x7f6e;&#x591a;&#x4e2a; cookie&#xff0c;&#x4f8b;&#x5982;&#xff1a;\n\nres\n  .status(<span class=\"hljs-number\">201</span>)\n  .cookie(<span class=\"hljs-string\">&apos;access_token&apos;</span>, <span class=\"hljs-string\">&apos;Bearer &apos;</span> + token, {\n    expires: <span class=\"hljs-built_in\">new</span> <span class=\"hljs-type\">Date</span>(<span class=\"hljs-type\">Date</span>.now() + <span class=\"hljs-number\">8</span> * <span class=\"hljs-number\">3600000</span>) // cookie will be removed <span class=\"hljs-keyword\">after</span> <span class=\"hljs-number\">8</span> hours\n  })\n  .cookie(<span class=\"hljs-string\">&apos;test&apos;</span>, <span class=\"hljs-string\">&apos;test&apos;</span>)\n  .redirect(<span class=\"hljs-number\">301</span>, <span class=\"hljs-string\">&apos;/admin&apos;</span>)\nencode &#x9009;&#x9879;&#x5141;&#x8bb8;&#x60a8;&#x9009;&#x62e9;&#x7528;&#x4e8e; cookie &#x503c;&#x7f16;&#x7801;&#x7684;&#x51fd;&#x6570;&#x3002;&#x4e0d;&#x652f;&#x6301;&#x5f02;&#x6b65;&#x51fd;&#x6570;&#x3002;\n\n&#x793a;&#x4f8b;&#x7528;&#x4f8b;&#xff1a;&#x60a8;&#x9700;&#x8981;&#x4e3a;&#x7ec4;&#x7ec7;&#x4e2d;&#x7684;&#x53e6;&#x4e00;&#x4e2a;&#x7ad9;&#x70b9;&#x8bbe;&#x7f6e;&#x57df;&#x8303;&#x56f4;&#x7684; cookie&#x3002;&#x6b64;&#x5176;&#x4ed6;&#x7ad9;&#x70b9;&#xff08;&#x4e0d;&#x53d7;&#x60a8;&#x7684;&#x7ba1;&#x7406;&#x63a7;&#x5236;&#xff09;&#x4e0d;&#x4f7f;&#x7528; URI &#x7f16;&#x7801;&#x7684; cookie &#x503c;&#x3002;\n\n// <span class=\"hljs-keyword\">Default</span> <span class=\"hljs-keyword\">encoding</span>\nres.cookie(<span class=\"hljs-string\">&apos;some_cross_domain_cookie&apos;</span>, <span class=\"hljs-string\">&apos;http://mysubdomain.example.com&apos;</span>, { <span class=\"hljs-keyword\">domain</span>: <span class=\"hljs-string\">&apos;example.com&apos;</span> })\n// Result: <span class=\"hljs-string\">&apos;some_cross_domain_cookie=http%3A%2F%2Fmysubdomain.example.com; Domain=example.com; Path=/&apos;</span>\n\n// Custom <span class=\"hljs-keyword\">encoding</span>\nres.cookie(<span class=\"hljs-string\">&apos;some_cross_domain_cookie&apos;</span>, <span class=\"hljs-string\">&apos;http://mysubdomain.example.com&apos;</span>, { <span class=\"hljs-keyword\">domain</span>: <span class=\"hljs-string\">&apos;example.com&apos;</span>, encode: String })\n// Result: <span class=\"hljs-string\">&apos;some_cross_domain_cookie=http://mysubdomain.example.com; Domain=example.com; Path=/;&apos;</span>\nmaxAge &#x9009;&#x9879;&#x662f;&#x4e00;&#x4e2a;&#x65b9;&#x4fbf;&#x7684;&#x9009;&#x9879;&#xff0c;&#x7528;&#x4e8e;&#x8bbe;&#x7f6e; &quot;expires&quot; &#x76f8;&#x5bf9;&#x4e8e;&#x5f53;&#x524d;&#x65f6;&#x95f4;&#xff08;&#x4ee5;&#x6beb;&#x79d2;&#x4e3a;&#x5355;&#x4f4d;&#xff09;&#x3002;&#x4ee5;&#x4e0b;&#x7b49;&#x6548;&#x4e8e;&#x4e0a;&#x9762;&#x7684;&#x7b2c;&#x4e8c;&#x4e2a;&#x793a;&#x4f8b;&#x3002;\n\nres.cookie(<span class=\"hljs-string\">&apos;rememberme&apos;</span>, <span class=\"hljs-string\">&apos;1&apos;</span>, { maxAge: <span class=\"hljs-number\">900000</span>, httpOnly: <span class=\"hljs-keyword\">true</span> })\n&#x60a8;&#x53ef;&#x4ee5;&#x5c06;&#x5bf9;&#x8c61;&#x4f5c;&#x4e3a; <span class=\"hljs-keyword\">value</span> &#x53c2;&#x6570;&#x4f20;&#x9012;&#xff1b;&#x7136;&#x540e;&#x5c06;&#x5176;&#x5e8f;&#x5217;&#x5316;&#x4e3a; <span class=\"hljs-type\">JSON</span> &#x5e76;&#x7531; bodyParser() &#x4e2d;&#x95f4;&#x4ef6;&#x89e3;&#x6790;&#x3002;\n\nres.cookie(<span class=\"hljs-string\">&apos;cart&apos;</span>, { items: [<span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">3</span>] })\nres.cookie(<span class=\"hljs-string\">&apos;cart&apos;</span>, { items: [<span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">3</span>] }, { maxAge: <span class=\"hljs-number\">900000</span> })\n&#x4f7f;&#x7528; cookie-<span class=\"hljs-keyword\">parser</span> &#x4e2d;&#x95f4;&#x4ef6;&#x65f6;&#xff0c;&#x6b64;&#x65b9;&#x6cd5;&#x8fd8;&#x652f;&#x6301;&#x7b7e;&#x540d; cookie&#x3002;&#x53ea;&#x9700;&#x5c06; signed &#x9009;&#x9879;&#x8bbe;&#x7f6e;&#x4e3a; <span class=\"hljs-keyword\">true</span>&#x3002;&#x7136;&#x540e; res.cookie() &#x5c06;&#x4f7f;&#x7528;&#x4f20;&#x9012;&#x7ed9; cookieParser(secret) &#x7684;&#x79d8;&#x5bc6;&#x5bf9;&#x503c;&#x8fdb;&#x884c;&#x7b7e;&#x540d;&#x3002;\n\nres.cookie(<span class=\"hljs-string\">&apos;name&apos;</span>, <span class=\"hljs-string\">&apos;tobi&apos;</span>, { signed: <span class=\"hljs-keyword\">true</span> })\n&#x7a0d;&#x540e;&#x60a8;&#x53ef;&#x4ee5;&#x901a;&#x8fc7; req.signedCookie &#x5bf9;&#x8c61;&#x8bbf;&#x95ee;&#x6b64;&#x503c;&#x3002;\n\n res.clearCookie(<span class=\"hljs-type\">name</span> [, <span class=\"hljs-keyword\">options</span>])&#x4e2d;&#x82f1;\n&#x6e05;&#x9664; <span class=\"hljs-type\">name</span> &#x6307;&#x5b9a;&#x7684; cookie&#x3002;&#x5173;&#x4e8e; <span class=\"hljs-keyword\">options</span> &#x5bf9;&#x8c61;&#x7684;&#x8be6;&#x7ec6;&#x4fe1;&#x606f;&#xff0c;&#x8bf7;&#x53c2;&#x89c1; res.cookie()&#x3002;\n\nWeb &#x6d4f;&#x89c8;&#x5668;&#x548c;&#x5176;&#x4ed6;&#x517c;&#x5bb9;&#x7684;&#x5ba2;&#x6237;&#x7aef;&#x53ea;&#x4f1a;&#x5728;&#x7ed9;&#x5b9a;&#x7684; <span class=\"hljs-keyword\">options</span> &#x4e0e;&#x7ed9;&#x5b9a;&#x7ed9; res.cookie() &#x7684;&#x76f8;&#x540c;&#xff08;&#x4e0d;&#x5305;&#x62ec; expires &#x548c; maxAge&#xff09;&#x65f6;&#x6e05;&#x9664; cookie&#x3002;\n\nres.cookie(<span class=\"hljs-string\">&apos;name&apos;</span>, <span class=\"hljs-string\">&apos;tobi&apos;</span>, { <span class=\"hljs-type\">path</span>: <span class=\"hljs-string\">&apos;/admin&apos;</span> })\nres.clearCookie(<span class=\"hljs-string\">&apos;name&apos;</span>, { <span class=\"hljs-type\">path</span>: <span class=\"hljs-string\">&apos;/admin&apos;</span> })\n res.download(<span class=\"hljs-type\">path</span> [, filename] [, <span class=\"hljs-keyword\">options</span>] [, fn])&#x4e2d;&#x82f1;\n&#x5c06; <span class=\"hljs-type\">path</span> &#x5904;&#x7684;&#x6587;&#x4ef6;&#x4f5c;&#x4e3a; &quot;attachment&quot; &#x4f20;&#x8f93;&#x3002;&#x901a;&#x5e38;&#xff0c;&#x6d4f;&#x89c8;&#x5668;&#x4f1a;&#x63d0;&#x793a;&#x7528;&#x6237;&#x4e0b;&#x8f7d;&#x3002;&#x9ed8;&#x8ba4;&#x60c5;&#x51b5;&#x4e0b;&#xff0c;Content-Disposition &#x6807;&#x5934; &quot;filename=&quot; &#x53c2;&#x6570;&#x6d3e;&#x751f;&#x81ea; <span class=\"hljs-type\">path</span> &#x53c2;&#x6570;&#xff0c;&#x4f46;&#x53ef;&#x4ee5;&#x7528; filename &#x53c2;&#x6570;&#x8986;&#x76d6;&#x3002;&#x5982;&#x679c; <span class=\"hljs-type\">path</span> &#x662f;&#x76f8;&#x5bf9;&#x7684;&#xff0c;&#x90a3;&#x4e48;&#x5b83;&#x5c06;&#x57fa;&#x4e8e;&#x8fdb;&#x7a0b;&#x7684;&#x5f53;&#x524d;&#x5de5;&#x4f5c;&#x76ee;&#x5f55;&#x6216; root &#x9009;&#x9879;&#xff08;&#x5982;&#x679c;&#x63d0;&#x4f9b;&#xff09;&#x3002;\n\n&#x6b64; API &#x63d0;&#x4f9b;&#x5bf9;&#x6b63;&#x5728;&#x8fd0;&#x884c;&#x7684;&#x6587;&#x4ef6;&#x7cfb;&#x7edf;&#x4e0a;&#x7684;&#x6570;&#x636e;&#x7684;&#x8bbf;&#x95ee;&#x3002;&#x786e;&#x4fdd; (a) &#x6784;&#x5efa; <span class=\"hljs-type\">path</span> &#x53c2;&#x6570;&#x7684;&#x65b9;&#x5f0f;&#x5728;&#x5305;&#x542b;&#x7528;&#x6237;&#x8f93;&#x5165;&#x7684;&#x60c5;&#x51b5;&#x4e0b;&#x662f;&#x5b89;&#x5168;&#x7684;&#xff0c;&#x6216;&#x8005; (b) &#x5c06; root &#x9009;&#x9879;&#x8bbe;&#x7f6e;&#x4e3a;&#x76ee;&#x5f55;&#x7684;&#x7edd;&#x5bf9;&#x8def;&#x5f84;&#x4ee5;&#x5305;&#x542b;&#x8bbf;&#x95ee;&#x6743;&#x9650;&#x3002;\n\n&#x5f53;&#x63d0;&#x4f9b; root &#x9009;&#x9879;&#x65f6;&#xff0c;Express &#x5c06;&#x9a8c;&#x8bc1;&#x4f5c;&#x4e3a; <span class=\"hljs-type\">path</span> &#x63d0;&#x4f9b;&#x7684;&#x76f8;&#x5bf9;&#x8def;&#x5f84;&#x5c06;&#x5728;&#x7ed9;&#x5b9a;&#x7684; root &#x9009;&#x9879;&#x4e2d;&#x89e3;&#x6790;&#x3002;\n\n&#x4e0b;&#x8868;&#x63d0;&#x4f9b;&#x4e86;&#x6709;&#x5173; <span class=\"hljs-keyword\">options</span> &#x53c2;&#x6570;&#x7684;&#x8be6;&#x7ec6;&#x4fe1;&#x606f;&#x3002;\n\nExpress v4<span class=\"hljs-number\">.16</span><span class=\"hljs-number\">.0</span> &#x53ca;&#x66f4;&#x9ad8;&#x7248;&#x672c;&#x652f;&#x6301;&#x53ef;&#x9009;&#x7684; <span class=\"hljs-keyword\">options</span> &#x53c2;&#x6570;&#x3002;\n\n&#x5c5e;&#x6027;\t&#x63cf;&#x8ff0;\t&#x9ed8;&#x8ba4;\t&#x53ef;&#x7528;&#x6027;\nmaxAge\t&#x8bbe;&#x7f6e; <span class=\"hljs-keyword\">Cache</span>-Control &#x6807;&#x5934;&#x7684; max-age &#x5c5e;&#x6027;&#xff08;&#x4ee5;&#x6beb;&#x79d2;&#x4e3a;&#x5355;&#x4f4d;&#xff09;&#x6216; ms &#x683c;&#x5f0f; &#x4e2d;&#x7684;&#x5b57;&#x7b26;&#x4e32;\t<span class=\"hljs-number\">0</span>\t<span class=\"hljs-number\">4.16</span>+\nroot\t&#x76f8;&#x5bf9;&#x6587;&#x4ef6;&#x540d;&#x7684;&#x6839;&#x76ee;&#x5f55;&#x3002;\t\t<span class=\"hljs-number\">4.18</span>+\nlastModified\t&#x5c06; Last-Modified &#x6807;&#x5934;&#x8bbe;&#x7f6e;&#x4e3a;&#x64cd;&#x4f5c;&#x7cfb;&#x7edf;&#x4e0a;&#x6587;&#x4ef6;&#x7684;&#x6700;&#x540e;&#x4fee;&#x6539;&#x65e5;&#x671f;&#x3002;&#x8bbe;&#x7f6e; <span class=\"hljs-keyword\">false</span> &#x4ee5;&#x7981;&#x7528;&#x5b83;&#x3002;\t&#x542f;&#x7528;\t<span class=\"hljs-number\">4.16</span>+\nheaders\t&#x5305;&#x542b;&#x4e0e;&#x6587;&#x4ef6;&#x4e00;&#x8d77;&#x670d;&#x52a1;&#x7684; HTTP &#x6807;&#x5934;&#x7684;&#x5bf9;&#x8c61;&#x3002;&#x6807;&#x9898; Content-Disposition &#x5c06;&#x88ab; filename &#x53c2;&#x6570;&#x8986;&#x76d6;&#x3002;\t\t<span class=\"hljs-number\">4.16</span>+\ndotfiles\t&#x63d0;&#x4f9b;&#x70b9;&#x6587;&#x4ef6;&#x7684;&#x9009;&#x9879;&#x3002;&#x53ef;&#x80fd;&#x7684;&#x503c;&#x4e3a; &quot;allow&quot;&#x3001;&quot;deny&quot;&#x3001;&quot;ignore&quot;&#x3002;\t&quot;ignore&quot;\t<span class=\"hljs-number\">4.16</span>+\nacceptRanges\t&#x542f;&#x7528;&#x6216;&#x7981;&#x7528;&#x63a5;&#x53d7;&#x8303;&#x56f4;&#x8bf7;&#x6c42;&#x3002;\t<span class=\"hljs-keyword\">true</span>\t<span class=\"hljs-number\">4.16</span>+\ncacheControl\t&#x542f;&#x7528;&#x6216;&#x7981;&#x7528;&#x8bbe;&#x7f6e; <span class=\"hljs-keyword\">Cache</span>-Control &#x54cd;&#x5e94;&#x6807;&#x5934;&#x3002;\ttrue\t<span class=\"hljs-number\">4.16</span>+\n<span class=\"hljs-keyword\">immutable</span>\t&#x5728; <span class=\"hljs-keyword\">Cache</span>-Control &#x54cd;&#x5e94;&#x6807;&#x5934;&#x4e2d;&#x542f;&#x7528;&#x6216;&#x7981;&#x7528; immutable &#x6307;&#x4ee4;&#x3002;&#x5982;&#x679c;&#x542f;&#x7528;&#xff0c;&#x8fd8;&#x5e94;&#x6307;&#x5b9a; maxAge &#x9009;&#x9879;&#x4ee5;&#x542f;&#x7528;&#x7f13;&#x5b58;&#x3002;immutable &#x6307;&#x4ee4;&#x5c06;&#x963b;&#x6b62;&#x53d7;&#x652f;&#x6301;&#x7684;&#x5ba2;&#x6237;&#x7aef;&#x5728; maxAge &#x9009;&#x9879;&#x7684;&#x751f;&#x547d;&#x5468;&#x671f;&#x5185;&#x53d1;&#x51fa;&#x6761;&#x4ef6;&#x8bf7;&#x6c42;&#x4ee5;&#x68c0;&#x67e5;&#x6587;&#x4ef6;&#x662f;&#x5426;&#x5df2;&#x66f4;&#x6539;&#x3002;\tfalse\t<span class=\"hljs-number\">4.16</span>+\n&#x8be5;&#x65b9;&#x6cd5;&#x5728;&#x4f20;&#x8f93;&#x5b8c;&#x6210;&#x6216;&#x53d1;&#x751f;&#x9519;&#x8bef;&#x65f6;&#x8c03;&#x7528;&#x56de;&#x8c03;&#x51fd;&#x6570; fn(err)&#x3002;&#x5982;&#x679c;&#x6307;&#x5b9a;&#x4e86;&#x56de;&#x8c03;&#x51fd;&#x6570;&#x5e76;&#x4e14;&#x53d1;&#x751f;&#x9519;&#x8bef;&#xff0c;&#x5219;&#x56de;&#x8c03;&#x51fd;&#x6570;&#x5fc5;&#x987b;&#x901a;&#x8fc7;&#x7ed3;&#x675f;&#x8bf7;&#x6c42;-&#x54cd;&#x5e94;&#x5faa;&#x73af;&#x6216;&#x5c06;&#x63a7;&#x5236;&#x6743;&#x4f20;&#x9012;&#x7ed9;&#x4e0b;&#x4e00;&#x4e2a;&#x8def;&#x7531;&#x6765;&#x663e;&#x5f0f;&#x5904;&#x7406;&#x54cd;&#x5e94;&#x8fc7;&#x7a0b;&#x3002;\n\nres.download(<span class=\"hljs-string\">&apos;/report-12345.pdf&apos;</span>)\n\nres.download(<span class=\"hljs-string\">&apos;/report-12345.pdf&apos;</span>, <span class=\"hljs-string\">&apos;report.pdf&apos;</span>)\n\nres.download(<span class=\"hljs-string\">&apos;/report-12345.pdf&apos;</span>, <span class=\"hljs-string\">&apos;report.pdf&apos;</span>, <span class=\"hljs-keyword\">function</span> (err) {\n  <span class=\"hljs-keyword\">if</span> (err) {\n    // Handle error, but keep <span class=\"hljs-keyword\">in</span> mind the response may be partially-sent\n    // so <span class=\"hljs-keyword\">check</span> res.headersSent\n  } <span class=\"hljs-keyword\">else</span> {\n    // decrement a download credit, etc.\n  }\n})\n res.<span class=\"hljs-keyword\">end</span>([data] [, <span class=\"hljs-keyword\">encoding</span>])&#x4e2d;&#x82f1;\n&#x7ed3;&#x675f;&#x54cd;&#x5e94;&#x8fc7;&#x7a0b;&#x3002;&#x8fd9;&#x4e2a;&#x65b9;&#x6cd5;&#x5b9e;&#x9645;&#x4e0a;&#x6765;&#x81ea; Node &#x6838;&#x5fc3;&#xff0c;&#x7279;&#x522b;&#x662f; http.ServerResponse &#x7684; response.<span class=\"hljs-keyword\">end</span>() &#x65b9;&#x6cd5;&#x3002;\n\n&#x7528;&#x4e8e;&#x5728;&#x6ca1;&#x6709;&#x4efb;&#x4f55;&#x6570;&#x636e;&#x7684;&#x60c5;&#x51b5;&#x4e0b;&#x5feb;&#x901f;&#x7ed3;&#x675f;&#x54cd;&#x5e94;&#x3002;&#x5982;&#x679c;&#x60a8;&#x9700;&#x8981;&#x7528;&#x6570;&#x636e;&#x54cd;&#x5e94;&#xff0c;&#x8bf7;&#x6539;&#x7528; res.send() &#x548c; res.json() &#x7b49;&#x65b9;&#x6cd5;&#x3002;\n\nres.<span class=\"hljs-keyword\">end</span>()\nres.status(<span class=\"hljs-number\">404</span>).<span class=\"hljs-keyword\">end</span>()\n res.format(<span class=\"hljs-keyword\">object</span>)&#x4e2d;&#x82f1;\n&#x5bf9;&#x8bf7;&#x6c42;&#x5bf9;&#x8c61;&#x7684; Accept HTTP &#x6807;&#x5934;&#xff08;&#x5982;&#x679c;&#x5b58;&#x5728;&#xff09;&#x6267;&#x884c;&#x5185;&#x5bb9;&#x534f;&#x5546;&#x3002;&#x5b83;&#x4f7f;&#x7528; req.accepts() &#x6839;&#x636e;&#x8d28;&#x91cf;&#x503c;&#x6392;&#x5e8f;&#x7684;&#x53ef;&#x63a5;&#x53d7;&#x7c7b;&#x578b;&#x4e3a;&#x8bf7;&#x6c42;&#x9009;&#x62e9;&#x5904;&#x7406;&#x7a0b;&#x5e8f;&#x3002;&#x5982;&#x679c;&#x672a;&#x6307;&#x5b9a;&#x6807;&#x5934;&#xff0c;&#x5219;&#x8c03;&#x7528;&#x7b2c;&#x4e00;&#x4e2a;&#x56de;&#x8c03;&#x3002;&#x5f53;&#x6ca1;&#x6709;&#x627e;&#x5230;&#x5339;&#x914d;&#x65f6;&#xff0c;&#x670d;&#x52a1;&#x5668;&#x54cd;&#x5e94; <span class=\"hljs-number\">406</span> &quot;Not Acceptable&quot;&#xff0c;&#x6216;&#x8005;&#x8c03;&#x7528; <span class=\"hljs-keyword\">default</span> &#x56de;&#x8c03;&#x3002;\n\n&#x9009;&#x62e9;&#x56de;&#x8c03;&#x65f6;&#x8bbe;&#x7f6e; Content-<span class=\"hljs-keyword\">Type</span> &#x54cd;&#x5e94;&#x6807;&#x5934;&#x3002;&#x4f46;&#x662f;&#xff0c;&#x60a8;&#x53ef;&#x4ee5;&#x4f7f;&#x7528; res.<span class=\"hljs-keyword\">set</span>() &#x6216; res.<span class=\"hljs-keyword\">type</span>() &#x7b49;&#x65b9;&#x6cd5;&#x5728;&#x56de;&#x8c03;&#x4e2d;&#x66f4;&#x6539;&#x5b83;&#x3002;\n\n&#x5f53; Accept &#x5934;&#x5b57;&#x6bb5;&#x8bbe;&#x7f6e;&#x4e3a; &quot;application/json&quot; &#x6216; &quot;*/json&quot; &#x65f6;&#xff0c;&#x4ee5;&#x4e0b;&#x793a;&#x4f8b;&#x5c06;&#x54cd;&#x5e94; { &quot;message&quot;: &quot;hey&quot; }&#xff08;&#x4f46;&#x662f;&#x5982;&#x679c;&#x5b83;&#x662f; &quot;*/*&quot;&#xff0c;&#x5219;&#x54cd;&#x5e94;&#x5c06;&#x4e3a; &quot;hey&quot;&#xff09;&#x3002;\n\nres.format({\n  <span class=\"hljs-string\">&apos;text/plain&apos;</span>: <span class=\"hljs-keyword\">function</span> () {\n    res.send(<span class=\"hljs-string\">&apos;hey&apos;</span>)\n  },\n\n  <span class=\"hljs-string\">&apos;text/html&apos;</span>: <span class=\"hljs-keyword\">function</span> () {\n    res.send(<span class=\"hljs-string\">&apos;&lt;p&gt;hey&lt;/p&gt;&apos;</span>)\n  },\n\n  <span class=\"hljs-string\">&apos;application/json&apos;</span>: <span class=\"hljs-keyword\">function</span> () {\n    res.send({ message: <span class=\"hljs-string\">&apos;hey&apos;</span> })\n  },\n\n  <span class=\"hljs-keyword\">default</span>: <span class=\"hljs-keyword\">function</span> () {\n    // <span class=\"hljs-keyword\">log</span> the request <span class=\"hljs-keyword\">and</span> respond <span class=\"hljs-keyword\">with</span> <span class=\"hljs-number\">406</span>\n    res.status(<span class=\"hljs-number\">406</span>).send(<span class=\"hljs-string\">&apos;Not Acceptable&apos;</span>)\n  }\n})\n&#x9664;&#x4e86;&#x89c4;&#x8303;&#x5316;&#x7684; MIME &#x7c7b;&#x578b;&#x4e4b;&#x5916;&#xff0c;&#x60a8;&#x8fd8;&#x53ef;&#x4ee5;&#x4f7f;&#x7528;&#x6620;&#x5c04;&#x5230;&#x8fd9;&#x4e9b;&#x7c7b;&#x578b;&#x7684;&#x6269;&#x5c55;&#x540d;&#x6765;&#x5b9e;&#x73b0;&#x7a0d;&#x5fae;&#x4e0d;&#x90a3;&#x4e48;&#x5197;&#x957f;&#x7684;&#x5b9e;&#x73b0;&#xff1a;\n\nres.format({\n  <span class=\"hljs-type\">text</span>: <span class=\"hljs-keyword\">function</span> () {\n    res.send(<span class=\"hljs-string\">&apos;hey&apos;</span>)\n  },\n\n  html: <span class=\"hljs-keyword\">function</span> () {\n    res.send(<span class=\"hljs-string\">&apos;&lt;p&gt;hey&lt;/p&gt;&apos;</span>)\n  },\n\n  <span class=\"hljs-type\">json</span>: <span class=\"hljs-keyword\">function</span> () {\n    res.send({ message: <span class=\"hljs-string\">&apos;hey&apos;</span> })\n  }\n})\n res.<span class=\"hljs-keyword\">get</span>(field)&#x4e2d;&#x82f1;\n&#x8fd4;&#x56de; field &#x6307;&#x5b9a;&#x7684; HTTP &#x54cd;&#x5e94;&#x6807;&#x5934;&#x3002;&#x5339;&#x914d;&#x4e0d;&#x533a;&#x5206;&#x5927;&#x5c0f;&#x5199;&#x3002;\n\nres.<span class=\"hljs-keyword\">get</span>(<span class=\"hljs-string\">&apos;Content-Type&apos;</span>)\n// =&gt; &quot;text/plain&quot;\n res.json([body])&#x4e2d;&#x82f1;\n&#x53d1;&#x9001; <span class=\"hljs-type\">JSON</span> &#x54cd;&#x5e94;&#x3002;&#x6b64;&#x65b9;&#x6cd5;&#x53d1;&#x9001;&#x4e00;&#x4e2a;&#x54cd;&#x5e94;&#xff08;&#x5177;&#x6709;&#x6b63;&#x786e;&#x7684;&#x5185;&#x5bb9;&#x7c7b;&#x578b;&#xff09;&#xff0c;&#x8be5;&#x54cd;&#x5e94;&#x662f;&#x4f7f;&#x7528; <span class=\"hljs-type\">JSON</span>.stringify() &#x8f6c;&#x6362;&#x4e3a; <span class=\"hljs-type\">JSON</span> &#x5b57;&#x7b26;&#x4e32;&#x7684;&#x53c2;&#x6570;&#x3002;\n\n&#x53c2;&#x6570;&#x53ef;&#x4ee5;&#x662f;&#x4efb;&#x4f55; <span class=\"hljs-type\">JSON</span> &#x7c7b;&#x578b;&#xff0c;&#x5305;&#x62ec;&#x5bf9;&#x8c61;&#x3001;&#x6570;&#x7ec4;&#x3001;&#x5b57;&#x7b26;&#x4e32;&#x3001;&#x5e03;&#x5c14;&#x503c;&#x3001;&#x6570;&#x5b57;&#x6216; <span class=\"hljs-keyword\">null</span>&#xff0c;&#x60a8;&#x4e5f;&#x53ef;&#x4ee5;&#x4f7f;&#x7528;&#x5b83;&#x6765;&#x5c06;&#x5176;&#x4ed6;&#x503c;&#x8f6c;&#x6362;&#x4e3a; <span class=\"hljs-type\">JSON</span>&#x3002;\n\nres.json(<span class=\"hljs-keyword\">null</span>)\nres.json({ <span class=\"hljs-keyword\">user</span>: <span class=\"hljs-string\">&apos;tobi&apos;</span> })\nres.status(<span class=\"hljs-number\">500</span>).json({ error: <span class=\"hljs-string\">&apos;message&apos;</span> })\n res.jsonp([body])&#x4e2d;&#x82f1;\n&#x53d1;&#x9001;&#x5e26;&#x6709; JSONP &#x652f;&#x6301;&#x7684; <span class=\"hljs-type\">JSON</span> &#x54cd;&#x5e94;&#x3002;&#x6b64;&#x65b9;&#x6cd5;&#x4e0e; res.json() &#x76f8;&#x540c;&#xff0c;&#x53ea;&#x662f;&#x5b83;&#x9009;&#x62e9;&#x52a0;&#x5165; JSONP &#x56de;&#x8c03;&#x652f;&#x6301;&#x3002;\n\nres.jsonp(<span class=\"hljs-keyword\">null</span>)\n// =&gt; callback(<span class=\"hljs-keyword\">null</span>)\n\nres.jsonp({ <span class=\"hljs-keyword\">user</span>: <span class=\"hljs-string\">&apos;tobi&apos;</span> })\n// =&gt; callback({ &quot;user&quot;: &quot;tobi&quot; })\n\nres.status(<span class=\"hljs-number\">500</span>).jsonp({ error: <span class=\"hljs-string\">&apos;message&apos;</span> })\n// =&gt; callback({ &quot;error&quot;: &quot;message&quot; })\n&#x9ed8;&#x8ba4;&#x60c5;&#x51b5;&#x4e0b;&#xff0c;JSONP &#x56de;&#x8c03;&#x540d;&#x79f0;&#x53ea;&#x662f; callback&#x3002;&#x7528; jsonp &#x56de;&#x8c03;&#x540d;&#x79f0; &#x8bbe;&#x7f6e;&#x8986;&#x76d6;&#x5b83;&#x3002;\n\n&#x4ee5;&#x4e0b;&#x662f;&#x4f7f;&#x7528;&#x76f8;&#x540c;&#x4ee3;&#x7801;&#x7684; JSONP &#x54cd;&#x5e94;&#x7684;&#x4e00;&#x4e9b;&#x793a;&#x4f8b;&#xff1a;\n\n// ?callback=foo\nres.jsonp({ <span class=\"hljs-keyword\">user</span>: <span class=\"hljs-string\">&apos;tobi&apos;</span> })\n// =&gt; foo({ &quot;user&quot;: &quot;tobi&quot; })\n\napp.<span class=\"hljs-keyword\">set</span>(<span class=\"hljs-string\">&apos;jsonp callback name&apos;</span>, <span class=\"hljs-string\">&apos;cb&apos;</span>)\n\n// ?cb=foo\nres.status(<span class=\"hljs-number\">500</span>).jsonp({ error: <span class=\"hljs-string\">&apos;message&apos;</span> })\n// =&gt; foo({ &quot;error&quot;: &quot;message&quot; })\n res.links(links)&#x4e2d;&#x82f1;\n&#x52a0;&#x5165;&#x4f5c;&#x4e3a;&#x53c2;&#x6570;&#x5c5e;&#x6027;&#x63d0;&#x4f9b;&#x7684; links &#x4ee5;&#x586b;&#x5145;&#x54cd;&#x5e94;&#x7684; Link HTTP &#x6807;&#x5934;&#x5b57;&#x6bb5;&#x3002;\n\n&#x4f8b;&#x5982;&#xff0c;&#x4ee5;&#x4e0b;&#x8c03;&#x7528;&#xff1a;\n\nres.links({\n  next: <span class=\"hljs-string\">&apos;http://api.example.com/users?page=2&apos;</span>,\n  last: <span class=\"hljs-string\">&apos;http://api.example.com/users?page=5&apos;</span>\n})\n&#x4ea7;&#x751f;&#x4ee5;&#x4e0b;&#x7ed3;&#x679c;&#xff1a;\n\nLink: &lt;http://api.example.com/users?page=<span class=\"hljs-number\">2</span>&gt;; rel=&quot;next&quot;,\n      &lt;http://api.example.com/users?page=<span class=\"hljs-number\">5</span>&gt;; rel=&quot;last&quot;\n res.<span class=\"hljs-keyword\">location</span>(<span class=\"hljs-type\">path</span>)&#x4e2d;&#x82f1;\n&#x5c06;&#x54cd;&#x5e94; <span class=\"hljs-keyword\">Location</span> HTTP &#x6807;&#x5934;&#x8bbe;&#x7f6e;&#x4e3a;&#x6307;&#x5b9a;&#x7684; <span class=\"hljs-type\">path</span> &#x53c2;&#x6570;&#x3002;\n\nres.<span class=\"hljs-keyword\">location</span>(<span class=\"hljs-string\">&apos;/foo/bar&apos;</span>)\nres.<span class=\"hljs-keyword\">location</span>(<span class=\"hljs-string\">&apos;http://example.com&apos;</span>)\nres.<span class=\"hljs-keyword\">location</span>(<span class=\"hljs-string\">&apos;back&apos;</span>)\n&quot;back&quot; &#x7684; <span class=\"hljs-type\">path</span> &#x503c;&#x5177;&#x6709;&#x7279;&#x6b8a;&#x542b;&#x4e49;&#xff0c;&#x5b83;&#x6307;&#x7684;&#x662f;&#x8bf7;&#x6c42;&#x7684; Referer &#x6807;&#x5934;&#x4e2d;&#x6307;&#x5b9a;&#x7684; URL&#x3002;&#x5982;&#x679c;&#x672a;&#x6307;&#x5b9a; Referer &#x6807;&#x5934;&#xff0c;&#x5219;&#x5b83;&#x5f15;&#x7528; &quot;/&quot;&#x3002;\n\n&#x5728;&#x5bf9; URL &#x8fdb;&#x884c;&#x7f16;&#x7801;&#x540e;&#xff0c;&#x5982;&#x679c;&#x5c1a;&#x672a;&#x7f16;&#x7801;&#xff0c;Express &#x4f1a;&#x5c06;&#x6307;&#x5b9a;&#x7684; URL &#x5728; <span class=\"hljs-keyword\">Location</span> &#x6807;&#x5934;&#x4e2d;&#x4f20;&#x9012;&#x7ed9;&#x6d4f;&#x89c8;&#x5668;&#xff0c;&#x800c;&#x4e0d;&#x8fdb;&#x884c;&#x4efb;&#x4f55;&#x9a8c;&#x8bc1;&#x3002;\n\n&#x6d4f;&#x89c8;&#x5668;&#x8d1f;&#x8d23;&#x4ece;&#x5f53;&#x524d; URL &#x6216;&#x5f15;&#x7528; URL &#x4ee5;&#x53ca; <span class=\"hljs-keyword\">Location</span> &#x6807;&#x5934;&#x4e2d;&#x6307;&#x5b9a;&#x7684; URL &#x5bfc;&#x51fa;&#x9884;&#x671f; URL&#xff1b;&#x5e76;&#x76f8;&#x5e94;&#x5730;&#x91cd;&#x5b9a;&#x5411;&#x7528;&#x6237;&#x3002;\n\n res.redirect([status,] <span class=\"hljs-type\">path</span>)&#x4e2d;&#x82f1;\n&#x91cd;&#x5b9a;&#x5411;&#x5230;&#x4ece;&#x6307;&#x5b9a; <span class=\"hljs-type\">path</span> &#x6d3e;&#x751f;&#x7684; URL&#xff0c;&#x6307;&#x5b9a; status&#xff0c;&#x4e00;&#x4e2a;&#x5bf9;&#x5e94;&#x4e8e; HTTP &#x72b6;&#x6001;&#x7801; &#x7684;&#x6b63;&#x6574;&#x6570;&#x3002;&#x5982;&#x679c;&#x672a;&#x6307;&#x5b9a;&#xff0c;&#x5219; status &#x9ed8;&#x8ba4;&#x4e3a; &quot;302 &quot;<span class=\"hljs-built_in\">Found</span>&#x201d;&#x3002;\n\nres.redirect(<span class=\"hljs-string\">&apos;/foo/bar&apos;</span>)\nres.redirect(<span class=\"hljs-string\">&apos;http://example.com&apos;</span>)\nres.redirect(<span class=\"hljs-number\">301</span>, <span class=\"hljs-string\">&apos;http://example.com&apos;</span>)\nres.redirect(<span class=\"hljs-string\">&apos;../login&apos;</span>)\n&#x91cd;&#x5b9a;&#x5411;&#x53ef;&#x4ee5;&#x662f;&#x7528;&#x4e8e;&#x91cd;&#x5b9a;&#x5411;&#x5230;&#x4e0d;&#x540c;&#x7ad9;&#x70b9;&#x7684;&#x5b8c;&#x5168;&#x9650;&#x5b9a; URL&#xff1a;\n\nres.redirect(<span class=\"hljs-string\">&apos;http://google.com&apos;</span>)\n&#x91cd;&#x5b9a;&#x5411;&#x53ef;&#x4ee5;&#x76f8;&#x5bf9;&#x4e8e;&#x4e3b;&#x673a;&#x540d;&#x7684;&#x6839;&#x76ee;&#x5f55;&#x3002;&#x4f8b;&#x5982;&#xff0c;&#x5982;&#x679c;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x4f4d;&#x4e8e; http://example.com/<span class=\"hljs-keyword\">admin</span>/post/<span class=\"hljs-built_in\">new</span> &#x4e0a;&#xff0c;&#x5219;&#x4ee5;&#x4e0b;&#x5185;&#x5bb9;&#x5c06;&#x91cd;&#x5b9a;&#x5411;&#x5230; URL http://example.com/<span class=\"hljs-keyword\">admin</span>&#xff1a;\n\nres.redirect(<span class=\"hljs-string\">&apos;/admin&apos;</span>)\n&#x91cd;&#x5b9a;&#x5411;&#x53ef;&#x4ee5;&#x76f8;&#x5bf9;&#x4e8e;&#x5f53;&#x524d; URL&#x3002;&#x4f8b;&#x5982;&#xff0c;&#x4ece; http://example.com/blog/<span class=\"hljs-keyword\">admin</span>/&#xff08;&#x6ce8;&#x610f;&#x5c3e;&#x90e8;&#x659c;&#x6760;&#xff09;&#x5f00;&#x59cb;&#xff0c;&#x4ee5;&#x4e0b;&#x5185;&#x5bb9;&#x5c06;&#x91cd;&#x5b9a;&#x5411;&#x5230; URL http://example.com/blog/<span class=\"hljs-keyword\">admin</span>/post/<span class=\"hljs-built_in\">new</span>&#x3002;\n\nres.redirect(<span class=\"hljs-string\">&apos;post/new&apos;</span>)\n&#x4ece; http://example.com/blog/<span class=\"hljs-keyword\">admin</span> &#x91cd;&#x5b9a;&#x5411;&#x5230; post/<span class=\"hljs-built_in\">new</span>&#xff08;&#x6ca1;&#x6709;&#x5c3e;&#x90e8;&#x659c;&#x6760;&#xff09;&#xff0c;&#x5c06;&#x91cd;&#x5b9a;&#x5411;&#x5230; http://example.com/blog/post/<span class=\"hljs-built_in\">new</span>&#x3002;\n\n&#x5982;&#x679c;&#x60a8;&#x53d1;&#x73b0;&#x4e0a;&#x8ff0;&#x884c;&#x4e3a;&#x4ee4;&#x4eba;&#x56f0;&#x60d1;&#xff0c;&#x8bf7;&#x5c06;&#x8def;&#x5f84;&#x6bb5;&#x89c6;&#x4e3a;&#x76ee;&#x5f55;&#xff08;&#x5e26;&#x6709;&#x5c3e;&#x90e8;&#x659c;&#x6760;&#xff09;&#x548c;&#x6587;&#x4ef6;&#xff0c;&#x8fd9;&#x5c06;&#x5f00;&#x59cb;&#x6709;&#x610f;&#x4e49;&#x3002;\n\n&#x8def;&#x5f84;&#x76f8;&#x5173;&#x7684;&#x91cd;&#x5b9a;&#x5411;&#x4e5f;&#x662f;&#x53ef;&#x80fd;&#x7684;&#x3002;&#x5982;&#x679c;&#x60a8;&#x5728; http://example.com/<span class=\"hljs-keyword\">admin</span>/post/<span class=\"hljs-built_in\">new</span>&#xff0c;&#x4ee5;&#x4e0b;&#x5c06;&#x91cd;&#x5b9a;&#x5411;&#x5230; http://example.com/<span class=\"hljs-keyword\">admin</span>/post&#xff1a;\n\nres.redirect(<span class=\"hljs-string\">&apos;..&apos;</span>)\nback &#x91cd;&#x5b9a;&#x5411;&#x5c06;&#x8bf7;&#x6c42;&#x91cd;&#x5b9a;&#x5411;&#x56de; referer&#xff0c;&#x5f53;&#x5f15;&#x7528;&#x8005;&#x4e22;&#x5931;&#x65f6;&#x9ed8;&#x8ba4;&#x4e3a; /&#x3002;\n\nres.redirect(<span class=\"hljs-string\">&apos;back&apos;</span>)\n res.render(<span class=\"hljs-keyword\">view</span> [, locals] [, callback])&#x4e2d;&#x82f1;\n&#x5448;&#x73b0; <span class=\"hljs-keyword\">view</span> &#x5e76;&#x5c06;&#x5448;&#x73b0;&#x7684; HTML &#x5b57;&#x7b26;&#x4e32;&#x53d1;&#x9001;&#x5230;&#x5ba2;&#x6237;&#x7aef;&#x3002;&#x53ef;&#x9009;&#x53c2;&#x6570;&#xff1a;\n\nlocals&#xff0c;&#x4e00;&#x4e2a;&#x5bf9;&#x8c61;&#xff0c;&#x5176;&#x5c5e;&#x6027;&#x5b9a;&#x4e49;&#x89c6;&#x56fe;&#x7684;&#x5c40;&#x90e8;&#x53d8;&#x91cf;&#x3002;\ncallback&#xff0c;&#x56de;&#x8c03;&#x51fd;&#x6570;&#x3002;&#x5982;&#x679c;&#x63d0;&#x4f9b;&#xff0c;&#x8be5;&#x65b9;&#x6cd5;&#x5c06;&#x8fd4;&#x56de;&#x53ef;&#x80fd;&#x7684;&#x9519;&#x8bef;&#x548c;&#x5448;&#x73b0;&#x7684;&#x5b57;&#x7b26;&#x4e32;&#xff0c;&#x4f46;&#x4e0d;&#x6267;&#x884c;&#x81ea;&#x52a8;&#x54cd;&#x5e94;&#x3002;&#x5f53;&#x53d1;&#x751f;&#x9519;&#x8bef;&#x65f6;&#xff0c;&#x8be5;&#x65b9;&#x6cd5;&#x5728;&#x5185;&#x90e8;&#x8c03;&#x7528; next(err)&#x3002;\n<span class=\"hljs-keyword\">view</span> &#x53c2;&#x6570;&#x662f;&#x4e00;&#x4e2a;&#x5b57;&#x7b26;&#x4e32;&#xff0c;&#x5b83;&#x662f;&#x8981;&#x6e32;&#x67d3;&#x7684;&#x89c6;&#x56fe;&#x6587;&#x4ef6;&#x7684;&#x6587;&#x4ef6;&#x8def;&#x5f84;&#x3002;&#x8fd9;&#x53ef;&#x4ee5;&#x662f;&#x7edd;&#x5bf9;&#x8def;&#x5f84;&#xff0c;&#x4e5f;&#x53ef;&#x4ee5;&#x662f;&#x76f8;&#x5bf9;&#x4e8e; views &#x8bbe;&#x7f6e;&#x7684;&#x8def;&#x5f84;&#x3002;&#x5982;&#x679c;&#x8def;&#x5f84;&#x4e0d;&#x5305;&#x542b;&#x6587;&#x4ef6;&#x6269;&#x5c55;&#x540d;&#xff0c;&#x5219; <span class=\"hljs-keyword\">view</span> engine &#x8bbe;&#x7f6e;&#x786e;&#x5b9a;&#x6587;&#x4ef6;&#x6269;&#x5c55;&#x540d;&#x3002;&#x5982;&#x679c;&#x8def;&#x5f84;&#x786e;&#x5b9e;&#x5305;&#x542b;&#x6587;&#x4ef6;&#x6269;&#x5c55;&#x540d;&#xff0c;&#x90a3;&#x4e48; Express &#x5c06;&#x52a0;&#x8f7d;&#x6307;&#x5b9a;&#x6a21;&#x677f;&#x5f15;&#x64ce;&#x7684;&#x6a21;&#x5757;&#xff08;&#x901a;&#x8fc7; require()&#xff09;&#x5e76;&#x4f7f;&#x7528;&#x52a0;&#x8f7d;&#x6a21;&#x5757;&#x7684; __express &#x51fd;&#x6570;&#x6e32;&#x67d3;&#x5b83;&#x3002;\n\n&#x6709;&#x5173;&#x8be6;&#x7ec6;&#x4fe1;&#x606f;&#xff0c;&#x8bf7;&#x53c2;&#x9605; &#x4f7f;&#x7528; Express &#x6a21;&#x677f;&#x5f15;&#x64ce;&#x3002;\n\n&#x6ce8;&#x610f;&#xff1a;<span class=\"hljs-keyword\">view</span> &#x53c2;&#x6570;&#x6267;&#x884c;&#x6587;&#x4ef6;&#x7cfb;&#x7edf;&#x64cd;&#x4f5c;&#xff0c;&#x4f8b;&#x5982;&#x4ece;&#x78c1;&#x76d8;&#x8bfb;&#x53d6;&#x6587;&#x4ef6;&#x548c;&#x8bc4;&#x4f30; Node.js &#x6a21;&#x5757;&#xff0c;&#x56e0;&#x6b64;&#x51fa;&#x4e8e;&#x5b89;&#x5168;&#x539f;&#x56e0;&#x4e0d;&#x5e94;&#x5305;&#x542b;&#x6765;&#x81ea;&#x6700;&#x7ec8;&#x7528;&#x6237;&#x7684;&#x8f93;&#x5165;&#x3002;\n\n&#x5c40;&#x90e8;&#x53d8;&#x91cf; <span class=\"hljs-keyword\">cache</span> &#x542f;&#x7528;&#x89c6;&#x56fe;&#x7f13;&#x5b58;&#x3002;&#x8bbe;&#x7f6e;&#x4e3a;true&#xff0c;&#x5f00;&#x53d1;&#x65f6;&#x7f13;&#x5b58;&#x89c6;&#x56fe;&#xff1b;&#x9ed8;&#x8ba4;&#x60c5;&#x51b5;&#x4e0b;&#xff0c;&#x89c6;&#x56fe;&#x7f13;&#x5b58;&#x5728;&#x751f;&#x4ea7;&#x4e2d;&#x542f;&#x7528;&#x3002;\n\n// send the rendered view to the client\nres.render(&apos;index&apos;)\n\n// if a callback is specified, the rendered HTML string has to be sent explicitly\nres.render(&apos;index&apos;, function (err, html) {\n  res.send(html)\n})\n\n// pass a local variable to the view\nres.render(&apos;user&apos;, { name: &apos;Tobi&apos; }, function (err, html) {\n  // ...\n})\n res.req&#x4e2d;&#x82f1;\n&#x6b64;&#x5c5e;&#x6027;&#x5305;&#x542b;&#x5bf9;&#x4e0e;&#x6b64;&#x54cd;&#x5e94;&#x5bf9;&#x8c61;&#x76f8;&#x5173;&#x7684; &#x8bf7;&#x6c42;&#x5bf9;&#x8c61; &#x7684;&#x5f15;&#x7528;&#x3002;\n\n res.send([body])&#x4e2d;&#x82f1;\n&#x53d1;&#x9001; HTTP &#x54cd;&#x5e94;&#x3002;\n\nbody &#x53c2;&#x6570;&#x53ef;&#x4ee5;&#x662f; Buffer &#x5bf9;&#x8c61;&#x3001;String&#x3001;&#x5bf9;&#x8c61;&#x3001;Boolean &#x6216; Array&#x3002;&#x4f8b;&#x5982;&#xff1a;\n\nres.send(Buffer.from(&apos;whoop&apos;))\nres.send({ some: &apos;json&apos; })\nres.send(&apos;&lt;p&gt;some html&lt;/p&gt;&apos;)\nres.status(<span class=\"hljs-number\">404</span>).send(<span class=\"hljs-string\">&apos;Sorry, we cannot find that!&apos;</span>)\nres.status(<span class=\"hljs-number\">500</span>).send({ error: <span class=\"hljs-string\">&apos;something blew up&apos;</span> })\n&#x6b64;&#x65b9;&#x6cd5;&#x5bf9;&#x7b80;&#x5355;&#x7684;&#x975e;&#x6d41;&#x5f0f;&#x54cd;&#x5e94;&#x6267;&#x884c;&#x8bb8;&#x591a;&#x6709;&#x7528;&#x7684;&#x4efb;&#x52a1;&#xff1a;&#x4f8b;&#x5982;&#xff0c;&#x5b83;&#x81ea;&#x52a8;&#x5206;&#x914d; Content-Length HTTP &#x54cd;&#x5e94;&#x5934;&#x5b57;&#x6bb5;&#xff08;&#x9664;&#x975e;&#x4e4b;&#x524d;&#x5b9a;&#x4e49;&#xff09;&#x5e76;&#x63d0;&#x4f9b;&#x81ea;&#x52a8; HEAD &#x548c; HTTP &#x7f13;&#x5b58;&#x65b0;&#x9c9c;&#x5ea6;&#x652f;&#x6301;&#x3002;\n\n&#x5f53;&#x53c2;&#x6570;&#x4e3a; Buffer &#x5bf9;&#x8c61;&#x65f6;&#xff0c;&#x8be5;&#x65b9;&#x6cd5;&#x5c06; Content-<span class=\"hljs-keyword\">Type</span> &#x54cd;&#x5e94;&#x5934;&#x5b57;&#x6bb5;&#x8bbe;&#x7f6e;&#x4e3a; &quot;application/octet-stream&quot;&#xff0c;&#x9664;&#x975e;&#x4e4b;&#x524d;&#x5b9a;&#x4e49;&#x5982;&#x4e0b;&#x6240;&#x793a;&#xff1a;\n\nres.<span class=\"hljs-keyword\">set</span>(<span class=\"hljs-string\">&apos;Content-Type&apos;</span>, <span class=\"hljs-string\">&apos;text/html&apos;</span>)\nres.send(Buffer.<span class=\"hljs-keyword\">from</span>(<span class=\"hljs-string\">&apos;&lt;p&gt;some html&lt;/p&gt;&apos;</span>))\n&#x5f53;&#x53c2;&#x6570;&#x4e3a; String &#x65f6;&#xff0c;&#x8be5;&#x65b9;&#x6cd5;&#x5c06; Content-<span class=\"hljs-keyword\">Type</span> &#x8bbe;&#x7f6e;&#x4e3a; &quot;text/html&quot;&#xff1a;\n\nres.send(<span class=\"hljs-string\">&apos;&lt;p&gt;some html&lt;/p&gt;&apos;</span>)\n&#x5f53;&#x53c2;&#x6570;&#x4e3a; <span class=\"hljs-keyword\">Array</span> &#x6216; <span class=\"hljs-keyword\">Object</span> &#x65f6;&#xff0c;Express &#x4ee5; <span class=\"hljs-type\">JSON</span> &#x8868;&#x793a;&#x5f62;&#x5f0f;&#x54cd;&#x5e94;&#xff1a;\n\nres.send({ <span class=\"hljs-keyword\">user</span>: <span class=\"hljs-string\">&apos;tobi&apos;</span> })\nres.send([<span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">3</span>])\n res.sendFile(<span class=\"hljs-type\">path</span> [, <span class=\"hljs-keyword\">options</span>] [, fn])&#x4e2d;&#x82f1;\nExpress v4<span class=\"hljs-number\">.8</span><span class=\"hljs-number\">.0</span> &#x53ca;&#x66f4;&#x9ad8;&#x7248;&#x672c;&#x652f;&#x6301; res.sendFile()&#x3002;\n\n&#x5728;&#x7ed9;&#x5b9a;&#x7684; <span class=\"hljs-type\">path</span> &#x4f20;&#x8f93;&#x6587;&#x4ef6;&#x3002;&#x6839;&#x636e;&#x6587;&#x4ef6;&#x540d;&#x7684;&#x6269;&#x5c55;&#x540d;&#x8bbe;&#x7f6e; Content-<span class=\"hljs-keyword\">Type</span> &#x54cd;&#x5e94; HTTP &#x6807;&#x5934;&#x5b57;&#x6bb5;&#x3002;&#x9664;&#x975e;&#x5728;&#x9009;&#x9879;&#x5bf9;&#x8c61;&#x4e2d;&#x8bbe;&#x7f6e;&#x4e86; root &#x9009;&#x9879;&#xff0c;&#x5426;&#x5219; <span class=\"hljs-type\">path</span> &#x5fc5;&#x987b;&#x662f;&#x6587;&#x4ef6;&#x7684;&#x7edd;&#x5bf9;&#x8def;&#x5f84;&#x3002;\n\n&#x6b64; API &#x63d0;&#x4f9b;&#x5bf9;&#x6b63;&#x5728;&#x8fd0;&#x884c;&#x7684;&#x6587;&#x4ef6;&#x7cfb;&#x7edf;&#x4e0a;&#x7684;&#x6570;&#x636e;&#x7684;&#x8bbf;&#x95ee;&#x3002;&#x786e;&#x4fdd; (a) &#x5c06; <span class=\"hljs-type\">path</span> &#x53c2;&#x6570;&#x6784;&#x9020;&#x4e3a;&#x7edd;&#x5bf9;&#x8def;&#x5f84;&#x7684;&#x65b9;&#x5f0f;&#x5728;&#x5305;&#x542b;&#x7528;&#x6237;&#x8f93;&#x5165;&#x65f6;&#x662f;&#x5b89;&#x5168;&#x7684;&#xff0c;&#x6216;&#x8005; (b) &#x5c06; root &#x9009;&#x9879;&#x8bbe;&#x7f6e;&#x4e3a;&#x76ee;&#x5f55;&#x7684;&#x7edd;&#x5bf9;&#x8def;&#x5f84;&#x4ee5;&#x5305;&#x542b;&#x5176;&#x4e2d;&#x7684;&#x8bbf;&#x95ee;&#x3002;\n\n&#x5f53;&#x63d0;&#x4f9b; root &#x9009;&#x9879;&#x65f6;&#xff0c;&#x5141;&#x8bb8; <span class=\"hljs-type\">path</span> &#x53c2;&#x6570;&#x4e3a;&#x76f8;&#x5bf9;&#x8def;&#x5f84;&#xff0c;&#x5305;&#x62ec;&#x5305;&#x542b; ..&#x3002;Express &#x5c06;&#x9a8c;&#x8bc1;&#x4f5c;&#x4e3a; <span class=\"hljs-type\">path</span> &#x63d0;&#x4f9b;&#x7684;&#x76f8;&#x5bf9;&#x8def;&#x5f84;&#x5c06;&#x5728;&#x7ed9;&#x5b9a;&#x7684; root &#x9009;&#x9879;&#x4e2d;&#x89e3;&#x6790;&#x3002;\n\n&#x4e0b;&#x8868;&#x63d0;&#x4f9b;&#x4e86;&#x6709;&#x5173; <span class=\"hljs-keyword\">options</span> &#x53c2;&#x6570;&#x7684;&#x8be6;&#x7ec6;&#x4fe1;&#x606f;&#x3002;\n\n&#x5c5e;&#x6027;\t&#x63cf;&#x8ff0;\t&#x9ed8;&#x8ba4;\t&#x53ef;&#x7528;&#x6027;\nmaxAge\t&#x8bbe;&#x7f6e; <span class=\"hljs-keyword\">Cache</span>-Control &#x6807;&#x5934;&#x7684; max-age &#x5c5e;&#x6027;&#xff08;&#x4ee5;&#x6beb;&#x79d2;&#x4e3a;&#x5355;&#x4f4d;&#xff09;&#x6216; ms &#x683c;&#x5f0f; &#x4e2d;&#x7684;&#x5b57;&#x7b26;&#x4e32;\t<span class=\"hljs-number\">0</span>\t\nroot\t&#x76f8;&#x5bf9;&#x6587;&#x4ef6;&#x540d;&#x7684;&#x6839;&#x76ee;&#x5f55;&#x3002;\t\t\nlastModified\t&#x5c06; Last-Modified &#x6807;&#x5934;&#x8bbe;&#x7f6e;&#x4e3a;&#x64cd;&#x4f5c;&#x7cfb;&#x7edf;&#x4e0a;&#x6587;&#x4ef6;&#x7684;&#x6700;&#x540e;&#x4fee;&#x6539;&#x65e5;&#x671f;&#x3002;&#x8bbe;&#x7f6e; <span class=\"hljs-keyword\">false</span> &#x4ee5;&#x7981;&#x7528;&#x5b83;&#x3002;\t&#x542f;&#x7528;\t<span class=\"hljs-number\">4.9</span><span class=\"hljs-number\">.0</span>+\nheaders\t&#x5305;&#x542b;&#x4e0e;&#x6587;&#x4ef6;&#x4e00;&#x8d77;&#x670d;&#x52a1;&#x7684; HTTP &#x6807;&#x5934;&#x7684;&#x5bf9;&#x8c61;&#x3002;\t\t\ndotfiles\t&#x63d0;&#x4f9b;&#x70b9;&#x6587;&#x4ef6;&#x7684;&#x9009;&#x9879;&#x3002;&#x53ef;&#x80fd;&#x7684;&#x503c;&#x4e3a; &quot;allow&quot;&#x3001;&quot;deny&quot;&#x3001;&quot;ignore&quot;&#x3002;\t&quot;ignore&quot;\t \nacceptRanges\t&#x542f;&#x7528;&#x6216;&#x7981;&#x7528;&#x63a5;&#x53d7;&#x8303;&#x56f4;&#x8bf7;&#x6c42;&#x3002;\t<span class=\"hljs-keyword\">true</span>\t<span class=\"hljs-number\">4.14</span>+\ncacheControl\t&#x542f;&#x7528;&#x6216;&#x7981;&#x7528;&#x8bbe;&#x7f6e; <span class=\"hljs-keyword\">Cache</span>-Control &#x54cd;&#x5e94;&#x6807;&#x5934;&#x3002;\ttrue\t<span class=\"hljs-number\">4.14</span>+\n<span class=\"hljs-keyword\">immutable</span>\t&#x5728; <span class=\"hljs-keyword\">Cache</span>-Control &#x54cd;&#x5e94;&#x6807;&#x5934;&#x4e2d;&#x542f;&#x7528;&#x6216;&#x7981;&#x7528; immutable &#x6307;&#x4ee4;&#x3002;&#x5982;&#x679c;&#x542f;&#x7528;&#xff0c;&#x8fd8;&#x5e94;&#x6307;&#x5b9a; maxAge &#x9009;&#x9879;&#x4ee5;&#x542f;&#x7528;&#x7f13;&#x5b58;&#x3002;immutable &#x6307;&#x4ee4;&#x5c06;&#x963b;&#x6b62;&#x53d7;&#x652f;&#x6301;&#x7684;&#x5ba2;&#x6237;&#x7aef;&#x5728; maxAge &#x9009;&#x9879;&#x7684;&#x751f;&#x547d;&#x5468;&#x671f;&#x5185;&#x53d1;&#x51fa;&#x6761;&#x4ef6;&#x8bf7;&#x6c42;&#x4ee5;&#x68c0;&#x67e5;&#x6587;&#x4ef6;&#x662f;&#x5426;&#x5df2;&#x66f4;&#x6539;&#x3002;\tfalse\t<span class=\"hljs-number\">4.16</span>+\n&#x8be5;&#x65b9;&#x6cd5;&#x5728;&#x4f20;&#x8f93;&#x5b8c;&#x6210;&#x6216;&#x53d1;&#x751f;&#x9519;&#x8bef;&#x65f6;&#x8c03;&#x7528;&#x56de;&#x8c03;&#x51fd;&#x6570; fn(err)&#x3002;&#x5982;&#x679c;&#x6307;&#x5b9a;&#x4e86;&#x56de;&#x8c03;&#x51fd;&#x6570;&#x5e76;&#x4e14;&#x53d1;&#x751f;&#x9519;&#x8bef;&#xff0c;&#x5219;&#x56de;&#x8c03;&#x51fd;&#x6570;&#x5fc5;&#x987b;&#x901a;&#x8fc7;&#x7ed3;&#x675f;&#x8bf7;&#x6c42;-&#x54cd;&#x5e94;&#x5faa;&#x73af;&#x6216;&#x5c06;&#x63a7;&#x5236;&#x6743;&#x4f20;&#x9012;&#x7ed9;&#x4e0b;&#x4e00;&#x4e2a;&#x8def;&#x7531;&#x6765;&#x663e;&#x5f0f;&#x5904;&#x7406;&#x54cd;&#x5e94;&#x8fc7;&#x7a0b;&#x3002;\n\n&#x8fd9;&#x662f;&#x4e00;&#x4e2a;&#x4f7f;&#x7528; res.sendFile &#x53ca;&#x5176;&#x6240;&#x6709;&#x53c2;&#x6570;&#x7684;&#x793a;&#x4f8b;&#x3002;\n\napp.<span class=\"hljs-keyword\">get</span>(<span class=\"hljs-string\">&apos;/file/:name&apos;</span>, <span class=\"hljs-keyword\">function</span> (req, res, next) {\n  var <span class=\"hljs-keyword\">options</span> = {\n    root: <span class=\"hljs-type\">path</span>.<span class=\"hljs-keyword\">join</span>(__dirname, <span class=\"hljs-string\">&apos;public&apos;</span>),\n    dotfiles: <span class=\"hljs-string\">&apos;deny&apos;</span>,\n    headers: {\n      <span class=\"hljs-string\">&apos;x-timestamp&apos;</span>: <span class=\"hljs-type\">Date</span>.now(),\n      <span class=\"hljs-string\">&apos;x-sent&apos;</span>: <span class=\"hljs-keyword\">true</span>\n    }\n  }\n\n  var fileName = req.params.name\n  res.sendFile(fileName, <span class=\"hljs-keyword\">options</span>, <span class=\"hljs-keyword\">function</span> (err) {\n    <span class=\"hljs-keyword\">if</span> (err) {\n      next(err)\n    } <span class=\"hljs-keyword\">else</span> {\n      console.log(<span class=\"hljs-string\">&apos;Sent:&apos;</span>, fileName)\n    }\n  })\n})\n&#x4ee5;&#x4e0b;&#x793a;&#x4f8b;&#x8bf4;&#x660e;&#x4e86;&#x4f7f;&#x7528; res.sendFile &#x4e3a;&#x670d;&#x52a1;&#x6587;&#x4ef6;&#x63d0;&#x4f9b;&#x7ec6;&#x7c92;&#x5ea6;&#x652f;&#x6301;&#xff1a;\n\napp.<span class=\"hljs-keyword\">get</span>(<span class=\"hljs-string\">&apos;/user/:uid/photos/:file&apos;</span>, <span class=\"hljs-keyword\">function</span> (req, res) {\n  var uid = req.params.uid\n  var file = req.params.file\n\n  req.<span class=\"hljs-keyword\">user</span>.mayViewFilesFrom(uid, <span class=\"hljs-keyword\">function</span> (yes) {\n    <span class=\"hljs-keyword\">if</span> (yes) {\n      res.sendFile(<span class=\"hljs-string\">&apos;/uploads/&apos;</span> + uid + <span class=\"hljs-string\">&apos;/&apos;</span> + file)\n    } <span class=\"hljs-keyword\">else</span> {\n      res.status(<span class=\"hljs-number\">403</span>).send(&quot;Sorry! You can&apos;t see that.&quot;)\n    }\n  })\n})\n&#x5982;&#x9700;&#x66f4;&#x591a;&#x4fe1;&#x606f;&#xff0c;&#x6216;&#x8005;&#x5982;&#x679c;&#x60a8;&#x6709;&#x95ee;&#x9898;&#x6216;&#x7591;&#x8651;&#xff0c;&#x8bf7;&#x53c2;&#x9605; send&#x3002;\n\n res.sendStatus(statusCode)&#x4e2d;&#x82f1;\n&#x5c06;&#x54cd;&#x5e94; HTTP &#x72b6;&#x6001;&#x4ee3;&#x7801;&#x8bbe;&#x7f6e;&#x4e3a; statusCode&#xff0c;&#x5e76;&#x5c06;&#x6ce8;&#x518c;&#x7684;&#x72b6;&#x6001;&#x6d88;&#x606f;&#x4f5c;&#x4e3a;&#x6587;&#x672c;&#x54cd;&#x5e94;&#x6b63;&#x6587;&#x53d1;&#x9001;&#x3002;&#x5982;&#x679c;&#x6307;&#x5b9a;&#x4e86;&#x672a;&#x77e5;&#x72b6;&#x6001;&#x4ee3;&#x7801;&#xff0c;&#x5219;&#x54cd;&#x5e94;&#x6b63;&#x6587;&#x5c06;&#x53ea;&#x662f;&#x4ee3;&#x7801;&#x7f16;&#x53f7;&#x3002;\n\nres.sendStatus(<span class=\"hljs-number\">404</span>)\n&#x5f53; res.statusCode &#x8bbe;&#x7f6e;&#x4e3a;&#x65e0;&#x6548;&#x7684; HTTP &#x72b6;&#x6001;&#x4ee3;&#x7801;&#xff08;&#x8d85;&#x51fa;&#x8303;&#x56f4; <span class=\"hljs-number\">100</span> &#x5230; <span class=\"hljs-number\">599</span>&#xff09;&#x65f6;&#xff0c;&#x67d0;&#x4e9b;&#x7248;&#x672c;&#x7684; Node.js &#x4f1a;&#x629b;&#x51fa;&#x5f02;&#x5e38;&#x3002;&#x8bf7;&#x67e5;&#x9605; HTTP &#x670d;&#x52a1;&#x5668;&#x6587;&#x6863;&#x4ee5;&#x4e86;&#x89e3;&#x6240;&#x4f7f;&#x7528;&#x7684; Node.js &#x7248;&#x672c;&#x3002;\n\n&#x66f4;&#x591a;&#x5173;&#x4e8e; HTTP &#x72b6;&#x6001;&#x7801;\n\n res.<span class=\"hljs-keyword\">set</span>(field [, <span class=\"hljs-keyword\">value</span>])&#x4e2d;&#x82f1;\n&#x5c06;&#x54cd;&#x5e94;&#x7684; HTTP &#x6807;&#x5934; field &#x8bbe;&#x7f6e;&#x4e3a; <span class=\"hljs-keyword\">value</span>&#x3002;&#x8981;&#x4e00;&#x6b21;&#x8bbe;&#x7f6e;&#x591a;&#x4e2a;&#x5b57;&#x6bb5;&#xff0c;&#x8bf7;&#x5c06;&#x5bf9;&#x8c61;&#x4f5c;&#x4e3a;&#x53c2;&#x6570;&#x4f20;&#x9012;&#x3002;\n\nres.<span class=\"hljs-keyword\">set</span>(<span class=\"hljs-string\">&apos;Content-Type&apos;</span>, <span class=\"hljs-string\">&apos;text/plain&apos;</span>)\n\nres.<span class=\"hljs-keyword\">set</span>({\n  <span class=\"hljs-string\">&apos;Content-Type&apos;</span>: <span class=\"hljs-string\">&apos;text/plain&apos;</span>,\n  <span class=\"hljs-string\">&apos;Content-Length&apos;</span>: <span class=\"hljs-string\">&apos;123&apos;</span>,\n  ETag: <span class=\"hljs-string\">&apos;12345&apos;</span>\n})\n&#x522b;&#x540d;&#x4e3a; res.<span class=\"hljs-keyword\">header</span>(field [, <span class=\"hljs-keyword\">value</span>])&#x3002;\n\n res.status(code)&#x4e2d;&#x82f1;\n&#x8bbe;&#x7f6e;&#x54cd;&#x5e94;&#x7684; HTTP &#x72b6;&#x6001;&#x3002;&#x5b83;&#x662f; Node &#x7684; response.statusCode &#x7684;&#x53ef;&#x94fe;&#x63a5;&#x522b;&#x540d;&#x3002;\n\nres.status(<span class=\"hljs-number\">403</span>).<span class=\"hljs-keyword\">end</span>()\nres.status(<span class=\"hljs-number\">400</span>).send(<span class=\"hljs-string\">&apos;Bad Request&apos;</span>)\nres.status(<span class=\"hljs-number\">404</span>).sendFile(<span class=\"hljs-string\">&apos;/absolute/path/to/404.png&apos;</span>)\n res.<span class=\"hljs-keyword\">type</span>(<span class=\"hljs-keyword\">type</span>)&#x4e2d;&#x82f1;\n&#x5c06; Content-<span class=\"hljs-keyword\">Type</span> HTTP &#x6807;&#x5934;&#x8bbe;&#x7f6e;&#x4e3a;&#x7531;&#x6307;&#x5b9a; <span class=\"hljs-keyword\">type</span> &#x786e;&#x5b9a;&#x7684; MIME &#x7c7b;&#x578b;&#x3002;&#x5982;&#x679c; <span class=\"hljs-keyword\">type</span> &#x5305;&#x542b; &quot;/&quot; &#x5b57;&#x7b26;&#xff0c;&#x5219;&#x5b83;&#x5c06; Content-<span class=\"hljs-keyword\">Type</span> &#x8bbe;&#x7f6e;&#x4e3a; <span class=\"hljs-keyword\">type</span> &#x7684;&#x786e;&#x5207;&#x503c;&#xff0c;&#x5426;&#x5219;&#x5047;&#x5b9a;&#x5b83;&#x662f;&#x6587;&#x4ef6;&#x6269;&#x5c55;&#x540d;&#x5e76;&#x4f7f;&#x7528; express.static.mime.lookup() &#x65b9;&#x6cd5;&#x5728;&#x6620;&#x5c04;&#x4e2d;&#x67e5;&#x627e; MIME &#x7c7b;&#x578b;&#x3002;\n\nres.<span class=\"hljs-keyword\">type</span>(<span class=\"hljs-string\">&apos;.html&apos;</span>)\n// =&gt; <span class=\"hljs-string\">&apos;text/html&apos;</span>\nres.<span class=\"hljs-keyword\">type</span>(<span class=\"hljs-string\">&apos;html&apos;</span>)\n// =&gt; <span class=\"hljs-string\">&apos;text/html&apos;</span>\nres.<span class=\"hljs-keyword\">type</span>(<span class=\"hljs-string\">&apos;json&apos;</span>)\n// =&gt; <span class=\"hljs-string\">&apos;application/json&apos;</span>\nres.<span class=\"hljs-keyword\">type</span>(<span class=\"hljs-string\">&apos;application/json&apos;</span>)\n// =&gt; <span class=\"hljs-string\">&apos;application/json&apos;</span>\nres.<span class=\"hljs-keyword\">type</span>(<span class=\"hljs-string\">&apos;png&apos;</span>)\n// =&gt; <span class=\"hljs-string\">&apos;image/png&apos;</span>\n res.vary(field)&#x4e2d;&#x82f1;\n&#x5c06;&#x8be5;&#x5b57;&#x6bb5;&#x6dfb;&#x52a0;&#x5230; Vary &#x54cd;&#x5e94;&#x6807;&#x5934;&#xff08;&#x5982;&#x679c;&#x5c1a;&#x4e0d;&#x5b58;&#x5728;&#xff09;&#x3002;\n\nres.vary(<span class=\"hljs-string\">&apos;User-Agent&apos;</span>).render(<span class=\"hljs-string\">&apos;docs&apos;</span>)\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2046,2492"}},{"content":"<pre data-lines=\"2493,2520\"><code data-lines=\"2493,2520\">res<span class=\"hljs-selector-class\">.app</span>\nres<span class=\"hljs-selector-class\">.headersSent</span>\nres<span class=\"hljs-selector-class\">.locals</span>\nres<span class=\"hljs-selector-class\">.append</span>(field <span class=\"hljs-selector-attr\">[, value]</span>)\nres<span class=\"hljs-selector-class\">.attachment</span>(<span class=\"hljs-selector-attr\">[filename]</span>)\nres<span class=\"hljs-selector-class\">.cookie</span>(name, value <span class=\"hljs-selector-attr\">[, options]</span>)\nres<span class=\"hljs-selector-class\">.clearCookie</span>(name <span class=\"hljs-selector-attr\">[, options]</span>)\nres<span class=\"hljs-selector-class\">.download</span>(<span class=\"hljs-selector-tag\">path</span> <span class=\"hljs-selector-attr\">[, filename]</span> <span class=\"hljs-selector-attr\">[, options]</span> <span class=\"hljs-selector-attr\">[, fn]</span>)\nres<span class=\"hljs-selector-class\">.end</span>(<span class=\"hljs-selector-attr\">[data]</span> <span class=\"hljs-selector-attr\">[, encoding]</span>)\nres<span class=\"hljs-selector-class\">.format</span>(object)\nres<span class=\"hljs-selector-class\">.get</span>(field)\nres<span class=\"hljs-selector-class\">.json</span>(<span class=\"hljs-selector-attr\">[body]</span>)\nres<span class=\"hljs-selector-class\">.jsonp</span>(<span class=\"hljs-selector-attr\">[body]</span>)\nres<span class=\"hljs-selector-class\">.links</span>(links)\nres<span class=\"hljs-selector-class\">.location</span>(path)\nres<span class=\"hljs-selector-class\">.redirect</span>(<span class=\"hljs-selector-attr\">[status,]</span> path)\nres<span class=\"hljs-selector-class\">.render</span>(view <span class=\"hljs-selector-attr\">[, locals]</span> <span class=\"hljs-selector-attr\">[, callback]</span>)\nres<span class=\"hljs-selector-class\">.req</span>\nres<span class=\"hljs-selector-class\">.send</span>(<span class=\"hljs-selector-attr\">[body]</span>)\nres<span class=\"hljs-selector-class\">.sendFile</span>(<span class=\"hljs-selector-tag\">path</span> <span class=\"hljs-selector-attr\">[, options]</span> <span class=\"hljs-selector-attr\">[, fn]</span>)\nres<span class=\"hljs-selector-class\">.sendStatus</span>(statusCode)\nres<span class=\"hljs-selector-class\">.set</span>(field <span class=\"hljs-selector-attr\">[, value]</span>)\nres<span class=\"hljs-selector-class\">.status</span>(code)\nres<span class=\"hljs-selector-class\">.type</span>(type)\nres<span class=\"hljs-selector-class\">.vary</span>(field)\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2493,2520"}}],"payload":{"tag":"h1","lines":"2016,2017"}},{"content":"&#x8def;&#x7531;","children":[{"content":"<pre data-lines=\"2523,2530\"><code data-lines=\"2523,2530\">router<span class=\"hljs-selector-class\">.all</span>(<span class=\"hljs-selector-tag\">path</span>, <span class=\"hljs-selector-attr\">[callback, ...]</span> callback)\nrouter<span class=\"hljs-selector-class\">.METHOD</span>(<span class=\"hljs-selector-tag\">path</span>, <span class=\"hljs-selector-attr\">[callback, ...]</span> callback)\nrouter<span class=\"hljs-selector-class\">.param</span>(name, callback)\nrouter<span class=\"hljs-selector-class\">.route</span>(path)\nrouter<span class=\"hljs-selector-class\">.use</span>(<span class=\"hljs-selector-attr\">[path]</span>, <span class=\"hljs-selector-attr\">[function, ...]</span> function)\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2523,2530"}},{"content":"<pre data-lines=\"2531,2810\"><code data-lines=\"2531,2810\">router &#x5bf9;&#x8c61;&#x662f;&#x4e2d;&#x95f4;&#x4ef6;&#x548c;&#x8def;&#x7531;&#x7684;&#x9694;&#x79bb;&#x5b9e;&#x4f8b;&#x3002;&#x4f60;&#x53ef;&#x4ee5;&#x628a;&#x5b83;&#x60f3;&#x8c61;&#x6210;&#x4e00;&#x4e2a;&#x53ea;&#x80fd;&#x6267;&#x884c;&#x4e2d;&#x95f4;&#x4ef6;&#x548c;&#x8def;&#x7531;&#x529f;&#x80fd;&#x7684; <span class=\"hljs-string\">&quot;mini-application,&quot;</span>&#x3002;&#x6bcf;&#x4e2a; <span class=\"hljs-title class_\">Express</span> &#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x90fd;&#x6709;&#x4e00;&#x4e2a;&#x5185;&#x7f6e;&#x7684;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x8def;&#x7531;&#x3002;\n\n&#x8def;&#x7531;&#x7684;&#x884c;&#x4e3a;&#x7c7b;&#x4f3c;&#x4e8e;&#x4e2d;&#x95f4;&#x4ef6;&#x672c;&#x8eab;&#xff0c;&#x56e0;&#x6b64;&#x60a8;&#x53ef;&#x4ee5;&#x5c06;&#x5176;&#x7528;&#x4f5c; app.<span class=\"hljs-title function_\">use</span>() &#x7684;&#x53c2;&#x6570;&#x6216;&#x7528;&#x4f5c;&#x53e6;&#x4e00;&#x4e2a;&#x8def;&#x7531;&#x7684; <span class=\"hljs-title function_\">use</span>() &#x65b9;&#x6cd5;&#x7684;&#x53c2;&#x6570;&#x3002;\n\n&#x9876;&#x7ea7; express &#x5bf9;&#x8c61;&#x5177;&#x6709;&#x521b;&#x5efa;&#x65b0; router &#x5bf9;&#x8c61;&#x7684; <span class=\"hljs-title class_\">Router</span>() &#x65b9;&#x6cd5;&#x3002;\n\n&#x4e00;&#x65e6;&#x4f60;&#x521b;&#x5efa;&#x4e86;&#x4e00;&#x4e2a;&#x8def;&#x7531;&#x5bf9;&#x8c61;&#xff0c;&#x4f60;&#x5c31;&#x53ef;&#x4ee5;&#x50cf;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x4e00;&#x6837;&#x5411;&#x5b83;&#x6dfb;&#x52a0;&#x4e2d;&#x95f4;&#x4ef6;&#x548c; <span class=\"hljs-variable constant_\">HTTP</span> &#x65b9;&#x6cd5;&#x8def;&#x7531;&#xff08;&#x4f8b;&#x5982; get&#x3001;put&#x3001;post &#x7b49;&#xff09;&#x3002;&#x4f8b;&#x5982;&#xff1a;\n\n<span class=\"hljs-comment\">// invoked for any requests passed to this router</span>\nrouter.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res, next</span>) {\n  <span class=\"hljs-comment\">// .. some logic here .. like any other middleware</span>\n  <span class=\"hljs-title function_\">next</span>()\n})\n\n<span class=\"hljs-comment\">// will handle any request that ends in /events</span>\n<span class=\"hljs-comment\">// depends on where the router is &quot;use()&apos;d&quot;</span>\nrouter.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;/events&apos;</span>, <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res, next</span>) {\n  <span class=\"hljs-comment\">// ..</span>\n})\n&#x7136;&#x540e;&#xff0c;&#x60a8;&#x53ef;&#x4ee5;&#x5c06;&#x8def;&#x7531;&#x7528;&#x4e8e;&#x7279;&#x5b9a;&#x7684;&#x6839; <span class=\"hljs-variable constant_\">URL</span>&#xff0c;&#x4ee5;&#x8fd9;&#x79cd;&#x65b9;&#x5f0f;&#x5c06;&#x60a8;&#x7684;&#x8def;&#x7531;&#x5206;&#x6210;&#x6587;&#x4ef6;&#x751a;&#x81f3;&#x8ff7;&#x4f60;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x3002;\n\n<span class=\"hljs-comment\">// only requests to /calendar/* will be sent to our &quot;router&quot;</span>\napp.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-string\">&apos;/calendar&apos;</span>, router)\n router.<span class=\"hljs-title function_\">all</span>(path, [callback, ...] callback)&#x4e2d;&#x82f1;\n&#x6b64;&#x65b9;&#x6cd5;&#x4e0e; router.<span class=\"hljs-title function_\">METHOD</span>() &#x65b9;&#x6cd5;&#x4e00;&#x6837;&#xff0c;&#x53ea;&#x662f;&#x5b83;&#x5339;&#x914d;&#x6240;&#x6709; <span class=\"hljs-variable constant_\">HTTP</span> &#x65b9;&#x6cd5;&#xff08;&#x52a8;&#x8bcd;&#xff09;&#x3002;\n\n&#x6b64;&#x65b9;&#x6cd5;&#x5bf9;&#x4e8e;&#x4e3a;&#x7279;&#x5b9a;&#x8def;&#x5f84;&#x524d;&#x7f00;&#x6216;&#x4efb;&#x610f;&#x5339;&#x914d;&#x6620;&#x5c04; <span class=\"hljs-string\">&quot;global&quot;</span> &#x903b;&#x8f91;&#x975e;&#x5e38;&#x6709;&#x7528;&#x3002;&#x4f8b;&#x5982;&#xff0c;&#x5982;&#x679c;&#x60a8;&#x5c06;&#x4ee5;&#x4e0b;&#x8def;&#x7531;&#x653e;&#x5728;&#x6240;&#x6709;&#x5176;&#x4ed6;&#x8def;&#x7531;&#x5b9a;&#x4e49;&#x7684;&#x9876;&#x90e8;&#xff0c;&#x5219;&#x8981;&#x6c42;&#x4ece;&#x8be5;&#x70b9;&#x5f00;&#x59cb;&#x7684;&#x6240;&#x6709;&#x8def;&#x7531;&#x90fd;&#x9700;&#x8981;&#x8eab;&#x4efd;&#x9a8c;&#x8bc1;&#xff0c;&#x5e76;&#x81ea;&#x52a8;&#x52a0;&#x8f7d;&#x7528;&#x6237;&#x3002;&#x8bf7;&#x8bb0;&#x4f4f;&#xff0c;&#x8fd9;&#x4e9b;&#x56de;&#x8c03;&#x4e0d;&#x5fc5;&#x5145;&#x5f53;&#x7aef;&#x70b9;&#xff1b; loadUser &#x53ef;&#x4ee5;&#x6267;&#x884c;&#x4e00;&#x4e2a;&#x4efb;&#x52a1;&#xff0c;&#x7136;&#x540e;&#x8c03;&#x7528; <span class=\"hljs-title function_\">next</span>() &#x7ee7;&#x7eed;&#x5339;&#x914d;&#x540e;&#x7eed;&#x8def;&#x7531;&#x3002;\n\nrouter.<span class=\"hljs-title function_\">all</span>(<span class=\"hljs-string\">&apos;*&apos;</span>, requireAuthentication, loadUser)\n&#x6216;&#x7b49;&#x4ef7;&#x7269;&#xff1a;\n\nrouter.<span class=\"hljs-title function_\">all</span>(<span class=\"hljs-string\">&apos;*&apos;</span>, requireAuthentication)\nrouter.<span class=\"hljs-title function_\">all</span>(<span class=\"hljs-string\">&apos;*&apos;</span>, loadUser)\n&#x53e6;&#x4e00;&#x4e2a;&#x4f8b;&#x5b50;&#x662f;&#x5217;&#x5165;&#x767d;&#x540d;&#x5355;&#x7684; <span class=\"hljs-string\">&quot;global&quot;</span> &#x529f;&#x80fd;&#x3002;&#x8fd9;&#x91cc;&#x7684;&#x4f8b;&#x5b50;&#x5f88;&#x50cf;&#x4ee5;&#x524d;&#xff0c;&#x4f46;&#x5b83;&#x53ea;&#x9650;&#x5236;&#x4ee5; <span class=\"hljs-string\">&quot;/api&quot;</span> &#x4e3a;&#x524d;&#x7f00;&#x7684;&#x8def;&#x5f84;&#xff1a;\n\nrouter.<span class=\"hljs-title function_\">all</span>(<span class=\"hljs-string\">&apos;/api/*&apos;</span>, requireAuthentication)\n router.<span class=\"hljs-title function_\">METHOD</span>(path, [callback, ...] callback)&#x4e2d;&#x82f1;\nrouter.<span class=\"hljs-title function_\">METHOD</span>() &#x65b9;&#x6cd5;&#x5728; <span class=\"hljs-title class_\">Express</span> &#x4e2d;&#x63d0;&#x4f9b;&#x8def;&#x7531;&#x529f;&#x80fd;&#xff0c;&#x5176;&#x4e2d; <span class=\"hljs-variable constant_\">METHOD</span> &#x662f; <span class=\"hljs-variable constant_\">HTTP</span> &#x65b9;&#x6cd5;&#x4e4b;&#x4e00;&#xff0c;&#x4f8b;&#x5982; <span class=\"hljs-variable constant_\">GET</span>&#x3001;<span class=\"hljs-variable constant_\">PUT</span>&#x3001;<span class=\"hljs-variable constant_\">POST</span> &#x7b49;&#xff0c;&#x5c0f;&#x5199;&#x3002;&#x56e0;&#x6b64;&#xff0c;&#x5b9e;&#x9645;&#x7684;&#x65b9;&#x6cd5;&#x662f; router.<span class=\"hljs-title function_\">get</span>()&#x3001;router.<span class=\"hljs-title function_\">post</span>()&#x3001;router.<span class=\"hljs-title function_\">put</span>() &#x7b49;&#x7b49;&#x3002;\n\n&#x5982;&#x679c; router.<span class=\"hljs-title function_\">get</span>() &#x4e4b;&#x524d;&#x7684;&#x8def;&#x5f84;&#x6ca1;&#x6709;&#x8c03;&#x7528; router.<span class=\"hljs-title function_\">head</span>()&#xff0c;&#x5219;&#x9664;&#x4e86; <span class=\"hljs-variable constant_\">GET</span> &#x65b9;&#x6cd5;&#x4e4b;&#x5916;&#xff0c;&#x8fd8;&#x4f1a;&#x4e3a; <span class=\"hljs-variable constant_\">HTTP</span> <span class=\"hljs-variable constant_\">HEAD</span> &#x65b9;&#x6cd5;&#x81ea;&#x52a8;&#x8c03;&#x7528; router.<span class=\"hljs-title function_\">get</span>() &#x51fd;&#x6570;&#x3002;\n\n&#x60a8;&#x53ef;&#x4ee5;&#x63d0;&#x4f9b;&#x591a;&#x4e2a;&#x56de;&#x8c03;&#xff0c;&#x5e76;&#x4e14;&#x6240;&#x6709;&#x56de;&#x8c03;&#x90fd;&#x88ab;&#x5e73;&#x7b49;&#x5bf9;&#x5f85;&#xff0c;&#x5e76;&#x4e14;&#x8868;&#x73b0;&#x5f97;&#x50cf;&#x4e2d;&#x95f4;&#x4ef6;&#xff0c;&#x9664;&#x4e86;&#x8fd9;&#x4e9b;&#x56de;&#x8c03;&#x53ef;&#x80fd;&#x4f1a;&#x8c03;&#x7528; <span class=\"hljs-title function_\">next</span>(<span class=\"hljs-string\">&apos;route&apos;</span>) &#x4ee5;&#x7ed5;&#x8fc7;&#x5269;&#x4f59;&#x7684;&#x8def;&#x7531;&#x56de;&#x8c03;&#x3002;&#x60a8;&#x53ef;&#x4ee5;&#x4f7f;&#x7528;&#x6b64;&#x673a;&#x5236;&#x5bf9;&#x8def;&#x7531;&#x6267;&#x884c;&#x524d;&#x7f6e;&#x6761;&#x4ef6;&#xff0c;&#x7136;&#x540e;&#x5728;&#x6ca1;&#x6709;&#x7406;&#x7531;&#x7ee7;&#x7eed;&#x5339;&#x914d;&#x8def;&#x7531;&#x65f6;&#x5c06;&#x63a7;&#x5236;&#x6743;&#x4f20;&#x9012;&#x7ed9;&#x540e;&#x7eed;&#x8def;&#x7531;&#x3002;\n\n&#x4ee5;&#x4e0b;&#x7247;&#x6bb5;&#x8bf4;&#x660e;&#x4e86;&#x53ef;&#x80fd;&#x7684;&#x6700;&#x7b80;&#x5355;&#x7684;&#x8def;&#x7531;&#x5b9a;&#x4e49;&#x3002;<span class=\"hljs-title class_\">Express</span> &#x5c06;&#x8def;&#x5f84;&#x5b57;&#x7b26;&#x4e32;&#x8f6c;&#x6362;&#x4e3a;&#x6b63;&#x5219;&#x8868;&#x8fbe;&#x5f0f;&#xff0c;&#x5728;&#x5185;&#x90e8;&#x7528;&#x4e8e;&#x5339;&#x914d;&#x4f20;&#x5165;&#x7684;&#x8bf7;&#x6c42;&#x3002;&#x6267;&#x884c;&#x8fd9;&#x4e9b;&#x5339;&#x914d;&#x65f6;&#x4e0d;&#x8003;&#x8651;&#x67e5;&#x8be2;&#x5b57;&#x7b26;&#x4e32;&#xff0c;&#x4f8b;&#x5982; <span class=\"hljs-string\">&quot;GET /&quot;</span> &#x5c06;&#x5339;&#x914d;&#x4ee5;&#x4e0b;&#x8def;&#x7531;&#xff0c;<span class=\"hljs-string\">&quot;GET /?name=tobi&quot;</span> &#x4e5f;&#x662f;&#x5982;&#x6b64;&#x3002;\n\nrouter.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;/&apos;</span>, <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res</span>) {\n  res.<span class=\"hljs-title function_\">send</span>(<span class=\"hljs-string\">&apos;hello world&apos;</span>)\n})\n&#x60a8;&#x8fd8;&#x53ef;&#x4ee5;&#x4f7f;&#x7528;&#x6b63;&#x5219;&#x8868;&#x8fbe;&#x5f0f;&#x2014;&#x2014;&#x5982;&#x679c;&#x60a8;&#x6709;&#x975e;&#x5e38;&#x5177;&#x4f53;&#x7684;&#x7ea6;&#x675f;&#xff0c;&#x5219;&#x5f88;&#x6709;&#x7528;&#xff0c;&#x4f8b;&#x5982;&#x4ee5;&#x4e0b;&#x5c06;&#x5339;&#x914d; <span class=\"hljs-string\">&quot;GET /commits/71dbb9c&quot;</span> &#x548c; <span class=\"hljs-string\">&quot;GET /commits/71dbb9c..4c084f9&quot;</span>&#x3002;\n\nrouter.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-regexp\">/^\\/commits\\/(\\w+)(?:\\.\\.(\\w+))?&#x24;/</span>, <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res</span>) {\n  <span class=\"hljs-keyword\">var</span> <span class=\"hljs-keyword\">from</span> = req.<span class=\"hljs-property\">params</span>[<span class=\"hljs-number\">0</span>]\n  <span class=\"hljs-keyword\">var</span> to = req.<span class=\"hljs-property\">params</span>[<span class=\"hljs-number\">1</span>] || <span class=\"hljs-string\">&apos;HEAD&apos;</span>\n  res.<span class=\"hljs-title function_\">send</span>(<span class=\"hljs-string\">&apos;commit range &apos;</span> + <span class=\"hljs-keyword\">from</span> + <span class=\"hljs-string\">&apos;..&apos;</span> + to)\n})\n router.<span class=\"hljs-title function_\">param</span>(name, callback)&#x4e2d;&#x82f1;\n&#x4e3a;&#x8def;&#x7531;&#x53c2;&#x6570;&#x6dfb;&#x52a0;&#x56de;&#x8c03;&#x89e6;&#x53d1;&#x5668;&#xff0c;&#x5176;&#x4e2d;name&#x4e3a;&#x53c2;&#x6570;&#x540d;&#x79f0;&#xff0c;callback&#x4e3a;&#x56de;&#x8c03;&#x51fd;&#x6570;&#x3002;&#x5c3d;&#x7ba1; name &#x5728;&#x6280;&#x672f;&#x4e0a;&#x662f;&#x53ef;&#x9009;&#x7684;&#xff0c;&#x4f46;&#x4ece; <span class=\"hljs-title class_\">Express</span> v4<span class=\"hljs-number\">.11</span><span class=\"hljs-number\">.0</span> &#x5f00;&#x59cb;&#x4e0d;&#x63a8;&#x8350;&#x4f7f;&#x7528;&#x6b64;&#x65b9;&#x6cd5;&#xff08;&#x89c1;&#x4e0b;&#x6587;&#xff09;&#x3002;\n\n&#x56de;&#x8c03;&#x51fd;&#x6570;&#x7684;&#x53c2;&#x6570;&#x4e3a;&#x200b;&#x200b;&#xff1a;\n\nreq&#xff0c;&#x8bf7;&#x6c42;&#x5bf9;&#x8c61;&#x3002;\nres&#xff0c;&#x54cd;&#x5e94;&#x5bf9;&#x8c61;&#x3002;\nnext&#xff0c;&#x8868;&#x793a;&#x4e0b;&#x4e00;&#x4e2a;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x3002;\nname &#x53c2;&#x6570;&#x7684;&#x503c;&#x3002;\n&#x53c2;&#x6570;&#x7684;&#x540d;&#x79f0;&#x3002;\n&#x4e0e; app.<span class=\"hljs-title function_\">param</span>() &#x4e0d;&#x540c;&#xff0c;router.<span class=\"hljs-title function_\">param</span>() &#x4e0d;&#x63a5;&#x53d7;&#x8def;&#x7531;&#x53c2;&#x6570;&#x6570;&#x7ec4;&#x3002;\n\n&#x4f8b;&#x5982;&#xff0c;&#x5f53; :user &#x51fa;&#x73b0;&#x5728;&#x8def;&#x7531;&#x8def;&#x5f84;&#x4e2d;&#x65f6;&#xff0c;&#x60a8;&#x53ef;&#x4ee5;&#x6620;&#x5c04;&#x7528;&#x6237;&#x52a0;&#x8f7d;&#x903b;&#x8f91;&#x4ee5;&#x81ea;&#x52a8;&#x5c06; req.<span class=\"hljs-property\">user</span> &#x63d0;&#x4f9b;&#x7ed9;&#x8def;&#x7531;&#xff0c;&#x6216;&#x5bf9;&#x53c2;&#x6570;&#x8f93;&#x5165;&#x6267;&#x884c;&#x9a8c;&#x8bc1;&#x3002;\n\nrouter.<span class=\"hljs-title function_\">param</span>(<span class=\"hljs-string\">&apos;user&apos;</span>, <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res, next, id</span>) {\n  <span class=\"hljs-comment\">// try to get the user details from the User model and attach it to the request object</span>\n  <span class=\"hljs-title class_\">User</span>.<span class=\"hljs-title function_\">find</span>(id, <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">err, user</span>) {\n    <span class=\"hljs-keyword\">if</span> (err) {\n      <span class=\"hljs-title function_\">next</span>(err)\n    } <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span> (user) {\n      req.<span class=\"hljs-property\">user</span> = user\n      <span class=\"hljs-title function_\">next</span>()\n    } <span class=\"hljs-keyword\">else</span> {\n      <span class=\"hljs-title function_\">next</span>(<span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Error</span>(<span class=\"hljs-string\">&apos;failed to load user&apos;</span>))\n    }\n  })\n})\n&#x53c2;&#x6570;&#x56de;&#x8c03;&#x51fd;&#x6570;&#x5728;&#x5b9a;&#x4e49;&#x5b83;&#x4eec;&#x7684;&#x8def;&#x7531;&#x4e0a;&#x662f;&#x672c;&#x5730;&#x7684;&#x3002;&#x5b83;&#x4eec;&#x4e0d;&#x4f1a;&#x88ab;&#x5b89;&#x88c5;&#x7684;&#x5e94;&#x7528;&#x7a0b;&#x5e8f;&#x6216;&#x8def;&#x7531;&#x7ee7;&#x627f;&#x3002;&#x56e0;&#x6b64;&#xff0c;&#x5728; router &#x4e0a;&#x5b9a;&#x4e49;&#x7684;&#x53c2;&#x6570;&#x56de;&#x8c03;&#x5c06;&#x4ec5;&#x7531;&#x5728; router &#x8def;&#x7531;&#x4e0a;&#x5b9a;&#x4e49;&#x7684;&#x8def;&#x7531;&#x53c2;&#x6570;&#x89e6;&#x53d1;&#x3002;\n\n&#x4e00;&#x4e2a;&#x53c2;&#x6570;&#x56de;&#x8c03;&#x5728;&#x8bf7;&#x6c42;-&#x54cd;&#x5e94;&#x5468;&#x671f;&#x4e2d;&#x53ea;&#x4f1a;&#x88ab;&#x8c03;&#x7528;&#x4e00;&#x6b21;&#xff0c;&#x5373;&#x4f7f;&#x8be5;&#x53c2;&#x6570;&#x5728;&#x591a;&#x4e2a;&#x8def;&#x7531;&#x4e2d;&#x5339;&#x914d;&#xff0c;&#x5982;&#x4e0b;&#x4f8b;&#x6240;&#x793a;&#x3002;\n\nrouter.<span class=\"hljs-title function_\">param</span>(<span class=\"hljs-string\">&apos;id&apos;</span>, <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res, next, id</span>) {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;CALLED ONLY ONCE&apos;</span>)\n  <span class=\"hljs-title function_\">next</span>()\n})\n\nrouter.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;/user/:id&apos;</span>, <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res, next</span>) {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;although this matches&apos;</span>)\n  <span class=\"hljs-title function_\">next</span>()\n})\n\nrouter.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;/user/:id&apos;</span>, <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res</span>) {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;and this matches too&apos;</span>)\n  res.<span class=\"hljs-title function_\">end</span>()\n})\n&#x5728; <span class=\"hljs-variable constant_\">GET</span> /user/<span class=\"hljs-number\">42</span> &#x4e0a;&#xff0c;&#x6253;&#x5370;&#x4ee5;&#x4e0b;&#x5185;&#x5bb9;&#xff1a;\n\n<span class=\"hljs-variable constant_\">CALLED</span> <span class=\"hljs-variable constant_\">ONLY</span> <span class=\"hljs-variable constant_\">ONCE</span>\nalthough <span class=\"hljs-variable language_\">this</span> matches\nand <span class=\"hljs-variable language_\">this</span> matches too\n&#x4ee5;&#x4e0b;&#x90e8;&#x5206;&#x63cf;&#x8ff0;&#x4e86; router.<span class=\"hljs-title function_\">param</span>(callback)&#xff0c;&#x81ea; v4<span class=\"hljs-number\">.11</span><span class=\"hljs-number\">.0</span> &#x8d77;&#x5df2;&#x5f03;&#x7528;&#x3002;\n\nrouter.<span class=\"hljs-title function_\">param</span>(name, callback) &#x65b9;&#x6cd5;&#x7684;&#x884c;&#x4e3a;&#x53ef;&#x4ee5;&#x901a;&#x8fc7;&#x53ea;&#x5411; router.<span class=\"hljs-title function_\">param</span>() &#x4f20;&#x9012;&#x4e00;&#x4e2a;&#x51fd;&#x6570;&#x6765;&#x5b8c;&#x5168;&#x6539;&#x53d8;&#x3002;&#x8fd9;&#x4e2a;&#x51fd;&#x6570;&#x662f; router.<span class=\"hljs-title function_\">param</span>(name, callback) &#x5e94;&#x8be5;&#x5982;&#x4f55;&#x8868;&#x73b0;&#x7684;&#x81ea;&#x5b9a;&#x4e49;&#x5b9e;&#x73b0;&#x2014;&#x2014;&#x5b83;&#x63a5;&#x53d7;&#x4e24;&#x4e2a;&#x53c2;&#x6570;&#x5e76;&#x4e14;&#x5fc5;&#x987b;&#x8fd4;&#x56de;&#x4e00;&#x4e2a;&#x4e2d;&#x95f4;&#x4ef6;&#x3002;\n\n&#x6b64;&#x51fd;&#x6570;&#x7684;&#x7b2c;&#x4e00;&#x4e2a;&#x53c2;&#x6570;&#x662f;&#x5e94;&#x6355;&#x83b7;&#x7684; <span class=\"hljs-variable constant_\">URL</span> &#x53c2;&#x6570;&#x7684;&#x540d;&#x79f0;&#xff0c;&#x7b2c;&#x4e8c;&#x4e2a;&#x53c2;&#x6570;&#x53ef;&#x4ee5;&#x662f;&#x4efb;&#x4f55;&#x53ef;&#x80fd;&#x7528;&#x4e8e;&#x8fd4;&#x56de;&#x4e2d;&#x95f4;&#x4ef6;&#x5b9e;&#x73b0;&#x7684; <span class=\"hljs-title class_\">JavaScript</span> &#x5bf9;&#x8c61;&#x3002;\n\n&#x51fd;&#x6570;&#x8fd4;&#x56de;&#x7684;&#x4e2d;&#x95f4;&#x4ef6;&#x51b3;&#x5b9a;&#x4e86;&#x6355;&#x83b7; <span class=\"hljs-variable constant_\">URL</span> &#x53c2;&#x6570;&#x65f6;&#x53d1;&#x751f;&#x7684;&#x884c;&#x4e3a;&#x3002;\n\n&#x5728;&#x6b64;&#x793a;&#x4f8b;&#x4e2d;&#xff0c;&#x5c06; router.<span class=\"hljs-title function_\">param</span>(name, callback) &#x7b7e;&#x540d;&#x4fee;&#x6539;&#x4e3a; router.<span class=\"hljs-title function_\">param</span>(name, accessId)&#x3002;router.<span class=\"hljs-title function_\">param</span>() &#x73b0;&#x5728;&#x5c06;&#x63a5;&#x53d7;&#x540d;&#x79f0;&#x548c;&#x53f7;&#x7801;&#xff0c;&#x800c;&#x4e0d;&#x662f;&#x63a5;&#x53d7;&#x540d;&#x79f0;&#x548c;&#x56de;&#x8c03;&#x3002;\n\n<span class=\"hljs-keyword\">var</span> express = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;express&apos;</span>)\n<span class=\"hljs-keyword\">var</span> app = <span class=\"hljs-title function_\">express</span>()\n<span class=\"hljs-keyword\">var</span> router = express.<span class=\"hljs-title class_\">Router</span>()\n\n<span class=\"hljs-comment\">// customizing the behavior of router.param()</span>\nrouter.<span class=\"hljs-title function_\">param</span>(<span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">param, option</span>) {\n  <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res, next, val</span>) {\n    <span class=\"hljs-keyword\">if</span> (val === option) {\n      <span class=\"hljs-title function_\">next</span>()\n    } <span class=\"hljs-keyword\">else</span> {\n      res.<span class=\"hljs-title function_\">sendStatus</span>(<span class=\"hljs-number\">403</span>)\n    }\n  }\n})\n\n<span class=\"hljs-comment\">// using the customized router.param()</span>\nrouter.<span class=\"hljs-title function_\">param</span>(<span class=\"hljs-string\">&apos;id&apos;</span>, <span class=\"hljs-string\">&apos;1337&apos;</span>)\n\n<span class=\"hljs-comment\">// route to trigger the capture</span>\nrouter.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;/user/:id&apos;</span>, <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res</span>) {\n  res.<span class=\"hljs-title function_\">send</span>(<span class=\"hljs-string\">&apos;OK&apos;</span>)\n})\n\napp.<span class=\"hljs-title function_\">use</span>(router)\n\napp.<span class=\"hljs-title function_\">listen</span>(<span class=\"hljs-number\">3000</span>, <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\"></span>) {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;Ready&apos;</span>)\n})\n&#x5728;&#x6b64;&#x793a;&#x4f8b;&#x4e2d;&#xff0c;router.<span class=\"hljs-title function_\">param</span>(name, callback) &#x7b7e;&#x540d;&#x4fdd;&#x6301;&#x4e0d;&#x53d8;&#xff0c;&#x4f46;&#x6ca1;&#x6709;&#x4f7f;&#x7528;&#x4e2d;&#x95f4;&#x4ef6;&#x56de;&#x8c03;&#xff0c;&#x800c;&#x662f;&#x5b9a;&#x4e49;&#x4e86;&#x81ea;&#x5b9a;&#x4e49;&#x6570;&#x636e;&#x7c7b;&#x578b;&#x68c0;&#x67e5;&#x51fd;&#x6570;&#x6765;&#x9a8c;&#x8bc1;&#x7528;&#x6237; <span class=\"hljs-variable constant_\">ID</span> &#x7684;&#x6570;&#x636e;&#x7c7b;&#x578b;&#x3002;\n\nrouter.<span class=\"hljs-title function_\">param</span>(<span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">param, validator</span>) {\n  <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res, next, val</span>) {\n    <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-title function_\">validator</span>(val)) {\n      <span class=\"hljs-title function_\">next</span>()\n    } <span class=\"hljs-keyword\">else</span> {\n      res.<span class=\"hljs-title function_\">sendStatus</span>(<span class=\"hljs-number\">403</span>)\n    }\n  }\n})\n\nrouter.<span class=\"hljs-title function_\">param</span>(<span class=\"hljs-string\">&apos;id&apos;</span>, <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">candidate</span>) {\n  <span class=\"hljs-keyword\">return</span> !<span class=\"hljs-built_in\">isNaN</span>(<span class=\"hljs-built_in\">parseFloat</span>(candidate)) &amp;&amp; <span class=\"hljs-built_in\">isFinite</span>(candidate)\n})\n router.<span class=\"hljs-title function_\">route</span>(path)&#x4e2d;&#x82f1;\n&#x8fd4;&#x56de;&#x5355;&#x4e2a;&#x8def;&#x7531;&#x7684;&#x5b9e;&#x4f8b;&#xff0c;&#x7136;&#x540e;&#x60a8;&#x53ef;&#x4ee5;&#x4f7f;&#x7528;&#x8be5;&#x5b9e;&#x4f8b;&#x5904;&#x7406;&#x5e26;&#x6709;&#x53ef;&#x9009;&#x4e2d;&#x95f4;&#x4ef6;&#x7684; <span class=\"hljs-variable constant_\">HTTP</span> &#x52a8;&#x8bcd;&#x3002;&#x4f7f;&#x7528; router.<span class=\"hljs-title function_\">route</span>() &#x6765;&#x907f;&#x514d;&#x91cd;&#x590d;&#x7684;&#x8def;&#x7531;&#x547d;&#x540d;&#xff0c;&#x4ece;&#x800c;&#x907f;&#x514d;&#x8f93;&#x5165;&#x9519;&#x8bef;&#x3002;\n\n&#x5728;&#x4e0a;&#x9762;&#x7684; router.<span class=\"hljs-title function_\">param</span>() &#x793a;&#x4f8b;&#x7684;&#x57fa;&#x7840;&#x4e0a;&#xff0c;&#x4ee5;&#x4e0b;&#x4ee3;&#x7801;&#x663e;&#x793a;&#x4e86;&#x5982;&#x4f55;&#x4f7f;&#x7528; router.<span class=\"hljs-title function_\">route</span>() &#x6765;&#x6307;&#x5b9a;&#x5404;&#x79cd; <span class=\"hljs-variable constant_\">HTTP</span> &#x65b9;&#x6cd5;&#x5904;&#x7406;&#x7a0b;&#x5e8f;&#x3002;\n\n<span class=\"hljs-keyword\">var</span> router = express.<span class=\"hljs-title class_\">Router</span>()\n\nrouter.<span class=\"hljs-title function_\">param</span>(<span class=\"hljs-string\">&apos;user_id&apos;</span>, <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res, next, id</span>) {\n  <span class=\"hljs-comment\">// sample user, would actually fetch from DB, etc...</span>\n  req.<span class=\"hljs-property\">user</span> = {\n    <span class=\"hljs-attr\">id</span>: id,\n    <span class=\"hljs-attr\">name</span>: <span class=\"hljs-string\">&apos;TJ&apos;</span>\n  }\n  <span class=\"hljs-title function_\">next</span>()\n})\n\nrouter.<span class=\"hljs-title function_\">route</span>(<span class=\"hljs-string\">&apos;/users/:user_id&apos;</span>)\n  .<span class=\"hljs-title function_\">all</span>(<span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res, next</span>) {\n    <span class=\"hljs-comment\">// runs for all HTTP verbs first</span>\n    <span class=\"hljs-comment\">// think of it as route specific middleware!</span>\n    <span class=\"hljs-title function_\">next</span>()\n  })\n  .<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res, next</span>) {\n    res.<span class=\"hljs-title function_\">json</span>(req.<span class=\"hljs-property\">user</span>)\n  })\n  .<span class=\"hljs-title function_\">put</span>(<span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res, next</span>) {\n    <span class=\"hljs-comment\">// just an example of maybe updating the user</span>\n    req.<span class=\"hljs-property\">user</span>.<span class=\"hljs-property\">name</span> = req.<span class=\"hljs-property\">params</span>.<span class=\"hljs-property\">name</span>\n    <span class=\"hljs-comment\">// save user ... etc</span>\n    res.<span class=\"hljs-title function_\">json</span>(req.<span class=\"hljs-property\">user</span>)\n  })\n  .<span class=\"hljs-title function_\">post</span>(<span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res, next</span>) {\n    <span class=\"hljs-title function_\">next</span>(<span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Error</span>(<span class=\"hljs-string\">&apos;not implemented&apos;</span>))\n  })\n  .<span class=\"hljs-title function_\">delete</span>(<span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res, next</span>) {\n    <span class=\"hljs-title function_\">next</span>(<span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Error</span>(<span class=\"hljs-string\">&apos;not implemented&apos;</span>))\n  })\n&#x6b64;&#x65b9;&#x6cd5;&#x91cd;&#x7528;&#x5355;&#x4e2a; /users/:user_id &#x8def;&#x5f84;&#x5e76;&#x4e3a;&#x5404;&#x79cd; <span class=\"hljs-variable constant_\">HTTP</span> &#x65b9;&#x6cd5;&#x6dfb;&#x52a0;&#x5904;&#x7406;&#x7a0b;&#x5e8f;&#x3002;\n\n&#x6ce8;&#x610f;&#xff1a;&#x5f53;&#x60a8;&#x4f7f;&#x7528; router.<span class=\"hljs-title function_\">route</span>() &#x65f6;&#xff0c;&#x4e2d;&#x95f4;&#x4ef6;&#x6392;&#x5e8f;&#x57fa;&#x4e8e;&#x8def;&#x7531;&#x521b;&#x5efa;&#x7684;&#x65f6;&#x95f4;&#xff0c;&#x800c;&#x4e0d;&#x662f;&#x65b9;&#x6cd5;&#x5904;&#x7406;&#x7a0b;&#x5e8f;&#x6dfb;&#x52a0;&#x5230;&#x8def;&#x7531;&#x7684;&#x65f6;&#x95f4;&#x3002;&#x4e3a;&#x6b64;&#xff0c;&#x60a8;&#x53ef;&#x4ee5;&#x8ba4;&#x4e3a;&#x65b9;&#x6cd5;&#x5904;&#x7406;&#x7a0b;&#x5e8f;&#x5c5e;&#x4e8e;&#x6dfb;&#x52a0;&#x5b83;&#x4eec;&#x7684;&#x8def;&#x7531;&#x3002;\n\n router.<span class=\"hljs-title function_\">use</span>([path], [<span class=\"hljs-keyword\">function</span>, ...] <span class=\"hljs-keyword\">function</span>)&#x4e2d;&#x82f1;\n&#x4f7f;&#x7528;&#x6307;&#x5b9a;&#x7684;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x6216;&#x51fd;&#x6570;&#xff0c;&#x5e26;&#x6709;&#x53ef;&#x9009;&#x7684;&#x6302;&#x8f7d;&#x8def;&#x5f84; path&#xff0c;&#x9ed8;&#x8ba4;&#x4e3a; <span class=\"hljs-string\">&quot;/&quot;</span>&#x3002;\n\n&#x6b64;&#x65b9;&#x6cd5;&#x4e0e; app.<span class=\"hljs-title function_\">use</span>() &#x7c7b;&#x4f3c;&#x3002;&#x4e0b;&#x9762;&#x63cf;&#x8ff0;&#x4e86;&#x4e00;&#x4e2a;&#x7b80;&#x5355;&#x7684;&#x793a;&#x4f8b;&#x548c;&#x7528;&#x4f8b;&#x3002;&#x6709;&#x5173;&#x8be6;&#x7ec6;&#x4fe1;&#x606f;&#xff0c;&#x8bf7;&#x53c2;&#x9605; app.<span class=\"hljs-title function_\">use</span>()&#x3002;\n\n&#x4e2d;&#x95f4;&#x4ef6;&#x5c31;&#x50cf;&#x4e00;&#x4e2a;&#x7ba1;&#x9053;&#xff1a;&#x8bf7;&#x6c42;&#x4ece;&#x5b9a;&#x4e49;&#x7684;&#x7b2c;&#x4e00;&#x4e2a;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x5f00;&#x59cb;&#xff0c;&#x5e76;&#x6309;&#x7167;&#x5b83;&#x4eec;&#x5339;&#x914d;&#x7684;&#x6bcf;&#x4e2a;&#x8def;&#x5f84;&#x7684;&#x4e2d;&#x95f4;&#x4ef6;&#x5806;&#x6808;&#x5904;&#x7406;&#x65b9;&#x5f0f;&#x5de5;&#x4f5c;&#x3002;\n\n<span class=\"hljs-keyword\">var</span> express = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;express&apos;</span>)\n<span class=\"hljs-keyword\">var</span> app = <span class=\"hljs-title function_\">express</span>()\n<span class=\"hljs-keyword\">var</span> router = express.<span class=\"hljs-title class_\">Router</span>()\n\n<span class=\"hljs-comment\">// simple logger for this router&apos;s requests</span>\n<span class=\"hljs-comment\">// all requests to this router will first hit this middleware</span>\nrouter.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res, next</span>) {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;%s %s %s&apos;</span>, req.<span class=\"hljs-property\">method</span>, req.<span class=\"hljs-property\">url</span>, req.<span class=\"hljs-property\">path</span>)\n  <span class=\"hljs-title function_\">next</span>()\n})\n\n<span class=\"hljs-comment\">// this will only be invoked if the path starts with /bar from the mount point</span>\nrouter.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-string\">&apos;/bar&apos;</span>, <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res, next</span>) {\n  <span class=\"hljs-comment\">// ... maybe some additional /bar logging ...</span>\n  <span class=\"hljs-title function_\">next</span>()\n})\n\n<span class=\"hljs-comment\">// always invoked</span>\nrouter.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res, next</span>) {\n  res.<span class=\"hljs-title function_\">send</span>(<span class=\"hljs-string\">&apos;Hello World&apos;</span>)\n})\n\napp.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-string\">&apos;/foo&apos;</span>, router)\n\napp.<span class=\"hljs-title function_\">listen</span>(<span class=\"hljs-number\">3000</span>)\n<span class=\"hljs-string\">&quot;mount&quot;</span> &#x8def;&#x5f84;&#x88ab;&#x5265;&#x79bb;&#x5e76;&#x4e14;&#x5bf9;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x4e0d;&#x53ef;&#x89c1;&#x3002;&#x6b64;&#x529f;&#x80fd;&#x7684;&#x4e3b;&#x8981;&#x6548;&#x679c;&#x662f;&#x6302;&#x8f7d;&#x7684;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x53ef;&#x4ee5;&#x5728;&#x4e0d;&#x66f4;&#x6539;&#x4ee3;&#x7801;&#x7684;&#x60c5;&#x51b5;&#x4e0b;&#x8fd0;&#x884c;&#xff0c;&#x65e0;&#x8bba;&#x5176; <span class=\"hljs-string\">&quot;prefix&quot;</span> &#x8def;&#x5f84;&#x540d;&#x5982;&#x4f55;&#x3002;\n\n&#x4f7f;&#x7528; router.<span class=\"hljs-title function_\">use</span>() &#x5b9a;&#x4e49;&#x4e2d;&#x95f4;&#x4ef6;&#x7684;&#x987a;&#x5e8f;&#x975e;&#x5e38;&#x91cd;&#x8981;&#x3002;&#x5b83;&#x4eec;&#x6309;&#x987a;&#x5e8f;&#x8c03;&#x7528;&#xff0c;&#x56e0;&#x6b64;&#x987a;&#x5e8f;&#x5b9a;&#x4e49;&#x4e86;&#x4e2d;&#x95f4;&#x4ef6;&#x4f18;&#x5148;&#x7ea7;&#x3002;&#x4f8b;&#x5982;&#xff0c;&#x901a;&#x5e38;&#x8bb0;&#x5f55;&#x5668;&#x662f;&#x60a8;&#x5c06;&#x4f7f;&#x7528;&#x7684;&#x7b2c;&#x4e00;&#x4e2a;&#x4e2d;&#x95f4;&#x4ef6;&#xff0c;&#x4ee5;&#x4fbf;&#x8bb0;&#x5f55;&#x6bcf;&#x4e2a;&#x8bf7;&#x6c42;&#x3002;\n\n<span class=\"hljs-keyword\">var</span> logger = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;morgan&apos;</span>)\n<span class=\"hljs-keyword\">var</span> path = <span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;path&apos;</span>)\n\nrouter.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-title function_\">logger</span>())\nrouter.<span class=\"hljs-title function_\">use</span>(express.<span class=\"hljs-title function_\">static</span>(path.<span class=\"hljs-title function_\">join</span>(__dirname, <span class=\"hljs-string\">&apos;public&apos;</span>)))\nrouter.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res</span>) {\n  res.<span class=\"hljs-title function_\">send</span>(<span class=\"hljs-string\">&apos;Hello&apos;</span>)\n})\n&#x73b0;&#x5728;&#x5047;&#x8bbe;&#x60a8;&#x60f3;&#x5ffd;&#x7565;&#x5bf9;&#x9759;&#x6001;&#x6587;&#x4ef6;&#x7684;&#x65e5;&#x5fd7;&#x8bb0;&#x5f55;&#x8bf7;&#x6c42;&#xff0c;&#x4f46;&#x7ee7;&#x7eed;&#x8bb0;&#x5f55; <span class=\"hljs-title function_\">logger</span>() &#x4e4b;&#x540e;&#x5b9a;&#x4e49;&#x7684;&#x8def;&#x7531;&#x548c;&#x4e2d;&#x95f4;&#x4ef6;&#x3002;&#x5728;&#x6dfb;&#x52a0;&#x8bb0;&#x5f55;&#x5668;&#x4e2d;&#x95f4;&#x4ef6;&#x4e4b;&#x524d;&#xff0c;&#x60a8;&#x53ea;&#x9700;&#x5c06;&#x5bf9; express.<span class=\"hljs-title function_\">static</span>() &#x7684;&#x8c03;&#x7528;&#x79fb;&#x81f3;&#x9876;&#x90e8;&#xff1a;\n\nrouter.<span class=\"hljs-title function_\">use</span>(express.<span class=\"hljs-title function_\">static</span>(path.<span class=\"hljs-title function_\">join</span>(__dirname, <span class=\"hljs-string\">&apos;public&apos;</span>)))\nrouter.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-title function_\">logger</span>())\nrouter.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res</span>) {\n  res.<span class=\"hljs-title function_\">send</span>(<span class=\"hljs-string\">&apos;Hello&apos;</span>)\n})\n&#x53e6;&#x4e00;&#x4e2a;&#x4f8b;&#x5b50;&#x662f;&#x4ece;&#x591a;&#x4e2a;&#x76ee;&#x5f55;&#x63d0;&#x4f9b;&#x6587;&#x4ef6;&#xff0c;&#x8ba9; <span class=\"hljs-string\">&quot;./public&quot;</span> &#x4f18;&#x5148;&#x4e8e;&#x5176;&#x4ed6;&#xff1a;\n\nrouter.<span class=\"hljs-title function_\">use</span>(express.<span class=\"hljs-title function_\">static</span>(path.<span class=\"hljs-title function_\">join</span>(__dirname, <span class=\"hljs-string\">&apos;public&apos;</span>)))\nrouter.<span class=\"hljs-title function_\">use</span>(express.<span class=\"hljs-title function_\">static</span>(path.<span class=\"hljs-title function_\">join</span>(__dirname, <span class=\"hljs-string\">&apos;files&apos;</span>)))\nrouter.<span class=\"hljs-title function_\">use</span>(express.<span class=\"hljs-title function_\">static</span>(path.<span class=\"hljs-title function_\">join</span>(__dirname, <span class=\"hljs-string\">&apos;uploads&apos;</span>)))\nrouter.<span class=\"hljs-title function_\">use</span>() &#x65b9;&#x6cd5;&#x8fd8;&#x652f;&#x6301;&#x547d;&#x540d;&#x53c2;&#x6570;&#xff0c;&#x56e0;&#x6b64;&#x60a8;&#x7684;&#x5176;&#x4ed6;&#x8def;&#x7531;&#x7684;&#x6302;&#x8f7d;&#x70b9;&#x53ef;&#x4ee5;&#x4ece;&#x4f7f;&#x7528;&#x547d;&#x540d;&#x53c2;&#x6570;&#x7684;&#x9884;&#x52a0;&#x8f7d;&#x4e2d;&#x53d7;&#x76ca;&#x3002;\n\n&#x6ce8;&#x610f;&#xff1a;&#x5c3d;&#x7ba1;&#x8fd9;&#x4e9b;&#x4e2d;&#x95f4;&#x4ef6;&#x51fd;&#x6570;&#x662f;&#x901a;&#x8fc7;&#x7279;&#x5b9a;&#x7684;&#x8def;&#x7531;&#x6dfb;&#x52a0;&#x7684;&#xff0c;&#x4f46;&#x5b83;&#x4eec;&#x8fd0;&#x884c;&#x65f6;&#x662f;&#x7531;&#x5b83;&#x4eec;&#x6240;&#x8fde;&#x63a5;&#x7684;&#x8def;&#x5f84;&#xff08;&#x800c;&#x4e0d;&#x662f;&#x8def;&#x7531;&#xff09;&#x5b9a;&#x4e49;&#x7684;&#x3002;&#x56e0;&#x6b64;&#xff0c;&#x5982;&#x679c;&#x8def;&#x7531;&#x5339;&#x914d;&#xff0c;&#x901a;&#x8fc7;&#x4e00;&#x4e2a;&#x8def;&#x7531;&#x6dfb;&#x52a0;&#x7684;&#x4e2d;&#x95f4;&#x4ef6;&#x53ef;&#x4ee5;&#x4e3a;&#x5176;&#x4ed6;&#x8def;&#x7531;&#x8fd0;&#x884c;&#x3002;&#x4f8b;&#x5982;&#xff0c;&#x6b64;&#x4ee3;&#x7801;&#x663e;&#x793a;&#x4e86;&#x5b89;&#x88c5;&#x5728;&#x540c;&#x4e00;&#x8def;&#x5f84;&#x4e0a;&#x7684;&#x4e24;&#x4e2a;&#x4e0d;&#x540c;&#x8def;&#x7531;&#xff1a;\n\n<span class=\"hljs-keyword\">var</span> authRouter = express.<span class=\"hljs-title class_\">Router</span>()\n<span class=\"hljs-keyword\">var</span> openRouter = express.<span class=\"hljs-title class_\">Router</span>()\n\nauthRouter.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-built_in\">require</span>(<span class=\"hljs-string\">&apos;./authenticate&apos;</span>).<span class=\"hljs-title function_\">basic</span>(usersdb))\n\nauthRouter.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;/:user_id/edit&apos;</span>, <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res, next</span>) {\n  <span class=\"hljs-comment\">// ... Edit user UI ...</span>\n})\nopenRouter.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;/&apos;</span>, <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res, next</span>) {\n  <span class=\"hljs-comment\">// ... List users ...</span>\n})\nopenRouter.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;/:user_id&apos;</span>, <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">req, res, next</span>) {\n  <span class=\"hljs-comment\">// ... View user ...</span>\n})\n\napp.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-string\">&apos;/users&apos;</span>, authRouter)\napp.<span class=\"hljs-title function_\">use</span>(<span class=\"hljs-string\">&apos;/users&apos;</span>, openRouter)\n&#x5373;&#x4f7f;&#x8eab;&#x4efd;&#x9a8c;&#x8bc1;&#x4e2d;&#x95f4;&#x4ef6;&#x662f;&#x901a;&#x8fc7; authRouter &#x6dfb;&#x52a0;&#x7684;&#xff0c;&#x5b83;&#x4e5f;&#x4f1a;&#x5728; openRouter &#x5b9a;&#x4e49;&#x7684;&#x8def;&#x7531;&#x4e0a;&#x8fd0;&#x884c;&#xff0c;&#x56e0;&#x4e3a;&#x4e24;&#x4e2a;&#x8def;&#x7531;&#x90fd;&#x5b89;&#x88c5;&#x5728; /users &#x4e0a;&#x3002;&#x4e3a;&#x907f;&#x514d;&#x6b64;&#x884c;&#x4e3a;&#xff0c;&#x8bf7;&#x4e3a;&#x6bcf;&#x4e2a;&#x8def;&#x7531;&#x4f7f;&#x7528;&#x4e0d;&#x540c;&#x7684;&#x8def;&#x5f84;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2531,2810"}},{"content":"<pre data-lines=\"2811,2818\"><code data-lines=\"2811,2818\">router<span class=\"hljs-selector-class\">.all</span>(<span class=\"hljs-selector-tag\">path</span>, <span class=\"hljs-selector-attr\">[callback, ...]</span> callback)\nrouter<span class=\"hljs-selector-class\">.METHOD</span>(<span class=\"hljs-selector-tag\">path</span>, <span class=\"hljs-selector-attr\">[callback, ...]</span> callback)\nrouter<span class=\"hljs-selector-class\">.param</span>(name, callback)\nrouter<span class=\"hljs-selector-class\">.route</span>(path)\nrouter<span class=\"hljs-selector-class\">.use</span>(<span class=\"hljs-selector-attr\">[path]</span>, <span class=\"hljs-selector-attr\">[function, ...]</span> function)\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2811,2818"}}],"payload":{"tag":"h1","lines":"2521,2522"}}]},{})</script>
</body>
</html>
