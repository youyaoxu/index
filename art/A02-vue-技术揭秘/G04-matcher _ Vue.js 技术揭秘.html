<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets@11.11.1/styles/default.min.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.18.10/dist/browser/index.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/index.js"></script><script>(r => {
              setTimeout(r);
            })(function renderToolbar() {
  const {
    markmap,
    mm
  } = window;
  const {
    el
  } = markmap.Toolbar.create(mm);
  el.setAttribute('style', 'position:absolute;bottom:20px;right:20px');
  document.body.append(el);
})</script><script>((getMarkmap, getOptions, root2, jsonOptions) => {
              const markmap = getMarkmap();
              window.mm = markmap.Markmap.create(
                "svg#mindmap",
                (getOptions || markmap.deriveOptions)(jsonOptions),
                root2
              );
            })(() => window.markmap,null,{"content":"<a href=\"#matcher\">#</a> matcher","children":[{"content":"&#x8ba4;&#x8bc6;","children":[{"content":"<pre data-lines=\"6,7\"><code>`matcher` &#x76f8;&#x5173;&#x7684;&#x5b9e;&#x73b0;&#x90fd;&#x5728; `src/create-matcher.js` &#x4e2d;&#xff0c;&#x6211;&#x4eec;&#x5148;&#x6765;&#x770b;&#x4e00;&#x4e0b; `matcher` &#x7684;&#x6570;&#x636e;&#x7ed3;&#x6784;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"6,7"}},{"content":"<pre data-lines=\"8,14\"><code data-lines=\"8,14\"><span class=\"hljs-keyword\">export</span> type Matcher = {\n  match: <span class=\"hljs-function\"><span class=\"hljs-params\">(raw: RawLocation, current?: Route, redirectedFrom?: Location)</span> =&gt;</span> Route;\n  addRoutes: <span class=\"hljs-function\"><span class=\"hljs-params\">(routes: <span class=\"hljs-built_in\">Array</span>&lt;RouteConfig&gt;)</span> =&gt;</span> <span class=\"hljs-keyword\">void</span>;\n}; \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"8,14"}},{"content":"<pre data-lines=\"15,18\"><code>`Matcher` &#x8fd4;&#x56de;&#x4e86; 2 &#x4e2a;&#x65b9;&#x6cd5;&#xff0c;`match` &#x548c; `addRoutes`&#xff0c;&#x5728;&#x4e0a;&#x4e00;&#x8282;&#x6211;&#x4eec;&#x63a5;&#x89e6;&#x5230;&#x4e86; `match` &#x65b9;&#x6cd5;&#xff0c;&#x987e;&#x540d;&#x601d;&#x4e49;&#x5b83;&#x662f;&#x505a;&#x5339;&#x914d;&#xff0c;&#x90a3;&#x4e48;&#x5339;&#x914d;&#x7684;&#x662f;&#x4ec0;&#x4e48;&#xff0c;&#x5728;&#x4ecb;&#x7ecd;&#x4e4b;&#x524d;&#xff0c;&#x6211;&#x4eec;&#x5148;&#x4e86;&#x89e3;&#x8def;&#x7531;&#x4e2d;&#x91cd;&#x8981;&#x7684; 2 &#x4e2a;&#x6982;&#x5ff5;&#xff0c;`Loaction` &#x548c; `Route`&#xff0c;&#x5b83;&#x4eec;&#x7684;&#x6570;&#x636e;&#x7ed3;&#x6784;&#x5b9a;&#x4e49;&#x5728; `flow/declarations.js` &#x4e2d;&#x3002;\n\n*   Location\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"15,18"}},{"content":"<pre data-lines=\"19,31\"><code data-lines=\"19,31\">declare <span class=\"hljs-keyword\">type</span> Location = {\n  _normalized?: <span class=\"hljs-built_in\">boolean</span>;\n  name?: <span class=\"hljs-built_in\">string</span>;\n  path?: <span class=\"hljs-built_in\">string</span>;\n  hash?: <span class=\"hljs-built_in\">string</span>;\n  query?: Dictionary&lt;<span class=\"hljs-built_in\">string</span>&gt;;\n  <span class=\"hljs-keyword\">params</span>?: Dictionary&lt;<span class=\"hljs-built_in\">string</span>&gt;;\n  append?: <span class=\"hljs-built_in\">boolean</span>;\n  replace?: <span class=\"hljs-built_in\">boolean</span>;\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"19,31"}},{"content":"<pre data-lines=\"32,35\"><code>Vue-Router &#x4e2d;&#x5b9a;&#x4e49;&#x7684; `Location` &#x6570;&#x636e;&#x7ed3;&#x6784;&#x548c;&#x6d4f;&#x89c8;&#x5668;&#x63d0;&#x4f9b;&#x7684; `window.location` &#x90e8;&#x5206;&#x7ed3;&#x6784;&#x6709;&#x70b9;&#x7c7b;&#x4f3c;&#xff0c;&#x5b83;&#x4eec;&#x90fd;&#x662f;&#x5bf9; `url` &#x7684;&#x7ed3;&#x6784;&#x5316;&#x63cf;&#x8ff0;&#x3002;&#x4e3e;&#x4e2a;&#x4f8b;&#x5b50;&#xff1a;`/abc?foo=bar&amp;baz=qux#hello`&#xff0c;&#x5b83;&#x7684; `path` &#x662f; `/abc`&#xff0c;`query` &#x662f; `{foo:&apos;bar&apos;,baz:&apos;qux&apos;}`&#x3002;`Location` &#x7684;&#x5176;&#x4ed6;&#x5c5e;&#x6027;&#x6211;&#x4eec;&#x4e4b;&#x540e;&#x4f1a;&#x4ecb;&#x7ecd;&#x3002;\n\n*   Route\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"32,35"}},{"content":"<pre data-lines=\"36,49\"><code data-lines=\"36,49\"><span class=\"hljs-keyword\">declare</span> <span class=\"hljs-keyword\">type</span> <span class=\"hljs-title class_\">Route</span> = {\n  <span class=\"hljs-attr\">path</span>: <span class=\"hljs-built_in\">string</span>;\n  <span class=\"hljs-attr\">name</span>: ?<span class=\"hljs-built_in\">string</span>;\n  <span class=\"hljs-attr\">hash</span>: <span class=\"hljs-built_in\">string</span>;\n  <span class=\"hljs-attr\">query</span>: <span class=\"hljs-title class_\">Dictionary</span>&lt;<span class=\"hljs-built_in\">string</span>&gt;;\n  <span class=\"hljs-attr\">params</span>: <span class=\"hljs-title class_\">Dictionary</span>&lt;<span class=\"hljs-built_in\">string</span>&gt;;\n  <span class=\"hljs-attr\">fullPath</span>: <span class=\"hljs-built_in\">string</span>;\n  <span class=\"hljs-attr\">matched</span>: <span class=\"hljs-title class_\">Array</span>&lt;<span class=\"hljs-title class_\">RouteRecord</span>&gt;;\n  <span class=\"hljs-attr\">redirectedFrom</span>?: <span class=\"hljs-built_in\">string</span>;\n  <span class=\"hljs-attr\">meta</span>?: <span class=\"hljs-built_in\">any</span>;\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"36,49"}},{"content":"<pre data-lines=\"50,51\"><code>`Route` &#x8868;&#x793a;&#x7684;&#x662f;&#x8def;&#x7531;&#x4e2d;&#x7684;&#x4e00;&#x6761;&#x7ebf;&#x8def;&#xff0c;&#x5b83;&#x9664;&#x4e86;&#x63cf;&#x8ff0;&#x4e86;&#x7c7b;&#x4f3c; `Loctaion` &#x7684; `path`&#x3001;`query`&#x3001;`hash` &#x8fd9;&#x4e9b;&#x6982;&#x5ff5;&#xff0c;&#x8fd8;&#x6709; `matched` &#x8868;&#x793a;&#x5339;&#x914d;&#x5230;&#x7684;&#x6240;&#x6709;&#x7684; `RouteRecord`&#x3002;`Route` &#x7684;&#x5176;&#x4ed6;&#x5c5e;&#x6027;&#x6211;&#x4eec;&#x4e4b;&#x540e;&#x4f1a;&#x4ecb;&#x7ecd;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"50,51"}}],"payload":{"tag":"h2","lines":"3,5"}},{"content":"<a href=\"#creatematcher\">#</a> <code>createMatcher</code>","children":[{"content":"<pre data-lines=\"55,56\"><code>&#x5728;&#x4e86;&#x89e3;&#x4e86; `Location` &#x548c; `Route` &#x540e;&#xff0c;&#x6211;&#x4eec;&#x6765;&#x770b;&#x4e00;&#x4e0b; `matcher` &#x7684;&#x521b;&#x5efa;&#x8fc7;&#x7a0b;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"55,56"}},{"content":"<pre data-lines=\"57,137\"><code data-lines=\"57,137\"><span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">createMatcher</span> (<span class=\"hljs-params\">\n  routes: <span class=\"hljs-built_in\">Array</span>&lt;RouteConfig&gt;,\n  router: VueRouter\n</span>): <span class=\"hljs-title class_\">Matcher</span> {\n  <span class=\"hljs-keyword\">const</span> { pathList, pathMap, nameMap } = <span class=\"hljs-title function_\">createRouteMap</span>(routes)\n\n  <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">addRoutes</span> (<span class=\"hljs-params\">routes</span>) {\n    <span class=\"hljs-title function_\">createRouteMap</span>(routes, pathList, pathMap, nameMap)\n  }\n\n  <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">match</span> (<span class=\"hljs-params\">\n    raw: RawLocation,\n    currentRoute?: Route,\n    redirectedFrom?: Location\n  </span>): <span class=\"hljs-title class_\">Route</span> {\n    <span class=\"hljs-keyword\">const</span> location = <span class=\"hljs-title function_\">normalizeLocation</span>(raw, currentRoute, <span class=\"hljs-literal\">false</span>, router)\n    <span class=\"hljs-keyword\">const</span> { name } = location\n\n    <span class=\"hljs-keyword\">if</span> (name) {\n      <span class=\"hljs-keyword\">const</span> record = nameMap[name]\n      <span class=\"hljs-keyword\">if</span> (process.<span class=\"hljs-property\">env</span>.<span class=\"hljs-property\">NODE_ENV</span> !== <span class=\"hljs-string\">&apos;production&apos;</span>) {\n        <span class=\"hljs-title function_\">warn</span>(record, <span class=\"hljs-string\">`Route with name &apos;<span class=\"hljs-subst\">&#x24;{name}</span>&apos; does not exist`</span>)\n      }\n      <span class=\"hljs-keyword\">if</span> (!record) <span class=\"hljs-keyword\">return</span> <span class=\"hljs-title function_\">_createRoute</span>(<span class=\"hljs-literal\">null</span>, location)\n      <span class=\"hljs-keyword\">const</span> paramNames = record.<span class=\"hljs-property\">regex</span>.<span class=\"hljs-property\">keys</span>\n        .<span class=\"hljs-title function_\">filter</span>(<span class=\"hljs-function\"><span class=\"hljs-params\">key</span> =&gt;</span> !key.<span class=\"hljs-property\">optional</span>)\n        .<span class=\"hljs-title function_\">map</span>(<span class=\"hljs-function\"><span class=\"hljs-params\">key</span> =&gt;</span> key.<span class=\"hljs-property\">name</span>)\n\n      <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-keyword\">typeof</span> location.<span class=\"hljs-property\">params</span> !== <span class=\"hljs-string\">&apos;object&apos;</span>) {\n        location.<span class=\"hljs-property\">params</span> = {}\n      }\n\n      <span class=\"hljs-keyword\">if</span> (currentRoute &amp;&amp; <span class=\"hljs-keyword\">typeof</span> currentRoute.<span class=\"hljs-property\">params</span> === <span class=\"hljs-string\">&apos;object&apos;</span>) {\n        <span class=\"hljs-keyword\">for</span> (<span class=\"hljs-keyword\">const</span> key <span class=\"hljs-keyword\">in</span> currentRoute.<span class=\"hljs-property\">params</span>) {\n          <span class=\"hljs-keyword\">if</span> (!(key <span class=\"hljs-keyword\">in</span> location.<span class=\"hljs-property\">params</span>) &amp;&amp; paramNames.<span class=\"hljs-title function_\">indexOf</span>(key) &gt; -<span class=\"hljs-number\">1</span>) {\n            location.<span class=\"hljs-property\">params</span>[key] = currentRoute.<span class=\"hljs-property\">params</span>[key]\n          }\n        }\n      }\n\n      <span class=\"hljs-keyword\">if</span> (record) {\n        location.<span class=\"hljs-property\">path</span> = <span class=\"hljs-title function_\">fillParams</span>(record.<span class=\"hljs-property\">path</span>, location.<span class=\"hljs-property\">params</span>, <span class=\"hljs-string\">`named route &quot;<span class=\"hljs-subst\">&#x24;{name}</span>&quot;`</span>)\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-title function_\">_createRoute</span>(record, location, redirectedFrom)\n      }\n    } <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span> (location.<span class=\"hljs-property\">path</span>) {\n      location.<span class=\"hljs-property\">params</span> = {}\n      <span class=\"hljs-keyword\">for</span> (<span class=\"hljs-keyword\">let</span> i = <span class=\"hljs-number\">0</span>; i &lt; pathList.<span class=\"hljs-property\">length</span>; i++) {\n        <span class=\"hljs-keyword\">const</span> path = pathList[i]\n        <span class=\"hljs-keyword\">const</span> record = pathMap[path]\n        <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-title function_\">matchRoute</span>(record.<span class=\"hljs-property\">regex</span>, location.<span class=\"hljs-property\">path</span>, location.<span class=\"hljs-property\">params</span>)) {\n          <span class=\"hljs-keyword\">return</span> <span class=\"hljs-title function_\">_createRoute</span>(record, location, redirectedFrom)\n        }\n      }\n    }\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-title function_\">_createRoute</span>(<span class=\"hljs-literal\">null</span>, location)\n  }\n\n  <span class=\"hljs-comment\">// ...</span>\n\n  <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">_createRoute</span> (<span class=\"hljs-params\">\n    record: ?RouteRecord,\n    location: Location,\n    redirectedFrom?: Location\n  </span>): <span class=\"hljs-title class_\">Route</span> {\n    <span class=\"hljs-keyword\">if</span> (record &amp;&amp; record.<span class=\"hljs-property\">redirect</span>) {\n      <span class=\"hljs-keyword\">return</span> <span class=\"hljs-title function_\">redirect</span>(record, redirectedFrom || location)\n    }\n    <span class=\"hljs-keyword\">if</span> (record &amp;&amp; record.<span class=\"hljs-property\">matchAs</span>) {\n      <span class=\"hljs-keyword\">return</span> <span class=\"hljs-title function_\">alias</span>(record, location, record.<span class=\"hljs-property\">matchAs</span>)\n    }\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-title function_\">createRoute</span>(record, location, redirectedFrom, router)\n  }\n\n  <span class=\"hljs-keyword\">return</span> {\n    match,\n    addRoutes\n  }\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"57,137"}},{"content":"<pre data-lines=\"138,139\"><code>`createMatcher` &#x63a5;&#x6536; 2 &#x4e2a;&#x53c2;&#x6570;&#xff0c;&#x4e00;&#x4e2a;&#x662f; `router`&#xff0c;&#x5b83;&#x662f;&#x6211;&#x4eec; `new VueRouter` &#x8fd4;&#x56de;&#x7684;&#x5b9e;&#x4f8b;&#xff0c;&#x4e00;&#x4e2a;&#x662f; `routes`&#xff0c;&#x5b83;&#x662f;&#x7528;&#x6237;&#x5b9a;&#x4e49;&#x7684;&#x8def;&#x7531;&#x914d;&#x7f6e;&#xff0c;&#x6765;&#x770b;&#x4e00;&#x4e0b;&#x6211;&#x4eec;&#x4e4b;&#x524d;&#x4e3e;&#x7684;&#x4f8b;&#x5b50;&#x4e2d;&#x7684;&#x914d;&#x7f6e;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"138,139"}},{"content":"<pre data-lines=\"140,149\"><code data-lines=\"140,149\"><span class=\"hljs-keyword\">const</span> <span class=\"hljs-type\">Foo</span> = { <span class=\"hljs-keyword\">template</span>: &apos;&lt;<span class=\"hljs-keyword\">div</span>&gt;foo&lt;/<span class=\"hljs-keyword\">div</span>&gt;&apos; }\n<span class=\"hljs-keyword\">const</span> <span class=\"hljs-type\">Bar</span> = { <span class=\"hljs-keyword\">template</span>: &apos;&lt;<span class=\"hljs-keyword\">div</span>&gt;bar&lt;/<span class=\"hljs-keyword\">div</span>&gt;&apos; }\n\n<span class=\"hljs-keyword\">const</span> routes = [\n  { path: &apos;/foo&apos;, component: <span class=\"hljs-type\">Foo</span> },\n  { path: &apos;/bar&apos;, component: <span class=\"hljs-type\">Bar</span> }\n] \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"140,149"}},{"content":"<pre data-lines=\"150,151\"><code>`createMathcer` &#x9996;&#x5148;&#x6267;&#x884c;&#x7684;&#x903b;&#x8f91;&#x662f; `const { pathList, pathMap, nameMap } = createRouteMap(routes)` &#x521b;&#x5efa;&#x4e00;&#x4e2a;&#x8def;&#x7531;&#x6620;&#x5c04;&#x8868;&#xff0c;`createRouteMap` &#x7684;&#x5b9a;&#x4e49;&#x5728; `src/create-route-map` &#x4e2d;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"150,151"}},{"content":"<pre data-lines=\"152,186\"><code data-lines=\"152,186\">export <span class=\"hljs-keyword\">function</span> createRouteMap (\n  routes: <span class=\"hljs-keyword\">Array</span>&lt;RouteConfig&gt;,\n  oldPathList?: <span class=\"hljs-keyword\">Array</span>&lt;string&gt;,\n  oldPathMap?: <span class=\"hljs-keyword\">Dictionary</span>&lt;RouteRecord&gt;,\n  oldNameMap?: <span class=\"hljs-keyword\">Dictionary</span>&lt;RouteRecord&gt;\n): {\n  pathList: <span class=\"hljs-keyword\">Array</span>&lt;string&gt;;\n  pathMap: <span class=\"hljs-keyword\">Dictionary</span>&lt;RouteRecord&gt;;\n  nameMap: <span class=\"hljs-keyword\">Dictionary</span>&lt;RouteRecord&gt;;\n} {\n  const pathList: <span class=\"hljs-keyword\">Array</span>&lt;string&gt; = oldPathList || []\n  const pathMap: <span class=\"hljs-keyword\">Dictionary</span>&lt;RouteRecord&gt; = oldPathMap || <span class=\"hljs-keyword\">Object</span>.<span class=\"hljs-keyword\">create</span>(<span class=\"hljs-keyword\">null</span>)\n  const nameMap: <span class=\"hljs-keyword\">Dictionary</span>&lt;RouteRecord&gt; = oldNameMap || <span class=\"hljs-keyword\">Object</span>.<span class=\"hljs-keyword\">create</span>(<span class=\"hljs-keyword\">null</span>)\n\n  routes.<span class=\"hljs-keyword\">forEach</span>(route =&gt; {\n    addRouteRecord(pathList, pathMap, nameMap, route)\n  })\n\n  <span class=\"hljs-keyword\">for</span> (let i = <span class=\"hljs-number\">0</span>, l = pathList.length; i &lt; l; i++) {\n    <span class=\"hljs-keyword\">if</span> (pathList[i] === <span class=\"hljs-string\">&apos;*&apos;</span>) {\n      pathList.push(pathList.splice(i, <span class=\"hljs-number\">1</span>)[<span class=\"hljs-number\">0</span>])\n      l<span class=\"hljs-comment\">--</span>\n      i<span class=\"hljs-comment\">--</span>\n    }\n  }\n\n  <span class=\"hljs-keyword\">return</span> {\n    pathList,\n    pathMap,\n    nameMap\n  }\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"152,186"}},{"content":"<pre data-lines=\"187,188\"><code>`createRouteMap` &#x51fd;&#x6570;&#x7684;&#x76ee;&#x6807;&#x662f;&#x628a;&#x7528;&#x6237;&#x7684;&#x8def;&#x7531;&#x914d;&#x7f6e;&#x8f6c;&#x6362;&#x6210;&#x4e00;&#x5f20;&#x8def;&#x7531;&#x6620;&#x5c04;&#x8868;&#xff0c;&#x5b83;&#x5305;&#x542b; 3 &#x4e2a;&#x90e8;&#x5206;&#xff0c;`pathList` &#x5b58;&#x50a8;&#x6240;&#x6709;&#x7684; `path`&#xff0c;`pathMap` &#x8868;&#x793a;&#x4e00;&#x4e2a; `path` &#x5230; `RouteRecord` &#x7684;&#x6620;&#x5c04;&#x5173;&#x7cfb;&#xff0c;&#x800c; `nameMap` &#x8868;&#x793a; `name` &#x5230; `RouteRecord` &#x7684;&#x6620;&#x5c04;&#x5173;&#x7cfb;&#x3002;&#x90a3;&#x4e48; `RouteRecord` &#x5230;&#x5e95;&#x662f;&#x4ec0;&#x4e48;&#xff0c;&#x5148;&#x6765;&#x770b;&#x4e00;&#x4e0b;&#x5b83;&#x7684;&#x6570;&#x636e;&#x7ed3;&#x6784;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"187,188"}},{"content":"<pre data-lines=\"189,204\"><code data-lines=\"189,204\"><span class=\"hljs-keyword\">declare</span> <span class=\"hljs-keyword\">type</span> RouteRecord = {\n  <span class=\"hljs-type\">path</span>: string;\n  regex: RouteRegExp;\n  components: <span class=\"hljs-keyword\">Dictionary</span>&lt;<span class=\"hljs-keyword\">any</span>&gt;;\n  instances: <span class=\"hljs-keyword\">Dictionary</span>&lt;<span class=\"hljs-keyword\">any</span>&gt;;\n  <span class=\"hljs-type\">name</span>: ?string;\n  parent: ?RouteRecord;\n  redirect: ?RedirectOption;\n  matchAs: ?string;\n  beforeEnter: ?NavigationGuard;\n  meta: <span class=\"hljs-keyword\">any</span>;\n  props: <span class=\"hljs-type\">boolean</span> | <span class=\"hljs-keyword\">Object</span> | <span class=\"hljs-keyword\">Function</span> | <span class=\"hljs-keyword\">Dictionary</span>&lt;<span class=\"hljs-type\">boolean</span> | <span class=\"hljs-keyword\">Object</span> | <span class=\"hljs-keyword\">Function</span>&gt;;\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"189,204"}},{"content":"<pre data-lines=\"205,206\"><code>&#x5b83;&#x7684;&#x521b;&#x5efa;&#x662f;&#x901a;&#x8fc7;&#x904d;&#x5386; `routes` &#x4e3a;&#x6bcf;&#x4e00;&#x4e2a; `route` &#x6267;&#x884c; `addRouteRecord` &#x65b9;&#x6cd5;&#x751f;&#x6210;&#x4e00;&#x6761;&#x8bb0;&#x5f55;&#xff0c;&#x6765;&#x770b;&#x4e00;&#x4e0b;&#x5b83;&#x7684;&#x5b9a;&#x4e49;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"205,206"}},{"content":"<pre data-lines=\"207,315\"><code data-lines=\"207,315\"><span class=\"hljs-keyword\">function</span> addRouteRecord (\n  pathList: <span class=\"hljs-keyword\">Array</span>&lt;string&gt;,\n  pathMap: <span class=\"hljs-keyword\">Dictionary</span>&lt;RouteRecord&gt;,\n  nameMap: <span class=\"hljs-keyword\">Dictionary</span>&lt;RouteRecord&gt;,\n  route: RouteConfig,\n  parent?: RouteRecord,\n  matchAs?: string\n) {\n  const { <span class=\"hljs-type\">path</span>, <span class=\"hljs-type\">name</span> } = route\n  <span class=\"hljs-keyword\">if</span> (process.env.NODE_ENV !== <span class=\"hljs-string\">&apos;production&apos;</span>) {\n    <span class=\"hljs-keyword\">assert</span>(<span class=\"hljs-type\">path</span> != <span class=\"hljs-keyword\">null</span>, `&quot;path&quot; <span class=\"hljs-keyword\">is</span> required <span class=\"hljs-keyword\">in</span> a route <span class=\"hljs-keyword\">configuration</span>.`)\n    <span class=\"hljs-keyword\">assert</span>(\n      typeof route.component !== <span class=\"hljs-string\">&apos;string&apos;</span>,\n      `route config &quot;component&quot; <span class=\"hljs-keyword\">for</span> <span class=\"hljs-type\">path</span>: &#x24;{String(<span class=\"hljs-type\">path</span> || <span class=\"hljs-type\">name</span>)} cannot be a ` +\n      `string id. Use an actual component <span class=\"hljs-keyword\">instead</span>.`\n    )\n  }\n\n  const pathToRegexpOptions: PathToRegexpOptions = route.pathToRegexpOptions || {}\n  const normalizedPath = normalizePath(\n    <span class=\"hljs-type\">path</span>,\n    parent,\n    pathToRegexpOptions.<span class=\"hljs-keyword\">strict</span>\n  )\n\n  <span class=\"hljs-keyword\">if</span> (typeof route.caseSensitive === <span class=\"hljs-string\">&apos;boolean&apos;</span>) {\n    pathToRegexpOptions.sensitive = route.caseSensitive\n  }\n\n  const <span class=\"hljs-type\">record</span>: RouteRecord = {\n    <span class=\"hljs-type\">path</span>: normalizedPath,\n    regex: compileRouteRegex(normalizedPath, pathToRegexpOptions),\n    components: route.components || { <span class=\"hljs-keyword\">default</span>: route.component },\n    instances: {},\n    <span class=\"hljs-type\">name</span>,\n    parent,\n    matchAs,\n    redirect: route.redirect,\n    beforeEnter: route.beforeEnter,\n    meta: route.meta || {},\n    props: route.props == <span class=\"hljs-keyword\">null</span>\n      ? {}\n      : route.components\n        ? route.props\n        : { <span class=\"hljs-keyword\">default</span>: route.props }\n  }\n\n  <span class=\"hljs-keyword\">if</span> (route.children) {\n    <span class=\"hljs-keyword\">if</span> (process.env.NODE_ENV !== <span class=\"hljs-string\">&apos;production&apos;</span>) {\n      <span class=\"hljs-keyword\">if</span> (route.name &amp;&amp; !route.redirect &amp;&amp; route.children.<span class=\"hljs-keyword\">some</span>(child =&gt; /^\\/?&#x24;/.test(child.path))) {\n        warn(\n          <span class=\"hljs-keyword\">false</span>,\n          `Named Route <span class=\"hljs-string\">&apos;&#x24;{route.name}&apos;</span> has a <span class=\"hljs-keyword\">default</span> child route. ` +\n          `<span class=\"hljs-keyword\">When</span> navigating <span class=\"hljs-keyword\">to</span> this named route (:<span class=\"hljs-keyword\">to</span>=&quot;{name: &apos;&#x24;{route.name}&apos;&quot;), ` +\n          `the <span class=\"hljs-keyword\">default</span> child route will <span class=\"hljs-keyword\">not</span> be rendered. Remove the <span class=\"hljs-type\">name</span> <span class=\"hljs-keyword\">from</span> ` +\n          `this route <span class=\"hljs-keyword\">and</span> use the <span class=\"hljs-type\">name</span> <span class=\"hljs-keyword\">of</span> the <span class=\"hljs-keyword\">default</span> child route <span class=\"hljs-keyword\">for</span> named ` +\n          `links <span class=\"hljs-keyword\">instead</span>.`\n        )\n      }\n    }\n    route.children.<span class=\"hljs-keyword\">forEach</span>(child =&gt; {\n      const childMatchAs = matchAs\n        ? cleanPath(`&#x24;{matchAs}/&#x24;{child.path}`)\n        : undefined\n      addRouteRecord(pathList, pathMap, nameMap, child, <span class=\"hljs-type\">record</span>, childMatchAs)\n    })\n  }\n\n  <span class=\"hljs-keyword\">if</span> (route.<span class=\"hljs-keyword\">alias</span> !== undefined) {\n    const aliases = <span class=\"hljs-keyword\">Array</span>.isArray(route.<span class=\"hljs-keyword\">alias</span>)\n      ? route.<span class=\"hljs-keyword\">alias</span>\n      : [route.<span class=\"hljs-keyword\">alias</span>]\n\n    aliases.<span class=\"hljs-keyword\">forEach</span>(<span class=\"hljs-keyword\">alias</span> =&gt; {\n      const aliasRoute = {\n        <span class=\"hljs-type\">path</span>: <span class=\"hljs-keyword\">alias</span>,\n        children: route.children\n      }\n      addRouteRecord(\n        pathList,\n        pathMap,\n        nameMap,\n        aliasRoute,\n        parent,\n        <span class=\"hljs-type\">record</span>.path || <span class=\"hljs-string\">&apos;/&apos;</span>\n      )\n    })\n  }\n\n  <span class=\"hljs-keyword\">if</span> (!pathMap[<span class=\"hljs-type\">record</span>.path]) {\n    pathList.push(<span class=\"hljs-type\">record</span>.path)\n    pathMap[<span class=\"hljs-type\">record</span>.path] = <span class=\"hljs-type\">record</span>\n  }\n\n  <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-type\">name</span>) {\n    <span class=\"hljs-keyword\">if</span> (!nameMap[<span class=\"hljs-type\">name</span>]) {\n      nameMap[<span class=\"hljs-type\">name</span>] = <span class=\"hljs-type\">record</span>\n    } <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span> (process.env.NODE_ENV !== <span class=\"hljs-string\">&apos;production&apos;</span> &amp;&amp; !matchAs) {\n      warn(\n        <span class=\"hljs-keyword\">false</span>,\n        `Duplicate named routes definition: ` +\n        `{ <span class=\"hljs-type\">name</span>: &quot;&#x24;{name}&quot;, <span class=\"hljs-type\">path</span>: &quot;&#x24;{record.path}&quot; }`\n      )\n    }\n  }\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"207,315"}},{"content":"<pre data-lines=\"316,317\"><code>&#x6211;&#x4eec;&#x53ea;&#x770b;&#x51e0;&#x4e2a;&#x5173;&#x952e;&#x903b;&#x8f91;&#xff0c;&#x9996;&#x5148;&#x521b;&#x5efa; `RouteRecord` &#x7684;&#x4ee3;&#x7801;&#x5982;&#x4e0b;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"316,317"}},{"content":"<pre data-lines=\"318,337\"><code data-lines=\"318,337\"> const <span class=\"hljs-params\">record:</span> RouteRecord <span class=\"hljs-operator\">=</span> {\n  <span class=\"hljs-params\">path:</span> normalizedPath,\n  <span class=\"hljs-params\">regex:</span> compileRouteRegex(normalizedPath, pathToRegexpOptions),\n  <span class=\"hljs-params\">components:</span> route.components <span class=\"hljs-operator\">||</span> { <span class=\"hljs-params\">default:</span> route.component },\n  <span class=\"hljs-params\">instances:</span> {},\n  name,\n  parent,\n  matchAs,\n  <span class=\"hljs-params\">redirect:</span> route.redirect,\n  <span class=\"hljs-params\">beforeEnter:</span> route.beforeEnter,\n  <span class=\"hljs-params\">meta:</span> route.meta <span class=\"hljs-operator\">||</span> {},\n  <span class=\"hljs-params\">props:</span> route.props <span class=\"hljs-operator\">==</span> <span class=\"hljs-literal\">null</span>\n    <span class=\"hljs-operator\">?</span> {}\n    : route.components\n      <span class=\"hljs-operator\">?</span> route.<span class=\"hljs-params\">props\n      :</span> { <span class=\"hljs-params\">default:</span> route.props }\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"318,337"}},{"content":"<pre data-lines=\"338,339\"><code>&#x8fd9;&#x91cc;&#x8981;&#x6ce8;&#x610f;&#x51e0;&#x4e2a;&#x70b9;&#xff0c;`path` &#x662f;&#x89c4;&#x8303;&#x5316;&#x540e;&#x7684;&#x8def;&#x5f84;&#xff0c;&#x5b83;&#x4f1a;&#x6839;&#x636e; `parent` &#x7684; `path` &#x505a;&#x8ba1;&#x7b97;&#xff1b;`regex` &#x662f;&#x4e00;&#x4e2a;&#x6b63;&#x5219;&#x8868;&#x8fbe;&#x5f0f;&#x7684;&#x6269;&#x5c55;&#xff0c;&#x5b83;&#x5229;&#x7528;&#x4e86;`path-to-regexp` &#x8fd9;&#x4e2a;&#x5de5;&#x5177;&#x5e93;&#xff0c;&#x628a; `path` &#x89e3;&#x6790;&#x6210;&#x4e00;&#x4e2a;&#x6b63;&#x5219;&#x8868;&#x8fbe;&#x5f0f;&#x7684;&#x6269;&#x5c55;&#xff0c;&#x4e3e;&#x4e2a;&#x4f8b;&#x5b50;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"338,339"}},{"content":"<pre data-lines=\"340,346\"><code data-lines=\"340,346\"><span class=\"hljs-keyword\">var</span> keys = []\n<span class=\"hljs-keyword\">var</span> re = pathToRegexp(<span class=\"hljs-string\">&apos;/foo/:bar&apos;</span>, keys)\n// re = /^\\/foo\\/([^\\/]+?)\\/?&#x24;/i\n// keys = [{ name: <span class=\"hljs-string\">&apos;bar&apos;</span>, prefix: <span class=\"hljs-string\">&apos;/&apos;</span>, delimiter: <span class=\"hljs-string\">&apos;/&apos;</span>, optional: <span class=\"hljs-literal\">false</span>, <span class=\"hljs-keyword\">repeat</span>: <span class=\"hljs-literal\">false</span>, pattern: <span class=\"hljs-string\">&apos;[^\\\\/]+?&apos;</span> }] \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"340,346"}},{"content":"<pre data-lines=\"347,348\"><code>`components` &#x662f;&#x4e00;&#x4e2a;&#x5bf9;&#x8c61;&#xff0c;&#x901a;&#x5e38;&#x6211;&#x4eec;&#x5728;&#x914d;&#x7f6e;&#x4e2d;&#x5199;&#x7684; `component` &#x5b9e;&#x9645;&#x4e0a;&#x8fd9;&#x91cc;&#x4f1a;&#x88ab;&#x8f6c;&#x6362;&#x6210; `{components: route.component}`&#xff1b;`instances` &#x8868;&#x793a;&#x7ec4;&#x4ef6;&#x7684;&#x5b9e;&#x4f8b;&#xff0c;&#x4e5f;&#x662f;&#x4e00;&#x4e2a;&#x5bf9;&#x8c61;&#x7c7b;&#x578b;&#xff1b;`parent` &#x8868;&#x793a;&#x7236;&#x7684; `RouteRecord`&#xff0c;&#x56e0;&#x4e3a;&#x6211;&#x4eec;&#x914d;&#x7f6e;&#x7684;&#x65f6;&#x5019;&#x6709;&#x65f6;&#x5019;&#x4f1a;&#x914d;&#x7f6e;&#x5b50;&#x8def;&#x7531;&#xff0c;&#x6240;&#x4ee5;&#x6574;&#x4e2a; `RouteRecord` &#x4e5f;&#x5c31;&#x662f;&#x4e00;&#x4e2a;&#x6811;&#x578b;&#x7ed3;&#x6784;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"347,348"}},{"content":"<pre data-lines=\"349,360\"><code data-lines=\"349,360\"><span class=\"hljs-keyword\">if</span> (route.children) {\n  <span class=\"hljs-comment\">// ...</span>\n  route.children.forEach(<span class=\"hljs-function\"><span class=\"hljs-params\">child</span> =&gt;</span> {\n  const childMatchAs = matchAs\n    ? cleanPath(<span class=\"hljs-string\">`<span class=\"hljs-subst\">&#x24;{matchAs}</span>/<span class=\"hljs-subst\">&#x24;{child.path}</span>`</span>)\n    : <span class=\"hljs-literal\">undefined</span>\n  addRouteRecord(pathList, pathMap, nameMap, child, record, childMatchAs)\n})\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"349,360"}},{"content":"<pre data-lines=\"361,362\"><code>&#x5982;&#x679c;&#x914d;&#x7f6e;&#x4e86; `children`&#xff0c;&#x90a3;&#x4e48;&#x9012;&#x5f52;&#x6267;&#x884c; `addRouteRecord` &#x65b9;&#x6cd5;&#xff0c;&#x5e76;&#x628a;&#x5f53;&#x524d;&#x7684; `record` &#x4f5c;&#x4e3a; `parent` &#x4f20;&#x5165;&#xff0c;&#x901a;&#x8fc7;&#x8fd9;&#x6837;&#x7684;&#x6df1;&#x5ea6;&#x904d;&#x5386;&#xff0c;&#x6211;&#x4eec;&#x5c31;&#x53ef;&#x4ee5;&#x62ff;&#x5230;&#x4e00;&#x4e2a; `route` &#x4e0b;&#x7684;&#x5b8c;&#x6574;&#x8bb0;&#x5f55;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"361,362"}},{"content":"<pre data-lines=\"363,369\"><code data-lines=\"363,369\"><span class=\"hljs-keyword\">if</span> (!pathMap[<span class=\"hljs-type\">record</span>.path]) {\n  pathList.push(<span class=\"hljs-type\">record</span>.path)\n  pathMap[<span class=\"hljs-type\">record</span>.path] = <span class=\"hljs-type\">record</span>\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"363,369"}},{"content":"<pre data-lines=\"372,380\"><code data-lines=\"372,380\"><span class=\"hljs-keyword\">if</span> (<span class=\"hljs-built_in\">name</span>) {\n  <span class=\"hljs-keyword\">if</span> (!nameMap[<span class=\"hljs-built_in\">name</span>]) {\n    nameMap[<span class=\"hljs-built_in\">name</span>] = record\n  }\n  <span class=\"hljs-comment\">// ...</span>\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"372,380"}},{"content":"<pre data-lines=\"381,386\"><code>&#x5982;&#x679c;&#x6211;&#x4eec;&#x5728;&#x8def;&#x7531;&#x914d;&#x7f6e;&#x4e2d;&#x914d;&#x7f6e;&#x4e86; `name`&#xff0c;&#x5219;&#x7ed9; `nameMap` &#x6dfb;&#x52a0;&#x4e00;&#x6761;&#x8bb0;&#x5f55;&#x3002;\n\n&#x7531;&#x4e8e; `pathList`&#x3001;`pathMap`&#x3001;`nameMap` &#x90fd;&#x662f;&#x5f15;&#x7528;&#x7c7b;&#x578b;&#xff0c;&#x6240;&#x4ee5;&#x5728;&#x904d;&#x5386;&#x6574;&#x4e2a; `routes` &#x8fc7;&#x7a0b;&#x4e2d;&#x53bb;&#x6267;&#x884c; `addRouteRecord` &#x65b9;&#x6cd5;&#xff0c;&#x4f1a;&#x4e0d;&#x65ad;&#x7ed9;&#x4ed6;&#x4eec;&#x6dfb;&#x52a0;&#x6570;&#x636e;&#x3002;&#x90a3;&#x4e48;&#x7ecf;&#x8fc7;&#x6574;&#x4e2a; `createRouteMap` &#x65b9;&#x6cd5;&#x7684;&#x6267;&#x884c;&#xff0c;&#x6211;&#x4eec;&#x5f97;&#x5230;&#x7684;&#x5c31;&#x662f; `pathList`&#x3001;`pathMap` &#x548c; `nameMap`&#x3002;&#x5176;&#x4e2d; `pathList` &#x662f;&#x4e3a;&#x4e86;&#x8bb0;&#x5f55;&#x8def;&#x7531;&#x914d;&#x7f6e;&#x4e2d;&#x7684;&#x6240;&#x6709; `path`&#xff0c;&#x800c; `pathMap` &#x548c; `nameMap` &#x90fd;&#x662f;&#x4e3a;&#x4e86;&#x901a;&#x8fc7; `path` &#x548c; `name` &#x80fd;&#x5feb;&#x901f;&#x67e5;&#x5230;&#x5bf9;&#x5e94;&#x7684; `RouteRecord`&#x3002;\n\n&#x518d;&#x56de;&#x5230; `createMatcher` &#x51fd;&#x6570;&#xff0c;&#x63a5;&#x4e0b;&#x6765;&#x5c31;&#x5b9a;&#x4e49;&#x4e86;&#x4e00;&#x7cfb;&#x5217;&#x65b9;&#x6cd5;&#xff0c;&#x6700;&#x540e;&#x8fd4;&#x56de;&#x4e86;&#x4e00;&#x4e2a;&#x5bf9;&#x8c61;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"381,386"}},{"content":"<pre data-lines=\"387,393\"><code data-lines=\"387,393\"><span class=\"hljs-keyword\">return</span> {\n<span class=\"hljs-built_in\">  match,</span>\n  addRoutes\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"387,393"}},{"content":"<pre data-lines=\"394,395\"><code>&#x4e5f;&#x5c31;&#x662f;&#x8bf4;&#xff0c;`matcher` &#x662f;&#x4e00;&#x4e2a;&#x5bf9;&#x8c61;&#xff0c;&#x5b83;&#x5bf9;&#x5916;&#x66b4;&#x9732;&#x4e86; `match` &#x548c; `addRoutes` &#x65b9;&#x6cd5;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"394,395"}}],"payload":{"tag":"h2","lines":"52,54"}},{"content":"<a href=\"#addroutes\">#</a> addRoutes","children":[{"content":"<pre data-lines=\"399,400\"><code>`addRoutes` &#x65b9;&#x6cd5;&#x7684;&#x4f5c;&#x7528;&#x662f;&#x52a8;&#x6001;&#x6dfb;&#x52a0;&#x8def;&#x7531;&#x914d;&#x7f6e;&#xff0c;&#x56e0;&#x4e3a;&#x5728;&#x5b9e;&#x9645;&#x5f00;&#x53d1;&#x4e2d;&#x6709;&#x4e9b;&#x573a;&#x666f;&#x662f;&#x4e0d;&#x80fd;&#x63d0;&#x524d;&#x628a;&#x8def;&#x7531;&#x5199;&#x6b7b;&#x7684;&#xff0c;&#x9700;&#x8981;&#x6839;&#x636e;&#x4e00;&#x4e9b;&#x6761;&#x4ef6;&#x52a8;&#x6001;&#x6dfb;&#x52a0;&#x8def;&#x7531;&#xff0c;&#x6240;&#x4ee5; Vue-Router &#x4e5f;&#x63d0;&#x4f9b;&#x4e86;&#x8fd9;&#x4e00;&#x63a5;&#x53e3;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"399,400"}},{"content":"<pre data-lines=\"401,406\"><code data-lines=\"401,406\">function addRoutes (routes) {\n  <span class=\"hljs-built_in\">createRouteMap</span>(routes, pathList, pathMap, nameMap)\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"401,406"}},{"content":"<pre data-lines=\"407,408\"><code>`addRoutes` &#x7684;&#x65b9;&#x6cd5;&#x5341;&#x5206;&#x7b80;&#x5355;&#xff0c;&#x518d;&#x6b21;&#x8c03;&#x7528; `createRouteMap` &#x5373;&#x53ef;&#xff0c;&#x4f20;&#x5165;&#x65b0;&#x7684; `routes` &#x914d;&#x7f6e;&#xff0c;&#x7531;&#x4e8e; `pathList`&#x3001;`pathMap`&#x3001;`nameMap` &#x90fd;&#x662f;&#x5f15;&#x7528;&#x7c7b;&#x578b;&#xff0c;&#x6267;&#x884c; `addRoutes` &#x540e;&#x4f1a;&#x4fee;&#x6539;&#x5b83;&#x4eec;&#x7684;&#x503c;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"407,408"}}],"payload":{"tag":"h2","lines":"396,398"}},{"content":"<a href=\"#match\">#</a> match","children":[{"content":"<pre data-lines=\"412,461\"><code data-lines=\"412,461\"><span class=\"hljs-keyword\">function</span> match (\n  raw: RawLocation,\n  currentRoute?: Route,\n  redirectedFrom?: <span class=\"hljs-keyword\">Location</span>\n): Route {\n  const <span class=\"hljs-keyword\">location</span> = normalizeLocation(raw, currentRoute, <span class=\"hljs-keyword\">false</span>, router)\n  const { <span class=\"hljs-type\">name</span> } = <span class=\"hljs-keyword\">location</span>\n\n  <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-type\">name</span>) {\n    const <span class=\"hljs-type\">record</span> = nameMap[<span class=\"hljs-type\">name</span>]\n    <span class=\"hljs-keyword\">if</span> (process.env.NODE_ENV !== <span class=\"hljs-string\">&apos;production&apos;</span>) {\n      warn(<span class=\"hljs-type\">record</span>, `Route <span class=\"hljs-keyword\">with</span> <span class=\"hljs-type\">name</span> <span class=\"hljs-string\">&apos;&#x24;{name}&apos;</span> does <span class=\"hljs-keyword\">not</span> exist`)\n    }\n    <span class=\"hljs-keyword\">if</span> (!<span class=\"hljs-type\">record</span>) <span class=\"hljs-keyword\">return</span> _createRoute(<span class=\"hljs-keyword\">null</span>, <span class=\"hljs-keyword\">location</span>)\n    const paramNames = <span class=\"hljs-type\">record</span>.regex.keys\n      .<span class=\"hljs-keyword\">filter</span>(key =&gt; !key.optional)\n      .map(key =&gt; key.name)\n\n    <span class=\"hljs-keyword\">if</span> (typeof <span class=\"hljs-keyword\">location</span>.params !== <span class=\"hljs-string\">&apos;object&apos;</span>) {\n      <span class=\"hljs-keyword\">location</span>.params = {}\n    }\n\n    <span class=\"hljs-keyword\">if</span> (currentRoute &amp;&amp; typeof currentRoute.params === <span class=\"hljs-string\">&apos;object&apos;</span>) {\n      <span class=\"hljs-keyword\">for</span> (const key <span class=\"hljs-keyword\">in</span> currentRoute.params) {\n        <span class=\"hljs-keyword\">if</span> (!(key <span class=\"hljs-keyword\">in</span> <span class=\"hljs-keyword\">location</span>.params) &amp;&amp; paramNames.indexOf(key) &gt; <span class=\"hljs-number\">-1</span>) {\n          <span class=\"hljs-keyword\">location</span>.params[key] = currentRoute.params[key]\n        }\n      }\n    }\n\n    <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-type\">record</span>) {\n      <span class=\"hljs-keyword\">location</span>.path = fillParams(<span class=\"hljs-type\">record</span>.path, <span class=\"hljs-keyword\">location</span>.params, `named route &quot;&#x24;{name}&quot;`)\n      <span class=\"hljs-keyword\">return</span> _createRoute(<span class=\"hljs-type\">record</span>, <span class=\"hljs-keyword\">location</span>, redirectedFrom)\n    }\n  } <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-keyword\">location</span>.path) {\n    <span class=\"hljs-keyword\">location</span>.params = {}\n    <span class=\"hljs-keyword\">for</span> (let i = <span class=\"hljs-number\">0</span>; i &lt; pathList.length; i++) {\n      const <span class=\"hljs-type\">path</span> = pathList[i]\n      const <span class=\"hljs-type\">record</span> = pathMap[<span class=\"hljs-type\">path</span>]\n      <span class=\"hljs-keyword\">if</span> (matchRoute(<span class=\"hljs-type\">record</span>.regex, <span class=\"hljs-keyword\">location</span>.path, <span class=\"hljs-keyword\">location</span>.params)) {\n        <span class=\"hljs-keyword\">return</span> _createRoute(<span class=\"hljs-type\">record</span>, <span class=\"hljs-keyword\">location</span>, redirectedFrom)\n      }\n    }\n  }\n  \n  <span class=\"hljs-keyword\">return</span> _createRoute(<span class=\"hljs-keyword\">null</span>, <span class=\"hljs-keyword\">location</span>)\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"412,461"}},{"content":"<pre data-lines=\"462,465\"><code>`match` &#x65b9;&#x6cd5;&#x63a5;&#x6536; 3 &#x4e2a;&#x53c2;&#x6570;&#xff0c;&#x5176;&#x4e2d; `raw` &#x662f; `RawLocation` &#x7c7b;&#x578b;&#xff0c;&#x5b83;&#x53ef;&#x4ee5;&#x662f;&#x4e00;&#x4e2a; `url` &#x5b57;&#x7b26;&#x4e32;&#xff0c;&#x4e5f;&#x53ef;&#x4ee5;&#x662f;&#x4e00;&#x4e2a; `Location` &#x5bf9;&#x8c61;&#xff1b;`currentRoute` &#x662f; `Route` &#x7c7b;&#x578b;&#xff0c;&#x5b83;&#x8868;&#x793a;&#x5f53;&#x524d;&#x7684;&#x8def;&#x5f84;&#xff1b;`redirectedFrom` &#x548c;&#x91cd;&#x5b9a;&#x5411;&#x76f8;&#x5173;&#xff0c;&#x8fd9;&#x91cc;&#x5148;&#x5ffd;&#x7565;&#x3002;`match` &#x65b9;&#x6cd5;&#x8fd4;&#x56de;&#x7684;&#x662f;&#x4e00;&#x4e2a;&#x8def;&#x5f84;&#xff0c;&#x5b83;&#x7684;&#x4f5c;&#x7528;&#x662f;&#x6839;&#x636e;&#x4f20;&#x5165;&#x7684; `raw` &#x548c;&#x5f53;&#x524d;&#x7684;&#x8def;&#x5f84; `currentRoute` &#x8ba1;&#x7b97;&#x51fa;&#x4e00;&#x4e2a;&#x65b0;&#x7684;&#x8def;&#x5f84;&#x5e76;&#x8fd4;&#x56de;&#x3002;\n\n&#x9996;&#x5148;&#x6267;&#x884c;&#x4e86; `normalizeLocation`&#xff0c;&#x5b83;&#x7684;&#x5b9a;&#x4e49;&#x5728; `src/util/location.js` &#x4e2d;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"462,465"}},{"content":"<pre data-lines=\"466,519\"><code data-lines=\"466,519\">export <span class=\"hljs-keyword\">function</span> normalizeLocation (\n  raw: RawLocation,\n  <span class=\"hljs-keyword\">current</span>: ?Route,\n  append: ?<span class=\"hljs-type\">boolean</span>,\n  router: ?VueRouter\n): <span class=\"hljs-keyword\">Location</span> {\n  let next: <span class=\"hljs-keyword\">Location</span> = typeof raw === <span class=\"hljs-string\">&apos;string&apos;</span> ? { <span class=\"hljs-type\">path</span>: raw } : raw\n  <span class=\"hljs-keyword\">if</span> (next.name || next._normalized) {\n    <span class=\"hljs-keyword\">return next</span>\n  }\n\n  <span class=\"hljs-keyword\">if</span> (!next.path &amp;&amp; next.params &amp;&amp; <span class=\"hljs-keyword\">current</span>) {\n    next = assign({}, next)\n    next._normalized = <span class=\"hljs-keyword\">true</span>\n    const params: <span class=\"hljs-keyword\">any</span> = assign(assign({}, <span class=\"hljs-keyword\">current</span>.params), next.params)\n    <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-keyword\">current</span>.name) {\n      next.name = <span class=\"hljs-keyword\">current</span>.name\n      next.params = params\n    } <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-keyword\">current</span>.matched.length) {\n      const rawPath = <span class=\"hljs-keyword\">current</span>.matched[<span class=\"hljs-keyword\">current</span>.matched.length - <span class=\"hljs-number\">1</span>].path\n      next.path = fillParams(rawPath, params, `<span class=\"hljs-type\">path</span> &#x24;{<span class=\"hljs-keyword\">current</span>.path}`)\n    } <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span> (process.env.NODE_ENV !== <span class=\"hljs-string\">&apos;production&apos;</span>) {\n      warn(<span class=\"hljs-keyword\">false</span>, `relative params navigation requires a <span class=\"hljs-keyword\">current</span> route.`)\n    }\n    <span class=\"hljs-keyword\">return next</span>\n  }\n\n  const parsedPath = parsePath(next.path || <span class=\"hljs-string\">&apos;&apos;</span>)\n  const basePath = (<span class=\"hljs-keyword\">current</span> &amp;&amp; <span class=\"hljs-keyword\">current</span>.path) || <span class=\"hljs-string\">&apos;/&apos;</span>\n  const <span class=\"hljs-type\">path</span> = parsedPath.path\n    ? resolvePath(parsedPath.path, basePath, append || next.append)\n    : basePath\n\n  const query = resolveQuery(\n    parsedPath.query,\n    next.query,\n    router &amp;&amp; router.<span class=\"hljs-keyword\">options</span>.parseQuery\n  )\n\n  let hash = next.hash || parsedPath.hash\n  <span class=\"hljs-keyword\">if</span> (hash &amp;&amp; hash.charAt(<span class=\"hljs-number\">0</span>) !== <span class=\"hljs-string\">&apos;#&apos;</span>) {\n    hash = `#&#x24;{hash}`\n  }\n\n  <span class=\"hljs-keyword\">return</span> {\n    _normalized: <span class=\"hljs-keyword\">true</span>,\n    <span class=\"hljs-type\">path</span>,\n    query,\n    hash\n  }\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"466,519"}},{"content":"<pre data-lines=\"520,533\"><code>`normalizeLocation` &#x65b9;&#x6cd5;&#x7684;&#x4f5c;&#x7528;&#x662f;&#x6839;&#x636e; `raw`&#xff0c;`current` &#x8ba1;&#x7b97;&#x51fa;&#x65b0;&#x7684; `location`&#xff0c;&#x5b83;&#x4e3b;&#x8981;&#x5904;&#x7406;&#x4e86; `raw` &#x7684;&#x4e24;&#x79cd;&#x60c5;&#x51b5;&#xff0c;&#x4e00;&#x79cd;&#x662f;&#x6709; `params` &#x4e14;&#x6ca1;&#x6709; `path`&#xff0c;&#x4e00;&#x79cd;&#x662f;&#x6709; `path` &#x7684;&#xff0c;&#x5bf9;&#x4e8e;&#x7b2c;&#x4e00;&#x79cd;&#x60c5;&#x51b5;&#xff0c;&#x5982;&#x679c; `current` &#x6709; `name`&#xff0c;&#x5219;&#x8ba1;&#x7b97;&#x51fa;&#x7684; `location` &#x4e5f;&#x6709; `name`&#x3002;\n\n&#x8ba1;&#x7b97;&#x51fa;&#x65b0;&#x7684; `location` &#x540e;&#xff0c;&#x5bf9; `location` &#x7684; `name` &#x548c; `path` &#x7684;&#x4e24;&#x79cd;&#x60c5;&#x51b5;&#x505a;&#x4e86;&#x5904;&#x7406;&#x3002;\n\n*   `name`\n\n&#x6709; `name` &#x7684;&#x60c5;&#x51b5;&#x4e0b;&#x5c31;&#x6839;&#x636e; `nameMap` &#x5339;&#x914d;&#x5230; `record`&#xff0c;&#x5b83;&#x5c31;&#x662f;&#x4e00;&#x4e2a; `RouterRecord` &#x5bf9;&#x8c61;&#xff0c;&#x5982;&#x679c; `record` &#x4e0d;&#x5b58;&#x5728;&#xff0c;&#x5219;&#x5339;&#x914d;&#x5931;&#x8d25;&#xff0c;&#x8fd4;&#x56de;&#x4e00;&#x4e2a;&#x7a7a;&#x8def;&#x5f84;&#xff1b;&#x7136;&#x540e;&#x62ff;&#x5230; `record` &#x5bf9;&#x5e94;&#x7684; `paramNames`&#xff0c;&#x518d;&#x5bf9;&#x6bd4; `currentRoute` &#x4e2d;&#x7684; `params`&#xff0c;&#x628a;&#x4ea4;&#x96c6;&#x90e8;&#x5206;&#x7684; `params` &#x6dfb;&#x52a0;&#x5230; `location` &#x4e2d;&#xff0c;&#x7136;&#x540e;&#x5728;&#x901a;&#x8fc7; `fillParams` &#x65b9;&#x6cd5;&#x6839;&#x636e; `record.path` &#x548c; `location.path` &#x8ba1;&#x7b97;&#x51fa; `location.path`&#xff0c;&#x6700;&#x540e;&#x8c03;&#x7528; `_createRoute(record, location, redirectedFrom)` &#x53bb;&#x751f;&#x6210;&#x4e00;&#x6761;&#x65b0;&#x8def;&#x5f84;&#xff0c;&#x8be5;&#x65b9;&#x6cd5;&#x6211;&#x4eec;&#x4e4b;&#x540e;&#x4f1a;&#x4ecb;&#x7ecd;&#x3002;\n\n*   `path`\n\n&#x901a;&#x8fc7; `name` &#x6211;&#x4eec;&#x53ef;&#x4ee5;&#x5f88;&#x5feb;&#x7684;&#x627e;&#x5230; `record`&#xff0c;&#x4f46;&#x662f;&#x901a;&#x8fc7; `path` &#x5e76;&#x4e0d;&#x80fd;&#xff0c;&#x56e0;&#x4e3a;&#x6211;&#x4eec;&#x8ba1;&#x7b97;&#x540e;&#x7684; `location.path` &#x662f;&#x4e00;&#x4e2a;&#x771f;&#x5b9e;&#x8def;&#x5f84;&#xff0c;&#x800c; `record` &#x4e2d;&#x7684; `path` &#x53ef;&#x80fd;&#x4f1a;&#x6709; `param`&#xff0c;&#x56e0;&#x6b64;&#x9700;&#x8981;&#x5bf9;&#x6240;&#x6709;&#x7684; `pathList` &#x505a;&#x987a;&#x5e8f;&#x904d;&#x5386;&#xff0c; &#x7136;&#x540e;&#x901a;&#x8fc7; `matchRoute` &#x65b9;&#x6cd5;&#x6839;&#x636e; `record.regex`&#x3001;`location.path`&#x3001;`location.params` &#x5339;&#x914d;&#xff0c;&#x5982;&#x679c;&#x5339;&#x914d;&#x5230;&#x5219;&#x4e5f;&#x901a;&#x8fc7; `_createRoute(record, location, redirectedFrom)` &#x53bb;&#x751f;&#x6210;&#x4e00;&#x6761;&#x65b0;&#x8def;&#x5f84;&#x3002;&#x56e0;&#x4e3a;&#x662f;&#x987a;&#x5e8f;&#x904d;&#x5386;&#xff0c;&#x6240;&#x4ee5;&#x6211;&#x4eec;&#x4e66;&#x5199;&#x8def;&#x7531;&#x914d;&#x7f6e;&#x8981;&#x6ce8;&#x610f;&#x8def;&#x5f84;&#x7684;&#x987a;&#x5e8f;&#xff0c;&#x56e0;&#x4e3a;&#x5199;&#x5728;&#x524d;&#x9762;&#x7684;&#x4f1a;&#x4f18;&#x5148;&#x5c1d;&#x8bd5;&#x5339;&#x914d;&#x3002;\n\n&#x6700;&#x540e;&#x6211;&#x4eec;&#x6765;&#x770b;&#x4e00;&#x4e0b; `_createRoute` &#x7684;&#x5b9e;&#x73b0;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"520,533"}},{"content":"<pre data-lines=\"534,549\"><code data-lines=\"534,549\"><span class=\"hljs-keyword\">function</span> _createRoute (\n  <span class=\"hljs-type\">record</span>: ?RouteRecord,\n  <span class=\"hljs-keyword\">location</span>: <span class=\"hljs-keyword\">Location</span>,\n  redirectedFrom?: <span class=\"hljs-keyword\">Location</span>\n): Route {\n  <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-type\">record</span> &amp;&amp; <span class=\"hljs-type\">record</span>.redirect) {\n    <span class=\"hljs-keyword\">return</span> redirect(<span class=\"hljs-type\">record</span>, redirectedFrom || <span class=\"hljs-keyword\">location</span>)\n  }\n  <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-type\">record</span> &amp;&amp; <span class=\"hljs-type\">record</span>.matchAs) {\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">alias</span>(<span class=\"hljs-type\">record</span>, <span class=\"hljs-keyword\">location</span>, <span class=\"hljs-type\">record</span>.matchAs)\n  }\n  <span class=\"hljs-keyword\">return</span> createRoute(<span class=\"hljs-type\">record</span>, <span class=\"hljs-keyword\">location</span>, redirectedFrom, router)\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"534,549"}},{"content":"<pre data-lines=\"550,551\"><code>&#x6211;&#x4eec;&#x5148;&#x4e0d;&#x8003;&#x8651; `record.redirect` &#x548c; `record.matchAs` &#x7684;&#x60c5;&#x51b5;&#xff0c;&#x6700;&#x7ec8;&#x4f1a;&#x8c03;&#x7528; `createRoute` &#x65b9;&#x6cd5;&#xff0c;&#x5b83;&#x7684;&#x5b9a;&#x4e49;&#x5728; `src/uitl/route.js` &#x4e2d;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"550,551"}},{"content":"<pre data-lines=\"552,582\"><code data-lines=\"552,582\">export <span class=\"hljs-keyword\">function</span> createRoute (\n  <span class=\"hljs-type\">record</span>: ?RouteRecord,\n  <span class=\"hljs-keyword\">location</span>: <span class=\"hljs-keyword\">Location</span>,\n  redirectedFrom?: ?<span class=\"hljs-keyword\">Location</span>,\n  router?: VueRouter\n): Route {\n  const stringifyQuery = router &amp;&amp; router.<span class=\"hljs-keyword\">options</span>.stringifyQuery\n\n  let query: <span class=\"hljs-keyword\">any</span> = <span class=\"hljs-keyword\">location</span>.query || {}\n  try {\n    query = clone(query)\n  } catch (e) {}\n\n  const route: Route = {\n    <span class=\"hljs-type\">name</span>: <span class=\"hljs-keyword\">location</span>.name || (<span class=\"hljs-type\">record</span> &amp;&amp; <span class=\"hljs-type\">record</span>.name),\n    meta: (<span class=\"hljs-type\">record</span> &amp;&amp; <span class=\"hljs-type\">record</span>.meta) || {},\n    <span class=\"hljs-type\">path</span>: <span class=\"hljs-keyword\">location</span>.path || <span class=\"hljs-string\">&apos;/&apos;</span>,\n    hash: <span class=\"hljs-keyword\">location</span>.hash || <span class=\"hljs-string\">&apos;&apos;</span>,\n    query,\n    params: <span class=\"hljs-keyword\">location</span>.params || {},\n    fullPath: getFullPath(<span class=\"hljs-keyword\">location</span>, stringifyQuery),\n    matched: <span class=\"hljs-type\">record</span> ? formatMatch(<span class=\"hljs-type\">record</span>) : []\n  }\n  <span class=\"hljs-keyword\">if</span> (redirectedFrom) {\n    route.redirectedFrom = getFullPath(redirectedFrom, stringifyQuery)\n  }\n  <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">Object</span>.<span class=\"hljs-keyword\">freeze</span>(route)\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"552,582"}},{"content":"<pre data-lines=\"583,584\"><code>`createRoute` &#x53ef;&#x4ee5;&#x6839;&#x636e; `record` &#x548c; `location` &#x521b;&#x5efa;&#x51fa;&#x6765;&#xff0c;&#x6700;&#x7ec8;&#x8fd4;&#x56de;&#x7684;&#x662f;&#x4e00;&#x6761; `Route` &#x8def;&#x5f84;&#xff0c;&#x6211;&#x4eec;&#x4e4b;&#x524d;&#x4e5f;&#x4ecb;&#x7ecd;&#x8fc7;&#x5b83;&#x7684;&#x6570;&#x636e;&#x7ed3;&#x6784;&#x3002;&#x5728; Vue-Router &#x4e2d;&#xff0c;&#x6240;&#x6709;&#x7684; `Route` &#x6700;&#x7ec8;&#x90fd;&#x4f1a;&#x901a;&#x8fc7; `createRoute` &#x51fd;&#x6570;&#x521b;&#x5efa;&#xff0c;&#x5e76;&#x4e14;&#x5b83;&#x6700;&#x540e;&#x662f;&#x4e0d;&#x53ef;&#x4ee5;&#x88ab;&#x5916;&#x90e8;&#x4fee;&#x6539;&#x7684;&#x3002;`Route` &#x5bf9;&#x8c61;&#x4e2d;&#x6709;&#x4e00;&#x4e2a;&#x975e;&#x5e38;&#x91cd;&#x8981;&#x5c5e;&#x6027;&#x662f; `matched`&#xff0c;&#x5b83;&#x901a;&#x8fc7; `formatMatch(record)` &#x8ba1;&#x7b97;&#x800c;&#x6765;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"583,584"}},{"content":"<pre data-lines=\"585,595\"><code data-lines=\"585,595\"><span class=\"hljs-keyword\">function</span> formatMatch (<span class=\"hljs-type\">record</span>: ?RouteRecord): <span class=\"hljs-keyword\">Array</span>&lt;RouteRecord&gt; {\n  const res = []\n  <span class=\"hljs-keyword\">while</span> (<span class=\"hljs-type\">record</span>) {\n    res.unshift(<span class=\"hljs-type\">record</span>)\n    <span class=\"hljs-type\">record</span> = <span class=\"hljs-type\">record</span>.parent\n  }\n  <span class=\"hljs-keyword\">return</span> res\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"585,595"}},{"content":"<pre data-lines=\"596,597\"><code>&#x53ef;&#x4ee5;&#x770b;&#x5b83;&#x662f;&#x901a;&#x8fc7; `record` &#x5faa;&#x73af;&#x5411;&#x4e0a;&#x627e; `parent`&#xff0c;&#x76f4;&#x5230;&#x627e;&#x5230;&#x6700;&#x5916;&#x5c42;&#xff0c;&#x5e76;&#x628a;&#x6240;&#x6709;&#x7684; `record` &#x90fd; push &#x5230;&#x4e00;&#x4e2a;&#x6570;&#x7ec4;&#x4e2d;&#xff0c;&#x6700;&#x7ec8;&#x8fd4;&#x56de;&#x7684;&#x5c31;&#x662f; `record` &#x7684;&#x6570;&#x7ec4;&#xff0c;&#x5b83;&#x8bb0;&#x5f55;&#x4e86;&#x4e00;&#x6761;&#x7ebf;&#x8def;&#x4e0a;&#x7684;&#x6240;&#x6709; `record`&#x3002;`matched` &#x5c5e;&#x6027;&#x975e;&#x5e38;&#x6709;&#x7528;&#xff0c;&#x5b83;&#x4e3a;&#x4e4b;&#x540e;&#x6e32;&#x67d3;&#x7ec4;&#x4ef6;&#x63d0;&#x4f9b;&#x4e86;&#x4f9d;&#x636e;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"596,597"}}],"payload":{"tag":"h2","lines":"409,411"}},{"content":"<a href=\"#%E6%80%BB%E7%BB%93\">#</a> &#x603b;&#x7ed3;","children":[],"payload":{"tag":"h2","lines":"598,600"}}],"payload":{"tag":"h1","lines":"0,2"}},{})</script>
</body>
</html>
