<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets@11.11.1/styles/default.min.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.18.10/dist/browser/index.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/index.js"></script><script>(r => {
              setTimeout(r);
            })(function renderToolbar() {
  const {
    markmap,
    mm
  } = window;
  const {
    el
  } = markmap.Toolbar.create(mm);
  el.setAttribute('style', 'position:absolute;bottom:20px;right:20px');
  document.body.append(el);
})</script><script>((getMarkmap, getOptions, root2, jsonOptions) => {
              const markmap = getMarkmap();
              window.mm = markmap.Markmap.create(
                "svg#mindmap",
                (getOptions || markmap.deriveOptions)(jsonOptions),
                root2
              );
            })(() => window.markmap,null,{"content":"<a href=\"#props-v2-6-11\">#</a> Props (v2.6.11)","children":[{"content":"&#x8ba4;&#x8bc6;","children":[{"content":"<pre data-lines=\"6,7\"><code>`Props` &#x4f5c;&#x4e3a;&#x7ec4;&#x4ef6;&#x7684;&#x6838;&#x5fc3;&#x7279;&#x6027;&#x4e4b;&#x4e00;&#xff0c;&#x4e5f;&#x662f;&#x6211;&#x4eec;&#x5e73;&#x65f6;&#x5f00;&#x53d1; Vue &#x9879;&#x76ee;&#x4e2d;&#x63a5;&#x89e6;&#x6700;&#x591a;&#x7684;&#x7279;&#x6027;&#x4e4b;&#x4e00;&#xff0c;&#x5b83;&#x53ef;&#x4ee5;&#x8ba9;&#x7ec4;&#x4ef6;&#x7684;&#x529f;&#x80fd;&#x53d8;&#x5f97;&#x4e30;&#x5bcc;&#xff0c;&#x4e5f;&#x662f;&#x7236;&#x5b50;&#x7ec4;&#x4ef6;&#x901a;&#x8baf;&#x7684;&#x4e00;&#x4e2a;&#x6e20;&#x9053;&#x3002;&#x90a3;&#x4e48;&#x5b83;&#x7684;&#x5b9e;&#x73b0;&#x539f;&#x7406;&#x662f;&#x600e;&#x6837;&#x7684;&#xff0c;&#x6211;&#x4eec;&#x6765;&#x4e00;&#x63a2;&#x7a76;&#x7adf;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"6,7"}}],"payload":{"tag":"h2","lines":"3,5"}},{"content":"<a href=\"#%E8%A7%84%E8%8C%83%E5%8C%96\">#</a> &#x89c4;&#x8303;&#x5316;","children":[{"content":"<pre data-lines=\"11,12\"><code>&#x5728;&#x521d;&#x59cb;&#x5316; `props` &#x4e4b;&#x524d;&#xff0c;&#x9996;&#x5148;&#x4f1a;&#x5bf9; `props` &#x505a;&#x4e00;&#x6b21; `normalize`&#xff0c;&#x5b83;&#x53d1;&#x751f;&#x5728; `mergeOptions` &#x7684;&#x65f6;&#x5019;&#xff0c;&#x5728; `src/core/util/options.js` &#x4e2d;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"11,12"}},{"content":"<pre data-lines=\"13,58\"><code data-lines=\"13,58\"><span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">mergeOptions</span> (<span class=\"hljs-params\">\n  parent: <span class=\"hljs-built_in\">Object</span>,\n  child: <span class=\"hljs-built_in\">Object</span>,\n  vm?: Component\n</span>): <span class=\"hljs-title class_\">Object</span> {\n  <span class=\"hljs-comment\">// ...</span>\n  <span class=\"hljs-title function_\">normalizeProps</span>(child, vm)\n  <span class=\"hljs-comment\">// ...</span>\n}\n\n<span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">normalizeProps</span> (<span class=\"hljs-params\">options: <span class=\"hljs-built_in\">Object</span>, vm: ?Component</span>) {\n  <span class=\"hljs-keyword\">const</span> props = options.<span class=\"hljs-property\">props</span>\n  <span class=\"hljs-keyword\">if</span> (!props) <span class=\"hljs-keyword\">return</span>\n  <span class=\"hljs-keyword\">const</span> res = {}\n  <span class=\"hljs-keyword\">let</span> i, val, name\n  <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-title class_\">Array</span>.<span class=\"hljs-title function_\">isArray</span>(props)) {\n    i = props.<span class=\"hljs-property\">length</span>\n    <span class=\"hljs-keyword\">while</span> (i--) {\n      val = props[i]\n      <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-keyword\">typeof</span> val === <span class=\"hljs-string\">&apos;string&apos;</span>) {\n        name = <span class=\"hljs-title function_\">camelize</span>(val)\n        res[name] = { <span class=\"hljs-attr\">type</span>: <span class=\"hljs-literal\">null</span> }\n      } <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span> (process.<span class=\"hljs-property\">env</span>.<span class=\"hljs-property\">NODE_ENV</span> !== <span class=\"hljs-string\">&apos;production&apos;</span>) {\n        <span class=\"hljs-title function_\">warn</span>(<span class=\"hljs-string\">&apos;props must be strings when using array syntax.&apos;</span>)\n      }\n    }\n  } <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-title function_\">isPlainObject</span>(props)) {\n    <span class=\"hljs-keyword\">for</span> (<span class=\"hljs-keyword\">const</span> key <span class=\"hljs-keyword\">in</span> props) {\n      val = props[key]\n      name = <span class=\"hljs-title function_\">camelize</span>(key)\n      res[name] = <span class=\"hljs-title function_\">isPlainObject</span>(val)\n        ? val\n        : { <span class=\"hljs-attr\">type</span>: val }\n    }\n  } <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span> (process.<span class=\"hljs-property\">env</span>.<span class=\"hljs-property\">NODE_ENV</span> !== <span class=\"hljs-string\">&apos;production&apos;</span>) {\n    <span class=\"hljs-title function_\">warn</span>(\n      <span class=\"hljs-string\">`Invalid value for option &quot;props&quot;: expected an Array or an Object, `</span> +\n      <span class=\"hljs-string\">`but got <span class=\"hljs-subst\">&#x24;{toRawType(props)}</span>.`</span>,\n      vm\n    )\n  }\n  options.<span class=\"hljs-property\">props</span> = res\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"13,58"}},{"content":"<pre data-lines=\"59,70\"><code>&#x5408;&#x5e76;&#x914d;&#x7f6e;&#x6211;&#x4eec;&#x5728;&#x7ec4;&#x4ef6;&#x5316;&#x7ae0;&#x8282;&#x8bb2;&#x8fc7;&#xff0c;&#x5b83;&#x4e3b;&#x8981;&#x5c31;&#x662f;&#x5904;&#x7406;&#x6211;&#x4eec;&#x5b9a;&#x4e49;&#x7ec4;&#x4ef6;&#x7684;&#x5bf9;&#x8c61; `option`&#xff0c;&#x7136;&#x540e;&#x6302;&#x8f7d;&#x5230;&#x7ec4;&#x4ef6;&#x7684;&#x5b9e;&#x4f8b; `this.&#x24;options` &#x4e2d;&#x3002;\n\n&#x6211;&#x4eec;&#x63a5;&#x4e0b;&#x6765;&#x91cd;&#x70b9;&#x770b; `normalizeProps` &#x7684;&#x5b9e;&#x73b0;&#xff0c;&#x5176;&#x5b9e;&#x8fd9;&#x4e2a;&#x51fd;&#x6570;&#x7684;&#x4e3b;&#x8981;&#x76ee;&#x7684;&#x5c31;&#x662f;&#x628a;&#x6211;&#x4eec;&#x7f16;&#x5199;&#x7684; `props` &#x8f6c;&#x6210;&#x5bf9;&#x8c61;&#x683c;&#x5f0f;&#xff0c;&#x56e0;&#x4e3a;&#x5b9e;&#x9645;&#x4e0a; `props` &#x9664;&#x4e86;&#x5bf9;&#x8c61;&#x683c;&#x5f0f;&#xff0c;&#x8fd8;&#x5141;&#x8bb8;&#x5199;&#x6210;&#x6570;&#x7ec4;&#x683c;&#x5f0f;&#x3002;\n\n&#x5f53; `props` &#x662f;&#x4e00;&#x4e2a;&#x6570;&#x7ec4;&#xff0c;&#x6bcf;&#x4e00;&#x4e2a;&#x6570;&#x7ec4;&#x5143;&#x7d20; `prop` &#x53ea;&#x80fd;&#x662f;&#x4e00;&#x4e2a; `string`&#xff0c;&#x8868;&#x793a; `prop` &#x7684; `key`&#xff0c;&#x8f6c;&#x6210;&#x9a7c;&#x5cf0;&#x683c;&#x5f0f;&#xff0c;`prop` &#x7684;&#x7c7b;&#x578b;&#x4e3a;&#x7a7a;&#x3002;\n\n&#x5f53; `props` &#x662f;&#x4e00;&#x4e2a;&#x5bf9;&#x8c61;&#xff0c;&#x5bf9;&#x4e8e; `props` &#x4e2d;&#x6bcf;&#x4e2a; `prop` &#x7684; `key`&#xff0c;&#x6211;&#x4eec;&#x4f1a;&#x8f6c;&#x9a7c;&#x5cf0;&#x683c;&#x5f0f;&#xff0c;&#x800c;&#x5b83;&#x7684; `value`&#xff0c;&#x5982;&#x679c;&#x4e0d;&#x662f;&#x4e00;&#x4e2a;&#x5bf9;&#x8c61;&#xff0c;&#x6211;&#x4eec;&#x5c31;&#x628a;&#x5b83;&#x89c4;&#x8303;&#x6210;&#x4e00;&#x4e2a;&#x5bf9;&#x8c61;&#x3002;\n\n&#x5982;&#x679c; `props` &#x65e2;&#x4e0d;&#x662f;&#x6570;&#x7ec4;&#x4e5f;&#x4e0d;&#x662f;&#x5bf9;&#x8c61;&#xff0c;&#x5c31;&#x629b;&#x51fa;&#x4e00;&#x4e2a;&#x8b66;&#x544a;&#x3002;\n\n&#x4e3e;&#x4e2a;&#x4f8b;&#x5b50;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"59,70"}},{"content":"<pre data-lines=\"71,76\"><code data-lines=\"71,76\"><span class=\"hljs-built_in\">export</span><span class=\"hljs-built_in\"> default </span>{\n  props: [<span class=\"hljs-string\">&apos;name&apos;</span>, <span class=\"hljs-string\">&apos;nick-name&apos;</span>]\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"71,76"}},{"content":"<pre data-lines=\"77,78\"><code>&#x7ecf;&#x8fc7; `normalizeProps` &#x540e;&#xff0c;&#x4f1a;&#x88ab;&#x89c4;&#x8303;&#x6210;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"77,78"}},{"content":"<pre data-lines=\"79,85\"><code data-lines=\"79,85\">o<span class=\"hljs-attr\">ptions.props</span> <span class=\"hljs-operator\">=</span> {\n  <span class=\"hljs-params\">name:</span> { <span class=\"hljs-params\">type:</span> <span class=\"hljs-literal\">null</span> },\n  <span class=\"hljs-params\">nickName:</span> { <span class=\"hljs-params\">type:</span> <span class=\"hljs-literal\">null</span> }\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"79,85"}},{"content":"<pre data-lines=\"86,96\"><code data-lines=\"86,96\">export <span class=\"hljs-title class_\">default</span> <span class=\"hljs-punctuation\">{</span>\n<span class=\"hljs-symbol\">  props:</span> <span class=\"hljs-punctuation\">{</span>\n<span class=\"hljs-symbol\">    name:</span> String,\n<span class=\"hljs-symbol\">    nickName:</span> <span class=\"hljs-punctuation\">{</span>\n<span class=\"hljs-symbol\">      type:</span> Boolean\n    <span class=\"hljs-punctuation\">}</span>\n  <span class=\"hljs-punctuation\">}</span>\n<span class=\"hljs-punctuation\">}</span> \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"86,96"}},{"content":"<pre data-lines=\"97,98\"><code>&#x7ecf;&#x8fc7; `normalizeProps` &#x540e;&#xff0c;&#x4f1a;&#x88ab;&#x89c4;&#x8303;&#x6210;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"97,98"}},{"content":"<pre data-lines=\"99,105\"><code data-lines=\"99,105\"><span class=\"hljs-keyword\">options</span>.props = {\n  <span class=\"hljs-type\">name</span>: { <span class=\"hljs-keyword\">type</span>: String },\n  nickName: { <span class=\"hljs-keyword\">type</span>: <span class=\"hljs-type\">Boolean</span> }\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"99,105"}},{"content":"<pre data-lines=\"106,107\"><code>&#x7531;&#x4e8e;&#x5bf9;&#x8c61;&#x5f62;&#x5f0f;&#x7684; `props` &#x53ef;&#x4ee5;&#x6307;&#x5b9a;&#x6bcf;&#x4e2a; `prop` &#x7684;&#x7c7b;&#x578b;&#x548c;&#x5b9a;&#x4e49;&#x5176;&#x5b83;&#x7684;&#x4e00;&#x4e9b;&#x5c5e;&#x6027;&#xff0c;&#x63a8;&#x8350;&#x7528;&#x5bf9;&#x8c61;&#x5f62;&#x5f0f;&#x5b9a;&#x4e49; `props`&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"106,107"}}],"payload":{"tag":"h2","lines":"8,10"}},{"content":"<a href=\"#%E5%88%9D%E5%A7%8B%E5%8C%96\">#</a> &#x521d;&#x59cb;&#x5316;","children":[{"content":"<a href=\"#%E6%A0%A1%E9%AA%8C\">#</a> &#x6821;&#x9a8c;","children":[{"content":"<pre data-lines=\"174,175\"><code>&#x6821;&#x9a8c;&#x7684;&#x903b;&#x8f91;&#x5f88;&#x7b80;&#x5355;&#xff0c;&#x904d;&#x5386; `propsOptions`&#xff0c;&#x6267;&#x884c; `validateProp(key, propsOptions, propsData, vm)` &#x65b9;&#x6cd5;&#x3002;&#x8fd9;&#x91cc;&#x7684; `propsOptions` &#x5c31;&#x662f;&#x6211;&#x4eec;&#x5b9a;&#x4e49;&#x7684; `props` &#x5728;&#x89c4;&#x8303;&#x540e;&#x751f;&#x6210;&#x7684; `options.props` &#x5bf9;&#x8c61;&#xff0c;`propsData` &#x662f;&#x4ece;&#x7236;&#x7ec4;&#x4ef6;&#x4f20;&#x9012;&#x7684; `prop` &#x6570;&#x636e;&#x3002;&#x6240;&#x8c13;&#x6821;&#x9a8c;&#x7684;&#x76ee;&#x7684;&#x5c31;&#x662f;&#x68c0;&#x67e5;&#x4e00;&#x4e0b;&#x6211;&#x4eec;&#x4f20;&#x9012;&#x7684;&#x6570;&#x636e;&#x662f;&#x5426;&#x6ee1;&#x8db3; `prop`&#x7684;&#x5b9a;&#x4e49;&#x89c4;&#x8303;&#x3002;&#x518d;&#x6765;&#x770b;&#x4e00;&#x4e0b; `validateProp` &#x65b9;&#x6cd5;&#xff0c;&#x5b83;&#x5b9a;&#x4e49;&#x5728; `src/core/util/props.js` &#x4e2d;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"174,175"}},{"content":"<pre data-lines=\"176,220\"><code data-lines=\"176,220\">export function <span class=\"hljs-title function_\">validateProp</span> (\n  <span class=\"hljs-built_in\">key</span>: string,\n  propOptions: <span class=\"hljs-built_in\">Object</span>,\n  propsData: <span class=\"hljs-built_in\">Object</span>,\n  vm?: Component\n): any {\n  <span class=\"hljs-keyword\">const</span> prop = propOptions[<span class=\"hljs-built_in\">key</span>]\n  <span class=\"hljs-keyword\">const</span> absent = !<span class=\"hljs-title function_\">hasOwn</span>(propsData, <span class=\"hljs-built_in\">key</span>)\n  let value = propsData[<span class=\"hljs-built_in\">key</span>]\n  <span class=\"hljs-comment\">// boolean casting</span>\n  <span class=\"hljs-keyword\">const</span> booleanIndex = <span class=\"hljs-title function_\">getTypeIndex</span>(Boolean, prop.<span class=\"hljs-property\">type</span>)\n  <span class=\"hljs-keyword\">if</span> (booleanIndex &gt; <span class=\"hljs-number\">-1</span>) {\n    <span class=\"hljs-keyword\">if</span> (absent &amp;&amp; !<span class=\"hljs-title function_\">hasOwn</span>(prop, <span class=\"hljs-string\">&apos;default&apos;</span>)) {\n      value = <span class=\"hljs-literal\">false</span>\n    } <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span> (value === <span class=\"hljs-string\">&apos;&apos;</span> || value === <span class=\"hljs-title function_\">hyphenate</span>(<span class=\"hljs-built_in\">key</span>)) {\n      <span class=\"hljs-comment\">// only cast empty string / same name to boolean if</span>\n      <span class=\"hljs-comment\">// boolean has higher priority</span>\n      <span class=\"hljs-keyword\">const</span> stringIndex = <span class=\"hljs-title function_\">getTypeIndex</span>(<span class=\"hljs-built_in\">String</span>, prop.<span class=\"hljs-property\">type</span>)\n      <span class=\"hljs-keyword\">if</span> (stringIndex &lt; <span class=\"hljs-number\">0</span> || booleanIndex &lt; stringIndex) {\n        value = <span class=\"hljs-literal\">true</span>\n      }\n    }\n  }\n  <span class=\"hljs-comment\">// check default value</span>\n  <span class=\"hljs-keyword\">if</span> (value === undefined) {\n    value = <span class=\"hljs-title function_\">getPropDefaultValue</span>(vm, prop, <span class=\"hljs-built_in\">key</span>)\n    <span class=\"hljs-comment\">// since the default value is a fresh copy,</span>\n    <span class=\"hljs-comment\">// make sure to observe it.</span>\n    <span class=\"hljs-keyword\">const</span> prevShouldObserve = shouldObserve\n    <span class=\"hljs-title function_\">toggleObserving</span>(<span class=\"hljs-literal\">true</span>)\n    <span class=\"hljs-title function_\">observe</span>(value)\n    <span class=\"hljs-title function_\">toggleObserving</span>(prevShouldObserve)\n  }\n  <span class=\"hljs-keyword\">if</span> (\n    process.<span class=\"hljs-property\">env</span>.<span class=\"hljs-property\">NODE_ENV</span> !== <span class=\"hljs-string\">&apos;production&apos;</span> &amp;&amp;\n    <span class=\"hljs-comment\">// skip validation for weex recycle-list child component props</span>\n    !(__WEEX__ &amp;&amp; <span class=\"hljs-title function_\">isObject</span>(value) &amp;&amp; (<span class=\"hljs-string\">&apos;@binding&apos;</span> in value))\n  ) {\n    <span class=\"hljs-title function_\">assertProp</span>(prop, <span class=\"hljs-built_in\">key</span>, value, vm, absent)\n  }\n  <span class=\"hljs-keyword\">return</span> value\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"176,220"}},{"content":"<pre data-lines=\"221,224\"><code>`validateProp` &#x4e3b;&#x8981;&#x5c31;&#x505a; 3 &#x4ef6;&#x4e8b;&#x60c5;&#xff1a;&#x5904;&#x7406; `Boolean` &#x7c7b;&#x578b;&#x7684;&#x6570;&#x636e;&#xff0c;&#x5904;&#x7406;&#x9ed8;&#x8ba4;&#x6570;&#x636e;&#xff0c;`prop` &#x65ad;&#x8a00;&#xff0c;&#x5e76;&#x6700;&#x7ec8;&#x8fd4;&#x56de; `prop` &#x7684;&#x503c;&#x3002;\n\n&#x5148;&#x6765;&#x770b; `Boolean` &#x7c7b;&#x578b;&#x6570;&#x636e;&#x7684;&#x5904;&#x7406;&#x903b;&#x8f91;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"221,224"}},{"content":"<pre data-lines=\"225,244\"><code data-lines=\"225,244\"><span class=\"hljs-keyword\">const</span> prop = propOptions[<span class=\"hljs-built_in\">key</span>]\n<span class=\"hljs-keyword\">const</span> absent = !<span class=\"hljs-title function_\">hasOwn</span>(propsData, <span class=\"hljs-built_in\">key</span>)\nlet value = propsData[<span class=\"hljs-built_in\">key</span>]\n<span class=\"hljs-comment\">// boolean casting</span>\n<span class=\"hljs-keyword\">const</span> booleanIndex = <span class=\"hljs-title function_\">getTypeIndex</span>(Boolean, prop.<span class=\"hljs-property\">type</span>)\n<span class=\"hljs-keyword\">if</span> (booleanIndex &gt; <span class=\"hljs-number\">-1</span>) {\n  <span class=\"hljs-keyword\">if</span> (absent &amp;&amp; !<span class=\"hljs-title function_\">hasOwn</span>(prop, <span class=\"hljs-string\">&apos;default&apos;</span>)) {\n    value = <span class=\"hljs-literal\">false</span>\n  } <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span> (value === <span class=\"hljs-string\">&apos;&apos;</span> || value === <span class=\"hljs-title function_\">hyphenate</span>(<span class=\"hljs-built_in\">key</span>)) {\n    <span class=\"hljs-comment\">// only cast empty string / same name to boolean if</span>\n    <span class=\"hljs-comment\">// boolean has higher priority</span>\n    <span class=\"hljs-keyword\">const</span> stringIndex = <span class=\"hljs-title function_\">getTypeIndex</span>(<span class=\"hljs-built_in\">String</span>, prop.<span class=\"hljs-property\">type</span>)\n    <span class=\"hljs-keyword\">if</span> (stringIndex &lt; <span class=\"hljs-number\">0</span> || booleanIndex &lt; stringIndex) {\n      value = <span class=\"hljs-literal\">true</span>\n    }\n  }\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"225,244"}},{"content":"<pre data-lines=\"245,246\"><code>&#x5148;&#x901a;&#x8fc7; `const booleanIndex = getTypeIndex(Boolean, prop.type)` &#x6765;&#x5224;&#x65ad; `prop` &#x7684;&#x5b9a;&#x4e49;&#x662f;&#x5426;&#x662f; `Boolean` &#x7c7b;&#x578b;&#x7684;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"245,246"}},{"content":"<pre data-lines=\"247,269\"><code data-lines=\"247,269\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">getType</span> (fn) {\n  const match = fn &amp;&amp; fn.toString().match(/^\\s*<span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\"></span>(\\w+)/)\n  <span class=\"hljs-keyword\">return</span> <span class=\"hljs-type\">match</span> ? match[<span class=\"hljs-number\">1</span>] : &apos;&apos;\n}\n\n<span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">isSameType</span> (a, b) {\n  <span class=\"hljs-keyword\">return</span> <span class=\"hljs-type\">getType(a)</span> === getType(b)\n}\n\n<span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">getTypeIndex</span> (type, expectedTypes): number {\n  if (!Array.<span class=\"hljs-keyword\">is</span><span class=\"hljs-keyword\">Array</span>(expectedTypes)) {\n    <span class=\"hljs-keyword\">return</span> isSameType(expectedTypes, <span class=\"hljs-keyword\">type</span>) ? <span class=\"hljs-number\">0</span> : -1\n  }\n  <span class=\"hljs-keyword\">for</span> (let i = <span class=\"hljs-number\">0</span>, len = expectedTypes.length; i &lt; len; i++) {\n    <span class=\"hljs-keyword\">if</span> (isSameType(expectedTypes[i], <span class=\"hljs-keyword\">type</span>)) {\n      <span class=\"hljs-keyword\">return</span> i\n    }\n  }\n  <span class=\"hljs-keyword\">return</span> -<span class=\"hljs-number\">1</span>\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"247,269"}},{"content":"<pre data-lines=\"270,273\"><code>`getTypeIndex` &#x51fd;&#x6570;&#x5c31;&#x662f;&#x627e;&#x5230; `type` &#x548c; `expectedTypes` &#x5339;&#x914d;&#x7684;&#x7d22;&#x5f15;&#x5e76;&#x8fd4;&#x56de;&#x3002;\n\n`prop` &#x7c7b;&#x578b;&#x5b9a;&#x4e49;&#x7684;&#x65f6;&#x5019;&#x53ef;&#x4ee5;&#x662f;&#x67d0;&#x4e2a;&#x539f;&#x751f;&#x6784;&#x9020;&#x51fd;&#x6570;&#xff0c;&#x4e5f;&#x53ef;&#x4ee5;&#x662f;&#x539f;&#x751f;&#x6784;&#x9020;&#x51fd;&#x6570;&#x7684;&#x6570;&#x7ec4;&#xff0c;&#x6bd4;&#x5982;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"270,273"}},{"content":"<pre data-lines=\"274,282\"><code data-lines=\"274,282\"><span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">default</span> {\n  props: {\n    name: <span class=\"hljs-built_in\">String</span>,\n    value: [<span class=\"hljs-built_in\">String</span>, <span class=\"hljs-built_in\">Boolean</span>]\n  }\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"274,282"}},{"content":"<pre data-lines=\"283,290\"><code>&#x5982;&#x679c; `expectedTypes` &#x662f;&#x5355;&#x4e2a;&#x6784;&#x9020;&#x51fd;&#x6570;&#xff0c;&#x5c31;&#x6267;&#x884c; `isSameType` &#x53bb;&#x5224;&#x65ad;&#x662f;&#x5426;&#x662f;&#x540c;&#x4e00;&#x4e2a;&#x7c7b;&#x578b;&#xff1b;&#x5982;&#x679c;&#x662f;&#x6570;&#x7ec4;&#xff0c;&#x90a3;&#x4e48;&#x5c31;&#x904d;&#x5386;&#x8fd9;&#x4e2a;&#x6570;&#x7ec4;&#xff0c;&#x627e;&#x5230;&#x7b2c;&#x4e00;&#x4e2a;&#x540c;&#x7c7b;&#x578b;&#x7684;&#xff0c;&#x8fd4;&#x56de;&#x5b83;&#x7684;&#x7d22;&#x5f15;&#x3002;\n\n&#x56de;&#x5230; `validateProp` &#x51fd;&#x6570;&#xff0c;&#x901a;&#x8fc7; `const booleanIndex = getTypeIndex(Boolean, prop.type)` &#x5f97;&#x5230; `booleanIndex`&#xff0c;&#x5982;&#x679c; `prop.type` &#x662f;&#x4e00;&#x4e2a; `Boolean` &#x7c7b;&#x578b;&#xff0c;&#x5219;&#x901a;&#x8fc7; `absent &amp;&amp; !hasOwn(prop, &apos;default&apos;)` &#x6765;&#x5224;&#x65ad;&#x5982;&#x679c;&#x7236;&#x7ec4;&#x4ef6;&#x6ca1;&#x6709;&#x4f20;&#x9012;&#x8fd9;&#x4e2a; `prop` &#x6570;&#x636e;&#x5e76;&#x4e14;&#x6ca1;&#x6709;&#x8bbe;&#x7f6e; `default` &#x7684;&#x60c5;&#x51b5;&#xff0c;&#x5219; `value` &#x4e3a; false&#x3002;\n\n&#x63a5;&#x7740;&#x5224;&#x65ad;`value === &apos;&apos; || value === hyphenate(key)` &#x7684;&#x60c5;&#x51b5;&#xff0c;&#x5982;&#x679c;&#x6ee1;&#x8db3;&#x5219;&#x5148;&#x901a;&#x8fc7; `const stringIndex = getTypeIndex(String, prop.type)` &#x83b7;&#x53d6;&#x5339;&#x914d; `String` &#x7c7b;&#x578b;&#x7684;&#x7d22;&#x5f15;&#xff0c;&#x7136;&#x540e;&#x5224;&#x65ad; `stringIndex &lt; 0 || booleanIndex &lt; stringIndex` &#x7684;&#x503c;&#x6765;&#x51b3;&#x5b9a; `value` &#x7684;&#x503c;&#x662f;&#x5426;&#x4e3a; `true`&#x3002;&#x8fd9;&#x5757;&#x903b;&#x8f91;&#x7a0d;&#x5fae;&#x6709;&#x70b9;&#x7ed5;&#xff0c;&#x6211;&#x4eec;&#x4e3e; 2 &#x4e2a;&#x4f8b;&#x5b50;&#x6765;&#x8bf4;&#x660e;&#xff1a;\n\n&#x4f8b;&#x5982;&#x4f60;&#x5b9a;&#x4e49;&#x4e00;&#x4e2a;&#x7ec4;&#x4ef6; `Student`:\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"283,290"}},{"content":"<pre data-lines=\"291,297\"><code data-lines=\"291,297\"><span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">default</span> {\n  name: <span class=\"hljs-built_in\">String</span>,\n  nickName: [<span class=\"hljs-built_in\">Boolean</span>, <span class=\"hljs-built_in\">String</span>]\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"291,297"}},{"content":"<pre data-lines=\"298,299\"><code>&#x7136;&#x540e;&#x5728;&#x7236;&#x7ec4;&#x4ef6;&#x4e2d;&#x5f15;&#x5165;&#x8fd9;&#x4e2a;&#x7ec4;&#x4ef6;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"298,299"}},{"content":"<pre data-lines=\"300,307\"><code data-lines=\"300,307\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">template</span>&gt;</span>\n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">student</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;Kate&quot;</span> <span class=\"hljs-attr\">nick-name</span>&gt;</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">student</span>&gt;</span>\n  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">template</span>&gt;</span> \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"300,307"}},{"content":"<pre data-lines=\"308,309\"><code>&#x6216;&#x8005;&#x662f;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"308,309"}},{"content":"<pre data-lines=\"310,317\"><code data-lines=\"310,317\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">template</span>&gt;</span>\n  <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">div</span>&gt;</span>\n    <span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">student</span> <span class=\"hljs-attr\">name</span>=<span class=\"hljs-string\">&quot;Kate&quot;</span> <span class=\"hljs-attr\">nick-name</span>=<span class=\"hljs-string\">&quot;nick-name&quot;</span>&gt;</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">student</span>&gt;</span>\n  <span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">div</span>&gt;</span>\n<span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">template</span>&gt;</span> \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"310,317"}},{"content":"<pre data-lines=\"318,321\"><code>&#x7b2c;&#x4e00;&#x79cd;&#x60c5;&#x51b5;&#x6ca1;&#x6709;&#x5199;&#x5c5e;&#x6027;&#x7684;&#x503c;&#xff0c;&#x6ee1;&#x8db3; `value === &apos;&apos;`&#xff0c;&#x7b2c;&#x4e8c;&#x79cd;&#x6ee1;&#x8db3; `value === hyphenate(key)` &#x7684;&#x60c5;&#x51b5;&#xff0c;&#x53e6;&#x5916; `nickName` &#x8fd9;&#x4e2a; `prop` &#x7684;&#x7c7b;&#x578b;&#x662f; `Boolean` &#x6216;&#x8005;&#x662f; `String`&#xff0c;&#x5e76;&#x4e14;&#x6ee1;&#x8db3; `booleanIndex &lt; stringIndex`&#xff0c;&#x6240;&#x4ee5;&#x5bf9; `nickName` &#x8fd9;&#x4e2a; `prop` &#x7684; `value` &#x4e3a; `true`&#x3002;\n\n&#x63a5;&#x4e0b;&#x6765;&#x770b;&#x4e00;&#x4e0b;&#x9ed8;&#x8ba4;&#x6570;&#x636e;&#x5904;&#x7406;&#x903b;&#x8f91;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"318,321"}},{"content":"<pre data-lines=\"322,334\"><code data-lines=\"322,334\">//<span class=\"hljs-built_in\"> check </span>default value<span class=\"hljs-built_in\">\nif </span>(value === undefined) {\n  value = getPropDefaultValue(vm, prop, key)\n  // since the default value is a fresh copy,\n  // make sure to observe it.\n <span class=\"hljs-built_in\"> const </span>prevShouldObserve = shouldObserve\n  toggleObserving(true)\n  observe(value)\n  toggleObserving(prevShouldObserve)\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"322,334"}},{"content":"<pre data-lines=\"335,336\"><code>&#x5f53; `value` &#x7684;&#x503c;&#x4e3a; `undefined` &#x7684;&#x65f6;&#x5019;&#xff0c;&#x8bf4;&#x660e;&#x7236;&#x7ec4;&#x4ef6;&#x6839;&#x672c;&#x5c31;&#x6ca1;&#x6709;&#x4f20;&#x8fd9;&#x4e2a; `prop`&#xff0c;&#x90a3;&#x4e48;&#x6211;&#x4eec;&#x5c31;&#x9700;&#x8981;&#x901a;&#x8fc7; `getPropDefaultValue(vm, prop, key)` &#x83b7;&#x53d6;&#x8fd9;&#x4e2a; `prop` &#x7684;&#x9ed8;&#x8ba4;&#x503c;&#x3002;&#x6211;&#x4eec;&#x8fd9;&#x91cc;&#x53ea;&#x5173;&#x6ce8; `getPropDefaultValue` &#x7684;&#x5b9e;&#x73b0;&#xff0c;`toggleObserving` &#x548c; `observe` &#x7684;&#x4f5c;&#x7528;&#x6211;&#x4eec;&#x4e4b;&#x540e;&#x4f1a;&#x8bf4;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"335,336"}},{"content":"<pre data-lines=\"337,368\"><code data-lines=\"337,368\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">getPropDefaultValue</span> (vm: ?Component, prop: PropOptions, key: string): any {\n  // no default, <span class=\"hljs-keyword\">return</span> <span class=\"hljs-type\">undefined</span>\n  <span class=\"hljs-keyword\">if</span> (!hasOwn(prop, <span class=\"hljs-symbol\">&apos;default</span>&apos;)) {\n    <span class=\"hljs-keyword\">return</span> undefined\n  }\n  const def = prop.default\n  // warn against non-factory defaults <span class=\"hljs-keyword\">for</span> Object &amp; <span class=\"hljs-keyword\">Array</span>\n  <span class=\"hljs-keyword\">if</span> (process.env.NODE_ENV !== <span class=\"hljs-symbol\">&apos;production</span>&apos; &amp;&amp; isObject(def)) {\n    warn(\n      <span class=\"hljs-symbol\">&apos;Invalid</span> default value <span class=\"hljs-keyword\">for</span> prop <span class=\"hljs-string\">&quot;&apos; + key + &apos;&quot;</span>: &apos; +\n      <span class=\"hljs-symbol\">&apos;Props</span> <span class=\"hljs-keyword\">with</span> <span class=\"hljs-keyword\">type</span> <span class=\"hljs-type\">Object/Array </span>must <span class=\"hljs-keyword\">use</span> a factory <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">&apos;</span> +\n      &apos;to <span class=\"hljs-keyword\">return</span> <span class=\"hljs-type\">the</span> default value.&apos;,\n      vm\n    )\n  }\n  // the raw prop value was also undefined from previous render,\n  // <span class=\"hljs-keyword\">return</span> previous default value to avoid unnecessary watcher trigger\n  <span class=\"hljs-keyword\">if</span> (vm &amp;&amp; vm.&#x24;options.propsData &amp;&amp;\n    vm.&#x24;options.propsData[key] === undefined &amp;&amp;\n    vm._props[key] !== undefined\n  ) {\n    <span class=\"hljs-keyword\">return</span> vm._props[key]\n  }\n  // call factory <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">for</span> non-<span class=\"hljs-keyword\">Function</span> <span class=\"hljs-title\">types</span>\n  // a value <span class=\"hljs-keyword\">is</span> <span class=\"hljs-keyword\">Function</span> <span class=\"hljs-title\">if</span> its prototype <span class=\"hljs-keyword\">is</span> <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">even</span> across different execution context\n  <span class=\"hljs-keyword\">return</span> <span class=\"hljs-type\">typeof</span> def === <span class=\"hljs-symbol\">&apos;function</span>&apos; &amp;&amp; getType(prop.<span class=\"hljs-keyword\">type</span>) !== <span class=\"hljs-symbol\">&apos;Function</span>&apos;\n    ? def.call(vm)\n    : <span class=\"hljs-type\">def</span>\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"337,368"}},{"content":"<pre data-lines=\"369,378\"><code>&#x68c0;&#x6d4b;&#x5982;&#x679c; `prop` &#x6ca1;&#x6709;&#x5b9a;&#x4e49; `default` &#x5c5e;&#x6027;&#xff0c;&#x90a3;&#x4e48;&#x8fd4;&#x56de; `undefined`&#xff0c;&#x901a;&#x8fc7;&#x8fd9;&#x5757;&#x903b;&#x8f91;&#x6211;&#x4eec;&#x77e5;&#x9053;&#x9664;&#x4e86; `Boolean` &#x7c7b;&#x578b;&#x7684;&#x6570;&#x636e;&#xff0c;&#x5176;&#x4f59;&#x6ca1;&#x6709;&#x8bbe;&#x7f6e; `default` &#x5c5e;&#x6027;&#x7684; `prop` &#x9ed8;&#x8ba4;&#x503c;&#x90fd;&#x662f; `undefined`&#x3002;\n\n&#x63a5;&#x7740;&#x662f;&#x5f00;&#x53d1;&#x73af;&#x5883;&#x4e0b;&#x5bf9; `prop` &#x7684;&#x9ed8;&#x8ba4;&#x503c;&#x662f;&#x5426;&#x4e3a;&#x5bf9;&#x8c61;&#x6216;&#x8005;&#x6570;&#x7ec4;&#x7c7b;&#x578b;&#x7684;&#x5224;&#x65ad;&#xff0c;&#x5982;&#x679c;&#x662f;&#x7684;&#x8bdd;&#x4f1a;&#x62a5;&#x8b66;&#x544a;&#xff0c;&#x56e0;&#x4e3a;&#x5bf9;&#x8c61;&#x548c;&#x6570;&#x7ec4;&#x7c7b;&#x578b;&#x7684; `prop`&#xff0c;&#x4ed6;&#x4eec;&#x7684;&#x9ed8;&#x8ba4;&#x503c;&#x5fc5;&#x987b;&#x8981;&#x8fd4;&#x56de;&#x4e00;&#x4e2a;&#x5de5;&#x5382;&#x51fd;&#x6570;&#x3002;\n\n&#x63a5;&#x4e0b;&#x6765;&#x7684;&#x5224;&#x65ad;&#x662f;&#x5982;&#x679c;&#x4e0a;&#x4e00;&#x6b21;&#x7ec4;&#x4ef6;&#x6e32;&#x67d3;&#x7236;&#x7ec4;&#x4ef6;&#x4f20;&#x9012;&#x7684; `prop` &#x7684;&#x503c;&#x662f; `undefined`&#xff0c;&#x5219;&#x76f4;&#x63a5;&#x8fd4;&#x56de; &#x4e0a;&#x4e00;&#x6b21;&#x7684;&#x9ed8;&#x8ba4;&#x503c; `vm._props[key]`&#xff0c;&#x8fd9;&#x6837;&#x53ef;&#x4ee5;&#x907f;&#x514d;&#x89e6;&#x53d1;&#x4e0d;&#x5fc5;&#x8981;&#x7684; `watcher` &#x7684;&#x66f4;&#x65b0;&#x3002;\n\n&#x6700;&#x540e;&#x5c31;&#x662f;&#x5224;&#x65ad; `def` &#x5982;&#x679c;&#x662f;&#x5de5;&#x5382;&#x51fd;&#x6570;&#x4e14; `prop` &#x7684;&#x7c7b;&#x578b;&#x4e0d;&#x662f; `Function` &#x7684;&#x65f6;&#x5019;&#xff0c;&#x8fd4;&#x56de;&#x5de5;&#x5382;&#x51fd;&#x6570;&#x7684;&#x8fd4;&#x56de;&#x503c;&#xff0c;&#x5426;&#x5219;&#x76f4;&#x63a5;&#x8fd4;&#x56de; `def`&#x3002;\n\n&#x81f3;&#x6b64;&#xff0c;&#x6211;&#x4eec;&#x8bb2;&#x5b8c;&#x4e86; `validateProp` &#x51fd;&#x6570;&#x7684; `Boolean` &#x7c7b;&#x578b;&#x6570;&#x636e;&#x7684;&#x5904;&#x7406;&#x903b;&#x8f91;&#x548c;&#x9ed8;&#x8ba4;&#x6570;&#x636e;&#x5904;&#x7406;&#x903b;&#x8f91;&#xff0c;&#x6700;&#x540e;&#x6765;&#x770b;&#x4e00;&#x4e0b; `prop` &#x65ad;&#x8a00;&#x903b;&#x8f91;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"369,378"}},{"content":"<pre data-lines=\"379,388\"><code data-lines=\"379,388\"><span class=\"hljs-keyword\">if</span> (\nprocess<span class=\"hljs-selector-class\">.env</span><span class=\"hljs-selector-class\">.NODE_ENV</span> !== <span class=\"hljs-string\">&apos;production&apos;</span> &amp;&amp;\n<span class=\"hljs-comment\">// skip validation for weex recycle-list child component props</span>\n!(__WEEX__ &amp;&amp; <span class=\"hljs-built_in\">isObject</span>(value) &amp;&amp; (<span class=\"hljs-string\">&apos;@binding&apos;</span> <span class=\"hljs-keyword\">in</span> value))\n) {\n  <span class=\"hljs-built_in\">assertProp</span>(prop, key, value, vm, absent)\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"379,388"}},{"content":"<pre data-lines=\"389,390\"><code>&#x5728;&#x5f00;&#x53d1;&#x73af;&#x5883;&#x4e14;&#x975e; `weex` &#x7684;&#x67d0;&#x79cd;&#x73af;&#x5883;&#x4e0b;&#xff0c;&#x6267;&#x884c; `assertProp` &#x505a;&#x5c5e;&#x6027;&#x65ad;&#x8a00;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"389,390"}},{"content":"<pre data-lines=\"391,441\"><code data-lines=\"391,441\"><span class=\"hljs-keyword\">function</span> assertProp (\n  prop: PropOptions,\n  <span class=\"hljs-type\">name</span>: string,\n  <span class=\"hljs-keyword\">value</span>: <span class=\"hljs-keyword\">any</span>,\n  vm: ?Component,\n  absent: <span class=\"hljs-type\">boolean</span>\n) {\n  <span class=\"hljs-keyword\">if</span> (prop.required &amp;&amp; absent) {\n    warn(\n      <span class=\"hljs-string\">&apos;Missing required prop: &quot;&apos;</span> + <span class=\"hljs-type\">name</span> + <span class=\"hljs-string\">&apos;&quot;&apos;</span>,\n      vm\n    )\n    <span class=\"hljs-keyword\">return</span>\n  }\n  <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-keyword\">value</span> == <span class=\"hljs-keyword\">null</span> &amp;&amp; !prop.required) {\n    <span class=\"hljs-keyword\">return</span>\n  }\n  let <span class=\"hljs-keyword\">type</span> = prop.<span class=\"hljs-keyword\">type</span>\n  let <span class=\"hljs-keyword\">valid</span> = !<span class=\"hljs-keyword\">type</span> || <span class=\"hljs-keyword\">type</span> === <span class=\"hljs-keyword\">true</span>\n  const expectedTypes = []\n  <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-keyword\">type</span>) {\n    <span class=\"hljs-keyword\">if</span> (!<span class=\"hljs-keyword\">Array</span>.isArray(<span class=\"hljs-keyword\">type</span>)) {\n      <span class=\"hljs-keyword\">type</span> = [<span class=\"hljs-keyword\">type</span>]\n    }\n    <span class=\"hljs-keyword\">for</span> (let i = <span class=\"hljs-number\">0</span>; i &lt; <span class=\"hljs-keyword\">type</span>.length &amp;&amp; !<span class=\"hljs-keyword\">valid</span>; i++) {\n      const assertedType = assertType(<span class=\"hljs-keyword\">value</span>, <span class=\"hljs-keyword\">type</span>[i])\n      expectedTypes.push(assertedType.expectedType || <span class=\"hljs-string\">&apos;&apos;</span>)\n      <span class=\"hljs-keyword\">valid</span> = assertedType.<span class=\"hljs-keyword\">valid</span>\n    }\n  }\n\n  <span class=\"hljs-keyword\">if</span> (!<span class=\"hljs-keyword\">valid</span>) {\n    warn(\n      getInvalidTypeMessage(<span class=\"hljs-type\">name</span>, <span class=\"hljs-keyword\">value</span>, expectedTypes),\n      vm\n    )\n    <span class=\"hljs-keyword\">return</span>\n  }\n  const <span class=\"hljs-keyword\">validator</span> = prop.<span class=\"hljs-keyword\">validator</span>\n  <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-keyword\">validator</span>) {\n    <span class=\"hljs-keyword\">if</span> (!<span class=\"hljs-keyword\">validator</span>(<span class=\"hljs-keyword\">value</span>)) {\n      warn(\n        <span class=\"hljs-string\">&apos;Invalid prop: custom validator check failed for prop &quot;&apos;</span> + <span class=\"hljs-type\">name</span> + <span class=\"hljs-string\">&apos;&quot;.&apos;</span>,\n        vm\n      )\n    }\n  }\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"391,441"}},{"content":"<pre data-lines=\"442,449\"><code>`assertProp` &#x51fd;&#x6570;&#x7684;&#x76ee;&#x7684;&#x662f;&#x65ad;&#x8a00;&#x8fd9;&#x4e2a; `prop` &#x662f;&#x5426;&#x5408;&#x6cd5;&#x3002;\n\n&#x9996;&#x5148;&#x5224;&#x65ad;&#x5982;&#x679c; `prop` &#x5b9a;&#x4e49;&#x4e86; `required` &#x5c5e;&#x6027;&#x4f46;&#x7236;&#x7ec4;&#x4ef6;&#x6ca1;&#x6709;&#x4f20;&#x9012;&#x8fd9;&#x4e2a; `prop` &#x6570;&#x636e;&#x7684;&#x8bdd;&#x4f1a;&#x62a5;&#x4e00;&#x4e2a;&#x8b66;&#x544a;&#x3002;\n\n&#x63a5;&#x7740;&#x5224;&#x65ad;&#x5982;&#x679c; `value` &#x4e3a;&#x7a7a;&#x4e14; `prop` &#x6ca1;&#x6709;&#x5b9a;&#x4e49; `required` &#x5c5e;&#x6027;&#x5219;&#x76f4;&#x63a5;&#x8fd4;&#x56de;&#x3002;\n\n&#x7136;&#x540e;&#x518d;&#x53bb;&#x5bf9; `prop` &#x7684;&#x7c7b;&#x578b;&#x505a;&#x6821;&#x9a8c;&#xff0c;&#x5148;&#x662f;&#x62ff;&#x5230; `prop` &#x4e2d;&#x5b9a;&#x4e49;&#x7684;&#x7c7b;&#x578b; `type`&#xff0c;&#x5e76;&#x5c1d;&#x8bd5;&#x628a;&#x5b83;&#x8f6c;&#x6210;&#x4e00;&#x4e2a;&#x7c7b;&#x578b;&#x6570;&#x7ec4;&#xff0c;&#x7136;&#x540e;&#x4f9d;&#x6b21;&#x904d;&#x5386;&#x8fd9;&#x4e2a;&#x6570;&#x7ec4;&#xff0c;&#x6267;&#x884c; `assertType(value, type[i])` &#x53bb;&#x83b7;&#x53d6;&#x65ad;&#x8a00;&#x7684;&#x7ed3;&#x679c;&#xff0c;&#x76f4;&#x5230;&#x904d;&#x5386;&#x5b8c;&#x6210;&#x6216;&#x8005;&#x662f; `valid` &#x4e3a; `true` &#x7684;&#x65f6;&#x5019;&#x8df3;&#x51fa;&#x5faa;&#x73af;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"442,449"}},{"content":"<pre data-lines=\"450,478\"><code data-lines=\"450,478\">const simpleCheckRE = /^(String|Number|<span class=\"hljs-type\">Boolean</span>|<span class=\"hljs-keyword\">Function</span>|Symbol)&#x24;/\n<span class=\"hljs-keyword\">function</span> assertType (<span class=\"hljs-keyword\">value</span>: <span class=\"hljs-keyword\">any</span>, <span class=\"hljs-keyword\">type</span>: <span class=\"hljs-keyword\">Function</span>): {\n  <span class=\"hljs-keyword\">valid</span>: <span class=\"hljs-type\">boolean</span>;\n  expectedType: string;\n} {\n  let <span class=\"hljs-keyword\">valid</span>\n  const expectedType = getType(<span class=\"hljs-keyword\">type</span>)\n  <span class=\"hljs-keyword\">if</span> (simpleCheckRE.test(expectedType)) {\n    const t = typeof <span class=\"hljs-keyword\">value</span>\n    <span class=\"hljs-keyword\">valid</span> = t === expectedType.toLowerCase()\n    // <span class=\"hljs-keyword\">for</span> primitive <span class=\"hljs-keyword\">wrapper</span> objects\n    <span class=\"hljs-keyword\">if</span> (!<span class=\"hljs-keyword\">valid</span> &amp;&amp; t === <span class=\"hljs-string\">&apos;object&apos;</span>) {\n      <span class=\"hljs-keyword\">valid</span> = <span class=\"hljs-keyword\">value</span> instanceof <span class=\"hljs-keyword\">type</span>\n    }\n  } <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span> (expectedType === <span class=\"hljs-string\">&apos;Object&apos;</span>) {\n    <span class=\"hljs-keyword\">valid</span> = isPlainObject(<span class=\"hljs-keyword\">value</span>)\n  } <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span> (expectedType === <span class=\"hljs-string\">&apos;Array&apos;</span>) {\n    <span class=\"hljs-keyword\">valid</span> = <span class=\"hljs-keyword\">Array</span>.isArray(<span class=\"hljs-keyword\">value</span>)\n  } <span class=\"hljs-keyword\">else</span> {\n    <span class=\"hljs-keyword\">valid</span> = <span class=\"hljs-keyword\">value</span> instanceof <span class=\"hljs-keyword\">type</span>\n  }\n  <span class=\"hljs-keyword\">return</span> {\n    <span class=\"hljs-keyword\">valid</span>,\n    expectedType\n  }\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"450,478"}},{"content":"<pre data-lines=\"479,484\"><code>`assertType` &#x7684;&#x903b;&#x8f91;&#x5f88;&#x7b80;&#x5355;&#xff0c;&#x5148;&#x901a;&#x8fc7; `getType(type)` &#x83b7;&#x53d6; `prop` &#x671f;&#x671b;&#x7684;&#x7c7b;&#x578b; `expectedType`&#xff0c;&#x7136;&#x540e;&#x518d;&#x53bb;&#x6839;&#x636e;&#x51e0;&#x79cd;&#x4e0d;&#x540c;&#x7684;&#x60c5;&#x51b5;&#x5bf9;&#x6bd4; `prop` &#x7684;&#x503c; `value` &#x662f;&#x5426;&#x548c; `expectedType` &#x5339;&#x914d;&#xff0c;&#x6700;&#x540e;&#x8fd4;&#x56de;&#x5339;&#x914d;&#x7684;&#x7ed3;&#x679c;&#x3002;\n\n&#x5982;&#x679c;&#x5faa;&#x73af;&#x7ed3;&#x675f;&#x540e; `valid` &#x4ecd;&#x7136;&#x4e3a; `false`&#xff0c;&#x90a3;&#x4e48;&#x8bf4;&#x660e; `prop` &#x7684;&#x503c; `value` &#x4e0e; `prop` &#x5b9a;&#x4e49;&#x7684;&#x7c7b;&#x578b;&#x90fd;&#x4e0d;&#x5339;&#x914d;&#xff0c;&#x90a3;&#x4e48;&#x5c31;&#x4f1a;&#x8f93;&#x51fa;&#x4e00;&#x6bb5;&#x901a;&#x8fc7; `getInvalidTypeMessage(name, value, expectedTypes)` &#x751f;&#x6210;&#x7684;&#x8b66;&#x544a;&#x4fe1;&#x606f;&#xff0c;&#x5c31;&#x4e0d;&#x7ec6;&#x8bf4;&#x4e86;&#x3002;\n\n&#x6700;&#x540e;&#x5224;&#x65ad;&#x5f53; `prop` &#x81ea;&#x5df1;&#x5b9a;&#x4e49;&#x4e86; `validator` &#x81ea;&#x5b9a;&#x4e49;&#x6821;&#x9a8c;&#x5668;&#xff0c;&#x5219;&#x6267;&#x884c; `validator` &#x6821;&#x9a8c;&#x5668;&#x65b9;&#x6cd5;&#xff0c;&#x5982;&#x679c;&#x6821;&#x9a8c;&#x4e0d;&#x901a;&#x8fc7;&#x5219;&#x8f93;&#x51fa;&#x8b66;&#x544a;&#x4fe1;&#x606f;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"479,484"}}],"payload":{"tag":"h3","lines":"172,173"}},{"content":"<a href=\"#%E5%93%8D%E5%BA%94%E5%BC%8F\">#</a> &#x54cd;&#x5e94;&#x5f0f;","children":[{"content":"<pre data-lines=\"487,490\"><code>&#x56de;&#x5230; `initProps` &#x65b9;&#x6cd5;&#xff0c;&#x5f53;&#x6211;&#x4eec;&#x901a;&#x8fc7; `const value = validateProp(key, propsOptions, propsData, vm)` &#x5bf9; `prop` &#x505a;&#x9a8c;&#x8bc1;&#x5e76;&#x4e14;&#x83b7;&#x53d6;&#x5230; `prop` &#x7684;&#x503c;&#x540e;&#xff0c;&#x63a5;&#x4e0b;&#x6765;&#x9700;&#x8981;&#x901a;&#x8fc7; `defineReactive` &#x628a; `prop` &#x53d8;&#x6210;&#x54cd;&#x5e94;&#x5f0f;&#x3002;\n\n`defineReactive` &#x6211;&#x4eec;&#x4e4b;&#x524d;&#x5df2;&#x7ecf;&#x4ecb;&#x7ecd;&#x8fc7;&#xff0c;&#x8fd9;&#x91cc;&#x8981;&#x6ce8;&#x610f;&#x7684;&#x662f;&#xff0c;&#x5728;&#x5f00;&#x53d1;&#x73af;&#x5883;&#x4e2d;&#x6211;&#x4eec;&#x4f1a;&#x6821;&#x9a8c; `prop` &#x7684; `key` &#x662f;&#x5426;&#x662f; `HTML` &#x7684;&#x4fdd;&#x7559;&#x5c5e;&#x6027;&#xff0c;&#x5e76;&#x4e14;&#x5728; `defineReactive` &#x7684;&#x65f6;&#x5019;&#x4f1a;&#x6dfb;&#x52a0;&#x4e00;&#x4e2a;&#x81ea;&#x5b9a;&#x4e49; `setter`&#xff0c;&#x5f53;&#x6211;&#x4eec;&#x76f4;&#x63a5;&#x5bf9; `prop` &#x8d4b;&#x503c;&#x7684;&#x65f6;&#x5019;&#x4f1a;&#x8f93;&#x51fa;&#x8b66;&#x544a;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"487,490"}},{"content":"<pre data-lines=\"491,514\"><code data-lines=\"491,514\"><span class=\"hljs-keyword\">if</span> (process.<span class=\"hljs-property\">env</span>.<span class=\"hljs-property\">NODE_ENV</span> !== <span class=\"hljs-string\">&apos;production&apos;</span>) {\n  <span class=\"hljs-keyword\">const</span> hyphenatedKey = <span class=\"hljs-title function_\">hyphenate</span>(key)\n  <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-title function_\">isReservedAttribute</span>(hyphenatedKey) ||\n      config.<span class=\"hljs-title function_\">isReservedAttr</span>(hyphenatedKey)) {\n    <span class=\"hljs-title function_\">warn</span>(\n      <span class=\"hljs-string\">`&quot;<span class=\"hljs-subst\">&#x24;{hyphenatedKey}</span>&quot; is a reserved attribute and cannot be used as component prop.`</span>,\n      vm\n    )\n  }\n  <span class=\"hljs-title function_\">defineReactive</span>(props, key, value, <span class=\"hljs-function\">() =&gt;</span> {\n    <span class=\"hljs-keyword\">if</span> (!isRoot &amp;&amp; !isUpdatingChildComponent) {\n      <span class=\"hljs-title function_\">warn</span>(\n        <span class=\"hljs-string\">`Avoid mutating a prop directly since the value will be `</span> +\n        <span class=\"hljs-string\">`overwritten whenever the parent component re-renders. `</span> +\n        <span class=\"hljs-string\">`Instead, use a data or computed property based on the prop&apos;s `</span> +\n        <span class=\"hljs-string\">`value. Prop being mutated: &quot;<span class=\"hljs-subst\">&#x24;{key}</span>&quot;`</span>,\n        vm\n      )\n    }\n  })\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"491,514"}},{"content":"<pre data-lines=\"515,516\"><code>&#x5173;&#x4e8e; `prop` &#x7684;&#x54cd;&#x5e94;&#x5f0f;&#x6709;&#x4e00;&#x70b9;&#x4e0d;&#x540c;&#x7684;&#x662f;&#x5f53; `vm` &#x662f;&#x975e;&#x6839;&#x5b9e;&#x4f8b;&#x7684;&#x65f6;&#x5019;&#xff0c;&#x4f1a;&#x5148;&#x6267;&#x884c; `toggleObserving(false)`&#xff0c;&#x5b83;&#x7684;&#x76ee;&#x7684;&#x662f;&#x4e3a;&#x4e86;&#x54cd;&#x5e94;&#x5f0f;&#x7684;&#x4f18;&#x5316;&#xff0c;&#x6211;&#x4eec;&#x5148;&#x8df3;&#x8fc7;&#xff0c;&#x4e4b;&#x540e;&#x4f1a;&#x8be6;&#x7ec6;&#x8bf4;&#x660e;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"515,516"}}],"payload":{"tag":"h3","lines":"485,486"}},{"content":"<a href=\"#%E4%BB%A3%E7%90%86\">#</a> &#x4ee3;&#x7406;","children":[{"content":"<pre data-lines=\"519,520\"><code>&#x5728;&#x7ecf;&#x8fc7;&#x54cd;&#x5e94;&#x5f0f;&#x5904;&#x7406;&#x540e;&#xff0c;&#x6211;&#x4eec;&#x4f1a;&#x628a; `prop` &#x7684;&#x503c;&#x6dfb;&#x52a0;&#x5230; `vm._props` &#x4e2d;&#xff0c;&#x6bd4;&#x5982; key &#x4e3a; `name` &#x7684; `prop`&#xff0c;&#x5b83;&#x7684;&#x503c;&#x4fdd;&#x5b58;&#x5728; `vm._props.name` &#x4e2d;&#xff0c;&#x4f46;&#x662f;&#x6211;&#x4eec;&#x5728;&#x7ec4;&#x4ef6;&#x4e2d;&#x53ef;&#x4ee5;&#x901a;&#x8fc7; `this.name` &#x8bbf;&#x95ee;&#x5230;&#x8fd9;&#x4e2a; `prop`&#xff0c;&#x8fd9;&#x5c31;&#x662f;&#x4ee3;&#x7406;&#x505a;&#x7684;&#x4e8b;&#x60c5;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"519,520"}},{"content":"<pre data-lines=\"521,529\"><code data-lines=\"521,529\"><span class=\"hljs-comment\">// static props are already proxied on the component&apos;s prototype</span>\n<span class=\"hljs-comment\">// during Vue.extend(). We only need to proxy props defined at</span>\n<span class=\"hljs-comment\">// instantiation here.</span>\nif (!(key in vm)) {\n  <span class=\"hljs-built_in\">proxy</span>(vm, `_props`, key)\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"521,529"}},{"content":"<pre data-lines=\"530,531\"><code>&#x901a;&#x8fc7; `proxy` &#x51fd;&#x6570;&#x5b9e;&#x73b0;&#x4e86;&#x4e0a;&#x8ff0;&#x9700;&#x6c42;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"530,531"}},{"content":"<pre data-lines=\"532,550\"><code data-lines=\"532,550\"><span class=\"hljs-keyword\">const</span> sharedPropertyDefinition = {\n  enumerable: <span class=\"hljs-literal\">true</span>,\n  configurable: <span class=\"hljs-literal\">true</span>,\n  <span class=\"hljs-keyword\">get</span>: noop,\n  <span class=\"hljs-keyword\">set</span>: noop\n}\n\n<span class=\"hljs-function\">export function <span class=\"hljs-title\">proxy</span> (<span class=\"hljs-params\">target: Object, sourceKey: <span class=\"hljs-built_in\">string</span>, key: <span class=\"hljs-built_in\">string</span></span>)</span> {\n  sharedPropertyDefinition.<span class=\"hljs-keyword\">get</span> = <span class=\"hljs-function\">function <span class=\"hljs-title\">proxyGetter</span> ()</span> {\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">this</span>[sourceKey][key]\n  }\n  sharedPropertyDefinition.<span class=\"hljs-keyword\">set</span> = <span class=\"hljs-function\">function <span class=\"hljs-title\">proxySetter</span> (<span class=\"hljs-params\">val</span>)</span> {\n    <span class=\"hljs-keyword\">this</span>[sourceKey][key] = val\n  }\n  Object.defineProperty(target, key, sharedPropertyDefinition)\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"532,550"}},{"content":"<pre data-lines=\"551,554\"><code>&#x5f53;&#x8bbf;&#x95ee; `this.name` &#x7684;&#x65f6;&#x5019;&#x5c31;&#x76f8;&#x5f53;&#x4e8e;&#x8bbf;&#x95ee; `this._props.name`&#x3002;\n\n&#x5176;&#x5b9e;&#x5bf9;&#x4e8e;&#x975e;&#x6839;&#x5b9e;&#x4f8b;&#x7684;&#x5b50;&#x7ec4;&#x4ef6;&#x800c;&#x8a00;&#xff0c;`prop` &#x7684;&#x4ee3;&#x7406;&#x53d1;&#x751f;&#x5728; `Vue.extend` &#x9636;&#x6bb5;&#xff0c;&#x5728; `src/core/global-api/extend.js` &#x4e2d;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"551,554"}},{"content":"<pre data-lines=\"555,584\"><code data-lines=\"555,584\"><span class=\"hljs-title class_\">Vue</span>.<span class=\"hljs-property\">extend</span> = <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">extendOptions: <span class=\"hljs-built_in\">Object</span></span>): <span class=\"hljs-title class_\">Function</span> {\n  <span class=\"hljs-comment\">// ...</span>\n  <span class=\"hljs-keyword\">const</span> <span class=\"hljs-title class_\">Sub</span> = <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">VueComponent</span> (<span class=\"hljs-params\">options</span>) {\n    <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-title function_\">_init</span>(options)\n  }\n  <span class=\"hljs-comment\">// ...</span>\n\n  <span class=\"hljs-comment\">// For props and computed properties, we define the proxy getters on</span>\n  <span class=\"hljs-comment\">// the Vue instances at extension time, on the extended prototype. This</span>\n  <span class=\"hljs-comment\">// avoids Object.defineProperty calls for each instance created.</span>\n  <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-title class_\">Sub</span>.<span class=\"hljs-property\">options</span>.<span class=\"hljs-property\">props</span>) {\n    <span class=\"hljs-title function_\">initProps</span>(<span class=\"hljs-title class_\">Sub</span>)\n  }\n  <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-title class_\">Sub</span>.<span class=\"hljs-property\">options</span>.<span class=\"hljs-property\">computed</span>) {\n    <span class=\"hljs-title function_\">initComputed</span>(<span class=\"hljs-title class_\">Sub</span>)\n  }\n\n  <span class=\"hljs-comment\">// ...</span>\n  <span class=\"hljs-keyword\">return</span> <span class=\"hljs-title class_\">Sub</span>\n}\n\n<span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">initProps</span> (<span class=\"hljs-params\">Comp</span>) {\n  <span class=\"hljs-keyword\">const</span> props = <span class=\"hljs-title class_\">Comp</span>.<span class=\"hljs-property\">options</span>.<span class=\"hljs-property\">props</span>\n  <span class=\"hljs-keyword\">for</span> (<span class=\"hljs-keyword\">const</span> key <span class=\"hljs-keyword\">in</span> props) {\n    <span class=\"hljs-title function_\">proxy</span>(<span class=\"hljs-title class_\">Comp</span>.<span class=\"hljs-property\"><span class=\"hljs-keyword\">prototype</span></span>, <span class=\"hljs-string\">`_props`</span>, key)\n  }\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"555,584"}},{"content":"<pre data-lines=\"585,586\"><code>&#x8fd9;&#x4e48;&#x505a;&#x7684;&#x597d;&#x5904;&#x662f;&#x4e0d;&#x7528;&#x4e3a;&#x6bcf;&#x4e2a;&#x7ec4;&#x4ef6;&#x5b9e;&#x4f8b;&#x90fd;&#x505a;&#x4e00;&#x5c42; `proxy`&#xff0c;&#x662f;&#x4e00;&#x79cd;&#x4f18;&#x5316;&#x624b;&#x6bb5;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"585,586"}}],"payload":{"tag":"h3","lines":"517,518"}}],"payload":{"tag":"h2","lines":"108,110"}},{"content":"<a href=\"#props-%E6%9B%B4%E6%96%B0\">#</a> Props &#x66f4;&#x65b0;","children":[{"content":"<a href=\"#%E5%AD%90%E7%BB%84%E4%BB%B6-props-%E6%9B%B4%E6%96%B0\">#</a> &#x5b50;&#x7ec4;&#x4ef6; props &#x66f4;&#x65b0;","children":[{"content":"<pre data-lines=\"594,597\"><code>&#x9996;&#x5148;&#xff0c;`prop` &#x6570;&#x636e;&#x7684;&#x503c;&#x53d8;&#x5316;&#x5728;&#x7236;&#x7ec4;&#x4ef6;&#xff0c;&#x6211;&#x4eec;&#x77e5;&#x9053;&#x5728;&#x7236;&#x7ec4;&#x4ef6;&#x7684; `render` &#x8fc7;&#x7a0b;&#x4e2d;&#x4f1a;&#x8bbf;&#x95ee;&#x5230;&#x8fd9;&#x4e2a; `prop` &#x6570;&#x636e;&#xff0c;&#x6240;&#x4ee5;&#x5f53; `prop` &#x6570;&#x636e;&#x53d8;&#x5316;&#x4e00;&#x5b9a;&#x4f1a;&#x89e6;&#x53d1;&#x7236;&#x7ec4;&#x4ef6;&#x7684;&#x91cd;&#x65b0;&#x6e32;&#x67d3;&#xff0c;&#x90a3;&#x4e48;&#x91cd;&#x65b0;&#x6e32;&#x67d3;&#x662f;&#x5982;&#x4f55;&#x66f4;&#x65b0;&#x5b50;&#x7ec4;&#x4ef6;&#x5bf9;&#x5e94;&#x7684; `prop` &#x7684;&#x503c;&#x5462;&#xff1f;\n\n&#x5728;&#x7236;&#x7ec4;&#x4ef6;&#x91cd;&#x65b0;&#x6e32;&#x67d3;&#x7684;&#x6700;&#x540e;&#xff0c;&#x4f1a;&#x6267;&#x884c; `patch` &#x8fc7;&#x7a0b;&#xff0c;&#x8fdb;&#x800c;&#x6267;&#x884c; `patchVnode` &#x51fd;&#x6570;&#xff0c;`patchVnode` &#x901a;&#x5e38;&#x662f;&#x4e00;&#x4e2a;&#x9012;&#x5f52;&#x8fc7;&#x7a0b;&#xff0c;&#x5f53;&#x5b83;&#x9047;&#x5230;&#x7ec4;&#x4ef6; `vnode` &#x7684;&#x65f6;&#x5019;&#xff0c;&#x4f1a;&#x6267;&#x884c;&#x7ec4;&#x4ef6;&#x66f4;&#x65b0;&#x8fc7;&#x7a0b;&#x7684; `prepatch` &#x94a9;&#x5b50;&#x51fd;&#x6570;&#xff0c;&#x5728; `src/core/vdom/patch.js` &#x4e2d;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"594,597"}},{"content":"<pre data-lines=\"598,617\"><code data-lines=\"598,617\">function patchVnode (\n  oldVnode,\n  vnode,\n  insertedVnodeQueue,\n  ownerArray,\n  index,\n  removeOnly\n) {\n  <span class=\"hljs-comment\">// ...</span>\n\n  let <span class=\"hljs-selector-tag\">i</span>\n  const data = vnode<span class=\"hljs-selector-class\">.data</span>\n  <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-built_in\">isDef</span>(data) &amp;&amp; <span class=\"hljs-built_in\">isDef</span>(<span class=\"hljs-selector-tag\">i</span> = data.hook) &amp;&amp; <span class=\"hljs-built_in\">isDef</span>(<span class=\"hljs-selector-tag\">i</span> = <span class=\"hljs-selector-tag\">i</span>.prepatch)) {\n    <span class=\"hljs-selector-tag\">i</span>(oldVnode, vnode)\n  }\n  <span class=\"hljs-comment\">// ...</span>\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"598,617"}},{"content":"<pre data-lines=\"618,619\"><code>`prepatch` &#x51fd;&#x6570;&#x5b9a;&#x4e49;&#x5728; `src/core/vdom/create-component.js` &#x4e2d;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"618,619"}},{"content":"<pre data-lines=\"620,633\"><code data-lines=\"620,633\">prepatch (oldVnode: MountedComponentVNode, vnode: MountedComponentVNode) {\n  const options = vnode<span class=\"hljs-selector-class\">.componentOptions</span>\n  const child = vnode<span class=\"hljs-selector-class\">.componentInstance</span> = oldVnode<span class=\"hljs-selector-class\">.componentInstance</span>\n  <span class=\"hljs-built_in\">updateChildComponent</span>(\n    child,\n    options<span class=\"hljs-selector-class\">.propsData</span>, <span class=\"hljs-comment\">// updated props</span>\n    options<span class=\"hljs-selector-class\">.listeners</span>, <span class=\"hljs-comment\">// updated listeners</span>\n    vnode, <span class=\"hljs-comment\">// new parent vnode</span>\n    options<span class=\"hljs-selector-class\">.children</span> <span class=\"hljs-comment\">// new children</span>\n  )\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"620,633"}},{"content":"<pre data-lines=\"634,635\"><code>&#x5185;&#x90e8;&#x4f1a;&#x8c03;&#x7528; `updateChildComponent` &#x65b9;&#x6cd5;&#x6765;&#x66f4;&#x65b0; `props`&#xff0c;&#x6ce8;&#x610f;&#x7b2c;&#x4e8c;&#x4e2a;&#x53c2;&#x6570;&#x5c31;&#x662f;&#x7236;&#x7ec4;&#x4ef6;&#x7684; `propData`&#xff0c;&#x90a3;&#x4e48;&#x4e3a;&#x4ec0;&#x4e48; `vnode.componentOptions.propsData` &#x5c31;&#x662f;&#x7236;&#x7ec4;&#x4ef6;&#x4f20;&#x9012;&#x7ed9;&#x5b50;&#x7ec4;&#x4ef6;&#x7684; `prop` &#x6570;&#x636e;&#x5462;&#xff08;&#x8fd9;&#x4e2a;&#x4e5f;&#x540c;&#x6837;&#x89e3;&#x91ca;&#x4e86;&#x7b2c;&#x4e00;&#x6b21;&#x6e32;&#x67d3;&#x7684; `propsData` &#x6765;&#x6e90;&#xff09;&#xff1f;&#x539f;&#x6765;&#x5728;&#x7ec4;&#x4ef6;&#x7684; `render` &#x8fc7;&#x7a0b;&#x4e2d;&#xff0c;&#x5bf9;&#x4e8e;&#x7ec4;&#x4ef6;&#x8282;&#x70b9;&#x4f1a;&#x901a;&#x8fc7; `createComponent` &#x65b9;&#x6cd5;&#x6765;&#x521b;&#x5efa;&#x7ec4;&#x4ef6; `vnode`&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"634,635"}},{"content":"<pre data-lines=\"636,663\"><code data-lines=\"636,663\"><span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">createComponent</span> (<span class=\"hljs-params\">\n  Ctor: Class&lt;Component&gt; | <span class=\"hljs-built_in\">Function</span> | <span class=\"hljs-built_in\">Object</span> | <span class=\"hljs-keyword\">void</span>,\n  data: ?VNodeData,\n  context: Component,\n  children: ?<span class=\"hljs-built_in\">Array</span>&lt;VNode&gt;,\n  tag?: string\n</span>): <span class=\"hljs-title class_\">VNode</span> | <span class=\"hljs-title class_\">Array</span>&lt;<span class=\"hljs-title class_\">VNode</span>&gt; | <span class=\"hljs-keyword\">void</span> {\n  <span class=\"hljs-comment\">// ...</span>\n\n  <span class=\"hljs-comment\">// extract props</span>\n  <span class=\"hljs-keyword\">const</span> propsData = <span class=\"hljs-title function_\">extractPropsFromVNodeData</span>(data, <span class=\"hljs-title class_\">Ctor</span>, tag)\n\n  <span class=\"hljs-comment\">// ...</span>\n  \n  <span class=\"hljs-keyword\">const</span> vnode = <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">VNode</span>(\n    <span class=\"hljs-string\">`vue-component-<span class=\"hljs-subst\">&#x24;{Ctor.cid}</span><span class=\"hljs-subst\">&#x24;{name ? <span class=\"hljs-string\">`-<span class=\"hljs-subst\">&#x24;{name}</span>`</span> : <span class=\"hljs-string\">&apos;&apos;</span>}</span>`</span>,\n    data, <span class=\"hljs-literal\">undefined</span>, <span class=\"hljs-literal\">undefined</span>, <span class=\"hljs-literal\">undefined</span>, context,\n    { <span class=\"hljs-title class_\">Ctor</span>, propsData, listeners, tag, children },\n    asyncFactory\n  )\n\n  <span class=\"hljs-comment\">// ...</span>\n  \n  <span class=\"hljs-keyword\">return</span> vnode\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"636,663"}},{"content":"<pre data-lines=\"664,667\"><code>&#x5728;&#x521b;&#x5efa;&#x7ec4;&#x4ef6; `vnode` &#x7684;&#x8fc7;&#x7a0b;&#x4e2d;&#xff0c;&#x9996;&#x5148;&#x4ece; `data` &#x4e2d;&#x63d0;&#x53d6;&#x51fa; `propData`&#xff0c;&#x7136;&#x540e;&#x5728; `new VNode` &#x7684;&#x65f6;&#x5019;&#xff0c;&#x4f5c;&#x4e3a;&#x7b2c;&#x4e03;&#x4e2a;&#x53c2;&#x6570; `VNodeComponentOptions` &#x4e2d;&#x7684;&#x4e00;&#x4e2a;&#x5c5e;&#x6027;&#x4f20;&#x5165;&#xff0c;&#x6240;&#x4ee5;&#x6211;&#x4eec;&#x53ef;&#x4ee5;&#x901a;&#x8fc7; `vnode.componentOptions.propsData` &#x62ff;&#x5230; `prop` &#x6570;&#x636e;&#x3002;\n\n&#x63a5;&#x7740;&#x770b; `updateChildComponent` &#x51fd;&#x6570;&#xff0c;&#x5b83;&#x7684;&#x5b9a;&#x4e49;&#x5728; `src/core/instance/lifecycle.js` &#x4e2d;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"664,667"}},{"content":"<pre data-lines=\"668,696\"><code data-lines=\"668,696\"><span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">updateChildComponent</span> (<span class=\"hljs-params\">\n  vm: Component,\n  propsData: ?<span class=\"hljs-built_in\">Object</span>,\n  listeners: ?<span class=\"hljs-built_in\">Object</span>,\n  parentVnode: MountedComponentVNode,\n  renderChildren: ?<span class=\"hljs-built_in\">Array</span>&lt;VNode&gt;\n</span>) {\n  <span class=\"hljs-comment\">// ...</span>\n\n  <span class=\"hljs-comment\">// update props</span>\n  <span class=\"hljs-keyword\">if</span> (propsData &amp;&amp; vm.<span class=\"hljs-property\">&#x24;options</span>.<span class=\"hljs-property\">props</span>) {\n    <span class=\"hljs-title function_\">toggleObserving</span>(<span class=\"hljs-literal\">false</span>)\n    <span class=\"hljs-keyword\">const</span> props = vm.<span class=\"hljs-property\">_props</span>\n    <span class=\"hljs-keyword\">const</span> propKeys = vm.<span class=\"hljs-property\">&#x24;options</span>.<span class=\"hljs-property\">_propKeys</span> || []\n    <span class=\"hljs-keyword\">for</span> (<span class=\"hljs-keyword\">let</span> i = <span class=\"hljs-number\">0</span>; i &lt; propKeys.<span class=\"hljs-property\">length</span>; i++) {\n      <span class=\"hljs-keyword\">const</span> key = propKeys[i]\n      <span class=\"hljs-keyword\">const</span> <span class=\"hljs-attr\">propOptions</span>: any = vm.<span class=\"hljs-property\">&#x24;options</span>.<span class=\"hljs-property\">props</span> <span class=\"hljs-comment\">// wtf flow?</span>\n      props[key] = <span class=\"hljs-title function_\">validateProp</span>(key, propOptions, propsData, vm)\n    }\n    <span class=\"hljs-title function_\">toggleObserving</span>(<span class=\"hljs-literal\">true</span>)\n    <span class=\"hljs-comment\">// keep a copy of raw propsData</span>\n    vm.<span class=\"hljs-property\">&#x24;options</span>.<span class=\"hljs-property\">propsData</span> = propsData\n  }\n\n  <span class=\"hljs-comment\">// ...</span>\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"668,696"}},{"content":"<pre data-lines=\"697,698\"><code>&#x6211;&#x4eec;&#x91cd;&#x70b9;&#x6765;&#x770b;&#x66f4;&#x65b0; `props` &#x7684;&#x76f8;&#x5173;&#x903b;&#x8f91;&#xff0c;&#x8fd9;&#x91cc;&#x7684; `propsData` &#x662f;&#x7236;&#x7ec4;&#x4ef6;&#x4f20;&#x9012;&#x7684; `props` &#x6570;&#x636e;&#xff0c;`vm` &#x662f;&#x5b50;&#x7ec4;&#x4ef6;&#x7684;&#x5b9e;&#x4f8b;&#x3002;`vm._props` &#x6307;&#x5411;&#x7684;&#x5c31;&#x662f;&#x5b50;&#x7ec4;&#x4ef6;&#x7684; `props` &#x503c;&#xff0c;`propKeys` &#x5c31;&#x662f;&#x5728;&#x4e4b;&#x524d; `initProps` &#x8fc7;&#x7a0b;&#x4e2d;&#xff0c;&#x7f13;&#x5b58;&#x7684;&#x5b50;&#x7ec4;&#x4ef6;&#x4e2d;&#x5b9a;&#x4e49;&#x7684;&#x6240;&#x6709; `prop` &#x7684; `key`&#x3002;&#x4e3b;&#x8981;&#x903b;&#x8f91;&#x5c31;&#x662f;&#x904d;&#x5386; `propKeys`&#xff0c;&#x7136;&#x540e;&#x6267;&#x884c; `props[key] = validateProp(key, propOptions, propsData, vm)` &#x91cd;&#x65b0;&#x9a8c;&#x8bc1;&#x548c;&#x8ba1;&#x7b97;&#x65b0;&#x7684; `prop` &#x6570;&#x636e;&#xff0c;&#x66f4;&#x65b0; `vm._props`&#xff0c;&#x4e5f;&#x5c31;&#x662f;&#x5b50;&#x7ec4;&#x4ef6;&#x7684; `props`&#xff0c;&#x8fd9;&#x4e2a;&#x5c31;&#x662f;&#x5b50;&#x7ec4;&#x4ef6; `props` &#x7684;&#x66f4;&#x65b0;&#x8fc7;&#x7a0b;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"697,698"}}],"payload":{"tag":"h3","lines":"592,593"}},{"content":"<a href=\"#%E5%AD%90%E7%BB%84%E4%BB%B6%E9%87%8D%E6%96%B0%E6%B8%B2%E6%9F%93\">#</a> &#x5b50;&#x7ec4;&#x4ef6;&#x91cd;&#x65b0;&#x6e32;&#x67d3;","children":[{"content":"<pre data-lines=\"701,708\"><code>&#x5176;&#x5b9e;&#x5b50;&#x7ec4;&#x4ef6;&#x7684;&#x91cd;&#x65b0;&#x6e32;&#x67d3;&#x6709; 2 &#x79cd;&#x60c5;&#x51b5;&#xff0c;&#x4e00;&#x4e2a;&#x662f; `prop` &#x503c;&#x88ab;&#x4fee;&#x6539;&#xff0c;&#x53e6;&#x4e00;&#x4e2a;&#x662f;&#x5bf9;&#x8c61;&#x7c7b;&#x578b;&#x7684; `prop` &#x5185;&#x90e8;&#x5c5e;&#x6027;&#x7684;&#x53d8;&#x5316;&#x3002;\n\n&#x5148;&#x6765;&#x770b;&#x4e00;&#x4e0b; `prop` &#x503c;&#x88ab;&#x4fee;&#x6539;&#x7684;&#x60c5;&#x51b5;&#xff0c;&#x5f53;&#x6267;&#x884c; `props[key] = validateProp(key, propOptions, propsData, vm)` &#x66f4;&#x65b0;&#x5b50;&#x7ec4;&#x4ef6; `prop` &#x7684;&#x65f6;&#x5019;&#xff0c;&#x4f1a;&#x89e6;&#x53d1; `prop` &#x7684; `setter` &#x8fc7;&#x7a0b;&#xff0c;&#x53ea;&#x8981;&#x5728;&#x6e32;&#x67d3;&#x5b50;&#x7ec4;&#x4ef6;&#x7684;&#x65f6;&#x5019;&#x8bbf;&#x95ee;&#x8fc7;&#x8fd9;&#x4e2a; `prop` &#x503c;&#xff0c;&#x90a3;&#x4e48;&#x6839;&#x636e;&#x54cd;&#x5e94;&#x5f0f;&#x539f;&#x7406;&#xff0c;&#x5c31;&#x4f1a;&#x89e6;&#x53d1;&#x5b50;&#x7ec4;&#x4ef6;&#x7684;&#x91cd;&#x65b0;&#x6e32;&#x67d3;&#x3002;\n\n&#x518d;&#x6765;&#x770b;&#x4e00;&#x4e0b;&#x5f53;&#x5bf9;&#x8c61;&#x7c7b;&#x578b;&#x7684; `prop` &#x7684;&#x5185;&#x90e8;&#x5c5e;&#x6027;&#x53d1;&#x751f;&#x53d8;&#x5316;&#x7684;&#x65f6;&#x5019;&#xff0c;&#x8fd9;&#x4e2a;&#x65f6;&#x5019;&#x5176;&#x5b9e;&#x5e76;&#x6ca1;&#x6709;&#x89e6;&#x53d1;&#x5b50;&#x7ec4;&#x4ef6; `prop` &#x7684;&#x66f4;&#x65b0;&#x3002;&#x4f46;&#x662f;&#x5728;&#x5b50;&#x7ec4;&#x4ef6;&#x7684;&#x6e32;&#x67d3;&#x8fc7;&#x7a0b;&#x4e2d;&#xff0c;&#x8bbf;&#x95ee;&#x8fc7;&#x8fd9;&#x4e2a;&#x5bf9;&#x8c61; `prop`&#xff0c;&#x6240;&#x4ee5;&#x8fd9;&#x4e2a;&#x5bf9;&#x8c61; `prop` &#x5728;&#x89e6;&#x53d1; `getter` &#x7684;&#x65f6;&#x5019;&#x4f1a;&#x628a;&#x5b50;&#x7ec4;&#x4ef6;&#x7684; `render watcher` &#x6536;&#x96c6;&#x5230;&#x4f9d;&#x8d56;&#x4e2d;&#xff0c;&#x7136;&#x540e;&#x5f53;&#x6211;&#x4eec;&#x5728;&#x7236;&#x7ec4;&#x4ef6;&#x66f4;&#x65b0;&#x8fd9;&#x4e2a;&#x5bf9;&#x8c61; `prop` &#x7684;&#x67d0;&#x4e2a;&#x5c5e;&#x6027;&#x7684;&#x65f6;&#x5019;&#xff0c;&#x4f1a;&#x89e6;&#x53d1; `setter` &#x8fc7;&#x7a0b;&#xff0c;&#x4e5f;&#x5c31;&#x4f1a;&#x901a;&#x77e5;&#x5b50;&#x7ec4;&#x4ef6; `render watcher` &#x7684; `update`&#xff0c;&#x8fdb;&#x800c;&#x89e6;&#x53d1;&#x5b50;&#x7ec4;&#x4ef6;&#x7684;&#x91cd;&#x65b0;&#x6e32;&#x67d3;&#x3002;\n\n&#x4ee5;&#x4e0a;&#x5c31;&#x662f;&#x5f53;&#x7236;&#x7ec4;&#x4ef6; `props` &#x66f4;&#x65b0;&#xff0c;&#x89e6;&#x53d1;&#x5b50;&#x7ec4;&#x4ef6;&#x91cd;&#x65b0;&#x6e32;&#x67d3;&#x7684; 2 &#x79cd;&#x60c5;&#x51b5;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"701,708"}}],"payload":{"tag":"h3","lines":"699,700"}}],"payload":{"tag":"h2","lines":"587,589"}},{"content":"<a href=\"#toggleobserving\">#</a> toggleObserving","children":[{"content":"<pre data-lines=\"712,713\"><code>&#x6700;&#x540e;&#x6211;&#x4eec;&#x5728;&#x6765;&#x804a;&#x4e00;&#x4e0b; `toggleObserving`&#xff0c;&#x5b83;&#x7684;&#x5b9a;&#x4e49;&#x5728; `src/core/observer/index.js` &#x4e2d;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"712,713"}},{"content":"<pre data-lines=\"714,721\"><code data-lines=\"714,721\"><span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">let</span> <span class=\"hljs-attr\">shouldObserve</span>: <span class=\"hljs-built_in\">boolean</span> = <span class=\"hljs-literal\">true</span>\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">toggleObserving</span> (<span class=\"hljs-params\"><span class=\"hljs-attr\">value</span>: <span class=\"hljs-built_in\">boolean</span></span>) {\n  shouldObserve = value\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"714,721"}},{"content":"<pre data-lines=\"722,727\"><code>&#x5b83;&#x5728;&#x5f53;&#x524d;&#x6a21;&#x5757;&#x4e2d;&#x5b9a;&#x4e49;&#x4e86; `shouldObserve` &#x53d8;&#x91cf;&#xff0c;&#x7528;&#x6765;&#x63a7;&#x5236;&#x5728; `observe` &#x7684;&#x8fc7;&#x7a0b;&#x4e2d;&#x662f;&#x5426;&#x9700;&#x8981;&#x628a;&#x5f53;&#x524d;&#x503c;&#x53d8;&#x6210;&#x4e00;&#x4e2a; `Observer` &#x5bf9;&#x8c61;&#x3002;\n\n&#x90a3;&#x4e48;&#x4e3a;&#x4ec0;&#x4e48;&#x5728; `props` &#x7684;&#x521d;&#x59cb;&#x5316;&#x548c;&#x66f4;&#x65b0;&#x8fc7;&#x7a0b;&#x4e2d;&#xff0c;&#x591a;&#x6b21;&#x6267;&#x884c; `toggleObserving(false)` &#x5462;&#xff0c;&#x63a5;&#x4e0b;&#x6765;&#x6211;&#x4eec;&#x5c31;&#x6765;&#x5206;&#x6790;&#x8fd9;&#x51e0;&#x79cd;&#x60c5;&#x51b5;&#x3002;\n\n&#x5728; `initProps` &#x7684;&#x8fc7;&#x7a0b;&#x4e2d;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"722,727"}},{"content":"<pre data-lines=\"728,742\"><code data-lines=\"728,742\"><span class=\"hljs-keyword\">const</span> isRoot = !vm.&#x24;parent\n<span class=\"hljs-comment\">// root instance props should be converted</span>\n<span class=\"hljs-keyword\">if</span> (!isRoot) {\n  <span class=\"hljs-title function_\">toggleObserving</span>(<span class=\"hljs-literal\">false</span>)\n}\n<span class=\"hljs-keyword\">for</span> (<span class=\"hljs-keyword\">const</span> <span class=\"hljs-built_in\">key</span> in propsOptions) {\n  <span class=\"hljs-comment\">// ...</span>\n  <span class=\"hljs-keyword\">const</span> value = <span class=\"hljs-title function_\">validateProp</span>(<span class=\"hljs-built_in\">key</span>, propsOptions, propsData, vm)\n  <span class=\"hljs-title function_\">defineReactive</span>(props, <span class=\"hljs-built_in\">key</span>, value)\n  <span class=\"hljs-comment\">// ...</span>\n}\n<span class=\"hljs-title function_\">toggleObserving</span>(<span class=\"hljs-literal\">true</span>) \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"728,742"}},{"content":"<pre data-lines=\"743,746\"><code>&#x5bf9;&#x4e8e;&#x975e;&#x6839;&#x5b9e;&#x4f8b;&#x7684;&#x60c5;&#x51b5;&#xff0c;&#x6211;&#x4eec;&#x4f1a;&#x6267;&#x884c; `toggleObserving(false)`&#xff0c;&#x7136;&#x540e;&#x5bf9;&#x4e8e;&#x6bcf;&#x4e00;&#x4e2a; `prop` &#x503c;&#xff0c;&#x53bb;&#x6267;&#x884c; `defineReactive(props, key, value)` &#x53bb;&#x628a;&#x5b83;&#x53d8;&#x6210;&#x54cd;&#x5e94;&#x5f0f;&#x3002;\n\n&#x56de;&#x987e;&#x4e00;&#x4e0b; `defineReactive` &#x7684;&#x5b9a;&#x4e49;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"743,746"}},{"content":"<pre data-lines=\"747,770\"><code data-lines=\"747,770\"><span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">defineReactive</span> (<span class=\"hljs-params\">\n  obj: <span class=\"hljs-built_in\">Object</span>,\n  key: string,\n  val: any,\n  customSetter?: ?<span class=\"hljs-built_in\">Function</span>,\n  shallow?: boolean\n</span>) {\n  <span class=\"hljs-comment\">// ...</span>\n  \n  <span class=\"hljs-keyword\">let</span> childOb = !shallow &amp;&amp; <span class=\"hljs-title function_\">observe</span>(val)\n  <span class=\"hljs-title class_\">Object</span>.<span class=\"hljs-title function_\">defineProperty</span>(obj, key, {\n    <span class=\"hljs-attr\">enumerable</span>: <span class=\"hljs-literal\">true</span>,\n    <span class=\"hljs-attr\">configurable</span>: <span class=\"hljs-literal\">true</span>,\n    <span class=\"hljs-attr\">get</span>: <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">reactiveGetter</span> (<span class=\"hljs-params\"></span>) {\n      <span class=\"hljs-comment\">// ...</span>\n    },\n    <span class=\"hljs-attr\">set</span>: <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">reactiveSetter</span> (<span class=\"hljs-params\">newVal</span>) {\n      <span class=\"hljs-comment\">// ...</span>\n    }\n  })\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"747,770"}},{"content":"<pre data-lines=\"771,778\"><code>&#x901a;&#x5e38;&#x5bf9;&#x4e8e;&#x503c; `val` &#x4f1a;&#x6267;&#x884c; `observe` &#x51fd;&#x6570;&#xff0c;&#x7136;&#x540e;&#x9047;&#x5230; `val` &#x662f;&#x5bf9;&#x8c61;&#x6216;&#x8005;&#x6570;&#x7ec4;&#x7684;&#x60c5;&#x51b5;&#x4f1a;&#x9012;&#x5f52;&#x6267;&#x884c; `defineReactive` &#x628a;&#x5b83;&#x4eec;&#x7684;&#x5b50;&#x5c5e;&#x6027;&#x90fd;&#x53d8;&#x6210;&#x54cd;&#x5e94;&#x5f0f;&#x7684;&#xff0c;&#x4f46;&#x662f;&#x7531;&#x4e8e; `shouldObserve` &#x7684;&#x503c;&#x53d8;&#x6210;&#x4e86; `false`&#xff0c;&#x8fd9;&#x4e2a;&#x9012;&#x5f52;&#x8fc7;&#x7a0b;&#x88ab;&#x7701;&#x7565;&#x4e86;&#x3002;&#x4e3a;&#x4ec0;&#x4e48;&#x4f1a;&#x8fd9;&#x6837;&#x5462;&#xff1f;\n\n&#x56e0;&#x4e3a;&#x6b63;&#x5982;&#x6211;&#x4eec;&#x524d;&#x9762;&#x5206;&#x6790;&#x7684;&#xff0c;&#x5bf9;&#x4e8e;&#x5bf9;&#x8c61;&#x7684; `prop` &#x503c;&#xff0c;&#x5b50;&#x7ec4;&#x4ef6;&#x7684; `prop` &#x503c;&#x59cb;&#x7ec8;&#x6307;&#x5411;&#x7236;&#x7ec4;&#x4ef6;&#x7684; `prop` &#x503c;&#xff0c;&#x53ea;&#x8981;&#x7236;&#x7ec4;&#x4ef6;&#x7684; `prop` &#x503c;&#x53d8;&#x5316;&#xff0c;&#x5c31;&#x4f1a;&#x89e6;&#x53d1;&#x5b50;&#x7ec4;&#x4ef6;&#x7684;&#x91cd;&#x65b0;&#x6e32;&#x67d3;&#xff0c;&#x6240;&#x4ee5;&#x8fd9;&#x4e2a; `observe` &#x8fc7;&#x7a0b;&#x662f;&#x53ef;&#x4ee5;&#x7701;&#x7565;&#x7684;&#x3002;\n\n&#x6700;&#x540e;&#x518d;&#x6267;&#x884c; `toggleObserving(true)` &#x6062;&#x590d; `shouldObserve` &#x4e3a; `true`&#x3002;\n\n&#x5728; `validateProp` &#x7684;&#x8fc7;&#x7a0b;&#x4e2d;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"771,778"}},{"content":"<pre data-lines=\"779,791\"><code data-lines=\"779,791\">//<span class=\"hljs-built_in\"> check </span>default value<span class=\"hljs-built_in\">\nif </span>(value === undefined) {\n  value = getPropDefaultValue(vm, prop, key)\n  // since the default value is a fresh copy,\n  // make sure to observe it.\n <span class=\"hljs-built_in\"> const </span>prevShouldObserve = shouldObserve\n  toggleObserving(true)\n  observe(value)\n  toggleObserving(prevShouldObserve)\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"779,791"}},{"content":"<pre data-lines=\"792,795\"><code>&#x8fd9;&#x79cd;&#x662f;&#x7236;&#x7ec4;&#x4ef6;&#x6ca1;&#x6709;&#x4f20;&#x9012; `prop` &#x503c;&#x5bf9;&#x9ed8;&#x8ba4;&#x503c;&#x7684;&#x5904;&#x7406;&#x903b;&#x8f91;&#xff0c;&#x56e0;&#x4e3a;&#x8fd9;&#x4e2a;&#x503c;&#x662f;&#x4e00;&#x4e2a;&#x62f7;&#x8d1d;&#xff0c;&#x6240;&#x4ee5;&#x6211;&#x4eec;&#x9700;&#x8981; `toggleObserving(true)`&#xff0c;&#x7136;&#x540e;&#x6267;&#x884c; `observe(value)` &#x628a;&#x503c;&#x53d8;&#x6210;&#x54cd;&#x5e94;&#x5f0f;&#x3002;\n\n&#x5728; `updateChildComponent` &#x8fc7;&#x7a0b;&#x4e2d;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"792,795"}},{"content":"<pre data-lines=\"796,812\"><code data-lines=\"796,812\"><span class=\"hljs-comment\">// update props</span>\n<span class=\"hljs-keyword\">if</span> (propsData &amp;&amp; vm.<span class=\"hljs-variable\">&#x24;options</span>.props) {\n  <span class=\"hljs-title function_ invoke__\">toggleObserving</span>(<span class=\"hljs-literal\">false</span>)\n  <span class=\"hljs-keyword\">const</span> <span class=\"hljs-variable constant_\">props</span> = vm._props\n  <span class=\"hljs-keyword\">const</span> <span class=\"hljs-variable constant_\">propKeys</span> = vm.<span class=\"hljs-variable\">&#x24;options</span>._propKeys || []\n  <span class=\"hljs-keyword\">for</span> (let i = <span class=\"hljs-number\">0</span>; i &lt; propKeys.length; i++) {\n    <span class=\"hljs-keyword\">const</span> <span class=\"hljs-variable constant_\">key</span> = propKeys[i]\n    <span class=\"hljs-keyword\">const</span> <span class=\"hljs-variable constant_\">propOptions</span>: any = vm.<span class=\"hljs-variable\">&#x24;options</span>.props <span class=\"hljs-comment\">// wtf flow?</span>\n    props[key] = <span class=\"hljs-title function_ invoke__\">validateProp</span>(key, propOptions, propsData, vm)\n  }\n  <span class=\"hljs-title function_ invoke__\">toggleObserving</span>(<span class=\"hljs-literal\">true</span>)\n  <span class=\"hljs-comment\">// keep a copy of raw propsData</span>\n  vm.<span class=\"hljs-variable\">&#x24;options</span>.propsData = propsData\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"796,812"}},{"content":"<pre data-lines=\"813,814\"><code>&#x5176;&#x5b9e;&#x548c; `initProps` &#x7684;&#x903b;&#x8f91;&#x4e00;&#x6837;&#xff0c;&#x4e0d;&#x9700;&#x8981;&#x5bf9;&#x5f15;&#x7528;&#x7c7b;&#x578b; `props` &#x9012;&#x5f52;&#x505a;&#x54cd;&#x5e94;&#x5f0f;&#x5904;&#x7406;&#xff0c;&#x6240;&#x4ee5;&#x4e5f;&#x9700;&#x8981; `toggleObserving(false)`&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"813,814"}}],"payload":{"tag":"h2","lines":"709,711"}},{"content":"<a href=\"#%E6%80%BB%E7%BB%93\">#</a> &#x603b;&#x7ed3;","children":[{"content":"<pre data-lines=\"818,819\"><code>&#x901a;&#x8fc7;&#x8fd9;&#x4e00;&#x8282;&#x7684;&#x5206;&#x6790;&#xff0c;&#x6211;&#x4eec;&#x4e86;&#x89e3;&#x4e86; `props` &#x7684;&#x89c4;&#x8303;&#x5316;&#x3001;&#x521d;&#x59cb;&#x5316;&#x3001;&#x66f4;&#x65b0;&#x7b49;&#x8fc7;&#x7a0b;&#x7684;&#x5b9e;&#x73b0;&#x539f;&#x7406;&#xff1b;&#x4e5f;&#x4e86;&#x89e3;&#x4e86; Vue &#x5185;&#x90e8;&#x5bf9; `props` &#x5982;&#x4f55;&#x505a;&#x54cd;&#x5e94;&#x5f0f;&#x7684;&#x4f18;&#x5316;&#xff1b;&#x540c;&#x65f6;&#x8fd8;&#x4e86;&#x89e3;&#x5230; `props` &#x7684;&#x53d8;&#x5316;&#x662f;&#x5982;&#x4f55;&#x89e6;&#x53d1;&#x5b50;&#x7ec4;&#x4ef6;&#x7684;&#x66f4;&#x65b0;&#x3002;&#x4e86;&#x89e3;&#x8fd9;&#x4e9b;&#x5bf9;&#x6211;&#x4eec;&#x5e73;&#x65f6;&#x5bf9; `props` &#x7684;&#x5e94;&#x7528;&#xff0c;&#x9047;&#x5230;&#x95ee;&#x9898;&#x65f6;&#x7684;&#x5b9a;&#x4f4d;&#x8ffd;&#x8e2a;&#x4f1a;&#x6709;&#x5f88;&#x5927;&#x7684;&#x5e2e;&#x52a9;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"818,819"}}],"payload":{"tag":"h2","lines":"815,817"}}],"payload":{"tag":"h1","lines":"0,2"}},{})</script>
</body>
</html>
