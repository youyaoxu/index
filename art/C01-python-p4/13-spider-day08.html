<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets@11.11.1/styles/default.min.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.18.10/dist/browser/index.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/index.js"></script><script>(r => {
              setTimeout(r);
            })(function renderToolbar() {
  const {
    markmap,
    mm
  } = window;
  const {
    el
  } = markmap.Toolbar.create(mm);
  el.setAttribute('style', 'position:absolute;bottom:20px;right:20px');
  document.body.append(el);
})</script><script>((getMarkmap, getOptions, root2, jsonOptions) => {
              const markmap = getMarkmap();
              window.mm = markmap.Markmap.create(
                "svg#mindmap",
                (getOptions || markmap.deriveOptions)(jsonOptions),
                root2
              );
            })(() => window.markmap,null,{"content":"","children":[{"content":"Day07&#x56de;&#x987e;","children":[{"content":"selenium+phantomjs/chrome/firefox","children":[{"content":"&#x8bbe;&#x7f6e;&#x65e0;&#x754c;&#x9762;&#x6a21;&#x5f0f;&#xff08;chromedriver | firefox&#xff09;","children":[{"content":"<pre data-lines=\"6,13\"><code class=\"language-python\">options = webdriver.ChromeOptions()\noptions.add_argument(<span class=\"hljs-string\">&apos;--headless&apos;</span>)\n\nbrowser = webdriver.Chrome(options=options)\nbrowser.get(url)\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"6,13"}}],"payload":{"tag":"h3","lines":"4,5"}},{"content":"browser&#x6267;&#x884c;JS&#x811a;&#x672c;","children":[{"content":"<pre data-lines=\"16,22\"><code class=\"language-python\">browser.execute_script(\n<span class=\"hljs-string\">&apos;window.scrollTo(0,document.body.scrollHeight)&apos;</span>\n)\ntime.sleep(<span class=\"hljs-number\">2</span>)\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"16,22"}}],"payload":{"tag":"h3","lines":"14,15"}},{"content":"selenium&#x5e38;&#x7528;&#x64cd;&#x4f5c;","children":[{"content":"<pre data-lines=\"25,54\"><code class=\"language-python\">&#x3010;<span class=\"hljs-number\">1</span>&#x3011;&#x952e;&#x76d8;&#x64cd;&#x4f5c;\n    <span class=\"hljs-keyword\">from</span> selenium.webdriver.common.keys <span class=\"hljs-keyword\">import</span> Keys\n    node.send_keys(Keys.SPACE)\n    node.send_keys(Keys.CONTROL, <span class=\"hljs-string\">&apos;a&apos;</span>)\n    node.send_keys(Keys.CONTROL, <span class=\"hljs-string\">&apos;c&apos;</span>)\n    node.send_keys(Keys.CONTROL, <span class=\"hljs-string\">&apos;v&apos;</span>)\n    node.send_keys(Keys.ENTER)\n\n&#x3010;<span class=\"hljs-number\">2</span>&#x3011;&#x9f20;&#x6807;&#x64cd;&#x4f5c;\n    <span class=\"hljs-keyword\">from</span> selenium.webdriver <span class=\"hljs-keyword\">import</span> ActionChains\n    mouse_action = ActionChains(browser)\n    mouse_action.move_to_element(node)\n    mouse_action.perform()\n\n&#x3010;<span class=\"hljs-number\">3</span>&#x3011;&#x5207;&#x6362;&#x53e5;&#x67c4;\n    all_handles = browser.window_handles\n    time.sleep(<span class=\"hljs-number\">1</span>)\n    browser.switch_to.window(all_handles[<span class=\"hljs-number\">1</span>])\n\n&#x3010;<span class=\"hljs-number\">4</span>&#x3011;iframe&#x5b50;&#x6846;&#x67b6;\n    browser.switch_to.frame(iframe_element)\n    <span class=\"hljs-comment\"># &#x5199;&#x6cd5;1 - &#x4efb;&#x4f55;&#x573a;&#x666f;&#x90fd;&#x53ef;&#x4ee5;: </span>\n    iframe_node = browser.find_element_by_xpath(<span class=\"hljs-string\">&apos;&apos;</span>)\n    browser.switch_to.frame(iframe_node)\n    \n    <span class=\"hljs-comment\"># &#x5199;&#x6cd5;2 - &#x9ed8;&#x8ba4;&#x652f;&#x6301; id &#x548c; name &#x4e24;&#x4e2a;&#x5c5e;&#x6027;&#x503c;:</span>\n    browser.switch_to.frame(<span class=\"hljs-string\">&apos;id&#x5c5e;&#x6027;&#x503c;|name&#x5c5e;&#x6027;&#x503c;&apos;</span>)\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"25,54"}}],"payload":{"tag":"h3","lines":"23,24"}}],"payload":{"tag":"h2","lines":"2,3"}},{"content":"scrapy&#x6846;&#x67b6;","children":[{"content":"&#x4e94;&#x5927;&#x7ec4;&#x4ef6;","children":[{"content":"<pre data-lines=\"59,71\"><code class=\"language-python\">&#x3010;1&#x3011;&#x5f15;&#x64ce;&#xff08;Engine&#xff09;----------&#x6574;&#x4e2a;&#x6846;&#x67b6;&#x6838;&#x5fc3;\n&#x3010;2&#x3011;&#x722c;&#x866b;&#x7a0b;&#x5e8f;&#xff08;Spider&#xff09;------&#x6570;&#x636e;&#x89e3;&#x6790;&#x63d0;&#x53d6;\n&#x3010;3&#x3011;&#x8c03;&#x5ea6;&#x5668;&#xff08;Scheduler&#xff09;-----&#x7ef4;&#x62a4;&#x8bf7;&#x6c42;&#x961f;&#x5217;\n&#x3010;4&#x3011;&#x4e0b;&#x8f7d;&#x5668;&#xff08;Downloader&#xff09;----&#x83b7;&#x53d6;&#x54cd;&#x5e94;&#x5bf9;&#x8c61;\n&#x3010;5&#x3011;&#x7ba1;&#x9053;&#x6587;&#x4ef6;&#xff08;Pipeline&#xff09;-----&#x6570;&#x636e;&#x5165;&#x5e93;&#x5904;&#x7406;\n\n\n&#x3010;&#x4e24;&#x4e2a;&#x4e2d;&#x95f4;&#x4ef6;&#x3011;\n    &#x4e0b;&#x8f7d;&#x5668;&#x4e2d;&#x95f4;&#x4ef6;&#xff08;Downloader Middlewares&#xff09;\n    &#x8718;&#x86db;&#x4e2d;&#x95f4;&#x4ef6;&#xff08;Spider Middlewares&#xff09;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"59,71"}}],"payload":{"tag":"h3","lines":"57,58"}},{"content":"&#x5de5;&#x4f5c;&#x6d41;&#x7a0b;","children":[{"content":"<pre data-lines=\"74,82\"><code class=\"language-python\">&#x3010;1&#x3011;Engine&#x5411;Spider&#x7d22;&#x8981;URL,&#x4ea4;&#x7ed9;Scheduler&#x5165;&#x961f;&#x5217;\n&#x3010;2&#x3011;Scheduler&#x5904;&#x7406;&#x540e;&#x51fa;&#x961f;&#x5217;,&#x901a;&#x8fc7;Downloader Middlewares&#x4ea4;&#x7ed9;Downloader&#x53bb;&#x4e0b;&#x8f7d;\n&#x3010;3&#x3011;Downloader&#x5f97;&#x5230;&#x54cd;&#x5e94;&#x540e;,&#x901a;&#x8fc7;Spider Middlewares&#x4ea4;&#x7ed9;Spider\n&#x3010;4&#x3011;Spider&#x6570;&#x636e;&#x63d0;&#x53d6;&#xff1a;\n    4.1) &#x6570;&#x636e;&#x4ea4;&#x7ed9;Pipeline&#x5904;&#x7406;\n    4.2) &#x9700;&#x8981;&#x8ddf;&#x8fdb;URL,&#x7ee7;&#x7eed;&#x4ea4;&#x7ed9;Scheduler&#x5165;&#x961f;&#x5217;&#xff0c;&#x4f9d;&#x6b21;&#x5faa;&#x73af;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"74,82"}}],"payload":{"tag":"h3","lines":"72,73"}},{"content":"&#x5e38;&#x7528;&#x547d;&#x4ee4;","children":[{"content":"<pre data-lines=\"85,93\"><code class=\"language-python\">&#x3010;1&#x3011;&#x521b;&#x5efa;&#x722c;&#x866b;&#x9879;&#x76ee; : scrapy startproject &#x9879;&#x76ee;&#x540d;\n&#x3010;2&#x3011;&#x521b;&#x5efa;&#x722c;&#x866b;&#x6587;&#x4ef6;\n    2.1) cd &#x9879;&#x76ee;&#x6587;&#x4ef6;&#x5939;\n    2.2) scrapy genspider &#x722c;&#x866b;&#x540d; &#x57df;&#x540d;\n&#x3010;3&#x3011;&#x8fd0;&#x884c;&#x722c;&#x866b;\n    scrapy crawl &#x722c;&#x866b;&#x540d;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"85,93"}}],"payload":{"tag":"h3","lines":"83,84"}},{"content":"scrapy&#x9879;&#x76ee;&#x76ee;&#x5f55;&#x7ed3;&#x6784;","children":[{"content":"<pre data-lines=\"96,107\"><code class=\"language-python\">Baidu                   <span class=\"hljs-comment\"># &#x9879;&#x76ee;&#x6587;&#x4ef6;&#x5939;</span>\n&#x251c;&#x2500;&#x2500; Baidu               <span class=\"hljs-comment\"># &#x9879;&#x76ee;&#x76ee;&#x5f55;</span>\n&#x2502;   &#x251c;&#x2500;&#x2500; items.py        <span class=\"hljs-comment\"># &#x5b9a;&#x4e49;&#x6570;&#x636e;&#x7ed3;&#x6784;</span>\n&#x2502;   &#x251c;&#x2500;&#x2500; middlewares.py  <span class=\"hljs-comment\"># &#x4e2d;&#x95f4;&#x4ef6;</span>\n&#x2502;   &#x251c;&#x2500;&#x2500; pipelines.py    <span class=\"hljs-comment\"># &#x6570;&#x636e;&#x5904;&#x7406;</span>\n&#x2502;   &#x251c;&#x2500;&#x2500; settings.py     <span class=\"hljs-comment\"># &#x5168;&#x5c40;&#x914d;&#x7f6e;</span>\n&#x2502;   &#x2514;&#x2500;&#x2500; spiders\n&#x2502;       &#x251c;&#x2500;&#x2500; baidu.py    <span class=\"hljs-comment\"># &#x722c;&#x866b;&#x6587;&#x4ef6;</span>\n&#x2514;&#x2500;&#x2500; scrapy.cfg          <span class=\"hljs-comment\"># &#x9879;&#x76ee;&#x57fa;&#x672c;&#x914d;&#x7f6e;&#x6587;&#x4ef6;</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"96,107"}}],"payload":{"tag":"h3","lines":"94,95"}},{"content":"&#x5168;&#x5c40;&#x914d;&#x7f6e;&#x6587;&#x4ef6;settings.py","children":[{"content":"<pre data-lines=\"110,126\"><code class=\"language-python\">&#x3010;<span class=\"hljs-number\">1</span>&#x3011;&#x5b9a;&#x4e49;User-Agent\n    USER_AGENT = <span class=\"hljs-string\">&apos;Mozilla/5.0&apos;</span>\n    \n&#x3010;<span class=\"hljs-number\">2</span>&#x3011;&#x662f;&#x5426;&#x9075;&#x5faa;robots&#x534f;&#x8bae;&#xff0c;&#x4e00;&#x822c;&#x8bbe;&#x7f6e;&#x4e3a;<span class=\"hljs-literal\">False</span>\n    ROBOTSTXT_OBEY = <span class=\"hljs-string\">&apos;False&apos;</span>\n    \n&#x3010;<span class=\"hljs-number\">3</span>&#x3011;&#x6700;&#x5927;&#x5e76;&#x53d1;&#x91cf;&#xff0c;&#x9ed8;&#x8ba4;&#x4e3a;<span class=\"hljs-number\">16</span>\n    CONCURRENT_REQUESTS = <span class=\"hljs-number\">32</span>\n    \n&#x3010;<span class=\"hljs-number\">4</span>&#x3011;&#x4e0b;&#x8f7d;&#x5ef6;&#x8fdf;&#x65f6;&#x95f4;\n    DOWNLOAD_DELAY = <span class=\"hljs-number\">1</span>\n    \n&#x3010;<span class=\"hljs-number\">5</span>&#x3011;&#x8bf7;&#x6c42;&#x5934;&#xff0c;&#x6b64;&#x5904;&#x4e5f;&#x53ef;&#x4ee5;&#x6dfb;&#x52a0;User-Agent\n    DEFAULT_REQUEST_HEADERS = {}\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"110,126"}}],"payload":{"tag":"h3","lines":"108,109"}}],"payload":{"tag":"h2","lines":"55,56"}},{"content":"&#x8fd8;&#x8bb0;&#x5f97;&#x767e;&#x5ea6;&#x4e00;&#x4e0b;,&#x4f60;&#x5c31;&#x77e5;&#x9053;&#x5417;","children":[{"content":"&#x6b65;&#x9aa4;&#x8ddf;&#x8e2a;","children":[{"content":"<pre data-lines=\"131,158\"><code class=\"language-python\">&#x3010;<span class=\"hljs-number\">1</span>&#x3011;&#x521b;&#x5efa;&#x9879;&#x76ee; <span class=\"hljs-string\">&apos;Baidu&apos;</span> &#x548c;&#x722c;&#x866b;&#x6587;&#x4ef6; <span class=\"hljs-string\">&apos;baidu&apos;</span>\n    <span class=\"hljs-number\">1.1</span>) scrapy startproject Baidu\n    <span class=\"hljs-number\">1.2</span>) cd Baidu\n    <span class=\"hljs-number\">1.3</span>) scrapy genspider baidu www.baidu.com\n    \n&#x3010;<span class=\"hljs-number\">2</span>&#x3011;&#x6253;&#x5f00;&#x722c;&#x866b;&#x6587;&#x4ef6;: baidu.py\n    <span class=\"hljs-keyword\">import</span> scrapy\n    <span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">BaiduSpider</span>(scarpy.Spider):\n        name = <span class=\"hljs-string\">&apos;baidu&apos;</span>\n        allowed_domains = [<span class=\"hljs-string\">&apos;www.baidu.com&apos;</span>]\n        start_urls = [<span class=\"hljs-string\">&apos;http://www.baidu.com/&apos;</span>]\n        \n        <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">parse</span>(<span class=\"hljs-params\">self,response</span>):\n            r_list = response.xpath(<span class=\"hljs-string\">&apos;/html/head/title/text()&apos;</span>).extract()\n            <span class=\"hljs-built_in\">print</span>(r_list)\n            \n&#x3010;<span class=\"hljs-number\">3</span>&#x3011;&#x5168;&#x5c40;&#x914d;&#x7f6e;&#x6587;&#x4ef6;: settings.py\n    ROBOTSTXT_OBEY = <span class=\"hljs-literal\">False</span>\n    DEFAULT_REQUEST_HEADERS = {<span class=\"hljs-string\">&apos;User-Agent&apos;</span>:<span class=\"hljs-string\">&apos;Mozilla/5.0&apos;</span>}\n    \n&#x3010;<span class=\"hljs-number\">4</span>&#x3011;&#x521b;&#x5efa;&#x6587;&#x4ef6;(&#x548c;&#x9879;&#x76ee;&#x76ee;&#x5f55;&#x540c;&#x8def;&#x5f84;): run.py\n    <span class=\"hljs-keyword\">from</span> scrapy <span class=\"hljs-keyword\">import</span> cmdline\n    cmdline.execute(<span class=\"hljs-string\">&apos;scrapy crawl baidu&apos;</span>.split())\n    \n&#x3010;<span class=\"hljs-number\">5</span>&#x3011;&#x8fd0;&#x884c; run.py &#x542f;&#x52a8;&#x722c;&#x866b;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"131,158"}}],"payload":{"tag":"h3","lines":"129,130"}}],"payload":{"tag":"h2","lines":"127,128"}}],"payload":{"tag":"h1","lines":"0,1"}},{"content":"Day08&#x7b14;&#x8bb0;","children":[{"content":"scrapy&#x6846;&#x67b6;","children":[{"content":"&#x521b;&#x5efa;&#x722c;&#x866b;&#x9879;&#x76ee;&#x6b65;&#x9aa4;","children":[{"content":"<pre data-lines=\"165,182\"><code class=\"language-python\">&#x3010;<span class=\"hljs-number\">1</span>&#x3011;&#x65b0;&#x5efa;&#x9879;&#x76ee;&#x548c;&#x722c;&#x866b;&#x6587;&#x4ef6;\n    scrapy startproject &#x9879;&#x76ee;&#x540d;\n    cd &#x9879;&#x76ee;&#x6587;&#x4ef6;&#x5939;\n    &#x65b0;&#x5efa;&#x722c;&#x866b;&#x6587;&#x4ef6; &#xff1a;scrapy genspider &#x6587;&#x4ef6;&#x540d; &#x57df;&#x540d;\n&#x3010;<span class=\"hljs-number\">2</span>&#x3011;&#x660e;&#x786e;&#x76ee;&#x6807;(items.py)\n&#x3010;<span class=\"hljs-number\">3</span>&#x3011;&#x5199;&#x722c;&#x866b;&#x7a0b;&#x5e8f;(&#x6587;&#x4ef6;&#x540d;.py)\n&#x3010;<span class=\"hljs-number\">4</span>&#x3011;&#x7ba1;&#x9053;&#x6587;&#x4ef6;(pipelines.py)\n&#x3010;<span class=\"hljs-number\">5</span>&#x3011;&#x5168;&#x5c40;&#x914d;&#x7f6e;(settings.py)\n&#x3010;<span class=\"hljs-number\">6</span>&#x3011;&#x8fd0;&#x884c;&#x722c;&#x866b;\n    <span class=\"hljs-number\">8.1</span>) &#x7ec8;&#x7aef;: scrapy crawl &#x722c;&#x866b;&#x540d;\n    <span class=\"hljs-number\">8.2</span>) pycharm&#x8fd0;&#x884c;\n        a&gt; &#x521b;&#x5efa;run.py(&#x548c;scrapy.cfg&#x6587;&#x4ef6;&#x540c;&#x76ee;&#x5f55;)\n\t      <span class=\"hljs-keyword\">from</span> scrapy <span class=\"hljs-keyword\">import</span> cmdline\n\t      cmdline.execute(<span class=\"hljs-string\">&apos;scrapy crawl maoyan&apos;</span>.split())\n        b&gt; &#x76f4;&#x63a5;&#x8fd0;&#x884c; run.py &#x5373;&#x53ef;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"165,182"}}],"payload":{"tag":"h3","lines":"163,164"}}],"payload":{"tag":"h2","lines":"161,162"}},{"content":"&#x74dc;&#x5b50;&#x4e8c;&#x624b;&#x8f66;&#x76f4;&#x5356;&#x7f51; - &#x4e00;&#x7ea7;&#x9875;&#x9762;","children":[{"content":"&#x76ee;&#x6807;","children":[{"content":"<pre data-lines=\"187,198\"><code class=\"language-python\">&#x3010;<span class=\"hljs-number\">1</span>&#x3011;&#x6293;&#x53d6;&#x74dc;&#x5b50;&#x4e8c;&#x624b;&#x8f66;&#x5b98;&#x7f51;&#x4e8c;&#x624b;&#x8f66;&#x6536;&#x636e;&#xff08;&#x6211;&#x8981;&#x4e70;&#x8f66;&#xff09;\n\n&#x3010;<span class=\"hljs-number\">2</span>&#x3011;URL&#x5730;&#x5740;&#xff1a;https://www.guazi.com/langfang/buy/o{}/<span class=\"hljs-comment\">#bread</span>\n    URL&#x89c4;&#x5f8b;: o1  o2  o3  o4  o5  ... ...\n        \n&#x3010;<span class=\"hljs-number\">3</span>&#x3011;&#x6240;&#x6293;&#x6570;&#x636e;\n    <span class=\"hljs-number\">3.1</span>) &#x6c7d;&#x8f66;&#x94fe;&#x63a5;\n    <span class=\"hljs-number\">3.2</span>) &#x6c7d;&#x8f66;&#x540d;&#x79f0;\n    <span class=\"hljs-number\">3.3</span>) &#x6c7d;&#x8f66;&#x4ef7;&#x683c;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"187,198"}}],"payload":{"tag":"h3","lines":"185,186"}},{"content":"&#x5b9e;&#x73b0;&#x6b65;&#x9aa4;","children":[{"content":"&#x6b65;&#x9aa4;1 - &#x521b;&#x5efa;&#x9879;&#x76ee;&#x548c;&#x722c;&#x866b;&#x6587;&#x4ef6;","children":[{"content":"<pre data-lines=\"203,208\"><code class=\"language-python\">scrapy startproject Car\ncd Car\nscrapy genspider car www.guazi.com\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"203,208"}}],"payload":{"tag":"h4","lines":"201,202"}},{"content":"&#x6b65;&#x9aa4;2 - &#x5b9a;&#x4e49;&#x8981;&#x722c;&#x53d6;&#x7684;&#x6570;&#x636e;&#x7ed3;&#x6784;","children":[{"content":"<pre data-lines=\"211,221\"><code class=\"language-python\"><span class=\"hljs-string\">&quot;&quot;&quot;items.py&quot;&quot;&quot;</span>\n<span class=\"hljs-keyword\">import</span> scrapy\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">CarItem</span>(scrapy.Item):\n    <span class=\"hljs-comment\"># &#x94fe;&#x63a5;&#x3001;&#x540d;&#x79f0;&#x3001;&#x4ef7;&#x683c;</span>\n    url = scrapy.Field()\n    name = scrapy.Field()\n    price = scrapy.Field()\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"211,221"}}],"payload":{"tag":"h4","lines":"209,210"}},{"content":"&#x6b65;&#x9aa4;3 - &#x7f16;&#x5199;&#x722c;&#x866b;&#x6587;&#x4ef6;&#xff08;&#x4ee3;&#x7801;&#x5b9e;&#x73b0;1&#xff09;","children":[{"content":"<pre data-lines=\"224,266\"><code class=\"language-python\"><span class=\"hljs-string\">&quot;&quot;&quot;\n&#x6b64;&#x65b9;&#x6cd5;&#x5176;&#x5b9e;&#x8fd8;&#x662f;&#x4e00;&#x9875;&#x4e00;&#x9875;&#x6293;&#x53d6;&#xff0c;&#x6548;&#x7387;&#x5e76;&#x6ca1;&#x6709;&#x63d0;&#x5347;&#xff0c;&#x548c;&#x5355;&#x7ebf;&#x7a0b;&#x4e00;&#x6837;\n\nxpath&#x8868;&#x8fbe;&#x5f0f;&#x5982;&#x4e0b;:\n&#x3010;1&#x3011;&#x57fa;&#x51c6;xpath,&#x5339;&#x914d;&#x6240;&#x6709;&#x6c7d;&#x8f66;&#x8282;&#x70b9;&#x5bf9;&#x8c61;&#x5217;&#x8868;\n    li_list = response.xpath(&apos;//ul[@class=&quot;carlist clearfix js-top&quot;]/li&apos;)\n    \n&#x3010;2&#x3011;&#x904d;&#x5386;&#x540e;&#x6bcf;&#x8f86;&#x8f66;&#x4fe1;&#x606f;&#x7684;xpath&#x8868;&#x8fbe;&#x5f0f;\n    &#x6c7d;&#x8f66;&#x94fe;&#x63a5;: &apos;./a[1]/@href&apos;\n    &#x6c7d;&#x8f66;&#x540d;&#x79f0;: &apos;.//h2[@class=&quot;t&quot;]/text()&apos;\n    &#x6c7d;&#x8f66;&#x4ef7;&#x683c;: &apos;.//div[@class=&quot;t-price&quot;]/p/text()&apos;\n&quot;&quot;&quot;</span>\n<span class=\"hljs-comment\"># -*- coding: utf-8 -*-</span>\n<span class=\"hljs-keyword\">import</span> scrapy\n<span class=\"hljs-keyword\">from</span> ..items <span class=\"hljs-keyword\">import</span> CarItem\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">CarSpider</span>(scrapy.Spider):\n    name = <span class=\"hljs-string\">&apos;car&apos;</span>\n    allowed_domains = [<span class=\"hljs-string\">&apos;www.guazi.com&apos;</span>]\n    i = <span class=\"hljs-number\">1</span>\n    start_urls = [<span class=\"hljs-string\">&apos;https://www.guazi.com/langfang/buy/o1/&apos;</span>]\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">parse</span>(<span class=\"hljs-params\">self, response</span>):\n        <span class=\"hljs-comment\"># 1.&#x57fa;&#x51c6;xpath,&#x5339;&#x914d;&#x6240;&#x6709;&#x6c7d;&#x8f66;&#x8282;&#x70b9;&#x5bf9;&#x8c61;&#x5217;&#x8868;</span>\n        li_list = response.xpath(<span class=\"hljs-string\">&apos;//ul[@class=&quot;carlist clearfix js-top&quot;]/li&apos;</span>)\n        <span class=\"hljs-comment\"># &#x521b;&#x5efa;item&#x5bf9;&#x8c61;,&#x7ed9;items.py&#x4e2d;&#x5b9a;&#x4e49;&#x7684;&#x6570;&#x636e;&#x7ed3;&#x6784;&#x8d4b;&#x503c;</span>\n        item = CarItem()\n        <span class=\"hljs-keyword\">for</span> li <span class=\"hljs-keyword\">in</span> li_list:\n            item[<span class=\"hljs-string\">&apos;url&apos;</span>] = <span class=\"hljs-string\">&apos;https://www.guazi.com/&apos;</span> + li.xpath(<span class=\"hljs-string\">&apos;./a[1]/@href&apos;</span>).get()\n            item[<span class=\"hljs-string\">&apos;name&apos;</span>] = li.xpath(<span class=\"hljs-string\">&apos;.//h2[@class=&quot;t&quot;]/text()&apos;</span>).get()\n            item[<span class=\"hljs-string\">&apos;price&apos;</span>] = li.xpath(<span class=\"hljs-string\">&apos;.//div[@class=&quot;t-price&quot;]/p/text()&apos;</span>).get()\n\n            <span class=\"hljs-keyword\">yield</span> item\n\n        <span class=\"hljs-comment\"># &#x751f;&#x6210;&#x4e0b;&#x4e00;&#x9875;&#x7684;&#x94fe;&#x63a5;,&#x7ee7;&#x7eed;&#x4ea4;&#x7ed9;&#x8c03;&#x5ea6;&#x5668;&#x5165;&#x961f;&#x5217;</span>\n        <span class=\"hljs-keyword\">if</span> <span class=\"hljs-variable language_\">self</span>.i &lt; <span class=\"hljs-number\">5</span>:\n            <span class=\"hljs-variable language_\">self</span>.i += <span class=\"hljs-number\">1</span>\n            url = <span class=\"hljs-string\">&apos;https://www.guazi.com/langfang/buy/o{}/&apos;</span>.<span class=\"hljs-built_in\">format</span>(<span class=\"hljs-variable language_\">self</span>.i)\n            <span class=\"hljs-comment\"># scrapy.Request()&#x662f;&#x5c06;&#x8bf7;&#x6c42;&#x4ea4;&#x7ed9;&#x8c03;&#x5ea6;&#x5668;&#x5165;&#x961f;&#x5217;&#x7684;&#x65b9;&#x6cd5;</span>\n            <span class=\"hljs-keyword\">yield</span> scrapy.Request(url=url,callback=<span class=\"hljs-variable language_\">self</span>.parse)\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"224,266"}}],"payload":{"tag":"h4","lines":"222,223"}},{"content":"&#x6b65;&#x9aa4;3 - &#x7f16;&#x5199;&#x722c;&#x866b;&#x6587;&#x4ef6;&#xff08;&#x4ee3;&#x7801;&#x5b9e;&#x73b0;2&#xff09;","children":[{"content":"<pre data-lines=\"269,300\"><code class=\"language-python\"><span class=\"hljs-string\">&quot;&quot;&quot;\n&#x91cd;&#x5199;start_requests()&#x65b9;&#x6cd5;&#xff0c;&#x6548;&#x7387;&#x6781;&#x9ad8;\n&quot;&quot;&quot;</span>\n<span class=\"hljs-comment\"># -*- coding: utf-8 -*-</span>\n<span class=\"hljs-keyword\">import</span> scrapy\n<span class=\"hljs-keyword\">from</span> ..items <span class=\"hljs-keyword\">import</span> CarItem\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">CarSpider</span>(scrapy.Spider):\n    name = <span class=\"hljs-string\">&apos;car2&apos;</span>\n    allowed_domains = [<span class=\"hljs-string\">&apos;www.guazi.com&apos;</span>]\n    <span class=\"hljs-comment\"># 1&#x3001;&#x53bb;&#x6389; start_urls</span>\n    <span class=\"hljs-comment\"># 2&#x3001;&#x91cd;&#x5199;start_requests()&#x65b9;&#x6cd5;</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">start_requests</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x751f;&#x6210;&#x6240;&#x6709;&#x5f85;&#x722c;&#x53d6;&#x7684;URL&#x5730;&#x5740;,&#x7edf;&#x4e00;&#x4ea4;&#x7ed9;&#x8c03;&#x5ea6;&#x5668;&#x5165;&#x961f;&#x5217;&quot;&quot;&quot;</span>\n        <span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(<span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">5</span>):\n            url = <span class=\"hljs-string\">&apos;https://www.guazi.com/langfang/buy/o{}/&apos;</span>.<span class=\"hljs-built_in\">format</span>(i)\n            <span class=\"hljs-keyword\">yield</span> scrapy.Request(url=url,callback=<span class=\"hljs-variable language_\">self</span>.parse)\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">parse</span>(<span class=\"hljs-params\">self, response</span>):\n        <span class=\"hljs-comment\"># 1.&#x57fa;&#x51c6;xpath,&#x5339;&#x914d;&#x6240;&#x6709;&#x6c7d;&#x8f66;&#x8282;&#x70b9;&#x5bf9;&#x8c61;&#x5217;&#x8868;</span>\n        li_list = response.xpath(<span class=\"hljs-string\">&apos;//ul[@class=&quot;carlist clearfix js-top&quot;]/li&apos;</span>)\n        <span class=\"hljs-comment\"># &#x521b;&#x5efa;item&#x5bf9;&#x8c61;,&#x7ed9;items.py&#x4e2d;&#x5b9a;&#x4e49;&#x7684;&#x6570;&#x636e;&#x7ed3;&#x6784;&#x8d4b;&#x503c;</span>\n        item = CarItem()\n        <span class=\"hljs-keyword\">for</span> li <span class=\"hljs-keyword\">in</span> li_list:\n            item[<span class=\"hljs-string\">&apos;url&apos;</span>] = <span class=\"hljs-string\">&apos;https://www.guazi.com/&apos;</span> + li.xpath(<span class=\"hljs-string\">&apos;./a[1]/@href&apos;</span>).get()\n            item[<span class=\"hljs-string\">&apos;name&apos;</span>] = li.xpath(<span class=\"hljs-string\">&apos;.//h2[@class=&quot;t&quot;]/text()&apos;</span>).get()\n            item[<span class=\"hljs-string\">&apos;price&apos;</span>] = li.xpath(<span class=\"hljs-string\">&apos;.//div[@class=&quot;t-price&quot;]/p/text()&apos;</span>).get()\n\n            <span class=\"hljs-keyword\">yield</span> item\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"269,300"}}],"payload":{"tag":"h4","lines":"267,268"}},{"content":"&#x6b65;&#x9aa4;4 - &#x7ba1;&#x9053;&#x6587;&#x4ef6;&#x5904;&#x7406;&#x6570;&#x636e;","children":[{"content":"<pre data-lines=\"303,365\"><code class=\"language-python\"><span class=\"hljs-string\">&quot;&quot;&quot;\npipelines.py&#x5904;&#x7406;&#x6570;&#x636e;\n1&#x3001;mysql&#x6570;&#x636e;&#x5e93;&#x5efa;&#x5e93;&#x5efa;&#x8868;\ncreate database guazidb charset utf8;\nuse guazidb;\ncreate table guazitab(\nname varchar(200),\nprice varchar(100),\nurl varchar(500)\n)charset=utf8;\n&quot;&quot;&quot;</span>\n<span class=\"hljs-comment\"># -*- coding: utf-8 -*-</span>\n\n<span class=\"hljs-comment\"># &#x7ba1;&#x9053;1 - &#x4ece;&#x7ec8;&#x7aef;&#x6253;&#x5370;&#x8f93;&#x51fa;</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">CarPipeline</span>(<span class=\"hljs-title class_ inherited__\">object</span>):\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_item</span>(<span class=\"hljs-params\">self, item, spider</span>):\n        <span class=\"hljs-built_in\">print</span>(item[<span class=\"hljs-string\">&apos;name&apos;</span>],item[<span class=\"hljs-string\">&apos;price&apos;</span>],item[<span class=\"hljs-string\">&apos;url&apos;</span>])\n        <span class=\"hljs-keyword\">return</span> item\n\n<span class=\"hljs-comment\"># &#x7ba1;&#x9053;2 - &#x5b58;&#x5165;MySQL&#x6570;&#x636e;&#x5e93;&#x7ba1;&#x9053;</span>\n<span class=\"hljs-keyword\">import</span> pymysql\n<span class=\"hljs-keyword\">from</span> .settings <span class=\"hljs-keyword\">import</span> *\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">CarMysqlPipeline</span>(<span class=\"hljs-title class_ inherited__\">object</span>):\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">open_spider</span>(<span class=\"hljs-params\">self,spider</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x722c;&#x866b;&#x9879;&#x76ee;&#x542f;&#x52a8;&#x65f6;&#x53ea;&#x6267;&#x884c;1&#x6b21;,&#x4e00;&#x822c;&#x7528;&#x4e8e;&#x6570;&#x636e;&#x5e93;&#x8fde;&#x63a5;&quot;&quot;&quot;</span>\n        <span class=\"hljs-variable language_\">self</span>.db = pymysql.connect(MYSQL_HOST,MYSQL_USER,MYSQL_PWD,MYSQL_DB,charset=CHARSET)\n        <span class=\"hljs-variable language_\">self</span>.cursor = <span class=\"hljs-variable language_\">self</span>.db.cursor()\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_item</span>(<span class=\"hljs-params\">self,item,spider</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x5904;&#x7406;&#x4ece;&#x722c;&#x866b;&#x6587;&#x4ef6;&#x4f20;&#x8fc7;&#x6765;&#x7684;item&#x6570;&#x636e;&quot;&quot;&quot;</span>\n        ins = <span class=\"hljs-string\">&apos;insert into guazitab values(%s,%s,%s)&apos;</span>\n        car_li = [item[<span class=\"hljs-string\">&apos;name&apos;</span>],item[<span class=\"hljs-string\">&apos;price&apos;</span>],item[<span class=\"hljs-string\">&apos;url&apos;</span>]]\n        <span class=\"hljs-variable language_\">self</span>.cursor.execute(ins,car_li)\n        <span class=\"hljs-variable language_\">self</span>.db.commit()\n\n        <span class=\"hljs-keyword\">return</span> item\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">close_spider</span>(<span class=\"hljs-params\">self,spider</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x722c;&#x866b;&#x7a0b;&#x5e8f;&#x7ed3;&#x675f;&#x65f6;&#x53ea;&#x6267;&#x884c;1&#x6b21;,&#x4e00;&#x822c;&#x7528;&#x4e8e;&#x6570;&#x636e;&#x5e93;&#x65ad;&#x5f00;&quot;&quot;&quot;</span>\n        <span class=\"hljs-variable language_\">self</span>.cursor.close()\n        <span class=\"hljs-variable language_\">self</span>.db.close()\n\n\n<span class=\"hljs-comment\"># &#x7ba1;&#x9053;3 - &#x5b58;&#x5165;MongoDB&#x7ba1;&#x9053;</span>\n<span class=\"hljs-keyword\">import</span> pymongo\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">CarMongoPipeline</span>(<span class=\"hljs-title class_ inherited__\">object</span>):\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">open_spider</span>(<span class=\"hljs-params\">self,spider</span>):\n        <span class=\"hljs-variable language_\">self</span>.conn = pymongo.MongoClient(MONGO_HOST,MONGO_PORT)\n        <span class=\"hljs-variable language_\">self</span>.db = <span class=\"hljs-variable language_\">self</span>.conn[MONGO_DB]\n        <span class=\"hljs-variable language_\">self</span>.myset = <span class=\"hljs-variable language_\">self</span>.db[MONGO_SET]\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_item</span>(<span class=\"hljs-params\">self,item,spider</span>):\n        car_dict = {\n            <span class=\"hljs-string\">&apos;name&apos;</span> : item[<span class=\"hljs-string\">&apos;name&apos;</span>],\n            <span class=\"hljs-string\">&apos;price&apos;</span>: item[<span class=\"hljs-string\">&apos;price&apos;</span>],\n            <span class=\"hljs-string\">&apos;url&apos;</span>  : item[<span class=\"hljs-string\">&apos;url&apos;</span>]\n        }\n        <span class=\"hljs-variable language_\">self</span>.myset.insert_one(car_dict)\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"303,365"}}],"payload":{"tag":"h4","lines":"301,302"}},{"content":"&#x6b65;&#x9aa4;5 - &#x5168;&#x5c40;&#x914d;&#x7f6e;&#x6587;&#x4ef6;&#xff08;settings.py&#xff09;","children":[{"content":"<pre data-lines=\"368,396\"><code class=\"language-python\">&#x3010;<span class=\"hljs-number\">1</span>&#x3011;ROBOTSTXT_OBEY = <span class=\"hljs-literal\">False</span>\n&#x3010;<span class=\"hljs-number\">2</span>&#x3011;DOWNLOAD_DELAY = <span class=\"hljs-number\">2</span>\n&#x3010;<span class=\"hljs-number\">3</span>&#x3011;COOKIES_ENABLED = <span class=\"hljs-literal\">False</span>\n&#x3010;<span class=\"hljs-number\">4</span>&#x3011;DEFAULT_REQUEST_HEADERS = {\n    <span class=\"hljs-string\">&quot;Cookie&quot;</span>: <span class=\"hljs-string\">&quot;&#x6b64;&#x5904;&#x586b;&#x5199;&#x6293;&#x5305;&#x6293;&#x53d6;&#x5230;&#x7684;Cookie&quot;</span>,\n    <span class=\"hljs-string\">&quot;User-Agent&quot;</span>: <span class=\"hljs-string\">&quot;&#x6b64;&#x5904;&#x586b;&#x5199;&#x81ea;&#x5df1;&#x7684;User-Agent&quot;</span>,\n  }\n\n&#x3010;<span class=\"hljs-number\">5</span>&#x3011;ITEM_PIPELINES = {\n     <span class=\"hljs-string\">&apos;Car.pipelines.CarPipeline&apos;</span>: <span class=\"hljs-number\">300</span>,\n     <span class=\"hljs-comment\">#&apos;Car.pipelines.CarMysqlPipeline&apos;: 400,</span>\n     <span class=\"hljs-comment\">#&apos;Car.pipelines.CarMongoPipeline&apos;: 500,</span>\n  }\n\n&#x3010;<span class=\"hljs-number\">6</span>&#x3011;&#x5b9a;&#x4e49;MySQL&#x76f8;&#x5173;&#x53d8;&#x91cf;\nMYSQL_HOST = <span class=\"hljs-string\">&apos;localhost&apos;</span>\nMYSQL_USER = <span class=\"hljs-string\">&apos;root&apos;</span>\nMYSQL_PWD = <span class=\"hljs-string\">&apos;123456&apos;</span>\nMYSQL_DB = <span class=\"hljs-string\">&apos;guazidb&apos;</span>\nCHARSET = <span class=\"hljs-string\">&apos;utf8&apos;</span>\n\n&#x3010;<span class=\"hljs-number\">7</span>&#x3011;&#x5b9a;&#x4e49;MongoDB&#x76f8;&#x5173;&#x53d8;&#x91cf;\nMONGO_HOST = <span class=\"hljs-string\">&apos;localhost&apos;</span>\nMONGO_PORT = <span class=\"hljs-number\">27017</span>\nMONGO_DB = <span class=\"hljs-string\">&apos;guazidb&apos;</span>\nMONGO_SET = <span class=\"hljs-string\">&apos;guaziset&apos;</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"368,396"}}],"payload":{"tag":"h4","lines":"366,367"}},{"content":"&#x6b65;&#x9aa4;6 - &#x8fd0;&#x884c;&#x722c;&#x866b;&#xff08;run.py&#xff09;","children":[{"content":"<pre data-lines=\"399,404\"><code class=\"language-python\"><span class=\"hljs-string\">&quot;&quot;&quot;run.py&quot;&quot;&quot;</span>\n<span class=\"hljs-keyword\">from</span> scrapy <span class=\"hljs-keyword\">import</span> cmdline\ncmdline.execute(<span class=\"hljs-string\">&apos;scrapy crawl maoyan&apos;</span>.split())\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"399,404"}}],"payload":{"tag":"h4","lines":"397,398"}}],"payload":{"tag":"h3","lines":"199,200"}}],"payload":{"tag":"h2","lines":"183,184"}},{"content":"&#x6570;&#x636e;&#x6301;&#x4e45;&#x5316;(MySQL)","children":[{"content":"&#x5b9e;&#x73b0;&#x6b65;&#x9aa4;","children":[{"content":"<pre data-lines=\"409,428\"><code class=\"language-python\">&#x3010;<span class=\"hljs-number\">1</span>&#x3011;&#x5728;setting.py&#x4e2d;&#x5b9a;&#x4e49;&#x76f8;&#x5173;&#x53d8;&#x91cf;\n\n&#x3010;<span class=\"hljs-number\">2</span>&#x3011;pipelines.py&#x4e2d;&#x5bfc;&#x5165;settings&#x6a21;&#x5757;\n\t<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">open_spider</span>(<span class=\"hljs-params\">self,spider</span>):\n\t\t<span class=\"hljs-string\">&quot;&quot;&quot;&#x722c;&#x866b;&#x5f00;&#x59cb;&#x6267;&#x884c;1&#x6b21;,&#x7528;&#x4e8e;&#x6570;&#x636e;&#x5e93;&#x8fde;&#x63a5;&quot;&quot;&quot;</span>\n        \n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_item</span>(<span class=\"hljs-params\">self,item,spider</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x5177;&#x4f53;&#x5904;&#x7406;&#x6570;&#x636e;&quot;&quot;&quot;</span>\n        <span class=\"hljs-keyword\">return</span> item\n    \n\t<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">close_spider</span>(<span class=\"hljs-params\">self,spider</span>):\n\t\t<span class=\"hljs-string\">&quot;&quot;&quot;&#x722c;&#x866b;&#x7ed3;&#x675f;&#x65f6;&#x6267;&#x884c;1&#x6b21;,&#x7528;&#x4e8e;&#x65ad;&#x5f00;&#x6570;&#x636e;&#x5e93;&#x8fde;&#x63a5;&quot;&quot;&quot;</span>\n       \n&#x3010;<span class=\"hljs-number\">3</span>&#x3011;settings.py&#x4e2d;&#x6dfb;&#x52a0;&#x6b64;&#x7ba1;&#x9053;\n\tITEM_PIPELINES = {<span class=\"hljs-string\">&apos;&apos;</span>:<span class=\"hljs-number\">200</span>}\n\n&#x3010;&#x6ce8;&#x610f;&#x3011; &#xff1a;process_item() &#x51fd;&#x6570;&#x4e2d;&#x4e00;&#x5b9a;&#x8981; <span class=\"hljs-keyword\">return</span> item ,&#x5f53;&#x524d;&#x7ba1;&#x9053;&#x7684;process_item()&#x7684;&#x8fd4;&#x56de;&#x503c;&#x4f1a;&#x4f5c;&#x4e3a;&#x4e0b;&#x4e00;&#x4e2a;&#x7ba1;&#x9053; process_item()&#x7684;&#x53c2;&#x6570;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"409,428"}}],"payload":{"tag":"h3","lines":"407,408"}}],"payload":{"tag":"h2","lines":"405,406"}},{"content":"&#x77e5;&#x8bc6;&#x70b9;&#x6c47;&#x603b;","children":[{"content":"&#x8282;&#x70b9;&#x5bf9;&#x8c61;.xpath(&apos;&apos;)","children":[{"content":"<pre data-lines=\"433,442\"><code class=\"language-python\">&#x3010;<span class=\"hljs-number\">1</span>&#x3011;&#x5217;&#x8868;,&#x5143;&#x7d20;&#x4e3a;&#x9009;&#x62e9;&#x5668; \n    [\n        &lt;selector xpath=<span class=\"hljs-string\">&apos;xxx&apos;</span> data=<span class=\"hljs-string\">&apos;A&apos;</span>&gt;,\n        &lt;selector xpath=<span class=\"hljs-string\">&apos;xxx&apos;</span> data=<span class=\"hljs-string\">&apos;B&apos;</span>&gt;\n    ]\n&#x3010;<span class=\"hljs-number\">2</span>&#x3011;&#x5217;&#x8868;.extract() &#xff1a;&#x5e8f;&#x5217;&#x5316;&#x5217;&#x8868;&#x4e2d;&#x6240;&#x6709;&#x9009;&#x62e9;&#x5668;&#x4e3a;Unicode&#x5b57;&#x7b26;&#x4e32; [<span class=\"hljs-string\">&apos;A&apos;</span>,<span class=\"hljs-string\">&apos;B&apos;</span>]\n&#x3010;<span class=\"hljs-number\">3</span>&#x3011;&#x5217;&#x8868;.extract_first() &#x6216;&#x8005; get() :&#x83b7;&#x53d6;&#x5217;&#x8868;&#x4e2d;&#x7b2c;<span class=\"hljs-number\">1</span>&#x4e2a;&#x5e8f;&#x5217;&#x5316;&#x7684;&#x5143;&#x7d20;(&#x5b57;&#x7b26;&#x4e32;) <span class=\"hljs-string\">&apos;A&apos;</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"433,442"}}],"payload":{"tag":"h3","lines":"431,432"}},{"content":"&#x65e5;&#x5fd7;&#x53d8;&#x91cf;&#x53ca;&#x65e5;&#x5fd7;&#x7ea7;&#x522b;(settings.py)","children":[{"content":"<pre data-lines=\"445,458\"><code class=\"language-python\"><span class=\"hljs-comment\"># &#x65e5;&#x5fd7;&#x76f8;&#x5173;&#x53d8;&#x91cf; - settings.py</span>\nLOG_LEVEL = <span class=\"hljs-string\">&apos;&apos;</span>\nLOG_FILE = <span class=\"hljs-string\">&apos;&#x6587;&#x4ef6;&#x540d;.log&apos;</span>\n\n<span class=\"hljs-comment\"># &#x65e5;&#x5fd7;&#x7ea7;&#x522b;</span>\n<span class=\"hljs-number\">5</span> CRITICAL &#xff1a;&#x4e25;&#x91cd;&#x9519;&#x8bef;\n<span class=\"hljs-number\">4</span> ERROR    &#xff1a;&#x666e;&#x901a;&#x9519;&#x8bef;\n<span class=\"hljs-number\">3</span> WARNING  &#xff1a;&#x8b66;&#x544a;\n<span class=\"hljs-number\">2</span> INFO     &#xff1a;&#x4e00;&#x822c;&#x4fe1;&#x606f;\n<span class=\"hljs-number\">1</span> DEBUG    &#xff1a;&#x8c03;&#x8bd5;&#x4fe1;&#x606f;\n<span class=\"hljs-comment\"># &#x6ce8;&#x610f;: &#x53ea;&#x663e;&#x793a;&#x5f53;&#x524d;&#x7ea7;&#x522b;&#x7684;&#x65e5;&#x5fd7;&#x548c;&#x6bd4;&#x5f53;&#x524d;&#x7ea7;&#x522b;&#x65e5;&#x5fd7;&#x66f4;&#x4e25;&#x91cd;&#x7684;</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"445,458"}}],"payload":{"tag":"h3","lines":"443,444"}},{"content":"&#x7ba1;&#x9053;&#x6587;&#x4ef6;&#x4f7f;&#x7528;","children":[{"content":"<pre data-lines=\"461,471\"><code class=\"language-python\">&#x3010;<span class=\"hljs-number\">1</span>&#x3011;&#x5728;&#x722c;&#x866b;&#x6587;&#x4ef6;&#x4e2d;&#x4e3a;items.py&#x4e2d;&#x7c7b;&#x505a;&#x5b9e;&#x4f8b;&#x5316;&#xff0c;&#x7528;&#x722c;&#x4e0b;&#x6765;&#x7684;&#x6570;&#x636e;&#x7ed9;&#x5bf9;&#x8c61;&#x8d4b;&#x503c;\n\t<span class=\"hljs-keyword\">from</span> ..items <span class=\"hljs-keyword\">import</span> CarItem\n\titem = CarItem()\n    \n&#x3010;<span class=\"hljs-number\">2</span>&#x3011;&#x7ba1;&#x9053;&#x6587;&#x4ef6;&#xff08;pipelines.py&#xff09;\n\n&#x3010;<span class=\"hljs-number\">3</span>&#x3011;&#x5f00;&#x542f;&#x7ba1;&#x9053;&#xff08;settings.py&#xff09;\n\tITEM_PIPELINES = { <span class=\"hljs-string\">&apos;&#x9879;&#x76ee;&#x76ee;&#x5f55;&#x540d;.pipelines.&#x7c7b;&#x540d;&apos;</span>:&#x4f18;&#x5148;&#x7ea7; }\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"461,471"}}],"payload":{"tag":"h3","lines":"459,460"}}],"payload":{"tag":"h2","lines":"429,430"}},{"content":"&#x4fdd;&#x5b58;&#x4e3a;csv&#x3001;json&#x6587;&#x4ef6;","children":[{"content":"&#x547d;&#x4ee4;&#x683c;&#x5f0f;","children":[{"content":"<pre data-lines=\"476,487\"><code class=\"language-python\"><span class=\"hljs-string\">&quot;&quot;&quot;run.py&quot;&quot;&quot;</span>\n&#x3010;<span class=\"hljs-number\">1</span>&#x3011;&#x5b58;&#x5165;csv&#x6587;&#x4ef6;\n    scrapy crawl car -o car.csv\n \n&#x3010;<span class=\"hljs-number\">2</span>&#x3011;&#x5b58;&#x5165;json&#x6587;&#x4ef6;\n    scrapy crawl car -o car.json\n\n&#x3010;<span class=\"hljs-number\">3</span>&#x3011;&#x6ce8;&#x610f;: settings.py&#x4e2d;&#x8bbe;&#x7f6e;&#x5bfc;&#x51fa;&#x7f16;&#x7801; - &#x4e3b;&#x8981;&#x9488;&#x5bf9;json&#x6587;&#x4ef6;\n    FEED_EXPORT_ENCODING = <span class=\"hljs-string\">&apos;utf-8&apos;</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"476,487"}}],"payload":{"tag":"h3","lines":"474,475"}},{"content":"&#x8bfe;&#x5802;&#x7ec3;&#x4e60;","children":[{"content":"<pre data-lines=\"490,504\"><code class=\"language-python\">&#x3010;&#x719f;&#x6089;&#x6574;&#x4e2a;&#x6d41;&#x7a0b;&#x3011; : &#x5c06;&#x732b;&#x773c;&#x7535;&#x5f71;&#x6848;&#x4f8b;&#x6570;&#x636e;&#x6293;&#x53d6;&#xff0c;&#x5b58;&#x5165;MySQL&#x6570;&#x636e;&#x5e93;\n    \n    \n    <span class=\"hljs-string\">&quot;&quot;&quot;\n    1&#x3001;&#x4e00;&#x5b9a;&#x8981;&#x81ea;&#x5df1;&#x52a8;&#x624b;&#x4ece;&#x5934;&#x5230;&#x5c3e;&#x5199;&#x4e00;&#x904d;,&#x51fa;&#x9519;&#x4e86;&#x53ef;&#x4ee5;&#x8c03;,&#x5148;&#x4e0d;&#x53c2;&#x8003;&#x6211;&#x7684;&#x4ee3;&#x7801;\n    2&#x3001;&#x6d41;&#x7a0b;&#x53ef;&#x4ee5;&#x53c2;&#x8003;:\n       &#x3010;2.1&#x3011;items.py\n       &#x3010;2.2&#x3011;maoyan.py\n       &#x3010;2.3&#x3011;pipelines.py\n       &#x3010;2.4&#x3011;settings.py\n       &#x3010;2.5&#x3011;run.py\n    &quot;&quot;&quot;</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"490,504"}}],"payload":{"tag":"h3","lines":"488,489"}}],"payload":{"tag":"h2","lines":"472,473"}},{"content":"&#x74dc;&#x5b50;&#x4e8c;&#x624b;&#x8f66;&#x76f4;&#x5356;&#x7f51; - &#x4e8c;&#x7ea7;&#x9875;&#x9762;","children":[{"content":"&#x76ee;&#x6807;&#x8bf4;&#x660e;","children":[{"content":"<pre data-lines=\"509,521\"><code class=\"language-python\">&#x3010;<span class=\"hljs-number\">1</span>&#x3011;&#x5728;&#x6293;&#x53d6;&#x4e00;&#x7ea7;&#x9875;&#x9762;&#x7684;&#x4ee3;&#x7801;&#x57fa;&#x7840;&#x4e0a;&#x5347;&#x7ea7;\n&#x3010;<span class=\"hljs-number\">2</span>&#x3011;&#x4e00;&#x7ea7;&#x9875;&#x9762;&#x6240;&#x6293;&#x53d6;&#x6570;&#x636e;&#xff08;&#x548c;&#x4e4b;&#x524d;&#x4e00;&#x6837;&#xff09;:\n    <span class=\"hljs-number\">2.1</span>) &#x6c7d;&#x8f66;&#x94fe;&#x63a5;\n    <span class=\"hljs-number\">2.2</span>) &#x6c7d;&#x8f66;&#x540d;&#x79f0;\n    <span class=\"hljs-number\">2.3</span>) &#x6c7d;&#x8f66;&#x4ef7;&#x683c;\n&#x3010;<span class=\"hljs-number\">3</span>&#x3011;&#x4e8c;&#x7ea7;&#x9875;&#x9762;&#x6240;&#x6293;&#x53d6;&#x6570;&#x636e;\n    <span class=\"hljs-number\">3.1</span>) &#x4e0a;&#x724c;&#x65f6;&#x95f4;: //ul[@<span class=\"hljs-keyword\">class</span>=<span class=\"hljs-string\">&quot;assort clearfix&quot;</span>]/li[<span class=\"hljs-number\">1</span>]/span/text()\n    <span class=\"hljs-number\">3.2</span>) &#x884c;&#x9a76;&#x91cc;&#x7a0b;: //ul[@<span class=\"hljs-keyword\">class</span>=<span class=\"hljs-string\">&quot;assort clearfix&quot;</span>]/li[<span class=\"hljs-number\">2</span>]/span/text()\n    <span class=\"hljs-number\">3.3</span>) &#x6392;&#x91cf;:    //ul[@<span class=\"hljs-keyword\">class</span>=<span class=\"hljs-string\">&quot;assort clearfix&quot;</span>]/li[<span class=\"hljs-number\">3</span>]/span/text()\n    <span class=\"hljs-number\">3.4</span>) &#x53d8;&#x901f;&#x7bb1;:  //ul[@<span class=\"hljs-keyword\">class</span>=<span class=\"hljs-string\">&quot;assort clearfix&quot;</span>]/li[<span class=\"hljs-number\">4</span>]/span/text()\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"509,521"}}],"payload":{"tag":"h3","lines":"507,508"}},{"content":"&#x5728;&#x539f;&#x6709;&#x9879;&#x76ee;&#x57fa;&#x7840;&#x4e0a;&#x5b9e;&#x73b0;","children":[{"content":"&#x6b65;&#x9aa4;1 - items.py","children":[{"content":"<pre data-lines=\"526,543\"><code class=\"language-python\"><span class=\"hljs-comment\"># &#x6dfb;&#x52a0;&#x4e8c;&#x7ea7;&#x9875;&#x9762;&#x6240;&#x9700;&#x6293;&#x53d6;&#x7684;&#x6570;&#x636e;&#x7ed3;&#x6784;</span>\n\n<span class=\"hljs-keyword\">import</span> scrapy\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">GuaziItem</span>(scrapy.Item):\n    <span class=\"hljs-comment\"># define the fields for your item here like:</span>\n    <span class=\"hljs-comment\"># &#x4e00;&#x7ea7;&#x9875;&#x9762;: &#x94fe;&#x63a5;&#x3001;&#x540d;&#x79f0;&#x3001;&#x4ef7;&#x683c;</span>\n    url = scrapy.Field()\n    name = scrapy.Field()\n    price = scrapy.Field()\n    <span class=\"hljs-comment\"># &#x4e8c;&#x7ea7;&#x9875;&#x9762;: &#x65f6;&#x95f4;&#x3001;&#x91cc;&#x7a0b;&#x3001;&#x6392;&#x91cf;&#x3001;&#x53d8;&#x901f;&#x7bb1;</span>\n    time = scrapy.Field()\n    km = scrapy.Field()\n    disp = scrapy.Field()\n    trans = scrapy.Field()\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"526,543"}}],"payload":{"tag":"h4","lines":"524,525"}},{"content":"&#x6b65;&#x9aa4;2 - guazi2.py","children":[{"content":"<pre data-lines=\"546,591\"><code class=\"language-python\"><span class=\"hljs-comment\"># -*- coding: utf-8 -*-</span>\n<span class=\"hljs-keyword\">import</span> scrapy\n<span class=\"hljs-keyword\">from</span> ..items <span class=\"hljs-keyword\">import</span> GuaziItem\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">GuaziSpider</span>(scrapy.Spider):\n    <span class=\"hljs-comment\"># &#x722c;&#x866b;&#x540d;</span>\n    name = <span class=\"hljs-string\">&apos;guazi2&apos;</span>\n    <span class=\"hljs-comment\"># &#x5141;&#x8bb8;&#x722c;&#x53d6;&#x7684;&#x57df;&#x540d;</span>\n    allowed_domains = [<span class=\"hljs-string\">&apos;www.guazi.com&apos;</span>]\n    <span class=\"hljs-comment\"># 1&#x3001;&#x53bb;&#x6389;start_urls&#x53d8;&#x91cf;</span>\n    <span class=\"hljs-comment\"># 2&#x3001;&#x91cd;&#x5199; start_requests() &#x65b9;&#x6cd5;</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">start_requests</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x751f;&#x6210;&#x6240;&#x6709;&#x8981;&#x6293;&#x53d6;&#x7684;URL&#x5730;&#x5740;,&#x4e00;&#x6b21;&#x6027;&#x4ea4;&#x7ed9;&#x8c03;&#x5ea6;&#x5668;&#x5165;&#x961f;&#x5217;&quot;&quot;&quot;</span>\n        <span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(<span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">6</span>):\n            url = <span class=\"hljs-string\">&apos;https://www.guazi.com/langfang/buy/o{}/#bread&apos;</span>.<span class=\"hljs-built_in\">format</span>(i)\n            <span class=\"hljs-comment\"># scrapy.Request(): &#x628a;&#x8bf7;&#x6c42;&#x4ea4;&#x7ed9;&#x8c03;&#x5ea6;&#x5668;&#x5165;&#x961f;&#x5217;</span>\n            <span class=\"hljs-keyword\">yield</span> scrapy.Request(url=url,callback=<span class=\"hljs-variable language_\">self</span>.parse)\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">parse</span>(<span class=\"hljs-params\">self, response</span>):\n        <span class=\"hljs-comment\"># &#x57fa;&#x51c6;xpath: &#x5339;&#x914d;&#x6240;&#x6709;&#x6c7d;&#x8f66;&#x7684;&#x8282;&#x70b9;&#x5bf9;&#x8c61;&#x5217;&#x8868;</span>\n        li_list = response.xpath(<span class=\"hljs-string\">&apos;//ul[@class=&quot;carlist clearfix js-top&quot;]/li&apos;</span>)\n        <span class=\"hljs-comment\"># &#x5b58;&#x653e;&#x6240;&#x6709;&#x6c7d;&#x8f66;&#x8be6;&#x60c5;&#x9875;&#x7684;Request&#x5bf9;&#x8c61;</span>\n        <span class=\"hljs-keyword\">for</span> li <span class=\"hljs-keyword\">in</span> li_list:\n            <span class=\"hljs-comment\"># &#x6bcf;&#x8f86;&#x6c7d;&#x8f66;&#x7684;&#x8bf7;&#x6c42;&#x5bf9;&#x8c61;</span>\n            item = GuaziItem()\n            item[<span class=\"hljs-string\">&apos;url&apos;</span>] = <span class=\"hljs-string\">&apos;https://www.guazi.com&apos;</span> + li.xpath(<span class=\"hljs-string\">&apos;./a[1]/@href&apos;</span>).extract()[<span class=\"hljs-number\">0</span>]\n            item[<span class=\"hljs-string\">&apos;name&apos;</span>] = li.xpath(<span class=\"hljs-string\">&apos;.//h2[@class=&quot;t&quot;]/text()&apos;</span>).extract()[<span class=\"hljs-number\">0</span>]\n            item[<span class=\"hljs-string\">&apos;price&apos;</span>] = li.xpath(<span class=\"hljs-string\">&apos;.//div[@class=&quot;t-price&quot;]/p/text()&apos;</span>).extract()[<span class=\"hljs-number\">0</span>]\n\n            <span class=\"hljs-comment\"># Request()&#x4e2d;meta&#x53c2;&#x6570;: &#x5728;&#x4e0d;&#x540c;&#x89e3;&#x6790;&#x51fd;&#x6570;&#x4e4b;&#x95f4;&#x4f20;&#x9012;&#x6570;&#x636e;,item&#x6570;&#x636e;&#x4f1a;&#x968f;&#x7740;response&#x4e00;&#x8d77;&#x8fd4;&#x56de;</span>\n            <span class=\"hljs-keyword\">yield</span> scrapy.Request(url=item[<span class=\"hljs-string\">&apos;url&apos;</span>],meta={<span class=\"hljs-string\">&apos;meta_1&apos;</span>:item},callback=<span class=\"hljs-variable language_\">self</span>.detail_parse)\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">detail_parse</span>(<span class=\"hljs-params\">self,response</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x6c7d;&#x8f66;&#x8be6;&#x60c5;&#x9875;&#x7684;&#x89e3;&#x6790;&#x51fd;&#x6570;&quot;&quot;&quot;</span>\n        <span class=\"hljs-comment\"># &#x83b7;&#x53d6;&#x4e0a;&#x4e2a;&#x89e3;&#x6790;&#x51fd;&#x6570;&#x4f20;&#x9012;&#x8fc7;&#x6765;&#x7684; meta &#x6570;&#x636e;</span>\n        item = response.meta[<span class=\"hljs-string\">&apos;meta_1&apos;</span>]\n        item[<span class=\"hljs-string\">&apos;time&apos;</span>] = response.xpath(<span class=\"hljs-string\">&apos;//ul[@class=&quot;assort clearfix&quot;]/li[1]/span/text()&apos;</span>).get()\n        item[<span class=\"hljs-string\">&apos;km&apos;</span>] = response.xpath(<span class=\"hljs-string\">&apos;//ul[@class=&quot;assort clearfix&quot;]/li[2]/span/text()&apos;</span>).get()\n        item[<span class=\"hljs-string\">&apos;disp&apos;</span>] = response.xpath(<span class=\"hljs-string\">&apos;//ul[@class=&quot;assort clearfix&quot;]/li[3]/span/text()&apos;</span>).get()\n        item[<span class=\"hljs-string\">&apos;trans&apos;</span>] = response.xpath(<span class=\"hljs-string\">&apos;//ul[@class=&quot;assort clearfix&quot;]/li[4]/span/text()&apos;</span>).get()\n\n        <span class=\"hljs-comment\"># 1&#x6761;&#x6570;&#x636e;&#x6700;&#x7ec8;&#x63d0;&#x53d6;&#x5168;&#x90e8;&#x5b8c;&#x6210;,&#x4ea4;&#x7ed9;&#x7ba1;&#x9053;&#x6587;&#x4ef6;&#x5904;&#x7406;</span>\n        <span class=\"hljs-keyword\">yield</span> item\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"546,591"}}],"payload":{"tag":"h4","lines":"544,545"}},{"content":"&#x6b65;&#x9aa4;3 - pipelines.py","children":[{"content":"<pre data-lines=\"594,611\"><code class=\"language-python\"><span class=\"hljs-comment\"># &#x5c06;&#x6570;&#x636e;&#x5b58;&#x5165;mongodb&#x6570;&#x636e;&#x5e93;,&#x6b64;&#x5904;&#x6211;&#x4eec;&#x5c31;&#x4e0d;&#x5bf9;MySQL&#x8868;&#x5b57;&#x6bb5;&#x8fdb;&#x884c;&#x64cd;&#x4f5c;&#x4e86;,&#x5982;&#x6709;&#x5174;&#x8da3;&#x53ef;&#x81ea;&#x884c;&#x5b8c;&#x5584;</span>\n<span class=\"hljs-comment\"># MongoDB&#x7ba1;&#x9053;</span>\n<span class=\"hljs-keyword\">import</span> pymongo\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">GuaziMongoPipeline</span>(<span class=\"hljs-title class_ inherited__\">object</span>):\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">open_spider</span>(<span class=\"hljs-params\">self,spider</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x722c;&#x866b;&#x9879;&#x76ee;&#x542f;&#x52a8;&#x65f6;&#x53ea;&#x6267;&#x884c;1&#x6b21;,&#x7528;&#x4e8e;&#x8fde;&#x63a5;MongoDB&#x6570;&#x636e;&#x5e93;&quot;&quot;&quot;</span>\n        <span class=\"hljs-variable language_\">self</span>.conn = pymongo.MongoClient(MONGO_HOST,MONGO_PORT)\n        <span class=\"hljs-variable language_\">self</span>.db = <span class=\"hljs-variable language_\">self</span>.conn[MONGO_DB]\n        <span class=\"hljs-variable language_\">self</span>.myset = <span class=\"hljs-variable language_\">self</span>.db[MONGO_SET]\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_item</span>(<span class=\"hljs-params\">self,item,spider</span>):\n        car_dict = <span class=\"hljs-built_in\">dict</span>(item)\n        <span class=\"hljs-variable language_\">self</span>.myset.insert_one(car_dict)\n        <span class=\"hljs-keyword\">return</span> item\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"594,611"}}],"payload":{"tag":"h4","lines":"592,593"}}],"payload":{"tag":"h3","lines":"522,523"}}],"payload":{"tag":"h2","lines":"505,506"}},{"content":"&#x817e;&#x8baf;&#x62db;&#x8058;&#x804c;&#x4f4d;&#x4fe1;&#x606f;&#x6293;&#x53d6; - &#x4e8c;&#x7ea7;&#x9875;&#x9762;","children":[{"content":"1&#x3001;&#x521b;&#x5efa;&#x9879;&#x76ee;+&#x722c;&#x866b;&#x6587;&#x4ef6;","children":[{"content":"<pre data-lines=\"626,637\"><code class=\"language-python\">scrapy startproject Tencent\ncd Tencent\nscrapy genspider tencent careers.tencent.com\n\n# &#x4e00;&#x7ea7;&#x9875;&#x9762;(postId):\nhttps://careers.tencent.com/tencentcareer/api/post/Query?timestamp=1566266592644&amp;countryId=&amp;cityId=&amp;bgIds=&amp;productId=&amp;categoryId=&amp;parentCategoryId=&amp;attrId=&amp;keyword={}&amp;pageIndex={}&amp;pageSize=10&amp;language=zh-cn&amp;area=cn\n\n# &#x4e8c;&#x7ea7;&#x9875;&#x9762;(&#x540d;&#x79f0;+&#x7c7b;&#x522b;+&#x804c;&#x8d23;+&#x8981;&#x6c42;+&#x5730;&#x5740;+&#x65f6;&#x95f4;)\nhttps://careers.tencent.com/tencentcareer/api/post/ByPostId?timestamp=1566266695175&amp;postId={}&amp;language=zh-cn\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"626,637"}}],"payload":{"tag":"h3","lines":"624,625"}},{"content":"2&#x3001;&#x5b9a;&#x4e49;&#x722c;&#x53d6;&#x7684;&#x6570;&#x636e;&#x7ed3;&#x6784;","children":[{"content":"<pre data-lines=\"640,655\"><code class=\"language-python\"><span class=\"hljs-keyword\">import</span> scrapy\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">TencentItem</span>(scrapy.Item):\n    <span class=\"hljs-comment\"># &#x540d;&#x79f0;+&#x7c7b;&#x522b;+&#x804c;&#x8d23;+&#x8981;&#x6c42;+&#x5730;&#x5740;+&#x65f6;&#x95f4;</span>\n    job_name = scrapy.Field()\n    job_type = scrapy.Field()\n    job_duty = scrapy.Field()\n    job_require = scrapy.Field()\n    job_address = scrapy.Field()\n    job_time = scrapy.Field()\n    <span class=\"hljs-comment\"># &#x5177;&#x4f53;&#x804c;&#x4f4d;&#x94fe;&#x63a5;</span>\n    job_url = scrapy.Field()\n    post_id = scrapy.Field()\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"640,655"}}],"payload":{"tag":"h3","lines":"638,639"}},{"content":"3&#x3001;&#x722c;&#x866b;&#x6587;&#x4ef6;","children":[{"content":"<pre data-lines=\"658,720\"><code class=\"language-python\"><span class=\"hljs-comment\"># -*- coding: utf-8 -*-</span>\n<span class=\"hljs-keyword\">import</span> scrapy\n<span class=\"hljs-keyword\">from</span> urllib <span class=\"hljs-keyword\">import</span> parse\n<span class=\"hljs-keyword\">import</span> requests\n<span class=\"hljs-keyword\">import</span> json\n<span class=\"hljs-keyword\">from</span> ..items <span class=\"hljs-keyword\">import</span> TencentItem\n\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">TencentSpider</span>(scrapy.Spider):\n    name = <span class=\"hljs-string\">&apos;tencent&apos;</span>\n    allowed_domains = [<span class=\"hljs-string\">&apos;careers.tencent.com&apos;</span>]\n    <span class=\"hljs-comment\"># &#x5b9a;&#x4e49;&#x5e38;&#x7528;&#x53d8;&#x91cf;</span>\n    one_url = <span class=\"hljs-string\">&apos;https://careers.tencent.com/tencentcareer/api/post/Query?timestamp=1566266592644&amp;countryId=&amp;cityId=&amp;bgIds=&amp;productId=&amp;categoryId=&amp;parentCategoryId=&amp;attrId=&amp;keyword={}&amp;pageIndex={}&amp;pageSize=10&amp;language=zh-cn&amp;area=cn&apos;</span>\n    two_url = <span class=\"hljs-string\">&apos;https://careers.tencent.com/tencentcareer/api/post/ByPostId?timestamp=1566266695175&amp;postId={}&amp;language=zh-cn&apos;</span>\n    headers = {<span class=\"hljs-string\">&apos;User-Agent&apos;</span>: <span class=\"hljs-string\">&apos;Mozilla/5.0&apos;</span>}\n    keyword = <span class=\"hljs-built_in\">input</span>(<span class=\"hljs-string\">&apos;&#x8bf7;&#x8f93;&#x5165;&#x804c;&#x4f4d;&#x7c7b;&#x522b;:&apos;</span>)\n    keyword = parse.quote(keyword)\n\n    <span class=\"hljs-comment\"># &#x91cd;&#x5199;start_requests()&#x65b9;&#x6cd5;</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">start_requests</span>(<span class=\"hljs-params\">self</span>):\n        total = <span class=\"hljs-variable language_\">self</span>.get_total()\n        <span class=\"hljs-comment\"># &#x751f;&#x6210;&#x4e00;&#x7ea7;&#x9875;&#x9762;&#x6240;&#x6709;&#x9875;&#x7684;URL&#x5730;&#x5740;,&#x4ea4;&#x7ed9;&#x8c03;&#x5ea6;&#x5668;</span>\n        <span class=\"hljs-keyword\">for</span> index <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(<span class=\"hljs-number\">1</span>,total+<span class=\"hljs-number\">1</span>):\n            url = <span class=\"hljs-variable language_\">self</span>.one_url.<span class=\"hljs-built_in\">format</span>(<span class=\"hljs-variable language_\">self</span>.keyword,index)\n            <span class=\"hljs-keyword\">yield</span> scrapy.Request(url=url,callback=<span class=\"hljs-variable language_\">self</span>.parse_one_page)\n\n    <span class=\"hljs-comment\"># &#x83b7;&#x53d6;&#x603b;&#x9875;&#x6570;</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">get_total</span>(<span class=\"hljs-params\">self</span>):\n        url = <span class=\"hljs-variable language_\">self</span>.one_url.<span class=\"hljs-built_in\">format</span>(<span class=\"hljs-variable language_\">self</span>.keyword, <span class=\"hljs-number\">1</span>)\n        html = requests.get(url=url, headers=<span class=\"hljs-variable language_\">self</span>.headers).json()\n        count = html[<span class=\"hljs-string\">&apos;Data&apos;</span>][<span class=\"hljs-string\">&apos;Count&apos;</span>]\n        total = count//<span class=\"hljs-number\">10</span> <span class=\"hljs-keyword\">if</span> count%<span class=\"hljs-number\">10</span>==<span class=\"hljs-number\">0</span> <span class=\"hljs-keyword\">else</span> count//<span class=\"hljs-number\">10</span> + <span class=\"hljs-number\">1</span>\n\n        <span class=\"hljs-keyword\">return</span> total\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">parse_one_page</span>(<span class=\"hljs-params\">self, response</span>):\n        html = json.loads(response.text)\n        <span class=\"hljs-keyword\">for</span> one <span class=\"hljs-keyword\">in</span> html[<span class=\"hljs-string\">&apos;Data&apos;</span>][<span class=\"hljs-string\">&apos;Posts&apos;</span>]:\n            <span class=\"hljs-comment\"># &#x6b64;&#x5904;&#x662f;&#x4e0d;&#x662f;&#x6709;URL&#x9700;&#x8981;&#x4ea4;&#x7ed9;&#x8c03;&#x5ea6;&#x5668;&#x53bb;&#x5165;&#x961f;&#x5217;&#x4e86;&#xff1f; - &#x521b;&#x5efa;item&#x5bf9;&#x8c61;&#xff01;</span>\n            item = TencentItem()\n            item[<span class=\"hljs-string\">&apos;post_id&apos;</span>] = one[<span class=\"hljs-string\">&apos;PostId&apos;</span>]\n            item[<span class=\"hljs-string\">&apos;job_url&apos;</span>] = <span class=\"hljs-variable language_\">self</span>.two_url.<span class=\"hljs-built_in\">format</span>(item[<span class=\"hljs-string\">&apos;post_id&apos;</span>])\n            <span class=\"hljs-comment\"># &#x521b;&#x5efa;1&#x4e2a;item&#x5bf9;&#x8c61;,&#x8bf7;&#x5c06;&#x5176;&#x4ea4;&#x7ed9;&#x8c03;&#x5ea6;&#x5668;&#x5165;&#x961f;&#x5217;</span>\n            <span class=\"hljs-keyword\">yield</span> scrapy.Request(url=item[<span class=\"hljs-string\">&apos;job_url&apos;</span>],meta={<span class=\"hljs-string\">&apos;item&apos;</span>:item},callback=<span class=\"hljs-variable language_\">self</span>.detail_page)\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">detail_page</span>(<span class=\"hljs-params\">self,response</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x4e8c;&#x7ea7;&#x9875;&#x9762;: &#x8be6;&#x60c5;&#x9875;&#x6570;&#x636e;&#x89e3;&#x6790;&quot;&quot;&quot;</span>\n        item = response.meta[<span class=\"hljs-string\">&apos;item&apos;</span>]\n        <span class=\"hljs-comment\"># &#x5c06;&#x54cd;&#x5e94;&#x5185;&#x5bb9;&#x8f6c;&#x4e3a;python&#x6570;&#x636e;&#x7c7b;&#x578b;</span>\n        html = json.loads(response.text)\n        <span class=\"hljs-comment\"># &#x540d;&#x79f0;+&#x7c7b;&#x522b;+&#x804c;&#x8d23;+&#x8981;&#x6c42;+&#x5730;&#x5740;+&#x65f6;&#x95f4;</span>\n        item[<span class=\"hljs-string\">&apos;job_name&apos;</span>] = html[<span class=\"hljs-string\">&apos;Data&apos;</span>][<span class=\"hljs-string\">&apos;RecruitPostName&apos;</span>]\n        item[<span class=\"hljs-string\">&apos;job_type&apos;</span>] = html[<span class=\"hljs-string\">&apos;Data&apos;</span>][<span class=\"hljs-string\">&apos;CategoryName&apos;</span>]\n        item[<span class=\"hljs-string\">&apos;job_duty&apos;</span>] = html[<span class=\"hljs-string\">&apos;Data&apos;</span>][<span class=\"hljs-string\">&apos;Responsibility&apos;</span>]\n        item[<span class=\"hljs-string\">&apos;job_require&apos;</span>] = html[<span class=\"hljs-string\">&apos;Data&apos;</span>][<span class=\"hljs-string\">&apos;Requirement&apos;</span>]\n        item[<span class=\"hljs-string\">&apos;job_address&apos;</span>] = html[<span class=\"hljs-string\">&apos;Data&apos;</span>][<span class=\"hljs-string\">&apos;LocationName&apos;</span>]\n        item[<span class=\"hljs-string\">&apos;job_time&apos;</span>] = html[<span class=\"hljs-string\">&apos;Data&apos;</span>][<span class=\"hljs-string\">&apos;LastUpdateTime&apos;</span>]\n\n        <span class=\"hljs-comment\"># &#x81f3;&#x6b64;: 1&#x6761;&#x5b8c;&#x6574;&#x6570;&#x636e;&#x63d0;&#x53d6;&#x5b8c;&#x6210;,&#x6ca1;&#x6709;&#x7ee7;&#x7eed;&#x9001;&#x5f80;&#x8c03;&#x5ea6;&#x5668;&#x7684;&#x8bf7;&#x6c42;&#x4e86;,&#x4ea4;&#x7ed9;&#x7ba1;&#x9053;&#x6587;&#x4ef6;</span>\n        <span class=\"hljs-keyword\">yield</span> item\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"658,720"}}],"payload":{"tag":"h3","lines":"656,657"}},{"content":"4&#x3001;&#x63d0;&#x524d;&#x5efa;&#x5e93;&#x5efa;&#x8868; - MySQL","children":[{"content":"<pre data-lines=\"723,735\"><code class=\"language-python\">create database tencentdb charset utf8;\nuse tencentdb;\ncreate table tencenttab(\njob_name varchar(500),\njob_type varchar(200),\njob_duty varchar(5000),\njob_require varchar(5000),\njob_address varchar(100),\njob_time varchar(100)\n)charset=utf8;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"723,735"}}],"payload":{"tag":"h3","lines":"721,722"}},{"content":"5&#x3001;&#x7ba1;&#x9053;&#x6587;&#x4ef6;","children":[{"content":"<pre data-lines=\"738,772\"><code class=\"language-python\"><span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">TencentPipeline</span>(<span class=\"hljs-title class_ inherited__\">object</span>):\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_item</span>(<span class=\"hljs-params\">self, item, spider</span>):\n        <span class=\"hljs-keyword\">return</span> item\n\n<span class=\"hljs-keyword\">import</span> pymysql\n<span class=\"hljs-keyword\">from</span> .settings <span class=\"hljs-keyword\">import</span> *\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">TencentMysqlPipeline</span>(<span class=\"hljs-title class_ inherited__\">object</span>):\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">open_spider</span>(<span class=\"hljs-params\">self,spider</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x722c;&#x866b;&#x9879;&#x76ee;&#x542f;&#x52a8;&#x65f6;,&#x8fde;&#x63a5;&#x6570;&#x636e;&#x5e93;1&#x6b21;&quot;&quot;&quot;</span>\n        <span class=\"hljs-variable language_\">self</span>.db = pymysql.connect(MYSQL_HOST,MYSQL_USER,MYSQL_PWD,MYSQL_DB,charset=CHARSET)\n        <span class=\"hljs-variable language_\">self</span>.cursor = <span class=\"hljs-variable language_\">self</span>.db.cursor()\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_item</span>(<span class=\"hljs-params\">self,item,spider</span>):\n        ins=<span class=\"hljs-string\">&apos;insert into tencenttab values(%s,%s,%s,%s,%s,%s)&apos;</span>\n        job_li = [\n            item[<span class=\"hljs-string\">&apos;job_name&apos;</span>],\n            item[<span class=\"hljs-string\">&apos;job_type&apos;</span>],\n            item[<span class=\"hljs-string\">&apos;job_duty&apos;</span>],\n            item[<span class=\"hljs-string\">&apos;job_require&apos;</span>],\n            item[<span class=\"hljs-string\">&apos;job_address&apos;</span>],\n            item[<span class=\"hljs-string\">&apos;job_time&apos;</span>]\n        ]\n        <span class=\"hljs-variable language_\">self</span>.cursor.execute(ins,job_li)\n        <span class=\"hljs-variable language_\">self</span>.db.commit()\n\n        <span class=\"hljs-keyword\">return</span> item\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">close_spider</span>(<span class=\"hljs-params\">self,spider</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x722c;&#x866b;&#x9879;&#x76ee;&#x7ed3;&#x675f;&#x65f6;,&#x65ad;&#x5f00;&#x6570;&#x636e;&#x5e93;1&#x6b21;&quot;&quot;&quot;</span>\n        <span class=\"hljs-variable language_\">self</span>.cursor.close()\n        <span class=\"hljs-variable language_\">self</span>.db.close()\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"738,772"}}],"payload":{"tag":"h3","lines":"736,737"}},{"content":"6&#x3001;settings.py","children":[{"content":"<pre data-lines=\"775,794\"><code class=\"language-python\">ROBOTS_TXT = <span class=\"hljs-literal\">False</span>\nDOWNLOAD_DELAY = <span class=\"hljs-number\">0.5</span>\nDEFAULT_REQUEST_HEADERS = {\n  <span class=\"hljs-string\">&apos;Accept&apos;</span>: <span class=\"hljs-string\">&apos;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&apos;</span>,\n  <span class=\"hljs-string\">&apos;Accept-Language&apos;</span>: <span class=\"hljs-string\">&apos;en&apos;</span>,\n  <span class=\"hljs-string\">&apos;User-Agent&apos;</span>: <span class=\"hljs-string\">&apos;Mozilla/5.0&apos;</span>,\n}\nITEM_PIPELINES = {\n   <span class=\"hljs-string\">&apos;Tencent.pipelines.TencentPipeline&apos;</span>: <span class=\"hljs-number\">300</span>,\n   <span class=\"hljs-string\">&apos;Tencent.pipelines.TencentMysqlPipeline&apos;</span>: <span class=\"hljs-number\">500</span>,\n}\n<span class=\"hljs-comment\"># MySQL&#x76f8;&#x5173;&#x53d8;&#x91cf;</span>\nMYSQL_HOST = <span class=\"hljs-string\">&apos;localhost&apos;</span>\nMYSQL_USER = <span class=\"hljs-string\">&apos;root&apos;</span>\nMYSQL_PWD = <span class=\"hljs-string\">&apos;123456&apos;</span>\nMYSQL_DB = <span class=\"hljs-string\">&apos;tencentdb&apos;</span>\nCHARSET = <span class=\"hljs-string\">&apos;utf8&apos;</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"775,794"}}],"payload":{"tag":"h3","lines":"773,774"}}],"payload":{"tag":"h2","lines":"622,623"}},{"content":"&#x76d7;&#x5893;&#x7b14;&#x8bb0;&#x5c0f;&#x8bf4;&#x6293;&#x53d6; - &#x4e09;&#x7ea7;&#x9875;&#x9762;","children":[{"content":"&#x76ee;&#x6807;","children":[{"content":"<pre data-lines=\"799,805\"><code class=\"language-python\">&#x3010;1&#x3011;URL&#x5730;&#x5740; &#xff1a;http://www.daomubiji.com/\n&#x3010;2&#x3011;&#x8981;&#x6c42; : &#x6293;&#x53d6;&#x76ee;&#x6807;&#x7f51;&#x7ad9;&#x4e2d;&#x76d7;&#x5893;&#x7b14;&#x8bb0;&#x6240;&#x6709;&#x7ae0;&#x8282;&#x7684;&#x6240;&#x6709;&#x5c0f;&#x8bf4;&#x7684;&#x5177;&#x4f53;&#x5185;&#x5bb9;&#xff0c;&#x4fdd;&#x5b58;&#x5230;&#x672c;&#x5730;&#x6587;&#x4ef6;\n    ./data/novel/&#x76d7;&#x5893;&#x7b14;&#x8bb0;1:&#x4e03;&#x661f;&#x9c81;&#x738b;&#x5bab;/&#x4e03;&#x661f;&#x9c81;&#x738b;_&#x7b2c;&#x4e00;&#x7ae0;_&#x8840;&#x5c38;.txt\n    ./data/novel/&#x76d7;&#x5893;&#x7b14;&#x8bb0;1:&#x4e03;&#x661f;&#x9c81;&#x738b;&#x5bab;/&#x4e03;&#x661f;&#x9c81;&#x738b;_&#x7b2c;&#x4e8c;&#x7ae0;_&#x4e94;&#x5341;&#x5e74;&#x540e;.txt\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"799,805"}}],"payload":{"tag":"h3","lines":"797,798"}},{"content":"&#x51c6;&#x5907;&#x5de5;&#x4f5c;xpath","children":[{"content":"<pre data-lines=\"808,823\"><code class=\"language-python\">&#x3010;<span class=\"hljs-number\">1</span>&#x3011;&#x4e00;&#x7ea7;&#x9875;&#x9762; - &#x5927;&#x7ae0;&#x8282;&#x6807;&#x9898;&#x3001;&#x94fe;&#x63a5;&#xff1a;\n    <span class=\"hljs-number\">1.1</span>) &#x57fa;&#x51c6;xpath&#x5339;&#x914d;a&#x8282;&#x70b9;&#x5bf9;&#x8c61;&#x5217;&#x8868;:  <span class=\"hljs-string\">&apos;//li[contains(@id,&quot;menu-item-20&quot;)]/a&apos;</span>\n    <span class=\"hljs-number\">1.2</span>) &#x5927;&#x7ae0;&#x8282;&#x6807;&#x9898;: <span class=\"hljs-string\">&apos;./text()&apos;</span>\n    <span class=\"hljs-number\">1.3</span>) &#x5927;&#x7ae0;&#x8282;&#x94fe;&#x63a5;: <span class=\"hljs-string\">&apos;./@href&apos;</span>\n    \n&#x3010;<span class=\"hljs-number\">2</span>&#x3011;&#x4e8c;&#x7ea7;&#x9875;&#x9762; - &#x5c0f;&#x7ae0;&#x8282;&#x6807;&#x9898;&#x3001;&#x94fe;&#x63a5;\n    <span class=\"hljs-number\">2.1</span>) &#x57fa;&#x51c6;xpath&#x5339;&#x914d;article&#x8282;&#x70b9;&#x5bf9;&#x8c61;&#x5217;&#x8868;: <span class=\"hljs-string\">&apos;//article&apos;</span>\n    <span class=\"hljs-number\">2.2</span>) &#x5c0f;&#x7ae0;&#x8282;&#x6807;&#x9898;: <span class=\"hljs-string\">&apos;./a/text()&apos;</span>\n    <span class=\"hljs-number\">2.3</span>) &#x5c0f;&#x7ae0;&#x8282;&#x94fe;&#x63a5;: <span class=\"hljs-string\">&apos;./a/@href&apos;</span>\n    \n&#x3010;<span class=\"hljs-number\">3</span>&#x3011;&#x4e09;&#x7ea7;&#x9875;&#x9762; - &#x5c0f;&#x8bf4;&#x5185;&#x5bb9;\n    <span class=\"hljs-number\">3.1</span>) p&#x8282;&#x70b9;&#x5217;&#x8868;: <span class=\"hljs-string\">&apos;//article[@class=&quot;article-content&quot;]/p/text()&apos;</span>\n    <span class=\"hljs-number\">3.2</span>) &#x5229;&#x7528;join()&#x8fdb;&#x884c;&#x62fc;&#x63a5;: <span class=\"hljs-string\">&apos; &apos;</span>.join([<span class=\"hljs-string\">&apos;p1&apos;</span>,<span class=\"hljs-string\">&apos;p2&apos;</span>,<span class=\"hljs-string\">&apos;p3&apos;</span>,<span class=\"hljs-string\">&apos;&apos;</span>])\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"808,823"}}],"payload":{"tag":"h3","lines":"806,807"}},{"content":"&#x9879;&#x76ee;&#x5b9e;&#x73b0;","children":[{"content":"1&#x3001;&#x521b;&#x5efa;&#x9879;&#x76ee;&#x53ca;&#x722c;&#x866b;&#x6587;&#x4ef6;","children":[{"content":"<pre data-lines=\"828,833\"><code class=\"language-python\">scrapy startproject Daomu\ncd Daomu\nscrapy genspider daomu www.daomubiji.com\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"828,833"}}],"payload":{"tag":"h4","lines":"826,827"}},{"content":"2&#x3001;&#x5b9a;&#x4e49;&#x8981;&#x722c;&#x53d6;&#x7684;&#x6570;&#x636e;&#x7ed3;&#x6784; - itemspy","children":[{"content":"<pre data-lines=\"836,852\"><code class=\"language-python\"><span class=\"hljs-keyword\">import</span> scrapy\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">DaomuItem</span>(scrapy.Item):\n    <span class=\"hljs-comment\"># define the fields for your item here like:</span>\n    <span class=\"hljs-comment\"># 1&#x3001;&#x4e00;&#x7ea7;&#x9875;&#x9762;: &#x5927;&#x6807;&#x9898;+&#x94fe;&#x63a5;</span>\n    parent_title = scrapy.Field()\n    parent_url = scrapy.Field()\n    <span class=\"hljs-comment\"># 2&#x3001;&#x4e8c;&#x7ea7;&#x9875;&#x9762;&#xff1a;&#x5c0f;&#x6807;&#x9898;+&#x94fe;&#x63a5;</span>\n    son_title = scrapy.Field()\n    son_url = scrapy.Field()\n    <span class=\"hljs-comment\"># 3&#x3001;&#x4e09;&#x7ea7;&#x9875;&#x9762;&#xff1a;&#x5c0f;&#x8bf4;&#x5185;&#x5bb9;</span>\n    content = scrapy.Field()\n    <span class=\"hljs-comment\"># 4&#x3001;&#x76ee;&#x5f55;</span>\n    directory = scrapy.Field()\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"836,852"}}],"payload":{"tag":"h4","lines":"834,835"}},{"content":"3&#x3001;&#x722c;&#x866b;&#x6587;&#x4ef6;&#x5b9e;&#x73b0;&#x6570;&#x636e;&#x6293;&#x53d6; - daomu.py","children":[{"content":"<pre data-lines=\"855,910\"><code class=\"language-python\"><span class=\"hljs-comment\"># -*- coding: utf-8 -*-</span>\n<span class=\"hljs-keyword\">import</span> scrapy\n<span class=\"hljs-keyword\">from</span> ..items <span class=\"hljs-keyword\">import</span> DaomuItem\n<span class=\"hljs-keyword\">import</span> os\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">DaomuSpider</span>(scrapy.Spider):\n    name = <span class=\"hljs-string\">&apos;daomu&apos;</span>\n    allowed_domains = [<span class=\"hljs-string\">&apos;www.daomubiji.com&apos;</span>]\n    start_urls = [<span class=\"hljs-string\">&apos;http://www.daomubiji.com/&apos;</span>]\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">parse</span>(<span class=\"hljs-params\">self, response</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x4e00;&#x7ea7;&#x9875;&#x9762;&#x89e3;&#x6790;&#xff1a;&#x63d0;&#x53d6;&#x5927;&#x6807;&#x9898;&#x548c;&#x94fe;&#x63a5;&quot;&quot;&quot;</span>\n        a_list = response.xpath(<span class=\"hljs-string\">&apos;//li[contains(@id,&quot;menu-item-20&quot;)]/a&apos;</span>)\n        <span class=\"hljs-keyword\">for</span> a <span class=\"hljs-keyword\">in</span> a_list:\n            <span class=\"hljs-comment\"># &#x601d;&#x8003;: &#x6b64;&#x5904;&#x662f;&#x5426;&#x9700;&#x8981;&#x7ee7;&#x7eed;&#x4ea4;&#x7ed9;&#x8c03;&#x5ea6;&#x5668;&#x5165;&#x961f;&#x5217;&#xff1f;-&#x9700;&#x8981;&#xff01;&#x521b;&#x5efa;item&#x5bf9;&#x8c61;</span>\n            item = DaomuItem()\n            item[<span class=\"hljs-string\">&apos;parent_title&apos;</span>] = a.xpath(<span class=\"hljs-string\">&apos;./text()&apos;</span>).get()\n            item[<span class=\"hljs-string\">&apos;parent_url&apos;</span>] = a.xpath(<span class=\"hljs-string\">&apos;./@href&apos;</span>).get()\n            directory = <span class=\"hljs-string\">&apos;./novel/{}/&apos;</span>.<span class=\"hljs-built_in\">format</span>(item[<span class=\"hljs-string\">&apos;parent_title&apos;</span>])\n            item[<span class=\"hljs-string\">&apos;directory&apos;</span>] = directory\n            <span class=\"hljs-comment\"># &#x521b;&#x5efa;&#x5bf9;&#x5e94;&#x76ee;&#x5f55;</span>\n            <span class=\"hljs-keyword\">if</span> <span class=\"hljs-keyword\">not</span> os.path.exists(directory):\n                os.makedirs(directory)\n            <span class=\"hljs-comment\"># &#x7ee7;&#x7eed;&#x4ea4;&#x7ed9;&#x8c03;&#x5ea6;&#x5668;&#x5165;&#x961f;&#x5217;</span>\n            <span class=\"hljs-keyword\">yield</span> scrapy.Request(\n                url=item[<span class=\"hljs-string\">&apos;parent_url&apos;</span>],meta={<span class=\"hljs-string\">&apos;meta_1&apos;</span>:item},callback=<span class=\"hljs-variable language_\">self</span>.detail_page)\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">detail_page</span>(<span class=\"hljs-params\">self,response</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x4e8c;&#x7ea7;&#x9875;&#x9762;&#x89e3;&#x6790;&#xff1a;&#x63d0;&#x53d6;&#x5c0f;&#x6807;&#x9898;&#x540d;&#x5b57;&#x3001;&#x94fe;&#x63a5;&quot;&quot;&quot;</span>\n        meta1_item = response.meta[<span class=\"hljs-string\">&apos;meta_1&apos;</span>]\n        article_list = response.xpath(<span class=\"hljs-string\">&apos;//article&apos;</span>)\n        <span class=\"hljs-keyword\">for</span> article <span class=\"hljs-keyword\">in</span> article_list:\n            <span class=\"hljs-comment\"># &#x53c8;&#x6709;&#x7ee7;&#x7eed;&#x4ea4;&#x7ed9;&#x8c03;&#x5ea6;&#x5668;&#x5165;&#x961f;&#x5217;&#x7684;&#x8bf7;&#x6c42;&#x4e86;</span>\n            item = DaomuItem()\n            item[<span class=\"hljs-string\">&apos;son_title&apos;</span>] = article.xpath(<span class=\"hljs-string\">&apos;./a/text()&apos;</span>).get()\n            item[<span class=\"hljs-string\">&apos;son_url&apos;</span>] = article.xpath(<span class=\"hljs-string\">&apos;./a/@href&apos;</span>).get()\n            item[<span class=\"hljs-string\">&apos;parent_title&apos;</span>] = meta1_item[<span class=\"hljs-string\">&apos;parent_title&apos;</span>]\n            item[<span class=\"hljs-string\">&apos;parent_url&apos;</span>] = meta1_item[<span class=\"hljs-string\">&apos;parent_url&apos;</span>]\n            item[<span class=\"hljs-string\">&apos;directory&apos;</span>] = meta1_item[<span class=\"hljs-string\">&apos;directory&apos;</span>]\n            <span class=\"hljs-comment\"># &#x628a;&#x6bcf;&#x4e00;&#x4e2a;&#x7ae0;&#x8282;&#x7684;item&#x5bf9;&#x8c61;&#x4ea4;&#x7ed9;&#x8c03;&#x5ea6;&#x5668;&#x5165;&#x961f;&#x5217;</span>\n            <span class=\"hljs-keyword\">yield</span> scrapy.Request(\n                url=item[<span class=\"hljs-string\">&apos;son_url&apos;</span>],meta={<span class=\"hljs-string\">&apos;meta_2&apos;</span>:item},callback=<span class=\"hljs-variable language_\">self</span>.get_content)\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">get_content</span>(<span class=\"hljs-params\">self,response</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x4e09;&#x7ea7;&#x9875;&#x9762;&#xff1a;&#x63d0;&#x53d6;&#x5c0f;&#x8bf4;&#x5177;&#x4f53;&#x5185;&#x5bb9;&quot;&quot;&quot;</span>\n        <span class=\"hljs-comment\"># &#x6700;&#x540e;&#x4e00;&#x7ea7;&#x9875;&#x9762;,&#x6ca1;&#x6709;&#x7ee7;&#x7eed;&#x4ea4;&#x7ed9;&#x8c03;&#x5ea6;&#x5668;&#x5165;&#x961f;&#x5217;&#x7684;&#x8bf7;&#x6c42;&#x4e86;,&#x6240;&#x4ee5;&#x4e0d;&#x9700;&#x8981;&#x521b;&#x5efa;item&#x5bf9;&#x8c61;&#x4e86;</span>\n        item = response.meta[<span class=\"hljs-string\">&apos;meta_2&apos;</span>]\n        <span class=\"hljs-comment\"># content_list: [&apos;&#x6bb5;&#x843d;1&apos;,&apos;&#x6bb5;&#x843d;2&apos;,&apos;&#x6bb5;&#x843d;3&apos;,&apos;&#x6bb5;&#x843d;4&apos;]</span>\n        content_list = response.xpath(<span class=\"hljs-string\">&apos;//article[@class=&quot;article-content&quot;]/p/text()&apos;</span>).extract()\n        item[<span class=\"hljs-string\">&apos;content&apos;</span>] = <span class=\"hljs-string\">&apos;\\n&apos;</span>.join(content_list)\n\n        <span class=\"hljs-comment\"># 1&#x6761;&#x6570;&#x636e;&#x5f7b;&#x5e95;&#x641e;&#x5b8c;,&#x4ea4;&#x7ed9;&#x7ba1;&#x9053;&#x6587;&#x4ef6;&#x5904;&#x7406;</span>\n        <span class=\"hljs-keyword\">yield</span> item\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"855,910"}}],"payload":{"tag":"h4","lines":"853,854"}},{"content":"4&#x3001;&#x7ba1;&#x9053;&#x6587;&#x4ef6;&#x5b9e;&#x73b0;&#x6570;&#x636e;&#x5904;&#x7406; - pipelines.py","children":[{"content":"<pre data-lines=\"913,927\"><code class=\"language-python\"><span class=\"hljs-comment\"># -*- coding: utf-8 -*-</span>\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">DaomuPipeline</span>(<span class=\"hljs-title class_ inherited__\">object</span>):\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_item</span>(<span class=\"hljs-params\">self, item, spider</span>):\n        <span class=\"hljs-comment\"># &#x6700;&#x7ec8;&#x76ee;&#x6807;:  ./novel/&#x76d7;&#x5893;&#x7b14;&#x8bb0;1:&#x4e03;&#x661f;&#x9c81;&#x738b;&#x5bab;/&#x4e03;&#x661f;&#x9c81;&#x738b;_&#x7b2c;&#x4e00;&#x7ae0;_&#x8840;&#x5c38;.txt</span>\n        <span class=\"hljs-comment\"># directory: ./novel/&#x76d7;&#x5893;&#x7b14;&#x8bb0;1:&#x4e03;&#x661f;&#x9c81;&#x738b;&#x5bab;/</span>\n        filename = item[<span class=\"hljs-string\">&apos;directory&apos;</span>] + item[<span class=\"hljs-string\">&apos;son_title&apos;</span>].replace(<span class=\"hljs-string\">&apos; &apos;</span>,<span class=\"hljs-string\">&apos;_&apos;</span>) + <span class=\"hljs-string\">&apos;.txt&apos;</span>\n        <span class=\"hljs-keyword\">with</span> <span class=\"hljs-built_in\">open</span>(filename,<span class=\"hljs-string\">&apos;w&apos;</span>) <span class=\"hljs-keyword\">as</span> f:\n            f.write(item[<span class=\"hljs-string\">&apos;content&apos;</span>])\n\n        <span class=\"hljs-keyword\">return</span> item\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"913,927"}}],"payload":{"tag":"h4","lines":"911,912"}},{"content":"5&#x3001;&#x5168;&#x5c40;&#x914d;&#x7f6e; - setting.py","children":[{"content":"<pre data-lines=\"930,942\"><code class=\"language-python\">ROBOTSTXT_OBEY = <span class=\"hljs-literal\">False</span>\nDOWNLOAD_DELAY = <span class=\"hljs-number\">0.5</span>\nDEFAULT_REQUEST_HEADERS = {\n  <span class=\"hljs-string\">&apos;Accept&apos;</span>: <span class=\"hljs-string\">&apos;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&apos;</span>,\n  <span class=\"hljs-string\">&apos;Accept-Language&apos;</span>: <span class=\"hljs-string\">&apos;en&apos;</span>,\n  <span class=\"hljs-string\">&apos;User-Agent&apos;</span>: <span class=\"hljs-string\">&apos;Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36&apos;</span>\n}\nITEM_PIPELINES = {\n   <span class=\"hljs-string\">&apos;Daomu.pipelines.DaomuPipeline&apos;</span>: <span class=\"hljs-number\">300</span>,\n}\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"930,942"}}],"payload":{"tag":"h4","lines":"928,929"}}],"payload":{"tag":"h3","lines":"824,825"}}],"payload":{"tag":"h2","lines":"795,796"}},{"content":"&#x4eca;&#x65e5;&#x4f5c;&#x4e1a; - &#x65b0;&#x6d6a;&#x65b0;&#x95fb;&#x5168;&#x7ad9;&#x6293;&#x53d6;","children":[{"content":"&#x76d7;&#x5893;&#x7b14;&#x8bb0;&#x4f5c;&#x4e1a;&#x63d0;&#x793a;","children":[{"content":"<pre data-lines=\"957,973\"><code class=\"language-python\">&#x3010;<span class=\"hljs-number\">1</span>&#x3011;&#x4e00;&#x7ea7;&#x9875;&#x9762;xpath&#x8868;&#x8fbe;&#x5f0f;&#xff1a;\n    a&#x8282;&#x70b9;: //li[contains(@<span class=\"hljs-built_in\">id</span>,<span class=\"hljs-string\">&quot;menu-item-20&quot;</span>)]/a\n    title: ./text()\n    link : ./@href\n    \n&#x3010;<span class=\"hljs-number\">2</span>&#x3011;&#x4e8c;&#x7ea7;&#x9875;&#x9762;xpath&#x8868;&#x8fbe;&#x5f0f;\n    &#x57fa;&#x51c6;xpath &#xff1a;//article\n    <span class=\"hljs-keyword\">for</span>&#x5faa;&#x73af;&#x904d;&#x5386;&#x540e;:\n        name=article.xpath(<span class=\"hljs-string\">&apos;./a/text()&apos;</span>).get()\n        link=article.xpath(<span class=\"hljs-string\">&apos;./a/@href&apos;</span>).get()\n    \n&#x3010;<span class=\"hljs-number\">3</span>&#x3011;&#x4e09;&#x7ea7;&#x9875;&#x9762;xpath&#xff1a;\n    response.xpath(<span class=\"hljs-string\">&apos;//article[@class=&quot;article-content&quot;]/p/text()&apos;</span>).extract()\n    <span class=\"hljs-comment\"># &#x7ed3;&#x679c;: [&apos;p1&apos;,&apos;p2&apos;,&apos;p3&apos;,&apos;&apos;]</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"957,973"}}],"payload":{"tag":"h3","lines":"955,956"}},{"content":"&#x793a;&#x4f8b;","children":[{"content":"<pre data-lines=\"976,979\"><code data-lines=\"976,979\">\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"976,979"}}],"payload":{"tag":"h3","lines":"974,975"}}],"payload":{"tag":"h2","lines":"943,944"}}],"payload":{"tag":"h1","lines":"159,160"}}]},{})</script>
</body>
</html>
