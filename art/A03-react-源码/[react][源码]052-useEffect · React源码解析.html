<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets@11.11.1/styles/default.min.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.18.10/dist/browser/index.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/index.js"></script><script>(r => {
              setTimeout(r);
            })(function renderToolbar() {
  const {
    markmap,
    mm
  } = window;
  const {
    el
  } = markmap.Toolbar.create(mm);
  el.setAttribute('style', 'position:absolute;bottom:20px;right:20px');
  document.body.append(el);
})</script><script>((getMarkmap, getOptions, root2, jsonOptions) => {
              const markmap = getMarkmap();
              window.mm = markmap.Markmap.create(
                "svg#mindmap",
                (getOptions || markmap.deriveOptions)(jsonOptions),
                root2
              );
            })(() => window.markmap,null,{"content":"useEffect","children":[{"content":"<pre data-lines=\"2,5\"><code>`effect`&#x4e5f;&#x5c31;&#x662f;&#x5728;React&#x4e2d;&#x6211;&#x4eec;&#x5e38;&#x8bf4;&#x7684;`side effect`&#xff0c;&#x5728;React&#x4e2d;&#x7c7b;&#x4f3c;&#x50cf;`componentDidMount`&#x8fd9;&#x6837;&#x7684;&#x751f;&#x547d;&#x5468;&#x671f;&#x65b9;&#x6cd5;&#x4e2d;&#xff0c;&#x56e0;&#x4e3a;&#x53ef;&#x80fd;&#x4f1a;&#x6267;&#x884c;`setState`&#x8fd9;&#x6837;&#x7684;&#x65b9;&#x6cd5;&#x800c;&#x4ea7;&#x751f;&#x65b0;&#x7684;&#x66f4;&#x65b0;&#xff0c;&#x6211;&#x4eec;&#x79f0;&#x4e4b;&#x4e3a;`side effect`&#x5373;&#x526f;&#x4f5c;&#x7528;&#x3002;&#x672c;&#x8eab;`FunctionalComponent`&#x56e0;&#x4e3a;&#x662f;`pure function`&#xff0c;&#x6240;&#x4ee5;&#x4e0d;&#x4f1a;&#x4ea7;&#x751f;&#x4efb;&#x4f55;&#x7684;&#x526f;&#x4f5c;&#x7528;&#xff0c;&#x800c;`useEffect`&#x548c;`useLayoutEffect`&#x5219;&#x662f;&#x5e26;&#x7ed9;`FunctionalComponent`&#x4ea7;&#x751f;&#x526f;&#x4f5c;&#x7528;&#x80fd;&#x529b;&#x7684;Hooks&#xff0c;&#x4ed6;&#x4eec;&#x7684;&#x884c;&#x4e3a;&#x975e;&#x5e38;&#x7c7b;&#x4f3c;`componentDidMount`&#x548c;`componentDidUpdate`\n\n&#x4ed6;&#x4eec;&#x63a5;&#x53d7;&#x4e00;&#x4e2a;&#x65b9;&#x6cd5;&#x4f5c;&#x4e3a;&#x53c2;&#x6570;&#xff0c;&#x8be5;&#x65b9;&#x6cd5;&#x4f1a;&#x5728;&#x6bcf;&#x6b21;&#x6e32;&#x67d3;&#x5b8c;&#x6210;&#x4e4b;&#x540e;&#x88ab;&#x8c03;&#x7528;&#xff1b;&#x5176;&#x6b21;&#x8fd8;&#x63a5;&#x53d7;&#x7b2c;&#x4e8c;&#x4e2a;&#x53c2;&#x6570;&#xff0c;&#x662f;&#x4e00;&#x4e2a;&#x6570;&#x7ec4;&#xff0c;&#x8fd9;&#x4e2a;&#x6570;&#x7ec4;&#x91cc;&#x7684;&#x6bcf;&#x4e00;&#x4e2a;&#x5185;&#x5bb9;&#x90fd;&#x4f1a;&#x88ab;&#x7528;&#x6765;&#x8fdb;&#x884c;&#x6e32;&#x67d3;&#x524d;&#x540e;&#x7684;&#x5bf9;&#x6bd4;&#xff0c;&#x5982;&#x679c;&#x6ca1;&#x6709;&#x53d8;&#x5316;&#xff0c;&#x5219;&#x4e0d;&#x4f1a;&#x8c03;&#x7528;&#x8be5;&#x526f;&#x4f5c;&#x7528;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"2,5"}},{"content":"<pre data-lines=\"6,40\"><code data-lines=\"6,40\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">createFunctionComponentUpdateQueue</span>(): FunctionComponentUpdateQueue {\n  <span class=\"hljs-keyword\">return</span> {\n    lastEffect: <span class=\"hljs-literal\">null</span>,\n  };\n}\n\n<span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">pushEffect</span>(tag, create, destroy, inputs) {\n  <span class=\"hljs-keyword\">const</span> effect: Effect = {\n    tag,\n    create,\n    destroy,\n    inputs,\n    \n    <span class=\"hljs-keyword\">next</span>: (<span class=\"hljs-literal\">null</span>: any),\n  };\n  <span class=\"hljs-keyword\">if</span> (componentUpdateQueue === <span class=\"hljs-literal\">null</span>) {\n    componentUpdateQueue = createFunctionComponentUpdateQueue();\n    componentUpdateQueue.lastEffect = effect.<span class=\"hljs-keyword\">next</span> = effect;\n  } <span class=\"hljs-keyword\">else</span> {\n    <span class=\"hljs-keyword\">const</span> lastEffect = componentUpdateQueue.lastEffect;\n    <span class=\"hljs-keyword\">if</span> (lastEffect === <span class=\"hljs-literal\">null</span>) {\n      componentUpdateQueue.lastEffect = effect.<span class=\"hljs-keyword\">next</span> = effect;\n    } <span class=\"hljs-keyword\">else</span> {\n      <span class=\"hljs-keyword\">const</span> firstEffect = lastEffect.<span class=\"hljs-keyword\">next</span>;\n      lastEffect.<span class=\"hljs-keyword\">next</span> = effect;\n      effect.<span class=\"hljs-keyword\">next</span> = firstEffect;\n      componentUpdateQueue.lastEffect = effect;\n    }\n  }\n  <span class=\"hljs-keyword\">return</span> effect;\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"6,40"}},{"content":"<pre data-lines=\"41,53\"><code>&#x4e0d;&#x96be;&#x53d1;&#x73b0;&#x8fd9;&#x4e2a;&#x8fc7;&#x7a0b;&#x5176;&#x5b9e;&#x5c31;&#x662f;&#x5f80;&#x5f53;&#x524d;`Fiber`&#x4e0a;&#x589e;&#x52a0;&#x4e00;&#x7cfb;&#x5217;`effectTag`&#xff0c;&#x5e76;&#x4e14;&#x4f1a;&#x521b;&#x5efa;`updateQueue`&#xff0c;&#x8fd9;&#x8ddf;`HostComponent`&#x7c7b;&#x4f3c;&#xff0c;&#x8fd9;&#x4e2a;`queue`&#x4f1a;&#x5728;`commit`&#x9636;&#x6bb5;&#x88ab;&#x6267;&#x884c;&#x3002;&#x8fd9;&#x91cc;&#x6211;&#x4eec;&#x9700;&#x8981;&#x6ce8;&#x610f;&#x7684;&#x662f;`useLayoutEffect`&#x548c;`useEffect`&#x589e;&#x52a0;&#x7684;`effectTag`&#x662f;&#x4e0d;&#x4e00;&#x6837;&#x7684;&#xff0c;&#x6240;&#x4ee5;&#x4ed6;&#x4eec;&#x6267;&#x884c;&#x7684;&#x65f6;&#x673a;&#x4e5f;&#x662f;&#x4e0d;&#x4e00;&#x6837;&#x7684;&#x3002;`effectTag`&#x4f1a;&#x6709;&#x4ee5;&#x4e0b;&#x51e0;&#x79cd;&#x60c5;&#x51b5;&#xff1a;\n\n*   `useLayoutEffect`&#x589e;&#x52a0;`UpdateEffect`\n*   `useEffect`&#x589e;&#x52a0;`UpdateEffect | PassiveEffect`\n\n&#x4ee5;&#x4e0a;&#x662f;&#x589e;&#x52a0;&#x5728;`Fiber`&#x5bf9;&#x8c61;&#x4e0a;&#x7684;&#xff0c;&#x800c;&#x8bb0;&#x5f55;&#x5bf9;&#x5e94;Hook&#x5bf9;&#x8c61;&#x7684;`effectTag`&#x5982;&#x4e0b;&#xff1a;\n\n*   `useLayoutEffect`&#x589e;&#x52a0;`UnmountMutation | MountLayout`\n*   `useEffect`&#x589e;&#x52a0;`UnmountPassive | MountPassive`\n*   &#x5982;&#x679c;`areHookInputsEqual`&#x7b26;&#x5408;&#xff0c;&#x5219;&#x589e;&#x52a0;`NoHookEffect`\n\n&#x8bb0;&#x4f4f;&#x8fd9;&#x4e9b;&#x5185;&#x5bb9;&#xff0c;&#x6211;&#x4eec;&#x53bb;&#x770b;`commit`&#x9636;&#x6bb5;&#x505a;&#x4e86;&#x4ec0;&#x4e48;&#x8ddf;Hook&#x6709;&#x5173;&#x7684;&#x5185;&#x5bb9;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"41,53"}},{"content":"<pre data-lines=\"54,99\"><code data-lines=\"54,99\"><span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">useLayoutEffect</span>(<span class=\"hljs-params\">\n  create: () =&gt; mixed,\n  inputs: <span class=\"hljs-built_in\">Array</span>&lt;mixed&gt; | <span class=\"hljs-keyword\">void</span> | <span class=\"hljs-literal\">null</span>,\n</span>): <span class=\"hljs-keyword\">void</span> {\n  <span class=\"hljs-title function_\">useEffectImpl</span>(<span class=\"hljs-title class_\">UpdateEffect</span>, <span class=\"hljs-title class_\">UnmountMutation</span> | <span class=\"hljs-title class_\">MountLayout</span>, create, inputs);\n}\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">useEffect</span>(<span class=\"hljs-params\">\n  create: () =&gt; mixed,\n  inputs: <span class=\"hljs-built_in\">Array</span>&lt;mixed&gt; | <span class=\"hljs-keyword\">void</span> | <span class=\"hljs-literal\">null</span>,\n</span>): <span class=\"hljs-keyword\">void</span> {\n  <span class=\"hljs-title function_\">useEffectImpl</span>(\n    <span class=\"hljs-title class_\">UpdateEffect</span> | <span class=\"hljs-title class_\">PassiveEffect</span>,\n    <span class=\"hljs-title class_\">UnmountPassive</span> | <span class=\"hljs-title class_\">MountPassive</span>,\n    create,\n    inputs,\n  );\n}\n\n<span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">useEffectImpl</span>(<span class=\"hljs-params\">fiberEffectTag, hookEffectTag, create, inputs</span>): <span class=\"hljs-keyword\">void</span> {\n  currentlyRenderingFiber = <span class=\"hljs-title function_\">resolveCurrentlyRenderingFiber</span>();\n  workInProgressHook = <span class=\"hljs-title function_\">createWorkInProgressHook</span>();\n\n  <span class=\"hljs-keyword\">let</span> nextInputs = inputs !== <span class=\"hljs-literal\">undefined</span> &amp;&amp; inputs !== <span class=\"hljs-literal\">null</span> ? inputs : [create];\n  <span class=\"hljs-keyword\">let</span> destroy = <span class=\"hljs-literal\">null</span>;\n  <span class=\"hljs-keyword\">if</span> (currentHook !== <span class=\"hljs-literal\">null</span>) {\n    <span class=\"hljs-keyword\">const</span> prevEffect = currentHook.<span class=\"hljs-property\">memoizedState</span>;\n    destroy = prevEffect.<span class=\"hljs-property\">destroy</span>;\n    <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-title function_\">areHookInputsEqual</span>(nextInputs, prevEffect.<span class=\"hljs-property\">inputs</span>)) {\n      <span class=\"hljs-title function_\">pushEffect</span>(<span class=\"hljs-title class_\">NoHookEffect</span>, create, destroy, nextInputs);\n      <span class=\"hljs-keyword\">return</span>;\n    }\n  }\n\n  currentlyRenderingFiber.<span class=\"hljs-property\">effectTag</span> |= fiberEffectTag;\n  workInProgressHook.<span class=\"hljs-property\">memoizedState</span> = <span class=\"hljs-title function_\">pushEffect</span>(\n    hookEffectTag,\n    create,\n    destroy,\n    nextInputs,\n  );\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"54,99"}},{"content":"<pre data-lines=\"102,120\"><code>&#x5728;&#x4ee5;&#x4e0b;&#x4e09;&#x4e2a;&#x9636;&#x6bb5;&#x90fd;&#x4f1a;&#x8c03;&#x7528;`commitHookEffectList`&#x65b9;&#x6cd5;&#xff0c;&#x6211;&#x4eec;&#x6765;&#x770b;&#x4e00;&#x4e0b;&#xff1a;\n\n*   `commitWork`&#x4e2d;`commitHookEffectList(UnmountMutation, MountMutation, finishedWork);`\n*   `commitBeforeMutationLifeCycles`&#x4e2d;`commitHookEffectList(UnmountSnapshot, NoHookEffect, finishedWork);`\n*   `commitLifeCycles`&#x4e2d;`commitHookEffectList(UnmountLayout, MountLayout, finishedWork);`\n\n`commitHookEffectList`&#x8fd9;&#x4e2a;&#x65b9;&#x6cd5;&#x7684;&#x5185;&#x5bb9;&#x5c31;&#x662f;&#x6839;&#x636e;&#x4f20;&#x5165;&#x7684;`unmountTag`&#x548c;`mountTag`&#x6765;&#x5224;&#x65ad;&#x662f;&#x5426;&#x9700;&#x8981;&#x6267;&#x884c;&#x5bf9;&#x5e94;&#x7684;`destory`&#x548c;`create`&#x65b9;&#x6cd5;&#xff0c;&#x8fd9;&#x662f;&#x5728;&#x6bcf;&#x4e2a;`Hook`&#x5bf9;&#x8c61;&#x7684;`effect`&#x94fe;&#x4e0a;&#x7684;&#x3002;&#x6240;&#x4ee5;&#x770b;&#x8fd9;&#x90e8;&#x5206;&#x4ee3;&#x7801;&#x6700;&#x91cd;&#x8981;&#x7684;&#x5176;&#x5b9e;&#x5c31;&#x662f;&#x770b;&#x4ed6;&#x4f20;&#x5165;&#x7684;`effectTag`&#x548c;Hook&#x5bf9;&#x8c61;&#x4e0a;&#x7684;`effectTag`&#x7684;&#x5bf9;&#x6bd4;&#x3002;\n\n&#x5bf9;&#x6bd4;&#x7ed3;&#x679c;&#x5c31;&#x662f;&#xff1a;\n\n1.  `useLayoutEffect`&#x7684;`destory`&#x4f1a;&#x5728;`commitWork`&#x7684;&#x65f6;&#x5019;&#x88ab;&#x6267;&#x884c;&#xff1b;&#x800c;&#x4ed6;&#x7684;`create`&#x4f1a;&#x5728;`commitLifeCycles`&#x7684;&#x65f6;&#x5019;&#x88ab;&#x6267;&#x884c;&#x3002;\n2.  `useEffect`&#x5728;&#x8fd9;&#x4e2a;&#x6d41;&#x7a0b;&#x4e2d;&#x90fd;&#x4e0d;&#x4f1a;&#x88ab;&#x6267;&#x884c;&#x3002;\n\n&#x53ef;&#x4ee5;&#x770b;&#x51fa;&#x6765;`useLayoutEffect`&#x7684;&#x6267;&#x884c;&#x8fc7;&#x7a0b;&#x8ddf;`componentDidMount`&#x548c;`componentDidUpdate`&#x975e;&#x5e38;&#x76f8;&#x4f3c;&#xff0c;&#x6240;&#x4ee5;React&#x5b98;&#x65b9;&#x4e5f;&#x8bf4;&#x4e86;&#xff0c;&#x5982;&#x679c;&#x4f60;&#x4e00;&#x5b9a;&#x8981;&#x9009;&#x62e9;&#x4e00;&#x4e2a;&#x7c7b;&#x4f3c;&#x4e8e;&#x751f;&#x547d;&#x5468;&#x671f;&#x65b9;&#x6cd5;&#x7684;Hook&#xff0c;&#x90a3;&#x4e48;`useLayoutEffect`&#x662f;&#x4e0d;&#x4f1a;&#x9519;&#x7684;&#x90a3;&#x4e2a;&#xff0c;&#x4f46;&#x662f;&#x6211;&#x4eec;&#x63a8;&#x8350;&#x4f60;&#x4f7f;&#x7528;`useEffect`&#xff0c;&#x5728;&#x4f60;&#x6e05;&#x9664;&#x4ed6;&#x4eec;&#x7684;&#x533a;&#x522b;&#x7684;&#x524d;&#x63d0;&#x4e0b;&#xff0c;&#x540e;&#x8005;&#x662f;&#x66f4;&#x597d;&#x7684;&#x9009;&#x62e9;&#x3002;\n\n&#x90a3;&#x4e48;`useEffect`&#x4ec0;&#x4e48;&#x65f6;&#x5019;&#x88ab;&#x8c03;&#x7528;&#x5462;&#xff1f;\n\n&#x7b54;&#x6848;&#x5728;`commitRoot`&#x7684;&#x6700;&#x540e;&#xff0c;&#x4ed6;&#x7b49;&#x5176;&#x4ed6;`sideEffect`&#x5168;&#x90e8;`commit`&#x5b8c;&#x4e86;&#x4e4b;&#x540e;&#xff0c;&#x4f1a;&#x6267;&#x884c;&#x4ee5;&#x4e0b;&#x4ee3;&#x7801;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"102,120"}},{"content":"<pre data-lines=\"121,133\"><code data-lines=\"121,133\">if <span class=\"hljs-punctuation\">(</span>\n  enableHooks <span class=\"hljs-meta\">&amp;&amp;</span>\n  firstEffect !<span class=\"hljs-punctuation\">=</span><span class=\"hljs-punctuation\">=</span> <span class=\"hljs-literal\">null</span> <span class=\"hljs-meta\">&amp;&amp;</span>\n  rootWithPendingPassiveEffects !<span class=\"hljs-punctuation\">=</span><span class=\"hljs-punctuation\">=</span> <span class=\"hljs-literal\">null</span>\n<span class=\"hljs-punctuation\">)</span> {\n  let callback <span class=\"hljs-punctuation\">=</span> commitPassiveEffects.bind<span class=\"hljs-punctuation\">(</span><span class=\"hljs-literal\">null</span><span class=\"hljs-punctuation\">,</span> root<span class=\"hljs-punctuation\">,</span> firstEffect<span class=\"hljs-punctuation\">)</span><span class=\"hljs-punctuation\">;</span>\n  passiveEffectCallbackHandle <span class=\"hljs-punctuation\">=</span> Schedule_scheduleCallback<span class=\"hljs-punctuation\">(</span>callback<span class=\"hljs-punctuation\">)</span><span class=\"hljs-punctuation\">;</span>\n  passiveEffectCallback <span class=\"hljs-punctuation\">=</span> callback<span class=\"hljs-punctuation\">;</span>\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"121,133"}},{"content":"<pre data-lines=\"134,135\"><code>`rootWithPendingPassiveEffects`&#x662f;&#x5728;`commitAllLifeCycles`&#x7684;&#x65f6;&#x5019;&#x5982;&#x679c;&#x53d1;&#x73b0;&#x66f4;&#x65b0;&#x4e2d;&#x6709;`passive effect`&#x7684;&#x8282;&#x70b9;&#x7684;&#x8bdd;&#xff0c;&#x5c31;&#x7b49;&#x4e8e;`FiberRoot`&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"134,135"}},{"content":"<pre data-lines=\"136,142\"><code data-lines=\"136,142\"><span class=\"hljs-attribute\">if</span> (enableHooks &amp;&amp; effectTag &amp; Passive) {\n  <span class=\"hljs-attribute\">rootWithPendingPassiveEffects</span> = finishedRoot;\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"136,142"}},{"content":"<pre data-lines=\"143,148\"><code>&#x8fd9;&#x91cc;&#x5982;&#x679c;&#x6709;&#xff0c;&#x5219;&#x4f1a;&#x53d1;&#x8d77;&#x4e00;&#x6b21;`Schedule_scheduleCallback`&#xff0c;&#x8fd9;&#x4e2a;&#x5c31;&#x662f;&#x6211;&#x4eec;&#x4e4b;&#x524d;&#x8bb2;&#x7684;&#x5f02;&#x6b65;&#x8c03;&#x5ea6;&#x6a21;&#x5757;`Scheduler`&#x7684;&#x65b9;&#x6cd5;&#xff0c;&#x6d41;&#x7a0b;&#x8ddf;`PerformWork`&#x7c7b;&#x4f3c;&#xff0c;&#x8fd9;&#x91cc;&#x6211;&#x4eec;&#x4e0d;&#x518d;&#x91cd;&#x590d;&#x8bb2;&#x89e3;&#x3002;\n\n&#x4f46;&#x6211;&#x4eec;&#x770b;&#x5230;&#x8fd9;&#x91cc;&#x5c31;&#x6e05;&#x695a;&#x4e86;&#xff0c;`useEffect`&#x7684;`destory`&#x548c;`create`&#x90fd;&#x662f;&#x5f02;&#x6b65;&#x8c03;&#x7528;&#x7684;&#xff0c;&#x6240;&#x4ee5;&#x4ed6;&#x4eec;&#x4e0d;&#x4f1a;&#x5f71;&#x54cd;&#x672c;&#x6b21;&#x66f4;&#x65b0;&#x7684;&#x63d0;&#x4ea4;&#xff0c;&#x6240;&#x4ee5;&#x4e0d;&#x4f1a;&#x56e0;&#x4e3a;&#x5728;`effect`&#x4e2d;&#x4ea7;&#x751f;&#x4e86;&#x65b0;&#x7684;&#x66f4;&#x65b0;&#x800c;&#x5bfc;&#x81f4;&#x963b;&#x585e;DOM&#x6e32;&#x67d3;&#x7684;&#x60c5;&#x51b5;&#x3002;\n\n&#x90a3;&#x4e48;`commitPassiveEffects`&#x505a;&#x4e86;&#x5565;&#x5462;&#xff1f;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"143,148"}},{"content":"<pre data-lines=\"149,156\"><code data-lines=\"149,156\">export function <span class=\"hljs-built_in\">commitPassiveHookEffects</span>(finishedWork: Fiber): void {\n  <span class=\"hljs-built_in\">commitHookEffectList</span>(UnmountPassive, NoHookEffect, finishedWork);\n  <span class=\"hljs-built_in\">commitHookEffectList</span>(NoHookEffect, MountPassive, finishedWork);\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"149,156"}},{"content":"<pre data-lines=\"157,158\"><code>&#x6b63;&#x597d;&#x5bf9;&#x5e94;&#x4e86;`useEffect`&#x8bbe;&#x7f6e;&#x7684;`sideEffect`&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"157,158"}},{"content":"<pre data-lines=\"159,197\"><code data-lines=\"159,197\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">commitHookEffectList</span>(<span class=\"hljs-params\">\n  <span class=\"hljs-attr\">unmountTag</span>: <span class=\"hljs-built_in\">number</span>,\n  <span class=\"hljs-attr\">mountTag</span>: <span class=\"hljs-built_in\">number</span>,\n  <span class=\"hljs-attr\">finishedWork</span>: <span class=\"hljs-title class_\">Fiber</span>,\n</span>) {\n  <span class=\"hljs-keyword\">if</span> (!enableHooks) {\n    <span class=\"hljs-keyword\">return</span>;\n  }\n  <span class=\"hljs-keyword\">const</span> <span class=\"hljs-attr\">updateQueue</span>: <span class=\"hljs-title class_\">FunctionComponentUpdateQueue</span> | <span class=\"hljs-literal\">null</span> = (finishedWork.<span class=\"hljs-property\">updateQueue</span>: <span class=\"hljs-built_in\">any</span>);\n  <span class=\"hljs-keyword\">let</span> lastEffect = updateQueue !== <span class=\"hljs-literal\">null</span> ? updateQueue.<span class=\"hljs-property\">lastEffect</span> : <span class=\"hljs-literal\">null</span>;\n  <span class=\"hljs-keyword\">if</span> (lastEffect !== <span class=\"hljs-literal\">null</span>) {\n    <span class=\"hljs-keyword\">const</span> firstEffect = lastEffect.<span class=\"hljs-property\">next</span>;\n    <span class=\"hljs-keyword\">let</span> effect = firstEffect;\n    <span class=\"hljs-keyword\">do</span> {\n      <span class=\"hljs-keyword\">if</span> ((effect.<span class=\"hljs-property\">tag</span> &amp; unmountTag) !== <span class=\"hljs-title class_\">NoHookEffect</span>) {\n        \n        <span class=\"hljs-keyword\">const</span> destroy = effect.<span class=\"hljs-property\">destroy</span>;\n        effect.<span class=\"hljs-property\">destroy</span> = <span class=\"hljs-literal\">null</span>;\n        <span class=\"hljs-keyword\">if</span> (destroy !== <span class=\"hljs-literal\">null</span>) {\n          <span class=\"hljs-title function_\">destroy</span>();\n        }\n      }\n      <span class=\"hljs-keyword\">if</span> ((effect.<span class=\"hljs-property\">tag</span> &amp; mountTag) !== <span class=\"hljs-title class_\">NoHookEffect</span>) {\n        \n        <span class=\"hljs-keyword\">const</span> create = effect.<span class=\"hljs-property\">create</span>;\n        <span class=\"hljs-keyword\">let</span> destroy = <span class=\"hljs-title function_\">create</span>();\n        <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-keyword\">typeof</span> destroy !== <span class=\"hljs-string\">&apos;function&apos;</span>) {\n          destroy = <span class=\"hljs-literal\">null</span>;\n        }\n        effect.<span class=\"hljs-property\">destroy</span> = destroy;\n      }\n      effect = effect.<span class=\"hljs-property\">next</span>;\n    } <span class=\"hljs-keyword\">while</span> (effect !== firstEffect);\n  }\n}\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"159,197"}},{"content":"<img src=\"https://static.coursebetter.com/202112/Jokcy%E7%9A%84%E4%BA%8C%E7%BB%B4%E7%A0%81.png\" alt>","children":[],"payload":{"tag":"img","lines":"198,199"}},{"content":"<img src=\"https://static.coursebetter.com/202112/Jokcy%E7%9A%84%E4%BA%8C%E7%BB%B4%E7%A0%81.png\" alt>","children":[],"payload":{"tag":"img","lines":"202,203"}}],"payload":{"tag":"h1","lines":"0,1"}},{})</script>
</body>
</html>
