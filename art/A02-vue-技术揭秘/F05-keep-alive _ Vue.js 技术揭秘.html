<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets@11.11.1/styles/default.min.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.18.10/dist/browser/index.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/index.js"></script><script>(r => {
              setTimeout(r);
            })(function renderToolbar() {
  const {
    markmap,
    mm
  } = window;
  const {
    el
  } = markmap.Toolbar.create(mm);
  el.setAttribute('style', 'position:absolute;bottom:20px;right:20px');
  document.body.append(el);
})</script><script>((getMarkmap, getOptions, root2, jsonOptions) => {
              const markmap = getMarkmap();
              window.mm = markmap.Markmap.create(
                "svg#mindmap",
                (getOptions || markmap.deriveOptions)(jsonOptions),
                root2
              );
            })(() => window.markmap,null,{"content":"<a href=\"#keep-alive\">#</a> keep-alive","children":[{"content":"&#x8ba4;&#x8bc6;","children":[{"content":"<pre data-lines=\"6,7\"><code>&#x5728;&#x6211;&#x4eec;&#x7684;&#x5e73;&#x65f6;&#x5f00;&#x53d1;&#x5de5;&#x4f5c;&#x4e2d;&#xff0c;&#x7ecf;&#x5e38;&#x4e3a;&#x4e86;&#x7ec4;&#x4ef6;&#x7684;&#x7f13;&#x5b58;&#x4f18;&#x5316;&#x800c;&#x4f7f;&#x7528; `&lt;keep-alive&gt;` &#x7ec4;&#x4ef6;&#xff0c;&#x4e50;&#x6b64;&#x4e0d;&#x75b2;&#xff0c;&#x4f46;&#x5f88;&#x5c11;&#x6709;&#x4eba;&#x5173;&#x6ce8;&#x5b83;&#x7684;&#x5b9e;&#x73b0;&#x539f;&#x7406;&#xff0c;&#x4e0b;&#x9762;&#x5c31;&#x8ba9;&#x6211;&#x4eec;&#x6765;&#x4e00;&#x63a2;&#x7a76;&#x7adf;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"6,7"}}],"payload":{"tag":"h2","lines":"3,5"}},{"content":"<a href=\"#%E5%86%85%E7%BD%AE%E7%BB%84%E4%BB%B6\">#</a> &#x5185;&#x7f6e;&#x7ec4;&#x4ef6;","children":[{"content":"<pre data-lines=\"11,12\"><code>`&lt;keep-alive&gt;` &#x662f; Vue &#x6e90;&#x7801;&#x4e2d;&#x5b9e;&#x73b0;&#x7684;&#x4e00;&#x4e2a;&#x7ec4;&#x4ef6;&#xff0c;&#x4e5f;&#x5c31;&#x662f;&#x8bf4; Vue &#x6e90;&#x7801;&#x4e0d;&#x4ec5;&#x5b9e;&#x73b0;&#x4e86;&#x4e00;&#x5957;&#x7ec4;&#x4ef6;&#x5316;&#x7684;&#x673a;&#x5236;&#xff0c;&#x4e5f;&#x5b9e;&#x73b0;&#x4e86;&#x4e00;&#x4e9b;&#x5185;&#x7f6e;&#x7ec4;&#x4ef6;&#xff0c;&#x5b83;&#x7684;&#x5b9a;&#x4e49;&#x5728; `src/core/components/keep-alive.js` &#x4e2d;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"11,12"}},{"content":"<pre data-lines=\"13,87\"><code data-lines=\"13,87\">export default {\n  name: <span class=\"hljs-string\">&apos;keep-alive&apos;</span>,\n  <span class=\"hljs-keyword\">abstract</span>: <span class=\"hljs-literal\">true</span>,\n\n  props: {\n    include: patternTypes,\n    exclude: patternTypes,\n    max: [String, Number]\n  },\n\n  created () {\n    <span class=\"hljs-keyword\">this</span>.cache = Object.create(<span class=\"hljs-literal\">null</span>)\n    <span class=\"hljs-keyword\">this</span>.keys = []\n  },\n\n  destroyed () {\n    <span class=\"hljs-keyword\">for</span> (<span class=\"hljs-keyword\">const</span> key <span class=\"hljs-keyword\">in</span> <span class=\"hljs-keyword\">this</span>.cache) {\n      pruneCacheEntry(<span class=\"hljs-keyword\">this</span>.cache, key, <span class=\"hljs-keyword\">this</span>.keys)\n    }\n  },\n\n  mounted () {\n    <span class=\"hljs-keyword\">this</span>.&#x24;watch(<span class=\"hljs-string\">&apos;include&apos;</span>, <span class=\"hljs-keyword\">val</span> =&gt; {\n      pruneCache(<span class=\"hljs-keyword\">this</span>, name =&gt; matches(<span class=\"hljs-keyword\">val</span>, name))\n    })\n    <span class=\"hljs-keyword\">this</span>.&#x24;watch(<span class=\"hljs-string\">&apos;exclude&apos;</span>, <span class=\"hljs-keyword\">val</span> =&gt; {\n      pruneCache(<span class=\"hljs-keyword\">this</span>, name =&gt; !matches(<span class=\"hljs-keyword\">val</span>, name))\n    })\n  },\n\n  render () {\n    <span class=\"hljs-keyword\">const</span> slot = <span class=\"hljs-keyword\">this</span>.&#x24;slots.default\n    <span class=\"hljs-keyword\">const</span> vnode: VNode = getFirstComponentChild(slot)\n    <span class=\"hljs-keyword\">const</span> componentOptions: ?VNodeComponentOptions = vnode &amp;&amp; vnode.componentOptions\n    <span class=\"hljs-keyword\">if</span> (componentOptions) {\n      <span class=\"hljs-comment\">// check pattern</span>\n      <span class=\"hljs-keyword\">const</span> name: ?string = getComponentName(componentOptions)\n      <span class=\"hljs-keyword\">const</span> { include, exclude } = <span class=\"hljs-keyword\">this</span>\n      <span class=\"hljs-keyword\">if</span> (\n        <span class=\"hljs-comment\">// not included</span>\n        (include &amp;&amp; (!name || !matches(include, name))) ||\n        <span class=\"hljs-comment\">// excluded</span>\n        (exclude &amp;&amp; name &amp;&amp; matches(exclude, name))\n      ) {\n        <span class=\"hljs-keyword\">return</span> vnode\n      }\n\n      <span class=\"hljs-keyword\">const</span> { cache, keys } = <span class=\"hljs-keyword\">this</span>\n      <span class=\"hljs-keyword\">const</span> key: ?string = vnode.key == <span class=\"hljs-literal\">null</span>\n        <span class=\"hljs-comment\">// same constructor may get registered as different local components</span>\n        <span class=\"hljs-comment\">// so cid alone is not enough (#3269)</span>\n        ? componentOptions.Ctor.cid + (componentOptions.tag ? `::&#x24;{componentOptions.tag}` : <span class=\"hljs-string\">&apos;&apos;</span>)\n        : vnode.key\n      <span class=\"hljs-keyword\">if</span> (cache[key]) {\n        vnode.componentInstance = cache[key].componentInstance\n        <span class=\"hljs-comment\">// make current key freshest</span>\n        remove(keys, key)\n        keys.push(key)\n      } <span class=\"hljs-keyword\">else</span> {\n        cache[key] = vnode\n        keys.push(key)\n        <span class=\"hljs-comment\">// prune oldest entry</span>\n        <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-keyword\">this</span>.max &amp;&amp; keys.length &gt; parseInt(<span class=\"hljs-keyword\">this</span>.max)) {\n          pruneCacheEntry(cache, keys[<span class=\"hljs-number\">0</span>], keys, <span class=\"hljs-keyword\">this</span>._vnode)\n        }\n      }\n\n      vnode.<span class=\"hljs-keyword\">data</span>.keepAlive = <span class=\"hljs-literal\">true</span>\n    }\n    <span class=\"hljs-keyword\">return</span> vnode || (slot &amp;&amp; slot[<span class=\"hljs-number\">0</span>])\n  }\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"13,87"}},{"content":"<pre data-lines=\"88,89\"><code>&#x53ef;&#x4ee5;&#x770b;&#x5230; `&lt;keep-alive&gt;` &#x7ec4;&#x4ef6;&#x7684;&#x5b9e;&#x73b0;&#x4e5f;&#x662f;&#x4e00;&#x4e2a;&#x5bf9;&#x8c61;&#xff0c;&#x6ce8;&#x610f;&#x5b83;&#x6709;&#x4e00;&#x4e2a;&#x5c5e;&#x6027; `abstract` &#x4e3a; true&#xff0c;&#x662f;&#x4e00;&#x4e2a;&#x62bd;&#x8c61;&#x7ec4;&#x4ef6;&#xff0c;Vue &#x7684;&#x6587;&#x6863;&#x6ca1;&#x6709;&#x63d0;&#x8fd9;&#x4e2a;&#x6982;&#x5ff5;&#xff0c;&#x5b9e;&#x9645;&#x4e0a;&#x5b83;&#x5728;&#x7ec4;&#x4ef6;&#x5b9e;&#x4f8b;&#x5efa;&#x7acb;&#x7236;&#x5b50;&#x5173;&#x7cfb;&#x7684;&#x65f6;&#x5019;&#x4f1a;&#x88ab;&#x5ffd;&#x7565;&#xff0c;&#x53d1;&#x751f;&#x5728; `initLifecycle` &#x7684;&#x8fc7;&#x7a0b;&#x4e2d;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"88,89"}},{"content":"<pre data-lines=\"90,101\"><code data-lines=\"90,101\"><span class=\"hljs-comment\">// locate first non-abstract parent</span>\nlet parent = <span class=\"hljs-keyword\">options</span>.parent\n<span class=\"hljs-keyword\">if</span> (parent &amp;&amp; !<span class=\"hljs-keyword\">options</span>.abstract) {\n  <span class=\"hljs-keyword\">while</span> (parent.<span class=\"hljs-symbol\">&#x24;</span><span class=\"hljs-keyword\">options</span>.abstract &amp;&amp; parent.<span class=\"hljs-symbol\">&#x24;</span>parent) {\n    parent = parent.<span class=\"hljs-symbol\">&#x24;</span>parent\n  }\n  parent.<span class=\"hljs-symbol\">&#x24;</span>children.push(vm)\n}\nvm.<span class=\"hljs-symbol\">&#x24;</span>parent = parent \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"90,101"}},{"content":"<pre data-lines=\"102,107\"><code>`&lt;keep-alive&gt;` &#x5728; `created` &#x94a9;&#x5b50;&#x91cc;&#x5b9a;&#x4e49;&#x4e86; `this.cache` &#x548c; `this.keys`&#xff0c;&#x672c;&#x8d28;&#x4e0a;&#x5b83;&#x5c31;&#x662f;&#x53bb;&#x7f13;&#x5b58;&#x5df2;&#x7ecf;&#x521b;&#x5efa;&#x8fc7;&#x7684; `vnode`&#x3002;&#x5b83;&#x7684; `props` &#x5b9a;&#x4e49;&#x4e86; `include`&#xff0c;`exclude`&#xff0c;&#x5b83;&#x4eec;&#x53ef;&#x4ee5;&#x5b57;&#x7b26;&#x4e32;&#x6216;&#x8005;&#x8868;&#x8fbe;&#x5f0f;&#xff0c;`include` &#x8868;&#x793a;&#x53ea;&#x6709;&#x5339;&#x914d;&#x7684;&#x7ec4;&#x4ef6;&#x4f1a;&#x88ab;&#x7f13;&#x5b58;&#xff0c;&#x800c; `exclude` &#x8868;&#x793a;&#x4efb;&#x4f55;&#x5339;&#x914d;&#x7684;&#x7ec4;&#x4ef6;&#x90fd;&#x4e0d;&#x4f1a;&#x88ab;&#x7f13;&#x5b58;&#xff0c;`props` &#x8fd8;&#x5b9a;&#x4e49;&#x4e86; `max`&#xff0c;&#x5b83;&#x8868;&#x793a;&#x7f13;&#x5b58;&#x7684;&#x5927;&#x5c0f;&#xff0c;&#x56e0;&#x4e3a;&#x6211;&#x4eec;&#x662f;&#x7f13;&#x5b58;&#x7684; `vnode` &#x5bf9;&#x8c61;&#xff0c;&#x5b83;&#x4e5f;&#x4f1a;&#x6301;&#x6709; DOM&#xff0c;&#x5f53;&#x6211;&#x4eec;&#x7f13;&#x5b58;&#x5f88;&#x591a;&#x7684;&#x65f6;&#x5019;&#xff0c;&#x4f1a;&#x6bd4;&#x8f83;&#x5360;&#x7528;&#x5185;&#x5b58;&#xff0c;&#x6240;&#x4ee5;&#x8be5;&#x914d;&#x7f6e;&#x5141;&#x8bb8;&#x6211;&#x4eec;&#x6307;&#x5b9a;&#x7f13;&#x5b58;&#x5927;&#x5c0f;&#x3002;\n\n`&lt;keep-alive&gt;` &#x76f4;&#x63a5;&#x5b9e;&#x73b0;&#x4e86; `render` &#x51fd;&#x6570;&#xff0c;&#x800c;&#x4e0d;&#x662f;&#x6211;&#x4eec;&#x5e38;&#x89c4;&#x6a21;&#x677f;&#x7684;&#x65b9;&#x5f0f;&#xff0c;&#x6267;&#x884c; `&lt;keep-alive&gt;` &#x7ec4;&#x4ef6;&#x6e32;&#x67d3;&#x7684;&#x65f6;&#x5019;&#xff0c;&#x5c31;&#x4f1a;&#x6267;&#x884c;&#x5230;&#x8fd9;&#x4e2a; `render` &#x51fd;&#x6570;&#xff0c;&#x63a5;&#x4e0b;&#x6765;&#x6211;&#x4eec;&#x5206;&#x6790;&#x4e00;&#x4e0b;&#x5b83;&#x7684;&#x5b9e;&#x73b0;&#x3002;\n\n&#x9996;&#x5148;&#x83b7;&#x53d6;&#x7b2c;&#x4e00;&#x4e2a;&#x5b50;&#x5143;&#x7d20;&#x7684; `vnode`&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"102,107"}},{"content":"<pre data-lines=\"108,112\"><code data-lines=\"108,112\"><span class=\"hljs-type\">const</span> slot = <span class=\"hljs-keyword\">this</span>.&#x24;slots.<span class=\"hljs-keyword\">default</span>\n<span class=\"hljs-type\">const</span> vnode: VNode = <span class=\"hljs-built_in\">getFirstComponentChild</span>(slot) \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"108,112"}},{"content":"<pre data-lines=\"113,116\"><code>&#x7531;&#x4e8e;&#x6211;&#x4eec;&#x4e5f;&#x662f;&#x5728; `&lt;keep-alive&gt;` &#x6807;&#x7b7e;&#x5185;&#x90e8;&#x5199; DOM&#xff0c;&#x6240;&#x4ee5;&#x53ef;&#x4ee5;&#x5148;&#x83b7;&#x53d6;&#x5230;&#x5b83;&#x7684;&#x9ed8;&#x8ba4;&#x63d2;&#x69fd;&#xff0c;&#x7136;&#x540e;&#x518d;&#x83b7;&#x53d6;&#x5230;&#x5b83;&#x7684;&#x7b2c;&#x4e00;&#x4e2a;&#x5b50;&#x8282;&#x70b9;&#x3002;`&lt;keep-alive&gt;` &#x53ea;&#x5904;&#x7406;&#x7b2c;&#x4e00;&#x4e2a;&#x5b50;&#x5143;&#x7d20;&#xff0c;&#x6240;&#x4ee5;&#x4e00;&#x822c;&#x548c;&#x5b83;&#x642d;&#x914d;&#x4f7f;&#x7528;&#x7684;&#x6709; `component` &#x52a8;&#x6001;&#x7ec4;&#x4ef6;&#x6216;&#x8005;&#x662f; `router-view`&#xff0c;&#x8fd9;&#x70b9;&#x8981;&#x7262;&#x8bb0;&#x3002;\n\n&#x7136;&#x540e;&#x53c8;&#x5224;&#x65ad;&#x4e86;&#x5f53;&#x524d;&#x7ec4;&#x4ef6;&#x7684;&#x540d;&#x79f0;&#x548c; `include`&#x3001;`exclude` &#x7684;&#x5173;&#x7cfb;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"113,116"}},{"content":"<pre data-lines=\"117,141\"><code data-lines=\"117,141\">// <span class=\"hljs-keyword\">check</span> pattern\nconst <span class=\"hljs-type\">name</span>: ?string = getComponentName(componentOptions)\nconst { <span class=\"hljs-keyword\">include</span>, <span class=\"hljs-keyword\">exclude</span> } = this\n<span class=\"hljs-keyword\">if</span> (\n  // <span class=\"hljs-keyword\">not</span> included\n  (<span class=\"hljs-keyword\">include</span> &amp;&amp; (!<span class=\"hljs-type\">name</span> || !matches(<span class=\"hljs-keyword\">include</span>, <span class=\"hljs-type\">name</span>))) ||\n  // excluded\n  (<span class=\"hljs-keyword\">exclude</span> &amp;&amp; <span class=\"hljs-type\">name</span> &amp;&amp; matches(<span class=\"hljs-keyword\">exclude</span>, <span class=\"hljs-type\">name</span>))\n) {\n  <span class=\"hljs-keyword\">return</span> vnode\n}\n\n<span class=\"hljs-keyword\">function</span> matches (pattern: string | RegExp | <span class=\"hljs-keyword\">Array</span>&lt;string&gt;, <span class=\"hljs-type\">name</span>: string): <span class=\"hljs-type\">boolean</span> {\n  <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-keyword\">Array</span>.isArray(pattern)) {\n    <span class=\"hljs-keyword\">return</span> pattern.indexOf(<span class=\"hljs-type\">name</span>) &gt; <span class=\"hljs-number\">-1</span>\n  } <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span> (typeof pattern === <span class=\"hljs-string\">&apos;string&apos;</span>) {\n    <span class=\"hljs-keyword\">return</span> pattern.split(<span class=\"hljs-string\">&apos;,&apos;</span>).indexOf(<span class=\"hljs-type\">name</span>) &gt; <span class=\"hljs-number\">-1</span>\n  } <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span> (isRegExp(pattern)) {\n    <span class=\"hljs-keyword\">return</span> pattern.test(<span class=\"hljs-type\">name</span>)\n  }\n  <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">false</span>\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"117,141"}},{"content":"<pre data-lines=\"142,143\"><code>`matches` &#x7684;&#x903b;&#x8f91;&#x5f88;&#x7b80;&#x5355;&#xff0c;&#x5c31;&#x662f;&#x505a;&#x5339;&#x914d;&#xff0c;&#x5206;&#x522b;&#x5904;&#x7406;&#x4e86;&#x6570;&#x7ec4;&#x3001;&#x5b57;&#x7b26;&#x4e32;&#x3001;&#x6b63;&#x5219;&#x8868;&#x8fbe;&#x5f0f;&#x7684;&#x60c5;&#x51b5;&#xff0c;&#x4e5f;&#x5c31;&#x662f;&#x8bf4;&#x6211;&#x4eec;&#x5e73;&#x65f6;&#x4f20;&#x7684; `include` &#x548c; `exclude` &#x53ef;&#x4ee5;&#x662f;&#x8fd9;&#x4e09;&#x79cd;&#x7c7b;&#x578b;&#x7684;&#x4efb;&#x610f;&#x4e00;&#x79cd;&#x3002;&#x5e76;&#x4e14;&#x6211;&#x4eec;&#x7684;&#x7ec4;&#x4ef6;&#x540d;&#x5982;&#x679c;&#x6ee1;&#x8db3;&#x4e86;&#x914d;&#x7f6e; `include` &#x4e14;&#x4e0d;&#x5339;&#x914d;&#x6216;&#x8005;&#x662f;&#x914d;&#x7f6e;&#x4e86; `exclude` &#x4e14;&#x5339;&#x914d;&#xff0c;&#x90a3;&#x4e48;&#x5c31;&#x76f4;&#x63a5;&#x8fd4;&#x56de;&#x8fd9;&#x4e2a;&#x7ec4;&#x4ef6;&#x7684; `vnode`&#xff0c;&#x5426;&#x5219;&#x7684;&#x8bdd;&#x8d70;&#x4e0b;&#x4e00;&#x6b65;&#x7f13;&#x5b58;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"142,143"}},{"content":"<pre data-lines=\"144,165\"><code data-lines=\"144,165\">const { cache, <span class=\"hljs-built_in\">keys</span> } = this\nconst <span class=\"hljs-built_in\">key</span>: ?<span class=\"hljs-built_in\">string</span> = vnode.<span class=\"hljs-built_in\">key</span> == <span class=\"hljs-built_in\">null</span>\n  <span class=\"hljs-comment\">// same constructor may get registered as different local components</span>\n  <span class=\"hljs-comment\">// so cid alone is not enough (#3269)</span>\n  ? componentOptions.Ctor.cid + (componentOptions.tag ? `::&#x24;{componentOptions.tag}` : &apos;&apos;)\n  : vnode.<span class=\"hljs-built_in\">key</span>\nif (cache[<span class=\"hljs-built_in\">key</span>]) {\n  vnode.componentInstance = cache[<span class=\"hljs-built_in\">key</span>].componentInstance\n  <span class=\"hljs-comment\">// make current key freshest</span>\n  remove(<span class=\"hljs-built_in\">keys</span>, <span class=\"hljs-built_in\">key</span>)\n  <span class=\"hljs-built_in\">keys</span>.push(<span class=\"hljs-built_in\">key</span>)\n} else {\n  cache[<span class=\"hljs-built_in\">key</span>] = vnode\n  <span class=\"hljs-built_in\">keys</span>.push(<span class=\"hljs-built_in\">key</span>)\n  <span class=\"hljs-comment\">// prune oldest entry</span>\n  if (this.<span class=\"hljs-built_in\">max</span> &amp;&amp; <span class=\"hljs-built_in\">keys</span>.length &gt; parseInt(this.<span class=\"hljs-built_in\">max</span>)) {\n    pruneCacheEntry(cache, <span class=\"hljs-built_in\">keys</span>[<span class=\"hljs-number\">0</span>], <span class=\"hljs-built_in\">keys</span>, this._vnode)\n  }\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"144,165"}},{"content":"<pre data-lines=\"166,167\"><code>&#x8fd9;&#x90e8;&#x5206;&#x903b;&#x8f91;&#x5f88;&#x7b80;&#x5355;&#xff0c;&#x5982;&#x679c;&#x547d;&#x4e2d;&#x7f13;&#x5b58;&#xff0c;&#x5219;&#x76f4;&#x63a5;&#x4ece;&#x7f13;&#x5b58;&#x4e2d;&#x62ff; `vnode` &#x7684;&#x7ec4;&#x4ef6;&#x5b9e;&#x4f8b;&#xff0c;&#x5e76;&#x4e14;&#x91cd;&#x65b0;&#x8c03;&#x6574;&#x4e86; key &#x7684;&#x987a;&#x5e8f;&#x653e;&#x5728;&#x4e86;&#x6700;&#x540e;&#x4e00;&#x4e2a;&#xff1b;&#x5426;&#x5219;&#x628a; `vnode` &#x8bbe;&#x7f6e;&#x8fdb;&#x7f13;&#x5b58;&#xff0c;&#x6700;&#x540e;&#x8fd8;&#x6709;&#x4e00;&#x4e2a;&#x903b;&#x8f91;&#xff0c;&#x5982;&#x679c;&#x914d;&#x7f6e;&#x4e86; `max` &#x5e76;&#x4e14;&#x7f13;&#x5b58;&#x7684;&#x957f;&#x5ea6;&#x8d85;&#x8fc7;&#x4e86; `this.max`&#xff0c;&#x8fd8;&#x8981;&#x4ece;&#x7f13;&#x5b58;&#x4e2d;&#x5220;&#x9664;&#x7b2c;&#x4e00;&#x4e2a;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"166,167"}},{"content":"<pre data-lines=\"168,183\"><code data-lines=\"168,183\">function pruneCacheEntry (\n  cache: VNodeCache,\n  <span class=\"hljs-built_in\">key</span>: <span class=\"hljs-built_in\">string</span>,\n  <span class=\"hljs-built_in\">keys</span>: Array&lt;<span class=\"hljs-built_in\">string</span>&gt;,\n  current?: VNode\n) {\n  const cached = cache[<span class=\"hljs-built_in\">key</span>]\n  if (cached &amp;&amp; (!current || cached.tag !== current.tag)) {\n    cached.componentInstance.&#x24;destroy()\n  }\n  cache[<span class=\"hljs-built_in\">key</span>] = <span class=\"hljs-built_in\">null</span> \n  remove(<span class=\"hljs-built_in\">keys</span>, <span class=\"hljs-built_in\">key</span>)\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"168,183"}},{"content":"<pre data-lines=\"184,189\"><code>&#x9664;&#x4e86;&#x4ece;&#x7f13;&#x5b58;&#x4e2d;&#x5220;&#x9664;&#x5916;&#xff0c;&#x8fd8;&#x8981;&#x5224;&#x65ad;&#x5982;&#x679c;&#x8981;&#x5220;&#x9664;&#x7684;&#x7f13;&#x5b58;&#x5e76;&#x7684;&#x7ec4;&#x4ef6; `tag` &#x4e0d;&#x662f;&#x5f53;&#x524d;&#x6e32;&#x67d3;&#x7ec4;&#x4ef6; `tag`&#xff0c;&#x4e5f;&#x6267;&#x884c;&#x5220;&#x9664;&#x7f13;&#x5b58;&#x7684;&#x7ec4;&#x4ef6;&#x5b9e;&#x4f8b;&#x7684; `&#x24;destroy` &#x65b9;&#x6cd5;&#x3002;\n\n&#x6700;&#x540e;&#x8bbe;&#x7f6e; `vnode.data.keepAlive = true` &#xff0c;&#x8fd9;&#x4e2a;&#x4f5c;&#x7528;&#x7a0d;&#x540e;&#x6211;&#x4eec;&#x4ecb;&#x7ecd;&#x3002;\n\n&#x6ce8;&#x610f;&#xff0c;`&lt;keep-alive&gt;` &#x7ec4;&#x4ef6;&#x4e5f;&#x662f;&#x4e3a;&#x89c2;&#x6d4b; `include` &#x548c; `exclude` &#x7684;&#x53d8;&#x5316;&#xff0c;&#x5bf9;&#x7f13;&#x5b58;&#x505a;&#x5904;&#x7406;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"184,189"}},{"content":"<pre data-lines=\"190,213\"><code data-lines=\"190,213\"><span class=\"hljs-attr\">watch</span>: {\n  <span class=\"hljs-title function_\">include</span> (<span class=\"hljs-attr\">val</span>: <span class=\"hljs-built_in\">string</span> | <span class=\"hljs-title class_\">RegExp</span> | <span class=\"hljs-title class_\">Array</span>&lt;<span class=\"hljs-built_in\">string</span>&gt;) {\n    <span class=\"hljs-title function_\">pruneCache</span>(<span class=\"hljs-variable language_\">this</span>, <span class=\"hljs-function\"><span class=\"hljs-params\">name</span> =&gt;</span> <span class=\"hljs-title function_\">matches</span>(val, name))\n  },\n  <span class=\"hljs-title function_\">exclude</span> (<span class=\"hljs-attr\">val</span>: <span class=\"hljs-built_in\">string</span> | <span class=\"hljs-title class_\">RegExp</span> | <span class=\"hljs-title class_\">Array</span>&lt;<span class=\"hljs-built_in\">string</span>&gt;) {\n    <span class=\"hljs-title function_\">pruneCache</span>(<span class=\"hljs-variable language_\">this</span>, <span class=\"hljs-function\"><span class=\"hljs-params\">name</span> =&gt;</span> !<span class=\"hljs-title function_\">matches</span>(val, name))\n  }\n}\n\n<span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">pruneCache</span> (<span class=\"hljs-params\"><span class=\"hljs-attr\">keepAliveInstance</span>: <span class=\"hljs-built_in\">any</span>, <span class=\"hljs-attr\">filter</span>: <span class=\"hljs-title class_\">Function</span></span>) {\n  <span class=\"hljs-keyword\">const</span> { cache, keys, _vnode } = keepAliveInstance\n  <span class=\"hljs-keyword\">for</span> (<span class=\"hljs-keyword\">const</span> key <span class=\"hljs-keyword\">in</span> cache) {\n    <span class=\"hljs-keyword\">const</span> <span class=\"hljs-attr\">cachedNode</span>: ?<span class=\"hljs-title class_\">VNode</span> = cache[key]\n    <span class=\"hljs-keyword\">if</span> (cachedNode) {\n      <span class=\"hljs-keyword\">const</span> <span class=\"hljs-attr\">name</span>: ?<span class=\"hljs-built_in\">string</span> = <span class=\"hljs-title function_\">getComponentName</span>(cachedNode.<span class=\"hljs-property\">componentOptions</span>)\n      <span class=\"hljs-keyword\">if</span> (name &amp;&amp; !<span class=\"hljs-title function_\">filter</span>(name)) {\n        <span class=\"hljs-title function_\">pruneCacheEntry</span>(cache, key, keys, _vnode)\n      }\n    }\n  }\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"190,213"}},{"content":"<pre data-lines=\"214,215\"><code>&#x903b;&#x8f91;&#x5f88;&#x7b80;&#x5355;&#xff0c;&#x89c2;&#x6d4b;&#x4ed6;&#x4eec;&#x7684;&#x53d8;&#x5316;&#x6267;&#x884c; `pruneCache` &#x51fd;&#x6570;&#xff0c;&#x5176;&#x5b9e;&#x5c31;&#x662f;&#x5bf9; `cache` &#x505a;&#x904d;&#x5386;&#xff0c;&#x53d1;&#x73b0;&#x7f13;&#x5b58;&#x7684;&#x8282;&#x70b9;&#x540d;&#x79f0;&#x548c;&#x65b0;&#x7684;&#x89c4;&#x5219;&#x6ca1;&#x6709;&#x5339;&#x914d;&#x4e0a;&#x7684;&#x65f6;&#x5019;&#xff0c;&#x5c31;&#x628a;&#x8fd9;&#x4e2a;&#x7f13;&#x5b58;&#x8282;&#x70b9;&#x4ece;&#x7f13;&#x5b58;&#x4e2d;&#x6458;&#x9664;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"214,215"}}],"payload":{"tag":"h2","lines":"8,10"}},{"content":"<a href=\"#%E7%BB%84%E4%BB%B6%E6%B8%B2%E6%9F%93\">#</a> &#x7ec4;&#x4ef6;&#x6e32;&#x67d3;","children":[{"content":"<a href=\"#%E9%A6%96%E6%AC%A1%E6%B8%B2%E6%9F%93\">#</a> &#x9996;&#x6b21;&#x6e32;&#x67d3;","children":[{"content":"<pre data-lines=\"264,265\"><code>&#x6211;&#x4eec;&#x77e5;&#x9053; Vue &#x7684;&#x6e32;&#x67d3;&#x6700;&#x540e;&#x90fd;&#x4f1a;&#x5230; `patch` &#x8fc7;&#x7a0b;&#xff0c;&#x800c;&#x7ec4;&#x4ef6;&#x7684; `patch` &#x8fc7;&#x7a0b;&#x4f1a;&#x6267;&#x884c; `createComponent` &#x65b9;&#x6cd5;&#xff0c;&#x5b83;&#x7684;&#x5b9a;&#x4e49;&#x5728; `src/core/vdom/patch.js` &#x4e2d;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"264,265"}},{"content":"<pre data-lines=\"266,289\"><code data-lines=\"266,289\">function createComponent (vnode, insertedVnodeQueue, parentElm, refElm) {\n  let <span class=\"hljs-selector-tag\">i</span> = vnode<span class=\"hljs-selector-class\">.data</span>\n  <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-built_in\">isDef</span>(i)) {\n    const isReactivated = <span class=\"hljs-built_in\">isDef</span>(vnode.componentInstance) &amp;&amp; <span class=\"hljs-selector-tag\">i</span><span class=\"hljs-selector-class\">.keepAlive</span>\n    <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-built_in\">isDef</span>(<span class=\"hljs-selector-tag\">i</span> = <span class=\"hljs-selector-tag\">i</span>.hook) &amp;&amp; <span class=\"hljs-built_in\">isDef</span>(<span class=\"hljs-selector-tag\">i</span> = <span class=\"hljs-selector-tag\">i</span>.init)) {\n      <span class=\"hljs-selector-tag\">i</span>(vnode, false <span class=\"hljs-comment\">/* hydrating */</span>)\n    }\n    <span class=\"hljs-comment\">// after calling the init hook, if the vnode is a child component</span>\n    <span class=\"hljs-comment\">// it should&apos;ve created a child instance and mounted it. the child</span>\n    <span class=\"hljs-comment\">// component also has set the placeholder vnode&apos;s elm.</span>\n    <span class=\"hljs-comment\">// in that case we can just return the element and be done.</span>\n    <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-built_in\">isDef</span>(vnode.componentInstance)) {\n      <span class=\"hljs-built_in\">initComponent</span>(vnode, insertedVnodeQueue)\n      <span class=\"hljs-built_in\">insert</span>(parentElm, vnode<span class=\"hljs-selector-class\">.elm</span>, refElm)\n      <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-built_in\">isTrue</span>(isReactivated)) {\n        <span class=\"hljs-built_in\">reactivateComponent</span>(vnode, insertedVnodeQueue, parentElm, refElm)\n      }\n      return true\n    }\n  }\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"266,289"}},{"content":"<pre data-lines=\"290,291\"><code>`createComponent` &#x5b9a;&#x4e49;&#x4e86; `isReactivated` &#x7684;&#x53d8;&#x91cf;&#xff0c;&#x5b83;&#x662f;&#x6839;&#x636e; `vnode.componentInstance` &#x4ee5;&#x53ca; `vnode.data.keepAlive` &#x7684;&#x5224;&#x65ad;&#xff0c;&#x7b2c;&#x4e00;&#x6b21;&#x6e32;&#x67d3;&#x7684;&#x65f6;&#x5019;&#xff0c;`vnode.componentInstance` &#x4e3a; `undefined`&#xff0c;`vnode.data.keepAlive` &#x4e3a; true&#xff0c;&#x56e0;&#x4e3a;&#x5b83;&#x7684;&#x7236;&#x7ec4;&#x4ef6; `&lt;keep-alive&gt;` &#x7684; `render` &#x51fd;&#x6570;&#x4f1a;&#x5148;&#x6267;&#x884c;&#xff0c;&#x90a3;&#x4e48;&#x8be5; `vnode` &#x7f13;&#x5b58;&#x5230;&#x5185;&#x5b58;&#x4e2d;&#xff0c;&#x5e76;&#x4e14;&#x8bbe;&#x7f6e; `vnode.data.keepAlive` &#x4e3a; true&#xff0c;&#x56e0;&#x6b64; `isReactivated` &#x4e3a; `false`&#xff0c;&#x90a3;&#x4e48;&#x8d70;&#x6b63;&#x5e38;&#x7684; `init` &#x7684;&#x94a9;&#x5b50;&#x51fd;&#x6570;&#x6267;&#x884c;&#x7ec4;&#x4ef6;&#x7684; `mount`&#x3002;&#x5f53; `vnode` &#x5df2;&#x7ecf;&#x6267;&#x884c;&#x5b8c; `patch` &#x540e;&#xff0c;&#x6267;&#x884c; `initComponent` &#x51fd;&#x6570;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"290,291"}},{"content":"<pre data-lines=\"292,311\"><code data-lines=\"292,311\">function initComponent (vnode, insertedVnodeQueue) {\n  <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-built_in\">isDef</span>(vnode<span class=\"hljs-selector-class\">.data</span>.pendingInsert)) {\n    insertedVnodeQueue<span class=\"hljs-selector-class\">.push</span><span class=\"hljs-selector-class\">.apply</span>(insertedVnodeQueue, vnode<span class=\"hljs-selector-class\">.data</span>.pendingInsert)\n    vnode<span class=\"hljs-selector-class\">.data</span><span class=\"hljs-selector-class\">.pendingInsert</span> = null\n  }\n  vnode<span class=\"hljs-selector-class\">.elm</span> = vnode<span class=\"hljs-selector-class\">.componentInstance</span>.<span class=\"hljs-variable\">&#x24;el</span>\n  <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-built_in\">isPatchable</span>(vnode)) {\n    <span class=\"hljs-built_in\">invokeCreateHooks</span>(vnode, insertedVnodeQueue)\n    <span class=\"hljs-built_in\">setScope</span>(vnode)\n  } <span class=\"hljs-keyword\">else</span> {\n    <span class=\"hljs-comment\">// empty component root.</span>\n    <span class=\"hljs-comment\">// skip all element-related modules except for ref (#3455)</span>\n    <span class=\"hljs-built_in\">registerRef</span>(vnode)\n    <span class=\"hljs-comment\">// make sure to invoke the insert hook</span>\n    insertedVnodeQueue<span class=\"hljs-selector-class\">.push</span>(vnode)\n  }\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"292,311"}},{"content":"<pre data-lines=\"312,315\"><code>&#x8fd9;&#x91cc;&#x4f1a;&#x6709; `vnode.elm` &#x7f13;&#x5b58;&#x4e86; `vnode` &#x521b;&#x5efa;&#x751f;&#x6210;&#x7684; DOM &#x8282;&#x70b9;&#x3002;&#x6240;&#x4ee5;&#x5bf9;&#x4e8e;&#x9996;&#x6b21;&#x6e32;&#x67d3;&#x800c;&#x8a00;&#xff0c;&#x9664;&#x4e86;&#x5728; `&lt;keep-alive&gt;` &#x4e2d;&#x5efa;&#x7acb;&#x7f13;&#x5b58;&#xff0c;&#x548c;&#x666e;&#x901a;&#x7ec4;&#x4ef6;&#x6e32;&#x67d3;&#x6ca1;&#x4ec0;&#x4e48;&#x533a;&#x522b;&#x3002;\n\n&#x6240;&#x4ee5;&#x5bf9;&#x6211;&#x4eec;&#x7684;&#x4f8b;&#x5b50;&#xff0c;&#x521d;&#x59cb;&#x5316;&#x6e32;&#x67d3; `A` &#x7ec4;&#x4ef6;&#x4ee5;&#x53ca;&#x7b2c;&#x4e00;&#x6b21;&#x70b9;&#x51fb; `switch` &#x6e32;&#x67d3; `B` &#x7ec4;&#x4ef6;&#xff0c;&#x90fd;&#x662f;&#x9996;&#x6b21;&#x6e32;&#x67d3;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"312,315"}}],"payload":{"tag":"h3","lines":"262,263"}},{"content":"<a href=\"#%E7%BC%93%E5%AD%98%E6%B8%B2%E6%9F%93\">#</a> &#x7f13;&#x5b58;&#x6e32;&#x67d3;","children":[{"content":"<pre data-lines=\"318,323\"><code>&#x5f53;&#x6211;&#x4eec;&#x4ece; `B` &#x7ec4;&#x4ef6;&#x518d;&#x6b21;&#x70b9;&#x51fb; `switch` &#x5207;&#x6362;&#x5230; `A` &#x7ec4;&#x4ef6;&#xff0c;&#x5c31;&#x4f1a;&#x547d;&#x4e2d;&#x7f13;&#x5b58;&#x6e32;&#x67d3;&#x3002;\n\n&#x6211;&#x4eec;&#x4e4b;&#x524d;&#x5206;&#x6790;&#x8fc7;&#xff0c;&#x5f53;&#x6570;&#x636e;&#x53d1;&#x9001;&#x53d8;&#x5316;&#xff0c;&#x5728; `patch` &#x7684;&#x8fc7;&#x7a0b;&#x4e2d;&#x4f1a;&#x6267;&#x884c; `patchVnode` &#x7684;&#x903b;&#x8f91;&#xff0c;&#x5b83;&#x4f1a;&#x5bf9;&#x6bd4;&#x65b0;&#x65e7; `vnode` &#x8282;&#x70b9;&#xff0c;&#x751a;&#x81f3;&#x5bf9;&#x6bd4;&#x5b83;&#x4eec;&#x7684;&#x5b50;&#x8282;&#x70b9;&#x53bb;&#x505a;&#x66f4;&#x65b0;&#x903b;&#x8f91;&#xff0c;&#x4f46;&#x662f;&#x5bf9;&#x4e8e;&#x7ec4;&#x4ef6; `vnode` &#x800c;&#x8a00;&#xff0c;&#x662f;&#x6ca1;&#x6709; `children` &#x7684;&#xff0c;&#x90a3;&#x4e48;&#x5bf9;&#x4e8e; `&lt;keep-alive&gt;` &#x7ec4;&#x4ef6;&#x800c;&#x8a00;&#xff0c;&#x5982;&#x4f55;&#x66f4;&#x65b0;&#x5b83;&#x5305;&#x88f9;&#x7684;&#x5185;&#x5bb9;&#x5462;&#xff1f;\n\n&#x539f;&#x6765; `patchVnode` &#x5728;&#x505a;&#x5404;&#x79cd; diff &#x4e4b;&#x524d;&#xff0c;&#x4f1a;&#x5148;&#x6267;&#x884c; `prepatch` &#x7684;&#x94a9;&#x5b50;&#x51fd;&#x6570;&#xff0c;&#x5b83;&#x7684;&#x5b9a;&#x4e49;&#x5728; `src/core/vdom/create-component` &#x4e2d;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"318,323"}},{"content":"<pre data-lines=\"324,340\"><code data-lines=\"324,340\">const componentVNodeHooks = {\n  prepatch (oldVnode: MountedComponentVNode, vnode: MountedComponentVNode) {\n    const options = vnode<span class=\"hljs-selector-class\">.componentOptions</span>\n    const child = vnode<span class=\"hljs-selector-class\">.componentInstance</span> = oldVnode<span class=\"hljs-selector-class\">.componentInstance</span>\n    <span class=\"hljs-built_in\">updateChildComponent</span>(\n      child,\n      options<span class=\"hljs-selector-class\">.propsData</span>, <span class=\"hljs-comment\">// updated props</span>\n      options<span class=\"hljs-selector-class\">.listeners</span>, <span class=\"hljs-comment\">// updated listeners</span>\n      vnode, <span class=\"hljs-comment\">// new parent vnode</span>\n      options<span class=\"hljs-selector-class\">.children</span> <span class=\"hljs-comment\">// new children</span>\n    )\n  },\n  <span class=\"hljs-comment\">// ...</span>\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"324,340"}},{"content":"<pre data-lines=\"341,342\"><code>`prepatch` &#x6838;&#x5fc3;&#x903b;&#x8f91;&#x5c31;&#x662f;&#x6267;&#x884c; `updateChildComponent` &#x65b9;&#x6cd5;&#xff0c;&#x5b83;&#x7684;&#x5b9a;&#x4e49;&#x5728; `src/core/instance/lifecycle.js` &#x4e2d;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"341,342"}},{"content":"<pre data-lines=\"343,365\"><code data-lines=\"343,365\"><span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">updateChildComponent</span> (<span class=\"hljs-params\">\n  vm: Component,\n  propsData: ?<span class=\"hljs-built_in\">Object</span>,\n  listeners: ?<span class=\"hljs-built_in\">Object</span>,\n  parentVnode: MountedComponentVNode,\n  renderChildren: ?<span class=\"hljs-built_in\">Array</span>&lt;VNode&gt;\n</span>) {\n  <span class=\"hljs-keyword\">const</span> hasChildren = !!(\n    renderChildren ||          \n    vm.<span class=\"hljs-property\">&#x24;options</span>.<span class=\"hljs-property\">_renderChildren</span> ||\n    parentVnode.<span class=\"hljs-property\">data</span>.<span class=\"hljs-property\">scopedSlots</span> || \n    vm.<span class=\"hljs-property\">&#x24;scopedSlots</span> !== emptyObject \n  )\n\n  <span class=\"hljs-comment\">// ...</span>\n  <span class=\"hljs-keyword\">if</span> (hasChildren) {\n    vm.<span class=\"hljs-property\">&#x24;slots</span> = <span class=\"hljs-title function_\">resolveSlots</span>(renderChildren, parentVnode.<span class=\"hljs-property\">context</span>)\n    vm.&#x24;forceUpdate()\n  }\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"343,365"}},{"content":"<pre data-lines=\"366,367\"><code>`updateChildComponent` &#x65b9;&#x6cd5;&#x4e3b;&#x8981;&#x662f;&#x53bb;&#x66f4;&#x65b0;&#x7ec4;&#x4ef6;&#x5b9e;&#x4f8b;&#x7684;&#x4e00;&#x4e9b;&#x5c5e;&#x6027;&#xff0c;&#x8fd9;&#x91cc;&#x6211;&#x4eec;&#x91cd;&#x70b9;&#x5173;&#x6ce8;&#x4e00;&#x4e0b; `slot` &#x90e8;&#x5206;&#xff0c;&#x7531;&#x4e8e; `&lt;keep-alive&gt;` &#x7ec4;&#x4ef6;&#x672c;&#x8d28;&#x4e0a;&#x652f;&#x6301;&#x4e86; `slot`&#xff0c;&#x6240;&#x4ee5;&#x5b83;&#x6267;&#x884c; `prepatch` &#x7684;&#x65f6;&#x5019;&#xff0c;&#x9700;&#x8981;&#x5bf9;&#x81ea;&#x5df1;&#x7684; `children`&#xff0c;&#x4e5f;&#x5c31;&#x662f;&#x8fd9;&#x4e9b; `slots` &#x505a;&#x91cd;&#x65b0;&#x89e3;&#x6790;&#xff0c;&#x5e76;&#x89e6;&#x53d1; `&lt;keep-alive&gt;` &#x7ec4;&#x4ef6;&#x5b9e;&#x4f8b; `&#x24;forceUpdate` &#x903b;&#x8f91;&#xff0c;&#x4e5f;&#x5c31;&#x662f;&#x91cd;&#x65b0;&#x6267;&#x884c; `&lt;keep-alive&gt;` &#x7684; `render` &#x65b9;&#x6cd5;&#xff0c;&#x8fd9;&#x4e2a;&#x65f6;&#x5019;&#x5982;&#x679c;&#x5b83;&#x5305;&#x88f9;&#x7684;&#x7b2c;&#x4e00;&#x4e2a;&#x7ec4;&#x4ef6; `vnode` &#x547d;&#x4e2d;&#x7f13;&#x5b58;&#xff0c;&#x5219;&#x76f4;&#x63a5;&#x8fd4;&#x56de;&#x7f13;&#x5b58;&#x4e2d;&#x7684; `vnode.componentInstance`&#xff0c;&#x5728;&#x6211;&#x4eec;&#x7684;&#x4f8b;&#x5b50;&#x4e2d;&#x5c31;&#x662f;&#x7f13;&#x5b58;&#x7684; `A` &#x7ec4;&#x4ef6;&#xff0c;&#x63a5;&#x7740;&#x53c8;&#x4f1a;&#x6267;&#x884c; `patch` &#x8fc7;&#x7a0b;&#xff0c;&#x518d;&#x6b21;&#x6267;&#x884c;&#x5230; `createComponent` &#x65b9;&#x6cd5;&#xff0c;&#x6211;&#x4eec;&#x518d;&#x56de;&#x987e;&#x4e00;&#x4e0b;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"366,367"}},{"content":"<pre data-lines=\"368,391\"><code data-lines=\"368,391\">function createComponent (vnode, insertedVnodeQueue, parentElm, refElm) {\n  let <span class=\"hljs-selector-tag\">i</span> = vnode<span class=\"hljs-selector-class\">.data</span>\n  <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-built_in\">isDef</span>(i)) {\n    const isReactivated = <span class=\"hljs-built_in\">isDef</span>(vnode.componentInstance) &amp;&amp; <span class=\"hljs-selector-tag\">i</span><span class=\"hljs-selector-class\">.keepAlive</span>\n    <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-built_in\">isDef</span>(<span class=\"hljs-selector-tag\">i</span> = <span class=\"hljs-selector-tag\">i</span>.hook) &amp;&amp; <span class=\"hljs-built_in\">isDef</span>(<span class=\"hljs-selector-tag\">i</span> = <span class=\"hljs-selector-tag\">i</span>.init)) {\n      <span class=\"hljs-selector-tag\">i</span>(vnode, false <span class=\"hljs-comment\">/* hydrating */</span>)\n    }\n    <span class=\"hljs-comment\">// after calling the init hook, if the vnode is a child component</span>\n    <span class=\"hljs-comment\">// it should&apos;ve created a child instance and mounted it. the child</span>\n    <span class=\"hljs-comment\">// component also has set the placeholder vnode&apos;s elm.</span>\n    <span class=\"hljs-comment\">// in that case we can just return the element and be done.</span>\n    <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-built_in\">isDef</span>(vnode.componentInstance)) {\n      <span class=\"hljs-built_in\">initComponent</span>(vnode, insertedVnodeQueue)\n      <span class=\"hljs-built_in\">insert</span>(parentElm, vnode<span class=\"hljs-selector-class\">.elm</span>, refElm)\n      <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-built_in\">isTrue</span>(isReactivated)) {\n        <span class=\"hljs-built_in\">reactivateComponent</span>(vnode, insertedVnodeQueue, parentElm, refElm)\n      }\n      return true\n    }\n  }\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"368,391"}},{"content":"<pre data-lines=\"392,393\"><code>&#x8fd9;&#x4e2a;&#x65f6;&#x5019; `isReactivated` &#x4e3a; true&#xff0c;&#x5e76;&#x4e14;&#x5728;&#x6267;&#x884c; `init` &#x94a9;&#x5b50;&#x51fd;&#x6570;&#x7684;&#x65f6;&#x5019;&#x4e0d;&#x4f1a;&#x518d;&#x6267;&#x884c;&#x7ec4;&#x4ef6;&#x7684; `mount` &#x8fc7;&#x7a0b;&#x4e86;&#xff0c;&#x76f8;&#x5173;&#x903b;&#x8f91;&#x5728; `src/core/vdom/create-component.js` &#x4e2d;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"392,393"}},{"content":"<pre data-lines=\"394,416\"><code data-lines=\"394,416\"><span class=\"hljs-keyword\">const</span> <span class=\"hljs-variable constant_\">componentVNodeHooks</span> = {\n  <span class=\"hljs-title function_ invoke__\">init</span> (<span class=\"hljs-attr\">vnode</span>: VNodeWithData, <span class=\"hljs-attr\">hydrating</span>: <span class=\"hljs-keyword\">boolean</span>): ?<span class=\"hljs-keyword\">boolean</span> {\n    <span class=\"hljs-keyword\">if</span> (\n      vnode.componentInstance &amp;&amp;\n      !vnode.componentInstance._isDestroyed &amp;&amp;\n      vnode.data.keepAlive\n    ) {\n      <span class=\"hljs-comment\">// kept-alive components, treat as a patch</span>\n      <span class=\"hljs-keyword\">const</span> <span class=\"hljs-variable constant_\">mountedNode</span>: any = vnode <span class=\"hljs-comment\">// work around flow</span>\n      componentVNodeHooks.<span class=\"hljs-title function_ invoke__\">prepatch</span>(mountedNode, mountedNode)\n    } <span class=\"hljs-keyword\">else</span> {\n      <span class=\"hljs-keyword\">const</span> <span class=\"hljs-variable constant_\">child</span> = vnode.componentInstance = <span class=\"hljs-title function_ invoke__\">createComponentInstanceForVnode</span>(\n        vnode,\n        activeInstance\n      )\n      child.<span class=\"hljs-variable\">&#x24;mount</span>(hydrating ? vnode.elm : undefined, hydrating)\n    }\n  },\n  <span class=\"hljs-comment\">// ...</span>\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"394,416"}},{"content":"<pre data-lines=\"417,418\"><code>&#x8fd9;&#x4e5f;&#x5c31;&#x662f;&#x88ab; `&lt;keep-alive&gt;` &#x5305;&#x88f9;&#x7684;&#x7ec4;&#x4ef6;&#x5728;&#x6709;&#x7f13;&#x5b58;&#x7684;&#x65f6;&#x5019;&#x5c31;&#x4e0d;&#x4f1a;&#x5728;&#x6267;&#x884c;&#x7ec4;&#x4ef6;&#x7684; `created`&#x3001;`mounted` &#x7b49;&#x94a9;&#x5b50;&#x51fd;&#x6570;&#x7684;&#x539f;&#x56e0;&#x4e86;&#x3002;&#x56de;&#x5230; `createComponent` &#x65b9;&#x6cd5;&#xff0c;&#x5728; `isReactivated` &#x4e3a; true &#x7684;&#x60c5;&#x51b5;&#x4e0b;&#x4f1a;&#x6267;&#x884c; `reactivateComponent` &#x65b9;&#x6cd5;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"417,418"}},{"content":"<pre data-lines=\"419,442\"><code data-lines=\"419,442\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">reactivateComponent</span> (<span class=\"hljs-params\">vnode, insertedVnodeQueue, parentElm, refElm</span>) {\n  let i\n  <span class=\"hljs-comment\">// hack for #4339: a reactivated component with inner transition</span>\n  <span class=\"hljs-comment\">// does not trigger because the inner node&apos;s created hooks are not called</span>\n  <span class=\"hljs-comment\">// again. It&apos;s not ideal to involve module-specific logic in here but</span>\n  <span class=\"hljs-comment\">// there doesn&apos;t seem to be a better way to do it.</span>\n  let innerNode = vnode\n  <span class=\"hljs-keyword\">while</span> (innerNode.componentInstance) {\n    innerNode = innerNode.componentInstance._vnode\n    <span class=\"hljs-keyword\">if</span> (isDef(i = innerNode.data) &amp;&amp; isDef(i = i.transition)) {\n      <span class=\"hljs-keyword\">for</span> (i = <span class=\"hljs-number\">0</span>; i &lt; cbs.activate.<span class=\"hljs-built_in\">length</span>; ++i) {\n        cbs.activate[i](emptyNode, innerNode)\n      }\n      insertedVnodeQueue.<span class=\"hljs-built_in\">push</span>(innerNode)\n      <span class=\"hljs-keyword\">break</span>\n    }\n  }\n  <span class=\"hljs-comment\">// unlike a newly created component,</span>\n  <span class=\"hljs-comment\">// a reactivated keep-alive component doesn&apos;t insert itself</span>\n  <span class=\"hljs-built_in\">insert</span>(parentElm, vnode.elm, refElm)\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"419,442"}},{"content":"<pre data-lines=\"443,444\"><code>&#x524d;&#x9762;&#x90e8;&#x5206;&#x7684;&#x903b;&#x8f91;&#x662f;&#x89e3;&#x51b3;&#x5bf9; `reactived` &#x7ec4;&#x4ef6; `transition` &#x52a8;&#x753b;&#x4e0d;&#x89e6;&#x53d1;&#x7684;&#x95ee;&#x9898;&#xff0c;&#x53ef;&#x4ee5;&#x5148;&#x4e0d;&#x5173;&#x6ce8;&#xff0c;&#x6700;&#x540e;&#x901a;&#x8fc7;&#x6267;&#x884c; `insert(parentElm, vnode.elm, refElm)` &#x5c31;&#x628a;&#x7f13;&#x5b58;&#x7684; DOM &#x5bf9;&#x8c61;&#x76f4;&#x63a5;&#x63d2;&#x5165;&#x5230;&#x76ee;&#x6807;&#x5143;&#x7d20;&#x4e2d;&#xff0c;&#x8fd9;&#x6837;&#x5c31;&#x5b8c;&#x6210;&#x4e86;&#x5728;&#x6570;&#x636e;&#x66f4;&#x65b0;&#x7684;&#x60c5;&#x51b5;&#x4e0b;&#x7684;&#x6e32;&#x67d3;&#x8fc7;&#x7a0b;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"443,444"}}],"payload":{"tag":"h3","lines":"316,317"}}],"payload":{"tag":"h2","lines":"216,218"}},{"content":"<a href=\"#%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F\">#</a> &#x751f;&#x547d;&#x5468;&#x671f;","children":[{"content":"<pre data-lines=\"448,451\"><code>&#x4e4b;&#x524d;&#x6211;&#x4eec;&#x63d0;&#x5230;&#xff0c;&#x7ec4;&#x4ef6;&#x4e00;&#x65e6;&#x88ab; `&lt;keep-alive&gt;` &#x7f13;&#x5b58;&#xff0c;&#x90a3;&#x4e48;&#x518d;&#x6b21;&#x6e32;&#x67d3;&#x7684;&#x65f6;&#x5019;&#x5c31;&#x4e0d;&#x4f1a;&#x6267;&#x884c; `created`&#x3001;`mounted` &#x7b49;&#x94a9;&#x5b50;&#x51fd;&#x6570;&#xff0c;&#x4f46;&#x662f;&#x6211;&#x4eec;&#x5f88;&#x591a;&#x4e1a;&#x52a1;&#x573a;&#x666f;&#x90fd;&#x662f;&#x5e0c;&#x671b;&#x5728;&#x6211;&#x4eec;&#x88ab;&#x7f13;&#x5b58;&#x7684;&#x7ec4;&#x4ef6;&#x518d;&#x6b21;&#x88ab;&#x6e32;&#x67d3;&#x7684;&#x65f6;&#x5019;&#x505a;&#x4e00;&#x4e9b;&#x4e8b;&#x60c5;&#xff0c;&#x597d;&#x5728; Vue &#x63d0;&#x4f9b;&#x4e86; `activated` &#x94a9;&#x5b50;&#x51fd;&#x6570;&#xff0c;&#x5b83;&#x7684;&#x6267;&#x884c;&#x65f6;&#x673a;&#x662f; `&lt;keep-alive&gt;` &#x5305;&#x88f9;&#x7684;&#x7ec4;&#x4ef6;&#x6e32;&#x67d3;&#x7684;&#x65f6;&#x5019;&#xff0c;&#x63a5;&#x4e0b;&#x6765;&#x6211;&#x4eec;&#x4ece;&#x6e90;&#x7801;&#x89d2;&#x5ea6;&#x6765;&#x5206;&#x6790;&#x4e00;&#x4e0b;&#x5b83;&#x7684;&#x5b9e;&#x73b0;&#x539f;&#x7406;&#x3002;\n\n&#x5728;&#x6e32;&#x67d3;&#x7684;&#x6700;&#x540e;&#x4e00;&#x6b65;&#xff0c;&#x4f1a;&#x6267;&#x884c; `invokeInsertHook(vnode, insertedVnodeQueue, isInitialPatch)` &#x51fd;&#x6570;&#x6267;&#x884c; `vnode` &#x7684; `insert` &#x94a9;&#x5b50;&#x51fd;&#x6570;&#xff0c;&#x5b83;&#x7684;&#x5b9a;&#x4e49;&#x5728; `src/core/vdom/create-component.js` &#x4e2d;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"448,451"}},{"content":"<pre data-lines=\"452,476\"><code data-lines=\"452,476\"><span class=\"hljs-keyword\">const</span> componentVNodeHooks = {\n  insert (vnode: MountedComponentVNode) {\n    <span class=\"hljs-keyword\">const</span> { context, componentInstance } = <span class=\"hljs-function\">vnode\n    <span class=\"hljs-title\">if</span> (<span class=\"hljs-params\">!componentInstance._isMounted</span>)</span> {\n      componentInstance._isMounted = <span class=\"hljs-function\"><span class=\"hljs-literal\">true</span>\n      <span class=\"hljs-title\">callHook</span>(<span class=\"hljs-params\">componentInstance, <span class=\"hljs-string\">&apos;mounted&apos;</span></span>)\n    }\n    <span class=\"hljs-title\">if</span> (<span class=\"hljs-params\">vnode.data.keepAlive</span>)</span> {\n      <span class=\"hljs-keyword\">if</span> (context._isMounted) {\n        <span class=\"hljs-comment\">// vue-router#1212</span>\n        <span class=\"hljs-comment\">// During updates, a kept-alive component&apos;s child components may</span>\n        <span class=\"hljs-comment\">// change, so directly walking the tree here may call activated hooks</span>\n        <span class=\"hljs-comment\">// on incorrect children. Instead we push them into a queue which will</span>\n        <span class=\"hljs-comment\">// be processed after the whole patch process ended.</span>\n        queueActivatedComponent(componentInstance)\n      } <span class=\"hljs-keyword\">else</span> {\n        activateChildComponent(componentInstance, <span class=\"hljs-literal\">true</span> <span class=\"hljs-comment\">/* direct */</span>)\n      }\n    }\n  },\n  <span class=\"hljs-comment\">// ...</span>\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"452,476"}},{"content":"<pre data-lines=\"477,478\"><code>&#x8fd9;&#x91cc;&#x5224;&#x65ad;&#x5982;&#x679c;&#x662f;&#x88ab; `&lt;keep-alive&gt;` &#x5305;&#x88f9;&#x7684;&#x7ec4;&#x4ef6;&#x5df2;&#x7ecf; `mounted`&#xff0c;&#x90a3;&#x4e48;&#x5219;&#x6267;&#x884c; `queueActivatedComponent(componentInstance)` &#xff0c;&#x5426;&#x5219;&#x6267;&#x884c; `activateChildComponent(componentInstance, true)`&#x3002;&#x6211;&#x4eec;&#x5148;&#x5206;&#x6790;&#x975e; `mounted` &#x7684;&#x60c5;&#x51b5;&#xff0c;`activateChildComponent` &#x7684;&#x5b9a;&#x4e49;&#x5728; `src/core/instance/lifecycle.js` &#x4e2d;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"477,478"}},{"content":"<pre data-lines=\"479,498\"><code data-lines=\"479,498\">export <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title\">activateChildComponent</span> (<span class=\"hljs-params\">vm: Component, direct?: <span class=\"hljs-keyword\">boolean</span></span>) </span>{\n  <span class=\"hljs-keyword\">if</span> (direct) {\n    vm._directInactive = <span class=\"hljs-literal\">false</span>\n    <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-title function_ invoke__\">isInInactiveTree</span>(vm)) {\n      <span class=\"hljs-keyword\">return</span>\n    }\n  } <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span> (vm._directInactive) {\n    <span class=\"hljs-keyword\">return</span>\n  }\n  <span class=\"hljs-keyword\">if</span> (vm._inactive || vm._inactive === <span class=\"hljs-literal\">null</span>) {\n    vm._inactive = <span class=\"hljs-literal\">false</span>\n    <span class=\"hljs-keyword\">for</span> (let i = <span class=\"hljs-number\">0</span>; i &lt; vm.<span class=\"hljs-variable\">&#x24;children</span>.length; i++) {\n      <span class=\"hljs-title function_ invoke__\">activateChildComponent</span>(vm.<span class=\"hljs-variable\">&#x24;children</span>[i])\n    }\n    <span class=\"hljs-title function_ invoke__\">callHook</span>(vm, <span class=\"hljs-string\">&apos;activated&apos;</span>)\n  }\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"479,498"}},{"content":"<pre data-lines=\"499,502\"><code>&#x53ef;&#x4ee5;&#x770b;&#x5230;&#x8fd9;&#x91cc;&#x5c31;&#x662f;&#x6267;&#x884c;&#x7ec4;&#x4ef6;&#x7684; `acitvated` &#x94a9;&#x5b50;&#x51fd;&#x6570;&#xff0c;&#x5e76;&#x4e14;&#x9012;&#x5f52;&#x53bb;&#x6267;&#x884c;&#x5b83;&#x7684;&#x6240;&#x6709;&#x5b50;&#x7ec4;&#x4ef6;&#x7684; `activated` &#x94a9;&#x5b50;&#x51fd;&#x6570;&#x3002;\n\n&#x90a3;&#x4e48;&#x518d;&#x770b; `queueActivatedComponent` &#x7684;&#x903b;&#x8f91;&#xff0c;&#x5b83;&#x5b9a;&#x4e49;&#x5728; `src/core/observer/scheduler.js` &#x4e2d;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"499,502"}},{"content":"<pre data-lines=\"503,509\"><code data-lines=\"503,509\"><span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">queueActivatedComponent</span> (<span class=\"hljs-params\">vm: Component</span>) {\n  vm._inactive = <span class=\"hljs-literal\">false</span>\n  activatedChildren.<span class=\"hljs-built_in\">push</span>(vm)\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"503,509"}},{"content":"<pre data-lines=\"510,511\"><code>&#x8fd9;&#x4e2a;&#x903b;&#x8f91;&#x5f88;&#x7b80;&#x5355;&#xff0c;&#x628a;&#x5f53;&#x524d; `vm` &#x5b9e;&#x4f8b;&#x6dfb;&#x52a0;&#x5230; `activatedChildren` &#x6570;&#x7ec4;&#x4e2d;&#xff0c;&#x7b49;&#x6240;&#x6709;&#x7684;&#x6e32;&#x67d3;&#x5b8c;&#x6bd5;&#xff0c;&#x5728; `nextTick`&#x540e;&#x4f1a;&#x6267;&#x884c; `flushSchedulerQueue`&#xff0c;&#x8fd9;&#x4e2a;&#x65f6;&#x5019;&#x5c31;&#x4f1a;&#x6267;&#x884c;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"510,511"}},{"content":"<pre data-lines=\"512,526\"><code data-lines=\"512,526\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">flushSchedulerQueue</span> (<span class=\"hljs-params\"></span>) {\n  <span class=\"hljs-comment\">// ...</span>\n  const activatedQueue = activatedChildren.<span class=\"hljs-built_in\">slice</span>()\n  callActivatedHooks(activatedQueue)\n  <span class=\"hljs-comment\">// ...</span>\n} \n\n<span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">callActivatedHooks</span> (<span class=\"hljs-params\">queue</span>) {\n  <span class=\"hljs-keyword\">for</span> (let i = <span class=\"hljs-number\">0</span>; i &lt; queue.<span class=\"hljs-built_in\">length</span>; i++) {\n    queue[i]._inactive = <span class=\"hljs-literal\">true</span>\n    activateChildComponent(queue[i], <span class=\"hljs-literal\">true</span>)  }\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"512,526"}},{"content":"<pre data-lines=\"527,530\"><code>&#x4e5f;&#x5c31;&#x662f;&#x904d;&#x5386;&#x6240;&#x6709;&#x7684; `activatedChildren`&#xff0c;&#x6267;&#x884c; `activateChildComponent` &#x65b9;&#x6cd5;&#xff0c;&#x901a;&#x8fc7;&#x961f;&#x5217;&#x8c03;&#x7684;&#x65b9;&#x5f0f;&#x5c31;&#x662f;&#x628a;&#x6574;&#x4e2a; `activated` &#x65f6;&#x673a;&#x5ef6;&#x540e;&#x4e86;&#x3002;\n\n&#x6709; `activated` &#x94a9;&#x5b50;&#x51fd;&#x6570;&#xff0c;&#x4e5f;&#x5c31;&#x6709;&#x5bf9;&#x5e94;&#x7684; `deactivated` &#x94a9;&#x5b50;&#x51fd;&#x6570;&#xff0c;&#x5b83;&#x662f;&#x53d1;&#x751f;&#x5728; `vnode` &#x7684; `destory` &#x94a9;&#x5b50;&#x51fd;&#x6570;&#xff0c;&#x5b9a;&#x4e49;&#x5728; `src/core/vdom/create-component.js` &#x4e2d;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"527,530"}},{"content":"<pre data-lines=\"531,545\"><code data-lines=\"531,545\"><span class=\"hljs-keyword\">const</span> <span class=\"hljs-variable constant_\">componentVNodeHooks</span> = {\n  <span class=\"hljs-title function_ invoke__\">destroy</span> (<span class=\"hljs-attr\">vnode</span>: MountedComponentVNode) {\n    <span class=\"hljs-keyword\">const</span> { componentInstance } = vnode\n    <span class=\"hljs-keyword\">if</span> (!componentInstance._isDestroyed) {\n      <span class=\"hljs-keyword\">if</span> (!vnode.data.keepAlive) {\n        componentInstance.<span class=\"hljs-variable\">&#x24;destroy</span>()\n      } <span class=\"hljs-keyword\">else</span> {\n        <span class=\"hljs-title function_ invoke__\">deactivateChildComponent</span>(componentInstance, <span class=\"hljs-literal\">true</span> <span class=\"hljs-comment\">/* direct */</span>)\n      }\n    }\n  }\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"531,545"}},{"content":"<pre data-lines=\"546,547\"><code>&#x5bf9;&#x4e8e; `&lt;keep-alive&gt;` &#x5305;&#x88f9;&#x7684;&#x7ec4;&#x4ef6;&#x800c;&#x8a00;&#xff0c;&#x5b83;&#x4f1a;&#x6267;&#x884c; `deactivateChildComponent(componentInstance, true)` &#x65b9;&#x6cd5;&#xff0c;&#x5b9a;&#x4e49;&#x5728; `src/core/instance/lifecycle.js` &#x4e2d;&#xff1a;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"546,547"}},{"content":"<pre data-lines=\"548,565\"><code data-lines=\"548,565\"><span class=\"hljs-built_in\">export</span> <span class=\"hljs-keyword\">function</span> deactivateChildComponent (vm: Component, direct?: boolean) {\n  <span class=\"hljs-keyword\">if</span> (direct) {\n    vm._directInactive = <span class=\"hljs-literal\">true</span>\n    <span class=\"hljs-keyword\">if</span> (isInInactiveTree(vm)) {\n      <span class=\"hljs-built_in\">return</span>\n    }\n  }\n  <span class=\"hljs-keyword\">if</span> (!vm._inactive) {\n    vm._inactive = <span class=\"hljs-literal\">true</span>\n    <span class=\"hljs-keyword\">for</span> (<span class=\"hljs-built_in\">let</span> i = 0; i &lt; vm.<span class=\"hljs-variable\">&#x24;children</span>.length; i++) {\n      deactivateChildComponent(vm.<span class=\"hljs-variable\">&#x24;children</span>[i])\n    }\n    callHook(vm, <span class=\"hljs-string\">&apos;deactivated&apos;</span>)\n  }\n} \n</code></pre>","children":[],"payload":{"tag":"pre","lines":"548,565"}},{"content":"<pre data-lines=\"566,567\"><code>&#x548c; `activateChildComponent` &#x65b9;&#x6cd5;&#x7c7b;&#x4f3c;&#xff0c;&#x5c31;&#x662f;&#x6267;&#x884c;&#x7ec4;&#x4ef6;&#x7684; `deacitvated` &#x94a9;&#x5b50;&#x51fd;&#x6570;&#xff0c;&#x5e76;&#x4e14;&#x9012;&#x5f52;&#x53bb;&#x6267;&#x884c;&#x5b83;&#x7684;&#x6240;&#x6709;&#x5b50;&#x7ec4;&#x4ef6;&#x7684; `deactivated` &#x94a9;&#x5b50;&#x51fd;&#x6570;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"566,567"}}],"payload":{"tag":"h2","lines":"445,447"}},{"content":"<a href=\"#%E6%80%BB%E7%BB%93\">#</a> &#x603b;&#x7ed3;","children":[],"payload":{"tag":"h2","lines":"568,570"}}],"payload":{"tag":"h1","lines":"0,2"}},{})</script>
</body>
</html>
