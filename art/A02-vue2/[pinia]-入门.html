<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets@11.11.1/styles/default.min.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.18.10/dist/browser/index.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/index.js"></script><script>(r => {
              setTimeout(r);
            })(function renderToolbar() {
  const {
    markmap,
    mm
  } = window;
  const {
    el
  } = markmap.Toolbar.create(mm);
  el.setAttribute('style', 'position:absolute;bottom:20px;right:20px');
  document.body.append(el);
})</script><script>((getMarkmap, getOptions, root2, jsonOptions) => {
              const markmap = getMarkmap();
              window.mm = markmap.Markmap.create(
                "svg#mindmap",
                (getOptions || markmap.deriveOptions)(jsonOptions),
                root2
              );
            })(() => window.markmap,null,{"content":"[pinia]-&#x5165;&#x95e8;","children":[{"content":"&#x7528;&#x6237;store","children":[{"content":"store/modules/useUserStore","children":[{"content":"<pre data-lines=\"5,79\"><code class=\"language-js\"><span class=\"hljs-keyword\">import</span> { login, logout, getInfo } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&apos;@/api/login&apos;</span>\n<span class=\"hljs-keyword\">import</span> { getToken, setToken, removeToken } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&apos;@/utils/auth&apos;</span>\n<span class=\"hljs-keyword\">import</span> defAva <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&apos;@/assets/images/profile.jpg&apos;</span>\n\n<span class=\"hljs-keyword\">const</span> useUserStore = <span class=\"hljs-title function_\">defineStore</span>(\n  <span class=\"hljs-string\">&apos;user&apos;</span>,\n  {\n    <span class=\"hljs-attr\">state</span>: <span class=\"hljs-function\">() =&gt;</span> ({\n      <span class=\"hljs-attr\">token</span>: <span class=\"hljs-title function_\">getToken</span>(),\n      <span class=\"hljs-attr\">name</span>: <span class=\"hljs-string\">&apos;&apos;</span>,\n      <span class=\"hljs-attr\">avatar</span>: <span class=\"hljs-string\">&apos;&apos;</span>,\n      <span class=\"hljs-attr\">roles</span>: [],\n      <span class=\"hljs-attr\">permissions</span>: []\n    }),\n    <span class=\"hljs-attr\">actions</span>: {\n      <span class=\"hljs-comment\">// &#x767b;&#x5f55;</span>\n      <span class=\"hljs-title function_\">login</span>(<span class=\"hljs-params\">userInfo</span>) {\n        <span class=\"hljs-keyword\">const</span> username = userInfo.<span class=\"hljs-property\">username</span>.<span class=\"hljs-title function_\">trim</span>()\n        <span class=\"hljs-keyword\">const</span> password = userInfo.<span class=\"hljs-property\">password</span>\n        <span class=\"hljs-keyword\">const</span> code = userInfo.<span class=\"hljs-property\">code</span>\n        <span class=\"hljs-keyword\">const</span> uuid = userInfo.<span class=\"hljs-property\">uuid</span>\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Promise</span>(<span class=\"hljs-function\">(<span class=\"hljs-params\">resolve, reject</span>) =&gt;</span> {\n          <span class=\"hljs-title function_\">login</span>(username, password, code, uuid).<span class=\"hljs-title function_\">then</span>(<span class=\"hljs-function\"><span class=\"hljs-params\">res</span> =&gt;</span> {\n            <span class=\"hljs-keyword\">let</span> data = res.<span class=\"hljs-property\">data</span>\n            <span class=\"hljs-title function_\">setToken</span>(data.<span class=\"hljs-property\">access_token</span>)\n            <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">token</span> = data.<span class=\"hljs-property\">access_token</span>\n            <span class=\"hljs-title function_\">resolve</span>()\n          }).<span class=\"hljs-title function_\">catch</span>(<span class=\"hljs-function\"><span class=\"hljs-params\">error</span> =&gt;</span> {\n            <span class=\"hljs-title function_\">reject</span>(error)\n          })\n        })\n      },\n      <span class=\"hljs-comment\">// &#x83b7;&#x53d6;&#x7528;&#x6237;&#x4fe1;&#x606f;</span>\n      <span class=\"hljs-title function_\">getInfo</span>(<span class=\"hljs-params\"></span>) {\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Promise</span>(<span class=\"hljs-function\">(<span class=\"hljs-params\">resolve, reject</span>) =&gt;</span> {\n          <span class=\"hljs-title function_\">getInfo</span>().<span class=\"hljs-title function_\">then</span>(<span class=\"hljs-function\"><span class=\"hljs-params\">res</span> =&gt;</span> {\n            <span class=\"hljs-keyword\">const</span> user = res.<span class=\"hljs-property\">user</span>\n            <span class=\"hljs-keyword\">const</span> avatar = (user.<span class=\"hljs-property\">avatar</span> == <span class=\"hljs-string\">&quot;&quot;</span> || user.<span class=\"hljs-property\">avatar</span> == <span class=\"hljs-literal\">null</span>) ? defAva : user.<span class=\"hljs-property\">avatar</span>;\n\n            <span class=\"hljs-keyword\">if</span> (res.<span class=\"hljs-property\">roles</span> &amp;&amp; res.<span class=\"hljs-property\">roles</span>.<span class=\"hljs-property\">length</span> &gt; <span class=\"hljs-number\">0</span>) { <span class=\"hljs-comment\">// &#x9a8c;&#x8bc1;&#x8fd4;&#x56de;&#x7684;roles&#x662f;&#x5426;&#x662f;&#x4e00;&#x4e2a;&#x975e;&#x7a7a;&#x6570;&#x7ec4;</span>\n              <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">roles</span> = res.<span class=\"hljs-property\">roles</span>\n              <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">permissions</span> = res.<span class=\"hljs-property\">permissions</span>\n            } <span class=\"hljs-keyword\">else</span> {\n              <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">roles</span> = [<span class=\"hljs-string\">&apos;ROLE_DEFAULT&apos;</span>]\n            }\n            <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">name</span> = user.<span class=\"hljs-property\">userName</span>\n            <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">avatar</span> = avatar;\n            <span class=\"hljs-title function_\">resolve</span>(res)\n          }).<span class=\"hljs-title function_\">catch</span>(<span class=\"hljs-function\"><span class=\"hljs-params\">error</span> =&gt;</span> {\n            <span class=\"hljs-title function_\">reject</span>(error)\n          })\n        })\n      },\n      <span class=\"hljs-comment\">// &#x9000;&#x51fa;&#x7cfb;&#x7edf;</span>\n      <span class=\"hljs-title function_\">logOut</span>(<span class=\"hljs-params\"></span>) {\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Promise</span>(<span class=\"hljs-function\">(<span class=\"hljs-params\">resolve, reject</span>) =&gt;</span> {\n          <span class=\"hljs-title function_\">logout</span>(<span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">token</span>).<span class=\"hljs-title function_\">then</span>(<span class=\"hljs-function\">() =&gt;</span> {\n            <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">token</span> = <span class=\"hljs-string\">&apos;&apos;</span>\n            <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">roles</span> = []\n            <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">permissions</span> = []\n            <span class=\"hljs-title function_\">removeToken</span>()\n            <span class=\"hljs-title function_\">resolve</span>()\n          }).<span class=\"hljs-title function_\">catch</span>(<span class=\"hljs-function\"><span class=\"hljs-params\">error</span> =&gt;</span> {\n            <span class=\"hljs-title function_\">reject</span>(error)\n          })\n        })\n      }\n    }\n  })\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">default</span> useUserStore\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"5,79"}}],"payload":{"tag":"h3","lines":"4,5"}},{"content":"store/modules/useAppStore","children":[{"content":"<pre data-lines=\"81,130\"><code class=\"language-js\"><span class=\"hljs-keyword\">import</span> <span class=\"hljs-title class_\">Cookies</span> <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&apos;js-cookie&apos;</span>\n\n<span class=\"hljs-keyword\">const</span> useAppStore = <span class=\"hljs-title function_\">defineStore</span>(\n  <span class=\"hljs-string\">&apos;app&apos;</span>,\n  {\n    <span class=\"hljs-attr\">state</span>: <span class=\"hljs-function\">() =&gt;</span> ({\n      <span class=\"hljs-attr\">sidebar</span>: {\n        <span class=\"hljs-attr\">opened</span>: <span class=\"hljs-title class_\">Cookies</span>.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;sidebarStatus&apos;</span>) ? !!+<span class=\"hljs-title class_\">Cookies</span>.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;sidebarStatus&apos;</span>) : <span class=\"hljs-literal\">true</span>,\n        <span class=\"hljs-attr\">withoutAnimation</span>: <span class=\"hljs-literal\">false</span>,\n        <span class=\"hljs-attr\">hide</span>: <span class=\"hljs-literal\">false</span>\n      },\n      <span class=\"hljs-attr\">device</span>: <span class=\"hljs-string\">&apos;desktop&apos;</span>,\n      <span class=\"hljs-attr\">size</span>: <span class=\"hljs-title class_\">Cookies</span>.<span class=\"hljs-title function_\">get</span>(<span class=\"hljs-string\">&apos;size&apos;</span>) || <span class=\"hljs-string\">&apos;default&apos;</span>\n    }),\n    <span class=\"hljs-attr\">actions</span>: {\n      <span class=\"hljs-title function_\">toggleSideBar</span>(<span class=\"hljs-params\">withoutAnimation</span>) {\n        <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">sidebar</span>.<span class=\"hljs-property\">hide</span>) {\n          <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">false</span>;\n        }\n        <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">sidebar</span>.<span class=\"hljs-property\">opened</span> = !<span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">sidebar</span>.<span class=\"hljs-property\">opened</span>\n        <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">sidebar</span>.<span class=\"hljs-property\">withoutAnimation</span> = withoutAnimation\n        <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">sidebar</span>.<span class=\"hljs-property\">opened</span>) {\n          <span class=\"hljs-title class_\">Cookies</span>.<span class=\"hljs-title function_\">set</span>(<span class=\"hljs-string\">&apos;sidebarStatus&apos;</span>, <span class=\"hljs-number\">1</span>)\n        } <span class=\"hljs-keyword\">else</span> {\n          <span class=\"hljs-title class_\">Cookies</span>.<span class=\"hljs-title function_\">set</span>(<span class=\"hljs-string\">&apos;sidebarStatus&apos;</span>, <span class=\"hljs-number\">0</span>)\n        }\n      },\n      <span class=\"hljs-title function_\">closeSideBar</span>(<span class=\"hljs-params\">{ withoutAnimation }</span>) {\n        <span class=\"hljs-title class_\">Cookies</span>.<span class=\"hljs-title function_\">set</span>(<span class=\"hljs-string\">&apos;sidebarStatus&apos;</span>, <span class=\"hljs-number\">0</span>)\n        <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">sidebar</span>.<span class=\"hljs-property\">opened</span> = <span class=\"hljs-literal\">false</span>\n        <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">sidebar</span>.<span class=\"hljs-property\">withoutAnimation</span> = withoutAnimation\n      },\n      <span class=\"hljs-title function_\">toggleDevice</span>(<span class=\"hljs-params\">device</span>) {\n        <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">device</span> = device\n      },\n      <span class=\"hljs-title function_\">setSize</span>(<span class=\"hljs-params\">size</span>) {\n        <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">size</span> = size;\n        <span class=\"hljs-title class_\">Cookies</span>.<span class=\"hljs-title function_\">set</span>(<span class=\"hljs-string\">&apos;size&apos;</span>, size)\n      },\n      <span class=\"hljs-title function_\">toggleSideBarHide</span>(<span class=\"hljs-params\">status</span>) {\n        <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">sidebar</span>.<span class=\"hljs-property\">hide</span> = status\n      }\n    }\n  })\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">default</span> useAppStore\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"81,130"}}],"payload":{"tag":"h3","lines":"80,81"}},{"content":"store/modules/permissions","children":[{"content":"<pre data-lines=\"132,274\"><code class=\"language-js\">\n<span class=\"hljs-keyword\">import</span> auth <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&apos;@/plugins/auth&apos;</span>\n<span class=\"hljs-keyword\">import</span> router, { constantRoutes, dynamicRoutes } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&apos;@/router&apos;</span>\n<span class=\"hljs-keyword\">import</span> { getRouters } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&apos;@/api/menu&apos;</span>\n<span class=\"hljs-keyword\">import</span> <span class=\"hljs-title class_\">Layout</span> <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&apos;@/layout/index&apos;</span>\n<span class=\"hljs-keyword\">import</span> <span class=\"hljs-title class_\">ParentView</span> <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&apos;@/components/ParentView&apos;</span>\n<span class=\"hljs-keyword\">import</span> <span class=\"hljs-title class_\">InnerLink</span> <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&apos;@/layout/components/InnerLink&apos;</span>\n\n<span class=\"hljs-comment\">// &#x5339;&#x914d;views&#x91cc;&#x9762;&#x6240;&#x6709;&#x7684;.vue&#x6587;&#x4ef6;</span>\n<span class=\"hljs-keyword\">const</span> modules = <span class=\"hljs-keyword\">import</span>.<span class=\"hljs-property\">meta</span>.<span class=\"hljs-title function_\">glob</span>(<span class=\"hljs-string\">&apos;./../../views/**/*.vue&apos;</span>)\n\n<span class=\"hljs-keyword\">const</span> usePermissionStore = <span class=\"hljs-title function_\">defineStore</span>(\n  <span class=\"hljs-string\">&apos;permission&apos;</span>,\n  {\n    <span class=\"hljs-attr\">state</span>: <span class=\"hljs-function\">() =&gt;</span> ({\n      <span class=\"hljs-attr\">routes</span>: [],\n      <span class=\"hljs-attr\">addRoutes</span>: [],\n      <span class=\"hljs-attr\">defaultRoutes</span>: [],\n      <span class=\"hljs-attr\">topbarRouters</span>: [],\n      <span class=\"hljs-attr\">sidebarRouters</span>: []\n    }),\n    <span class=\"hljs-attr\">actions</span>: {\n      <span class=\"hljs-title function_\">setRoutes</span>(<span class=\"hljs-params\">routes</span>) {\n        <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">addRoutes</span> = routes\n        <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">routes</span> = constantRoutes.<span class=\"hljs-title function_\">concat</span>(routes)\n      },\n      <span class=\"hljs-title function_\">setDefaultRoutes</span>(<span class=\"hljs-params\">routes</span>) {\n        <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">defaultRoutes</span> = constantRoutes.<span class=\"hljs-title function_\">concat</span>(routes)\n      },\n      <span class=\"hljs-title function_\">setTopbarRoutes</span>(<span class=\"hljs-params\">routes</span>) {\n        <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">topbarRouters</span> = routes\n      },\n      <span class=\"hljs-title function_\">setSidebarRouters</span>(<span class=\"hljs-params\">routes</span>) {\n        <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">sidebarRouters</span> = routes\n      },\n      <span class=\"hljs-title function_\">generateRoutes</span>(<span class=\"hljs-params\">roles</span>) {\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-keyword\">new</span> <span class=\"hljs-title class_\">Promise</span>(<span class=\"hljs-function\"><span class=\"hljs-params\">resolve</span> =&gt;</span> {\n          <span class=\"hljs-comment\">// &#x5411;&#x540e;&#x7aef;&#x8bf7;&#x6c42;&#x8def;&#x7531;&#x6570;&#x636e;</span>\n          <span class=\"hljs-title function_\">getRouters</span>().<span class=\"hljs-title function_\">then</span>(<span class=\"hljs-function\"><span class=\"hljs-params\">res</span> =&gt;</span> {\n            <span class=\"hljs-keyword\">const</span> sdata = <span class=\"hljs-title class_\">JSON</span>.<span class=\"hljs-title function_\">parse</span>(<span class=\"hljs-title class_\">JSON</span>.<span class=\"hljs-title function_\">stringify</span>(res.<span class=\"hljs-property\">data</span>))\n            <span class=\"hljs-keyword\">const</span> rdata = <span class=\"hljs-title class_\">JSON</span>.<span class=\"hljs-title function_\">parse</span>(<span class=\"hljs-title class_\">JSON</span>.<span class=\"hljs-title function_\">stringify</span>(res.<span class=\"hljs-property\">data</span>))\n            <span class=\"hljs-keyword\">const</span> defaultData = <span class=\"hljs-title class_\">JSON</span>.<span class=\"hljs-title function_\">parse</span>(<span class=\"hljs-title class_\">JSON</span>.<span class=\"hljs-title function_\">stringify</span>(res.<span class=\"hljs-property\">data</span>))\n            <span class=\"hljs-keyword\">const</span> sidebarRoutes = <span class=\"hljs-title function_\">filterAsyncRouter</span>(sdata)\n            <span class=\"hljs-keyword\">const</span> rewriteRoutes = <span class=\"hljs-title function_\">filterAsyncRouter</span>(rdata, <span class=\"hljs-literal\">false</span>, <span class=\"hljs-literal\">true</span>)\n            <span class=\"hljs-keyword\">const</span> defaultRoutes = <span class=\"hljs-title function_\">filterAsyncRouter</span>(defaultData)\n            <span class=\"hljs-keyword\">const</span> asyncRoutes = <span class=\"hljs-title function_\">filterDynamicRoutes</span>(dynamicRoutes)\n            asyncRoutes.<span class=\"hljs-title function_\">forEach</span>(<span class=\"hljs-function\"><span class=\"hljs-params\">route</span> =&gt;</span> { router.<span class=\"hljs-title function_\">addRoute</span>(route) })\n            <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-title function_\">setRoutes</span>(rewriteRoutes)\n            <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-title function_\">setSidebarRouters</span>(constantRoutes.<span class=\"hljs-title function_\">concat</span>(sidebarRoutes))\n            <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-title function_\">setDefaultRoutes</span>(sidebarRoutes)\n            <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-title function_\">setTopbarRoutes</span>(defaultRoutes)\n            <span class=\"hljs-title function_\">resolve</span>(rewriteRoutes)\n          })\n        })\n      }\n    }\n  })\n\n<span class=\"hljs-comment\">// &#x904d;&#x5386;&#x540e;&#x53f0;&#x4f20;&#x6765;&#x7684;&#x8def;&#x7531;&#x5b57;&#x7b26;&#x4e32;&#xff0c;&#x8f6c;&#x6362;&#x4e3a;&#x7ec4;&#x4ef6;&#x5bf9;&#x8c61;</span>\n<span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">filterAsyncRouter</span>(<span class=\"hljs-params\">asyncRouterMap, lastRouter = <span class=\"hljs-literal\">false</span>, type = <span class=\"hljs-literal\">false</span></span>) {\n  <span class=\"hljs-keyword\">return</span> asyncRouterMap.<span class=\"hljs-title function_\">filter</span>(<span class=\"hljs-function\"><span class=\"hljs-params\">route</span> =&gt;</span> {\n    <span class=\"hljs-keyword\">if</span> (type &amp;&amp; route.<span class=\"hljs-property\">children</span>) {\n      route.<span class=\"hljs-property\">children</span> = <span class=\"hljs-title function_\">filterChildren</span>(route.<span class=\"hljs-property\">children</span>)\n    }\n    <span class=\"hljs-keyword\">if</span> (route.<span class=\"hljs-property\">component</span>) {\n      <span class=\"hljs-comment\">// Layout ParentView &#x7ec4;&#x4ef6;&#x7279;&#x6b8a;&#x5904;&#x7406;</span>\n      <span class=\"hljs-keyword\">if</span> (route.<span class=\"hljs-property\">component</span> === <span class=\"hljs-string\">&apos;Layout&apos;</span>) {\n        route.<span class=\"hljs-property\">component</span> = <span class=\"hljs-title class_\">Layout</span>\n      } <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span> (route.<span class=\"hljs-property\">component</span> === <span class=\"hljs-string\">&apos;ParentView&apos;</span>) {\n        route.<span class=\"hljs-property\">component</span> = <span class=\"hljs-title class_\">ParentView</span>\n      } <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span> (route.<span class=\"hljs-property\">component</span> === <span class=\"hljs-string\">&apos;InnerLink&apos;</span>) {\n        route.<span class=\"hljs-property\">component</span> = <span class=\"hljs-title class_\">InnerLink</span>\n      } <span class=\"hljs-keyword\">else</span> {\n        route.<span class=\"hljs-property\">component</span> = <span class=\"hljs-title function_\">loadView</span>(route.<span class=\"hljs-property\">component</span>)\n      }\n    }\n    <span class=\"hljs-keyword\">if</span> (route.<span class=\"hljs-property\">children</span> != <span class=\"hljs-literal\">null</span> &amp;&amp; route.<span class=\"hljs-property\">children</span> &amp;&amp; route.<span class=\"hljs-property\">children</span>.<span class=\"hljs-property\">length</span>) {\n      route.<span class=\"hljs-property\">children</span> = <span class=\"hljs-title function_\">filterAsyncRouter</span>(route.<span class=\"hljs-property\">children</span>, route, type)\n    } <span class=\"hljs-keyword\">else</span> {\n      <span class=\"hljs-keyword\">delete</span> route[<span class=\"hljs-string\">&apos;children&apos;</span>]\n      <span class=\"hljs-keyword\">delete</span> route[<span class=\"hljs-string\">&apos;redirect&apos;</span>]\n    }\n    <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">true</span>\n  })\n}\n\n<span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">filterChildren</span>(<span class=\"hljs-params\">childrenMap, lastRouter = <span class=\"hljs-literal\">false</span></span>) {\n  <span class=\"hljs-keyword\">var</span> children = []\n  childrenMap.<span class=\"hljs-title function_\">forEach</span>(<span class=\"hljs-function\">(<span class=\"hljs-params\">el, index</span>) =&gt;</span> {\n    <span class=\"hljs-keyword\">if</span> (el.<span class=\"hljs-property\">children</span> &amp;&amp; el.<span class=\"hljs-property\">children</span>.<span class=\"hljs-property\">length</span>) {\n      <span class=\"hljs-keyword\">if</span> (el.<span class=\"hljs-property\">component</span> === <span class=\"hljs-string\">&apos;ParentView&apos;</span> &amp;&amp; !lastRouter) {\n        el.<span class=\"hljs-property\">children</span>.<span class=\"hljs-title function_\">forEach</span>(<span class=\"hljs-function\"><span class=\"hljs-params\">c</span> =&gt;</span> {\n          c.<span class=\"hljs-property\">path</span> = el.<span class=\"hljs-property\">path</span> + <span class=\"hljs-string\">&apos;/&apos;</span> + c.<span class=\"hljs-property\">path</span>\n          <span class=\"hljs-keyword\">if</span> (c.<span class=\"hljs-property\">children</span> &amp;&amp; c.<span class=\"hljs-property\">children</span>.<span class=\"hljs-property\">length</span>) {\n            children = children.<span class=\"hljs-title function_\">concat</span>(<span class=\"hljs-title function_\">filterChildren</span>(c.<span class=\"hljs-property\">children</span>, c))\n            <span class=\"hljs-keyword\">return</span>\n          }\n          children.<span class=\"hljs-title function_\">push</span>(c)\n        })\n        <span class=\"hljs-keyword\">return</span>\n      }\n    }\n    <span class=\"hljs-keyword\">if</span> (lastRouter) {\n      el.<span class=\"hljs-property\">path</span> = lastRouter.<span class=\"hljs-property\">path</span> + <span class=\"hljs-string\">&apos;/&apos;</span> + el.<span class=\"hljs-property\">path</span>\n    }\n    children = children.<span class=\"hljs-title function_\">concat</span>(el)\n  })\n  <span class=\"hljs-keyword\">return</span> children\n}\n\n<span class=\"hljs-comment\">// &#x52a8;&#x6001;&#x8def;&#x7531;&#x904d;&#x5386;&#xff0c;&#x9a8c;&#x8bc1;&#x662f;&#x5426;&#x5177;&#x5907;&#x6743;&#x9650;</span>\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">filterDynamicRoutes</span>(<span class=\"hljs-params\">routes</span>) {\n  <span class=\"hljs-keyword\">const</span> res = []\n  routes.<span class=\"hljs-title function_\">forEach</span>(<span class=\"hljs-function\"><span class=\"hljs-params\">route</span> =&gt;</span> {\n    <span class=\"hljs-keyword\">if</span> (route.<span class=\"hljs-property\">permissions</span>) {\n      <span class=\"hljs-keyword\">if</span> (auth.<span class=\"hljs-title function_\">hasPermiOr</span>(route.<span class=\"hljs-property\">permissions</span>)) {\n        res.<span class=\"hljs-title function_\">push</span>(route)\n      }\n    } <span class=\"hljs-keyword\">else</span> <span class=\"hljs-keyword\">if</span> (route.<span class=\"hljs-property\">roles</span>) {\n      <span class=\"hljs-keyword\">if</span> (auth.<span class=\"hljs-title function_\">hasRoleOr</span>(route.<span class=\"hljs-property\">roles</span>)) {\n        res.<span class=\"hljs-title function_\">push</span>(route)\n      }\n    }\n  })\n  <span class=\"hljs-keyword\">return</span> res\n}\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">const</span> <span class=\"hljs-title function_\">loadView</span> = (<span class=\"hljs-params\">view</span>) =&gt; {\n  <span class=\"hljs-keyword\">let</span> res;\n  <span class=\"hljs-keyword\">for</span> (<span class=\"hljs-keyword\">const</span> path <span class=\"hljs-keyword\">in</span> modules) {\n    <span class=\"hljs-keyword\">const</span> dir = path.<span class=\"hljs-title function_\">split</span>(<span class=\"hljs-string\">&apos;views/&apos;</span>)[<span class=\"hljs-number\">1</span>].<span class=\"hljs-title function_\">split</span>(<span class=\"hljs-string\">&apos;.vue&apos;</span>)[<span class=\"hljs-number\">0</span>];\n    <span class=\"hljs-keyword\">if</span> (dir === view) {\n      res = <span class=\"hljs-function\">() =&gt;</span> modules[path]();\n    }\n  }\n  <span class=\"hljs-keyword\">return</span> res;\n}\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">default</span> usePermissionStore\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"132,274"}}],"payload":{"tag":"h3","lines":"131,132"}},{"content":"store/modules/setting","children":[{"content":"<pre data-lines=\"276,317\"><code class=\"language-js\"><span class=\"hljs-keyword\">import</span> defaultSettings <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&apos;@/settings&apos;</span>\n<span class=\"hljs-keyword\">import</span> { useDynamicTitle } <span class=\"hljs-keyword\">from</span> <span class=\"hljs-string\">&apos;@/utils/dynamicTitle&apos;</span>\n\n<span class=\"hljs-keyword\">const</span> { sideTheme, showSettings, topNav, tagsView, fixedHeader, sidebarLogo, dynamicTitle } = defaultSettings\n\n<span class=\"hljs-keyword\">const</span> storageSetting = <span class=\"hljs-title class_\">JSON</span>.<span class=\"hljs-title function_\">parse</span>(<span class=\"hljs-variable language_\">localStorage</span>.<span class=\"hljs-title function_\">getItem</span>(<span class=\"hljs-string\">&apos;layout-setting&apos;</span>)) || <span class=\"hljs-string\">&apos;&apos;</span>\n\n<span class=\"hljs-keyword\">const</span> useSettingsStore = <span class=\"hljs-title function_\">defineStore</span>(\n  <span class=\"hljs-string\">&apos;settings&apos;</span>,\n  {\n    <span class=\"hljs-attr\">state</span>: <span class=\"hljs-function\">() =&gt;</span> ({\n      <span class=\"hljs-attr\">title</span>: <span class=\"hljs-string\">&apos;&apos;</span>,\n      <span class=\"hljs-attr\">theme</span>: storageSetting.<span class=\"hljs-property\">theme</span> || <span class=\"hljs-string\">&apos;#409EFF&apos;</span>,\n      <span class=\"hljs-attr\">sideTheme</span>: storageSetting.<span class=\"hljs-property\">sideTheme</span> || sideTheme,\n      <span class=\"hljs-attr\">showSettings</span>: showSettings,\n      <span class=\"hljs-attr\">topNav</span>: storageSetting.<span class=\"hljs-property\">topNav</span> === <span class=\"hljs-literal\">undefined</span> ? topNav : storageSetting.<span class=\"hljs-property\">topNav</span>,\n      <span class=\"hljs-attr\">tagsView</span>: storageSetting.<span class=\"hljs-property\">tagsView</span> === <span class=\"hljs-literal\">undefined</span> ? tagsView : storageSetting.<span class=\"hljs-property\">tagsView</span>,\n      <span class=\"hljs-attr\">fixedHeader</span>: storageSetting.<span class=\"hljs-property\">fixedHeader</span> === <span class=\"hljs-literal\">undefined</span> ? fixedHeader : storageSetting.<span class=\"hljs-property\">fixedHeader</span>,\n      <span class=\"hljs-attr\">sidebarLogo</span>: storageSetting.<span class=\"hljs-property\">sidebarLogo</span> === <span class=\"hljs-literal\">undefined</span> ? sidebarLogo : storageSetting.<span class=\"hljs-property\">sidebarLogo</span>,\n      <span class=\"hljs-attr\">dynamicTitle</span>: storageSetting.<span class=\"hljs-property\">dynamicTitle</span> === <span class=\"hljs-literal\">undefined</span> ? dynamicTitle : storageSetting.<span class=\"hljs-property\">dynamicTitle</span>\n    }),\n    <span class=\"hljs-attr\">actions</span>: {\n      <span class=\"hljs-comment\">// &#x4fee;&#x6539;&#x5e03;&#x5c40;&#x8bbe;&#x7f6e;</span>\n      <span class=\"hljs-title function_\">changeSetting</span>(<span class=\"hljs-params\">data</span>) {\n        <span class=\"hljs-keyword\">const</span> { key, value } = data\n        <span class=\"hljs-keyword\">if</span> (<span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-title function_\">hasOwnProperty</span>(key)) {\n          <span class=\"hljs-variable language_\">this</span>[key] = value\n        }\n      },\n      <span class=\"hljs-comment\">// &#x8bbe;&#x7f6e;&#x7f51;&#x9875;&#x6807;&#x9898;</span>\n      <span class=\"hljs-title function_\">setTitle</span>(<span class=\"hljs-params\">title</span>) {\n        <span class=\"hljs-variable language_\">this</span>.<span class=\"hljs-property\">title</span> = title\n        <span class=\"hljs-title function_\">useDynamicTitle</span>();\n      }\n    }\n  })\n\n<span class=\"hljs-keyword\">export</span> <span class=\"hljs-keyword\">default</span> useSettingsStore\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"276,317"}}],"payload":{"tag":"h3","lines":"275,276"}}],"payload":{"tag":"h2","lines":"2,3"}}],"payload":{"tag":"h1","lines":"0,1"}},{})</script>
</body>
</html>
