<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets@11.11.1/styles/default.min.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.18.10/dist/browser/index.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/index.js"></script><script>(r => {
              setTimeout(r);
            })(function renderToolbar() {
  const {
    markmap,
    mm
  } = window;
  const {
    el
  } = markmap.Toolbar.create(mm);
  el.setAttribute('style', 'position:absolute;bottom:20px;right:20px');
  document.body.append(el);
})</script><script>((getMarkmap, getOptions, root2, jsonOptions) => {
              const markmap = getMarkmap();
              window.mm = markmap.Markmap.create(
                "svg#mindmap",
                (getOptions || markmap.deriveOptions)(jsonOptions),
                root2
              );
            })(() => window.markmap,null,{"content":"&#x793a;&#x4f8b;","children":[{"content":"Car","children":[{"content":"Car/Car/spider","children":[{"content":"<pre data-lines=\"14,46\"><code class=\"language-python\"><span class=\"hljs-comment\"># -*- coding: utf-8 -*-</span>\n<span class=\"hljs-keyword\">import</span> scrapy\n<span class=\"hljs-keyword\">from</span> ..items <span class=\"hljs-keyword\">import</span> CarItem\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">CarSpider</span>(scrapy.Spider):\n    name = <span class=\"hljs-string\">&apos;car&apos;</span>\n    allowed_domains = [<span class=\"hljs-string\">&apos;www.guazi.com&apos;</span>]\n    start_urls = [<span class=\"hljs-string\">&apos;https://www.guazi.com/dachang/buy/o1/#bread&apos;</span>]\n    page = <span class=\"hljs-number\">1</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">parse</span>(<span class=\"hljs-params\">self, response</span>):\n        li_list = response.xpath(<span class=\"hljs-string\">&apos;//ul[@class=&quot;carlist clearfix js-top&quot;]/li&apos;</span>)\n        <span class=\"hljs-keyword\">for</span> li <span class=\"hljs-keyword\">in</span> li_list:\n            <span class=\"hljs-comment\"># &#x5728;&#x7ed9; items.py &#x4e2d;&#x7684; CarItem&#x7c7b; &#x5b9e;&#x4f8b;&#x5316;&#x4e86;1&#x4e2a;&#x5bf9;&#x8c61;</span>\n            item = CarItem()\n            item[<span class=\"hljs-string\">&apos;name&apos;</span>] = li.xpath(<span class=\"hljs-string\">&apos;.//h2[@class=&quot;t&quot;]/text()&apos;</span>).get()\n            item[<span class=\"hljs-string\">&apos;price&apos;</span>] = li.xpath(<span class=\"hljs-string\">&apos;.//div[@class=&quot;t-price&quot;]/p/text()&apos;</span>).get()\n            item[<span class=\"hljs-string\">&apos;url&apos;</span>] = li.xpath(<span class=\"hljs-string\">&apos;./a[1]/@href&apos;</span>).get()\n\n            <span class=\"hljs-comment\"># item&#x5bf9;&#x8c61;&#x5c31;&#x662f;&#x9700;&#x8981;&#x4ea4;&#x7ed9;&#x7ba1;&#x9053;&#x7684;&#x6570;&#x636e;</span>\n            <span class=\"hljs-comment\"># &#x6570;&#x636e;&#x4ea4;&#x7ed9;&#x7ba1;&#x9053;&#x6587;&#x4ef6;&#x7684;&#x65b9;&#x6cd5;&#xff1a;yield item</span>\n            <span class=\"hljs-keyword\">yield</span> item\n\n        <span class=\"hljs-comment\"># &#x751f;&#x6210;&#x4e0b;&#x4e00;&#x9875;&#x7684;URL&#x5730;&#x5740;,&#x4ea4;&#x7ed9;&#x8c03;&#x5ea6;&#x5668;&#x5165;&#x961f;&#x5217;</span>\n        <span class=\"hljs-comment\"># scrapy.Request():&#x628a;&#x8bf7;&#x6c42;&#x4ea4;&#x7ed9;&#x8c03;&#x5ea6;&#x5668;&#x5165;&#x961f;&#x5217;,&#x8fd4;&#x56de;&#x7684;response&#x627e;callback&#x89e3;&#x6790;&#x51fd;&#x6570;&#x505a;&#x5904;&#x7406;</span>\n        <span class=\"hljs-keyword\">if</span> <span class=\"hljs-variable language_\">self</span>.page &lt; <span class=\"hljs-number\">5</span>:\n            <span class=\"hljs-variable language_\">self</span>.page += <span class=\"hljs-number\">1</span>\n            url = <span class=\"hljs-string\">&apos;https://www.guazi.com/dachang/buy/o{}/#bread&apos;</span>.<span class=\"hljs-built_in\">format</span>(<span class=\"hljs-variable language_\">self</span>.page)\n            <span class=\"hljs-keyword\">yield</span> scrapy.Request(url=url, callback=<span class=\"hljs-variable language_\">self</span>.parse)\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"14,46"}},{"content":"<pre data-lines=\"47,78\"><code class=\"language-python\"><span class=\"hljs-comment\"># -*- coding: utf-8 -*-</span>\n<span class=\"hljs-keyword\">import</span> scrapy\n<span class=\"hljs-keyword\">from</span> ..items <span class=\"hljs-keyword\">import</span> CarItem\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">CarSpider</span>(scrapy.Spider):\n    name = <span class=\"hljs-string\">&apos;car2&apos;</span>\n    allowed_domains = [<span class=\"hljs-string\">&apos;www.guazi.com&apos;</span>]\n\n    <span class=\"hljs-comment\"># &#x91cd;&#x5199;Spider&#x7c7b;&#x7684; start_requests() &#x65b9;&#x6cd5;</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">start_requests</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x751f;&#x6210;&#x6240;&#x6709;&#x8981;&#x6293;&#x53d6;&#x7684;URL&#x5730;&#x5740;,&#x4ea4;&#x7ed9;&#x8c03;&#x5ea6;&#x5668;&#x5165;&#x961f;&#x5217;&quot;&quot;&quot;</span>\n        <span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(<span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">6</span>):\n            url = <span class=\"hljs-string\">&apos;https://www.guazi.com/dachang/buy/o{}/#bread&apos;</span>.<span class=\"hljs-built_in\">format</span>(i)\n            <span class=\"hljs-comment\"># scrapy.Request() &#x4ea4;&#x7ed9;&#x8c03;&#x5ea6;&#x5668;&#x5165;&#x961f;&#x5217;</span>\n            <span class=\"hljs-keyword\">yield</span> scrapy.Request(url=url, callback=<span class=\"hljs-variable language_\">self</span>.parse_html)\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">parse_html</span>(<span class=\"hljs-params\">self, response</span>):\n        li_list = response.xpath(<span class=\"hljs-string\">&apos;//ul[@class=&quot;carlist clearfix js-top&quot;]/li&apos;</span>)\n        <span class=\"hljs-keyword\">for</span> li <span class=\"hljs-keyword\">in</span> li_list:\n            <span class=\"hljs-comment\"># &#x5728;&#x7ed9; items.py &#x4e2d;&#x7684; CarItem&#x7c7b; &#x5b9e;&#x4f8b;&#x5316;&#x4e86;1&#x4e2a;&#x5bf9;&#x8c61;</span>\n            item = CarItem()\n            item[<span class=\"hljs-string\">&apos;name&apos;</span>] = li.xpath(<span class=\"hljs-string\">&apos;.//h2[@class=&quot;t&quot;]/text()&apos;</span>).get()\n            item[<span class=\"hljs-string\">&apos;price&apos;</span>] = li.xpath(<span class=\"hljs-string\">&apos;.//div[@class=&quot;t-price&quot;]/p/text()&apos;</span>).get()\n            item[<span class=\"hljs-string\">&apos;url&apos;</span>] = li.xpath(<span class=\"hljs-string\">&apos;./a[1]/@href&apos;</span>).get()\n\n            <span class=\"hljs-comment\"># item&#x5bf9;&#x8c61;&#x5c31;&#x662f;&#x9700;&#x8981;&#x4ea4;&#x7ed9;&#x7ba1;&#x9053;&#x7684;&#x6570;&#x636e;</span>\n            <span class=\"hljs-comment\"># &#x6570;&#x636e;&#x4ea4;&#x7ed9;&#x7ba1;&#x9053;&#x6587;&#x4ef6;&#x7684;&#x65b9;&#x6cd5;&#xff1a;yield item</span>\n            <span class=\"hljs-keyword\">yield</span> item\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"47,78"}}],"payload":{"tag":"h5","lines":"12,13"}},{"content":"Car/Car","children":[{"content":"<pre data-lines=\"83,105\"><code class=\"language-python\"><span class=\"hljs-comment\"># -*- coding: utf-8 -*-</span>\n\n<span class=\"hljs-comment\"># Define here the models for your scraped items</span>\n<span class=\"hljs-comment\">#</span>\n<span class=\"hljs-comment\"># See documentation in:</span>\n<span class=\"hljs-comment\"># https://doc.scrapy.org/en/latest/topics/items.html</span>\n\n<span class=\"hljs-keyword\">import</span> scrapy\n\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">CarItem</span>(scrapy.Item):\n    <span class=\"hljs-comment\"># define the fields for your item here like:</span>\n    <span class=\"hljs-comment\"># name = scrapy.Field()</span>\n    <span class=\"hljs-comment\"># &#x6c7d;&#x8f66;&#x540d;&#x79f0;&#x3001;&#x94fe;&#x63a5;&#x3001;&#x4ef7;&#x683c;</span>\n    name = scrapy.Field()\n    url = scrapy.Field()\n    price = scrapy.Field()\n\n<span class=\"hljs-comment\"># &#x76f8;&#x5f53;&#x4e8e;&#xff1a; {&apos;name&apos;:&apos;&apos;,&apos;url&apos;:&apos;&apos;,&apos;price&apos;:&apos;&apos;}</span>\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"83,105"}},{"content":"<pre data-lines=\"106,212\"><code class=\"language-python\"><span class=\"hljs-comment\"># -*- coding: utf-8 -*-</span>\n\n<span class=\"hljs-comment\"># Define here the models for your spider middleware</span>\n<span class=\"hljs-comment\">#</span>\n<span class=\"hljs-comment\"># See documentation in:</span>\n<span class=\"hljs-comment\"># https://doc.scrapy.org/en/latest/topics/spider-middleware.html</span>\n\n<span class=\"hljs-keyword\">from</span> scrapy <span class=\"hljs-keyword\">import</span> signals\n\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">CarSpiderMiddleware</span>(<span class=\"hljs-title class_ inherited__\">object</span>):\n    <span class=\"hljs-comment\"># Not all methods need to be defined. If a method is not defined,</span>\n    <span class=\"hljs-comment\"># scrapy acts as if the spider middleware does not modify the</span>\n    <span class=\"hljs-comment\"># passed objects.</span>\n\n<span class=\"hljs-meta\">    @classmethod</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">from_crawler</span>(<span class=\"hljs-params\">cls, crawler</span>):\n        <span class=\"hljs-comment\"># This method is used by Scrapy to create your spiders.</span>\n        s = cls()\n        crawler.signals.connect(s.spider_opened, signal=signals.spider_opened)\n        <span class=\"hljs-keyword\">return</span> s\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_spider_input</span>(<span class=\"hljs-params\">self, response, spider</span>):\n        <span class=\"hljs-comment\"># Called for each response that goes through the spider</span>\n        <span class=\"hljs-comment\"># middleware and into the spider.</span>\n\n        <span class=\"hljs-comment\"># Should return None or raise an exception.</span>\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">None</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_spider_output</span>(<span class=\"hljs-params\">self, response, result, spider</span>):\n        <span class=\"hljs-comment\"># Called with the results returned from the Spider, after</span>\n        <span class=\"hljs-comment\"># it has processed the response.</span>\n\n        <span class=\"hljs-comment\"># Must return an iterable of Request, dict or Item objects.</span>\n        <span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> result:\n            <span class=\"hljs-keyword\">yield</span> i\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_spider_exception</span>(<span class=\"hljs-params\">self, response, exception, spider</span>):\n        <span class=\"hljs-comment\"># Called when a spider or process_spider_input() method</span>\n        <span class=\"hljs-comment\"># (from other spider middleware) raises an exception.</span>\n\n        <span class=\"hljs-comment\"># Should return either None or an iterable of Response, dict</span>\n        <span class=\"hljs-comment\"># or Item objects.</span>\n        <span class=\"hljs-keyword\">pass</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_start_requests</span>(<span class=\"hljs-params\">self, start_requests, spider</span>):\n        <span class=\"hljs-comment\"># Called with the start requests of the spider, and works</span>\n        <span class=\"hljs-comment\"># similarly to the process_spider_output() method, except</span>\n        <span class=\"hljs-comment\"># that it doesn&#x2019;t have a response associated.</span>\n\n        <span class=\"hljs-comment\"># Must return only requests (not items).</span>\n        <span class=\"hljs-keyword\">for</span> r <span class=\"hljs-keyword\">in</span> start_requests:\n            <span class=\"hljs-keyword\">yield</span> r\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">spider_opened</span>(<span class=\"hljs-params\">self, spider</span>):\n        spider.logger.info(<span class=\"hljs-string\">&apos;Spider opened: %s&apos;</span> % spider.name)\n\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">CarDownloaderMiddleware</span>(<span class=\"hljs-title class_ inherited__\">object</span>):\n    <span class=\"hljs-comment\"># Not all methods need to be defined. If a method is not defined,</span>\n    <span class=\"hljs-comment\"># scrapy acts as if the downloader middleware does not modify the</span>\n    <span class=\"hljs-comment\"># passed objects.</span>\n\n<span class=\"hljs-meta\">    @classmethod</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">from_crawler</span>(<span class=\"hljs-params\">cls, crawler</span>):\n        <span class=\"hljs-comment\"># This method is used by Scrapy to create your spiders.</span>\n        s = cls()\n        crawler.signals.connect(s.spider_opened, signal=signals.spider_opened)\n        <span class=\"hljs-keyword\">return</span> s\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_request</span>(<span class=\"hljs-params\">self, request, spider</span>):\n        <span class=\"hljs-comment\"># Called for each request that goes through the downloader</span>\n        <span class=\"hljs-comment\"># middleware.</span>\n\n        <span class=\"hljs-comment\"># Must either:</span>\n        <span class=\"hljs-comment\"># - return None: continue processing this request</span>\n        <span class=\"hljs-comment\"># - or return a Response object</span>\n        <span class=\"hljs-comment\"># - or return a Request object</span>\n        <span class=\"hljs-comment\"># - or raise IgnoreRequest: process_exception() methods of</span>\n        <span class=\"hljs-comment\">#   installed downloader middleware will be called</span>\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">None</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_response</span>(<span class=\"hljs-params\">self, request, response, spider</span>):\n        <span class=\"hljs-comment\"># Called with the response returned from the downloader.</span>\n\n        <span class=\"hljs-comment\"># Must either;</span>\n        <span class=\"hljs-comment\"># - return a Response object</span>\n        <span class=\"hljs-comment\"># - return a Request object</span>\n        <span class=\"hljs-comment\"># - or raise IgnoreRequest</span>\n        <span class=\"hljs-keyword\">return</span> response\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_exception</span>(<span class=\"hljs-params\">self, request, exception, spider</span>):\n        <span class=\"hljs-comment\"># Called when a download handler or a process_request()</span>\n        <span class=\"hljs-comment\"># (from other downloader middleware) raises an exception.</span>\n\n        <span class=\"hljs-comment\"># Must either:</span>\n        <span class=\"hljs-comment\"># - return None: continue processing this exception</span>\n        <span class=\"hljs-comment\"># - return a Response object: stops process_exception() chain</span>\n        <span class=\"hljs-comment\"># - return a Request object: stops process_exception() chain</span>\n        <span class=\"hljs-keyword\">pass</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">spider_opened</span>(<span class=\"hljs-params\">self, spider</span>):\n        spider.logger.info(<span class=\"hljs-string\">&apos;Spider opened: %s&apos;</span> % spider.name)\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"106,212"}},{"content":"<pre data-lines=\"213,263\"><code class=\"language-python\"><span class=\"hljs-comment\"># -*- coding: utf-8 -*-</span>\n\n<span class=\"hljs-comment\"># Define your item pipelines here</span>\n<span class=\"hljs-comment\">#</span>\n<span class=\"hljs-comment\"># Don&apos;t forget to add your pipeline to the ITEM_PIPELINES setting</span>\n<span class=\"hljs-comment\"># See: https://doc.scrapy.org/en/latest/topics/item-pipeline.html</span>\n\n<span class=\"hljs-comment\"># &#x7ba1;&#x9053;1 - &#x7ec8;&#x7aef;&#x6253;&#x5370;&#x8f93;&#x51fa;</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">CarPipeline</span>(<span class=\"hljs-title class_ inherited__\">object</span>):\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_item</span>(<span class=\"hljs-params\">self, item, spider</span>):\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&apos;*&apos;</span> * <span class=\"hljs-number\">50</span>)\n        <span class=\"hljs-built_in\">print</span>(item[<span class=\"hljs-string\">&apos;name&apos;</span>],item[<span class=\"hljs-string\">&apos;price&apos;</span>],item[<span class=\"hljs-string\">&apos;url&apos;</span>])\n        <span class=\"hljs-keyword\">return</span> item\n\n<span class=\"hljs-comment\"># &#x7ba1;&#x9053;2 - &#x5b58;&#x5165;MySQL&#x6570;&#x636e;&#x5e93;</span>\n<span class=\"hljs-keyword\">import</span> pymysql\n<span class=\"hljs-keyword\">from</span> .settings <span class=\"hljs-keyword\">import</span> *\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">CarMysqlPipeline</span>(<span class=\"hljs-title class_ inherited__\">object</span>):\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">open_spider</span>(<span class=\"hljs-params\">self, spider</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x722c;&#x866b;&#x9879;&#x76ee;&#x542f;&#x52a8;&#x65f6;,&#x53ea;&#x6267;&#x884c;1&#x6b21;,&#x4e00;&#x822c;&#x7528;&#x4e8e;&#x6570;&#x636e;&#x5e93;&#x7684;&#x8fde;&#x63a5;&quot;&quot;&quot;</span>\n        <span class=\"hljs-variable language_\">self</span>.db = pymysql.connect(MYSQL_HOST,MYSQL_USER,MYSQL_PWD,MYSQL_DB,charset=CHARSET)\n        <span class=\"hljs-variable language_\">self</span>.cursor = <span class=\"hljs-variable language_\">self</span>.db.cursor()\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_item</span>(<span class=\"hljs-params\">self, item, spider</span>):\n        ins = <span class=\"hljs-string\">&apos;insert into cartab values(%s,%s,%s)&apos;</span>\n        <span class=\"hljs-variable language_\">self</span>.cursor.execute(ins,[ item[<span class=\"hljs-string\">&apos;name&apos;</span>],item[<span class=\"hljs-string\">&apos;price&apos;</span>],item[<span class=\"hljs-string\">&apos;url&apos;</span>] ])\n        <span class=\"hljs-variable language_\">self</span>.db.commit()\n        <span class=\"hljs-keyword\">return</span> item\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">close_spider</span>(<span class=\"hljs-params\">self, spider</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x722c;&#x866b;&#x9879;&#x76ee;&#x7ed3;&#x675f;&#x65f6;,&#x53ea;&#x6267;&#x884c;1&#x6b21;,&#x4e00;&#x822c;&#x7528;&#x4e8e;&#x6570;&#x636e;&#x5e93;&#x7684;&#x65ad;&#x5f00;&quot;&quot;&quot;</span>\n        <span class=\"hljs-variable language_\">self</span>.cursor.close()\n        <span class=\"hljs-variable language_\">self</span>.db.close()\n\n<span class=\"hljs-comment\"># &#x7ba1;&#x9053;3 - &#x5b58;&#x5165;mongodb&#x6570;&#x636e;&#x5e93;</span>\n<span class=\"hljs-keyword\">import</span> pymongo\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">CarMongoPipeline</span>(<span class=\"hljs-title class_ inherited__\">object</span>):\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">open_spider</span>(<span class=\"hljs-params\">self, spider</span>):\n        <span class=\"hljs-variable language_\">self</span>.conn = pymongo.MongoClient(MONGO_HOST, MONGO_PORT)\n        <span class=\"hljs-variable language_\">self</span>.db = <span class=\"hljs-variable language_\">self</span>.conn[MONGO_DB]\n        <span class=\"hljs-variable language_\">self</span>.myset = <span class=\"hljs-variable language_\">self</span>.db[MONGO_SET]\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_item</span>(<span class=\"hljs-params\">self, item, spider</span>):\n        <span class=\"hljs-variable language_\">self</span>.myset.insert_one(<span class=\"hljs-built_in\">dict</span>(item))\n        <span class=\"hljs-keyword\">return</span> item\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"213,263"}},{"content":"<pre data-lines=\"264,383\"><code class=\"language-python\"><span class=\"hljs-comment\"># -*- coding: utf-8 -*-</span>\n\n<span class=\"hljs-comment\"># Scrapy settings for Car project</span>\n<span class=\"hljs-comment\">#</span>\n<span class=\"hljs-comment\"># For simplicity, this file contains only settings considered important or</span>\n<span class=\"hljs-comment\"># commonly used. You can find more settings consulting the documentation:</span>\n<span class=\"hljs-comment\">#</span>\n<span class=\"hljs-comment\">#     https://doc.scrapy.org/en/latest/topics/settings.html</span>\n<span class=\"hljs-comment\">#     https://doc.scrapy.org/en/latest/topics/downloader-middleware.html</span>\n<span class=\"hljs-comment\">#     https://doc.scrapy.org/en/latest/topics/spider-middleware.html</span>\n\nBOT_NAME = <span class=\"hljs-string\">&apos;Car&apos;</span>\n\nSPIDER_MODULES = [<span class=\"hljs-string\">&apos;Car.spiders&apos;</span>]\nNEWSPIDER_MODULE = <span class=\"hljs-string\">&apos;Car.spiders&apos;</span>\n\n\n<span class=\"hljs-comment\"># Crawl responsibly by identifying yourself (and your website) on the user-agent</span>\n<span class=\"hljs-comment\">#USER_AGENT = &apos;Car (+http://www.yourdomain.com)&apos;</span>\n\n<span class=\"hljs-comment\"># Obey robots.txt rules</span>\nROBOTSTXT_OBEY = <span class=\"hljs-literal\">False</span>\n\n<span class=\"hljs-comment\"># &#x8bbe;&#x7f6e;&#x65e5;&#x5fd7;&#x7ea7;&#x522b;</span>\n<span class=\"hljs-comment\"># LOG_LEVEL = &apos;DEBUG&apos;</span>\n<span class=\"hljs-comment\"># LOG_FILE = &apos;car.log&apos;</span>\n\n<span class=\"hljs-comment\"># &#x8bbe;&#x7f6e;&#x5bfc;&#x51fa;&#x6587;&#x4ef6;&#x7f16;&#x7801;</span>\nFEED_EXPORT_ENCODING = <span class=\"hljs-string\">&apos;utf-8&apos;</span>\n\n<span class=\"hljs-comment\"># Configure maximum concurrent requests performed by Scrapy (default: 16)</span>\n<span class=\"hljs-comment\">#CONCURRENT_REQUESTS = 32</span>\n\n<span class=\"hljs-comment\"># Configure a delay for requests for the same website (default: 0)</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/settings.html#download-delay</span>\n<span class=\"hljs-comment\"># See also autothrottle settings and docs</span>\n<span class=\"hljs-comment\">#DOWNLOAD_DELAY = 3</span>\n<span class=\"hljs-comment\"># The download delay setting will honor only one of:</span>\n<span class=\"hljs-comment\">#CONCURRENT_REQUESTS_PER_DOMAIN = 16</span>\n<span class=\"hljs-comment\">#CONCURRENT_REQUESTS_PER_IP = 16</span>\n\n<span class=\"hljs-comment\"># Disable cookies (enabled by default)</span>\nCOOKIES_ENABLED = <span class=\"hljs-literal\">False</span>\n\n<span class=\"hljs-comment\"># Disable Telnet Console (enabled by default)</span>\n<span class=\"hljs-comment\">#TELNETCONSOLE_ENABLED = False</span>\n\n<span class=\"hljs-comment\"># Override the default request headers:</span>\nDEFAULT_REQUEST_HEADERS = {\n  <span class=\"hljs-string\">&apos;Accept&apos;</span>: <span class=\"hljs-string\">&apos;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&apos;</span>,\n  <span class=\"hljs-string\">&apos;Accept-Language&apos;</span>: <span class=\"hljs-string\">&apos;en&apos;</span>,\n  <span class=\"hljs-string\">&apos;Cookie&apos;</span> : <span class=\"hljs-string\">&apos;antipas=3g35lm41V408p5832Cp050B49m41; uuid=05611c70-8e38-4a82-c7d5-02a86e74c090; ganji_uuid=5484236533304847117197; lg=1; clueSourceCode=%2A%2300; user_city_id=1001737; sessionid=9f77ed86-3678-4c0f-e566-b2a895774901; close_finance_popup=2020-03-27; cainfo=%7B%22ca_a%22%3A%22-%22%2C%22ca_b%22%3A%22-%22%2C%22ca_s%22%3A%22self%22%2C%22ca_n%22%3A%22self%22%2C%22ca_medium%22%3A%22-%22%2C%22ca_term%22%3A%22-%22%2C%22ca_content%22%3A%22-%22%2C%22ca_campaign%22%3A%22-%22%2C%22ca_kw%22%3A%22-%22%2C%22ca_i%22%3A%22-%22%2C%22scode%22%3A%22-%22%2C%22keyword%22%3A%22-%22%2C%22ca_keywordid%22%3A%22-%22%2C%22display_finance_flag%22%3A%22-%22%2C%22platform%22%3A%221%22%2C%22version%22%3A1%2C%22client_ab%22%3A%22-%22%2C%22guid%22%3A%2205611c70-8e38-4a82-c7d5-02a86e74c090%22%2C%22ca_city%22%3A%22langfang%22%2C%22sessionid%22%3A%229f77ed86-3678-4c0f-e566-b2a895774901%22%7D; cityDomain=dachang; preTime=%7B%22last%22%3A1585275757%2C%22this%22%3A1585128131%2C%22pre%22%3A1585128131%7D&apos;</span>,\n  <span class=\"hljs-string\">&apos;User-Agent&apos;</span> : <span class=\"hljs-string\">&apos;Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36&apos;</span>\n}\n\n<span class=\"hljs-comment\"># Enable or disable spider middlewares</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/spider-middleware.html</span>\n<span class=\"hljs-comment\">#SPIDER_MIDDLEWARES = {</span>\n<span class=\"hljs-comment\">#    &apos;Car.middlewares.CarSpiderMiddleware&apos;: 543,</span>\n<span class=\"hljs-comment\">#}</span>\n\n<span class=\"hljs-comment\"># Enable or disable downloader middlewares</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/downloader-middleware.html</span>\n<span class=\"hljs-comment\">#DOWNLOADER_MIDDLEWARES = {</span>\n<span class=\"hljs-comment\">#    &apos;Car.middlewares.CarDownloaderMiddleware&apos;: 543,</span>\n<span class=\"hljs-comment\">#}</span>\n\n<span class=\"hljs-comment\"># Enable or disable extensions</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/extensions.html</span>\n<span class=\"hljs-comment\">#EXTENSIONS = {</span>\n<span class=\"hljs-comment\">#    &apos;scrapy.extensions.telnet.TelnetConsole&apos;: None,</span>\n<span class=\"hljs-comment\">#}</span>\n\n<span class=\"hljs-comment\"># Configure item pipelines</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/item-pipeline.html</span>\n<span class=\"hljs-comment\"># &#x5f00;&#x542f;&#x7ba1;&#x9053;</span>\nITEM_PIPELINES = {\n   <span class=\"hljs-comment\"># &apos;&#x9879;&#x76ee;&#x76ee;&#x5f55;&#x540d;.&#x6a21;&#x5757;&#x540d;.&#x7c7b;&#x540d;&apos; : &#x4f18;&#x5148;&#x7ea7; (&#x4ece;1-1000&#x4e0d;&#x7b49;,&#x6570;&#x5b57;&#x8d8a;&#x5c0f;,&#x4f18;&#x5148;&#x7ea7;&#x8d8a;&#x9ad8;)</span>\n   <span class=\"hljs-string\">&apos;Car.pipelines.CarPipeline&apos;</span>: <span class=\"hljs-number\">300</span>,\n   <span class=\"hljs-string\">&apos;Car.pipelines.CarMysqlPipeline&apos;</span>: <span class=\"hljs-number\">100</span>,\n   <span class=\"hljs-string\">&apos;Car.pipelines.CarMongoPipeline&apos;</span>: <span class=\"hljs-number\">200</span>,\n}\n\n<span class=\"hljs-comment\"># Enable and configure the AutoThrottle extension (disabled by default)</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/autothrottle.html</span>\n<span class=\"hljs-comment\">#AUTOTHROTTLE_ENABLED = True</span>\n<span class=\"hljs-comment\"># The initial download delay</span>\n<span class=\"hljs-comment\">#AUTOTHROTTLE_START_DELAY = 5</span>\n<span class=\"hljs-comment\"># The maximum download delay to be set in case of high latencies</span>\n<span class=\"hljs-comment\">#AUTOTHROTTLE_MAX_DELAY = 60</span>\n<span class=\"hljs-comment\"># The average number of requests Scrapy should be sending in parallel to</span>\n<span class=\"hljs-comment\"># each remote server</span>\n<span class=\"hljs-comment\">#AUTOTHROTTLE_TARGET_CONCURRENCY = 1.0</span>\n<span class=\"hljs-comment\"># Enable showing throttling stats for every response received:</span>\n<span class=\"hljs-comment\">#AUTOTHROTTLE_DEBUG = False</span>\n\n<span class=\"hljs-comment\"># Enable and configure HTTP caching (disabled by default)</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/downloader-middleware.html#httpcache-middleware-settings</span>\n<span class=\"hljs-comment\">#HTTPCACHE_ENABLED = True</span>\n<span class=\"hljs-comment\">#HTTPCACHE_EXPIRATION_SECS = 0</span>\n<span class=\"hljs-comment\">#HTTPCACHE_DIR = &apos;httpcache&apos;</span>\n<span class=\"hljs-comment\">#HTTPCACHE_IGNORE_HTTP_CODES = []</span>\n<span class=\"hljs-comment\">#HTTPCACHE_STORAGE = &apos;scrapy.extensions.httpcache.FilesystemCacheStorage&apos;</span>\n\n<span class=\"hljs-comment\"># &#x5b9a;&#x4e49;MySQL&#x76f8;&#x5173;&#x53d8;&#x91cf;</span>\nMYSQL_HOST = <span class=\"hljs-string\">&apos;127.0.0.1&apos;</span>\nMYSQL_USER = <span class=\"hljs-string\">&apos;root&apos;</span>\nMYSQL_PWD = <span class=\"hljs-string\">&apos;123456&apos;</span>\nMYSQL_DB = <span class=\"hljs-string\">&apos;cardb&apos;</span>\nCHARSET = <span class=\"hljs-string\">&apos;utf8&apos;</span>\n\n<span class=\"hljs-comment\"># &#x5b9a;&#x4e49; mongodb &#x76f8;&#x5173;&#x53d8;&#x91cf;</span>\nMONGO_HOST = <span class=\"hljs-string\">&apos;127.0.0.1&apos;</span>\nMONGO_PORT = <span class=\"hljs-number\">27017</span>\nMONGO_DB = <span class=\"hljs-string\">&apos;cardb&apos;</span>\nMONGO_SET = <span class=\"hljs-string\">&apos;carset&apos;</span>\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"264,383"}}],"payload":{"tag":"h5","lines":"81,82"}}],"payload":{"tag":"h4","lines":"2,3"}},{"content":"Car2","children":[{"content":"Car2/Carpython","children":[{"content":"<pre data-lines=\"394,421\"><code class=\"language-python\"><span class=\"hljs-comment\"># -*- coding: utf-8 -*-</span>\n\n<span class=\"hljs-comment\"># Define here the models for your scraped items</span>\n<span class=\"hljs-comment\">#</span>\n<span class=\"hljs-comment\"># See documentation in:</span>\n<span class=\"hljs-comment\"># https://doc.scrapy.org/en/latest/topics/items.html</span>\n\n<span class=\"hljs-keyword\">import</span> scrapy\n\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">CarItem</span>(scrapy.Item):\n    <span class=\"hljs-comment\"># define the fields for your item here like:</span>\n    <span class=\"hljs-comment\"># name = scrapy.Field()</span>\n    <span class=\"hljs-comment\"># &#x6c7d;&#x8f66;&#x540d;&#x79f0;&#x3001;&#x94fe;&#x63a5;&#x3001;&#x4ef7;&#x683c;</span>\n    name = scrapy.Field()\n    url = scrapy.Field()\n    price = scrapy.Field()\n    <span class=\"hljs-comment\"># &#x4e8c;&#x7ea7;&#x9875;&#x9762;: &#x4e0a;&#x724c;&#x65f6;&#x95f4;&#x3001;&#x884c;&#x9a76;&#x91cc;&#x7a0b;&#x3001;&#x6392;&#x91cf;&#x3001;&#x53d8;&#x901f;&#x7bb1;</span>\n    time = scrapy.Field()\n    km = scrapy.Field()\n    disp = scrapy.Field()\n    trans = scrapy.Field()\n\n<span class=\"hljs-comment\"># &#x76f8;&#x5f53;&#x4e8e;&#xff1a; {&apos;name&apos;:&apos;&apos;,&apos;url&apos;:&apos;&apos;,&apos;price&apos;:&apos;&apos;}</span>\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"394,421"}},{"content":"<pre data-lines=\"422,528\"><code class=\"language-python\"><span class=\"hljs-comment\"># -*- coding: utf-8 -*-</span>\n\n<span class=\"hljs-comment\"># Define here the models for your spider middleware</span>\n<span class=\"hljs-comment\">#</span>\n<span class=\"hljs-comment\"># See documentation in:</span>\n<span class=\"hljs-comment\"># https://doc.scrapy.org/en/latest/topics/spider-middleware.html</span>\n\n<span class=\"hljs-keyword\">from</span> scrapy <span class=\"hljs-keyword\">import</span> signals\n\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">CarSpiderMiddleware</span>(<span class=\"hljs-title class_ inherited__\">object</span>):\n    <span class=\"hljs-comment\"># Not all methods need to be defined. If a method is not defined,</span>\n    <span class=\"hljs-comment\"># scrapy acts as if the spider middleware does not modify the</span>\n    <span class=\"hljs-comment\"># passed objects.</span>\n\n<span class=\"hljs-meta\">    @classmethod</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">from_crawler</span>(<span class=\"hljs-params\">cls, crawler</span>):\n        <span class=\"hljs-comment\"># This method is used by Scrapy to create your spiders.</span>\n        s = cls()\n        crawler.signals.connect(s.spider_opened, signal=signals.spider_opened)\n        <span class=\"hljs-keyword\">return</span> s\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_spider_input</span>(<span class=\"hljs-params\">self, response, spider</span>):\n        <span class=\"hljs-comment\"># Called for each response that goes through the spider</span>\n        <span class=\"hljs-comment\"># middleware and into the spider.</span>\n\n        <span class=\"hljs-comment\"># Should return None or raise an exception.</span>\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">None</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_spider_output</span>(<span class=\"hljs-params\">self, response, result, spider</span>):\n        <span class=\"hljs-comment\"># Called with the results returned from the Spider, after</span>\n        <span class=\"hljs-comment\"># it has processed the response.</span>\n\n        <span class=\"hljs-comment\"># Must return an iterable of Request, dict or Item objects.</span>\n        <span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> result:\n            <span class=\"hljs-keyword\">yield</span> i\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_spider_exception</span>(<span class=\"hljs-params\">self, response, exception, spider</span>):\n        <span class=\"hljs-comment\"># Called when a spider or process_spider_input() method</span>\n        <span class=\"hljs-comment\"># (from other spider middleware) raises an exception.</span>\n\n        <span class=\"hljs-comment\"># Should return either None or an iterable of Response, dict</span>\n        <span class=\"hljs-comment\"># or Item objects.</span>\n        <span class=\"hljs-keyword\">pass</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_start_requests</span>(<span class=\"hljs-params\">self, start_requests, spider</span>):\n        <span class=\"hljs-comment\"># Called with the start requests of the spider, and works</span>\n        <span class=\"hljs-comment\"># similarly to the process_spider_output() method, except</span>\n        <span class=\"hljs-comment\"># that it doesn&#x2019;t have a response associated.</span>\n\n        <span class=\"hljs-comment\"># Must return only requests (not items).</span>\n        <span class=\"hljs-keyword\">for</span> r <span class=\"hljs-keyword\">in</span> start_requests:\n            <span class=\"hljs-keyword\">yield</span> r\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">spider_opened</span>(<span class=\"hljs-params\">self, spider</span>):\n        spider.logger.info(<span class=\"hljs-string\">&apos;Spider opened: %s&apos;</span> % spider.name)\n\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">CarDownloaderMiddleware</span>(<span class=\"hljs-title class_ inherited__\">object</span>):\n    <span class=\"hljs-comment\"># Not all methods need to be defined. If a method is not defined,</span>\n    <span class=\"hljs-comment\"># scrapy acts as if the downloader middleware does not modify the</span>\n    <span class=\"hljs-comment\"># passed objects.</span>\n\n<span class=\"hljs-meta\">    @classmethod</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">from_crawler</span>(<span class=\"hljs-params\">cls, crawler</span>):\n        <span class=\"hljs-comment\"># This method is used by Scrapy to create your spiders.</span>\n        s = cls()\n        crawler.signals.connect(s.spider_opened, signal=signals.spider_opened)\n        <span class=\"hljs-keyword\">return</span> s\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_request</span>(<span class=\"hljs-params\">self, request, spider</span>):\n        <span class=\"hljs-comment\"># Called for each request that goes through the downloader</span>\n        <span class=\"hljs-comment\"># middleware.</span>\n\n        <span class=\"hljs-comment\"># Must either:</span>\n        <span class=\"hljs-comment\"># - return None: continue processing this request</span>\n        <span class=\"hljs-comment\"># - or return a Response object</span>\n        <span class=\"hljs-comment\"># - or return a Request object</span>\n        <span class=\"hljs-comment\"># - or raise IgnoreRequest: process_exception() methods of</span>\n        <span class=\"hljs-comment\">#   installed downloader middleware will be called</span>\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">None</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_response</span>(<span class=\"hljs-params\">self, request, response, spider</span>):\n        <span class=\"hljs-comment\"># Called with the response returned from the downloader.</span>\n\n        <span class=\"hljs-comment\"># Must either;</span>\n        <span class=\"hljs-comment\"># - return a Response object</span>\n        <span class=\"hljs-comment\"># - return a Request object</span>\n        <span class=\"hljs-comment\"># - or raise IgnoreRequest</span>\n        <span class=\"hljs-keyword\">return</span> response\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_exception</span>(<span class=\"hljs-params\">self, request, exception, spider</span>):\n        <span class=\"hljs-comment\"># Called when a download handler or a process_request()</span>\n        <span class=\"hljs-comment\"># (from other downloader middleware) raises an exception.</span>\n\n        <span class=\"hljs-comment\"># Must either:</span>\n        <span class=\"hljs-comment\"># - return None: continue processing this exception</span>\n        <span class=\"hljs-comment\"># - return a Response object: stops process_exception() chain</span>\n        <span class=\"hljs-comment\"># - return a Request object: stops process_exception() chain</span>\n        <span class=\"hljs-keyword\">pass</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">spider_opened</span>(<span class=\"hljs-params\">self, spider</span>):\n        spider.logger.info(<span class=\"hljs-string\">&apos;Spider opened: %s&apos;</span> % spider.name)\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"422,528"}},{"content":"<pre data-lines=\"529,579\"><code class=\"language-python\"><span class=\"hljs-comment\"># -*- coding: utf-8 -*-</span>\n\n<span class=\"hljs-comment\"># Define your item pipelines here</span>\n<span class=\"hljs-comment\">#</span>\n<span class=\"hljs-comment\"># Don&apos;t forget to add your pipeline to the ITEM_PIPELINES setting</span>\n<span class=\"hljs-comment\"># See: https://doc.scrapy.org/en/latest/topics/item-pipeline.html</span>\n\n<span class=\"hljs-comment\"># &#x7ba1;&#x9053;1 - &#x7ec8;&#x7aef;&#x6253;&#x5370;&#x8f93;&#x51fa;</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">CarPipeline</span>(<span class=\"hljs-title class_ inherited__\">object</span>):\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_item</span>(<span class=\"hljs-params\">self, item, spider</span>):\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&apos;*&apos;</span> * <span class=\"hljs-number\">50</span>)\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-built_in\">dict</span>(item))\n        <span class=\"hljs-keyword\">return</span> item\n\n<span class=\"hljs-comment\"># &#x7ba1;&#x9053;2 - &#x5b58;&#x5165;MySQL&#x6570;&#x636e;&#x5e93;</span>\n<span class=\"hljs-keyword\">import</span> pymysql\n<span class=\"hljs-keyword\">from</span> .settings <span class=\"hljs-keyword\">import</span> *\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">CarMysqlPipeline</span>(<span class=\"hljs-title class_ inherited__\">object</span>):\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">open_spider</span>(<span class=\"hljs-params\">self, spider</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x722c;&#x866b;&#x9879;&#x76ee;&#x542f;&#x52a8;&#x65f6;,&#x53ea;&#x6267;&#x884c;1&#x6b21;,&#x4e00;&#x822c;&#x7528;&#x4e8e;&#x6570;&#x636e;&#x5e93;&#x7684;&#x8fde;&#x63a5;&quot;&quot;&quot;</span>\n        <span class=\"hljs-variable language_\">self</span>.db = pymysql.connect(MYSQL_HOST,MYSQL_USER,MYSQL_PWD,MYSQL_DB,charset=CHARSET)\n        <span class=\"hljs-variable language_\">self</span>.cursor = <span class=\"hljs-variable language_\">self</span>.db.cursor()\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_item</span>(<span class=\"hljs-params\">self, item, spider</span>):\n        ins = <span class=\"hljs-string\">&apos;insert into cartab values(%s,%s,%s)&apos;</span>\n        <span class=\"hljs-variable language_\">self</span>.cursor.execute(ins,[ item[<span class=\"hljs-string\">&apos;name&apos;</span>],item[<span class=\"hljs-string\">&apos;price&apos;</span>],item[<span class=\"hljs-string\">&apos;url&apos;</span>] ])\n        <span class=\"hljs-variable language_\">self</span>.db.commit()\n        <span class=\"hljs-keyword\">return</span> item\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">close_spider</span>(<span class=\"hljs-params\">self, spider</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x722c;&#x866b;&#x9879;&#x76ee;&#x7ed3;&#x675f;&#x65f6;,&#x53ea;&#x6267;&#x884c;1&#x6b21;,&#x4e00;&#x822c;&#x7528;&#x4e8e;&#x6570;&#x636e;&#x5e93;&#x7684;&#x65ad;&#x5f00;&quot;&quot;&quot;</span>\n        <span class=\"hljs-variable language_\">self</span>.cursor.close()\n        <span class=\"hljs-variable language_\">self</span>.db.close()\n\n<span class=\"hljs-comment\"># &#x7ba1;&#x9053;3 - &#x5b58;&#x5165;mongodb&#x6570;&#x636e;&#x5e93;</span>\n<span class=\"hljs-keyword\">import</span> pymongo\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">CarMongoPipeline</span>(<span class=\"hljs-title class_ inherited__\">object</span>):\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">open_spider</span>(<span class=\"hljs-params\">self, spider</span>):\n        <span class=\"hljs-variable language_\">self</span>.conn = pymongo.MongoClient(MONGO_HOST, MONGO_PORT)\n        <span class=\"hljs-variable language_\">self</span>.db = <span class=\"hljs-variable language_\">self</span>.conn[MONGO_DB]\n        <span class=\"hljs-variable language_\">self</span>.myset = <span class=\"hljs-variable language_\">self</span>.db[MONGO_SET]\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_item</span>(<span class=\"hljs-params\">self, item, spider</span>):\n        <span class=\"hljs-variable language_\">self</span>.myset.insert_one(<span class=\"hljs-built_in\">dict</span>(item))\n        <span class=\"hljs-keyword\">return</span> item\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"529,579"}},{"content":"<pre data-lines=\"580,699\"><code class=\"language-python\"><span class=\"hljs-comment\"># -*- coding: utf-8 -*-</span>\n\n<span class=\"hljs-comment\"># Scrapy settings for Car project</span>\n<span class=\"hljs-comment\">#</span>\n<span class=\"hljs-comment\"># For simplicity, this file contains only settings considered important or</span>\n<span class=\"hljs-comment\"># commonly used. You can find more settings consulting the documentation:</span>\n<span class=\"hljs-comment\">#</span>\n<span class=\"hljs-comment\">#     https://doc.scrapy.org/en/latest/topics/settings.html</span>\n<span class=\"hljs-comment\">#     https://doc.scrapy.org/en/latest/topics/downloader-middleware.html</span>\n<span class=\"hljs-comment\">#     https://doc.scrapy.org/en/latest/topics/spider-middleware.html</span>\n\nBOT_NAME = <span class=\"hljs-string\">&apos;Car&apos;</span>\n\nSPIDER_MODULES = [<span class=\"hljs-string\">&apos;Car.spiders&apos;</span>]\nNEWSPIDER_MODULE = <span class=\"hljs-string\">&apos;Car.spiders&apos;</span>\n\n\n<span class=\"hljs-comment\"># Crawl responsibly by identifying yourself (and your website) on the user-agent</span>\n<span class=\"hljs-comment\">#USER_AGENT = &apos;Car (+http://www.yourdomain.com)&apos;</span>\n\n<span class=\"hljs-comment\"># Obey robots.txt rules</span>\nROBOTSTXT_OBEY = <span class=\"hljs-literal\">False</span>\n\n<span class=\"hljs-comment\"># &#x8bbe;&#x7f6e;&#x65e5;&#x5fd7;&#x7ea7;&#x522b;</span>\n<span class=\"hljs-comment\"># LOG_LEVEL = &apos;DEBUG&apos;</span>\n<span class=\"hljs-comment\"># LOG_FILE = &apos;car.log&apos;</span>\n\n<span class=\"hljs-comment\"># &#x8bbe;&#x7f6e;&#x5bfc;&#x51fa;&#x6587;&#x4ef6;&#x7f16;&#x7801;</span>\nFEED_EXPORT_ENCODING = <span class=\"hljs-string\">&apos;utf-8&apos;</span>\n\n<span class=\"hljs-comment\"># Configure maximum concurrent requests performed by Scrapy (default: 16)</span>\n<span class=\"hljs-comment\">#CONCURRENT_REQUESTS = 32</span>\n\n<span class=\"hljs-comment\"># Configure a delay for requests for the same website (default: 0)</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/settings.html#download-delay</span>\n<span class=\"hljs-comment\"># See also autothrottle settings and docs</span>\nDOWNLOAD_DELAY = <span class=\"hljs-number\">0.1</span>\n<span class=\"hljs-comment\"># The download delay setting will honor only one of:</span>\n<span class=\"hljs-comment\">#CONCURRENT_REQUESTS_PER_DOMAIN = 16</span>\n<span class=\"hljs-comment\">#CONCURRENT_REQUESTS_PER_IP = 16</span>\n\n<span class=\"hljs-comment\"># Disable cookies (enabled by default)</span>\nCOOKIES_ENABLED = <span class=\"hljs-literal\">False</span>\n\n<span class=\"hljs-comment\"># Disable Telnet Console (enabled by default)</span>\n<span class=\"hljs-comment\">#TELNETCONSOLE_ENABLED = False</span>\n\n<span class=\"hljs-comment\"># Override the default request headers:</span>\nDEFAULT_REQUEST_HEADERS = {\n  <span class=\"hljs-string\">&apos;Accept&apos;</span>: <span class=\"hljs-string\">&apos;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&apos;</span>,\n  <span class=\"hljs-string\">&apos;Accept-Language&apos;</span>: <span class=\"hljs-string\">&apos;en&apos;</span>,\n  <span class=\"hljs-string\">&apos;Cookie&apos;</span> : <span class=\"hljs-string\">&apos;antipas=3g35lm41V408p5832Cp050B49m41; uuid=05611c70-8e38-4a82-c7d5-02a86e74c090; ganji_uuid=5484236533304847117197; lg=1; clueSourceCode=%2A%2300; user_city_id=1001737; sessionid=9f77ed86-3678-4c0f-e566-b2a895774901; close_finance_popup=2020-03-27; cainfo=%7B%22ca_a%22%3A%22-%22%2C%22ca_b%22%3A%22-%22%2C%22ca_s%22%3A%22self%22%2C%22ca_n%22%3A%22self%22%2C%22ca_medium%22%3A%22-%22%2C%22ca_term%22%3A%22-%22%2C%22ca_content%22%3A%22-%22%2C%22ca_campaign%22%3A%22-%22%2C%22ca_kw%22%3A%22-%22%2C%22ca_i%22%3A%22-%22%2C%22scode%22%3A%22-%22%2C%22keyword%22%3A%22-%22%2C%22ca_keywordid%22%3A%22-%22%2C%22display_finance_flag%22%3A%22-%22%2C%22platform%22%3A%221%22%2C%22version%22%3A1%2C%22client_ab%22%3A%22-%22%2C%22guid%22%3A%2205611c70-8e38-4a82-c7d5-02a86e74c090%22%2C%22ca_city%22%3A%22langfang%22%2C%22sessionid%22%3A%229f77ed86-3678-4c0f-e566-b2a895774901%22%7D; cityDomain=dachang; preTime=%7B%22last%22%3A1585275757%2C%22this%22%3A1585128131%2C%22pre%22%3A1585128131%7D&apos;</span>,\n  <span class=\"hljs-string\">&apos;User-Agent&apos;</span> : <span class=\"hljs-string\">&apos;Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36&apos;</span>\n}\n\n<span class=\"hljs-comment\"># Enable or disable spider middlewares</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/spider-middleware.html</span>\n<span class=\"hljs-comment\">#SPIDER_MIDDLEWARES = {</span>\n<span class=\"hljs-comment\">#    &apos;Car.middlewares.CarSpiderMiddleware&apos;: 543,</span>\n<span class=\"hljs-comment\">#}</span>\n\n<span class=\"hljs-comment\"># Enable or disable downloader middlewares</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/downloader-middleware.html</span>\n<span class=\"hljs-comment\">#DOWNLOADER_MIDDLEWARES = {</span>\n<span class=\"hljs-comment\">#    &apos;Car.middlewares.CarDownloaderMiddleware&apos;: 543,</span>\n<span class=\"hljs-comment\">#}</span>\n\n<span class=\"hljs-comment\"># Enable or disable extensions</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/extensions.html</span>\n<span class=\"hljs-comment\">#EXTENSIONS = {</span>\n<span class=\"hljs-comment\">#    &apos;scrapy.extensions.telnet.TelnetConsole&apos;: None,</span>\n<span class=\"hljs-comment\">#}</span>\n\n<span class=\"hljs-comment\"># Configure item pipelines</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/item-pipeline.html</span>\n<span class=\"hljs-comment\"># &#x5f00;&#x542f;&#x7ba1;&#x9053;</span>\nITEM_PIPELINES = {\n   <span class=\"hljs-comment\"># &apos;&#x9879;&#x76ee;&#x76ee;&#x5f55;&#x540d;.&#x6a21;&#x5757;&#x540d;.&#x7c7b;&#x540d;&apos; : &#x4f18;&#x5148;&#x7ea7; (&#x4ece;1-1000&#x4e0d;&#x7b49;,&#x6570;&#x5b57;&#x8d8a;&#x5c0f;,&#x4f18;&#x5148;&#x7ea7;&#x8d8a;&#x9ad8;)</span>\n   <span class=\"hljs-string\">&apos;Car.pipelines.CarPipeline&apos;</span>: <span class=\"hljs-number\">300</span>,\n   <span class=\"hljs-comment\"># &apos;Car.pipelines.CarMysqlPipeline&apos;: 100,</span>\n   <span class=\"hljs-comment\"># &apos;Car.pipelines.CarMongoPipeline&apos;: 200,</span>\n}\n\n<span class=\"hljs-comment\"># Enable and configure the AutoThrottle extension (disabled by default)</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/autothrottle.html</span>\n<span class=\"hljs-comment\">#AUTOTHROTTLE_ENABLED = True</span>\n<span class=\"hljs-comment\"># The initial download delay</span>\n<span class=\"hljs-comment\">#AUTOTHROTTLE_START_DELAY = 5</span>\n<span class=\"hljs-comment\"># The maximum download delay to be set in case of high latencies</span>\n<span class=\"hljs-comment\">#AUTOTHROTTLE_MAX_DELAY = 60</span>\n<span class=\"hljs-comment\"># The average number of requests Scrapy should be sending in parallel to</span>\n<span class=\"hljs-comment\"># each remote server</span>\n<span class=\"hljs-comment\">#AUTOTHROTTLE_TARGET_CONCURRENCY = 1.0</span>\n<span class=\"hljs-comment\"># Enable showing throttling stats for every response received:</span>\n<span class=\"hljs-comment\">#AUTOTHROTTLE_DEBUG = False</span>\n\n<span class=\"hljs-comment\"># Enable and configure HTTP caching (disabled by default)</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/downloader-middleware.html#httpcache-middleware-settings</span>\n<span class=\"hljs-comment\">#HTTPCACHE_ENABLED = True</span>\n<span class=\"hljs-comment\">#HTTPCACHE_EXPIRATION_SECS = 0</span>\n<span class=\"hljs-comment\">#HTTPCACHE_DIR = &apos;httpcache&apos;</span>\n<span class=\"hljs-comment\">#HTTPCACHE_IGNORE_HTTP_CODES = []</span>\n<span class=\"hljs-comment\">#HTTPCACHE_STORAGE = &apos;scrapy.extensions.httpcache.FilesystemCacheStorage&apos;</span>\n\n<span class=\"hljs-comment\"># &#x5b9a;&#x4e49;MySQL&#x76f8;&#x5173;&#x53d8;&#x91cf;</span>\nMYSQL_HOST = <span class=\"hljs-string\">&apos;127.0.0.1&apos;</span>\nMYSQL_USER = <span class=\"hljs-string\">&apos;root&apos;</span>\nMYSQL_PWD = <span class=\"hljs-string\">&apos;123456&apos;</span>\nMYSQL_DB = <span class=\"hljs-string\">&apos;cardb&apos;</span>\nCHARSET = <span class=\"hljs-string\">&apos;utf8&apos;</span>\n\n<span class=\"hljs-comment\"># &#x5b9a;&#x4e49; mongodb &#x76f8;&#x5173;&#x53d8;&#x91cf;</span>\nMONGO_HOST = <span class=\"hljs-string\">&apos;127.0.0.1&apos;</span>\nMONGO_PORT = <span class=\"hljs-number\">27017</span>\nMONGO_DB = <span class=\"hljs-string\">&apos;cardb&apos;</span>\nMONGO_SET = <span class=\"hljs-string\">&apos;carset&apos;</span>\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"580,699"}}],"payload":{"tag":"h5","lines":"392,393"}},{"content":"Car2/Car/spiders","children":[{"content":"<pre data-lines=\"702,734\"><code class=\"language-python\"><span class=\"hljs-comment\"># -*- coding: utf-8 -*-</span>\n<span class=\"hljs-keyword\">import</span> scrapy\n<span class=\"hljs-keyword\">from</span> ..items <span class=\"hljs-keyword\">import</span> CarItem\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">CarSpider</span>(scrapy.Spider):\n    name = <span class=\"hljs-string\">&apos;car&apos;</span>\n    allowed_domains = [<span class=\"hljs-string\">&apos;www.guazi.com&apos;</span>]\n    start_urls = [<span class=\"hljs-string\">&apos;https://www.guazi.com/dachang/buy/o1/#bread&apos;</span>]\n    page = <span class=\"hljs-number\">1</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">parse</span>(<span class=\"hljs-params\">self, response</span>):\n        li_list = response.xpath(<span class=\"hljs-string\">&apos;//ul[@class=&quot;carlist clearfix js-top&quot;]/li&apos;</span>)\n        <span class=\"hljs-keyword\">for</span> li <span class=\"hljs-keyword\">in</span> li_list:\n            <span class=\"hljs-comment\"># &#x5728;&#x7ed9; items.py &#x4e2d;&#x7684; CarItem&#x7c7b; &#x5b9e;&#x4f8b;&#x5316;&#x4e86;1&#x4e2a;&#x5bf9;&#x8c61;</span>\n            item = CarItem()\n            item[<span class=\"hljs-string\">&apos;name&apos;</span>] = li.xpath(<span class=\"hljs-string\">&apos;.//h2[@class=&quot;t&quot;]/text()&apos;</span>).get()\n            item[<span class=\"hljs-string\">&apos;price&apos;</span>] = li.xpath(<span class=\"hljs-string\">&apos;.//div[@class=&quot;t-price&quot;]/p/text()&apos;</span>).get()\n            item[<span class=\"hljs-string\">&apos;url&apos;</span>] = li.xpath(<span class=\"hljs-string\">&apos;./a[1]/@href&apos;</span>).get()\n\n            <span class=\"hljs-comment\"># item&#x5bf9;&#x8c61;&#x5c31;&#x662f;&#x9700;&#x8981;&#x4ea4;&#x7ed9;&#x7ba1;&#x9053;&#x7684;&#x6570;&#x636e;</span>\n            <span class=\"hljs-comment\"># &#x6570;&#x636e;&#x4ea4;&#x7ed9;&#x7ba1;&#x9053;&#x6587;&#x4ef6;&#x7684;&#x65b9;&#x6cd5;&#xff1a;yield item</span>\n            <span class=\"hljs-keyword\">yield</span> item\n\n        <span class=\"hljs-comment\"># &#x751f;&#x6210;&#x4e0b;&#x4e00;&#x9875;&#x7684;URL&#x5730;&#x5740;,&#x4ea4;&#x7ed9;&#x8c03;&#x5ea6;&#x5668;&#x5165;&#x961f;&#x5217;</span>\n        <span class=\"hljs-comment\"># scrapy.Request():&#x628a;&#x8bf7;&#x6c42;&#x4ea4;&#x7ed9;&#x8c03;&#x5ea6;&#x5668;&#x5165;&#x961f;&#x5217;,&#x8fd4;&#x56de;&#x7684;response&#x627e;callback&#x89e3;&#x6790;&#x51fd;&#x6570;&#x505a;&#x5904;&#x7406;</span>\n        <span class=\"hljs-keyword\">if</span> <span class=\"hljs-variable language_\">self</span>.page &lt; <span class=\"hljs-number\">5</span>:\n            <span class=\"hljs-variable language_\">self</span>.page += <span class=\"hljs-number\">1</span>\n            url = <span class=\"hljs-string\">&apos;https://www.guazi.com/dachang/buy/o{}/#bread&apos;</span>.<span class=\"hljs-built_in\">format</span>(<span class=\"hljs-variable language_\">self</span>.page)\n            <span class=\"hljs-keyword\">yield</span> scrapy.Request(url=url, callback=<span class=\"hljs-variable language_\">self</span>.parse)\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"702,734"}},{"content":"<pre data-lines=\"735,776\"><code class=\"language-python\"><span class=\"hljs-comment\"># -*- coding: utf-8 -*-</span>\n<span class=\"hljs-keyword\">import</span> scrapy\n<span class=\"hljs-keyword\">from</span> ..items <span class=\"hljs-keyword\">import</span> CarItem\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">CarSpider</span>(scrapy.Spider):\n    name = <span class=\"hljs-string\">&apos;car2&apos;</span>\n    allowed_domains = [<span class=\"hljs-string\">&apos;www.guazi.com&apos;</span>]\n\n    <span class=\"hljs-comment\"># &#x91cd;&#x5199;Spider&#x7c7b;&#x7684; start_requests() &#x65b9;&#x6cd5;</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">start_requests</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x751f;&#x6210;&#x6240;&#x6709;&#x8981;&#x6293;&#x53d6;&#x7684;URL&#x5730;&#x5740;,&#x4ea4;&#x7ed9;&#x8c03;&#x5ea6;&#x5668;&#x5165;&#x961f;&#x5217;&quot;&quot;&quot;</span>\n        <span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(<span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">6</span>):\n            url = <span class=\"hljs-string\">&apos;https://www.guazi.com/dachang/buy/o{}/#bread&apos;</span>.<span class=\"hljs-built_in\">format</span>(i)\n            <span class=\"hljs-comment\"># scrapy.Request() &#x4ea4;&#x7ed9;&#x8c03;&#x5ea6;&#x5668;&#x5165;&#x961f;&#x5217;</span>\n            <span class=\"hljs-keyword\">yield</span> scrapy.Request(url=url, callback=<span class=\"hljs-variable language_\">self</span>.parse_html)\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">parse_html</span>(<span class=\"hljs-params\">self, response</span>):\n        li_list = response.xpath(<span class=\"hljs-string\">&apos;//ul[@class=&quot;carlist clearfix js-top&quot;]/li&apos;</span>)\n        <span class=\"hljs-keyword\">for</span> li <span class=\"hljs-keyword\">in</span> li_list:\n            <span class=\"hljs-comment\"># &#x5728;&#x7ed9; items.py &#x4e2d;&#x7684; CarItem&#x7c7b; &#x5b9e;&#x4f8b;&#x5316;&#x4e86;1&#x4e2a;&#x5bf9;&#x8c61;</span>\n            item = CarItem()\n            item[<span class=\"hljs-string\">&apos;name&apos;</span>] = li.xpath(<span class=\"hljs-string\">&apos;.//h2[@class=&quot;t&quot;]/text()&apos;</span>).get()\n            item[<span class=\"hljs-string\">&apos;price&apos;</span>] = li.xpath(<span class=\"hljs-string\">&apos;.//div[@class=&quot;t-price&quot;]/p/text()&apos;</span>).get()\n            item[<span class=\"hljs-string\">&apos;url&apos;</span>] = <span class=\"hljs-string\">&apos;https://www.guazi.com&apos;</span> + li.xpath(<span class=\"hljs-string\">&apos;./a[1]/@href&apos;</span>).get()\n            <span class=\"hljs-comment\"># &#x628a; item[&apos;url&apos;] &#x7ee7;&#x7eed;&#x4ea4;&#x7ed9;&#x8c03;&#x5ea6;&#x5668;&#x5165;&#x961f;&#x5217;</span>\n            <span class=\"hljs-comment\"># meta&#x53c2;&#x6570;&#x4f5c;&#x7528;&#xff1a;&#x5728;&#x4e0d;&#x540c;&#x7684;&#x89e3;&#x6790;&#x51fd;&#x6570;&#x4e4b;&#x95f4;&#x4f20;&#x9012;&#x6570;&#x636e;</span>\n            <span class=\"hljs-keyword\">yield</span> scrapy.Request(url=item[<span class=\"hljs-string\">&apos;url&apos;</span>], meta={<span class=\"hljs-string\">&apos;item&apos;</span>:item}, callback=<span class=\"hljs-variable language_\">self</span>.detail_parse)\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">detail_parse</span>(<span class=\"hljs-params\">self, response</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x4e8c;&#x7ea7;&#x9875;&#x9762;&#x89e3;&#x6790;&#x51fd;&#x6570;&#xff1a;&#x63d0;&#x53d6;&#x4e0a;&#x724c;&#x65f6;&#x95f4;&#x3001;&#x91cc;&#x7a0b;&#x3001;&#x53d8;&#x901f;&#x7bb1;&#x3001;&#x6392;&#x91cf;&quot;&quot;&quot;</span>\n        <span class=\"hljs-comment\"># meta&#x4f1a;&#x968f;&#x7740;response&#x4e00;&#x8d77;&#x56de;&#x6765;,&#x4f5c;&#x4e3a;response&#x7684;&#x4e00;&#x4e2a;&#x5c5e;&#x6027;</span>\n        item = response.meta[<span class=\"hljs-string\">&apos;item&apos;</span>]\n        item[<span class=\"hljs-string\">&apos;time&apos;</span>] = response.xpath(<span class=\"hljs-string\">&apos;//ul[@class=&quot;assort clearfix&quot;]/li[1]/span/text()&apos;</span>).get()\n        item[<span class=\"hljs-string\">&apos;km&apos;</span>] = response.xpath(<span class=\"hljs-string\">&apos;//ul[@class=&quot;assort clearfix&quot;]/li[2]/span/text()&apos;</span>).get()\n        item[<span class=\"hljs-string\">&apos;disp&apos;</span>] = response.xpath(<span class=\"hljs-string\">&apos;//ul[@class=&quot;assort clearfix&quot;]/li[3]/span/text()&apos;</span>).get()\n        item[<span class=\"hljs-string\">&apos;trans&apos;</span>] = response.xpath(<span class=\"hljs-string\">&apos;//ul[@class=&quot;assort clearfix&quot;]/li[4]/span/text()&apos;</span>).get()\n\n        <span class=\"hljs-keyword\">yield</span> item\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"735,776"}}],"payload":{"tag":"h5","lines":"700,701"}}],"payload":{"tag":"h4","lines":"384,385"}},{"content":"Daomu","children":[{"content":"Daomu/Daomu","children":[{"content":"<pre data-lines=\"804,830\"><code class=\"language-python\"><span class=\"hljs-comment\"># -*- coding: utf-8 -*-</span>\n\n<span class=\"hljs-comment\"># Define here the models for your scraped items</span>\n<span class=\"hljs-comment\">#</span>\n<span class=\"hljs-comment\"># See documentation in:</span>\n<span class=\"hljs-comment\"># https://doc.scrapy.org/en/latest/topics/items.html</span>\n\n<span class=\"hljs-keyword\">import</span> scrapy\n\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">DaomuItem</span>(scrapy.Item):\n    <span class=\"hljs-comment\"># define the fields for your item here like:</span>\n    <span class=\"hljs-comment\"># name = scrapy.Field()</span>\n    <span class=\"hljs-comment\"># &#x4e00;&#x7ea7;&#x9875;&#x9762;&#xff1a;&#x5927;&#x6807;&#x9898;+&#x5927;&#x94fe;&#x63a5;</span>\n    parent_title = scrapy.Field()\n    parent_url = scrapy.Field()\n    <span class=\"hljs-comment\"># &#x4e8c;&#x7ea7;&#x9875;&#x9762;&#xff1a;&#x5c0f;&#x6807;&#x9898;+&#x5c0f;&#x94fe;&#x63a5;</span>\n    son_title = scrapy.Field()\n    son_url = scrapy.Field()\n    <span class=\"hljs-comment\"># &#x4e09;&#x7ea7;&#x9875;&#x9762;&#xff1a;&#x5c0f;&#x8bf4;&#x5185;&#x5bb9;</span>\n    content = scrapy.Field()\n    <span class=\"hljs-comment\"># &#x76ee;&#x5f55;&#xff1a;&#x6211;&#x7684;&#x9700;&#x6c42;&#x4e2d;&#x9700;&#x8981;&#x53bb;&#x521b;&#x5efa;&#x5bf9;&#x5e94;&#x7684;&#x76ee;&#x5f55;,&#x800c;&#x4e14;&#x5728;&#x7ba1;&#x9053;&#x6587;&#x4ef6;&#x4e2d;&#x8fd8;&#x8981;&#x53bb;&#x547d;&#x540d;&#x6587;&#x4ef6;&#x540d;</span>\n    directory = scrapy.Field()\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"804,830"}},{"content":"<pre data-lines=\"831,937\"><code class=\"language-python\"><span class=\"hljs-comment\"># -*- coding: utf-8 -*-</span>\n\n<span class=\"hljs-comment\"># Define here the models for your spider middleware</span>\n<span class=\"hljs-comment\">#</span>\n<span class=\"hljs-comment\"># See documentation in:</span>\n<span class=\"hljs-comment\"># https://doc.scrapy.org/en/latest/topics/spider-middleware.html</span>\n\n<span class=\"hljs-keyword\">from</span> scrapy <span class=\"hljs-keyword\">import</span> signals\n\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">DaomuSpiderMiddleware</span>(<span class=\"hljs-title class_ inherited__\">object</span>):\n    <span class=\"hljs-comment\"># Not all methods need to be defined. If a method is not defined,</span>\n    <span class=\"hljs-comment\"># scrapy acts as if the spider middleware does not modify the</span>\n    <span class=\"hljs-comment\"># passed objects.</span>\n\n<span class=\"hljs-meta\">    @classmethod</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">from_crawler</span>(<span class=\"hljs-params\">cls, crawler</span>):\n        <span class=\"hljs-comment\"># This method is used by Scrapy to create your spiders.</span>\n        s = cls()\n        crawler.signals.connect(s.spider_opened, signal=signals.spider_opened)\n        <span class=\"hljs-keyword\">return</span> s\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_spider_input</span>(<span class=\"hljs-params\">self, response, spider</span>):\n        <span class=\"hljs-comment\"># Called for each response that goes through the spider</span>\n        <span class=\"hljs-comment\"># middleware and into the spider.</span>\n\n        <span class=\"hljs-comment\"># Should return None or raise an exception.</span>\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">None</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_spider_output</span>(<span class=\"hljs-params\">self, response, result, spider</span>):\n        <span class=\"hljs-comment\"># Called with the results returned from the Spider, after</span>\n        <span class=\"hljs-comment\"># it has processed the response.</span>\n\n        <span class=\"hljs-comment\"># Must return an iterable of Request, dict or Item objects.</span>\n        <span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> result:\n            <span class=\"hljs-keyword\">yield</span> i\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_spider_exception</span>(<span class=\"hljs-params\">self, response, exception, spider</span>):\n        <span class=\"hljs-comment\"># Called when a spider or process_spider_input() method</span>\n        <span class=\"hljs-comment\"># (from other spider middleware) raises an exception.</span>\n\n        <span class=\"hljs-comment\"># Should return either None or an iterable of Response, dict</span>\n        <span class=\"hljs-comment\"># or Item objects.</span>\n        <span class=\"hljs-keyword\">pass</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_start_requests</span>(<span class=\"hljs-params\">self, start_requests, spider</span>):\n        <span class=\"hljs-comment\"># Called with the start requests of the spider, and works</span>\n        <span class=\"hljs-comment\"># similarly to the process_spider_output() method, except</span>\n        <span class=\"hljs-comment\"># that it doesn&#x2019;t have a response associated.</span>\n\n        <span class=\"hljs-comment\"># Must return only requests (not items).</span>\n        <span class=\"hljs-keyword\">for</span> r <span class=\"hljs-keyword\">in</span> start_requests:\n            <span class=\"hljs-keyword\">yield</span> r\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">spider_opened</span>(<span class=\"hljs-params\">self, spider</span>):\n        spider.logger.info(<span class=\"hljs-string\">&apos;Spider opened: %s&apos;</span> % spider.name)\n\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">DaomuDownloaderMiddleware</span>(<span class=\"hljs-title class_ inherited__\">object</span>):\n    <span class=\"hljs-comment\"># Not all methods need to be defined. If a method is not defined,</span>\n    <span class=\"hljs-comment\"># scrapy acts as if the downloader middleware does not modify the</span>\n    <span class=\"hljs-comment\"># passed objects.</span>\n\n<span class=\"hljs-meta\">    @classmethod</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">from_crawler</span>(<span class=\"hljs-params\">cls, crawler</span>):\n        <span class=\"hljs-comment\"># This method is used by Scrapy to create your spiders.</span>\n        s = cls()\n        crawler.signals.connect(s.spider_opened, signal=signals.spider_opened)\n        <span class=\"hljs-keyword\">return</span> s\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_request</span>(<span class=\"hljs-params\">self, request, spider</span>):\n        <span class=\"hljs-comment\"># Called for each request that goes through the downloader</span>\n        <span class=\"hljs-comment\"># middleware.</span>\n\n        <span class=\"hljs-comment\"># Must either:</span>\n        <span class=\"hljs-comment\"># - return None: continue processing this request</span>\n        <span class=\"hljs-comment\"># - or return a Response object</span>\n        <span class=\"hljs-comment\"># - or return a Request object</span>\n        <span class=\"hljs-comment\"># - or raise IgnoreRequest: process_exception() methods of</span>\n        <span class=\"hljs-comment\">#   installed downloader middleware will be called</span>\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">None</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_response</span>(<span class=\"hljs-params\">self, request, response, spider</span>):\n        <span class=\"hljs-comment\"># Called with the response returned from the downloader.</span>\n\n        <span class=\"hljs-comment\"># Must either;</span>\n        <span class=\"hljs-comment\"># - return a Response object</span>\n        <span class=\"hljs-comment\"># - return a Request object</span>\n        <span class=\"hljs-comment\"># - or raise IgnoreRequest</span>\n        <span class=\"hljs-keyword\">return</span> response\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_exception</span>(<span class=\"hljs-params\">self, request, exception, spider</span>):\n        <span class=\"hljs-comment\"># Called when a download handler or a process_request()</span>\n        <span class=\"hljs-comment\"># (from other downloader middleware) raises an exception.</span>\n\n        <span class=\"hljs-comment\"># Must either:</span>\n        <span class=\"hljs-comment\"># - return None: continue processing this exception</span>\n        <span class=\"hljs-comment\"># - return a Response object: stops process_exception() chain</span>\n        <span class=\"hljs-comment\"># - return a Request object: stops process_exception() chain</span>\n        <span class=\"hljs-keyword\">pass</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">spider_opened</span>(<span class=\"hljs-params\">self, spider</span>):\n        spider.logger.info(<span class=\"hljs-string\">&apos;Spider opened: %s&apos;</span> % spider.name)\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"831,937"}},{"content":"<pre data-lines=\"938,957\"><code class=\"language-python\"><span class=\"hljs-comment\"># -*- coding: utf-8 -*-</span>\n\n<span class=\"hljs-comment\"># Define your item pipelines here</span>\n<span class=\"hljs-comment\">#</span>\n<span class=\"hljs-comment\"># Don&apos;t forget to add your pipeline to the ITEM_PIPELINES setting</span>\n<span class=\"hljs-comment\"># See: https://doc.scrapy.org/en/latest/topics/item-pipeline.html</span>\n\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">DaomuPipeline</span>(<span class=\"hljs-title class_ inherited__\">object</span>):\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_item</span>(<span class=\"hljs-params\">self, item, spider</span>):\n        <span class=\"hljs-comment\"># filename: ./data/novel/&#x76d7;&#x5893;&#x7b14;&#x8bb0;1&#xff1a;&#x4e03;&#x661f;&#x9c81;&#x738b;&#x5bab;/&#x4e03;&#x661f;&#x9c81;&#x738b;_&#x7b2c;&#x4e00;&#x7ae0;_&#x8840;&#x5c38;.txt</span>\n        filename = item[<span class=\"hljs-string\">&apos;directory&apos;</span>] + item[<span class=\"hljs-string\">&apos;son_title&apos;</span>].replace(<span class=\"hljs-string\">&apos; &apos;</span>,<span class=\"hljs-string\">&apos;_&apos;</span>) + <span class=\"hljs-string\">&apos;.txt&apos;</span>\n        <span class=\"hljs-keyword\">with</span> <span class=\"hljs-built_in\">open</span>(filename,<span class=\"hljs-string\">&apos;w&apos;</span>) <span class=\"hljs-keyword\">as</span> f:\n            f.write(item[<span class=\"hljs-string\">&apos;content&apos;</span>])\n\n        <span class=\"hljs-keyword\">return</span> item\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"938,957"}},{"content":"<pre data-lines=\"958,1052\"><code class=\"language-python\"><span class=\"hljs-comment\"># -*- coding: utf-8 -*-</span>\n\n<span class=\"hljs-comment\"># Scrapy settings for Daomu project</span>\n<span class=\"hljs-comment\">#</span>\n<span class=\"hljs-comment\"># For simplicity, this file contains only settings considered important or</span>\n<span class=\"hljs-comment\"># commonly used. You can find more settings consulting the documentation:</span>\n<span class=\"hljs-comment\">#</span>\n<span class=\"hljs-comment\">#     https://doc.scrapy.org/en/latest/topics/settings.html</span>\n<span class=\"hljs-comment\">#     https://doc.scrapy.org/en/latest/topics/downloader-middleware.html</span>\n<span class=\"hljs-comment\">#     https://doc.scrapy.org/en/latest/topics/spider-middleware.html</span>\n\nBOT_NAME = <span class=\"hljs-string\">&apos;Daomu&apos;</span>\n\nSPIDER_MODULES = [<span class=\"hljs-string\">&apos;Daomu.spiders&apos;</span>]\nNEWSPIDER_MODULE = <span class=\"hljs-string\">&apos;Daomu.spiders&apos;</span>\n\n\n<span class=\"hljs-comment\"># Crawl responsibly by identifying yourself (and your website) on the user-agent</span>\n<span class=\"hljs-comment\">#USER_AGENT = &apos;Daomu (+http://www.yourdomain.com)&apos;</span>\n\n<span class=\"hljs-comment\"># Obey robots.txt rules</span>\nROBOTSTXT_OBEY = <span class=\"hljs-literal\">False</span>\n\n<span class=\"hljs-comment\"># Configure maximum concurrent requests performed by Scrapy (default: 16)</span>\n<span class=\"hljs-comment\">#CONCURRENT_REQUESTS = 32</span>\n\n<span class=\"hljs-comment\"># Configure a delay for requests for the same website (default: 0)</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/settings.html#download-delay</span>\n<span class=\"hljs-comment\"># See also autothrottle settings and docs</span>\nDOWNLOAD_DELAY = <span class=\"hljs-number\">0.1</span>\n<span class=\"hljs-comment\"># The download delay setting will honor only one of:</span>\n<span class=\"hljs-comment\">#CONCURRENT_REQUESTS_PER_DOMAIN = 16</span>\n<span class=\"hljs-comment\">#CONCURRENT_REQUESTS_PER_IP = 16</span>\n\n<span class=\"hljs-comment\"># Disable cookies (enabled by default)</span>\n<span class=\"hljs-comment\">#COOKIES_ENABLED = False</span>\n\n<span class=\"hljs-comment\"># Disable Telnet Console (enabled by default)</span>\n<span class=\"hljs-comment\">#TELNETCONSOLE_ENABLED = False</span>\n\n<span class=\"hljs-comment\"># Override the default request headers:</span>\nDEFAULT_REQUEST_HEADERS = {\n  <span class=\"hljs-string\">&apos;Accept&apos;</span>: <span class=\"hljs-string\">&apos;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&apos;</span>,\n  <span class=\"hljs-string\">&apos;Accept-Language&apos;</span>: <span class=\"hljs-string\">&apos;en&apos;</span>,\n  <span class=\"hljs-string\">&apos;User-Agent&apos;</span>: <span class=\"hljs-string\">&apos;Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36&apos;</span>,\n}\n\n<span class=\"hljs-comment\"># Enable or disable spider middlewares</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/spider-middleware.html</span>\n<span class=\"hljs-comment\">#SPIDER_MIDDLEWARES = {</span>\n<span class=\"hljs-comment\">#    &apos;Daomu.middlewares.DaomuSpiderMiddleware&apos;: 543,</span>\n<span class=\"hljs-comment\">#}</span>\n\n<span class=\"hljs-comment\"># Enable or disable downloader middlewares</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/downloader-middleware.html</span>\n<span class=\"hljs-comment\">#DOWNLOADER_MIDDLEWARES = {</span>\n<span class=\"hljs-comment\">#    &apos;Daomu.middlewares.DaomuDownloaderMiddleware&apos;: 543,</span>\n<span class=\"hljs-comment\">#}</span>\n\n<span class=\"hljs-comment\"># Enable or disable extensions</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/extensions.html</span>\n<span class=\"hljs-comment\">#EXTENSIONS = {</span>\n<span class=\"hljs-comment\">#    &apos;scrapy.extensions.telnet.TelnetConsole&apos;: None,</span>\n<span class=\"hljs-comment\">#}</span>\n\n<span class=\"hljs-comment\"># Configure item pipelines</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/item-pipeline.html</span>\nITEM_PIPELINES = {\n   <span class=\"hljs-string\">&apos;Daomu.pipelines.DaomuPipeline&apos;</span>: <span class=\"hljs-number\">300</span>,\n}\n\n<span class=\"hljs-comment\"># Enable and configure the AutoThrottle extension (disabled by default)</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/autothrottle.html</span>\n<span class=\"hljs-comment\">#AUTOTHROTTLE_ENABLED = True</span>\n<span class=\"hljs-comment\"># The initial download delay</span>\n<span class=\"hljs-comment\">#AUTOTHROTTLE_START_DELAY = 5</span>\n<span class=\"hljs-comment\"># The maximum download delay to be set in case of high latencies</span>\n<span class=\"hljs-comment\">#AUTOTHROTTLE_MAX_DELAY = 60</span>\n<span class=\"hljs-comment\"># The average number of requests Scrapy should be sending in parallel to</span>\n<span class=\"hljs-comment\"># each remote server</span>\n<span class=\"hljs-comment\">#AUTOTHROTTLE_TARGET_CONCURRENCY = 1.0</span>\n<span class=\"hljs-comment\"># Enable showing throttling stats for every response received:</span>\n<span class=\"hljs-comment\">#AUTOTHROTTLE_DEBUG = False</span>\n\n<span class=\"hljs-comment\"># Enable and configure HTTP caching (disabled by default)</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/downloader-middleware.html#httpcache-middleware-settings</span>\n<span class=\"hljs-comment\">#HTTPCACHE_ENABLED = True</span>\n<span class=\"hljs-comment\">#HTTPCACHE_EXPIRATION_SECS = 0</span>\n<span class=\"hljs-comment\">#HTTPCACHE_DIR = &apos;httpcache&apos;</span>\n<span class=\"hljs-comment\">#HTTPCACHE_IGNORE_HTTP_CODES = []</span>\n<span class=\"hljs-comment\">#HTTPCACHE_STORAGE = &apos;scrapy.extensions.httpcache.FilesystemCacheStorage&apos;</span>\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"958,1052"}}],"payload":{"tag":"h5","lines":"802,803"}},{"content":"Daomu/Daomu/spiders","children":[{"content":"<pre data-lines=\"1055,1108\"><code class=\"language-python\"><span class=\"hljs-comment\"># -*- coding: utf-8 -*-</span>\n<span class=\"hljs-keyword\">import</span> scrapy\n<span class=\"hljs-keyword\">from</span> ..items <span class=\"hljs-keyword\">import</span> DaomuItem\n<span class=\"hljs-keyword\">import</span> os\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">DaomuSpider</span>(scrapy.Spider):\n    name = <span class=\"hljs-string\">&apos;daomu&apos;</span>\n    allowed_domains = [<span class=\"hljs-string\">&apos;www.daomubiji.com&apos;</span>]\n    start_urls = [<span class=\"hljs-string\">&apos;http://www.daomubiji.com/&apos;</span>]\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">parse</span>(<span class=\"hljs-params\">self, response</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x4e00;&#x7ea7;&#x9875;&#x9762;&#x89e3;&#x6790;&#x51fd;&#x6570;&quot;&quot;&quot;</span>\n        a_list = response.xpath(<span class=\"hljs-string\">&apos;//li[contains(@id,&quot;menu-item-20&quot;)]/a&apos;</span>)\n        <span class=\"hljs-keyword\">for</span> a <span class=\"hljs-keyword\">in</span> a_list:\n            <span class=\"hljs-comment\"># &#x56e0;&#x4e3a;&#x6b64;item&#x5bf9;&#x8c61;&#x9700;&#x8981;&#x7ee7;&#x7eed;&#x4ea4;&#x7ed9;&#x8c03;&#x5ea6;&#x5668;&#x5165;&#x961f;&#x5217;</span>\n            item = DaomuItem()\n            item[<span class=\"hljs-string\">&apos;parent_title&apos;</span>] = a.xpath(<span class=\"hljs-string\">&apos;./text()&apos;</span>).get()\n            item[<span class=\"hljs-string\">&apos;parent_url&apos;</span>] = a.xpath(<span class=\"hljs-string\">&apos;./@href&apos;</span>).get()\n            <span class=\"hljs-comment\"># item[&apos;directory&apos;]: ./data/novel/&#x76d7;&#x5893;&#x7b14;&#x8bb0;1&#xff1a;&#x4e03;&#x661f;&#x9c81;&#x738b;&#x5bab;</span>\n            item[<span class=\"hljs-string\">&apos;directory&apos;</span>] = <span class=\"hljs-string\">&apos;./data/novel/&apos;</span> + item[<span class=\"hljs-string\">&apos;parent_title&apos;</span>] + <span class=\"hljs-string\">&apos;/&apos;</span>\n            <span class=\"hljs-comment\"># &#x521b;&#x5efa;&#x5bf9;&#x5e94;&#x6587;&#x4ef6;&#x5939;</span>\n            <span class=\"hljs-keyword\">if</span> <span class=\"hljs-keyword\">not</span> os.path.exists(item[<span class=\"hljs-string\">&apos;directory&apos;</span>]):\n                os.makedirs(item[<span class=\"hljs-string\">&apos;directory&apos;</span>])\n            <span class=\"hljs-comment\"># &#x628a;&#x5927;&#x94fe;&#x63a5;&#x4ea4;&#x7ed9;&#x8c03;&#x5ea6;&#x5668;&#x5165;&#x961f;&#x5217;</span>\n            <span class=\"hljs-keyword\">yield</span> scrapy.Request(url=item[<span class=\"hljs-string\">&apos;parent_url&apos;</span>], meta={<span class=\"hljs-string\">&apos;meta_1&apos;</span>:item}, callback=<span class=\"hljs-variable language_\">self</span>.detail_page)\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">detail_page</span>(<span class=\"hljs-params\">self, response</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x4e8c;&#x7ea7;&#x9875;&#x9762;&#x89e3;&#x6790;&#xff1a;&#x5c0f;&#x6807;&#x9898;+&#x5c0f;&#x94fe;&#x63a5;&quot;&quot;&quot;</span>\n        meta_1 = response.meta[<span class=\"hljs-string\">&apos;meta_1&apos;</span>]\n        article_list = response.xpath(<span class=\"hljs-string\">&apos;//article&apos;</span>)\n        <span class=\"hljs-keyword\">for</span> article <span class=\"hljs-keyword\">in</span> article_list:\n            <span class=\"hljs-comment\"># &#x53ea;&#x8981;&#x6b64;&#x5faa;&#x73af;&#x4e2d;&#x6709;&#x7ee7;&#x7eed;&#x4ea4;&#x7ed9;&#x8c03;&#x5ea6;&#x5668;&#x5165;&#x961f;&#x5217;&#x7684;&#x8bf7;&#x6c42;,&#x5219;&#x5fc5;&#x987b;&#x521b;&#x5efa;&#x5168;&#x65b0;&#x7684;item&#x5bf9;&#x8c61;,&#x5426;&#x5219;item&#x7684;&#x503c;&#x4f1a;&#x88ab;&#x8986;&#x76d6;</span>\n            item = DaomuItem()\n            item[<span class=\"hljs-string\">&apos;son_title&apos;</span>] = article.xpath(<span class=\"hljs-string\">&apos;./a/text()&apos;</span>).get()\n            item[<span class=\"hljs-string\">&apos;son_url&apos;</span>] = article.xpath(<span class=\"hljs-string\">&apos;./a/@href&apos;</span>).get()\n            item[<span class=\"hljs-string\">&apos;directory&apos;</span>] = meta_1[<span class=\"hljs-string\">&apos;directory&apos;</span>]\n            item[<span class=\"hljs-string\">&apos;parent_title&apos;</span>] = meta_1[<span class=\"hljs-string\">&apos;parent_title&apos;</span>]\n            item[<span class=\"hljs-string\">&apos;parent_url&apos;</span>] = meta_1[<span class=\"hljs-string\">&apos;parent_url&apos;</span>]\n            <span class=\"hljs-comment\"># &#x4ea4;&#x7ed9;&#x8c03;&#x5ea6;&#x5668;&#x5165;&#x961f;&#x5217;</span>\n            <span class=\"hljs-keyword\">yield</span> scrapy.Request(url=item[<span class=\"hljs-string\">&apos;son_url&apos;</span>], meta={<span class=\"hljs-string\">&apos;meta_2&apos;</span>:item}, callback=<span class=\"hljs-variable language_\">self</span>.get_content)\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">get_content</span>(<span class=\"hljs-params\">self, response</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x4e09;&#x7ea7;&#x9875;&#x9762;&#xff1a;&#x63d0;&#x53d6;&#x5177;&#x4f53;&#x5c0f;&#x8bf4;&#x5185;&#x5bb9;&quot;&quot;&quot;</span>\n        item = response.meta[<span class=\"hljs-string\">&apos;meta_2&apos;</span>]\n        <span class=\"hljs-comment\"># content_list: [&apos;&#x6bb5;&#x843d;1&apos;,&apos;&#x6bb5;&#x843d;2&apos;,...]</span>\n        content_list = response.xpath(<span class=\"hljs-string\">&apos;//article[@class=&quot;article-content&quot;]/p/text()&apos;</span>).extract()\n        item[<span class=\"hljs-string\">&apos;content&apos;</span>] = <span class=\"hljs-string\">&apos;\\n&apos;</span>.join(content_list)\n\n        <span class=\"hljs-comment\"># &#x81f3;&#x6b64;,1&#x6761;&#x5b8c;&#x6574;&#x7684;item&#x6570;&#x636e;&#x63d0;&#x53d6;&#x5b8c;&#x6210;,&#x4ea4;&#x7ed9;&#x7ba1;&#x9053;&#x6587;&#x4ef6;&#x5904;&#x7406;</span>\n        <span class=\"hljs-keyword\">yield</span> item\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1055,1108"}}],"payload":{"tag":"h5","lines":"1053,1054"}}],"payload":{"tag":"h4","lines":"777,778"}},{"content":"Maoyan","children":[{"content":"Maoyan/Maoyan/spiders","children":[{"content":"<pre data-lines=\"1397,1424\"><code class=\"language-python\"><span class=\"hljs-comment\"># -*- coding: utf-8 -*-</span>\n<span class=\"hljs-keyword\">import</span> scrapy\n<span class=\"hljs-keyword\">from</span> ..items <span class=\"hljs-keyword\">import</span> MaoyanItem\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">MaoyanSpider</span>(scrapy.Spider):\n    name = <span class=\"hljs-string\">&apos;maoyan&apos;</span>\n    allowed_domains = [<span class=\"hljs-string\">&apos;maoyan.com&apos;</span>]\n\n    <span class=\"hljs-comment\"># &#x91cd;&#x5199;start_requests()&#x65b9;&#x6cd5;</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">start_requests</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-keyword\">for</span> offset <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(<span class=\"hljs-number\">0</span>,<span class=\"hljs-number\">91</span>,<span class=\"hljs-number\">10</span>):\n            url = <span class=\"hljs-string\">&apos;https://maoyan.com/board/4?offset={}&apos;</span>.<span class=\"hljs-built_in\">format</span>(offset)\n            <span class=\"hljs-keyword\">yield</span> scrapy.Request(url=url, callback=<span class=\"hljs-variable language_\">self</span>.parse_html)\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">parse_html</span>(<span class=\"hljs-params\">self, response</span>):\n        dd_list = response.xpath(<span class=\"hljs-string\">&apos;//dl[@class=&quot;board-wrapper&quot;]/dd&apos;</span>)\n        <span class=\"hljs-keyword\">for</span> dd <span class=\"hljs-keyword\">in</span> dd_list:\n            item = MaoyanItem()\n            item[<span class=\"hljs-string\">&apos;name&apos;</span>] = dd.xpath(<span class=\"hljs-string\">&apos;.//p[@class=&quot;name&quot;]/a/text()&apos;</span>).get()\n            item[<span class=\"hljs-string\">&apos;star&apos;</span>] = dd.xpath(<span class=\"hljs-string\">&apos;.//p[@class=&quot;star&quot;]/text()&apos;</span>).get()\n            item[<span class=\"hljs-string\">&apos;time&apos;</span>] = dd.xpath(<span class=\"hljs-string\">&apos;.//p[@class=&quot;releasetime&quot;]/text()&apos;</span>).get()\n\n            <span class=\"hljs-comment\"># &#x4ea4;&#x7ed9;&#x7ba1;&#x9053;&#x5904;&#x7406;</span>\n            <span class=\"hljs-keyword\">yield</span> item\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1397,1424"}}],"payload":{"tag":"h5","lines":"1395,1396"}}],"payload":{"tag":"h4","lines":"1111,1112"}},{"content":"Tencent","children":[{"content":"Tencent/Tencent","children":[{"content":"<pre data-lines=\"1452,1477\"><code class=\"language-python\"><span class=\"hljs-comment\"># -*- coding: utf-8 -*-</span>\n\n<span class=\"hljs-comment\"># Define here the models for your scraped items</span>\n<span class=\"hljs-comment\">#</span>\n<span class=\"hljs-comment\"># See documentation in:</span>\n<span class=\"hljs-comment\"># https://doc.scrapy.org/en/latest/topics/items.html</span>\n\n<span class=\"hljs-keyword\">import</span> scrapy\n\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">TencentItem</span>(scrapy.Item):\n    <span class=\"hljs-comment\"># define the fields for your item here like:</span>\n    <span class=\"hljs-comment\"># &#x540d;&#x79f0;+&#x7c7b;&#x522b;+&#x804c;&#x8d23;+&#x8981;&#x6c42;+&#x5730;&#x5740;+&#x65f6;&#x95f4;</span>\n    job_name = scrapy.Field()\n    job_type = scrapy.Field()\n    job_duty = scrapy.Field()\n    job_require = scrapy.Field()\n    job_address = scrapy.Field()\n    job_time = scrapy.Field()\n    <span class=\"hljs-comment\"># &#x5177;&#x4f53;&#x804c;&#x4f4d;&#x94fe;&#x63a5;</span>\n    job_url = scrapy.Field()\n    post_id = scrapy.Field()\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1452,1477"}},{"content":"<pre data-lines=\"1478,1584\"><code class=\"language-python\"><span class=\"hljs-comment\"># -*- coding: utf-8 -*-</span>\n\n<span class=\"hljs-comment\"># Define here the models for your spider middleware</span>\n<span class=\"hljs-comment\">#</span>\n<span class=\"hljs-comment\"># See documentation in:</span>\n<span class=\"hljs-comment\"># https://doc.scrapy.org/en/latest/topics/spider-middleware.html</span>\n\n<span class=\"hljs-keyword\">from</span> scrapy <span class=\"hljs-keyword\">import</span> signals\n\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">TencentSpiderMiddleware</span>(<span class=\"hljs-title class_ inherited__\">object</span>):\n    <span class=\"hljs-comment\"># Not all methods need to be defined. If a method is not defined,</span>\n    <span class=\"hljs-comment\"># scrapy acts as if the spider middleware does not modify the</span>\n    <span class=\"hljs-comment\"># passed objects.</span>\n\n<span class=\"hljs-meta\">    @classmethod</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">from_crawler</span>(<span class=\"hljs-params\">cls, crawler</span>):\n        <span class=\"hljs-comment\"># This method is used by Scrapy to create your spiders.</span>\n        s = cls()\n        crawler.signals.connect(s.spider_opened, signal=signals.spider_opened)\n        <span class=\"hljs-keyword\">return</span> s\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_spider_input</span>(<span class=\"hljs-params\">self, response, spider</span>):\n        <span class=\"hljs-comment\"># Called for each response that goes through the spider</span>\n        <span class=\"hljs-comment\"># middleware and into the spider.</span>\n\n        <span class=\"hljs-comment\"># Should return None or raise an exception.</span>\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">None</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_spider_output</span>(<span class=\"hljs-params\">self, response, result, spider</span>):\n        <span class=\"hljs-comment\"># Called with the results returned from the Spider, after</span>\n        <span class=\"hljs-comment\"># it has processed the response.</span>\n\n        <span class=\"hljs-comment\"># Must return an iterable of Request, dict or Item objects.</span>\n        <span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> result:\n            <span class=\"hljs-keyword\">yield</span> i\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_spider_exception</span>(<span class=\"hljs-params\">self, response, exception, spider</span>):\n        <span class=\"hljs-comment\"># Called when a spider or process_spider_input() method</span>\n        <span class=\"hljs-comment\"># (from other spider middleware) raises an exception.</span>\n\n        <span class=\"hljs-comment\"># Should return either None or an iterable of Response, dict</span>\n        <span class=\"hljs-comment\"># or Item objects.</span>\n        <span class=\"hljs-keyword\">pass</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_start_requests</span>(<span class=\"hljs-params\">self, start_requests, spider</span>):\n        <span class=\"hljs-comment\"># Called with the start requests of the spider, and works</span>\n        <span class=\"hljs-comment\"># similarly to the process_spider_output() method, except</span>\n        <span class=\"hljs-comment\"># that it doesn&#x2019;t have a response associated.</span>\n\n        <span class=\"hljs-comment\"># Must return only requests (not items).</span>\n        <span class=\"hljs-keyword\">for</span> r <span class=\"hljs-keyword\">in</span> start_requests:\n            <span class=\"hljs-keyword\">yield</span> r\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">spider_opened</span>(<span class=\"hljs-params\">self, spider</span>):\n        spider.logger.info(<span class=\"hljs-string\">&apos;Spider opened: %s&apos;</span> % spider.name)\n\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">TencentDownloaderMiddleware</span>(<span class=\"hljs-title class_ inherited__\">object</span>):\n    <span class=\"hljs-comment\"># Not all methods need to be defined. If a method is not defined,</span>\n    <span class=\"hljs-comment\"># scrapy acts as if the downloader middleware does not modify the</span>\n    <span class=\"hljs-comment\"># passed objects.</span>\n\n<span class=\"hljs-meta\">    @classmethod</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">from_crawler</span>(<span class=\"hljs-params\">cls, crawler</span>):\n        <span class=\"hljs-comment\"># This method is used by Scrapy to create your spiders.</span>\n        s = cls()\n        crawler.signals.connect(s.spider_opened, signal=signals.spider_opened)\n        <span class=\"hljs-keyword\">return</span> s\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_request</span>(<span class=\"hljs-params\">self, request, spider</span>):\n        <span class=\"hljs-comment\"># Called for each request that goes through the downloader</span>\n        <span class=\"hljs-comment\"># middleware.</span>\n\n        <span class=\"hljs-comment\"># Must either:</span>\n        <span class=\"hljs-comment\"># - return None: continue processing this request</span>\n        <span class=\"hljs-comment\"># - or return a Response object</span>\n        <span class=\"hljs-comment\"># - or return a Request object</span>\n        <span class=\"hljs-comment\"># - or raise IgnoreRequest: process_exception() methods of</span>\n        <span class=\"hljs-comment\">#   installed downloader middleware will be called</span>\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">None</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_response</span>(<span class=\"hljs-params\">self, request, response, spider</span>):\n        <span class=\"hljs-comment\"># Called with the response returned from the downloader.</span>\n\n        <span class=\"hljs-comment\"># Must either;</span>\n        <span class=\"hljs-comment\"># - return a Response object</span>\n        <span class=\"hljs-comment\"># - return a Request object</span>\n        <span class=\"hljs-comment\"># - or raise IgnoreRequest</span>\n        <span class=\"hljs-keyword\">return</span> response\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_exception</span>(<span class=\"hljs-params\">self, request, exception, spider</span>):\n        <span class=\"hljs-comment\"># Called when a download handler or a process_request()</span>\n        <span class=\"hljs-comment\"># (from other downloader middleware) raises an exception.</span>\n\n        <span class=\"hljs-comment\"># Must either:</span>\n        <span class=\"hljs-comment\"># - return None: continue processing this exception</span>\n        <span class=\"hljs-comment\"># - return a Response object: stops process_exception() chain</span>\n        <span class=\"hljs-comment\"># - return a Request object: stops process_exception() chain</span>\n        <span class=\"hljs-keyword\">pass</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">spider_opened</span>(<span class=\"hljs-params\">self, spider</span>):\n        spider.logger.info(<span class=\"hljs-string\">&apos;Spider opened: %s&apos;</span> % spider.name)\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1478,1584"}},{"content":"<pre data-lines=\"1585,1602\"><code class=\"language-python\"><span class=\"hljs-comment\"># -*- coding: utf-8 -*-</span>\n\n<span class=\"hljs-comment\"># Define your item pipelines here</span>\n<span class=\"hljs-comment\">#</span>\n<span class=\"hljs-comment\"># Don&apos;t forget to add your pipeline to the ITEM_PIPELINES setting</span>\n<span class=\"hljs-comment\"># See: https://doc.scrapy.org/en/latest/topics/item-pipeline.html</span>\n\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">TencentPipeline</span>(<span class=\"hljs-title class_ inherited__\">object</span>):\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">process_item</span>(<span class=\"hljs-params\">self, item, spider</span>):\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-built_in\">dict</span>(item))\n        <span class=\"hljs-keyword\">return</span> item\n\n\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1585,1602"}},{"content":"<pre data-lines=\"1603,1697\"><code class=\"language-python\"><span class=\"hljs-comment\"># -*- coding: utf-8 -*-</span>\n\n<span class=\"hljs-comment\"># Scrapy settings for Tencent project</span>\n<span class=\"hljs-comment\">#</span>\n<span class=\"hljs-comment\"># For simplicity, this file contains only settings considered important or</span>\n<span class=\"hljs-comment\"># commonly used. You can find more settings consulting the documentation:</span>\n<span class=\"hljs-comment\">#</span>\n<span class=\"hljs-comment\">#     https://doc.scrapy.org/en/latest/topics/settings.html</span>\n<span class=\"hljs-comment\">#     https://doc.scrapy.org/en/latest/topics/downloader-middleware.html</span>\n<span class=\"hljs-comment\">#     https://doc.scrapy.org/en/latest/topics/spider-middleware.html</span>\n\nBOT_NAME = <span class=\"hljs-string\">&apos;Tencent&apos;</span>\n\nSPIDER_MODULES = [<span class=\"hljs-string\">&apos;Tencent.spiders&apos;</span>]\nNEWSPIDER_MODULE = <span class=\"hljs-string\">&apos;Tencent.spiders&apos;</span>\n\n\n<span class=\"hljs-comment\"># Crawl responsibly by identifying yourself (and your website) on the user-agent</span>\n<span class=\"hljs-comment\">#USER_AGENT = &apos;Tencent (+http://www.yourdomain.com)&apos;</span>\n\n<span class=\"hljs-comment\"># Obey robots.txt rules</span>\nROBOTSTXT_OBEY = <span class=\"hljs-literal\">False</span>\n\n<span class=\"hljs-comment\"># Configure maximum concurrent requests performed by Scrapy (default: 16)</span>\n<span class=\"hljs-comment\">#CONCURRENT_REQUESTS = 32</span>\n\n<span class=\"hljs-comment\"># Configure a delay for requests for the same website (default: 0)</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/settings.html#download-delay</span>\n<span class=\"hljs-comment\"># See also autothrottle settings and docs</span>\nDOWNLOAD_DELAY = <span class=\"hljs-number\">0.1</span>\n<span class=\"hljs-comment\"># The download delay setting will honor only one of:</span>\n<span class=\"hljs-comment\">#CONCURRENT_REQUESTS_PER_DOMAIN = 16</span>\n<span class=\"hljs-comment\">#CONCURRENT_REQUESTS_PER_IP = 16</span>\n\n<span class=\"hljs-comment\"># Disable cookies (enabled by default)</span>\n<span class=\"hljs-comment\">#COOKIES_ENABLED = False</span>\n\n<span class=\"hljs-comment\"># Disable Telnet Console (enabled by default)</span>\n<span class=\"hljs-comment\">#TELNETCONSOLE_ENABLED = False</span>\n\n<span class=\"hljs-comment\"># Override the default request headers:</span>\nDEFAULT_REQUEST_HEADERS = {\n  <span class=\"hljs-string\">&apos;Accept&apos;</span>: <span class=\"hljs-string\">&apos;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&apos;</span>,\n  <span class=\"hljs-string\">&apos;Accept-Language&apos;</span>: <span class=\"hljs-string\">&apos;en&apos;</span>,\n  <span class=\"hljs-string\">&apos;User-Agent&apos;</span>: <span class=\"hljs-string\">&apos;Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36&apos;</span>,\n}\n\n<span class=\"hljs-comment\"># Enable or disable spider middlewares</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/spider-middleware.html</span>\n<span class=\"hljs-comment\">#SPIDER_MIDDLEWARES = {</span>\n<span class=\"hljs-comment\">#    &apos;Tencent.middlewares.TencentSpiderMiddleware&apos;: 543,</span>\n<span class=\"hljs-comment\">#}</span>\n\n<span class=\"hljs-comment\"># Enable or disable downloader middlewares</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/downloader-middleware.html</span>\n<span class=\"hljs-comment\">#DOWNLOADER_MIDDLEWARES = {</span>\n<span class=\"hljs-comment\">#    &apos;Tencent.middlewares.TencentDownloaderMiddleware&apos;: 543,</span>\n<span class=\"hljs-comment\">#}</span>\n\n<span class=\"hljs-comment\"># Enable or disable extensions</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/extensions.html</span>\n<span class=\"hljs-comment\">#EXTENSIONS = {</span>\n<span class=\"hljs-comment\">#    &apos;scrapy.extensions.telnet.TelnetConsole&apos;: None,</span>\n<span class=\"hljs-comment\">#}</span>\n\n<span class=\"hljs-comment\"># Configure item pipelines</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/item-pipeline.html</span>\nITEM_PIPELINES = {\n   <span class=\"hljs-string\">&apos;Tencent.pipelines.TencentPipeline&apos;</span>: <span class=\"hljs-number\">300</span>,\n}\n\n<span class=\"hljs-comment\"># Enable and configure the AutoThrottle extension (disabled by default)</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/autothrottle.html</span>\n<span class=\"hljs-comment\">#AUTOTHROTTLE_ENABLED = True</span>\n<span class=\"hljs-comment\"># The initial download delay</span>\n<span class=\"hljs-comment\">#AUTOTHROTTLE_START_DELAY = 5</span>\n<span class=\"hljs-comment\"># The maximum download delay to be set in case of high latencies</span>\n<span class=\"hljs-comment\">#AUTOTHROTTLE_MAX_DELAY = 60</span>\n<span class=\"hljs-comment\"># The average number of requests Scrapy should be sending in parallel to</span>\n<span class=\"hljs-comment\"># each remote server</span>\n<span class=\"hljs-comment\">#AUTOTHROTTLE_TARGET_CONCURRENCY = 1.0</span>\n<span class=\"hljs-comment\"># Enable showing throttling stats for every response received:</span>\n<span class=\"hljs-comment\">#AUTOTHROTTLE_DEBUG = False</span>\n\n<span class=\"hljs-comment\"># Enable and configure HTTP caching (disabled by default)</span>\n<span class=\"hljs-comment\"># See https://doc.scrapy.org/en/latest/topics/downloader-middleware.html#httpcache-middleware-settings</span>\n<span class=\"hljs-comment\">#HTTPCACHE_ENABLED = True</span>\n<span class=\"hljs-comment\">#HTTPCACHE_EXPIRATION_SECS = 0</span>\n<span class=\"hljs-comment\">#HTTPCACHE_DIR = &apos;httpcache&apos;</span>\n<span class=\"hljs-comment\">#HTTPCACHE_IGNORE_HTTP_CODES = []</span>\n<span class=\"hljs-comment\">#HTTPCACHE_STORAGE = &apos;scrapy.extensions.httpcache.FilesystemCacheStorage&apos;</span>\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1603,1697"}}],"payload":{"tag":"h5","lines":"1450,1451"}},{"content":"Tencent/Tencent/spiders","children":[{"content":"<pre data-lines=\"1702,1767\"><code class=\"language-python\"><span class=\"hljs-comment\"># -*- coding: utf-8 -*-</span>\n<span class=\"hljs-keyword\">import</span> scrapy\n<span class=\"hljs-keyword\">from</span> urllib <span class=\"hljs-keyword\">import</span> parse\n<span class=\"hljs-keyword\">import</span> json\n<span class=\"hljs-keyword\">from</span> ..items <span class=\"hljs-keyword\">import</span> TencentItem\n<span class=\"hljs-keyword\">import</span> requests\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">TencentSpider</span>(scrapy.Spider):\n    name = <span class=\"hljs-string\">&apos;tencent&apos;</span>\n    allowed_domains = [<span class=\"hljs-string\">&apos;careers.tencent.com&apos;</span>]\n    one_url = <span class=\"hljs-string\">&apos;https://careers.tencent.com/tencentcareer/api/post/Query?timestamp=1566266592644&amp;countryId=&amp;cityId=&amp;bgIds=&amp;productId=&amp;categoryId=&amp;parentCategoryId=&amp;attrId=&amp;keyword={}&amp;pageIndex={}&amp;pageSize=10&amp;language=zh-cn&amp;area=cn&apos;</span>\n    two_url = <span class=\"hljs-string\">&apos;https://careers.tencent.com/tencentcareer/api/post/ByPostId?timestamp=1566266695175&amp;postId={}&amp;language=zh-cn&apos;</span>\n    keyword = <span class=\"hljs-built_in\">input</span>(<span class=\"hljs-string\">&apos;&#x8bf7;&#x8f93;&#x5165;&#x5173;&#x952e;&#x5b57;:&apos;</span>)\n    keyword = parse.quote(keyword)\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">start_requests</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x628a;&#x6240;&#x6709;&#x4e00;&#x7ea7;&#x9875;&#x9762;&#x7684;URL&#x5730;&#x5740;&#x4ea4;&#x7ed9;&#x8c03;&#x5ea6;&#x5668;&#x5165;&#x961f;&#x5217;&quot;&quot;&quot;</span>\n        total = <span class=\"hljs-variable language_\">self</span>.get_total()\n        <span class=\"hljs-keyword\">for</span> page <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(<span class=\"hljs-number\">1</span>,total+<span class=\"hljs-number\">1</span>):\n            url = <span class=\"hljs-variable language_\">self</span>.one_url.<span class=\"hljs-built_in\">format</span>(<span class=\"hljs-variable language_\">self</span>.keyword, page)\n            <span class=\"hljs-comment\"># &#x628a;&#x4e00;&#x7ea7;&#x9875;&#x9762;&#x7684;URL&#x5730;&#x5740;&#x4ea4;&#x7ed9;&#x8c03;&#x5ea6;&#x5668;&#x5165;&#x961f;&#x5217;</span>\n            <span class=\"hljs-keyword\">yield</span> scrapy.Request(url=url, callback=<span class=\"hljs-variable language_\">self</span>.parse_one_page)\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">get_total</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x83b7;&#x53d6;&#x67d0;&#x4e2a;&#x7c7b;&#x522b;&#x4e0b;&#x7684;&#x603b;&#x9875;&#x6570;&quot;&quot;&quot;</span>\n        <span class=\"hljs-comment\"># &#x5411;&#x67d0;&#x4e2a;&#x7c7b;&#x522b;&#x4e0b;&#x7684;&#x7b2c;1&#x9875;&#x53d1;&#x8bf7;&#x6c42;,&#x53ef;&#x4ee5;&#x83b7;&#x53d6;&#x804c;&#x4f4d;&#x603b;&#x6570;</span>\n        url = <span class=\"hljs-variable language_\">self</span>.one_url.<span class=\"hljs-built_in\">format</span>(<span class=\"hljs-variable language_\">self</span>.keyword, <span class=\"hljs-number\">1</span>)\n        headers = {<span class=\"hljs-string\">&apos;User-Agent&apos;</span> : <span class=\"hljs-string\">&apos;Mozilla/5.0 (Windows NT 10.0; WOW64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/80.0.3987.149 Safari/537.36&apos;</span>}\n        html = requests.get(url=url, headers=headers).text\n        html = json.loads(html)\n        count = html[<span class=\"hljs-string\">&apos;Data&apos;</span>][<span class=\"hljs-string\">&apos;Count&apos;</span>]\n        total = count//<span class=\"hljs-number\">10</span> <span class=\"hljs-keyword\">if</span> count%<span class=\"hljs-number\">10</span>==<span class=\"hljs-number\">0</span> <span class=\"hljs-keyword\">else</span> count//<span class=\"hljs-number\">10</span> + <span class=\"hljs-number\">1</span>\n\n        <span class=\"hljs-keyword\">return</span> total\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">parse_one_page</span>(<span class=\"hljs-params\">self, response</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x89e3;&#x6790;&#x63d0;&#x53d6;postId,&#x5e76;&#x4ea4;&#x7ed9;&#x8c03;&#x5ea6;&#x5668;&#x5165;&#x961f;&#x5217;&quot;&quot;&quot;</span>\n        <span class=\"hljs-comment\"># &#x83b7;&#x53d6;&#x54cd;&#x5e94;&#x5185;&#x5bb9; - &#x5b57;&#x7b26;&#x4e32;</span>\n        html = json.loads(response.text)\n        <span class=\"hljs-keyword\">for</span> one <span class=\"hljs-keyword\">in</span> html[<span class=\"hljs-string\">&apos;Data&apos;</span>][<span class=\"hljs-string\">&apos;Posts&apos;</span>]:\n            <span class=\"hljs-comment\"># item&#x5bf9;&#x8c61; : &#x6b64;&#x65f6;,&#x4f1a;&#x7ee7;&#x7eed;&#x4ea4;&#x7ed9;&#x8c03;&#x5ea6;&#x5668;&#x5165;&#x961f;&#x5217;,&#x6240;&#x4ee5;&#x521b;&#x5efa;item&#x5bf9;&#x8c61;&#x7684;&#x65f6;&#x523b;&#x5230;&#x4e86;&#xff01;&#xff01;&#xff01;</span>\n            item = TencentItem()\n            item[<span class=\"hljs-string\">&apos;post_id&apos;</span>] = one[<span class=\"hljs-string\">&apos;PostId&apos;</span>]\n            item[<span class=\"hljs-string\">&apos;job_url&apos;</span>] = <span class=\"hljs-variable language_\">self</span>.two_url.<span class=\"hljs-built_in\">format</span>(item[<span class=\"hljs-string\">&apos;post_id&apos;</span>])\n            <span class=\"hljs-comment\"># &#x4ea4;&#x7ed9;&#x8c03;&#x5ea6;&#x5668;&#x5165;&#x961f;&#x5217;</span>\n            <span class=\"hljs-keyword\">yield</span> scrapy.Request(url=item[<span class=\"hljs-string\">&apos;job_url&apos;</span>], meta={<span class=\"hljs-string\">&apos;item&apos;</span>:item}, callback=<span class=\"hljs-variable language_\">self</span>.parse_two_page)\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">parse_two_page</span>(<span class=\"hljs-params\">self, response</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;&#x89e3;&#x6790;&#x63d0;&#x53d6;&#x804c;&#x4f4d;&#x8be6;&#x60c5;&#x9875;&#x6570;&#x636e;&quot;&quot;&quot;</span>\n        <span class=\"hljs-comment\"># &#x83b7;&#x53d6;&#x4f20;&#x9012;&#x8fc7;&#x6765;&#x7684;item&#x5bf9;&#x8c61;</span>\n        item = response.meta[<span class=\"hljs-string\">&apos;item&apos;</span>]\n        <span class=\"hljs-comment\"># &#x62ff;&#x5230;&#x4e8c;&#x7ea7;&#x9875;&#x9762;&#x7684;json&#x6570;&#x636e;,&#x5e76;&#x8f6c;&#x4e3a;Python&#x6570;&#x636e;&#x7c7b;&#x578b;</span>\n        two_html = json.loads(response.text)\n        item[<span class=\"hljs-string\">&apos;job_name&apos;</span>] = two_html[<span class=\"hljs-string\">&apos;Data&apos;</span>][<span class=\"hljs-string\">&apos;RecruitPostName&apos;</span>]\n        item[<span class=\"hljs-string\">&apos;job_type&apos;</span>] = two_html[<span class=\"hljs-string\">&apos;Data&apos;</span>][<span class=\"hljs-string\">&apos;CategoryName&apos;</span>]\n        item[<span class=\"hljs-string\">&apos;job_duty&apos;</span>] = two_html[<span class=\"hljs-string\">&apos;Data&apos;</span>][<span class=\"hljs-string\">&apos;Responsibility&apos;</span>]\n        item[<span class=\"hljs-string\">&apos;job_require&apos;</span>] = two_html[<span class=\"hljs-string\">&apos;Data&apos;</span>][<span class=\"hljs-string\">&apos;Requirement&apos;</span>]\n        item[<span class=\"hljs-string\">&apos;job_address&apos;</span>] = two_html[<span class=\"hljs-string\">&apos;Data&apos;</span>][<span class=\"hljs-string\">&apos;LocationName&apos;</span>]\n        item[<span class=\"hljs-string\">&apos;job_time&apos;</span>] = two_html[<span class=\"hljs-string\">&apos;Data&apos;</span>][<span class=\"hljs-string\">&apos;LastUpdateTime&apos;</span>]\n\n        <span class=\"hljs-comment\"># &#x81f3;&#x6b64;,1&#x6761;&#x5b8c;&#x6574;&#x7684;item&#x6570;&#x636e;&#x63d0;&#x53d6;&#x5b8c;&#x6210;,&#x4ea4;&#x7ed9;&#x7ba1;&#x9053;&#x6587;&#x4ef6;&#x5904;&#x7406;</span>\n        <span class=\"hljs-keyword\">yield</span> item\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1702,1767"}}],"payload":{"tag":"h5","lines":"1700,1701"}},{"content":"&#x5176;&#x4ed6;&#x793a;&#x4f8b;","children":[{"content":"<pre data-lines=\"1770,1786\"><code class=\"language-python\"><span class=\"hljs-string\">&quot;&quot;&quot;\nyield&#x8bed;&#x53e5;&#x56de;&#x987e;\n&quot;&quot;&quot;</span>\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">f1</span>():\n    <span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(<span class=\"hljs-number\">3</span>):\n        <span class=\"hljs-keyword\">yield</span> i\n\ng = f1()\n<span class=\"hljs-keyword\">while</span> <span class=\"hljs-literal\">True</span>:\n    <span class=\"hljs-keyword\">try</span>:\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-built_in\">next</span>(g))\n    <span class=\"hljs-keyword\">except</span> Exception <span class=\"hljs-keyword\">as</span> e:\n        <span class=\"hljs-keyword\">break</span>\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"1770,1786"}}],"payload":{"tag":"h5","lines":"1768,1769"}}],"payload":{"tag":"h4","lines":"1425,1426"}}],"payload":{"tag":"h3","lines":"0,1"}},{})</script>
</body>
</html>
