<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets@11.11.1/styles/default.min.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.18.10/dist/browser/index.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/index.js"></script><script>(r => {
              setTimeout(r);
            })(function renderToolbar() {
  const {
    markmap,
    mm
  } = window;
  const {
    el
  } = markmap.Toolbar.create(mm);
  el.setAttribute('style', 'position:absolute;bottom:20px;right:20px');
  document.body.append(el);
})</script><script>((getMarkmap, getOptions, root2, jsonOptions) => {
              const markmap = getMarkmap();
              window.mm = markmap.Markmap.create(
                "svg#mindmap",
                (getOptions || markmap.deriveOptions)(jsonOptions),
                root2
              );
            })(() => window.markmap,null,{"content":"Deep-Learning","children":[{"content":"&#x793a;&#x4f8b;","children":[{"content":"<pre data-lines=\"6,82\"><code class=\"language-python\"><span class=\"hljs-keyword\">import</span> os\n<span class=\"hljs-keyword\">import</span> scipy.misc\n<span class=\"hljs-keyword\">import</span> numpy <span class=\"hljs-keyword\">as</span> np\n<span class=\"hljs-keyword\">from</span> glob <span class=\"hljs-keyword\">import</span> glob\n\n\n<span class=\"hljs-comment\"># Avatar(&#x5316;&#x8eab;)&#x7c7b;</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">Avatar</span>:\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__init__</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-variable language_\">self</span>.data_name = <span class=\"hljs-string\">&apos;faces&apos;</span>\n        <span class=\"hljs-variable language_\">self</span>.source_shape = (<span class=\"hljs-number\">96</span>, <span class=\"hljs-number\">96</span>, <span class=\"hljs-number\">3</span>)\n        <span class=\"hljs-variable language_\">self</span>.resize_shape = (<span class=\"hljs-number\">48</span>, <span class=\"hljs-number\">48</span>, <span class=\"hljs-number\">3</span>)\n        <span class=\"hljs-variable language_\">self</span>.crop = <span class=\"hljs-literal\">True</span>  <span class=\"hljs-comment\"># &#x88c1;&#x526a;</span>\n        <span class=\"hljs-variable language_\">self</span>.img_shape = <span class=\"hljs-variable language_\">self</span>.source_shape <span class=\"hljs-keyword\">if</span> <span class=\"hljs-keyword\">not</span> <span class=\"hljs-variable language_\">self</span>.crop <span class=\"hljs-keyword\">else</span> <span class=\"hljs-variable language_\">self</span>.resize_shape  <span class=\"hljs-comment\"># &#x56fe;&#x7247;&#x5f62;&#x72b6;</span>\n        <span class=\"hljs-variable language_\">self</span>.img_list = <span class=\"hljs-variable language_\">self</span>._get_img_list()  <span class=\"hljs-comment\"># &#x52a0;&#x8f7d;&#x6240;&#x6709;&#x56fe;&#x7247;</span>\n        <span class=\"hljs-variable language_\">self</span>.batch_size = <span class=\"hljs-number\">64</span>  <span class=\"hljs-comment\"># batch_size&#x5927;&#x5c0f;</span>\n        <span class=\"hljs-variable language_\">self</span>.batch_shape = (<span class=\"hljs-variable language_\">self</span>.batch_size,) + <span class=\"hljs-variable language_\">self</span>.img_shape\n        <span class=\"hljs-variable language_\">self</span>.chunk_size = <span class=\"hljs-built_in\">len</span>(<span class=\"hljs-variable language_\">self</span>.img_list) // <span class=\"hljs-variable language_\">self</span>.batch_size  <span class=\"hljs-comment\"># &#x603b;&#x6279;&#x6b21;&#x6570;&#x91cf; = &#x6837;&#x672c;&#x6570; / &#x6279;&#x6b21;&#x5927;&#x5c0f;</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">_get_img_list</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;\n        &#x52a0;&#x8f7d;&#x6240;&#x6709;&#x56fe;&#x7247;&#x6837;&#x672c;&#x8def;&#x5f84;\n        :return:&#x6240;&#x6709;&#x56fe;&#x7247;&#x6837;&#x672c;&#x8def;&#x5f84;&#x5217;&#x8868;\n        &quot;&quot;&quot;</span>\n        path = os.path.join(os.getcwd(), <span class=\"hljs-variable language_\">self</span>.data_name, <span class=\"hljs-string\">&apos;*.jpg&apos;</span>)\n        <span class=\"hljs-keyword\">return</span> glob(path)\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">_get_img</span>(<span class=\"hljs-params\">self, name</span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;\n        &#x8bfb;&#x53d6;&#x56fe;&#x50cf;&#x6570;&#x636e;\n        :param name: &#x56fe;&#x7247;&#x8def;&#x5f84;\n        :return: &#x56fe;&#x50cf;&#x6570;&#x636e;\n        &quot;&quot;&quot;</span>\n        <span class=\"hljs-keyword\">assert</span> name <span class=\"hljs-keyword\">in</span> <span class=\"hljs-variable language_\">self</span>.img_list\n        img = scipy.misc.imread(name).astype(np.float32)  <span class=\"hljs-comment\"># &#x8bfb;&#x53d6;&#x56fe;&#x50cf;</span>\n        <span class=\"hljs-keyword\">assert</span> img.shape == <span class=\"hljs-variable language_\">self</span>.source_shape\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable language_\">self</span>._resize(img) <span class=\"hljs-keyword\">if</span> <span class=\"hljs-variable language_\">self</span>.crop <span class=\"hljs-keyword\">else</span> img  <span class=\"hljs-comment\"># &#x8c03;&#x6574;&#x5927;&#x5c0f;&#x5e76;&#x8fd4;&#x56de;</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">_resize</span>(<span class=\"hljs-params\">self, img</span>):\n        h, w = img.shape[:<span class=\"hljs-number\">2</span>]\n        resize_h, resize_w = <span class=\"hljs-variable language_\">self</span>.resize_shape[:<span class=\"hljs-number\">2</span>]\n        crop_h, crop_w = <span class=\"hljs-variable language_\">self</span>.source_shape[:<span class=\"hljs-number\">2</span>]\n        j = <span class=\"hljs-built_in\">int</span>(<span class=\"hljs-built_in\">round</span>((h - crop_h) / <span class=\"hljs-number\">2.</span>))\n        i = <span class=\"hljs-built_in\">int</span>(<span class=\"hljs-built_in\">round</span>((w - crop_w) / <span class=\"hljs-number\">2.</span>))\n        cropped_image = scipy.misc.imresize(img[j:j + crop_h, i:i + crop_w], [resize_h, resize_w])\n        <span class=\"hljs-keyword\">return</span> np.array(cropped_image) / <span class=\"hljs-number\">127.5</span> - <span class=\"hljs-number\">1.</span>\n\n<span class=\"hljs-meta\">    @staticmethod</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">save_img</span>(<span class=\"hljs-params\">image, path</span>):\n        scipy.misc.imsave(path, image)\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-literal\">True</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">batches</span>(<span class=\"hljs-params\">self</span>):\n        start = <span class=\"hljs-number\">0</span>\n        end = <span class=\"hljs-variable language_\">self</span>.batch_size\n\n        <span class=\"hljs-keyword\">for</span> _ <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(<span class=\"hljs-variable language_\">self</span>.chunk_size):\n            name_list = <span class=\"hljs-variable language_\">self</span>.img_list[start:end]\n            imgs = [<span class=\"hljs-variable language_\">self</span>._get_img(name) <span class=\"hljs-keyword\">for</span> name <span class=\"hljs-keyword\">in</span> name_list]\n            batches = np.zeros(<span class=\"hljs-variable language_\">self</span>.batch_shape)\n            batches[::] = imgs\n            <span class=\"hljs-keyword\">yield</span> batches\n            start += <span class=\"hljs-variable language_\">self</span>.batch_size\n            end += <span class=\"hljs-variable language_\">self</span>.batch_size\n\n\n<span class=\"hljs-keyword\">if</span> __name__ == <span class=\"hljs-string\">&apos;__main__&apos;</span>:\n    avatar = Avatar()\n    batch = avatar.batches()\n    b = <span class=\"hljs-built_in\">next</span>(batch)\n    <span class=\"hljs-keyword\">for</span> num <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(<span class=\"hljs-built_in\">len</span>(b)):\n        avatar.save_img(b[num], <span class=\"hljs-string\">&apos;samples&apos;</span> + os.sep + <span class=\"hljs-built_in\">str</span>(num) + <span class=\"hljs-string\">&apos;.jpg&apos;</span>)\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"6,82"}},{"content":"<pre data-lines=\"83,92\"><code class=\"language-python\"><span class=\"hljs-comment\"># from avatarDcgan.avatar_model import AvatarModel</span>\n<span class=\"hljs-keyword\">from</span> avatar_model <span class=\"hljs-keyword\">import</span> AvatarModel  <span class=\"hljs-comment\"># wdb 20200325</span>\n\n<span class=\"hljs-keyword\">if</span> __name__ == <span class=\"hljs-string\">&apos;__main__&apos;</span>:\n    avatar = AvatarModel()\n    avatar.gen()\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;&#x56fe;&#x7247;&#x751f;&#x6210;&#x5b8c;&#x6210;.&quot;</span>)\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"83,92"}},{"content":"<pre data-lines=\"93,416\"><code class=\"language-python\"><span class=\"hljs-keyword\">import</span> os\n<span class=\"hljs-keyword\">import</span> math\n<span class=\"hljs-keyword\">import</span> numpy <span class=\"hljs-keyword\">as</span> np\n<span class=\"hljs-keyword\">import</span> tensorflow <span class=\"hljs-keyword\">as</span> tf\n<span class=\"hljs-keyword\">from</span> datetime <span class=\"hljs-keyword\">import</span> datetime\n<span class=\"hljs-comment\"># from avatarDcgan.avatar import Avatar</span>\n<span class=\"hljs-keyword\">from</span> avatar <span class=\"hljs-keyword\">import</span> Avatar  <span class=\"hljs-comment\"># wdb 20200325</span>\n\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">AvatarModel</span>:\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__init__</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-variable language_\">self</span>.avatar = Avatar()\n        <span class=\"hljs-comment\"># &#x771f;&#x5b9e;&#x56fe;&#x7247;shape (height, width, depth)</span>\n        <span class=\"hljs-variable language_\">self</span>.img_shape = <span class=\"hljs-variable language_\">self</span>.avatar.img_shape\n        <span class=\"hljs-comment\"># &#x4e00;&#x4e2a;batch&#x7684;&#x56fe;&#x7247;&#x5411;&#x91cf;shape (batch, height, width, depth)</span>\n        <span class=\"hljs-variable language_\">self</span>.batch_shape = <span class=\"hljs-variable language_\">self</span>.avatar.batch_shape\n        <span class=\"hljs-comment\"># &#x4e00;&#x4e2a;batch&#x5305;&#x542b;&#x56fe;&#x7247;&#x6570;&#x91cf;</span>\n        <span class=\"hljs-variable language_\">self</span>.batch_size = <span class=\"hljs-variable language_\">self</span>.avatar.batch_size\n        <span class=\"hljs-comment\"># batch&#x6570;&#x91cf;</span>\n        <span class=\"hljs-variable language_\">self</span>.chunk_size = <span class=\"hljs-variable language_\">self</span>.avatar.chunk_size\n\n        <span class=\"hljs-comment\"># &#x566a;&#x97f3;&#x56fe;&#x7247;size</span>\n        <span class=\"hljs-variable language_\">self</span>.noise_img_size = <span class=\"hljs-number\">100</span>\n        <span class=\"hljs-comment\"># &#x5377;&#x79ef;&#x8f6c;&#x7f6e;&#x8f93;&#x51fa;&#x901a;&#x9053;&#x6570;&#x91cf;</span>\n        <span class=\"hljs-variable language_\">self</span>.gf_size = <span class=\"hljs-number\">64</span>\n        <span class=\"hljs-comment\"># &#x5377;&#x79ef;&#x8f93;&#x51fa;&#x901a;&#x9053;&#x6570;&#x91cf;</span>\n        <span class=\"hljs-variable language_\">self</span>.df_size = <span class=\"hljs-number\">64</span>\n        <span class=\"hljs-comment\"># &#x8bad;&#x7ec3;&#x5faa;&#x73af;&#x6b21;&#x6570;</span>\n        <span class=\"hljs-variable language_\">self</span>.epoch_size = <span class=\"hljs-number\">1</span>  <span class=\"hljs-comment\"># 50</span>\n        <span class=\"hljs-comment\"># &#x5b66;&#x4e60;&#x7387;</span>\n        <span class=\"hljs-variable language_\">self</span>.learning_rate = <span class=\"hljs-number\">0.0002</span>\n        <span class=\"hljs-comment\"># &#x4f18;&#x5316;&#x6307;&#x6570;&#x8870;&#x51cf;&#x7387;</span>\n        <span class=\"hljs-variable language_\">self</span>.beta1 = <span class=\"hljs-number\">0.5</span>\n        <span class=\"hljs-comment\"># &#x751f;&#x6210;&#x56fe;&#x7247;&#x6570;&#x91cf;</span>\n        <span class=\"hljs-variable language_\">self</span>.sample_size = <span class=\"hljs-number\">64</span>\n        <span class=\"hljs-comment\"># &#x6a21;&#x578b;&#x4fdd;&#x5b58;&#x8def;&#x5f84; wdb 20200326</span>\n        <span class=\"hljs-comment\"># self.model_dir = os.path.join(os.getcwd(), &quot;model&quot;)</span>\n        <span class=\"hljs-comment\"># self.model_path = os.path.join(self.model_dir, &quot;avatar.model&quot;)</span>\n        <span class=\"hljs-comment\"># print(self.model_dir)</span>\n        <span class=\"hljs-comment\"># print(self.model_path)</span>\n\n<span class=\"hljs-meta\">    @staticmethod</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">conv_out_size_same</span>(<span class=\"hljs-params\">size, stride</span>):\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-built_in\">int</span>(math.ceil(<span class=\"hljs-built_in\">float</span>(size) / <span class=\"hljs-built_in\">float</span>(stride)))\n\n<span class=\"hljs-meta\">    @staticmethod</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">linear</span>(<span class=\"hljs-params\">images, output_size, stddev=<span class=\"hljs-number\">0.02</span>, bias_start=<span class=\"hljs-number\">0.0</span>, name=<span class=\"hljs-string\">&apos;Linear&apos;</span></span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;\n        &#x8ba1;&#x7b97;&#x7ebf;&#x6027;&#x6a21;&#x578b; wx+b\n        :param images:\n        :param output_size:\n        :param stddev:\n        :param bias_start:\n        :param name:\n        :return:\n        &quot;&quot;&quot;</span>\n        shape = images.get_shape().as_list()\n\n        <span class=\"hljs-keyword\">with</span> tf.variable_scope(name):\n            w = tf.get_variable(<span class=\"hljs-string\">&quot;w&quot;</span>, [shape[<span class=\"hljs-number\">1</span>], output_size], tf.float32,\n                                tf.random_normal_initializer(stddev=stddev))\n            b = tf.get_variable(<span class=\"hljs-string\">&quot;b&quot;</span>, [output_size],\n                                initializer=tf.constant_initializer(bias_start))\n            <span class=\"hljs-keyword\">return</span> tf.matmul(images, w) + b, w, b\n\n<span class=\"hljs-meta\">    @staticmethod</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">batch_normalizer</span>(<span class=\"hljs-params\">x, epsilon=<span class=\"hljs-number\">1e-5</span>, momentum=<span class=\"hljs-number\">0.9</span>, train=<span class=\"hljs-literal\">True</span>, name=<span class=\"hljs-string\">&apos;batch_norm&apos;</span></span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;\n        &#x6279;&#x91cf;&#x6b63;&#x5219;&#x5316;\n        :param x:\n        :param epsilon:\n        :param momentum:\n        :param train:\n        :param name:\n        :return:\n        &quot;&quot;&quot;</span>\n        <span class=\"hljs-keyword\">with</span> tf.variable_scope(name):\n            <span class=\"hljs-keyword\">return</span> tf.contrib.layers.batch_norm(x, decay=momentum,\n                                                updates_collections=<span class=\"hljs-literal\">None</span>, epsilon=epsilon,\n                                                scale=<span class=\"hljs-literal\">True</span>, is_training=train)\n\n<span class=\"hljs-meta\">    @staticmethod</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">conv2d</span>(<span class=\"hljs-params\">images, output_dim, stddev=<span class=\"hljs-number\">0.02</span>, name=<span class=\"hljs-string\">&quot;conv2d&quot;</span></span>):\n        <span class=\"hljs-string\">&quot;&quot;&quot;\n        &#x4e8c;&#x7ef4;&#x5377;&#x79ef;\n        :param images:\n        :param output_dim:\n        :param stddev:\n        :param name:\n        :return:\n        &quot;&quot;&quot;</span>\n        <span class=\"hljs-keyword\">with</span> tf.variable_scope(name):\n            <span class=\"hljs-comment\"># filter : [height, width, in_channels, output_channels]</span>\n            <span class=\"hljs-comment\"># &#x6ce8;&#x610f;&#x4e0e;&#x8f6c;&#x7f6e;&#x5377;&#x79ef;&#x7684;&#x4e0d;&#x540c;</span>\n            filter_shape = [<span class=\"hljs-number\">5</span>, <span class=\"hljs-number\">5</span>, images.get_shape()[-<span class=\"hljs-number\">1</span>], output_dim]\n            <span class=\"hljs-comment\"># strides</span>\n            <span class=\"hljs-comment\"># &#x5bf9;&#x5e94;&#x6bcf;&#x4e00;&#x7ef4;&#x7684;filter&#x79fb;&#x52a8;&#x6b65;&#x957f;</span>\n            strides_shape = [<span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">1</span>]\n\n            w = tf.get_variable(<span class=\"hljs-string\">&apos;w&apos;</span>, filter_shape,\n                                initializer=tf.truncated_normal_initializer(stddev=stddev))\n            b = tf.get_variable(<span class=\"hljs-string\">&apos;b&apos;</span>, [output_dim],\n                                initializer=tf.constant_initializer(<span class=\"hljs-number\">0.0</span>))\n\n            conv = tf.nn.conv2d(images, w, strides=strides_shape, padding=<span class=\"hljs-string\">&apos;SAME&apos;</span>)\n            conv = tf.reshape(tf.nn.bias_add(conv, b), conv.get_shape())\n\n            <span class=\"hljs-keyword\">return</span> conv\n\n<span class=\"hljs-meta\">    @staticmethod</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">deconv2d</span>(<span class=\"hljs-params\">images, output_shape, stddev=<span class=\"hljs-number\">0.02</span>, name=<span class=\"hljs-string\">&apos;deconv2d&apos;</span></span>):\n        <span class=\"hljs-keyword\">with</span> tf.variable_scope(name):\n            <span class=\"hljs-comment\"># filter : [height, width, output_channels, in_channels]</span>\n            <span class=\"hljs-comment\"># &#x6ce8;&#x610f;&#x4e0e;&#x5377;&#x79ef;&#x7684;&#x4e0d;&#x540c;</span>\n            filter_shape = [<span class=\"hljs-number\">5</span>, <span class=\"hljs-number\">5</span>, output_shape[-<span class=\"hljs-number\">1</span>], images.get_shape()[-<span class=\"hljs-number\">1</span>]]\n            <span class=\"hljs-comment\"># strides</span>\n            <span class=\"hljs-comment\"># &#x5bf9;&#x5e94;&#x6bcf;&#x4e00;&#x7ef4;&#x7684;filter&#x79fb;&#x52a8;&#x6b65;&#x957f;</span>\n            strides_shape = [<span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">2</span>, <span class=\"hljs-number\">1</span>]\n\n            w = tf.get_variable(<span class=\"hljs-string\">&apos;w&apos;</span>, filter_shape,\n                                initializer=tf.random_normal_initializer(stddev=stddev))\n            b = tf.get_variable(<span class=\"hljs-string\">&apos;biases&apos;</span>, [output_shape[-<span class=\"hljs-number\">1</span>]],\n                                initializer=tf.constant_initializer(<span class=\"hljs-number\">0.0</span>))\n\n            deconv = tf.nn.conv2d_transpose(images,\n                                            w,\n                                            output_shape=output_shape,\n                                            strides=strides_shape)\n            deconv = tf.nn.bias_add(deconv, b)\n\n            <span class=\"hljs-keyword\">return</span> deconv, w, b\n\n<span class=\"hljs-meta\">    @staticmethod</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">lrelu</span>(<span class=\"hljs-params\">x, leak=<span class=\"hljs-number\">0.2</span></span>):\n        <span class=\"hljs-keyword\">return</span> tf.maximum(x, leak * x)\n\n    <span class=\"hljs-comment\"># &#x751f;&#x6210;&#x5668;</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">generator</span>(<span class=\"hljs-params\">self, noise_imgs, train=<span class=\"hljs-literal\">True</span></span>):\n        <span class=\"hljs-keyword\">with</span> tf.variable_scope(<span class=\"hljs-string\">&apos;generator&apos;</span>):\n            <span class=\"hljs-comment\"># &#x5206;&#x522b;&#x5bf9;&#x5e94;&#x6bcf;&#x4e2a;layer&#x7684;height, width</span>\n            s_h, s_w, _ = <span class=\"hljs-variable language_\">self</span>.img_shape\n            s_h2, s_w2 = <span class=\"hljs-variable language_\">self</span>.conv_out_size_same(s_h, <span class=\"hljs-number\">2</span>), <span class=\"hljs-variable language_\">self</span>.conv_out_size_same(s_w, <span class=\"hljs-number\">2</span>)\n            s_h4, s_w4 = <span class=\"hljs-variable language_\">self</span>.conv_out_size_same(s_h2, <span class=\"hljs-number\">2</span>), <span class=\"hljs-variable language_\">self</span>.conv_out_size_same(s_w2, <span class=\"hljs-number\">2</span>)\n            s_h8, s_w8 = <span class=\"hljs-variable language_\">self</span>.conv_out_size_same(s_h4, <span class=\"hljs-number\">2</span>), <span class=\"hljs-variable language_\">self</span>.conv_out_size_same(s_w4, <span class=\"hljs-number\">2</span>)\n            s_h16, s_w16 = <span class=\"hljs-variable language_\">self</span>.conv_out_size_same(s_h8, <span class=\"hljs-number\">2</span>), <span class=\"hljs-variable language_\">self</span>.conv_out_size_same(s_w8, <span class=\"hljs-number\">2</span>)\n\n            <span class=\"hljs-comment\"># layer 0</span>\n            <span class=\"hljs-comment\"># &#x5bf9;&#x8f93;&#x5165;&#x566a;&#x97f3;&#x56fe;&#x7247;&#x8fdb;&#x884c;&#x7ebf;&#x6027;&#x53d8;&#x6362;</span>\n            z, h0_w, h0_b = <span class=\"hljs-variable language_\">self</span>.linear(noise_imgs, <span class=\"hljs-comment\"># &#x56fe;&#x7247;&#x6570;&#x636e;</span>\n                                        <span class=\"hljs-variable language_\">self</span>.gf_size * <span class=\"hljs-number\">8</span> * s_h16 * s_w16) <span class=\"hljs-comment\"># &#x8f93;&#x51fa;&#x503c;&#x4e2a;&#x6570;</span>\n            <span class=\"hljs-comment\"># reshape&#x4e3a;&#x5408;&#x9002;&#x7684;&#x8f93;&#x5165;&#x5c42;&#x683c;&#x5f0f;</span>\n            h0 = tf.reshape(z, [-<span class=\"hljs-number\">1</span>, s_h16, s_w16, <span class=\"hljs-variable language_\">self</span>.gf_size * <span class=\"hljs-number\">8</span>])\n            <span class=\"hljs-comment\"># &#x5bf9;&#x6570;&#x636e;&#x8fdb;&#x884c;&#x5f52;&#x4e00;&#x5316;&#x5904;&#x7406; &#x52a0;&#x5feb;&#x6536;&#x655b;&#x901f;&#x5ea6;</span>\n            h0 = <span class=\"hljs-variable language_\">self</span>.batch_normalizer(h0, train=train, name=<span class=\"hljs-string\">&apos;g_bn0&apos;</span>)\n            <span class=\"hljs-comment\"># &#x6fc0;&#x6d3b;&#x51fd;&#x6570;</span>\n            h0 = tf.nn.relu(h0)\n\n            <span class=\"hljs-comment\"># layer 1</span>\n            <span class=\"hljs-comment\"># &#x5377;&#x79ef;&#x8f6c;&#x7f6e;&#x8fdb;&#x884c;&#x4e0a;&#x91c7;&#x6837;</span>\n            h1, h1_w, h1_b = <span class=\"hljs-variable language_\">self</span>.deconv2d(h0, [<span class=\"hljs-variable language_\">self</span>.batch_size, s_h8, s_w8, <span class=\"hljs-variable language_\">self</span>.gf_size * <span class=\"hljs-number\">4</span>], name=<span class=\"hljs-string\">&apos;g_h1&apos;</span>)\n            h1 = <span class=\"hljs-variable language_\">self</span>.batch_normalizer(h1, train=train, name=<span class=\"hljs-string\">&apos;g_bn1&apos;</span>)\n            h1 = tf.nn.relu(h1)\n\n            <span class=\"hljs-comment\"># layer 2</span>\n            h2, h2_w, h2_b = <span class=\"hljs-variable language_\">self</span>.deconv2d(h1, [<span class=\"hljs-variable language_\">self</span>.batch_size, s_h4, s_w4, <span class=\"hljs-variable language_\">self</span>.gf_size * <span class=\"hljs-number\">2</span>], name=<span class=\"hljs-string\">&apos;g_h2&apos;</span>)\n            h2 = <span class=\"hljs-variable language_\">self</span>.batch_normalizer(h2, train=train, name=<span class=\"hljs-string\">&apos;g_bn2&apos;</span>)\n            h2 = tf.nn.relu(h2)\n\n            <span class=\"hljs-comment\"># layer 3</span>\n            h3, h3_w, h3_b = <span class=\"hljs-variable language_\">self</span>.deconv2d(h2, [<span class=\"hljs-variable language_\">self</span>.batch_size, s_h2, s_w2, <span class=\"hljs-variable language_\">self</span>.gf_size * <span class=\"hljs-number\">1</span>], name=<span class=\"hljs-string\">&apos;g_h3&apos;</span>)\n            h3 = <span class=\"hljs-variable language_\">self</span>.batch_normalizer(h3, train=train, name=<span class=\"hljs-string\">&apos;g_bn3&apos;</span>)\n            h3 = tf.nn.relu(h3)\n\n            <span class=\"hljs-comment\"># layer 4</span>\n            h4, h4_w, h4_b = <span class=\"hljs-variable language_\">self</span>.deconv2d(h3, <span class=\"hljs-variable language_\">self</span>.batch_shape, name=<span class=\"hljs-string\">&apos;g_h4&apos;</span>)\n            <span class=\"hljs-keyword\">return</span> tf.nn.tanh(h4)\n\n    <span class=\"hljs-comment\"># &#x5224;&#x522b;&#x5668;</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">discriminator</span>(<span class=\"hljs-params\">self, real_imgs, reuse=<span class=\"hljs-literal\">False</span></span>):\n        <span class=\"hljs-keyword\">with</span> tf.variable_scope(<span class=\"hljs-string\">&quot;discriminator&quot;</span>, reuse=reuse):\n            <span class=\"hljs-comment\"># layer 0</span>\n            <span class=\"hljs-comment\"># &#x5377;&#x79ef;&#x64cd;&#x4f5c;</span>\n            h0 = <span class=\"hljs-variable language_\">self</span>.conv2d(real_imgs, <span class=\"hljs-variable language_\">self</span>.df_size, name=<span class=\"hljs-string\">&apos;d_h0_conv&apos;</span>)\n            <span class=\"hljs-comment\"># &#x6fc0;&#x6d3b;&#x51fd;&#x6570;</span>\n            h0 = <span class=\"hljs-variable language_\">self</span>.lrelu(h0)\n\n            <span class=\"hljs-comment\"># layer 1</span>\n            h1 = <span class=\"hljs-variable language_\">self</span>.conv2d(h0, <span class=\"hljs-variable language_\">self</span>.df_size * <span class=\"hljs-number\">2</span>, name=<span class=\"hljs-string\">&apos;d_h1_conv&apos;</span>)\n            h1 = <span class=\"hljs-variable language_\">self</span>.batch_normalizer(h1, name=<span class=\"hljs-string\">&apos;d_bn1&apos;</span>)\n            h1 = <span class=\"hljs-variable language_\">self</span>.lrelu(h1)\n\n            <span class=\"hljs-comment\"># layer 2</span>\n            h2 = <span class=\"hljs-variable language_\">self</span>.conv2d(h1, <span class=\"hljs-variable language_\">self</span>.df_size * <span class=\"hljs-number\">4</span>, name=<span class=\"hljs-string\">&apos;d_h2_conv&apos;</span>)\n            h2 = <span class=\"hljs-variable language_\">self</span>.batch_normalizer(h2, name=<span class=\"hljs-string\">&apos;d_bn2&apos;</span>)\n            h2 = <span class=\"hljs-variable language_\">self</span>.lrelu(h2)\n\n            <span class=\"hljs-comment\"># layer 3</span>\n            h3 = <span class=\"hljs-variable language_\">self</span>.conv2d(h2, <span class=\"hljs-variable language_\">self</span>.df_size * <span class=\"hljs-number\">8</span>, name=<span class=\"hljs-string\">&apos;d_h3_conv&apos;</span>)\n            h3 = <span class=\"hljs-variable language_\">self</span>.batch_normalizer(h3, name=<span class=\"hljs-string\">&apos;d_bn3&apos;</span>)\n            h3 = <span class=\"hljs-variable language_\">self</span>.lrelu(h3)\n\n            <span class=\"hljs-comment\"># layer 4</span>\n            h4, _, _ = <span class=\"hljs-variable language_\">self</span>.linear(tf.reshape(h3, [<span class=\"hljs-variable language_\">self</span>.batch_size, -<span class=\"hljs-number\">1</span>]), <span class=\"hljs-number\">1</span>, name=<span class=\"hljs-string\">&apos;d_h4_lin&apos;</span>)\n\n            <span class=\"hljs-keyword\">return</span> tf.nn.sigmoid(h4), h4\n\n<span class=\"hljs-meta\">    @staticmethod</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">loss_graph</span>(<span class=\"hljs-params\">real_logits, fake_logits</span>):\n        <span class=\"hljs-comment\"># &#x751f;&#x6210;&#x5668;&#x56fe;&#x7247;loss</span>\n        <span class=\"hljs-comment\"># &#x751f;&#x6210;&#x5668;&#x5e0c;&#x671b;&#x5224;&#x522b;&#x5668;&#x5224;&#x65ad;&#x51fa;&#x6765;&#x7684;&#x6807;&#x7b7e;&#x4e3a;1</span>\n        gen_loss = tf.reduce_mean(tf.nn.sigmoid_cross_entropy_with_logits(logits=fake_logits,\n                                                                          labels=tf.ones_like(fake_logits)))\n        <span class=\"hljs-comment\"># &#x5224;&#x522b;&#x5668;&#x8bc6;&#x522b;&#x751f;&#x6210;&#x5668;&#x56fe;&#x7247;loss</span>\n        <span class=\"hljs-comment\"># &#x5224;&#x522b;&#x5668;&#x5e0c;&#x671b;&#x8bc6;&#x522b;&#x51fa;&#x6765;&#x7684;&#x6807;&#x7b7e;&#x4e3a;0</span>\n        fake_loss = tf.reduce_mean(tf.nn.sigmoid_cross_entropy_with_logits(logits=fake_logits,\n                                                                           labels=tf.zeros_like(fake_logits)))\n        <span class=\"hljs-comment\"># &#x5224;&#x522b;&#x5668;&#x8bc6;&#x522b;&#x771f;&#x5b9e;&#x56fe;&#x7247;loss</span>\n        <span class=\"hljs-comment\"># &#x5224;&#x522b;&#x5668;&#x5e0c;&#x671b;&#x8bc6;&#x522b;&#x51fa;&#x6765;&#x7684;&#x6807;&#x7b7e;&#x4e3a;1</span>\n        real_loss = tf.reduce_mean(tf.nn.sigmoid_cross_entropy_with_logits(logits=real_logits,\n                                                                           labels=tf.ones_like(real_logits)))\n        <span class=\"hljs-comment\"># &#x5224;&#x522b;&#x5668;&#x603b;loss</span>\n        dis_loss = tf.add(fake_loss, real_loss)\n        <span class=\"hljs-keyword\">return</span> gen_loss, fake_loss, real_loss, dis_loss\n\n<span class=\"hljs-meta\">    @staticmethod</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">optimizer_graph</span>(<span class=\"hljs-params\">gen_loss, dis_loss, learning_rate, beta1</span>):\n        <span class=\"hljs-comment\"># &#x6240;&#x6709;&#x5b9a;&#x4e49;&#x53d8;&#x91cf;</span>\n        train_vars = tf.trainable_variables()\n        <span class=\"hljs-comment\"># &#x751f;&#x6210;&#x5668;&#x53d8;&#x91cf;</span>\n        gen_vars = [var <span class=\"hljs-keyword\">for</span> var <span class=\"hljs-keyword\">in</span> train_vars <span class=\"hljs-keyword\">if</span> var.name.startswith(<span class=\"hljs-string\">&apos;generator&apos;</span>)]\n        <span class=\"hljs-comment\"># &#x5224;&#x522b;&#x5668;&#x53d8;&#x91cf;</span>\n        dis_vars = [var <span class=\"hljs-keyword\">for</span> var <span class=\"hljs-keyword\">in</span> train_vars <span class=\"hljs-keyword\">if</span> var.name.startswith(<span class=\"hljs-string\">&apos;discriminator&apos;</span>)]\n        <span class=\"hljs-comment\"># optimizer</span>\n        <span class=\"hljs-comment\"># &#x751f;&#x6210;&#x5668;&#x4e0e;&#x5224;&#x522b;&#x5668;&#x4f5c;&#x4e3a;&#x4e24;&#x4e2a;&#x7f51;&#x7edc;&#x9700;&#x8981;&#x5206;&#x522b;&#x4f18;&#x5316;</span>\n        gen_optimizer = tf.train.AdamOptimizer(learning_rate=learning_rate, beta1=beta1).minimize(gen_loss,\n                                                                                                  var_list=gen_vars)\n        dis_optimizer = tf.train.AdamOptimizer(learning_rate=learning_rate, beta1=beta1).minimize(dis_loss,\n                                                                                                  var_list=dis_vars)\n        <span class=\"hljs-keyword\">return</span> gen_optimizer, dis_optimizer\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">train</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-comment\"># &#x771f;&#x5b9e;&#x56fe;&#x7247;</span>\n        real_imgs = tf.placeholder(tf.float32, <span class=\"hljs-variable language_\">self</span>.batch_shape, name=<span class=\"hljs-string\">&apos;real_images&apos;</span>)\n        <span class=\"hljs-comment\"># &#x566a;&#x58f0;&#x56fe;&#x7247;</span>\n        noise_imgs = tf.placeholder(tf.float32, [<span class=\"hljs-literal\">None</span>, <span class=\"hljs-variable language_\">self</span>.noise_img_size], name=<span class=\"hljs-string\">&apos;noise_images&apos;</span>)\n\n        <span class=\"hljs-comment\"># &#x751f;&#x6210;&#x5668;&#x56fe;&#x7247;</span>\n        fake_imgs = <span class=\"hljs-variable language_\">self</span>.generator(noise_imgs)\n\n        <span class=\"hljs-comment\"># &#x5224;&#x522b;&#x5668;</span>\n        real_outputs, real_logits = <span class=\"hljs-variable language_\">self</span>.discriminator(real_imgs)\n        fake_outputs, fake_logits = <span class=\"hljs-variable language_\">self</span>.discriminator(fake_imgs, reuse=<span class=\"hljs-literal\">True</span>)\n\n        <span class=\"hljs-comment\"># &#x635f;&#x5931;</span>\n        gen_loss, fake_loss, real_loss, dis_loss = <span class=\"hljs-variable language_\">self</span>.loss_graph(real_logits, fake_logits)\n        <span class=\"hljs-comment\"># &#x4f18;&#x5316;</span>\n        gen_optimizer, dis_optimizer = <span class=\"hljs-variable language_\">self</span>.optimizer_graph(gen_loss, dis_loss, <span class=\"hljs-variable language_\">self</span>.learning_rate, <span class=\"hljs-variable language_\">self</span>.beta1)\n\n        <span class=\"hljs-comment\"># &#x5f00;&#x59cb;&#x8bad;&#x7ec3;</span>\n        saver = tf.train.Saver()\n        step = <span class=\"hljs-number\">0</span>\n        <span class=\"hljs-comment\"># &#x6307;&#x5b9a;&#x5360;&#x7528;GPU&#x6bd4;&#x4f8b;</span>\n        <span class=\"hljs-comment\"># tensorflow&#x9ed8;&#x8ba4;&#x5360;&#x7528;&#x5168;&#x90e8;GPU&#x663e;&#x5b58; &#x9632;&#x6b62;&#x5728;&#x673a;&#x5668;&#x663e;&#x5b58;&#x88ab;&#x5176;&#x4ed6;&#x7a0b;&#x5e8f;&#x5360;&#x7528;&#x8fc7;&#x591a;&#x65f6;&#x53ef;&#x80fd;&#x5728;&#x542f;&#x52a8;&#x65f6;&#x62a5;&#x9519;</span>\n        gpu_options = tf.GPUOptions(per_process_gpu_memory_fraction=<span class=\"hljs-number\">0.8</span>)\n\n        <span class=\"hljs-keyword\">with</span> tf.Session(config=tf.ConfigProto(gpu_options=gpu_options)) <span class=\"hljs-keyword\">as</span> sess:\n            sess.run(tf.global_variables_initializer())\n\n            <span class=\"hljs-comment\"># &#x8bad;&#x7ec3;&#x4e4b;&#x524d;&#xff0c;&#x52a0;&#x8f7d;&#x6a21;&#x578b;&#xff0c;&#x4ece;&#x800c;&#x5b9e;&#x73b0;&#x589e;&#x91cf;&#x8bad;&#x7ec3; wdb add 20200403</span>\n            <span class=\"hljs-keyword\">if</span> os.path.exists(<span class=\"hljs-string\">&quot;./model/checkpoint&quot;</span>):\n                <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;&#x52a0;&#x8f7d;&#x6a21;&#x578b;:&quot;</span>, os.getcwd())\n                saver.restore(sess, tf.train.latest_checkpoint(<span class=\"hljs-string\">&quot;./model/&quot;</span>))\n\n            <span class=\"hljs-keyword\">for</span> epoch <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(<span class=\"hljs-variable language_\">self</span>.epoch_size):\n                batches = <span class=\"hljs-variable language_\">self</span>.avatar.batches()\n                <span class=\"hljs-keyword\">for</span> batch_imgs <span class=\"hljs-keyword\">in</span> batches:\n                    <span class=\"hljs-comment\"># generator&#x7684;&#x8f93;&#x5165;&#x566a;&#x58f0;</span>\n                    noises = np.random.uniform(-<span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">1</span>, size=(<span class=\"hljs-variable language_\">self</span>.batch_size, <span class=\"hljs-variable language_\">self</span>.noise_img_size)).astype(np.float32)\n                    <span class=\"hljs-comment\"># &#x4f18;&#x5316;</span>\n                    _ = sess.run(dis_optimizer, feed_dict={real_imgs: batch_imgs, noise_imgs: noises})\n                    _ = sess.run(gen_optimizer, feed_dict={noise_imgs: noises})\n                    _ = sess.run(gen_optimizer, feed_dict={noise_imgs: noises})\n                    step += <span class=\"hljs-number\">1</span>\n                    <span class=\"hljs-built_in\">print</span>(datetime.now().strftime(<span class=\"hljs-string\">&apos;%c&apos;</span>), epoch, step)\n                <span class=\"hljs-comment\"># &#x6bcf;&#x4e00;&#x8f6e;&#x7ed3;&#x675f;&#x8ba1;&#x7b97;loss</span>\n                <span class=\"hljs-comment\"># &#x5224;&#x522b;&#x5668;&#x635f;&#x5931;</span>\n                loss_dis = sess.run(dis_loss, feed_dict={real_imgs: batch_imgs, noise_imgs: noises})\n                <span class=\"hljs-comment\"># &#x5224;&#x522b;&#x5668;&#x5bf9;&#x771f;&#x5b9e;&#x56fe;&#x7247;</span>\n                loss_real = sess.run(real_loss, feed_dict={real_imgs: batch_imgs, noise_imgs: noises})\n                <span class=\"hljs-comment\"># &#x5224;&#x522b;&#x5668;&#x5bf9;&#x751f;&#x6210;&#x5668;&#x56fe;&#x7247;</span>\n                loss_fake = sess.run(fake_loss, feed_dict={real_imgs: batch_imgs, noise_imgs: noises})\n                <span class=\"hljs-comment\"># &#x751f;&#x6210;&#x5668;&#x635f;&#x5931;</span>\n                loss_gen = sess.run(gen_loss, feed_dict={noise_imgs: noises})\n\n                <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;&quot;</span>)\n                <span class=\"hljs-built_in\">print</span>(datetime.now().strftime(<span class=\"hljs-string\">&apos;%c&apos;</span>), <span class=\"hljs-string\">&apos; epoch:&apos;</span>, epoch, <span class=\"hljs-string\">&apos; step:&apos;</span>, step, <span class=\"hljs-string\">&apos; loss_dis:&apos;</span>, loss_dis,\n                      <span class=\"hljs-string\">&apos; loss_real:&apos;</span>, loss_real, <span class=\"hljs-string\">&apos; loss_fake:&apos;</span>, loss_fake, <span class=\"hljs-string\">&apos; loss_gen:&apos;</span>, loss_gen)\n\n            model_path = <span class=\"hljs-string\">&quot;./model/&quot;</span> + <span class=\"hljs-string\">&quot;avatar.model&quot;</span>\n            saver.save(sess, model_path, global_step=step)\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">gen</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-comment\"># &#x751f;&#x6210;&#x56fe;&#x7247;</span>\n        noise_imgs = tf.placeholder(tf.float32, [<span class=\"hljs-literal\">None</span>, <span class=\"hljs-variable language_\">self</span>.noise_img_size], name=<span class=\"hljs-string\">&apos;noise_imgs&apos;</span>)\n        sample_imgs = <span class=\"hljs-variable language_\">self</span>.generator(noise_imgs, train=<span class=\"hljs-literal\">False</span>)\n        saver = tf.train.Saver()\n\n        <span class=\"hljs-keyword\">with</span> tf.Session() <span class=\"hljs-keyword\">as</span> sess:\n            sess.run(tf.global_variables_initializer())\n\n            saver.restore(sess, tf.train.latest_checkpoint(<span class=\"hljs-string\">&apos;./model/&apos;</span>))\n            <span class=\"hljs-comment\"># print(&quot;model_dir:&quot;, self.model_dir)</span>\n            <span class=\"hljs-comment\"># saver.restore(sess, tf.train.latest_checkpoint(self.model_dir))</span>\n\n            sample_noise = np.random.uniform(-<span class=\"hljs-number\">1</span>, <span class=\"hljs-number\">1</span>, size=(<span class=\"hljs-variable language_\">self</span>.sample_size, <span class=\"hljs-variable language_\">self</span>.noise_img_size))\n            samples = sess.run(sample_imgs, feed_dict={noise_imgs: sample_noise})\n\n        <span class=\"hljs-keyword\">for</span> num <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(<span class=\"hljs-built_in\">len</span>(samples)):\n            <span class=\"hljs-variable language_\">self</span>.avatar.save_img(samples[num], <span class=\"hljs-string\">&apos;samples&apos;</span> + os.sep + <span class=\"hljs-built_in\">str</span>(num) + <span class=\"hljs-string\">&apos;.jpg&apos;</span>)\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"93,416"}},{"content":"<pre data-lines=\"417,427\"><code class=\"language-python\"><span class=\"hljs-comment\"># from avatarDcgan.avatar_model import AvatarModel</span>\n<span class=\"hljs-keyword\">from</span> avatar_model <span class=\"hljs-keyword\">import</span> AvatarModel <span class=\"hljs-comment\"># wdb 20200325</span>\n\n<span class=\"hljs-keyword\">if</span> __name__ == <span class=\"hljs-string\">&apos;__main__&apos;</span>:\n    avatar = AvatarModel()\n    avatar.train()\n\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"417,427"}},{"content":"<pre data-lines=\"428,445\"><code data-lines=\"428,445\"><span class=\"hljs-comment\"># &#x7b80;&#x4ecb;</span>\n&#x57fa;&#x4e8e;DCGAN&#x7684;&#x52a8;&#x6f2b;&#x5934;&#x50cf;&#x751f;&#x6210;&#x6a21;&#x578b;\n<span class=\"hljs-comment\"># &#x5feb;&#x901f;&#x5f00;&#x59cb;</span>\n* &#x8bad;&#x7ec3;&#x6a21;&#x578b;\n\n  python avatar_train.py\n\n* &#x56fe;&#x7247;&#x751f;&#x6210;\n\n &#xa0;python avatar_gen.py\n  \n <span class=\"hljs-comment\"># &#x5176;&#x4ed6;</span>\n &#x535a;&#x5ba2;&#xff1a;http:<span class=\"hljs-regexp\">//</span>blog.csdn.net<span class=\"hljs-regexp\">/sinat_33741547/</span>article<span class=\"hljs-regexp\">/details/</span><span class=\"hljs-number\">77871170</span>\n \n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"428,445"}},{"content":"<pre data-lines=\"446,458\"><code class=\"language-python\"><span class=\"hljs-keyword\">import</span> os\n\nimgs = os.listdir(<span class=\"hljs-string\">&quot;faces&quot;</span>)\ni = <span class=\"hljs-number\">0</span>\n<span class=\"hljs-keyword\">for</span> img <span class=\"hljs-keyword\">in</span> imgs:\n    i += <span class=\"hljs-number\">1</span>\n    <span class=\"hljs-keyword\">if</span> i &gt; <span class=\"hljs-number\">8000</span>:\n        file_name = <span class=\"hljs-string\">&quot;faces\\\\&quot;</span> + img\n        <span class=\"hljs-built_in\">print</span>(file_name)\n        os.remove(file_name)\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"446,458"}}],"payload":{"tag":"h5","lines":"4,5"}}],"payload":{"tag":"h3","lines":"0,1"}},{})</script>
</body>
</html>
