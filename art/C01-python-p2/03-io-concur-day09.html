<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets@11.11.1/styles/default.min.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.18.10/dist/browser/index.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/index.js"></script><script>(r => {
              setTimeout(r);
            })(function renderToolbar() {
  const {
    markmap,
    mm
  } = window;
  const {
    el
  } = markmap.Toolbar.create(mm);
  el.setAttribute('style', 'position:absolute;bottom:20px;right:20px');
  document.body.append(el);
})</script><script>((getMarkmap, getOptions, root2, jsonOptions) => {
              const markmap = getMarkmap();
              window.mm = markmap.Markmap.create(
                "svg#mindmap",
                (getOptions || markmap.deriveOptions)(jsonOptions),
                root2
              );
            })(() => window.markmap,null,{"content":"03-io-concur-day09","children":[{"content":"IO-CONCUR","children":[{"content":"&#x524d;&#x60c5;&#x56de;&#x987e;","children":[{"content":"<pre data-lines=\"8,88\"><code data-lines=\"8,88\">\n<span class=\"hljs-bullet\">1.</span> &#x7ebf;&#x7a0b;&#x3000;&#x591a;&#x4efb;&#x52a1;&#x7f16;&#x7a0b;&#x65b9;&#x5f0f;\n\n<span class=\"hljs-bullet\">2.</span> &#x7ebf;&#x7a0b;&#x5c5e;&#x6027;&#xff0c;&#x81ea;&#x5b9a;&#x4e49;&#x7ebf;&#x7a0b;&#x7c7b;\n\n<span class=\"hljs-bullet\">3.</span> &#x540c;&#x6b65;&#x4e92;&#x65a5;&#x65b9;&#x6cd5;\n\n&#x6d4b;&#x8bd5;&#x7ed3;&#x679c;&#xff1a;\nsingle cpu: 7.59330940246582\nsingle cpu: 5.1670081615448\n\nThread cpu: 6.379784107208252\nThread io: 4.807955503463745\n\nProcess cpu: 3.6827900409698486\nProcess io: 2.2019951343536377\n\n\n&#x7ec3;&#x4e60;&#xff1a;  &#x6839;&#x636e;&#x591a;&#x8fdb;&#x7a0b;&#x7f51;&#x7edc;&#x5e76;&#x53d1;&#x7684;&#x6a21;&#x578b;&#x548c;&#x601d;&#x60f3;&#xff0c;&#x5b8c;&#x6210;Thread&#x7684;&#x591a;\n&#x7ebf;&#x7a0b;&#x5e76;&#x53d1;\n\n\nftp&#x6587;&#x4ef6;&#x670d;&#x52a1;&#x5668;\n\n<span class=\"hljs-bullet\">1.</span> &#x9700;&#x6c42;&#x5206;&#x6790;\n\n<span class=\"hljs-bullet\">2.</span> &#x6280;&#x672f;&#x70b9;&#x5206;&#x6790;\n\n   &#x5e76;&#x53d1;&#x6a21;&#x578b; &#xff1a; &#x591a;&#x8fdb;&#x7a0b; / &#x591a;&#x7ebf;&#x7a0b;\n\n   &#x7f51;&#x7edc;&#x4f20;&#x8f93; &#xff1a; TCP\n\n\n<span class=\"hljs-bullet\">3.</span> &#x7ed3;&#x6784;&#x8bbe;&#x8ba1;\n\n   &#x5c01;&#x88c5;&#x7ed3;&#x6784; &#xff1a; &#x51fd;&#x6570; &#x548c; &#x7c7b;\n\n<span class=\"hljs-bullet\">4.</span> &#x529f;&#x80fd;&#x5212;&#x5206;&#x548c;&#x534f;&#x8bae;\n\n   &#x7f51;&#x7edc;&#x7ed3;&#x6784;&#x642d;&#x5efa;\n   &#x67e5;&#x770b;&#x6587;&#x4ef6;&#x5e93;\n   &#x4e0a;&#x4f20;&#x6587;&#x4ef6;\n   &#x4e0b;&#x8f7d;&#x6587;&#x4ef6;\n   &#x9000;&#x51fa;&#x64cd;&#x4f5c;\n\n   &#x534f;&#x8bae; &#xff1a;&#x3000;S  &#x67e5;&#x770b;&#x6587;&#x4ef6;&#x5e93;\n<span class=\"hljs-code\">    &#x3000;&#x3000;&#x3000;&#x3000;U  &#x4e0a;&#x4f20;\n    &#x3000;&#x3000;&#x3000;&#x3000;D  &#x4e0b;&#x8f7d;\n    &#x3000;&#x3000;&#x3000;&#x3000;Q  &#x9000;&#x51fa;\n</span>\n<span class=\"hljs-bullet\">5.</span> &#x529f;&#x80fd;&#x6a21;&#x5757;&#x7684;&#x5177;&#x4f53;&#x5206;&#x6790;\n\n   &#x67e5;&#x770b;&#x6587;&#x4ef6;&#x5e93;\n<span class=\"hljs-code\">      &#x5ba2;&#x6237;&#x7aef;: &#x53d1;&#x9001;&#x8bf7;&#x6c42;\n             &#x63a5;&#x53d7;&#x7ed3;&#x679c;\n             &#x6253;&#x5370;&#x6587;&#x4ef6;&#x5217;&#x8868;\n</span>\n<span class=\"hljs-code\">      &#x670d;&#x52a1;&#x7aef;&#xff1a; &#x83b7;&#x53d6;&#x6587;&#x4ef6;&#x5e93;&#x5217;&#x8868;\n              &#x53d1;&#x9001;&#x6587;&#x4ef6;&#x540d;\n</span>\n   &#x4e0a;&#x4f20;&#x6587;&#x4ef6;\n   &#x4e0b;&#x8f7d;&#x6587;&#x4ef6;\n   &#x9000;&#x51fa;&#x64cd;&#x4f5c;\n\n&#x4f5c;&#x4e1a;&#x7ec3;&#x4e60;:  * &#x4f18;&#x5148;&#x8bfe;&#x4e0a;&#x91cd;&#x70b9;&#x4ee3;&#x7801;\n\n1.&#x4e24;&#x4e2a;&#x7ebf;&#x7a0b;&#xff0c;&#x4e00;&#x4e2a;&#x7ebf;&#x7a0b;&#x6253;&#x5370;1-52, &#x53e6;&#x4e00;&#x4e2a;&#x7ebf;&#x7a0b;&#x6253;&#x5370;A-Z.&#x4e24;&#x4e2a;&#x7ebf;&#x7a0b;&#x540c;&#x65f6;&#x6267;&#x884c;&#xff0c;&#x8981;&#x6c42;&#x6253;&#x5370;&#x51fa;12A34B56C...5152Z&#x4e00;&#x4e32;&#x6570;&#x5b57;&#x3002;&#x4e0d;&#x5e94;&#x8be5;&#x7528;sleep&#x63a7;&#x5236;&#x3002;\n\n2.&#x804a;&#x5929;&#x5ba4;&#x4ee3;&#x7801;\n<span class=\"hljs-code\">    &#x654f;&#x611f;&#x8bcd;&#x6c47;&#xff1a; aa  bb  xx\n    * &#x5f53;&#x6709;&#x6210;&#x5458;&#x804a;&#x5929;&#x5185;&#x5bb9;&#x4e2d;&#x5305;&#x542b;&#x654f;&#x611f;&#x8bcd;&#x6c47;&#xff0c;&#x9700;&#x8981;&#x8fdb;&#x884c;&#x5c4f;&#x853d;&#x3002;&#x5e76;&#x4e14;\n    &#x5411;&#x7fa4;&#x91cc;&#x53d1;&#x8b66;&#x544a;&#x4fe1;&#x606f;&#xff0c;&#x6240;&#x6709;&#x4eba;&#x53ef;&#x89c1;\n    * &#x5982;&#x679c;&#x4e00;&#x4e2a;&#x4eba;&#x88ab;&#x8b66;&#x544a;&#x4e09;&#x6b21;&#x5219;&#x5c06;&#x5176;&#x4ece;&#x7fa4;&#x91cc;&#x8e22;&#x51fa;&#xff0c;&#x5e76;&#x5c06;&#x8fd9;&#x4e2a;IP&#x62c9;&#x9ed1;\n</span>\n<span class=\"hljs-bullet\">3.</span> &#x6587;&#x4ef6;&#x670d;&#x52a1;&#x5668;\n<span class=\"hljs-bullet\">    *</span> &#x80fd;&#x5426;&#x4e00;&#x4e2a;&#x5ba2;&#x6237;&#x7aef;&#x540c;&#x65f6;&#x53ef;&#x4ee5;&#x4e0b;&#x8f7d;&#x591a;&#x4e2a;&#x6587;&#x4ef6;\n<span class=\"hljs-bullet\">    *</span> &#x540c;&#x65f6;&#x6700;&#x591a;&#x80fd;&#x591f;&#x4e0b;&#x8f7d;4&#x4e2a;\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"8,88"}}],"payload":{"tag":"h5","lines":"6,7"}},{"content":"&#x793a;&#x4f8b;","children":[{"content":"<pre data-lines=\"91,146\"><code class=\"language-python\"><span class=\"hljs-string\">&quot;&quot;&quot;\nfork_server.py  &#x57fa;&#x4e8e;fork&#x7684;&#x591a;&#x8fdb;&#x7a0b;&#x7f51;&#x7edc;&#x5e76;&#x53d1;\n&#x91cd;&#x70b9;&#x4ee3;&#x7801;\n&quot;&quot;&quot;</span>\n<span class=\"hljs-keyword\">from</span> socket <span class=\"hljs-keyword\">import</span> *\n<span class=\"hljs-keyword\">import</span> os\n<span class=\"hljs-keyword\">import</span> signal\n\n<span class=\"hljs-comment\"># &#x5168;&#x5c40;&#x53d8;&#x91cf;</span>\nHOST = <span class=\"hljs-string\">&apos;0.0.0.0&apos;</span>\nPORT = <span class=\"hljs-number\">8888</span>\nADDR = (HOST,PORT)\n\n<span class=\"hljs-comment\"># &#x5904;&#x7406;&#x5ba2;&#x6237;&#x7aef;&#x4e8b;&#x4ef6;</span>\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">handle</span>(<span class=\"hljs-params\">connfd</span>):\n    <span class=\"hljs-keyword\">while</span> <span class=\"hljs-literal\">True</span>:\n        data = connfd.recv(<span class=\"hljs-number\">1024</span>).decode()\n        <span class=\"hljs-keyword\">if</span> <span class=\"hljs-keyword\">not</span> data:\n            <span class=\"hljs-keyword\">break</span>\n        <span class=\"hljs-built_in\">print</span>(data)\n        connfd.send(<span class=\"hljs-string\">b&apos;OK&apos;</span>)\n    connfd.close()\n\n<span class=\"hljs-comment\"># &#x521b;&#x5efa;&#x76d1;&#x542c;&#x5957;&#x63a5;&#x5b57;</span>\ns = socket()\ns.setsockopt(SOL_SOCKET,SO_REUSEADDR,<span class=\"hljs-number\">1</span>)\ns.bind(ADDR)\ns.listen(<span class=\"hljs-number\">3</span>)\n\n<span class=\"hljs-comment\"># &#x5904;&#x7406;&#x50f5;&#x5c38;&#x8fdb;&#x7a0b;</span>\nsignal.signal(signal.SIGCHLD,signal.SIG_IGN)\n\n<span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&apos;Listen the port 8888...&apos;</span>)\n<span class=\"hljs-keyword\">while</span> <span class=\"hljs-literal\">True</span>:\n    <span class=\"hljs-keyword\">try</span>:\n        c,addr = s.accept()\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;Connect from&quot;</span>,addr)\n    <span class=\"hljs-keyword\">except</span> KeyboardInterrupt:\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;&#x670d;&#x52a1;&#x5668;&#x9000;&#x51fa;&quot;</span>)\n        s.close()\n        os._exit(<span class=\"hljs-number\">0</span>)\n    <span class=\"hljs-keyword\">except</span> Exception <span class=\"hljs-keyword\">as</span> e:\n        <span class=\"hljs-built_in\">print</span>(e)\n        <span class=\"hljs-keyword\">continue</span>\n    <span class=\"hljs-comment\"># &#x5ba2;&#x6237;&#x7aef;&#x8fde;&#x63a5;&#x540e;&#xff0c;&#x65b0;&#x7684;&#x8fdb;&#x7a0b;&#x5904;&#x7406;&#x5ba2;&#x6237;&#x7aef;&#x8bf7;&#x6c42;</span>\n    pid = os.fork()\n    <span class=\"hljs-keyword\">if</span> pid == <span class=\"hljs-number\">0</span>:\n        s.close()\n        handle(c) <span class=\"hljs-comment\"># &#x5904;&#x7406;&#x5ba2;&#x6237;&#x7aef;&#x8bf7;&#x6c42;</span>\n        os._exit(<span class=\"hljs-number\">0</span>) <span class=\"hljs-comment\"># &#x5b50;&#x8fdb;&#x7a0b;&#x5904;&#x7406;&#x5b8c;&#x5ba2;&#x6237;&#x7aef;&#x4e8b;&#x4ef6;&#x5c31;&#x9000;&#x51fa;</span>\n    <span class=\"hljs-keyword\">else</span>:\n        c.close()\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"91,146"}},{"content":"<pre data-lines=\"147,259\"><code class=\"language-python\"><span class=\"hljs-string\">&quot;&quot;&quot;\nftp_client.py\nftp &#x6587;&#x4ef6;&#x670d;&#x52a1; &#x5ba2;&#x6237;&#x7aef;\n&quot;&quot;&quot;</span>\n<span class=\"hljs-keyword\">from</span> socket <span class=\"hljs-keyword\">import</span> *\n<span class=\"hljs-keyword\">import</span> sys\n<span class=\"hljs-keyword\">from</span> time <span class=\"hljs-keyword\">import</span> sleep\n\n<span class=\"hljs-comment\"># &#x670d;&#x52a1;&#x5668;&#x5730;&#x5740;</span>\nADDR = (<span class=\"hljs-string\">&apos;127.0.0.1&apos;</span>,<span class=\"hljs-number\">8888</span>)\n\n<span class=\"hljs-comment\"># &#x8bf7;&#x6c42;&#x529f;&#x80fd;</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">FTPCient</span>:\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__init__</span>(<span class=\"hljs-params\">self,sock</span>):\n        <span class=\"hljs-variable language_\">self</span>.sock = sock\n\n    <span class=\"hljs-comment\"># &#x83b7;&#x53d6;&#x6587;&#x4ef6;&#x5217;&#x8868;</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">select</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-variable language_\">self</span>.sock.send(<span class=\"hljs-string\">b&quot;S&quot;</span>) <span class=\"hljs-comment\"># &#x53d1;&#x9001;&#x8bf7;&#x6c42;</span>\n        <span class=\"hljs-comment\"># &#x7b49;&#x5f85;&#x7ed3;&#x679c; &#x7b49; Yes or No</span>\n        data = <span class=\"hljs-variable language_\">self</span>.sock.recv(<span class=\"hljs-number\">128</span>).decode()\n        <span class=\"hljs-keyword\">if</span> data == <span class=\"hljs-string\">&apos;OK&apos;</span>:\n            <span class=\"hljs-comment\"># &#x63a5;&#x6536;&#x6587;&#x4ef6;&#x5217;&#x8868;</span>\n            files = <span class=\"hljs-variable language_\">self</span>.sock.recv(<span class=\"hljs-number\">1024</span>*<span class=\"hljs-number\">1024</span>*<span class=\"hljs-number\">10</span>).decode()\n            <span class=\"hljs-built_in\">print</span>(files)\n            <span class=\"hljs-comment\"># while True:</span>\n            <span class=\"hljs-comment\">#     file = self.sock.recv(128).decode()</span>\n            <span class=\"hljs-comment\">#     if file == &apos;##&apos;:</span>\n            <span class=\"hljs-comment\">#         break</span>\n            <span class=\"hljs-comment\">#     print(file)</span>\n        <span class=\"hljs-keyword\">else</span>:\n            <span class=\"hljs-built_in\">print</span>(data)\n\n    <span class=\"hljs-comment\"># &#x4e0a;&#x4f20;&#x6587;&#x4ef6;</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">upload</span>(<span class=\"hljs-params\">self</span>):\n        filename = <span class=\"hljs-built_in\">input</span>(<span class=\"hljs-string\">&quot;&#x6587;&#x4ef6;&#xff1a;&quot;</span>)\n        <span class=\"hljs-keyword\">try</span>:\n            f = <span class=\"hljs-built_in\">open</span>(filename,<span class=\"hljs-string\">&apos;rb&apos;</span>)\n        <span class=\"hljs-keyword\">except</span> Exception:\n            <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;&#x6ca1;&#x6709;&#x8be5;&#x6587;&#x4ef6;&quot;</span>)\n            <span class=\"hljs-keyword\">return</span>\n        <span class=\"hljs-comment\"># &#x53d1;&#x9001;&#x8bf7;&#x6c42;  U filename</span>\n        filename = filename.split(<span class=\"hljs-string\">&apos;/&apos;</span>)[-<span class=\"hljs-number\">1</span>] <span class=\"hljs-comment\"># &#x63d0;&#x53d6;&#x771f;&#x6b63;&#x7684;&#x6587;&#x4ef6;&#x540d;</span>\n        <span class=\"hljs-variable language_\">self</span>.sock.send((<span class=\"hljs-string\">&quot;U &quot;</span>+filename).encode())\n        <span class=\"hljs-comment\"># &#x7b49;&#x5f85;&#x53cd;&#x9988;</span>\n        data = <span class=\"hljs-variable language_\">self</span>.sock.recv(<span class=\"hljs-number\">128</span>).decode()\n        <span class=\"hljs-keyword\">if</span> data == <span class=\"hljs-string\">&quot;OK&quot;</span>:\n            <span class=\"hljs-keyword\">while</span> <span class=\"hljs-literal\">True</span>:\n                data = f.read(<span class=\"hljs-number\">1024</span>)\n                <span class=\"hljs-keyword\">if</span> <span class=\"hljs-keyword\">not</span> data:\n                    sleep(<span class=\"hljs-number\">0.1</span>)\n                    <span class=\"hljs-variable language_\">self</span>.sock.send(<span class=\"hljs-string\">b&apos;##&apos;</span>)\n                    <span class=\"hljs-keyword\">break</span>\n                <span class=\"hljs-variable language_\">self</span>.sock.send(data)\n            f.close()\n        <span class=\"hljs-keyword\">else</span>:\n            <span class=\"hljs-built_in\">print</span>(data)\n\n    <span class=\"hljs-comment\"># &#x4e0b;&#x8f7d;&#x6587;&#x4ef6;</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">download</span>(<span class=\"hljs-params\">self</span>):\n        filename = <span class=\"hljs-built_in\">input</span>(<span class=\"hljs-string\">&quot;&#x6587;&#x4ef6;&#xff1a;&quot;</span>)\n        <span class=\"hljs-variable language_\">self</span>.sock.send((<span class=\"hljs-string\">&quot;D &quot;</span> + filename).encode())\n        <span class=\"hljs-comment\"># &#x7b49;&#x5f85;&#x53cd;&#x9988;</span>\n        data = <span class=\"hljs-variable language_\">self</span>.sock.recv(<span class=\"hljs-number\">128</span>).decode()\n        <span class=\"hljs-keyword\">if</span> data == <span class=\"hljs-string\">&quot;OK&quot;</span>:\n            f = <span class=\"hljs-built_in\">open</span>(filename, <span class=\"hljs-string\">&apos;wb&apos;</span>)\n            <span class=\"hljs-keyword\">while</span> <span class=\"hljs-literal\">True</span>:\n                data = <span class=\"hljs-variable language_\">self</span>.sock.recv(<span class=\"hljs-number\">1024</span>)\n                <span class=\"hljs-keyword\">if</span> data == <span class=\"hljs-string\">b&apos;##&apos;</span>:\n                    <span class=\"hljs-keyword\">break</span>\n                f.write(data)\n            f.close()\n        <span class=\"hljs-keyword\">else</span>:\n            <span class=\"hljs-built_in\">print</span>(data)\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">quit</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-variable language_\">self</span>.sock.send(<span class=\"hljs-string\">b&apos;Q&apos;</span>)\n        <span class=\"hljs-variable language_\">self</span>.sock.close()\n        sys.exit(<span class=\"hljs-string\">&quot;&#x8c22;&#x8c22;&#x4f7f;&#x7528;&quot;</span>)\n\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">main</span>():\n    sock = socket()\n    sock.connect(ADDR)\n\n    <span class=\"hljs-comment\"># &#x5b9e;&#x4f8b;&#x5316;&#x5bf9;&#x8c61;&#x7528;&#x6765;&#x8c03;&#x7528;&#x8bf7;&#x6c42;&#x51fd;&#x6570;</span>\n    ftp = FTPCient(sock)\n\n    <span class=\"hljs-comment\"># &#x5faa;&#x73af;&#x53d1;&#x9001;&#x8bf7;&#x6c42;</span>\n    <span class=\"hljs-keyword\">while</span> <span class=\"hljs-literal\">True</span>:\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;\\n==========COMMAND==========&quot;</span>)\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;****       select      ****&quot;</span>)\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;****       upload      ****&quot;</span>)\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;****      download     ****&quot;</span>)\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;****        quit       ****&quot;</span>)\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;===========================&quot;</span>)\n\n        cmd = <span class=\"hljs-built_in\">input</span>(<span class=\"hljs-string\">&quot;Command:&quot;</span>)\n        <span class=\"hljs-keyword\">if</span> cmd.strip() == <span class=\"hljs-string\">&quot;select&quot;</span>:\n            ftp.select()\n        <span class=\"hljs-keyword\">elif</span> cmd.strip() == <span class=\"hljs-string\">&apos;upload&apos;</span>:\n            ftp.upload()\n        <span class=\"hljs-keyword\">elif</span> cmd.strip() == <span class=\"hljs-string\">&apos;download&apos;</span>:\n            ftp.download()\n        <span class=\"hljs-keyword\">elif</span> cmd.strip() == <span class=\"hljs-string\">&apos;quit&apos;</span>:\n            ftp.quit()\n        <span class=\"hljs-keyword\">else</span>:\n            <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;&#x8bf7;&#x8f93;&#x5165;&#x6b63;&#x786e;&#x547d;&#x4ee4;&quot;</span>)\n\n<span class=\"hljs-keyword\">if</span> __name__ == <span class=\"hljs-string\">&apos;__main__&apos;</span>:\n    main()\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"147,259"}},{"content":"<pre data-lines=\"260,386\"><code class=\"language-python\"><span class=\"hljs-string\">&quot;&quot;&quot;\nftp_server.py\nftp &#x6587;&#x4ef6;&#x670d;&#x52a1;&#x5668;&#xff0c;&#x670d;&#x52a1;&#x7aef;\nenv: python3.6\n&#x591a;&#x7ebf;&#x7a0b;&#x5e76;&#x53d1;&#xff0c;socket\n&quot;&quot;&quot;</span>\n\n<span class=\"hljs-keyword\">from</span> socket <span class=\"hljs-keyword\">import</span> *\n<span class=\"hljs-keyword\">from</span> threading <span class=\"hljs-keyword\">import</span> Thread\n<span class=\"hljs-keyword\">import</span> sys\n<span class=\"hljs-keyword\">import</span> os\n<span class=\"hljs-keyword\">from</span> time <span class=\"hljs-keyword\">import</span> sleep\n\n<span class=\"hljs-comment\"># &#x5168;&#x5c40;&#x53d8;&#x91cf;</span>\nHOST = <span class=\"hljs-string\">&apos;0.0.0.0&apos;</span>\nPORT = <span class=\"hljs-number\">8888</span>\nADDR = (HOST,PORT)\nFTP = <span class=\"hljs-string\">&quot;/home/tarena/FTP/&quot;</span> <span class=\"hljs-comment\"># &#x6587;&#x4ef6;&#x5e93;&#x4f4d;&#x7f6e;</span>\n\n<span class=\"hljs-comment\"># &#x6587;&#x4ef6;&#x5904;&#x7406;&#x529f;&#x80fd;</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">FTPServer</span>(<span class=\"hljs-title class_ inherited__\">Thread</span>):\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__init__</span>(<span class=\"hljs-params\">self,connfd</span>):\n        <span class=\"hljs-built_in\">super</span>().__init__()\n        <span class=\"hljs-variable language_\">self</span>.connfd = connfd\n\n    <span class=\"hljs-comment\"># &#x53d1;&#x9001;&#x6587;&#x4ef6;&#x5217;&#x8868;</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">select</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-comment\"># &#x83b7;&#x53d6;&#x6587;&#x4ef6;&#x5217;&#x8868;</span>\n        files = os.listdir(FTP)\n        <span class=\"hljs-keyword\">if</span> <span class=\"hljs-keyword\">not</span> files:\n            <span class=\"hljs-variable language_\">self</span>.connfd.send(<span class=\"hljs-string\">&quot;&#x6587;&#x4ef6;&#x5e93;&#x4e3a;&#x7a7a;&quot;</span>.encode())\n            <span class=\"hljs-keyword\">return</span>\n        <span class=\"hljs-keyword\">else</span>:\n            <span class=\"hljs-variable language_\">self</span>.connfd.send(<span class=\"hljs-string\">b&apos;OK&apos;</span>)\n            sleep(<span class=\"hljs-number\">0.1</span>)\n        file_list = <span class=\"hljs-string\">&apos;\\n&apos;</span>.join(files)\n        <span class=\"hljs-variable language_\">self</span>.connfd.send(file_list.encode())\n        <span class=\"hljs-comment\"># for file in files:</span>\n        <span class=\"hljs-comment\">#     self.connfd.send(file.encode())</span>\n        <span class=\"hljs-comment\">#     sleep(0.1)</span>\n        <span class=\"hljs-comment\"># self.connfd.send(b&apos;##&apos;)</span>\n\n    <span class=\"hljs-comment\"># &#x5904;&#x7406;&#x4e0a;&#x4f20;</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">upload</span>(<span class=\"hljs-params\">self,filename</span>):\n        <span class=\"hljs-keyword\">if</span> os.path.exists(FTP + filename):\n            <span class=\"hljs-variable language_\">self</span>.connfd.send(<span class=\"hljs-string\">&quot;&#x6587;&#x4ef6;&#x5df2;&#x5b58;&#x5728;&quot;</span>.encode())\n            <span class=\"hljs-keyword\">return</span>\n        <span class=\"hljs-keyword\">else</span>:\n            <span class=\"hljs-variable language_\">self</span>.connfd.send(<span class=\"hljs-string\">b&apos;OK&apos;</span>)\n        <span class=\"hljs-comment\"># &#x63a5;&#x53d7;&#x6587;&#x4ef6;</span>\n        f = <span class=\"hljs-built_in\">open</span>(FTP + filename,<span class=\"hljs-string\">&apos;wb&apos;</span>)\n        <span class=\"hljs-keyword\">while</span> <span class=\"hljs-literal\">True</span>:\n            data = <span class=\"hljs-variable language_\">self</span>.connfd.recv(<span class=\"hljs-number\">1024</span>)\n            <span class=\"hljs-keyword\">if</span> data == <span class=\"hljs-string\">b&apos;##&apos;</span>:\n                <span class=\"hljs-keyword\">break</span>\n            f.write(data)\n        f.close()\n\n    <span class=\"hljs-comment\"># &#x5904;&#x7406;&#x4e0b;&#x8f7d;</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">download</span>(<span class=\"hljs-params\">self,filename</span>):\n        <span class=\"hljs-keyword\">try</span>:\n            f = <span class=\"hljs-built_in\">open</span>(FTP+filename,<span class=\"hljs-string\">&apos;rb&apos;</span>)\n        <span class=\"hljs-keyword\">except</span> Exception:\n            <span class=\"hljs-comment\"># &#x6253;&#x5f00;&#x5931;&#x8d25;&#x6587;&#x4ef6;&#x4e0d;&#x5b58;&#x5728;</span>\n            <span class=\"hljs-variable language_\">self</span>.connfd.send(<span class=\"hljs-string\">&quot;&#x6587;&#x4ef6;&#x4e0d;&#x5b58;&#x5728;&quot;</span>.encode())\n            <span class=\"hljs-keyword\">return</span>\n        <span class=\"hljs-keyword\">else</span>:\n            <span class=\"hljs-variable language_\">self</span>.connfd.send(<span class=\"hljs-string\">b&apos;OK&apos;</span>)\n            sleep(<span class=\"hljs-number\">0.1</span>)\n        <span class=\"hljs-keyword\">while</span> <span class=\"hljs-literal\">True</span>:\n            data = f.read(<span class=\"hljs-number\">1024</span>)\n            <span class=\"hljs-keyword\">if</span> <span class=\"hljs-keyword\">not</span> data:\n                sleep(<span class=\"hljs-number\">0.1</span>)\n                <span class=\"hljs-variable language_\">self</span>.connfd.send(<span class=\"hljs-string\">b&apos;##&apos;</span>)\n                <span class=\"hljs-keyword\">break</span>\n            <span class=\"hljs-variable language_\">self</span>.connfd.send(data)\n        f.close()\n\n\n    <span class=\"hljs-comment\"># &#x5904;&#x7406;&#x5ba2;&#x6237;&#x7aef;&#x8bf7;&#x6c42;</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">run</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-comment\"># &#x5faa;&#x73af;&#x63a5;&#x53d7;&#x8bf7;&#x6c42;</span>\n        <span class=\"hljs-keyword\">while</span> <span class=\"hljs-literal\">True</span>:\n            data = <span class=\"hljs-variable language_\">self</span>.connfd.recv(<span class=\"hljs-number\">1024</span>).decode()\n            <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;Request:&quot;</span>,data)\n            <span class=\"hljs-keyword\">if</span> <span class=\"hljs-keyword\">not</span> data <span class=\"hljs-keyword\">or</span> data == <span class=\"hljs-string\">&apos;Q&apos;</span>:\n                <span class=\"hljs-keyword\">return</span> <span class=\"hljs-comment\"># &#x7ebf;&#x7a0b;&#x7ed3;&#x675f;</span>\n            <span class=\"hljs-keyword\">elif</span> data == <span class=\"hljs-string\">&apos;S&apos;</span>:\n                <span class=\"hljs-variable language_\">self</span>.select()\n            <span class=\"hljs-keyword\">elif</span> data[<span class=\"hljs-number\">0</span>] == <span class=\"hljs-string\">&apos;U&apos;</span>:\n                filename = data.split(<span class=\"hljs-string\">&apos; &apos;</span>)[-<span class=\"hljs-number\">1</span>]\n                <span class=\"hljs-variable language_\">self</span>.upload(filename)\n            <span class=\"hljs-keyword\">elif</span> data[<span class=\"hljs-number\">0</span>] == <span class=\"hljs-string\">&apos;D&apos;</span>:\n                filename = data.split(<span class=\"hljs-string\">&apos; &apos;</span>)[-<span class=\"hljs-number\">1</span>]\n                <span class=\"hljs-variable language_\">self</span>.download(filename)\n\n<span class=\"hljs-comment\"># &#x7f51;&#x7edc;&#x529f;&#x80fd;</span>\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">main</span>():\n    <span class=\"hljs-comment\"># &#x521b;&#x5efa;&#x76d1;&#x542c;&#x5957;&#x63a5;&#x5b57;</span>\n    s = socket()\n    s.setsockopt(SOL_SOCKET, SO_REUSEADDR, <span class=\"hljs-number\">1</span>)\n    s.bind(ADDR)\n    s.listen(<span class=\"hljs-number\">3</span>)\n\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&apos;Listen the port 8888...&apos;</span>)\n    <span class=\"hljs-comment\"># &#x5faa;&#x73af;&#x7b49;&#x5f85;&#x5ba2;&#x6237;&#x7aef;&#x8fde;&#x63a5;</span>\n    <span class=\"hljs-keyword\">while</span> <span class=\"hljs-literal\">True</span>:\n        <span class=\"hljs-keyword\">try</span>:\n            c, addr = s.accept()\n            <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;Connect from&quot;</span>, addr)\n        <span class=\"hljs-keyword\">except</span> KeyboardInterrupt:\n            s.close()\n            sys.exit(<span class=\"hljs-string\">&quot;&#x670d;&#x52a1;&#x5668;&#x9000;&#x51fa;&quot;</span>)\n        <span class=\"hljs-keyword\">except</span> Exception <span class=\"hljs-keyword\">as</span> e:\n            <span class=\"hljs-built_in\">print</span>(e)\n            <span class=\"hljs-keyword\">continue</span>\n\n        <span class=\"hljs-comment\"># &#x5ba2;&#x6237;&#x7aef;&#x8fde;&#x63a5; &#xff0c;&#x521b;&#x5efa;&#x7ebf;&#x7a0b;</span>\n        t = FTPServer(c)\n        t.setDaemon(<span class=\"hljs-literal\">True</span>)\n        t.start()\n\n<span class=\"hljs-keyword\">if</span> __name__ == <span class=\"hljs-string\">&apos;__main__&apos;</span>:\n    main()\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"260,386"}},{"content":"<pre data-lines=\"387,404\"><code class=\"language-python\"><span class=\"hljs-comment\"># multi_process</span>\n<span class=\"hljs-keyword\">from</span> test <span class=\"hljs-keyword\">import</span> *\n<span class=\"hljs-keyword\">from</span> multiprocessing <span class=\"hljs-keyword\">import</span> Process\n<span class=\"hljs-keyword\">import</span> time\n\njobs = []\n\ntm = time.time()\n<span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(<span class=\"hljs-number\">10</span>):\n    p = Process(target=count,args=(<span class=\"hljs-number\">1</span>,<span class=\"hljs-number\">1</span>))\n    jobs.append(p)\n    p.start()\n<span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> jobs:\n    i.join()\n<span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;Process cpu:&quot;</span>,time.time() - tm)\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"387,404"}},{"content":"<pre data-lines=\"405,422\"><code class=\"language-python\"><span class=\"hljs-comment\"># multi_thread.py</span>\n<span class=\"hljs-keyword\">from</span> test <span class=\"hljs-keyword\">import</span> *\n<span class=\"hljs-keyword\">from</span> threading <span class=\"hljs-keyword\">import</span> Thread\n<span class=\"hljs-keyword\">import</span> time\n\njobs = []\n\ntm = time.time()\n<span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(<span class=\"hljs-number\">10</span>):\n    t = Thread(target=io)\n    jobs.append(t)\n    t.start()\n<span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> jobs:\n    i.join()\n<span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;Thread io:&quot;</span>,time.time() - tm)\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"405,422"}},{"content":"<pre data-lines=\"423,436\"><code class=\"language-python\"><span class=\"hljs-comment\"># single.py</span>\n<span class=\"hljs-keyword\">from</span> test <span class=\"hljs-keyword\">import</span> *\n<span class=\"hljs-keyword\">import</span> time\n\ntm = time.time()\n\n<span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(<span class=\"hljs-number\">10</span>):\n    <span class=\"hljs-comment\"># count(1,1)</span>\n    io()\n\n<span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;single cpu:&quot;</span>,time.time() - tm)\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"423,436"}},{"content":"<pre data-lines=\"437,464\"><code class=\"language-python\"><span class=\"hljs-string\">&quot;&quot;&quot;\ntcp_client.py\ntcp&#x5ba2;&#x6237;&#x7aef;&#x6d41;&#x7a0b;\n&quot;&quot;&quot;</span>\n<span class=\"hljs-keyword\">from</span> socket <span class=\"hljs-keyword\">import</span> *\n\n<span class=\"hljs-comment\"># &#x9ed8;&#x8ba4;&#x60c5;&#x51b5;&#x5c31;&#x662f;tcp&#x5957;&#x63a5;&#x5b57;</span>\nsockfd = socket()\n\n<span class=\"hljs-comment\"># &#x8fde;&#x63a5;&#x670d;&#x52a1;&#x5668;</span>\nserver_addr = (<span class=\"hljs-string\">&apos;127.0.0.1&apos;</span>,<span class=\"hljs-number\">8888</span>)\nsockfd.connect(server_addr)\n\n<span class=\"hljs-comment\"># &#x53d1;&#x6536;&#x6d88;&#x606f;</span>\n<span class=\"hljs-keyword\">while</span> <span class=\"hljs-literal\">True</span>:\n    msg = <span class=\"hljs-built_in\">input</span>(<span class=\"hljs-string\">&quot;&gt;&gt;&quot;</span>)\n    <span class=\"hljs-keyword\">if</span> <span class=\"hljs-keyword\">not</span> msg:\n        <span class=\"hljs-keyword\">break</span>\n    sockfd.send(msg.encode()) <span class=\"hljs-comment\"># &#x8981;&#x53d1;&#x9001;&#x5b57;&#x8282;&#x4e32;</span>\n    <span class=\"hljs-comment\"># if msg == &apos;##&apos;:</span>\n    <span class=\"hljs-comment\">#     break</span>\n    data = sockfd.recv(<span class=\"hljs-number\">1024</span>)\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;From server:&quot;</span>,data.decode())\n\nsockfd.close()\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"437,464"}},{"content":"<pre data-lines=\"465,496\"><code class=\"language-python\"><span class=\"hljs-string\">&quot;&quot;&quot;\ntest.py\n&#x6d4b;&#x8bd5;&#x7528;&#x4f8b;\n&#x5355;&#x8fdb;&#x7a0b;&#x6267;&#x884c;&#xff11;&#xff10;&#x6b21;count&#x8ba1;&#x7b97;&#x65f6;&#x95f4;&#xff0c;&#x6267;&#x884c;&#xff11;&#xff10;&#x6b21;io&#x8ba1;&#x7b97;&#x65f6;&#x95f4;\n&#xff11;&#xff10;&#x4e2a;&#x7ebf;&#x7a0b;&#x6bcf;&#x4e2a;&#x6267;&#x884c;&#xff11;&#x6b21;&#xff43;&#xff4f;&#xff55;&#xff4e;&#xff54;&#xff0c;&#x6bcf;&#x4e2a;&#x6267;&#x884c;&#xff11;&#x6b21;&#xff29;&#xff2f;&#xff0c;&#x5206;&#x522b;&#x8ba1;&#x7b97;&#x65f6;&#x95f4;\n&#xff11;&#xff10;&#x4e2a;&#x8fdb;&#x7a0b;&#x6bcf;&#x4e2a;&#x6267;&#x884c;&#xff11;&#x6b21;&#xff43;&#xff4f;&#xff55;&#xff4e;&#xff54;&#xff0c;&#x6bcf;&#x4e2a;&#x6267;&#x884c;&#xff11;&#x6b21;&#xff29;&#xff2f;&#xff0c;&#x5206;&#x522b;&#x8ba1;&#x7b97;&#x65f6;&#x95f4;\n&quot;&quot;&quot;</span>\n\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">count</span>(<span class=\"hljs-params\">x,y</span>):\n    c = <span class=\"hljs-number\">0</span>\n    <span class=\"hljs-keyword\">while</span> c &lt; <span class=\"hljs-number\">7000000</span>:\n        x += <span class=\"hljs-number\">1</span>\n        y += <span class=\"hljs-number\">1</span>\n        c += <span class=\"hljs-number\">1</span>\n\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">io</span>():\n    write()\n    read()\n\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">write</span>():\n    f = <span class=\"hljs-built_in\">open</span>(<span class=\"hljs-string\">&apos;text&apos;</span>,<span class=\"hljs-string\">&apos;w&apos;</span>)\n    <span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(<span class=\"hljs-number\">1800000</span>):\n        f.write(<span class=\"hljs-string\">&quot;hello world\\n&quot;</span>)\n    f.close()\n\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">read</span>():\n    f = <span class=\"hljs-built_in\">open</span>(<span class=\"hljs-string\">&apos;text&apos;</span>)\n    lines = f.readlines()\n    f.close()\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"465,496"}},{"content":"<pre data-lines=\"497,548\"><code class=\"language-python\"><span class=\"hljs-string\">&quot;&quot;&quot;\nthread_server.py  &#x57fa;&#x4e8e;Thread&#x7684;&#x591a;&#x7ebf;&#x7a0b;&#x5e76;&#x53d1;\n&#x91cd;&#x70b9;&#x4ee3;&#x7801;\n&quot;&quot;&quot;</span>\n\n<span class=\"hljs-keyword\">from</span> socket <span class=\"hljs-keyword\">import</span> *\n<span class=\"hljs-keyword\">from</span> threading <span class=\"hljs-keyword\">import</span> Thread\n<span class=\"hljs-keyword\">import</span> sys\n\n<span class=\"hljs-comment\"># &#x5168;&#x5c40;&#x53d8;&#x91cf;</span>\nHOST = <span class=\"hljs-string\">&apos;0.0.0.0&apos;</span>\nPORT = <span class=\"hljs-number\">8888</span>\nADDR = (HOST,PORT)\n\n<span class=\"hljs-comment\"># &#x5ba2;&#x6237;&#x7aef;&#x5904;&#x7406;&#x51fd;&#x6570;</span>\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">handle</span>(<span class=\"hljs-params\">connfd</span>):\n    <span class=\"hljs-keyword\">while</span> <span class=\"hljs-literal\">True</span>:\n        data = connfd.recv(<span class=\"hljs-number\">1024</span>).decode()\n        <span class=\"hljs-keyword\">if</span> <span class=\"hljs-keyword\">not</span> data:\n            <span class=\"hljs-keyword\">break</span>\n        <span class=\"hljs-built_in\">print</span>(data)\n        connfd.send(<span class=\"hljs-string\">b&apos;OK&apos;</span>)\n    connfd.close()\n\n\n<span class=\"hljs-comment\"># &#x521b;&#x5efa;&#x76d1;&#x542c;&#x5957;&#x63a5;&#x5b57;</span>\ns = socket()\ns.setsockopt(SOL_SOCKET,SO_REUSEADDR,<span class=\"hljs-number\">1</span>)\ns.bind(ADDR)\ns.listen(<span class=\"hljs-number\">3</span>)\n\n<span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&apos;Listen the port 8888...&apos;</span>)\n<span class=\"hljs-comment\"># &#x5faa;&#x73af;&#x7b49;&#x5f85;&#x5ba2;&#x6237;&#x7aef;&#x8fde;&#x63a5;</span>\n<span class=\"hljs-keyword\">while</span> <span class=\"hljs-literal\">True</span>:\n    <span class=\"hljs-keyword\">try</span>:\n        c,addr = s.accept()\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;Connect from&quot;</span>,addr)\n    <span class=\"hljs-keyword\">except</span> KeyboardInterrupt:\n        s.close()\n        sys.exit(<span class=\"hljs-string\">&quot;&#x670d;&#x52a1;&#x5668;&#x9000;&#x51fa;&quot;</span>)\n    <span class=\"hljs-keyword\">except</span> Exception <span class=\"hljs-keyword\">as</span> e:\n        <span class=\"hljs-built_in\">print</span>(e)\n        <span class=\"hljs-keyword\">continue</span>\n\n    <span class=\"hljs-comment\"># &#x5ba2;&#x6237;&#x7aef;&#x8fde;&#x63a5; &#xff0c;&#x521b;&#x5efa;&#x7ebf;&#x7a0b;</span>\n    t = Thread(target=handle,args=(c,))\n    t.setDaemon(<span class=\"hljs-literal\">True</span>)\n    t.start()\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"497,548"}}],"payload":{"tag":"h5","lines":"89,90"}}],"payload":{"tag":"h3","lines":"2,3"}}],"payload":{"tag":"h1","lines":"0,1"}},{})</script>
</body>
</html>
