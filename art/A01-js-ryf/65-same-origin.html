<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>
<link rel="stylesheet" href="https://unpkg.com/markmap-toolbar@0.18.10/dist/style.css"><link rel="stylesheet" href="https://unpkg.com/@highlightjs/cdn-assets@11.11.1/styles/default.min.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://unpkg.com/d3@7.9.0/dist/d3.min.js"></script><script src="https://unpkg.com/markmap-view@0.18.10/dist/browser/index.js"></script><script src="https://unpkg.com/markmap-toolbar@0.18.10/dist/index.js"></script><script>(r => {
              setTimeout(r);
            })(function renderToolbar() {
  const {
    markmap,
    mm
  } = window;
  const {
    el
  } = markmap.Toolbar.create(mm);
  el.setAttribute('style', 'position:absolute;bottom:20px;right:20px');
  document.body.append(el);
})</script><script>((getMarkmap, getOptions, root2, jsonOptions) => {
              const markmap = getMarkmap();
              window.mm = markmap.Markmap.create(
                "svg#mindmap",
                (getOptions || markmap.deriveOptions)(jsonOptions),
                root2
              );
            })(() => window.markmap,null,{"content":"&#x540c;&#x6e90;&#x9650;&#x5236;","children":[{"content":"<pre data-lines=\"4,5\"><code>&#x6d4f;&#x89c8;&#x5668;&#x5b89;&#x5168;&#x7684;&#x57fa;&#x77f3;&#x662f;&#x201c;&#x540c;&#x6e90;&#x653f;&#x7b56;&#x201d;&#xff08;[same-origin policy](https://en.wikipedia.org/wiki/Same-origin_policy)&#xff09;&#x3002;&#x5f88;&#x591a;&#x5f00;&#x53d1;&#x8005;&#x90fd;&#x77e5;&#x9053;&#x8fd9;&#x4e00;&#x70b9;&#xff0c;&#x4f46;&#x4e86;&#x89e3;&#x5f97;&#x4e0d;&#x5168;&#x9762;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"4,5"}},{"content":"&#x6982;&#x8ff0;","children":[{"content":"&#x542b;&#x4e49;","children":[{"content":"<pre data-lines=\"10,25\"><code>1995&#x5e74;&#xff0c;&#x540c;&#x6e90;&#x653f;&#x7b56;&#x7531; Netscape &#x516c;&#x53f8;&#x5f15;&#x5165;&#x6d4f;&#x89c8;&#x5668;&#x3002;&#x76ee;&#x524d;&#xff0c;&#x6240;&#x6709;&#x6d4f;&#x89c8;&#x5668;&#x90fd;&#x5b9e;&#x884c;&#x8fd9;&#x4e2a;&#x653f;&#x7b56;&#x3002;\n\n&#x6700;&#x521d;&#xff0c;&#x5b83;&#x7684;&#x542b;&#x4e49;&#x662f;&#x6307;&#xff0c;A &#x7f51;&#x9875;&#x8bbe;&#x7f6e;&#x7684; Cookie&#xff0c;B &#x7f51;&#x9875;&#x4e0d;&#x80fd;&#x6253;&#x5f00;&#xff0c;&#x9664;&#x975e;&#x8fd9;&#x4e24;&#x4e2a;&#x7f51;&#x9875;&#x201c;&#x540c;&#x6e90;&#x201d;&#x3002;&#x6240;&#x8c13;&#x201c;&#x540c;&#x6e90;&#x201d;&#x6307;&#x7684;&#x662f;&#x201c;&#x4e09;&#x4e2a;&#x76f8;&#x540c;&#x201d;&#x3002;\n\n&gt; - &#x534f;&#x8bae;&#x76f8;&#x540c;\n&gt; - &#x57df;&#x540d;&#x76f8;&#x540c;\n&gt; - &#x7aef;&#x53e3;&#x76f8;&#x540c;\n\n&#x4e3e;&#x4f8b;&#x6765;&#x8bf4;&#xff0c;`http://www.example.com/dir/page.html`&#x8fd9;&#x4e2a;&#x7f51;&#x5740;&#xff0c;&#x534f;&#x8bae;&#x662f;`http://`&#xff0c;&#x57df;&#x540d;&#x662f;`www.example.com`&#xff0c;&#x7aef;&#x53e3;&#x662f;`80`&#xff08;&#x9ed8;&#x8ba4;&#x7aef;&#x53e3;&#x53ef;&#x4ee5;&#x7701;&#x7565;&#xff09;&#xff0c;&#x5b83;&#x7684;&#x540c;&#x6e90;&#x60c5;&#x51b5;&#x5982;&#x4e0b;&#x3002;\n\n- `http://www.example.com/dir2/other.html`&#xff1a;&#x540c;&#x6e90;\n- `http://example.com/dir/other.html`&#xff1a;&#x4e0d;&#x540c;&#x6e90;&#xff08;&#x57df;&#x540d;&#x4e0d;&#x540c;&#xff09;\n- `http://v2.www.example.com/dir/other.html`&#xff1a;&#x4e0d;&#x540c;&#x6e90;&#xff08;&#x57df;&#x540d;&#x4e0d;&#x540c;&#xff09;\n- `http://www.example.com:81/dir/other.html`&#xff1a;&#x4e0d;&#x540c;&#x6e90;&#xff08;&#x7aef;&#x53e3;&#x4e0d;&#x540c;&#xff09;\n- `https://www.example.com/dir/page.html`&#xff1a;&#x4e0d;&#x540c;&#x6e90;&#xff08;&#x534f;&#x8bae;&#x4e0d;&#x540c;&#xff09;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"10,25"}}],"payload":{"tag":"h3","lines":"8,9"}},{"content":"&#x76ee;&#x7684;","children":[{"content":"<pre data-lines=\"28,33\"><code>&#x540c;&#x6e90;&#x653f;&#x7b56;&#x7684;&#x76ee;&#x7684;&#xff0c;&#x662f;&#x4e3a;&#x4e86;&#x4fdd;&#x8bc1;&#x7528;&#x6237;&#x4fe1;&#x606f;&#x7684;&#x5b89;&#x5168;&#xff0c;&#x9632;&#x6b62;&#x6076;&#x610f;&#x7684;&#x7f51;&#x7ad9;&#x7a83;&#x53d6;&#x6570;&#x636e;&#x3002;\n\n&#x8bbe;&#x60f3;&#x8fd9;&#x6837;&#x4e00;&#x79cd;&#x60c5;&#x51b5;&#xff1a;A &#x7f51;&#x7ad9;&#x662f;&#x4e00;&#x5bb6;&#x94f6;&#x884c;&#xff0c;&#x7528;&#x6237;&#x767b;&#x5f55;&#x4ee5;&#x540e;&#xff0c;A &#x7f51;&#x7ad9;&#x5728;&#x7528;&#x6237;&#x7684;&#x673a;&#x5668;&#x4e0a;&#x8bbe;&#x7f6e;&#x4e86;&#x4e00;&#x4e2a; Cookie&#xff0c;&#x5305;&#x542b;&#x4e86;&#x4e00;&#x4e9b;&#x9690;&#x79c1;&#x4fe1;&#x606f;&#xff08;&#x6bd4;&#x5982;&#x5b58;&#x6b3e;&#x603b;&#x989d;&#xff09;&#x3002;&#x7528;&#x6237;&#x79bb;&#x5f00; A &#x7f51;&#x7ad9;&#x4ee5;&#x540e;&#xff0c;&#x53c8;&#x53bb;&#x8bbf;&#x95ee; B &#x7f51;&#x7ad9;&#xff0c;&#x5982;&#x679c;&#x6ca1;&#x6709;&#x540c;&#x6e90;&#x9650;&#x5236;&#xff0c;B &#x7f51;&#x7ad9;&#x53ef;&#x4ee5;&#x8bfb;&#x53d6; A &#x7f51;&#x7ad9;&#x7684; Cookie&#xff0c;&#x90a3;&#x4e48;&#x9690;&#x79c1;&#x4fe1;&#x606f;&#x5c31;&#x4f1a;&#x6cc4;&#x6f0f;&#x3002;&#x66f4;&#x53ef;&#x6015;&#x7684;&#x662f;&#xff0c;Cookie &#x5f80;&#x5f80;&#x7528;&#x6765;&#x4fdd;&#x5b58;&#x7528;&#x6237;&#x7684;&#x767b;&#x5f55;&#x72b6;&#x6001;&#xff0c;&#x5982;&#x679c;&#x7528;&#x6237;&#x6ca1;&#x6709;&#x9000;&#x51fa;&#x767b;&#x5f55;&#xff0c;&#x5176;&#x4ed6;&#x7f51;&#x7ad9;&#x5c31;&#x53ef;&#x4ee5;&#x5192;&#x5145;&#x7528;&#x6237;&#xff0c;&#x4e3a;&#x6240;&#x6b32;&#x4e3a;&#x3002;&#x56e0;&#x4e3a;&#x6d4f;&#x89c8;&#x5668;&#x540c;&#x65f6;&#x8fd8;&#x89c4;&#x5b9a;&#xff0c;&#x63d0;&#x4ea4;&#x8868;&#x5355;&#x4e0d;&#x53d7;&#x540c;&#x6e90;&#x653f;&#x7b56;&#x7684;&#x9650;&#x5236;&#x3002;\n\n&#x7531;&#x6b64;&#x53ef;&#x89c1;&#xff0c;&#x540c;&#x6e90;&#x653f;&#x7b56;&#x662f;&#x5fc5;&#x9700;&#x7684;&#xff0c;&#x5426;&#x5219; Cookie &#x53ef;&#x4ee5;&#x5171;&#x4eab;&#xff0c;&#x4e92;&#x8054;&#x7f51;&#x5c31;&#x6beb;&#x65e0;&#x5b89;&#x5168;&#x53ef;&#x8a00;&#x4e86;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"28,33"}}],"payload":{"tag":"h3","lines":"26,27"}},{"content":"&#x9650;&#x5236;&#x8303;&#x56f4;","children":[{"content":"<pre data-lines=\"36,63\"><code>&#x968f;&#x7740;&#x4e92;&#x8054;&#x7f51;&#x7684;&#x53d1;&#x5c55;&#xff0c;&#x540c;&#x6e90;&#x653f;&#x7b56;&#x8d8a;&#x6765;&#x8d8a;&#x4e25;&#x683c;&#x3002;&#x76ee;&#x524d;&#xff0c;&#x5982;&#x679c;&#x975e;&#x540c;&#x6e90;&#xff0c;&#x5171;&#x6709;&#x4e09;&#x79cd;&#x884c;&#x4e3a;&#x53d7;&#x5230;&#x9650;&#x5236;&#x3002;\n\n&gt; &#xff08;1&#xff09; &#x65e0;&#x6cd5;&#x8bfb;&#x53d6;&#x975e;&#x540c;&#x6e90;&#x7f51;&#x9875;&#x7684; Cookie&#x3001;LocalStorage &#x548c; IndexedDB&#x3002;\n&gt;\n&gt; &#xff08;2&#xff09; &#x65e0;&#x6cd5;&#x63a5;&#x89e6;&#x975e;&#x540c;&#x6e90;&#x7f51;&#x9875;&#x7684; DOM&#x3002;\n&gt;\n&gt; &#xff08;3&#xff09; &#x65e0;&#x6cd5;&#x5411;&#x975e;&#x540c;&#x6e90;&#x5730;&#x5740;&#x53d1;&#x9001; AJAX &#x8bf7;&#x6c42;&#xff08;&#x53ef;&#x4ee5;&#x53d1;&#x9001;&#xff0c;&#x4f46;&#x6d4f;&#x89c8;&#x5668;&#x4f1a;&#x62d2;&#x7edd;&#x63a5;&#x53d7;&#x54cd;&#x5e94;&#xff09;&#x3002;\n\n&#x53e6;&#x5916;&#xff0c;&#x901a;&#x8fc7; JavaScript &#x811a;&#x672c;&#x53ef;&#x4ee5;&#x62ff;&#x5230;&#x5176;&#x4ed6;&#x7a97;&#x53e3;&#x7684;`window`&#x5bf9;&#x8c61;&#x3002;&#x5982;&#x679c;&#x662f;&#x975e;&#x540c;&#x6e90;&#x7684;&#x7f51;&#x9875;&#xff0c;&#x76ee;&#x524d;&#x5141;&#x8bb8;&#x4e00;&#x4e2a;&#x7a97;&#x53e3;&#x53ef;&#x4ee5;&#x63a5;&#x89e6;&#x5176;&#x4ed6;&#x7f51;&#x9875;&#x7684;`window`&#x5bf9;&#x8c61;&#x7684;&#x4e5d;&#x4e2a;&#x5c5e;&#x6027;&#x548c;&#x56db;&#x4e2a;&#x65b9;&#x6cd5;&#x3002;\n\n- window.closed\n- window.frames\n- window.length\n- window.location\n- window.opener\n- window.parent\n- window.self\n- window.top\n- window.window\n- window.blur()\n- window.close()\n- window.focus()\n- window.postMessage()\n\n&#x4e0a;&#x9762;&#x7684;&#x4e5d;&#x4e2a;&#x5c5e;&#x6027;&#x4e4b;&#x4e2d;&#xff0c;&#x53ea;&#x6709;`window.location`&#x662f;&#x53ef;&#x8bfb;&#x5199;&#x7684;&#xff0c;&#x5176;&#x4ed6;&#x516b;&#x4e2a;&#x5168;&#x90e8;&#x90fd;&#x662f;&#x53ea;&#x8bfb;&#x3002;&#x800c;&#x4e14;&#xff0c;&#x5373;&#x4f7f;&#x662f;`location`&#x5bf9;&#x8c61;&#xff0c;&#x975e;&#x540c;&#x6e90;&#x7684;&#x60c5;&#x51b5;&#x4e0b;&#xff0c;&#x4e5f;&#x53ea;&#x5141;&#x8bb8;&#x8c03;&#x7528;`location.replace`&#x65b9;&#x6cd5;&#x548c;&#x5199;&#x5165;`location.href`&#x5c5e;&#x6027;&#x3002;\n\n&#x867d;&#x7136;&#x8fd9;&#x4e9b;&#x9650;&#x5236;&#x662f;&#x5fc5;&#x8981;&#x7684;&#xff0c;&#x4f46;&#x662f;&#x6709;&#x65f6;&#x5f88;&#x4e0d;&#x65b9;&#x4fbf;&#xff0c;&#x5408;&#x7406;&#x7684;&#x7528;&#x9014;&#x4e5f;&#x53d7;&#x5230;&#x5f71;&#x54cd;&#x3002;&#x4e0b;&#x9762;&#x4ecb;&#x7ecd;&#x5982;&#x4f55;&#x89c4;&#x907f;&#x4e0a;&#x9762;&#x7684;&#x9650;&#x5236;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"36,63"}}],"payload":{"tag":"h3","lines":"34,35"}}],"payload":{"tag":"h2","lines":"6,7"}},{"content":"Cookie","children":[{"content":"<pre data-lines=\"66,69\"><code>Cookie &#x662f;&#x670d;&#x52a1;&#x5668;&#x5199;&#x5165;&#x6d4f;&#x89c8;&#x5668;&#x7684;&#x4e00;&#x5c0f;&#x6bb5;&#x4fe1;&#x606f;&#xff0c;&#x53ea;&#x6709;&#x540c;&#x6e90;&#x7684;&#x7f51;&#x9875;&#x624d;&#x80fd;&#x5171;&#x4eab;&#x3002;&#x5982;&#x679c;&#x4e24;&#x4e2a;&#x7f51;&#x9875;&#x4e00;&#x7ea7;&#x57df;&#x540d;&#x76f8;&#x540c;&#xff0c;&#x53ea;&#x662f;&#x6b21;&#x7ea7;&#x57df;&#x540d;&#x4e0d;&#x540c;&#xff0c;&#x6d4f;&#x89c8;&#x5668;&#x5141;&#x8bb8;&#x901a;&#x8fc7;&#x8bbe;&#x7f6e;`document.domain`&#x5171;&#x4eab; Cookie&#x3002;\n\n&#x4e3e;&#x4f8b;&#x6765;&#x8bf4;&#xff0c;A &#x7f51;&#x9875;&#x7684;&#x7f51;&#x5740;&#x662f;`http://w1.example.com/a.html`&#xff0c;B &#x7f51;&#x9875;&#x7684;&#x7f51;&#x5740;&#x662f;`http://w2.example.com/b.html`&#xff0c;&#x90a3;&#x4e48;&#x53ea;&#x8981;&#x8bbe;&#x7f6e;&#x76f8;&#x540c;&#x7684;`document.domain`&#xff0c;&#x4e24;&#x4e2a;&#x7f51;&#x9875;&#x5c31;&#x53ef;&#x4ee5;&#x5171;&#x4eab; Cookie&#x3002;&#x56e0;&#x4e3a;&#x6d4f;&#x89c8;&#x5668;&#x901a;&#x8fc7;`document.domain`&#x5c5e;&#x6027;&#x6765;&#x68c0;&#x67e5;&#x662f;&#x5426;&#x540c;&#x6e90;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"66,69"}},{"content":"<pre data-lines=\"70,74\"><code class=\"language-javascript\"><span class=\"hljs-comment\">// &#x4e24;&#x4e2a;&#x7f51;&#x9875;&#x90fd;&#x9700;&#x8981;&#x8bbe;&#x7f6e;</span>\n<span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-property\">domain</span> = <span class=\"hljs-string\">&apos;example.com&apos;</span>;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"70,74"}},{"content":"<pre data-lines=\"75,78\"><code>&#x6ce8;&#x610f;&#xff0c;A &#x548c; B &#x4e24;&#x4e2a;&#x7f51;&#x9875;&#x90fd;&#x9700;&#x8981;&#x8bbe;&#x7f6e;`document.domain`&#x5c5e;&#x6027;&#xff0c;&#x624d;&#x80fd;&#x8fbe;&#x5230;&#x540c;&#x6e90;&#x7684;&#x76ee;&#x7684;&#x3002;&#x56e0;&#x4e3a;&#x8bbe;&#x7f6e;`document.domain`&#x7684;&#x540c;&#x65f6;&#xff0c;&#x4f1a;&#x628a;&#x7aef;&#x53e3;&#x91cd;&#x7f6e;&#x4e3a;`null`&#xff0c;&#x56e0;&#x6b64;&#x5982;&#x679c;&#x53ea;&#x8bbe;&#x7f6e;&#x4e00;&#x4e2a;&#x7f51;&#x9875;&#x7684;`document.domain`&#xff0c;&#x4f1a;&#x5bfc;&#x81f4;&#x4e24;&#x4e2a;&#x7f51;&#x5740;&#x7684;&#x7aef;&#x53e3;&#x4e0d;&#x540c;&#xff0c;&#x8fd8;&#x662f;&#x8fbe;&#x4e0d;&#x5230;&#x540c;&#x6e90;&#x7684;&#x76ee;&#x7684;&#x3002;\n\n&#x73b0;&#x5728;&#xff0c;A &#x7f51;&#x9875;&#x901a;&#x8fc7;&#x811a;&#x672c;&#x8bbe;&#x7f6e;&#x4e00;&#x4e2a; Cookie&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"75,78"}},{"content":"<pre data-lines=\"79,82\"><code class=\"language-javascript\"><span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-property\">cookie</span> = <span class=\"hljs-string\">&quot;test1=hello&quot;</span>;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"79,82"}},{"content":"<pre data-lines=\"83,84\"><code>B &#x7f51;&#x9875;&#x5c31;&#x53ef;&#x4ee5;&#x8bfb;&#x5230;&#x8fd9;&#x4e2a; Cookie&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"83,84"}},{"content":"<pre data-lines=\"85,88\"><code class=\"language-javascript\"><span class=\"hljs-keyword\">var</span> allCookie = <span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-property\">cookie</span>;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"85,88"}},{"content":"<pre data-lines=\"89,92\"><code>&#x6ce8;&#x610f;&#xff0c;&#x8fd9;&#x79cd;&#x65b9;&#x6cd5;&#x53ea;&#x9002;&#x7528;&#x4e8e; Cookie &#x548c; iframe &#x7a97;&#x53e3;&#xff0c;LocalStorage &#x548c; IndexedDB &#x65e0;&#x6cd5;&#x901a;&#x8fc7;&#x8fd9;&#x79cd;&#x65b9;&#x6cd5;&#xff0c;&#x89c4;&#x907f;&#x540c;&#x6e90;&#x653f;&#x7b56;&#xff0c;&#x800c;&#x8981;&#x4f7f;&#x7528;&#x4e0b;&#x6587;&#x4ecb;&#x7ecd; PostMessage API&#x3002;\n\n&#x53e6;&#x5916;&#xff0c;&#x670d;&#x52a1;&#x5668;&#x4e5f;&#x53ef;&#x4ee5;&#x5728;&#x8bbe;&#x7f6e; Cookie &#x7684;&#x65f6;&#x5019;&#xff0c;&#x6307;&#x5b9a; Cookie &#x7684;&#x6240;&#x5c5e;&#x57df;&#x540d;&#x4e3a;&#x4e00;&#x7ea7;&#x57df;&#x540d;&#xff0c;&#x6bd4;&#x5982;`.example.com`&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"89,92"}},{"content":"<pre data-lines=\"93,96\"><code class=\"language-http\"><span class=\"hljs-attribute\">Set-Cookie</span><span class=\"hljs-punctuation\">: </span>key=value; domain=.example.com; path=/\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"93,96"}},{"content":"<pre data-lines=\"97,98\"><code>&#x8fd9;&#x6837;&#x7684;&#x8bdd;&#xff0c;&#x4e8c;&#x7ea7;&#x57df;&#x540d;&#x548c;&#x4e09;&#x7ea7;&#x57df;&#x540d;&#x4e0d;&#x7528;&#x505a;&#x4efb;&#x4f55;&#x8bbe;&#x7f6e;&#xff0c;&#x90fd;&#x53ef;&#x4ee5;&#x8bfb;&#x53d6;&#x8fd9;&#x4e2a; Cookie&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"97,98"}}],"payload":{"tag":"h2","lines":"64,65"}},{"content":"iframe &#x548c;&#x591a;&#x7a97;&#x53e3;&#x901a;&#x4fe1;","children":[{"content":"&#x7247;&#x6bb5;&#x8bc6;&#x522b;&#x7b26;","children":[{"content":"<pre data-lines=\"133,136\"><code>&#x7247;&#x6bb5;&#x6807;&#x8bc6;&#x7b26;&#xff08;fragment identifier&#xff09;&#x6307;&#x7684;&#x662f;&#xff0c;URL &#x7684;`#`&#x53f7;&#x540e;&#x9762;&#x7684;&#x90e8;&#x5206;&#xff0c;&#x6bd4;&#x5982;`http://example.com/x.html#fragment`&#x7684;`#fragment`&#x3002;&#x5982;&#x679c;&#x53ea;&#x662f;&#x6539;&#x53d8;&#x7247;&#x6bb5;&#x6807;&#x8bc6;&#x7b26;&#xff0c;&#x9875;&#x9762;&#x4e0d;&#x4f1a;&#x91cd;&#x65b0;&#x5237;&#x65b0;&#x3002;\n\n&#x7236;&#x7a97;&#x53e3;&#x53ef;&#x4ee5;&#x628a;&#x4fe1;&#x606f;&#xff0c;&#x5199;&#x5165;&#x5b50;&#x7a97;&#x53e3;&#x7684;&#x7247;&#x6bb5;&#x6807;&#x8bc6;&#x7b26;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"133,136"}},{"content":"<pre data-lines=\"137,141\"><code class=\"language-javascript\"><span class=\"hljs-keyword\">var</span> src = originURL + <span class=\"hljs-string\">&apos;#&apos;</span> + data;\n<span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-title function_\">getElementById</span>(<span class=\"hljs-string\">&apos;myIFrame&apos;</span>).<span class=\"hljs-property\">src</span> = src;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"137,141"}},{"content":"<pre data-lines=\"142,145\"><code>&#x4e0a;&#x9762;&#x4ee3;&#x7801;&#x4e2d;&#xff0c;&#x7236;&#x7a97;&#x53e3;&#x628a;&#x6240;&#x8981;&#x4f20;&#x9012;&#x7684;&#x4fe1;&#x606f;&#xff0c;&#x5199;&#x5165; iframe &#x7a97;&#x53e3;&#x7684;&#x7247;&#x6bb5;&#x6807;&#x8bc6;&#x7b26;&#x3002;\n\n&#x5b50;&#x7a97;&#x53e3;&#x901a;&#x8fc7;&#x76d1;&#x542c;`hashchange`&#x4e8b;&#x4ef6;&#x5f97;&#x5230;&#x901a;&#x77e5;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"142,145"}},{"content":"<pre data-lines=\"146,154\"><code class=\"language-javascript\"><span class=\"hljs-variable language_\">window</span>.<span class=\"hljs-property\">onhashchange</span> = checkMessage;\n\n<span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">checkMessage</span>(<span class=\"hljs-params\"></span>) {\n  <span class=\"hljs-keyword\">var</span> message = <span class=\"hljs-variable language_\">window</span>.<span class=\"hljs-property\">location</span>.<span class=\"hljs-property\">hash</span>;\n  <span class=\"hljs-comment\">// ...</span>\n}\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"146,154"}},{"content":"<pre data-lines=\"155,156\"><code>&#x540c;&#x6837;&#x7684;&#xff0c;&#x5b50;&#x7a97;&#x53e3;&#x4e5f;&#x53ef;&#x4ee5;&#x6539;&#x53d8;&#x7236;&#x7a97;&#x53e3;&#x7684;&#x7247;&#x6bb5;&#x6807;&#x8bc6;&#x7b26;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"155,156"}},{"content":"<pre data-lines=\"157,160\"><code class=\"language-javascript\">parent.<span class=\"hljs-property\">location</span>.<span class=\"hljs-property\">href</span> = target + <span class=\"hljs-string\">&apos;#&apos;</span> + hash;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"157,160"}}],"payload":{"tag":"h3","lines":"131,132"}},{"content":"window.postMessage()","children":[{"content":"<pre data-lines=\"163,166\"><code>&#x4e0a;&#x9762;&#x7684;&#x8fd9;&#x79cd;&#x65b9;&#x6cd5;&#x5c5e;&#x4e8e;&#x7834;&#x89e3;&#xff0c;HTML5 &#x4e3a;&#x4e86;&#x89e3;&#x51b3;&#x8fd9;&#x4e2a;&#x95ee;&#x9898;&#xff0c;&#x5f15;&#x5165;&#x4e86;&#x4e00;&#x4e2a;&#x5168;&#x65b0;&#x7684;API&#xff1a;&#x8de8;&#x6587;&#x6863;&#x901a;&#x4fe1; API&#xff08;Cross-document messaging&#xff09;&#x3002;\n\n&#x8fd9;&#x4e2a; API &#x4e3a;`window`&#x5bf9;&#x8c61;&#x65b0;&#x589e;&#x4e86;&#x4e00;&#x4e2a;`window.postMessage`&#x65b9;&#x6cd5;&#xff0c;&#x5141;&#x8bb8;&#x8de8;&#x7a97;&#x53e3;&#x901a;&#x4fe1;&#xff0c;&#x4e0d;&#x8bba;&#x8fd9;&#x4e24;&#x4e2a;&#x7a97;&#x53e3;&#x662f;&#x5426;&#x540c;&#x6e90;&#x3002;&#x4e3e;&#x4f8b;&#x6765;&#x8bf4;&#xff0c;&#x7236;&#x7a97;&#x53e3;`aaa.com`&#x5411;&#x5b50;&#x7a97;&#x53e3;`bbb.com`&#x53d1;&#x6d88;&#x606f;&#xff0c;&#x8c03;&#x7528;`postMessage`&#x65b9;&#x6cd5;&#x5c31;&#x53ef;&#x4ee5;&#x4e86;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"163,166"}},{"content":"<pre data-lines=\"167,173\"><code class=\"language-javascript\"><span class=\"hljs-comment\">// &#x7236;&#x7a97;&#x53e3;&#x6253;&#x5f00;&#x4e00;&#x4e2a;&#x5b50;&#x7a97;&#x53e3;</span>\n<span class=\"hljs-keyword\">var</span> popup = <span class=\"hljs-variable language_\">window</span>.<span class=\"hljs-title function_\">open</span>(<span class=\"hljs-string\">&apos;http://bbb.com&apos;</span>, <span class=\"hljs-string\">&apos;title&apos;</span>);\n<span class=\"hljs-comment\">// &#x7236;&#x7a97;&#x53e3;&#x5411;&#x5b50;&#x7a97;&#x53e3;&#x53d1;&#x6d88;&#x606f;</span>\npopup.<span class=\"hljs-title function_\">postMessage</span>(<span class=\"hljs-string\">&apos;Hello World!&apos;</span>, <span class=\"hljs-string\">&apos;http://bbb.com&apos;</span>);\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"167,173"}},{"content":"<pre data-lines=\"174,177\"><code>`postMessage`&#x65b9;&#x6cd5;&#x7684;&#x7b2c;&#x4e00;&#x4e2a;&#x53c2;&#x6570;&#x662f;&#x5177;&#x4f53;&#x7684;&#x4fe1;&#x606f;&#x5185;&#x5bb9;&#xff0c;&#x7b2c;&#x4e8c;&#x4e2a;&#x53c2;&#x6570;&#x662f;&#x63a5;&#x6536;&#x6d88;&#x606f;&#x7684;&#x7a97;&#x53e3;&#x7684;&#x6e90;&#xff08;origin&#xff09;&#xff0c;&#x5373;&#x201c;&#x534f;&#x8bae; + &#x57df;&#x540d; + &#x7aef;&#x53e3;&#x201d;&#x3002;&#x4e5f;&#x53ef;&#x4ee5;&#x8bbe;&#x4e3a;`*`&#xff0c;&#x8868;&#x793a;&#x4e0d;&#x9650;&#x5236;&#x57df;&#x540d;&#xff0c;&#x5411;&#x6240;&#x6709;&#x7a97;&#x53e3;&#x53d1;&#x9001;&#x3002;\n\n&#x5b50;&#x7a97;&#x53e3;&#x5411;&#x7236;&#x7a97;&#x53e3;&#x53d1;&#x9001;&#x6d88;&#x606f;&#x7684;&#x5199;&#x6cd5;&#x7c7b;&#x4f3c;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"174,177"}},{"content":"<pre data-lines=\"178,182\"><code class=\"language-javascript\"><span class=\"hljs-comment\">// &#x5b50;&#x7a97;&#x53e3;&#x5411;&#x7236;&#x7a97;&#x53e3;&#x53d1;&#x6d88;&#x606f;</span>\n<span class=\"hljs-variable language_\">window</span>.<span class=\"hljs-property\">opener</span>.<span class=\"hljs-title function_\">postMessage</span>(<span class=\"hljs-string\">&apos;Nice to see you&apos;</span>, <span class=\"hljs-string\">&apos;http://aaa.com&apos;</span>);\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"178,182"}},{"content":"<pre data-lines=\"183,184\"><code>&#x7236;&#x7a97;&#x53e3;&#x548c;&#x5b50;&#x7a97;&#x53e3;&#x90fd;&#x53ef;&#x4ee5;&#x901a;&#x8fc7;`message`&#x4e8b;&#x4ef6;&#xff0c;&#x76d1;&#x542c;&#x5bf9;&#x65b9;&#x7684;&#x6d88;&#x606f;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"183,184"}},{"content":"<pre data-lines=\"185,192\"><code class=\"language-javascript\"><span class=\"hljs-comment\">// &#x7236;&#x7a97;&#x53e3;&#x548c;&#x5b50;&#x7a97;&#x53e3;&#x90fd;&#x53ef;&#x4ee5;&#x7528;&#x4e0b;&#x9762;&#x7684;&#x4ee3;&#x7801;&#xff0c;</span>\n<span class=\"hljs-comment\">// &#x76d1;&#x542c; message &#x6d88;&#x606f;</span>\n<span class=\"hljs-variable language_\">window</span>.<span class=\"hljs-title function_\">addEventListener</span>(<span class=\"hljs-string\">&apos;message&apos;</span>, <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\">e</span>) {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(e.<span class=\"hljs-property\">data</span>);\n},<span class=\"hljs-literal\">false</span>);\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"185,192"}},{"content":"<pre data-lines=\"193,200\"><code>`message`&#x4e8b;&#x4ef6;&#x7684;&#x53c2;&#x6570;&#x662f;&#x4e8b;&#x4ef6;&#x5bf9;&#x8c61;`event`&#xff0c;&#x63d0;&#x4f9b;&#x4ee5;&#x4e0b;&#x4e09;&#x4e2a;&#x5c5e;&#x6027;&#x3002;\n\n&gt; - `event.source`&#xff1a;&#x53d1;&#x9001;&#x6d88;&#x606f;&#x7684;&#x7a97;&#x53e3;\n&gt; - `event.origin`: &#x6d88;&#x606f;&#x53d1;&#x5411;&#x7684;&#x7f51;&#x5740;\n&gt; - `event.data`: &#x6d88;&#x606f;&#x5185;&#x5bb9;\n\n&#x4e0b;&#x9762;&#x7684;&#x4f8b;&#x5b50;&#x662f;&#xff0c;&#x5b50;&#x7a97;&#x53e3;&#x901a;&#x8fc7;`event.source`&#x5c5e;&#x6027;&#x5f15;&#x7528;&#x7236;&#x7a97;&#x53e3;&#xff0c;&#x7136;&#x540e;&#x53d1;&#x9001;&#x6d88;&#x606f;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"193,200"}},{"content":"<pre data-lines=\"201,207\"><code class=\"language-javascript\"><span class=\"hljs-variable language_\">window</span>.<span class=\"hljs-title function_\">addEventListener</span>(<span class=\"hljs-string\">&apos;message&apos;</span>, receiveMessage);\n<span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">receiveMessage</span>(<span class=\"hljs-params\">event</span>) {\n  event.<span class=\"hljs-property\">source</span>.<span class=\"hljs-title function_\">postMessage</span>(<span class=\"hljs-string\">&apos;Nice to see you!&apos;</span>, <span class=\"hljs-string\">&apos;*&apos;</span>);\n}\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"201,207"}},{"content":"<pre data-lines=\"208,211\"><code>&#x4e0a;&#x9762;&#x4ee3;&#x7801;&#x6709;&#x51e0;&#x4e2a;&#x5730;&#x65b9;&#x9700;&#x8981;&#x6ce8;&#x610f;&#x3002;&#x9996;&#x5148;&#xff0c;`receiveMessage`&#x51fd;&#x6570;&#x91cc;&#x9762;&#x6ca1;&#x6709;&#x8fc7;&#x6ee4;&#x4fe1;&#x606f;&#x7684;&#x6765;&#x6e90;&#xff0c;&#x4efb;&#x610f;&#x7f51;&#x5740;&#x53d1;&#x6765;&#x7684;&#x4fe1;&#x606f;&#x90fd;&#x4f1a;&#x88ab;&#x5904;&#x7406;&#x3002;&#x5176;&#x6b21;&#xff0c;`postMessage`&#x65b9;&#x6cd5;&#x4e2d;&#x6307;&#x5b9a;&#x7684;&#x76ee;&#x6807;&#x7a97;&#x53e3;&#x7684;&#x7f51;&#x5740;&#x662f;&#x4e00;&#x4e2a;&#x661f;&#x53f7;&#xff0c;&#x8868;&#x793a;&#x8be5;&#x4fe1;&#x606f;&#x53ef;&#x4ee5;&#x5411;&#x4efb;&#x610f;&#x7f51;&#x5740;&#x53d1;&#x9001;&#x3002;&#x901a;&#x5e38;&#x6765;&#x8bf4;&#xff0c;&#x8fd9;&#x4e24;&#x79cd;&#x505a;&#x6cd5;&#x662f;&#x4e0d;&#x63a8;&#x8350;&#x7684;&#xff0c;&#x56e0;&#x4e3a;&#x4e0d;&#x591f;&#x5b89;&#x5168;&#xff0c;&#x53ef;&#x80fd;&#x4f1a;&#x88ab;&#x6076;&#x610f;&#x5229;&#x7528;&#x3002;\n\n`event.origin`&#x5c5e;&#x6027;&#x53ef;&#x4ee5;&#x8fc7;&#x6ee4;&#x4e0d;&#x662f;&#x53d1;&#x7ed9;&#x672c;&#x7a97;&#x53e3;&#x7684;&#x6d88;&#x606f;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"208,211"}},{"content":"<pre data-lines=\"212,223\"><code class=\"language-javascript\"><span class=\"hljs-variable language_\">window</span>.<span class=\"hljs-title function_\">addEventListener</span>(<span class=\"hljs-string\">&apos;message&apos;</span>, receiveMessage);\n<span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">receiveMessage</span>(<span class=\"hljs-params\">event</span>) {\n  <span class=\"hljs-keyword\">if</span> (event.<span class=\"hljs-property\">origin</span> !== <span class=\"hljs-string\">&apos;http://aaa.com&apos;</span>) <span class=\"hljs-keyword\">return</span>;\n  <span class=\"hljs-keyword\">if</span> (event.<span class=\"hljs-property\">data</span> === <span class=\"hljs-string\">&apos;Hello World&apos;</span>) {\n    event.<span class=\"hljs-property\">source</span>.<span class=\"hljs-title function_\">postMessage</span>(<span class=\"hljs-string\">&apos;Hello&apos;</span>, event.<span class=\"hljs-property\">origin</span>);\n  } <span class=\"hljs-keyword\">else</span> {\n    <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(event.<span class=\"hljs-property\">data</span>);\n  }\n}\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"212,223"}}],"payload":{"tag":"h3","lines":"161,162"}},{"content":"LocalStorage","children":[{"content":"<pre data-lines=\"226,229\"><code>&#x901a;&#x8fc7;`window.postMessage`&#xff0c;&#x8bfb;&#x5199;&#x5176;&#x4ed6;&#x7a97;&#x53e3;&#x7684; LocalStorage &#x4e5f;&#x6210;&#x4e3a;&#x4e86;&#x53ef;&#x80fd;&#x3002;\n\n&#x4e0b;&#x9762;&#x662f;&#x4e00;&#x4e2a;&#x4f8b;&#x5b50;&#xff0c;&#x4e3b;&#x7a97;&#x53e3;&#x5199;&#x5165; iframe &#x5b50;&#x7a97;&#x53e3;&#x7684;`localStorage`&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"226,229"}},{"content":"<pre data-lines=\"230,239\"><code class=\"language-javascript\"><span class=\"hljs-variable language_\">window</span>.<span class=\"hljs-property\">onmessage</span> = <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">e</span>) {\n  <span class=\"hljs-keyword\">if</span> (e.<span class=\"hljs-property\">origin</span> !== <span class=\"hljs-string\">&apos;http://bbb.com&apos;</span>) {\n    <span class=\"hljs-keyword\">return</span>;\n  }\n  <span class=\"hljs-keyword\">var</span> payload = <span class=\"hljs-title class_\">JSON</span>.<span class=\"hljs-title function_\">parse</span>(e.<span class=\"hljs-property\">data</span>);\n  <span class=\"hljs-variable language_\">localStorage</span>.<span class=\"hljs-title function_\">setItem</span>(payload.<span class=\"hljs-property\">key</span>, <span class=\"hljs-title class_\">JSON</span>.<span class=\"hljs-title function_\">stringify</span>(payload.<span class=\"hljs-property\">data</span>));\n};\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"230,239"}},{"content":"<pre data-lines=\"240,243\"><code>&#x4e0a;&#x9762;&#x4ee3;&#x7801;&#x4e2d;&#xff0c;&#x5b50;&#x7a97;&#x53e3;&#x5c06;&#x7236;&#x7a97;&#x53e3;&#x53d1;&#x6765;&#x7684;&#x6d88;&#x606f;&#xff0c;&#x5199;&#x5165;&#x81ea;&#x5df1;&#x7684; LocalStorage&#x3002;\n\n&#x7236;&#x7a97;&#x53e3;&#x53d1;&#x9001;&#x6d88;&#x606f;&#x7684;&#x4ee3;&#x7801;&#x5982;&#x4e0b;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"240,243"}},{"content":"<pre data-lines=\"244,252\"><code class=\"language-javascript\"><span class=\"hljs-keyword\">var</span> win = <span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-title function_\">getElementsByTagName</span>(<span class=\"hljs-string\">&apos;iframe&apos;</span>)[<span class=\"hljs-number\">0</span>].<span class=\"hljs-property\">contentWindow</span>;\n<span class=\"hljs-keyword\">var</span> obj = { <span class=\"hljs-attr\">name</span>: <span class=\"hljs-string\">&apos;Jack&apos;</span> };\nwin.<span class=\"hljs-title function_\">postMessage</span>(\n  <span class=\"hljs-title class_\">JSON</span>.<span class=\"hljs-title function_\">stringify</span>({<span class=\"hljs-attr\">key</span>: <span class=\"hljs-string\">&apos;storage&apos;</span>, <span class=\"hljs-attr\">data</span>: obj}),\n  <span class=\"hljs-string\">&apos;http://bbb.com&apos;</span>\n);\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"244,252"}},{"content":"<pre data-lines=\"253,254\"><code>&#x52a0;&#x5f3a;&#x7248;&#x7684;&#x5b50;&#x7a97;&#x53e3;&#x63a5;&#x6536;&#x6d88;&#x606f;&#x7684;&#x4ee3;&#x7801;&#x5982;&#x4e0b;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"253,254"}},{"content":"<pre data-lines=\"255,274\"><code class=\"language-javascript\"><span class=\"hljs-variable language_\">window</span>.<span class=\"hljs-property\">onmessage</span> = <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">e</span>) {\n  <span class=\"hljs-keyword\">if</span> (e.<span class=\"hljs-property\">origin</span> !== <span class=\"hljs-string\">&apos;http://bbb.com&apos;</span>) <span class=\"hljs-keyword\">return</span>;\n  <span class=\"hljs-keyword\">var</span> payload = <span class=\"hljs-title class_\">JSON</span>.<span class=\"hljs-title function_\">parse</span>(e.<span class=\"hljs-property\">data</span>);\n  <span class=\"hljs-keyword\">switch</span> (payload.<span class=\"hljs-property\">method</span>) {\n    <span class=\"hljs-keyword\">case</span> <span class=\"hljs-string\">&apos;set&apos;</span>:\n      <span class=\"hljs-variable language_\">localStorage</span>.<span class=\"hljs-title function_\">setItem</span>(payload.<span class=\"hljs-property\">key</span>, <span class=\"hljs-title class_\">JSON</span>.<span class=\"hljs-title function_\">stringify</span>(payload.<span class=\"hljs-property\">data</span>));\n      <span class=\"hljs-keyword\">break</span>;\n    <span class=\"hljs-keyword\">case</span> <span class=\"hljs-string\">&apos;get&apos;</span>:\n      <span class=\"hljs-keyword\">var</span> parent = <span class=\"hljs-variable language_\">window</span>.<span class=\"hljs-property\">parent</span>;\n      <span class=\"hljs-keyword\">var</span> data = <span class=\"hljs-variable language_\">localStorage</span>.<span class=\"hljs-title function_\">getItem</span>(payload.<span class=\"hljs-property\">key</span>);\n      parent.<span class=\"hljs-title function_\">postMessage</span>(data, <span class=\"hljs-string\">&apos;http://aaa.com&apos;</span>);\n      <span class=\"hljs-keyword\">break</span>;\n    <span class=\"hljs-keyword\">case</span> <span class=\"hljs-string\">&apos;remove&apos;</span>:\n      <span class=\"hljs-variable language_\">localStorage</span>.<span class=\"hljs-title function_\">removeItem</span>(payload.<span class=\"hljs-property\">key</span>);\n      <span class=\"hljs-keyword\">break</span>;\n  }\n};\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"255,274"}},{"content":"<pre data-lines=\"275,276\"><code>&#x52a0;&#x5f3a;&#x7248;&#x7684;&#x7236;&#x7a97;&#x53e3;&#x53d1;&#x9001;&#x6d88;&#x606f;&#x4ee3;&#x7801;&#x5982;&#x4e0b;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"275,276"}},{"content":"<pre data-lines=\"277,295\"><code class=\"language-javascript\"><span class=\"hljs-keyword\">var</span> win = <span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-title function_\">getElementsByTagName</span>(<span class=\"hljs-string\">&apos;iframe&apos;</span>)[<span class=\"hljs-number\">0</span>].<span class=\"hljs-property\">contentWindow</span>;\n<span class=\"hljs-keyword\">var</span> obj = { <span class=\"hljs-attr\">name</span>: <span class=\"hljs-string\">&apos;Jack&apos;</span> };\n<span class=\"hljs-comment\">// &#x5b58;&#x5165;&#x5bf9;&#x8c61;</span>\nwin.<span class=\"hljs-title function_\">postMessage</span>(\n  <span class=\"hljs-title class_\">JSON</span>.<span class=\"hljs-title function_\">stringify</span>({<span class=\"hljs-attr\">key</span>: <span class=\"hljs-string\">&apos;storage&apos;</span>, <span class=\"hljs-attr\">method</span>: <span class=\"hljs-string\">&apos;set&apos;</span>, <span class=\"hljs-attr\">data</span>: obj}),\n  <span class=\"hljs-string\">&apos;http://bbb.com&apos;</span>\n);\n<span class=\"hljs-comment\">// &#x8bfb;&#x53d6;&#x5bf9;&#x8c61;</span>\nwin.<span class=\"hljs-title function_\">postMessage</span>(\n  <span class=\"hljs-title class_\">JSON</span>.<span class=\"hljs-title function_\">stringify</span>({<span class=\"hljs-attr\">key</span>: <span class=\"hljs-string\">&apos;storage&apos;</span>, <span class=\"hljs-attr\">method</span>: <span class=\"hljs-string\">&quot;get&quot;</span>}),\n  <span class=\"hljs-string\">&quot;*&quot;</span>\n);\n<span class=\"hljs-variable language_\">window</span>.<span class=\"hljs-property\">onmessage</span> = <span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\">e</span>) {\n  <span class=\"hljs-keyword\">if</span> (e.<span class=\"hljs-property\">origin</span> != <span class=\"hljs-string\">&apos;http://aaa.com&apos;</span>) <span class=\"hljs-keyword\">return</span>;\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-title class_\">JSON</span>.<span class=\"hljs-title function_\">parse</span>(e.<span class=\"hljs-property\">data</span>).<span class=\"hljs-property\">name</span>);\n};\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"277,295"}}],"payload":{"tag":"h3","lines":"224,225"}}],"payload":{"tag":"h2","lines":"99,100"}},{"content":"AJAX","children":[{"content":"JSONP","children":[{"content":"<pre data-lines=\"308,313\"><code>JSONP &#x662f;&#x670d;&#x52a1;&#x5668;&#x4e0e;&#x5ba2;&#x6237;&#x7aef;&#x8de8;&#x6e90;&#x901a;&#x4fe1;&#x7684;&#x5e38;&#x7528;&#x65b9;&#x6cd5;&#x3002;&#x6700;&#x5927;&#x7279;&#x70b9;&#x5c31;&#x662f;&#x7b80;&#x5355;&#x6613;&#x7528;&#xff0c;&#x6ca1;&#x6709;&#x517c;&#x5bb9;&#x6027;&#x95ee;&#x9898;&#xff0c;&#x8001;&#x5f0f;&#x6d4f;&#x89c8;&#x5668;&#x5168;&#x90e8;&#x652f;&#x6301;&#xff0c;&#x670d;&#x52a1;&#x7aef;&#x6539;&#x9020;&#x975e;&#x5e38;&#x5c0f;&#x3002;\n\n&#x5b83;&#x7684;&#x505a;&#x6cd5;&#x5982;&#x4e0b;&#x3002;\n\n&#x7b2c;&#x4e00;&#x6b65;&#xff0c;&#x7f51;&#x9875;&#x6dfb;&#x52a0;&#x4e00;&#x4e2a;`&lt;script&gt;`&#x5143;&#x7d20;&#xff0c;&#x5411;&#x670d;&#x52a1;&#x5668;&#x8bf7;&#x6c42;&#x4e00;&#x4e2a;&#x811a;&#x672c;&#xff0c;&#x8fd9;&#x4e0d;&#x53d7;&#x540c;&#x6e90;&#x653f;&#x7b56;&#x9650;&#x5236;&#xff0c;&#x53ef;&#x4ee5;&#x8de8;&#x57df;&#x8bf7;&#x6c42;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"308,313"}},{"content":"<pre data-lines=\"314,317\"><code class=\"language-html\"><span class=\"hljs-tag\">&lt;<span class=\"hljs-name\">script</span> <span class=\"hljs-attr\">src</span>=<span class=\"hljs-string\">&quot;http://api.foo.com?callback=bar&quot;</span>&gt;</span><span class=\"hljs-tag\">&lt;/<span class=\"hljs-name\">script</span>&gt;</span>\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"314,317"}},{"content":"<pre data-lines=\"318,325\"><code>&#x6ce8;&#x610f;&#xff0c;&#x8bf7;&#x6c42;&#x7684;&#x811a;&#x672c;&#x7f51;&#x5740;&#x6709;&#x4e00;&#x4e2a;`callback`&#x53c2;&#x6570;&#xff08;`?callback=bar`&#xff09;&#xff0c;&#x7528;&#x6765;&#x544a;&#x8bc9;&#x670d;&#x52a1;&#x5668;&#xff0c;&#x5ba2;&#x6237;&#x7aef;&#x7684;&#x56de;&#x8c03;&#x51fd;&#x6570;&#x540d;&#x79f0;&#xff08;`bar`&#xff09;&#x3002;\n\n&#x7b2c;&#x4e8c;&#x6b65;&#xff0c;&#x670d;&#x52a1;&#x5668;&#x6536;&#x5230;&#x8bf7;&#x6c42;&#x540e;&#xff0c;&#x62fc;&#x63a5;&#x4e00;&#x4e2a;&#x5b57;&#x7b26;&#x4e32;&#xff0c;&#x5c06; JSON &#x6570;&#x636e;&#x653e;&#x5728;&#x51fd;&#x6570;&#x540d;&#x91cc;&#x9762;&#xff0c;&#x4f5c;&#x4e3a;&#x5b57;&#x7b26;&#x4e32;&#x8fd4;&#x56de;&#xff08;`bar({...})`&#xff09;&#x3002;\n\n&#x7b2c;&#x4e09;&#x6b65;&#xff0c;&#x5ba2;&#x6237;&#x7aef;&#x4f1a;&#x5c06;&#x670d;&#x52a1;&#x5668;&#x8fd4;&#x56de;&#x7684;&#x5b57;&#x7b26;&#x4e32;&#xff0c;&#x4f5c;&#x4e3a;&#x4ee3;&#x7801;&#x89e3;&#x6790;&#xff0c;&#x56e0;&#x4e3a;&#x6d4f;&#x89c8;&#x5668;&#x8ba4;&#x4e3a;&#xff0c;&#x8fd9;&#x662f;`&lt;script&gt;`&#x6807;&#x7b7e;&#x8bf7;&#x6c42;&#x7684;&#x811a;&#x672c;&#x5185;&#x5bb9;&#x3002;&#x8fd9;&#x65f6;&#xff0c;&#x5ba2;&#x6237;&#x7aef;&#x53ea;&#x8981;&#x5b9a;&#x4e49;&#x4e86;`bar()`&#x51fd;&#x6570;&#xff0c;&#x5c31;&#x80fd;&#x5728;&#x8be5;&#x51fd;&#x6570;&#x4f53;&#x5185;&#xff0c;&#x62ff;&#x5230;&#x670d;&#x52a1;&#x5668;&#x8fd4;&#x56de;&#x7684; JSON &#x6570;&#x636e;&#x3002;\n\n&#x4e0b;&#x9762;&#x770b;&#x4e00;&#x4e2a;&#x5b9e;&#x4f8b;&#x3002;&#x9996;&#x5148;&#xff0c;&#x7f51;&#x9875;&#x52a8;&#x6001;&#x63d2;&#x5165;`&lt;script&gt;`&#x5143;&#x7d20;&#xff0c;&#x7531;&#x5b83;&#x5411;&#x8de8;&#x57df;&#x7f51;&#x5740;&#x53d1;&#x51fa;&#x8bf7;&#x6c42;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"318,325"}},{"content":"<pre data-lines=\"326,342\"><code class=\"language-javascript\"><span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">addScriptTag</span>(<span class=\"hljs-params\">src</span>) {\n  <span class=\"hljs-keyword\">var</span> script = <span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-title function_\">createElement</span>(<span class=\"hljs-string\">&apos;script&apos;</span>);\n  script.<span class=\"hljs-title function_\">setAttribute</span>(<span class=\"hljs-string\">&apos;type&apos;</span>, <span class=\"hljs-string\">&apos;text/javascript&apos;</span>);\n  script.<span class=\"hljs-property\">src</span> = src;\n  <span class=\"hljs-variable language_\">document</span>.<span class=\"hljs-property\">body</span>.<span class=\"hljs-title function_\">appendChild</span>(script);\n}\n\n<span class=\"hljs-variable language_\">window</span>.<span class=\"hljs-property\">onload</span> = <span class=\"hljs-keyword\">function</span> (<span class=\"hljs-params\"></span>) {\n  <span class=\"hljs-title function_\">addScriptTag</span>(<span class=\"hljs-string\">&apos;http://example.com/ip?callback=foo&apos;</span>);\n}\n\n<span class=\"hljs-keyword\">function</span> <span class=\"hljs-title function_\">foo</span>(<span class=\"hljs-params\">data</span>) {\n  <span class=\"hljs-variable language_\">console</span>.<span class=\"hljs-title function_\">log</span>(<span class=\"hljs-string\">&apos;Your public IP address is: &apos;</span> + data.<span class=\"hljs-property\">ip</span>);\n};\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"326,342"}},{"content":"<pre data-lines=\"343,346\"><code>&#x4e0a;&#x9762;&#x4ee3;&#x7801;&#x901a;&#x8fc7;&#x52a8;&#x6001;&#x6dfb;&#x52a0;`&lt;script&gt;`&#x5143;&#x7d20;&#xff0c;&#x5411;&#x670d;&#x52a1;&#x5668;`example.com`&#x53d1;&#x51fa;&#x8bf7;&#x6c42;&#x3002;&#x6ce8;&#x610f;&#xff0c;&#x8be5;&#x8bf7;&#x6c42;&#x7684;&#x67e5;&#x8be2;&#x5b57;&#x7b26;&#x4e32;&#x6709;&#x4e00;&#x4e2a;`callback`&#x53c2;&#x6570;&#xff0c;&#x7528;&#x6765;&#x6307;&#x5b9a;&#x56de;&#x8c03;&#x51fd;&#x6570;&#x7684;&#x540d;&#x5b57;&#xff0c;&#x8fd9;&#x5bf9;&#x4e8e; JSONP &#x662f;&#x5fc5;&#x9700;&#x7684;&#x3002;\n\n&#x670d;&#x52a1;&#x5668;&#x6536;&#x5230;&#x8fd9;&#x4e2a;&#x8bf7;&#x6c42;&#x4ee5;&#x540e;&#xff0c;&#x4f1a;&#x5c06;&#x6570;&#x636e;&#x653e;&#x5728;&#x56de;&#x8c03;&#x51fd;&#x6570;&#x7684;&#x53c2;&#x6570;&#x4f4d;&#x7f6e;&#x8fd4;&#x56de;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"343,346"}},{"content":"<pre data-lines=\"347,352\"><code class=\"language-javascript\"><span class=\"hljs-title function_\">foo</span>({\n  <span class=\"hljs-string\">&apos;ip&apos;</span>: <span class=\"hljs-string\">&apos;8.8.8.8&apos;</span>\n});\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"347,352"}},{"content":"<pre data-lines=\"353,354\"><code>&#x7531;&#x4e8e;`&lt;script&gt;`&#x5143;&#x7d20;&#x8bf7;&#x6c42;&#x7684;&#x811a;&#x672c;&#xff0c;&#x76f4;&#x63a5;&#x4f5c;&#x4e3a;&#x4ee3;&#x7801;&#x8fd0;&#x884c;&#x3002;&#x8fd9;&#x65f6;&#xff0c;&#x53ea;&#x8981;&#x6d4f;&#x89c8;&#x5668;&#x5b9a;&#x4e49;&#x4e86;`foo`&#x51fd;&#x6570;&#xff0c;&#x8be5;&#x51fd;&#x6570;&#x5c31;&#x4f1a;&#x7acb;&#x5373;&#x8c03;&#x7528;&#x3002;&#x4f5c;&#x4e3a;&#x53c2;&#x6570;&#x7684; JSON &#x6570;&#x636e;&#x88ab;&#x89c6;&#x4e3a; JavaScript &#x5bf9;&#x8c61;&#xff0c;&#x800c;&#x4e0d;&#x662f;&#x5b57;&#x7b26;&#x4e32;&#xff0c;&#x56e0;&#x6b64;&#x907f;&#x514d;&#x4e86;&#x4f7f;&#x7528;`JSON.parse`&#x7684;&#x6b65;&#x9aa4;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"353,354"}}],"payload":{"tag":"h3","lines":"306,307"}},{"content":"WebSocket","children":[{"content":"<pre data-lines=\"357,360\"><code>WebSocket &#x662f;&#x4e00;&#x79cd;&#x901a;&#x4fe1;&#x534f;&#x8bae;&#xff0c;&#x4f7f;&#x7528;`ws://`&#xff08;&#x975e;&#x52a0;&#x5bc6;&#xff09;&#x548c;`wss://`&#xff08;&#x52a0;&#x5bc6;&#xff09;&#x4f5c;&#x4e3a;&#x534f;&#x8bae;&#x524d;&#x7f00;&#x3002;&#x8be5;&#x534f;&#x8bae;&#x4e0d;&#x5b9e;&#x884c;&#x540c;&#x6e90;&#x653f;&#x7b56;&#xff0c;&#x53ea;&#x8981;&#x670d;&#x52a1;&#x5668;&#x652f;&#x6301;&#xff0c;&#x5c31;&#x53ef;&#x4ee5;&#x901a;&#x8fc7;&#x5b83;&#x8fdb;&#x884c;&#x8de8;&#x6e90;&#x901a;&#x4fe1;&#x3002;\n\n&#x4e0b;&#x9762;&#x662f;&#x4e00;&#x4e2a;&#x4f8b;&#x5b50;&#xff0c;&#x6d4f;&#x89c8;&#x5668;&#x53d1;&#x51fa;&#x7684; WebSocket &#x8bf7;&#x6c42;&#x7684;&#x5934;&#x4fe1;&#x606f;&#xff08;&#x6458;&#x81ea;[&#x7ef4;&#x57fa;&#x767e;&#x79d1;](https://en.wikipedia.org/wiki/WebSocket)&#xff09;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"357,360"}},{"content":"<pre data-lines=\"361,371\"><code class=\"language-http\"><span class=\"hljs-keyword\">GET</span> <span class=\"hljs-string\">/chat</span> <span class=\"hljs-meta\">HTTP/1.1</span>\n<span class=\"hljs-attribute\">Host</span><span class=\"hljs-punctuation\">: </span>server.example.com\n<span class=\"hljs-attribute\">Upgrade</span><span class=\"hljs-punctuation\">: </span>websocket\n<span class=\"hljs-attribute\">Connection</span><span class=\"hljs-punctuation\">: </span>Upgrade\n<span class=\"hljs-attribute\">Sec-WebSocket-Key</span><span class=\"hljs-punctuation\">: </span>x3JJHMbDL1EzLkh9GBhXDw==\n<span class=\"hljs-attribute\">Sec-WebSocket-Protocol</span><span class=\"hljs-punctuation\">: </span>chat, superchat\n<span class=\"hljs-attribute\">Sec-WebSocket-Version</span><span class=\"hljs-punctuation\">: </span>13\n<span class=\"hljs-attribute\">Origin</span><span class=\"hljs-punctuation\">: </span>http://example.com\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"361,371"}},{"content":"<pre data-lines=\"372,375\"><code>&#x4e0a;&#x9762;&#x4ee3;&#x7801;&#x4e2d;&#xff0c;&#x6709;&#x4e00;&#x4e2a;&#x5b57;&#x6bb5;&#x662f;`Origin`&#xff0c;&#x8868;&#x793a;&#x8be5;&#x8bf7;&#x6c42;&#x7684;&#x8bf7;&#x6c42;&#x6e90;&#xff08;origin&#xff09;&#xff0c;&#x5373;&#x53d1;&#x81ea;&#x54ea;&#x4e2a;&#x57df;&#x540d;&#x3002;\n\n&#x6b63;&#x662f;&#x56e0;&#x4e3a;&#x6709;&#x4e86;`Origin`&#x8fd9;&#x4e2a;&#x5b57;&#x6bb5;&#xff0c;&#x6240;&#x4ee5; WebSocket &#x624d;&#x6ca1;&#x6709;&#x5b9e;&#x884c;&#x540c;&#x6e90;&#x653f;&#x7b56;&#x3002;&#x56e0;&#x4e3a;&#x670d;&#x52a1;&#x5668;&#x53ef;&#x4ee5;&#x6839;&#x636e;&#x8fd9;&#x4e2a;&#x5b57;&#x6bb5;&#xff0c;&#x5224;&#x65ad;&#x662f;&#x5426;&#x8bb8;&#x53ef;&#x672c;&#x6b21;&#x901a;&#x4fe1;&#x3002;&#x5982;&#x679c;&#x8be5;&#x57df;&#x540d;&#x5728;&#x767d;&#x540d;&#x5355;&#x5185;&#xff0c;&#x670d;&#x52a1;&#x5668;&#x5c31;&#x4f1a;&#x505a;&#x51fa;&#x5982;&#x4e0b;&#x56de;&#x5e94;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"372,375"}},{"content":"<pre data-lines=\"376,383\"><code class=\"language-http\"><span class=\"hljs-meta\">HTTP/1.1</span> <span class=\"hljs-number\">101</span> Switching Protocols\n<span class=\"hljs-attribute\">Upgrade</span><span class=\"hljs-punctuation\">: </span>websocket\n<span class=\"hljs-attribute\">Connection</span><span class=\"hljs-punctuation\">: </span>Upgrade\n<span class=\"hljs-attribute\">Sec-WebSocket-Accept</span><span class=\"hljs-punctuation\">: </span>HSmrc0sMlYUkAGmm5OPpG2HaGWk=\n<span class=\"hljs-attribute\">Sec-WebSocket-Protocol</span><span class=\"hljs-punctuation\">: </span>chat\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"376,383"}}],"payload":{"tag":"h3","lines":"355,356"}},{"content":"CORS","children":[{"content":"<pre data-lines=\"386,389\"><code>CORS &#x662f;&#x8de8;&#x6e90;&#x8d44;&#x6e90;&#x5206;&#x4eab;&#xff08;Cross-Origin Resource Sharing&#xff09;&#x7684;&#x7f29;&#x5199;&#x3002;&#x5b83;&#x662f; W3C &#x6807;&#x51c6;&#xff0c;&#x5c5e;&#x4e8e;&#x8de8;&#x6e90; AJAX &#x8bf7;&#x6c42;&#x7684;&#x6839;&#x672c;&#x89e3;&#x51b3;&#x65b9;&#x6cd5;&#x3002;&#x76f8;&#x6bd4; JSONP &#x53ea;&#x80fd;&#x53d1;`GET`&#x8bf7;&#x6c42;&#xff0c;CORS &#x5141;&#x8bb8;&#x4efb;&#x4f55;&#x7c7b;&#x578b;&#x7684;&#x8bf7;&#x6c42;&#x3002;\n\n&#x4e0b;&#x4e00;&#x7ae0;&#x5c06;&#x8be6;&#x7ec6;&#x4ecb;&#x7ecd;&#xff0c;&#x5982;&#x4f55;&#x901a;&#x8fc7; CORS &#x5b8c;&#x6210;&#x8de8;&#x6e90; AJAX &#x8bf7;&#x6c42;&#x3002;\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"386,389"}}],"payload":{"tag":"h3","lines":"384,385"}}],"payload":{"tag":"h2","lines":"296,297"}},{"content":"&#x53c2;&#x8003;&#x94fe;&#x63a5;","children":[{"content":"Mozilla Developer Network, <a href=\"https://developer.mozilla.org/en-US/docs/Web/API/window.postMessage\">Window.postMessage</a>","children":[],"payload":{"tag":"li","lines":"392,393"}},{"content":"Jakub Jankiewicz, <a href=\"http://jcubic.wordpress.com/2014/06/20/cross-domain-localstorage/\">Cross-Domain LocalStorage</a>","children":[],"payload":{"tag":"li","lines":"393,394"}},{"content":"David Baron, <a href=\"http://dbaron.org/log/20100309-faster-timeouts\">setTimeout with a shorter delay</a>: &#x5229;&#x7528; window.postMessage &#x53ef;&#x4ee5;&#x5b9e;&#x73b0;0&#x6beb;&#x79d2;&#x89e6;&#x53d1;&#x56de;&#x8c03;&#x51fd;&#x6570;","children":[],"payload":{"tag":"li","lines":"394,395"}}],"payload":{"tag":"h2","lines":"390,391"}}],"payload":{"tag":"h1","lines":"0,1"}},{})</script>
</body>
</html>
