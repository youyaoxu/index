<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<title>Markmap</title>
<style>
* {
  margin: 0;
  padding: 0;
}
#mindmap {
  display: block;
  width: 100vw;
  height: 100vh;
}
</style>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@highlightjs/cdn-assets@11.11.1/styles/default.min.css">
</head>
<body>
<svg id="mindmap"></svg>
<script src="https://cdn.jsdelivr.net/npm/d3@7.9.0/dist/d3.min.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-view@0.18.10/dist/browser/index.js"></script><script src="https://cdn.jsdelivr.net/npm/markmap-toolbar@0.18.10/dist/index.js"></script><script>(r => {
              setTimeout(r);
            })(function renderToolbar() {
  const {
    markmap,
    mm
  } = window;
  const {
    el
  } = markmap.Toolbar.create(mm);
  el.setAttribute('style', 'position:absolute;bottom:20px;right:20px');
  document.body.append(el);
})</script><script>((getMarkmap, getOptions, root2, jsonOptions) => {
              const markmap = getMarkmap();
              window.mm = markmap.Markmap.create(
                "svg#mindmap",
                (getOptions || markmap.deriveOptions)(jsonOptions),
                root2
              );
            })(() => window.markmap,null,{"content":"03-io-concur-day08","children":[{"content":"IO-CONCUR","children":[{"content":"&#x524d;&#x60c5;&#x56de;&#x987e;","children":[{"content":"<pre data-lines=\"8,40\"><code data-lines=\"8,40\">\n<span class=\"hljs-number\">1</span>. &#x8fdb;&#x7a0b;  Process\n\n   <span class=\"hljs-built_in\">Process</span>()  &#x521b;&#x5efa;&#x8fdb;&#x7a0b;&#x5bf9;&#x8c61;\n   <span class=\"hljs-selector-tag\">p</span><span class=\"hljs-selector-class\">.start</span>()  &#x542f;&#x52a8;&#x8fdb;&#x7a0b;\n   <span class=\"hljs-selector-tag\">p</span><span class=\"hljs-selector-class\">.join</span>()  &#x56de;&#x6536;&#x8fdb;&#x7a0b;\n\n<span class=\"hljs-number\">2</span>. &#x8fdb;&#x7a0b;&#x5bf9;&#x8c61;&#x5c5e;&#x6027;\n    <span class=\"hljs-selector-tag\">p</span><span class=\"hljs-selector-class\">.pid</span>    <span class=\"hljs-selector-tag\">p</span><span class=\"hljs-selector-class\">.daemon</span>\n\n<span class=\"hljs-number\">3</span>. &#x81ea;&#x5b9a;&#x4e49;&#x8fdb;&#x7a0b;&#x7c7b;\n\n    &#x7ee7;&#x627f;Process --&gt; <span class=\"hljs-built_in\">super</span>().<span class=\"hljs-built_in\">__init__</span>() --&gt;&#x91cd;&#x5199;run\n\n<span class=\"hljs-number\">4</span>. &#x8fdb;&#x7a0b;&#x6c60;\n\n   <span class=\"hljs-built_in\">Pool</span>()\n   <span class=\"hljs-built_in\">apply_async</span>()\n   <span class=\"hljs-built_in\">close</span>()\n   <span class=\"hljs-built_in\">join</span>()\n\n<span class=\"hljs-number\">5</span>. &#x6d88;&#x606f;&#x961f;&#x5217;\n   <span class=\"hljs-built_in\">Queue</span>()  <span class=\"hljs-selector-tag\">q</span><span class=\"hljs-selector-class\">.put</span>()  <span class=\"hljs-selector-tag\">q</span><span class=\"hljs-selector-class\">.get</span>()\n\n&#x7ec3;&#x4e60;<span class=\"hljs-number\">1</span>&#xff1a; &#x4ece;&#x591a;&#x4e2a;&#x4f4d;&#x7f6e;&#x540c;&#x65f6;&#x62f7;&#x8d1d;&#x4e00;&#x4e2a;&#x6587;&#x4ef6;&#x5230;&#x672c;&#x5730;\n\n\n&#x4f5c;&#x4e1a;&#xff1a;&#x3000;&#xff11;&#xff0e;&#x3000;&#x6d4b;&#x8bd5;&#x7528;&#x4f8b;&#x5b8c;&#x6210;\n&#x3000;&#x3000;&#x3000;&#x3000;&#xff12;&#xff0e;&#x3000;&#x603b;&#x7ed3;&#x7ebf;&#x7a0b;&#x7528;&#x6237;\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"8,40"}}],"payload":{"tag":"h5","lines":"6,7"}},{"content":"&#x793a;&#x4f8b;","children":[{"content":"<pre data-lines=\"43,62\"><code class=\"language-python\"><span class=\"hljs-comment\"># cls.py</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">A</span>:\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__init__</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-keyword\">pass</span>\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">start</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;1800&#x884c;&quot;</span>)\n        <span class=\"hljs-variable language_\">self</span>.run()\n    <span class=\"hljs-comment\"># &#x63a5;&#x53e3;</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">run</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-keyword\">pass</span>\n\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">B</span>(<span class=\"hljs-title class_ inherited__\">A</span>):\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">run</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;200&#x884c;&quot;</span>)\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"43,62"}},{"content":"<pre data-lines=\"63,113\"><code class=\"language-python\"><span class=\"hljs-comment\"># dead_lock.py</span>\n<span class=\"hljs-keyword\">from</span> time <span class=\"hljs-keyword\">import</span> sleep\n<span class=\"hljs-keyword\">from</span> threading <span class=\"hljs-keyword\">import</span> Thread,Lock\n\n<span class=\"hljs-comment\"># &#x8d26;&#x6237;&#x7c7b;</span>\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">Account</span>:\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__init__</span>(<span class=\"hljs-params\">self,<span class=\"hljs-built_in\">id</span>,balance,lock</span>):\n        <span class=\"hljs-variable language_\">self</span>.<span class=\"hljs-built_in\">id</span> = <span class=\"hljs-built_in\">id</span>\n        <span class=\"hljs-variable language_\">self</span>.balance = balance  <span class=\"hljs-comment\"># &#x5b58;&#x6b3e;</span>\n        <span class=\"hljs-variable language_\">self</span>.lock = lock  <span class=\"hljs-comment\"># &#x9501;</span>\n\n    <span class=\"hljs-comment\"># &#x53d6;&#x94b1;</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">withdraw</span>(<span class=\"hljs-params\">self,amount</span>):\n        <span class=\"hljs-variable language_\">self</span>.balance -= amount\n\n    <span class=\"hljs-comment\"># &#x5b58;&#x94b1;</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">deposit</span>(<span class=\"hljs-params\">self,amount</span>):\n        <span class=\"hljs-variable language_\">self</span>.balance += amount\n\n    <span class=\"hljs-comment\"># &#x4f59;&#x989d;</span>\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">getBalance</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-keyword\">return</span> <span class=\"hljs-variable language_\">self</span>.balance\n\n<span class=\"hljs-comment\"># &#x4ea7;&#x751f;&#x8d26;&#x6237;</span>\nLiang = Account(<span class=\"hljs-string\">&apos;Liang&apos;</span>,<span class=\"hljs-number\">5000</span>,Lock())\nGang = Account(<span class=\"hljs-string\">&apos;Gang&apos;</span>,<span class=\"hljs-number\">8000</span>,Lock())\n\n<span class=\"hljs-comment\"># &#x8f6c;&#x8d26;</span>\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">transfer</span>(<span class=\"hljs-params\">from_,to,amount</span>):\n    from_.lock.acquire() <span class=\"hljs-comment\"># &#x9501;&#x81ea;&#x5df1;&#x7684;</span>\n    from_.withdraw(amount) <span class=\"hljs-comment\"># &#x81ea;&#x5df1;&#x94b1;&#x51cf;&#x5c11;</span>\n    from_.lock.release()  <span class=\"hljs-comment\"># &#x89e3;&#x9501;</span>\n    sleep(<span class=\"hljs-number\">0.2</span>)\n    to.lock.acquire()  <span class=\"hljs-comment\"># &#x5bf9;&#x65b9;&#x4e0a;&#x9501;</span>\n    to.deposit(amount) <span class=\"hljs-comment\"># &#x5bf9;&#x65b9;&#x94b1;&#x589e;&#x52a0;</span>\n    to.lock.release()  <span class=\"hljs-comment\">#&#x89e3;&#x9501;</span>\n\n\n\nt1 = Thread(target=transfer,args=(Liang,Gang,<span class=\"hljs-number\">1500</span>))\nt2 = Thread(target=transfer,args=(Gang,Liang,<span class=\"hljs-number\">1500</span>))\nt1.start()\nt2.start()\nt1.join()\nt2.join()\n\n<span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;Liang:&quot;</span>,Liang.getBalance())\n<span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;Gang:&quot;</span>,Gang.getBalance())\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"63,113"}},{"content":"<pre data-lines=\"114,189\"><code class=\"language-python\"><span class=\"hljs-string\">&quot;&quot;&quot;\nexercise_1.py\n&#x4ece;&#x591a;&#x4e2a;&#x4f4d;&#x7f6e;&#x540c;&#x65f6;&#x62f7;&#x8d1d;&#x4e00;&#x4e2a;&#x6587;&#x4ef6;&#x5230;&#x672c;&#x5730;\n&quot;&quot;&quot;</span>\n\n<span class=\"hljs-keyword\">from</span> threading <span class=\"hljs-keyword\">import</span> Thread,Lock\n<span class=\"hljs-keyword\">import</span> os\n<span class=\"hljs-keyword\">from</span> time <span class=\"hljs-keyword\">import</span> sleep\n\nlock = Lock()\n\n<span class=\"hljs-comment\"># &#x6587;&#x4ef6;&#x7684;&#x5b58;&#x653e;&#x4f4d;&#x7f6e;</span>\nurls = [<span class=\"hljs-string\">&quot;/home/tarena/&#x684c;&#x9762;/&quot;</span>,\n        <span class=\"hljs-string\">&quot;/home/tarena/&#x6a21;&#x677f;/&quot;</span>,\n        <span class=\"hljs-string\">&quot;/home/tarena/&#x97f3;&#x4e50;/&quot;</span>,\n        <span class=\"hljs-string\">&quot;/home/tarena/&#x6587;&#x6863;/&quot;</span>,\n        <span class=\"hljs-string\">&quot;/home/tarena/&#x4e0b;&#x8f7d;/&quot;</span>,\n        <span class=\"hljs-string\">&quot;/home/tarena/&#x56fe;&#x7247;/&quot;</span>]\n\nfilename = <span class=\"hljs-built_in\">input</span>(<span class=\"hljs-string\">&quot;&#x6587;&#x4ef6;&#x540d;&#x79f0;:&quot;</span>)\n\nexplorer = [] <span class=\"hljs-comment\"># &#x6587;&#x4ef6;&#x7684;&#x8def;&#x5f84;</span>\n<span class=\"hljs-keyword\">for</span> url <span class=\"hljs-keyword\">in</span> urls:\n        <span class=\"hljs-keyword\">if</span> os.path.exists(url+filename):\n                explorer.append(url+filename)\n\n<span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;&#x8def;&#x5f84;:&quot;</span>,explorer)\n\n<span class=\"hljs-keyword\">if</span> <span class=\"hljs-keyword\">not</span> explorer:\n    os._exit(<span class=\"hljs-number\">0</span>)\n\nfile_size = os.path.getsize(explorer[<span class=\"hljs-number\">0</span>]) <span class=\"hljs-comment\"># &#x6587;&#x4ef6;&#x5927;&#x5c0f;</span>\npath_num = <span class=\"hljs-built_in\">len</span>(explorer) <span class=\"hljs-comment\"># &#x67e5;&#x770b;&#x6709;&#x51e0;&#x4e2a;&#x8d44;&#x6e90;</span>\nblock_size = file_size // path_num + <span class=\"hljs-number\">1</span> <span class=\"hljs-comment\"># &#x6bcf;&#x4e2a;&#x7ebf;&#x7a0b;&#x62f7;&#x8d1d;</span>\n\nfw = <span class=\"hljs-built_in\">open</span>(filename,<span class=\"hljs-string\">&apos;wb&apos;</span>) <span class=\"hljs-comment\"># &#x76ee;&#x6807; &#x5171;&#x4eab;&#x8d44;&#x6e90;</span>\n\n<span class=\"hljs-comment\"># &#x62f7;&#x8d1d;&#x6587;&#x4ef6;&#x4e00;&#x90e8;&#x5206; &#xff1a; &#x4ece;&#x54ea;&#x8003;  &#x62f7;&#x8d1d;&#x5230;&#x54ea;  &#x7b2c;&#x51e0;&#x90e8;&#x5206; &#x62f7;&#x8d1d;&#x591a;&#x5927;</span>\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">load</span>(<span class=\"hljs-params\">path,n</span>):\n    fr = <span class=\"hljs-built_in\">open</span>(path,<span class=\"hljs-string\">&apos;rb&apos;</span>) <span class=\"hljs-comment\"># &#x6a21;&#x62df;&#x4e0b;&#x8f7d;&#x8fc7;&#x7a0b;</span>\n    seek_num = block_size * n <span class=\"hljs-comment\"># &#x4ece;&#x54ea;&#x5f00;&#x59cb;&#x8bfb;&#x5199;</span>\n    fr.seek(seek_num)\n    <span class=\"hljs-comment\"># &#x8bfb;&#x5199;&#x8fc7;&#x7a0b;</span>\n    num = block_size\n    size = <span class=\"hljs-number\">0</span>\n    <span class=\"hljs-keyword\">while</span> <span class=\"hljs-literal\">True</span>:\n        <span class=\"hljs-keyword\">if</span> num &lt;= <span class=\"hljs-number\">1024</span>:\n            data = fr.read(num)\n            lock.acquire()\n            fw.seek(seek_num + size)\n            fw.write(data)\n            lock.release()\n            <span class=\"hljs-keyword\">break</span>\n        data = fr.read(<span class=\"hljs-number\">1024</span>)\n        lock.acquire()\n        fw.seek(seek_num+size)\n        sleep(<span class=\"hljs-number\">0.02</span>)\n        size += fw.write(data)\n        lock.release()\n        num -= <span class=\"hljs-number\">1024</span>\n\n\njobs = []\nn = <span class=\"hljs-number\">0</span>\n<span class=\"hljs-keyword\">for</span> path <span class=\"hljs-keyword\">in</span> explorer:\n    t = Thread(target=load,args=(path,n))\n    jobs.append(t)\n    t.start()\n    n += <span class=\"hljs-number\">1</span>\n\n<span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> jobs:\n    i.join()\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"114,189"}},{"content":"<pre data-lines=\"190,257\"><code class=\"language-python\"><span class=\"hljs-string\">&quot;&quot;&quot;\nexercise_3.py\n&#x4f7f;&#x7528;&#x8fdb;&#x7a0b;&#x6c60;&#x62f7;&#x8d1d;&#x4e00;&#x4e2a;&#x76ee;&#x5f55;&#xff08;&#x5305;&#x542b;&#x76ee;&#x5f55;&#x4e2d;&#x6240;&#x6709;&#x5185;&#x5bb9;&#xff09;&#xff0c;&#x76ee;&#x5f55;&#x4e2d;\n&#x5305;&#x542b;&#x82e5;&#x5e72;&#x4e2a;&#x666e;&#x901a;&#x6587;&#x4ef6;&#x3002;\n\n       *  &#x76ee;&#x5f55;&#x4e2d;&#x7684;&#x6bcf;&#x4e2a;&#x6587;&#x4ef6;&#x62f7;&#x8d1d;&#x8fc7;&#x7a0b;&#x90fd;&#x9700;&#x8981;&#x4e00;&#x4e2a;&#x5355;&#x72ec;&#x7684;&#x8fdb;&#x7a0b;&#x53bb;\n       &#x5b9e;&#x73b0;\n\n       *  &#x62f7;&#x8d1d;&#x8fc7;&#x7a0b;&#x4e2d;&#x5b9e;&#x65f6;&#x663e;&#x793a;&#x62f7;&#x8d1d;&#x7684;&#x767e;&#x5206;&#x6bd4;\n\n\n       os.mkdir() &#x521b;&#x5efa;&#x76ee;&#x5f55;\n&quot;&quot;&quot;</span>\n\n<span class=\"hljs-keyword\">from</span> multiprocessing <span class=\"hljs-keyword\">import</span> Pool,Queue\n<span class=\"hljs-keyword\">import</span> os\n\n<span class=\"hljs-comment\"># &#x6d88;&#x606f;&#x961f;&#x5217;</span>\nq = Queue()\n\nbase_path = <span class=\"hljs-string\">&quot;/home/tarena/&quot;</span> <span class=\"hljs-comment\"># &#x8981;&#x62f7;&#x8d1d;&#x7684;&#x76ee;&#x5f55;&#x5728;&#x8fd9;&#x4e2a;&#x76ee;&#x5f55;&#x4e0b;</span>\n<span class=\"hljs-built_in\">dir</span> = <span class=\"hljs-built_in\">input</span>(<span class=\"hljs-string\">&quot;&#x8981;&#x62f7;&#x8d1d;&#x7684;&#x76ee;&#x5f55;&#xff1a;&quot;</span>)\nold_folder = base_path + <span class=\"hljs-built_in\">dir</span>\n\n<span class=\"hljs-comment\"># &#x65b0;&#x7684;&#x76ee;&#x5f55;</span>\nnew_folder = old_folder+<span class=\"hljs-string\">&apos;-&#x5907;&#x4efd;&apos;</span>\nos.mkdir(new_folder)\n\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">copy_file</span>(<span class=\"hljs-params\">file</span>):\n    fr = <span class=\"hljs-built_in\">open</span>(old_folder+<span class=\"hljs-string\">&apos;/&apos;</span>+file,<span class=\"hljs-string\">&apos;rb&apos;</span>)\n    fw = <span class=\"hljs-built_in\">open</span>(new_folder+<span class=\"hljs-string\">&apos;/&apos;</span>+file,<span class=\"hljs-string\">&apos;wb&apos;</span>)\n    <span class=\"hljs-keyword\">while</span> <span class=\"hljs-literal\">True</span>:\n        data = fr.read(<span class=\"hljs-number\">1024</span>)\n        <span class=\"hljs-keyword\">if</span> <span class=\"hljs-keyword\">not</span> data:\n            <span class=\"hljs-keyword\">break</span>\n        n = fw.write(data)\n        q.put(n)\n    fr.close()\n    fw.close()\n\n\n<span class=\"hljs-comment\"># &#x4e00;&#x5171;&#x6709;&#x54ea;&#x4e9b;&#x6587;&#x4ef6;</span>\nall_files = os.listdir(old_folder)\n\n<span class=\"hljs-comment\"># &#x8ba1;&#x7b97;&#x76ee;&#x5f55;&#x5927;&#x5c0f;</span>\ntotal_size = <span class=\"hljs-number\">0</span>\n<span class=\"hljs-keyword\">for</span> file <span class=\"hljs-keyword\">in</span> all_files:\n    total_size += os.path.getsize(old_folder+<span class=\"hljs-string\">&apos;/&apos;</span>+file)\n\n<span class=\"hljs-comment\"># &#x4f7f;&#x7528;&#x8fdb;&#x7a0b;&#x6c60;&#x62f7;&#x8d1d;</span>\npool = Pool()\n<span class=\"hljs-keyword\">for</span> file <span class=\"hljs-keyword\">in</span> all_files:\n    <span class=\"hljs-comment\"># &#x6bcf;copy&#x4e00;&#x4e2a;&#x6587;&#x4ef6;&#x5c31;&#x662f;&#x4e00;&#x4e2a;&#x4e8b;&#x4ef6;</span>\n    pool.apply_async(copy_file,args=(file,))\npool.close()\n\ncopy_size = <span class=\"hljs-number\">0</span>\n<span class=\"hljs-keyword\">while</span> <span class=\"hljs-literal\">True</span>:\n    copy_size += q.get()\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;&#x62f7;&#x8d1d;&#x4e86;:%.1f%%&quot;</span>%(copy_size/total_size*<span class=\"hljs-number\">100</span>))\n    <span class=\"hljs-keyword\">if</span> copy_size &gt;= total_size:\n        <span class=\"hljs-keyword\">break</span>\n\npool.join()\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"190,257"}},{"content":"<pre data-lines=\"258,285\"><code class=\"language-python\"><span class=\"hljs-comment\"># myThread.py</span>\n<span class=\"hljs-keyword\">from</span> threading <span class=\"hljs-keyword\">import</span> Thread\n<span class=\"hljs-keyword\">from</span> time <span class=\"hljs-keyword\">import</span> *\n\n<span class=\"hljs-keyword\">class</span> <span class=\"hljs-title class_\">MyThread</span>(<span class=\"hljs-title class_ inherited__\">Thread</span>):\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">__init__</span>(<span class=\"hljs-params\">self,target=<span class=\"hljs-literal\">None</span>,args=(<span class=\"hljs-params\"></span>),kwargs={}</span>):\n        <span class=\"hljs-built_in\">super</span>().__init__() <span class=\"hljs-comment\"># &#x6b64;&#x884c;&#x4e0d;&#x8bb8;&#x52a8;</span>\n        <span class=\"hljs-variable language_\">self</span>.target = target\n        <span class=\"hljs-variable language_\">self</span>.args = args\n        <span class=\"hljs-variable language_\">self</span>.kwargs = kwargs\n\n    <span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">run</span>(<span class=\"hljs-params\">self</span>):\n        <span class=\"hljs-variable language_\">self</span>.target(*<span class=\"hljs-variable language_\">self</span>.args,**<span class=\"hljs-variable language_\">self</span>.kwargs)\n\n\n<span class=\"hljs-comment\">#####################################</span>\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">player</span>(<span class=\"hljs-params\">sec,song</span>):\n    <span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(<span class=\"hljs-number\">3</span>):\n        <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;Playing %s:%s&quot;</span>%(song,ctime()))\n        sleep(sec)\n\nt = MyThread(target=player,args=(<span class=\"hljs-number\">2</span>,),\n             kwargs={<span class=\"hljs-string\">&apos;song&apos;</span>:<span class=\"hljs-string\">&apos;&#x51c9;&#x51c9;&apos;</span>})\nt.start()\nt.join()\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"258,285"}},{"content":"<pre data-lines=\"286,317\"><code class=\"language-python\"><span class=\"hljs-string\">&quot;&quot;&quot;\ntest.py\n&#x6d4b;&#x8bd5;&#x7528;&#x4f8b;\n&#x5355;&#x8fdb;&#x7a0b;&#x6267;&#x884c;&#xff11;&#xff10;&#x6b21;count&#x8ba1;&#x7b97;&#x65f6;&#x95f4;&#xff0c;&#x6267;&#x884c;&#xff11;&#xff10;&#x6b21;io&#x8ba1;&#x7b97;&#x65f6;&#x95f4;\n&#xff11;&#xff10;&#x4e2a;&#x7ebf;&#x7a0b;&#x6bcf;&#x4e2a;&#x6267;&#x884c;&#xff11;&#x6b21;&#xff43;&#xff4f;&#xff55;&#xff4e;&#xff54;&#xff0c;&#x6bcf;&#x4e2a;&#x6267;&#x884c;&#xff11;&#x6b21;&#xff29;&#xff2f;&#xff0c;&#x5206;&#x522b;&#x8ba1;&#x7b97;&#x65f6;&#x95f4;\n&#xff11;&#xff10;&#x4e2a;&#x8fdb;&#x7a0b;&#x6bcf;&#x4e2a;&#x6267;&#x884c;&#xff11;&#x6b21;&#xff43;&#xff4f;&#xff55;&#xff4e;&#xff54;&#xff0c;&#x6bcf;&#x4e2a;&#x6267;&#x884c;&#xff11;&#x6b21;&#xff29;&#xff2f;&#xff0c;&#x5206;&#x522b;&#x8ba1;&#x7b97;&#x65f6;&#x95f4;\n&quot;&quot;&quot;</span>\n\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">count</span>(<span class=\"hljs-params\">x,y</span>):\n    c = <span class=\"hljs-number\">0</span>\n    <span class=\"hljs-keyword\">while</span> c &lt; <span class=\"hljs-number\">7000000</span>:\n        x += <span class=\"hljs-number\">1</span>\n        y += <span class=\"hljs-number\">1</span>\n        c += <span class=\"hljs-number\">1</span>\n\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">io</span>():\n    write()\n    read()\n\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">write</span>():\n    f = <span class=\"hljs-built_in\">open</span>(<span class=\"hljs-string\">&apos;text&apos;</span>,<span class=\"hljs-string\">&apos;w&apos;</span>)\n    <span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(<span class=\"hljs-number\">1800000</span>):\n        f.write(<span class=\"hljs-string\">&quot;hello world\\n&quot;</span>)\n    f.close()\n\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">read</span>():\n    f = <span class=\"hljs-built_in\">open</span>(<span class=\"hljs-string\">&apos;text&apos;</span>)\n    lines = f.readlines()\n    f.close()\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"286,317"}},{"content":"<pre data-lines=\"318,351\"><code class=\"language-python\"><span class=\"hljs-string\">&quot;&quot;&quot;\nthread1.py  &#x7ebf;&#x7a0b;&#x57fa;&#x7840;&#x4f7f;&#x7528;\n&#x6b65;&#x9aa4;&#xff1a; &#x57fa;&#x672c;&#x540c;&#x8fdb;&#x7a0b;Process\n&quot;&quot;&quot;</span>\n\n<span class=\"hljs-keyword\">import</span>  threading\n<span class=\"hljs-keyword\">from</span> time <span class=\"hljs-keyword\">import</span> sleep\n<span class=\"hljs-keyword\">import</span> os\n\na = <span class=\"hljs-number\">1</span>\n\n<span class=\"hljs-comment\"># &#x7ebf;&#x7a0b;&#x51fd;&#x6570;</span>\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">music</span>():\n    <span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(<span class=\"hljs-number\">3</span>):\n        sleep(<span class=\"hljs-number\">2</span>)\n        <span class=\"hljs-built_in\">print</span>(os.getpid(),<span class=\"hljs-string\">&quot;&#x64ad;&#x653e;:&#x9ec4;&#x6cb3;&#x5927;&#x5408;&#x5531;&quot;</span>)\n    <span class=\"hljs-keyword\">global</span> a\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;a = &quot;</span>,a)\n    a = <span class=\"hljs-number\">10000</span>\n\n<span class=\"hljs-comment\"># &#x521b;&#x5efa;&#x7ebf;&#x7a0b;&#x5bf9;&#x8c61;</span>\nt = threading.Thread(target=music)\nt.start() <span class=\"hljs-comment\"># &#x542f;&#x52a8;&#x7ebf;&#x7a0b;</span>\n\n<span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(<span class=\"hljs-number\">4</span>):\n    sleep(<span class=\"hljs-number\">1</span>)\n    <span class=\"hljs-built_in\">print</span>(os.getpid(),<span class=\"hljs-string\">&quot;&#x64ad;&#x653e;:&#x846b;&#x82a6;&#x5a03;&quot;</span>)\n\nt.join() <span class=\"hljs-comment\"># &#x56de;&#x6536;&#x7ebf;&#x7a0b;</span>\n<span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;a:&quot;</span>,a) <span class=\"hljs-comment\"># 10000</span>\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"318,351"}},{"content":"<pre data-lines=\"352,378\"><code class=\"language-python\"><span class=\"hljs-string\">&quot;&quot;&quot;\nthread2.py\n&#x7ebf;&#x7a0b;&#x51fd;&#x6570;&#x4f20;&#x53c2;\n&quot;&quot;&quot;</span>\n<span class=\"hljs-keyword\">from</span> threading <span class=\"hljs-keyword\">import</span> Thread\n<span class=\"hljs-keyword\">from</span> time <span class=\"hljs-keyword\">import</span> sleep\n\n<span class=\"hljs-comment\"># &#x542b;&#x6709;&#x53c2;&#x6570;&#x7684;&#x7ebf;&#x7a0b;&#x51fd;&#x6570;</span>\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">fun</span>(<span class=\"hljs-params\">sec,name</span>):\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;&#x7ebf;&#x7a0b;&#x51fd;&#x6570;&#x53c2;&#x6570;&quot;</span>)\n    sleep(sec)\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;%s&#x6267;&#x884c;&#x5b8c;&#x6bd5;&quot;</span>%name)\n\n<span class=\"hljs-comment\"># &#x521b;&#x5efa;&#x591a;&#x4e2a;&#x7ebf;&#x7a0b;</span>\njobs = []\n<span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> <span class=\"hljs-built_in\">range</span>(<span class=\"hljs-number\">5</span>):\n    t = Thread(target=fun,args=(<span class=\"hljs-number\">2</span>,),\n               kwargs={<span class=\"hljs-string\">&apos;name&apos;</span>:<span class=\"hljs-string\">&apos;T%d&apos;</span>%i})\n    jobs.append(t)\n    t.start()\n\n<span class=\"hljs-keyword\">for</span> i <span class=\"hljs-keyword\">in</span> jobs:\n    i.join()\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"352,378"}},{"content":"<pre data-lines=\"379,405\"><code class=\"language-python\"><span class=\"hljs-string\">&quot;&quot;&quot;\nthread_attr.py\n&#x7ebf;&#x7a0b;&#x5c5e;&#x6027;&#x793a;&#x4f8b;\n&quot;&quot;&quot;</span>\n<span class=\"hljs-keyword\">from</span> threading <span class=\"hljs-keyword\">import</span> Thread\n<span class=\"hljs-keyword\">from</span> time <span class=\"hljs-keyword\">import</span> sleep\n\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">fun</span>():\n    sleep(<span class=\"hljs-number\">3</span>)\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;&#x7ebf;&#x7a0b;&#x5c5e;&#x6027;&#x6d4b;&#x8bd5;&quot;</span>)\n\nt = Thread(target=fun,name = <span class=\"hljs-string\">&quot;Tarena&quot;</span>)\n\nt.setDaemon(<span class=\"hljs-literal\">True</span>) <span class=\"hljs-comment\"># &#x4e3b;&#x7ebf;&#x7a0b;&#x9000;&#x51fa;&#x8fd9;&#x4e2a;&#x5206;&#x652f;&#x7ebf;&#x7a0b;&#x4e5f;&#x9000;&#x51fa;</span>\n\nt.start()\n\nt.setName(<span class=\"hljs-string\">&quot;Tedu&quot;</span>)\n<span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;Name:&quot;</span>,t.getName())\n\n<span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;is alive:&quot;</span>,t.is_alive())\n\n\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"379,405"}},{"content":"<pre data-lines=\"406,437\"><code class=\"language-python\"><span class=\"hljs-string\">&quot;&quot;&quot;\nthread_event.py\n\nevent  &#x7ebf;&#x7a0b;&#x4e92;&#x65a5;&#x65b9;&#x6cd5;\n&quot;&quot;&quot;</span>\n<span class=\"hljs-keyword\">from</span> threading <span class=\"hljs-keyword\">import</span> Thread,Event\n\ns = <span class=\"hljs-literal\">None</span>  <span class=\"hljs-comment\"># &#x7528;&#x4e8e;&#x901a;&#x4fe1; &#x5171;&#x4eab;&#x8d44;&#x6e90;</span>\ne = Event()\n\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">&#x6768;&#x5b50;&#x8363;</span>():\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;&#x6768;&#x5b50;&#x8363;&#x524d;&#x6765;&#x62dc;&#x5c71;&#x5934;&quot;</span>)\n    <span class=\"hljs-keyword\">global</span> s\n    s = <span class=\"hljs-string\">&quot;&#x5929;&#x738b;&#x76d6;&#x5730;&#x864e;&quot;</span>\n    e.<span class=\"hljs-built_in\">set</span>() <span class=\"hljs-comment\"># &#x7528;&#x5b8c;s&#x89e3;&#x9664;&#x53e6;&#x4e00;&#x4e2a;&#x7ebf;&#x7a0b;&#x5bf9;s&#x4f7f;&#x7528;&#x7684;&#x963b;&#x585e;</span>\n\nt = Thread(target = &#x6768;&#x5b50;&#x8363;)\nt.start()\n\n<span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;&#x8bf4;&#x51fa;&#x53e3;&#x4ee4;&#x5c31;&#x662f;&#x81ea;&#x5df1;&#x4eba;&quot;</span>)\ne.wait() <span class=\"hljs-comment\"># &#x963b;&#x585e;&#x7b49;&#x5f85; &#x5206;&#x652f;&#x7ebf;&#x7a0b;&#x5148;&#x7528;&#x5b8c;s</span>\n<span class=\"hljs-keyword\">if</span> s == <span class=\"hljs-string\">&apos;&#x5929;&#x738b;&#x76d6;&#x5730;&#x864e;&apos;</span>:\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;&#x5b9d;&#x5854;&#x9547;&#x6cb3;&#x5996;&quot;</span>)\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;&#x786e;&#x8ba4;&#x8fc7;&#x773c;&#x795e;&#xff0c;&#x4f60;&#x662f;&#x5bf9;&#x7684;&#x4eba;&quot;</span>)\n<span class=\"hljs-keyword\">else</span>:\n    <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;&#x6253;&#x6b7b;&#x4ed6;....&quot;</span>)\n\n\nt.join()\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"406,437"}},{"content":"<pre data-lines=\"438,469\"><code class=\"language-python\"><span class=\"hljs-string\">&quot;&quot;&quot;\nthread_lock.py\n&#x7ebf;&#x7a0b;&#x9501;&#x6f14;&#x793a;\n&quot;&quot;&quot;</span>\n\n<span class=\"hljs-keyword\">from</span> threading <span class=\"hljs-keyword\">import</span> Thread,Lock\n\na = b = <span class=\"hljs-number\">0</span>\n\nlock = Lock() <span class=\"hljs-comment\"># &#x5b9a;&#x4e49;&#x9501;</span>\n\n<span class=\"hljs-keyword\">def</span> <span class=\"hljs-title function_\">value</span>():\n    <span class=\"hljs-keyword\">while</span> <span class=\"hljs-literal\">True</span>:\n        lock.acquire() <span class=\"hljs-comment\"># &#x4e0a;&#x9501;</span>\n        <span class=\"hljs-keyword\">if</span> a != b:\n            <span class=\"hljs-built_in\">print</span>(<span class=\"hljs-string\">&quot;a = %d,b = %d&quot;</span>%(a,b))\n        lock.release() <span class=\"hljs-comment\"># &#x89e3;&#x9501;</span>\n\nt = Thread(target = value)\nt.start()\n\n<span class=\"hljs-keyword\">while</span> <span class=\"hljs-literal\">True</span>:\n    lock.acquire()\n    a += <span class=\"hljs-number\">1</span>\n    b += <span class=\"hljs-number\">1</span>\n    lock.release()\n\nt.join()\n\n</code></pre>","children":[],"payload":{"tag":"pre","lines":"438,469"}},{"content":"<img src=\"../../image/12-python-new/03-io-concur-day08/xl.png\" alt=\"img\">","children":[],"payload":{"tag":"img","lines":"472,473"}}],"payload":{"tag":"h5","lines":"41,42"}}],"payload":{"tag":"h3","lines":"2,3"}}],"payload":{"tag":"h1","lines":"0,1"}},{})</script>
</body>
</html>
